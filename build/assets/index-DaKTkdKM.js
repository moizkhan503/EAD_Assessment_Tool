var Ks=Object.defineProperty;var ps=s=>{throw TypeError(s)};var Ys=(s,e,a)=>e in s?Ks(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a;var Sn=(s,e,a)=>Ys(s,typeof e!="symbol"?e+"":e,a),Ir=(s,e,a)=>e.has(s)||ps("Cannot "+a);var ct=(s,e,a)=>(Ir(s,e,"read from private field"),a?a.call(s):e.get(s)),Yt=(s,e,a)=>e.has(s)?ps("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,a),Qt=(s,e,a,o)=>(Ir(s,e,"write to private field"),o?o.call(s,a):e.set(s,a),a),Ht=(s,e,a)=>(Ir(s,e,"access private method"),a);var cr=(s,e,a,o)=>({set _(c){Qt(s,e,c,a)},get _(){return ct(s,e,o)}});function _mergeNamespaces(s,e){for(var a=0;a<e.length;a++){const o=e[a];if(typeof o!="string"&&!Array.isArray(o)){for(const c in o)if(c!=="default"&&!(c in s)){const d=Object.getOwnPropertyDescriptor(o,c);d&&Object.defineProperty(s,c,d.get?d:{enumerable:!0,get:()=>o[c]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&o(h)}).observe(document,{childList:!0,subtree:!0});function a(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function o(c){if(c.ep)return;c.ep=!0;const d=a(c);fetch(c.href,d)}})();function getDefaultExportFromCjs(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function getAugmentedNamespace(s){if(s.__esModule)return s;var e=s.default;if(typeof e=="function"){var a=function o(){return this instanceof o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};a.prototype=e.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(s).forEach(function(o){var c=Object.getOwnPropertyDescriptor(s,o);Object.defineProperty(a,o,c.get?c:{enumerable:!0,get:function(){return s[o]}})}),a}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t$2=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$2=Symbol.iterator;function A$1(s){return s===null||typeof s!="object"?null:(s=z$2&&s[z$2]||s["@@iterator"],typeof s=="function"?s:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(s,e,a){this.props=s,this.context=e,this.refs=D$1,this.updater=a||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(s,e){if(typeof s!="object"&&typeof s!="function"&&s!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,s,e,"setState")};E$1.prototype.forceUpdate=function(s){this.updater.enqueueForceUpdate(this,s,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(s,e,a){this.props=s,this.context=e,this.refs=D$1,this.updater=a||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(s,e,a){var o,c={},d=null,h=null;if(e!=null)for(o in e.ref!==void 0&&(h=e.ref),e.key!==void 0&&(d=""+e.key),e)J.call(e,o)&&!L$1.hasOwnProperty(o)&&(c[o]=e[o]);var g=arguments.length-2;if(g===1)c.children=a;else if(1<g){for(var _=Array(g),b=0;b<g;b++)_[b]=arguments[b+2];c.children=_}if(s&&s.defaultProps)for(o in g=s.defaultProps,g)c[o]===void 0&&(c[o]=g[o]);return{$$typeof:l$1,type:s,key:d,ref:h,props:c,_owner:K$1.current}}function N$1(s,e){return{$$typeof:l$1,type:s.type,key:e,ref:s.ref,props:s.props,_owner:s._owner}}function O$1(s){return typeof s=="object"&&s!==null&&s.$$typeof===l$1}function escape$1(s){var e={"=":"=0",":":"=2"};return"$"+s.replace(/[=:]/g,function(a){return e[a]})}var P$1=/\/+/g;function Q$1(s,e){return typeof s=="object"&&s!==null&&s.key!=null?escape$1(""+s.key):e.toString(36)}function R$1(s,e,a,o,c){var d=typeof s;(d==="undefined"||d==="boolean")&&(s=null);var h=!1;if(s===null)h=!0;else switch(d){case"string":case"number":h=!0;break;case"object":switch(s.$$typeof){case l$1:case n$1:h=!0}}if(h)return h=s,c=c(h),s=o===""?"."+Q$1(h,0):o,I$1(c)?(a="",s!=null&&(a=s.replace(P$1,"$&/")+"/"),R$1(c,e,a,"",function(b){return b})):c!=null&&(O$1(c)&&(c=N$1(c,a+(!c.key||h&&h.key===c.key?"":(""+c.key).replace(P$1,"$&/")+"/")+s)),e.push(c)),1;if(h=0,o=o===""?".":o+":",I$1(s))for(var g=0;g<s.length;g++){d=s[g];var _=o+Q$1(d,g);h+=R$1(d,e,a,_,c)}else if(_=A$1(s),typeof _=="function")for(s=_.call(s),g=0;!(d=s.next()).done;)d=d.value,_=o+Q$1(d,g++),h+=R$1(d,e,a,_,c);else if(d==="object")throw e=String(s),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return h}function S$1(s,e,a){if(s==null)return s;var o=[],c=0;return R$1(s,o,"","",function(d){return e.call(a,d,c++)}),o}function T$1(s){if(s._status===-1){var e=s._result;e=e(),e.then(function(a){(s._status===0||s._status===-1)&&(s._status=1,s._result=a)},function(a){(s._status===0||s._status===-1)&&(s._status=2,s._result=a)}),s._status===-1&&(s._status=0,s._result=e)}if(s._status===1)return s._result.default;throw s._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$1(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(s,e,a){S$1(s,function(){e.apply(this,arguments)},a)},count:function(s){var e=0;return S$1(s,function(){e++}),e},toArray:function(s){return S$1(s,function(e){return e})||[]},only:function(s){if(!O$1(s))throw Error("React.Children.only expected to receive a single React element child.");return s}};react_production_min.Component=E$1;react_production_min.Fragment=p$2;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$1;react_production_min.cloneElement=function(s,e,a){if(s==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+s+".");var o=C$1({},s.props),c=s.key,d=s.ref,h=s._owner;if(e!=null){if(e.ref!==void 0&&(d=e.ref,h=K$1.current),e.key!==void 0&&(c=""+e.key),s.type&&s.type.defaultProps)var g=s.type.defaultProps;for(_ in e)J.call(e,_)&&!L$1.hasOwnProperty(_)&&(o[_]=e[_]===void 0&&g!==void 0?g[_]:e[_])}var _=arguments.length-2;if(_===1)o.children=a;else if(1<_){g=Array(_);for(var b=0;b<_;b++)g[b]=arguments[b+2];o.children=g}return{$$typeof:l$1,type:s.type,key:c,ref:d,props:o,_owner:h}};react_production_min.createContext=function(s){return s={$$typeof:u,_currentValue:s,_currentValue2:s,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},s.Provider={$$typeof:t$2,_context:s},s.Consumer=s};react_production_min.createElement=M$1;react_production_min.createFactory=function(s){var e=M$1.bind(null,s);return e.type=s,e};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(s){return{$$typeof:v$1,render:s}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(s){return{$$typeof:y,_payload:{_status:-1,_result:s},_init:T$1}};react_production_min.memo=function(s,e){return{$$typeof:x,type:s,compare:e===void 0?null:e}};react_production_min.startTransition=function(s){var e=V$1.transition;V$1.transition={};try{s()}finally{V$1.transition=e}};react_production_min.unstable_act=X$1;react_production_min.useCallback=function(s,e){return U$1.current.useCallback(s,e)};react_production_min.useContext=function(s){return U$1.current.useContext(s)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(s){return U$1.current.useDeferredValue(s)};react_production_min.useEffect=function(s,e){return U$1.current.useEffect(s,e)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(s,e,a){return U$1.current.useImperativeHandle(s,e,a)};react_production_min.useInsertionEffect=function(s,e){return U$1.current.useInsertionEffect(s,e)};react_production_min.useLayoutEffect=function(s,e){return U$1.current.useLayoutEffect(s,e)};react_production_min.useMemo=function(s,e){return U$1.current.useMemo(s,e)};react_production_min.useReducer=function(s,e,a){return U$1.current.useReducer(s,e,a)};react_production_min.useRef=function(s){return U$1.current.useRef(s)};react_production_min.useState=function(s){return U$1.current.useState(s)};react_production_min.useSyncExternalStore=function(s,e,a){return U$1.current.useSyncExternalStore(s,e,a)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(s,e,a){var o,c={},d=null,h=null;a!==void 0&&(d=""+a),e.key!==void 0&&(d=""+e.key),e.ref!==void 0&&(h=e.ref);for(o in e)m$1.call(e,o)&&!p$1.hasOwnProperty(o)&&(c[o]=e[o]);if(s&&s.defaultProps)for(o in e=s.defaultProps,e)c[o]===void 0&&(c[o]=e[o]);return{$$typeof:k,type:s,key:d,ref:h,props:c,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(s){function e(Rt,bt){var Tt=Rt.length;Rt.push(bt);e:for(;0<Tt;){var $t=Tt-1>>>1,xt=Rt[$t];if(0<c(xt,bt))Rt[$t]=bt,Rt[Tt]=xt,Tt=$t;else break e}}function a(Rt){return Rt.length===0?null:Rt[0]}function o(Rt){if(Rt.length===0)return null;var bt=Rt[0],Tt=Rt.pop();if(Tt!==bt){Rt[0]=Tt;e:for(var $t=0,xt=Rt.length,ft=xt>>>1;$t<ft;){var yt=2*($t+1)-1,vt=Rt[yt],It=yt+1,Lt=Rt[It];if(0>c(vt,Tt))It<xt&&0>c(Lt,vt)?(Rt[$t]=Lt,Rt[It]=Tt,$t=It):(Rt[$t]=vt,Rt[yt]=Tt,$t=yt);else if(It<xt&&0>c(Lt,Tt))Rt[$t]=Lt,Rt[It]=Tt,$t=It;else break e}}return bt}function c(Rt,bt){var Tt=Rt.sortIndex-bt.sortIndex;return Tt!==0?Tt:Rt.id-bt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;s.unstable_now=function(){return d.now()}}else{var h=Date,g=h.now();s.unstable_now=function(){return h.now()-g}}var _=[],b=[],j=1,$=null,_e=3,tt=!1,et=!1,st=!1,rt=typeof setTimeout=="function"?setTimeout:null,nt=typeof clearTimeout=="function"?clearTimeout:null,it=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function at(Rt){for(var bt=a(b);bt!==null;){if(bt.callback===null)o(b);else if(bt.startTime<=Rt)o(b),bt.sortIndex=bt.expirationTime,e(_,bt);else break;bt=a(b)}}function dt(Rt){if(st=!1,at(Rt),!et)if(a(_)!==null)et=!0,Ot(ot);else{var bt=a(b);bt!==null&&Ct(dt,bt.startTime-Rt)}}function ot(Rt,bt){et=!1,st&&(st=!1,nt(pt),pt=-1),tt=!0;var Tt=_e;try{for(at(bt),$=a(_);$!==null&&(!($.expirationTime>bt)||Rt&&!mt());){var $t=$.callback;if(typeof $t=="function"){$.callback=null,_e=$.priorityLevel;var xt=$t($.expirationTime<=bt);bt=s.unstable_now(),typeof xt=="function"?$.callback=xt:$===a(_)&&o(_),at(bt)}else o(_);$=a(_)}if($!==null)var ft=!0;else{var yt=a(b);yt!==null&&Ct(dt,yt.startTime-bt),ft=!1}return ft}finally{$=null,_e=Tt,tt=!1}}var ht=!1,ut=null,pt=-1,_t=5,wt=-1;function mt(){return!(s.unstable_now()-wt<_t)}function Et(){if(ut!==null){var Rt=s.unstable_now();wt=Rt;var bt=!0;try{bt=ut(!0,Rt)}finally{bt?Pt():(ht=!1,ut=null)}}else ht=!1}var Pt;if(typeof it=="function")Pt=function(){it(Et)};else if(typeof MessageChannel<"u"){var jt=new MessageChannel,St=jt.port2;jt.port1.onmessage=Et,Pt=function(){St.postMessage(null)}}else Pt=function(){rt(Et,0)};function Ot(Rt){ut=Rt,ht||(ht=!0,Pt())}function Ct(Rt,bt){pt=rt(function(){Rt(s.unstable_now())},bt)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Rt){Rt.callback=null},s.unstable_continueExecution=function(){et||tt||(et=!0,Ot(ot))},s.unstable_forceFrameRate=function(Rt){0>Rt||125<Rt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_t=0<Rt?Math.floor(1e3/Rt):5},s.unstable_getCurrentPriorityLevel=function(){return _e},s.unstable_getFirstCallbackNode=function(){return a(_)},s.unstable_next=function(Rt){switch(_e){case 1:case 2:case 3:var bt=3;break;default:bt=_e}var Tt=_e;_e=bt;try{return Rt()}finally{_e=Tt}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(Rt,bt){switch(Rt){case 1:case 2:case 3:case 4:case 5:break;default:Rt=3}var Tt=_e;_e=Rt;try{return bt()}finally{_e=Tt}},s.unstable_scheduleCallback=function(Rt,bt,Tt){var $t=s.unstable_now();switch(typeof Tt=="object"&&Tt!==null?(Tt=Tt.delay,Tt=typeof Tt=="number"&&0<Tt?$t+Tt:$t):Tt=$t,Rt){case 1:var xt=-1;break;case 2:xt=250;break;case 5:xt=1073741823;break;case 4:xt=1e4;break;default:xt=5e3}return xt=Tt+xt,Rt={id:j++,callback:bt,priorityLevel:Rt,startTime:Tt,expirationTime:xt,sortIndex:-1},Tt>$t?(Rt.sortIndex=Tt,e(b,Rt),a(_)===null&&Rt===a(b)&&(st?(nt(pt),pt=-1):st=!0,Ct(dt,Tt-$t))):(Rt.sortIndex=xt,e(_,Rt),et||tt||(et=!0,Ot(ot))),Rt},s.unstable_shouldYield=mt,s.unstable_wrapCallback=function(Rt){var bt=_e;return function(){var Tt=_e;_e=bt;try{return Rt.apply(this,arguments)}finally{_e=Tt}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p(s){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+s,a=1;a<arguments.length;a++)e+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+s+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(s,e){ha(s,e),ha(s+"Capture",e)}function ha(s,e){for(ea[s]=e,s=0;s<e.length;s++)da.add(e[s])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(s){return ja.call(ma,s)?!0:ja.call(la,s)?!1:ka.test(s)?ma[s]=!0:(la[s]=!0,!1)}function pa(s,e,a,o){if(a!==null&&a.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return o?!1:a!==null?!a.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function qa(s,e,a,o){if(e===null||typeof e>"u"||pa(s,e,a,o))return!0;if(o)return!1;if(a!==null)switch(a.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function v(s,e,a,o,c,d,h){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=o,this.attributeNamespace=c,this.mustUseProperty=a,this.propertyName=s,this.type=e,this.sanitizeURL=d,this.removeEmptyString=h}var z$1={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){z$1[s]=new v(s,0,!1,s,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var e=s[0];z$1[e]=new v(e,1,!1,s[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(s){z$1[s]=new v(s,2,!1,s.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){z$1[s]=new v(s,2,!1,s,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){z$1[s]=new v(s,3,!1,s.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(s){z$1[s]=new v(s,3,!0,s,null,!1,!1)});["capture","download"].forEach(function(s){z$1[s]=new v(s,4,!1,s,null,!1,!1)});["cols","rows","size","span"].forEach(function(s){z$1[s]=new v(s,6,!1,s,null,!1,!1)});["rowSpan","start"].forEach(function(s){z$1[s]=new v(s,5,!1,s.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var e=s.replace(ra,sa);z$1[e]=new v(e,1,!1,s,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var e=s.replace(ra,sa);z$1[e]=new v(e,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(s){var e=s.replace(ra,sa);z$1[e]=new v(e,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(s){z$1[s]=new v(s,1,!1,s.toLowerCase(),null,!1,!1)});z$1.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(s){z$1[s]=new v(s,1,!1,s.toLowerCase(),null,!0,!0)});function ta(s,e,a,o){var c=z$1.hasOwnProperty(e)?z$1[e]:null;(c!==null?c.type!==0:o||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(qa(e,a,c,o)&&(a=null),o||c===null?oa(e)&&(a===null?s.removeAttribute(e):s.setAttribute(e,""+a)):c.mustUseProperty?s[c.propertyName]=a===null?c.type===3?!1:"":a:(e=c.attributeName,o=c.attributeNamespace,a===null?s.removeAttribute(e):(c=c.type,a=c===3||c===4&&a===!0?"":""+a,o?s.setAttributeNS(o,e,a):s.setAttribute(e,a))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(s){return s===null||typeof s!="object"?null:(s=Ja&&s[Ja]||s["@@iterator"],typeof s=="function"?s:null)}var A=Object.assign,La;function Ma(s){if(La===void 0)try{throw Error()}catch(a){var e=a.stack.trim().match(/\n( *(at )?)/);La=e&&e[1]||""}return`
`+La+s}var Na=!1;function Oa(s,e){if(!s||Na)return"";Na=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(b){var o=b}Reflect.construct(s,[],e)}else{try{e.call()}catch(b){o=b}s.call(e.prototype)}else{try{throw Error()}catch(b){o=b}s()}}catch(b){if(b&&o&&typeof b.stack=="string"){for(var c=b.stack.split(`
`),d=o.stack.split(`
`),h=c.length-1,g=d.length-1;1<=h&&0<=g&&c[h]!==d[g];)g--;for(;1<=h&&0<=g;h--,g--)if(c[h]!==d[g]){if(h!==1||g!==1)do if(h--,g--,0>g||c[h]!==d[g]){var _=`
`+c[h].replace(" at new "," at ");return s.displayName&&_.includes("<anonymous>")&&(_=_.replace("<anonymous>",s.displayName)),_}while(1<=h&&0<=g);break}}}finally{Na=!1,Error.prepareStackTrace=a}return(s=s?s.displayName||s.name:"")?Ma(s):""}function Pa(s){switch(s.tag){case 5:return Ma(s.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return s=Oa(s.type,!1),s;case 11:return s=Oa(s.type.render,!1),s;case 1:return s=Oa(s.type,!0),s;default:return""}}function Qa(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case Ca:return(s.displayName||"Context")+".Consumer";case Ba:return(s._context.displayName||"Context")+".Provider";case Da:var e=s.render;return s=s.displayName,s||(s=e.displayName||e.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case Ga:return e=s.displayName||null,e!==null?e:Qa(s.type)||"Memo";case Ha:e=s._payload,s=s._init;try{return Qa(s(e))}catch{}}return null}function Ra(s){var e=s.type;switch(s.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=e.render,s=s.displayName||s.name||"",e.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(e);case 8:return e===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Sa(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Ta(s){var e=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ua(s){var e=Ta(s)?"checked":"value",a=Object.getOwnPropertyDescriptor(s.constructor.prototype,e),o=""+s[e];if(!s.hasOwnProperty(e)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var c=a.get,d=a.set;return Object.defineProperty(s,e,{configurable:!0,get:function(){return c.call(this)},set:function(h){o=""+h,d.call(this,h)}}),Object.defineProperty(s,e,{enumerable:a.enumerable}),{getValue:function(){return o},setValue:function(h){o=""+h},stopTracking:function(){s._valueTracker=null,delete s[e]}}}}function Va(s){s._valueTracker||(s._valueTracker=Ua(s))}function Wa(s){if(!s)return!1;var e=s._valueTracker;if(!e)return!0;var a=e.getValue(),o="";return s&&(o=Ta(s)?s.checked?"true":"false":s.value),s=o,s!==a?(e.setValue(s),!0):!1}function Xa(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Ya(s,e){var a=e.checked;return A({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??s._wrapperState.initialChecked})}function Za(s,e){var a=e.defaultValue==null?"":e.defaultValue,o=e.checked!=null?e.checked:e.defaultChecked;a=Sa(e.value!=null?e.value:a),s._wrapperState={initialChecked:o,initialValue:a,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ab(s,e){e=e.checked,e!=null&&ta(s,"checked",e,!1)}function bb(s,e){ab(s,e);var a=Sa(e.value),o=e.type;if(a!=null)o==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+a):s.value!==""+a&&(s.value=""+a);else if(o==="submit"||o==="reset"){s.removeAttribute("value");return}e.hasOwnProperty("value")?cb(s,e.type,a):e.hasOwnProperty("defaultValue")&&cb(s,e.type,Sa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(s.defaultChecked=!!e.defaultChecked)}function db(s,e,a){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var o=e.type;if(!(o!=="submit"&&o!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+s._wrapperState.initialValue,a||e===s.value||(s.value=e),s.defaultValue=e}a=s.name,a!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,a!==""&&(s.name=a)}function cb(s,e,a){(e!=="number"||Xa(s.ownerDocument)!==s)&&(a==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+a&&(s.defaultValue=""+a))}var eb=Array.isArray;function fb(s,e,a,o){if(s=s.options,e){e={};for(var c=0;c<a.length;c++)e["$"+a[c]]=!0;for(a=0;a<s.length;a++)c=e.hasOwnProperty("$"+s[a].value),s[a].selected!==c&&(s[a].selected=c),c&&o&&(s[a].defaultSelected=!0)}else{for(a=""+Sa(a),e=null,c=0;c<s.length;c++){if(s[c].value===a){s[c].selected=!0,o&&(s[c].defaultSelected=!0);return}e!==null||s[c].disabled||(e=s[c])}e!==null&&(e.selected=!0)}}function gb(s,e){if(e.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},e,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function hb(s,e){var a=e.value;if(a==null){if(a=e.children,e=e.defaultValue,a!=null){if(e!=null)throw Error(p(92));if(eb(a)){if(1<a.length)throw Error(p(93));a=a[0]}e=a}e==null&&(e=""),a=e}s._wrapperState={initialValue:Sa(a)}}function ib(s,e){var a=Sa(e.value),o=Sa(e.defaultValue);a!=null&&(a=""+a,a!==s.value&&(s.value=a),e.defaultValue==null&&s.defaultValue!==a&&(s.defaultValue=a)),o!=null&&(s.defaultValue=""+o)}function jb(s){var e=s.textContent;e===s._wrapperState.initialValue&&e!==""&&e!==null&&(s.value=e)}function kb(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(s,e){return s==null||s==="http://www.w3.org/1999/xhtml"?kb(e):s==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var mb,nb=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,a,o,c){MSApp.execUnsafeLocalFunction(function(){return s(e,a,o,c)})}:s}(function(s,e){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=e;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=mb.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;e.firstChild;)s.appendChild(e.firstChild)}});function ob(s,e){if(e){var a=s.firstChild;if(a&&a===s.lastChild&&a.nodeType===3){a.nodeValue=e;return}}s.textContent=e}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(s){qb.forEach(function(e){e=e+s.charAt(0).toUpperCase()+s.substring(1),pb[e]=pb[s]})});function rb(s,e,a){return e==null||typeof e=="boolean"||e===""?"":a||typeof e!="number"||e===0||pb.hasOwnProperty(s)&&pb[s]?(""+e).trim():e+"px"}function sb(s,e){s=s.style;for(var a in e)if(e.hasOwnProperty(a)){var o=a.indexOf("--")===0,c=rb(a,e[a],o);a==="float"&&(a="cssFloat"),o?s.setProperty(a,c):s[a]=c}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(s,e){if(e){if(tb[s]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(p(137,s));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(p(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(p(61))}if(e.style!=null&&typeof e.style!="object")throw Error(p(62))}}function vb(s,e){if(s.indexOf("-")===-1)return typeof e.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var yb=null,zb=null,Ab=null;function Bb(s){if(s=Cb(s)){if(typeof yb!="function")throw Error(p(280));var e=s.stateNode;e&&(e=Db(e),yb(s.stateNode,s.type,e))}}function Eb(s){zb?Ab?Ab.push(s):Ab=[s]:zb=s}function Fb(){if(zb){var s=zb,e=Ab;if(Ab=zb=null,Bb(s),e)for(s=0;s<e.length;s++)Bb(e[s])}}function Gb(s,e){return s(e)}function Hb(){}var Ib=!1;function Jb(s,e,a){if(Ib)return s(e,a);Ib=!0;try{return Gb(s,e,a)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(s,e){var a=s.stateNode;if(a===null)return null;var o=Db(a);if(o===null)return null;a=o[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(s=s.type,o=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!o;break e;default:s=!1}if(s)return null;if(a&&typeof a!="function")throw Error(p(231,e,typeof a));return a}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(s,e,a,o,c,d,h,g,_){var b=Array.prototype.slice.call(arguments,3);try{e.apply(a,b)}catch(j){this.onError(j)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(s){Ob=!0,Pb=s}};function Tb(s,e,a,o,c,d,h,g,_){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(s,e,a,o,c,d,h,g,_){if(Tb.apply(this,arguments),Ob){if(Ob){var b=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=b)}}function Vb(s){var e=s,a=s;if(s.alternate)for(;e.return;)e=e.return;else{s=e;do e=s,e.flags&4098&&(a=e.return),s=e.return;while(s)}return e.tag===3?a:null}function Wb(s){if(s.tag===13){var e=s.memoizedState;if(e===null&&(s=s.alternate,s!==null&&(e=s.memoizedState)),e!==null)return e.dehydrated}return null}function Xb(s){if(Vb(s)!==s)throw Error(p(188))}function Yb(s){var e=s.alternate;if(!e){if(e=Vb(s),e===null)throw Error(p(188));return e!==s?null:s}for(var a=s,o=e;;){var c=a.return;if(c===null)break;var d=c.alternate;if(d===null){if(o=c.return,o!==null){a=o;continue}break}if(c.child===d.child){for(d=c.child;d;){if(d===a)return Xb(c),s;if(d===o)return Xb(c),e;d=d.sibling}throw Error(p(188))}if(a.return!==o.return)a=c,o=d;else{for(var h=!1,g=c.child;g;){if(g===a){h=!0,a=c,o=d;break}if(g===o){h=!0,o=c,a=d;break}g=g.sibling}if(!h){for(g=d.child;g;){if(g===a){h=!0,a=d,o=c;break}if(g===o){h=!0,o=d,a=c;break}g=g.sibling}if(!h)throw Error(p(189))}}if(a.alternate!==o)throw Error(p(190))}if(a.tag!==3)throw Error(p(188));return a.stateNode.current===a?s:e}function Zb(s){return s=Yb(s),s!==null?$b(s):null}function $b(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var e=$b(s);if(e!==null)return e;s=s.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(s){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,s,void 0,(s.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(s){return s>>>=0,s===0?32:31-(pc(s)/qc|0)|0}var rc=64,sc=4194304;function tc(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function uc(s,e){var a=s.pendingLanes;if(a===0)return 0;var o=0,c=s.suspendedLanes,d=s.pingedLanes,h=a&268435455;if(h!==0){var g=h&~c;g!==0?o=tc(g):(d&=h,d!==0&&(o=tc(d)))}else h=a&~c,h!==0?o=tc(h):d!==0&&(o=tc(d));if(o===0)return 0;if(e!==0&&e!==o&&!(e&c)&&(c=o&-o,d=e&-e,c>=d||c===16&&(d&4194240)!==0))return e;if(o&4&&(o|=a&16),e=s.entangledLanes,e!==0)for(s=s.entanglements,e&=o;0<e;)a=31-oc(e),c=1<<a,o|=s[a],e&=~c;return o}function vc(s,e){switch(s){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(s,e){for(var a=s.suspendedLanes,o=s.pingedLanes,c=s.expirationTimes,d=s.pendingLanes;0<d;){var h=31-oc(d),g=1<<h,_=c[h];_===-1?(!(g&a)||g&o)&&(c[h]=vc(g,e)):_<=e&&(s.expiredLanes|=g),d&=~g}}function xc(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function yc(){var s=rc;return rc<<=1,!(rc&4194240)&&(rc=64),s}function zc(s){for(var e=[],a=0;31>a;a++)e.push(s);return e}function Ac(s,e,a){s.pendingLanes|=e,e!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,e=31-oc(e),s[e]=a}function Bc(s,e){var a=s.pendingLanes&~e;s.pendingLanes=e,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=e,s.mutableReadLanes&=e,s.entangledLanes&=e,e=s.entanglements;var o=s.eventTimes;for(s=s.expirationTimes;0<a;){var c=31-oc(a),d=1<<c;e[c]=0,o[c]=-1,s[c]=-1,a&=~d}}function Cc(s,e){var a=s.entangledLanes|=e;for(s=s.entanglements;a;){var o=31-oc(a),c=1<<o;c&e|s[o]&e&&(s[o]|=e),a&=~c}}var C=0;function Dc(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(s,e){switch(s){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(e.pointerId)}}function Tc(s,e,a,o,c,d){return s===null||s.nativeEvent!==d?(s={blockedOn:e,domEventName:a,eventSystemFlags:o,nativeEvent:d,targetContainers:[c]},e!==null&&(e=Cb(e),e!==null&&Fc(e)),s):(s.eventSystemFlags|=o,e=s.targetContainers,c!==null&&e.indexOf(c)===-1&&e.push(c),s)}function Uc(s,e,a,o,c){switch(e){case"focusin":return Lc=Tc(Lc,s,e,a,o,c),!0;case"dragenter":return Mc=Tc(Mc,s,e,a,o,c),!0;case"mouseover":return Nc=Tc(Nc,s,e,a,o,c),!0;case"pointerover":var d=c.pointerId;return Oc.set(d,Tc(Oc.get(d)||null,s,e,a,o,c)),!0;case"gotpointercapture":return d=c.pointerId,Pc.set(d,Tc(Pc.get(d)||null,s,e,a,o,c)),!0}return!1}function Vc(s){var e=Wc(s.target);if(e!==null){var a=Vb(e);if(a!==null){if(e=a.tag,e===13){if(e=Wb(a),e!==null){s.blockedOn=e,Ic(s.priority,function(){Gc(a)});return}}else if(e===3&&a.stateNode.current.memoizedState.isDehydrated){s.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Xc(s){if(s.blockedOn!==null)return!1;for(var e=s.targetContainers;0<e.length;){var a=Yc(s.domEventName,s.eventSystemFlags,e[0],s.nativeEvent);if(a===null){a=s.nativeEvent;var o=new a.constructor(a.type,a);wb=o,a.target.dispatchEvent(o),wb=null}else return e=Cb(a),e!==null&&Fc(e),s.blockedOn=a,!1;e.shift()}return!0}function Zc(s,e,a){Xc(s)&&a.delete(e)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(s,e){s.blockedOn===e&&(s.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(s){function e(c){return ad(c,s)}if(0<Kc.length){ad(Kc[0],s);for(var a=1;a<Kc.length;a++){var o=Kc[a];o.blockedOn===s&&(o.blockedOn=null)}}for(Lc!==null&&ad(Lc,s),Mc!==null&&ad(Mc,s),Nc!==null&&ad(Nc,s),Oc.forEach(e),Pc.forEach(e),a=0;a<Qc.length;a++)o=Qc[a],o.blockedOn===s&&(o.blockedOn=null);for(;0<Qc.length&&(a=Qc[0],a.blockedOn===null);)Vc(a),a.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(s,e,a,o){var c=C,d=cd.transition;cd.transition=null;try{C=1,fd(s,e,a,o)}finally{C=c,cd.transition=d}}function gd(s,e,a,o){var c=C,d=cd.transition;cd.transition=null;try{C=4,fd(s,e,a,o)}finally{C=c,cd.transition=d}}function fd(s,e,a,o){if(dd){var c=Yc(s,e,a,o);if(c===null)hd(s,e,o,id,a),Sc(s,o);else if(Uc(c,s,e,a,o))o.stopPropagation();else if(Sc(s,o),e&4&&-1<Rc.indexOf(s)){for(;c!==null;){var d=Cb(c);if(d!==null&&Ec(d),d=Yc(s,e,a,o),d===null&&hd(s,e,o,id,a),d===c)break;c=d}c!==null&&o.stopPropagation()}else hd(s,e,o,null,a)}}var id=null;function Yc(s,e,a,o){if(id=null,s=xb(o),s=Wc(s),s!==null)if(e=Vb(s),e===null)s=null;else if(a=e.tag,a===13){if(s=Wb(e),s!==null)return s;s=null}else if(a===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;s=null}else e!==s&&(s=null);return id=s,null}function jd(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var s,e=ld,a=e.length,o,c="value"in kd?kd.value:kd.textContent,d=c.length;for(s=0;s<a&&e[s]===c[s];s++);var h=a-s;for(o=1;o<=h&&e[a-o]===c[d-o];o++);return md=c.slice(s,1<o?1-o:void 0)}function od(s){var e=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&e===13&&(s=13)):s=e,s===10&&(s=13),32<=s||s===13?s:0}function pd(){return!0}function qd(){return!1}function rd(s){function e(a,o,c,d,h){this._reactName=a,this._targetInst=c,this.type=o,this.nativeEvent=d,this.target=h,this.currentTarget=null;for(var g in s)s.hasOwnProperty(g)&&(a=s[g],this[g]=a?a(d):d[g]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),e}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==yd&&(yd&&s.type==="mousemove"?(wd=s.screenX-yd.screenX,xd=s.screenY-yd.screenY):xd=wd=0,yd=s),wd)},movementY:function(s){return"movementY"in s?s.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(s){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(s):(s=Od[s])?!!e[s]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(s){if(s.key){var e=Md[s.key]||s.key;if(e!=="Unidentified")return e}return s.type==="keypress"?(s=od(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Nd[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(s){return s.type==="keypress"?od(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?od(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=" ",fe=!1;function ge(s,e){switch(s){case"keyup":return $d.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ie=!1;function je(s,e){switch(s){case"compositionend":return he(e);case"keypress":return e.which!==32?null:(fe=!0,ee);case"textInput":return s=e.data,s===ee&&fe?null:s;default:return null}}function ke(s,e){if(ie)return s==="compositionend"||!ae&&ge(s,e)?(s=nd(),md=ld=kd=null,ie=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return de&&e.locale!=="ko"?null:e.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(s){var e=s&&s.nodeName&&s.nodeName.toLowerCase();return e==="input"?!!le[s.type]:e==="textarea"}function ne(s,e,a,o){Eb(o),e=oe(e,"onChange"),0<e.length&&(a=new td("onChange","change",null,a,o),s.push({event:a,listeners:e}))}var pe=null,qe=null;function re$3(s){se(s,0)}function te(s){var e=ue(s);if(Wa(e))return s}function ve(s,e){if(s==="change")return e}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(s){if(s.propertyName==="value"&&te(qe)){var e=[];ne(e,qe,s,xb(s)),Jb(re$3,e)}}function Ce(s,e,a){s==="focusin"?(Ae(),pe=e,qe=a,pe.attachEvent("onpropertychange",Be)):s==="focusout"&&Ae()}function De(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return te(qe)}function Ee(s,e){if(s==="click")return te(e)}function Fe(s,e){if(s==="input"||s==="change")return te(e)}function Ge(s,e){return s===e&&(s!==0||1/s===1/e)||s!==s&&e!==e}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(s,e){if(He(s,e))return!0;if(typeof s!="object"||s===null||typeof e!="object"||e===null)return!1;var a=Object.keys(s),o=Object.keys(e);if(a.length!==o.length)return!1;for(o=0;o<a.length;o++){var c=a[o];if(!ja.call(e,c)||!He(s[c],e[c]))return!1}return!0}function Je(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Ke(s,e){var a=Je(s);s=0;for(var o;a;){if(a.nodeType===3){if(o=s+a.textContent.length,s<=e&&o>=e)return{node:a,offset:e-s};s=o}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Je(a)}}function Le(s,e){return s&&e?s===e?!0:s&&s.nodeType===3?!1:e&&e.nodeType===3?Le(s,e.parentNode):"contains"in s?s.contains(e):s.compareDocumentPosition?!!(s.compareDocumentPosition(e)&16):!1:!1}function Me(){for(var s=window,e=Xa();e instanceof s.HTMLIFrameElement;){try{var a=typeof e.contentWindow.location.href=="string"}catch{a=!1}if(a)s=e.contentWindow;else break;e=Xa(s.document)}return e}function Ne(s){var e=s&&s.nodeName&&s.nodeName.toLowerCase();return e&&(e==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||e==="textarea"||s.contentEditable==="true")}function Oe(s){var e=Me(),a=s.focusedElem,o=s.selectionRange;if(e!==a&&a&&a.ownerDocument&&Le(a.ownerDocument.documentElement,a)){if(o!==null&&Ne(a)){if(e=o.start,s=o.end,s===void 0&&(s=e),"selectionStart"in a)a.selectionStart=e,a.selectionEnd=Math.min(s,a.value.length);else if(s=(e=a.ownerDocument||document)&&e.defaultView||window,s.getSelection){s=s.getSelection();var c=a.textContent.length,d=Math.min(o.start,c);o=o.end===void 0?d:Math.min(o.end,c),!s.extend&&d>o&&(c=o,o=d,d=c),c=Ke(a,d);var h=Ke(a,o);c&&h&&(s.rangeCount!==1||s.anchorNode!==c.node||s.anchorOffset!==c.offset||s.focusNode!==h.node||s.focusOffset!==h.offset)&&(e=e.createRange(),e.setStart(c.node,c.offset),s.removeAllRanges(),d>o?(s.addRange(e),s.extend(h.node,h.offset)):(e.setEnd(h.node,h.offset),s.addRange(e)))}}for(e=[],s=a;s=s.parentNode;)s.nodeType===1&&e.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<e.length;a++)s=e[a],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(s,e,a){var o=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Te||Qe==null||Qe!==Xa(o)||(o=Qe,"selectionStart"in o&&Ne(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Se&&Ie(Se,o)||(Se=o,o=oe(Re,"onSelect"),0<o.length&&(e=new td("onSelect","select",null,e,a),s.push({event:e,listeners:o}),e.target=Qe)))}function Ve(s,e){var a={};return a[s.toLowerCase()]=e.toLowerCase(),a["Webkit"+s]="webkit"+e,a["Moz"+s]="moz"+e,a}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(s){if(Xe[s])return Xe[s];if(!We[s])return s;var e=We[s],a;for(a in e)if(e.hasOwnProperty(a)&&a in Ye)return Xe[s]=e[a];return s}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(s,e){df.set(s,e),fa(e,[s])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(s,e,a){var o=s.type||"unknown-event";s.currentTarget=a,Ub(o,e,void 0,s),s.currentTarget=null}function se(s,e){e=(e&4)!==0;for(var a=0;a<s.length;a++){var o=s[a],c=o.event;o=o.listeners;e:{var d=void 0;if(e)for(var h=o.length-1;0<=h;h--){var g=o[h],_=g.instance,b=g.currentTarget;if(g=g.listener,_!==d&&c.isPropagationStopped())break e;nf(c,g,b),d=_}else for(h=0;h<o.length;h++){if(g=o[h],_=g.instance,b=g.currentTarget,g=g.listener,_!==d&&c.isPropagationStopped())break e;nf(c,g,b),d=_}}}if(Qb)throw s=Rb,Qb=!1,Rb=null,s}function D(s,e){var a=e[of];a===void 0&&(a=e[of]=new Set);var o=s+"__bubble";a.has(o)||(pf(e,s,2,!1),a.add(o))}function qf(s,e,a){var o=0;e&&(o|=4),pf(a,s,o,e)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(s){if(!s[rf]){s[rf]=!0,da.forEach(function(a){a!=="selectionchange"&&(mf.has(a)||qf(a,!1,s),qf(a,!0,s))});var e=s.nodeType===9?s:s.ownerDocument;e===null||e[rf]||(e[rf]=!0,qf("selectionchange",!1,e))}}function pf(s,e,a,o){switch(jd(e)){case 1:var c=ed;break;case 4:c=gd;break;default:c=fd}a=c.bind(null,e,a,s),c=void 0,!Lb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(c=!0),o?c!==void 0?s.addEventListener(e,a,{capture:!0,passive:c}):s.addEventListener(e,a,!0):c!==void 0?s.addEventListener(e,a,{passive:c}):s.addEventListener(e,a,!1)}function hd(s,e,a,o,c){var d=o;if(!(e&1)&&!(e&2)&&o!==null)e:for(;;){if(o===null)return;var h=o.tag;if(h===3||h===4){var g=o.stateNode.containerInfo;if(g===c||g.nodeType===8&&g.parentNode===c)break;if(h===4)for(h=o.return;h!==null;){var _=h.tag;if((_===3||_===4)&&(_=h.stateNode.containerInfo,_===c||_.nodeType===8&&_.parentNode===c))return;h=h.return}for(;g!==null;){if(h=Wc(g),h===null)return;if(_=h.tag,_===5||_===6){o=d=h;continue e}g=g.parentNode}}o=o.return}Jb(function(){var b=d,j=xb(a),$=[];e:{var _e=df.get(s);if(_e!==void 0){var tt=td,et=s;switch(s){case"keypress":if(od(a)===0)break e;case"keydown":case"keyup":tt=Rd;break;case"focusin":et="focus",tt=Fd;break;case"focusout":et="blur",tt=Fd;break;case"beforeblur":case"afterblur":tt=Fd;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":tt=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":tt=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":tt=Vd;break;case $e:case af:case bf:tt=Hd;break;case cf:tt=Xd;break;case"scroll":tt=vd;break;case"wheel":tt=Zd;break;case"copy":case"cut":case"paste":tt=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":tt=Td}var st=(e&4)!==0,rt=!st&&s==="scroll",nt=st?_e!==null?_e+"Capture":null:_e;st=[];for(var it=b,at;it!==null;){at=it;var dt=at.stateNode;if(at.tag===5&&dt!==null&&(at=dt,nt!==null&&(dt=Kb(it,nt),dt!=null&&st.push(tf(it,dt,at)))),rt)break;it=it.return}0<st.length&&(_e=new tt(_e,et,null,a,j),$.push({event:_e,listeners:st}))}}if(!(e&7)){e:{if(_e=s==="mouseover"||s==="pointerover",tt=s==="mouseout"||s==="pointerout",_e&&a!==wb&&(et=a.relatedTarget||a.fromElement)&&(Wc(et)||et[uf]))break e;if((tt||_e)&&(_e=j.window===j?j:(_e=j.ownerDocument)?_e.defaultView||_e.parentWindow:window,tt?(et=a.relatedTarget||a.toElement,tt=b,et=et?Wc(et):null,et!==null&&(rt=Vb(et),et!==rt||et.tag!==5&&et.tag!==6)&&(et=null)):(tt=null,et=b),tt!==et)){if(st=Bd,dt="onMouseLeave",nt="onMouseEnter",it="mouse",(s==="pointerout"||s==="pointerover")&&(st=Td,dt="onPointerLeave",nt="onPointerEnter",it="pointer"),rt=tt==null?_e:ue(tt),at=et==null?_e:ue(et),_e=new st(dt,it+"leave",tt,a,j),_e.target=rt,_e.relatedTarget=at,dt=null,Wc(j)===b&&(st=new st(nt,it+"enter",et,a,j),st.target=at,st.relatedTarget=rt,dt=st),rt=dt,tt&&et)t:{for(st=tt,nt=et,it=0,at=st;at;at=vf(at))it++;for(at=0,dt=nt;dt;dt=vf(dt))at++;for(;0<it-at;)st=vf(st),it--;for(;0<at-it;)nt=vf(nt),at--;for(;it--;){if(st===nt||nt!==null&&st===nt.alternate)break t;st=vf(st),nt=vf(nt)}st=null}else st=null;tt!==null&&wf($,_e,tt,st,!1),et!==null&&rt!==null&&wf($,rt,et,st,!0)}}e:{if(_e=b?ue(b):window,tt=_e.nodeName&&_e.nodeName.toLowerCase(),tt==="select"||tt==="input"&&_e.type==="file")var ot=ve;else if(me(_e))if(we)ot=Fe;else{ot=De;var ht=Ce}else(tt=_e.nodeName)&&tt.toLowerCase()==="input"&&(_e.type==="checkbox"||_e.type==="radio")&&(ot=Ee);if(ot&&(ot=ot(s,b))){ne($,ot,a,j);break e}ht&&ht(s,_e,b),s==="focusout"&&(ht=_e._wrapperState)&&ht.controlled&&_e.type==="number"&&cb(_e,"number",_e.value)}switch(ht=b?ue(b):window,s){case"focusin":(me(ht)||ht.contentEditable==="true")&&(Qe=ht,Re=b,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue($,a,j);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue($,a,j)}var ut;if(ae)e:{switch(s){case"compositionstart":var pt="onCompositionStart";break e;case"compositionend":pt="onCompositionEnd";break e;case"compositionupdate":pt="onCompositionUpdate";break e}pt=void 0}else ie?ge(s,a)&&(pt="onCompositionEnd"):s==="keydown"&&a.keyCode===229&&(pt="onCompositionStart");pt&&(de&&a.locale!=="ko"&&(ie||pt!=="onCompositionStart"?pt==="onCompositionEnd"&&ie&&(ut=nd()):(kd=j,ld="value"in kd?kd.value:kd.textContent,ie=!0)),ht=oe(b,pt),0<ht.length&&(pt=new Ld(pt,s,null,a,j),$.push({event:pt,listeners:ht}),ut?pt.data=ut:(ut=he(a),ut!==null&&(pt.data=ut)))),(ut=ce?je(s,a):ke(s,a))&&(b=oe(b,"onBeforeInput"),0<b.length&&(j=new Ld("onBeforeInput","beforeinput",null,a,j),$.push({event:j,listeners:b}),j.data=ut))}se($,e)})}function tf(s,e,a){return{instance:s,listener:e,currentTarget:a}}function oe(s,e){for(var a=e+"Capture",o=[];s!==null;){var c=s,d=c.stateNode;c.tag===5&&d!==null&&(c=d,d=Kb(s,a),d!=null&&o.unshift(tf(s,d,c)),d=Kb(s,e),d!=null&&o.push(tf(s,d,c))),s=s.return}return o}function vf(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function wf(s,e,a,o,c){for(var d=e._reactName,h=[];a!==null&&a!==o;){var g=a,_=g.alternate,b=g.stateNode;if(_!==null&&_===o)break;g.tag===5&&b!==null&&(g=b,c?(_=Kb(a,d),_!=null&&h.unshift(tf(a,_,g))):c||(_=Kb(a,d),_!=null&&h.push(tf(a,_,g)))),a=a.return}h.length!==0&&s.push({event:e,listeners:h})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(s){return(typeof s=="string"?s:""+s).replace(xf,`
`).replace(yf,"")}function Af(s,e,a){if(e=zf(e),zf(s)!==e&&a)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(s,e){return s==="textarea"||s==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(s){return Hf.resolve(null).then(s).catch(If)}:Ff;function If(s){setTimeout(function(){throw s})}function Kf(s,e){var a=e,o=0;do{var c=a.nextSibling;if(s.removeChild(a),c&&c.nodeType===8)if(a=c.data,a==="/$"){if(o===0){s.removeChild(c),bd(e);return}o--}else a!=="$"&&a!=="$?"&&a!=="$!"||o++;a=c}while(a);bd(e)}function Lf(s){for(;s!=null;s=s.nextSibling){var e=s.nodeType;if(e===1||e===3)break;if(e===8){if(e=s.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return s}function Mf(s){s=s.previousSibling;for(var e=0;s;){if(s.nodeType===8){var a=s.data;if(a==="$"||a==="$!"||a==="$?"){if(e===0)return s;e--}else a==="/$"&&e++}s=s.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(s){var e=s[Of];if(e)return e;for(var a=s.parentNode;a;){if(e=a[uf]||a[Of]){if(a=e.alternate,e.child!==null||a!==null&&a.child!==null)for(s=Mf(s);s!==null;){if(a=s[Of])return a;s=Mf(s)}return e}s=a,a=s.parentNode}return null}function Cb(s){return s=s[Of]||s[uf],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function ue(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(p(33))}function Db(s){return s[Pf]||null}var Sf=[],Tf=-1;function Uf(s){return{current:s}}function E(s){0>Tf||(s.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(s,e){Tf++,Sf[Tf]=s.current,s.current=e}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(s,e){var a=s.type.contextTypes;if(!a)return Vf;var o=s.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===e)return o.__reactInternalMemoizedMaskedChildContext;var c={},d;for(d in a)c[d]=e[d];return o&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=e,s.__reactInternalMemoizedMaskedChildContext=c),c}function Zf(s){return s=s.childContextTypes,s!=null}function $f(){E(Wf),E(H)}function ag(s,e,a){if(H.current!==Vf)throw Error(p(168));G(H,e),G(Wf,a)}function bg(s,e,a){var o=s.stateNode;if(e=e.childContextTypes,typeof o.getChildContext!="function")return a;o=o.getChildContext();for(var c in o)if(!(c in e))throw Error(p(108,Ra(s)||"Unknown",c));return A({},a,o)}function cg(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,s),G(Wf,Wf.current),!0}function dg(s,e,a){var o=s.stateNode;if(!o)throw Error(p(169));a?(s=bg(s,e,Xf),o.__reactInternalMemoizedMergedChildContext=s,E(Wf),E(H),G(H,s)):E(Wf),G(Wf,a)}var eg=null,fg=!1,gg=!1;function hg(s){eg===null?eg=[s]:eg.push(s)}function ig(s){fg=!0,hg(s)}function jg(){if(!gg&&eg!==null){gg=!0;var s=0,e=C;try{var a=eg;for(C=1;s<a.length;s++){var o=a[s];do o=o(!0);while(o!==null)}eg=null,fg=!1}catch(c){throw eg!==null&&(eg=eg.slice(s+1)),ac(fc,jg),c}finally{C=e,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(s,e){kg[lg++]=ng,kg[lg++]=mg,mg=s,ng=e}function ug(s,e,a){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=s;var o=rg;s=sg;var c=32-oc(o)-1;o&=~(1<<c),a+=1;var d=32-oc(e)+c;if(30<d){var h=c-c%5;d=(o&(1<<h)-1).toString(32),o>>=h,c-=h,rg=1<<32-oc(e)+c|a<<c|o,sg=d+s}else rg=1<<d|a<<c|o,sg=s}function vg(s){s.return!==null&&(tg(s,1),ug(s,1,0))}function wg(s){for(;s===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;s===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(s,e){var a=Bg(5,null,null,0);a.elementType="DELETED",a.stateNode=e,a.return=s,e=s.deletions,e===null?(s.deletions=[a],s.flags|=16):e.push(a)}function Cg(s,e){switch(s.tag){case 5:var a=s.type;return e=e.nodeType!==1||a.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(s.stateNode=e,xg=s,yg=Lf(e.firstChild),!0):!1;case 6:return e=s.pendingProps===""||e.nodeType!==3?null:e,e!==null?(s.stateNode=e,xg=s,yg=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(a=qg!==null?{id:rg,overflow:sg}:null,s.memoizedState={dehydrated:e,treeContext:a,retryLane:1073741824},a=Bg(18,null,null,0),a.stateNode=e,a.return=s,s.child=a,xg=s,yg=null,!0):!1;default:return!1}}function Dg(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Eg(s){if(I){var e=yg;if(e){var a=e;if(!Cg(s,e)){if(Dg(s))throw Error(p(418));e=Lf(a.nextSibling);var o=xg;e&&Cg(s,e)?Ag(o,a):(s.flags=s.flags&-4097|2,I=!1,xg=s)}}else{if(Dg(s))throw Error(p(418));s.flags=s.flags&-4097|2,I=!1,xg=s}}}function Fg(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;xg=s}function Gg(s){if(s!==xg)return!1;if(!I)return Fg(s),I=!0,!1;var e;if((e=s.tag!==3)&&!(e=s.tag!==5)&&(e=s.type,e=e!=="head"&&e!=="body"&&!Ef(s.type,s.memoizedProps)),e&&(e=yg)){if(Dg(s))throw Hg(),Error(p(418));for(;e;)Ag(s,e),e=Lf(e.nextSibling)}if(Fg(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(p(317));e:{for(s=s.nextSibling,e=0;s;){if(s.nodeType===8){var a=s.data;if(a==="/$"){if(e===0){yg=Lf(s.nextSibling);break e}e--}else a!=="$"&&a!=="$!"&&a!=="$?"||e++}s=s.nextSibling}yg=null}}else yg=xg?Lf(s.stateNode.nextSibling):null;return!0}function Hg(){for(var s=yg;s;)s=Lf(s.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(s){zg===null?zg=[s]:zg.push(s)}var Kg=ua.ReactCurrentBatchConfig;function Lg(s,e,a){if(s=a.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(p(309));var o=a.stateNode}if(!o)throw Error(p(147,s));var c=o,d=""+s;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===d?e.ref:(e=function(h){var g=c.refs;h===null?delete g[d]:g[d]=h},e._stringRef=d,e)}if(typeof s!="string")throw Error(p(284));if(!a._owner)throw Error(p(290,s))}return s}function Mg(s,e){throw s=Object.prototype.toString.call(e),Error(p(31,s==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":s))}function Ng(s){var e=s._init;return e(s._payload)}function Og(s){function e(nt,it){if(s){var at=nt.deletions;at===null?(nt.deletions=[it],nt.flags|=16):at.push(it)}}function a(nt,it){if(!s)return null;for(;it!==null;)e(nt,it),it=it.sibling;return null}function o(nt,it){for(nt=new Map;it!==null;)it.key!==null?nt.set(it.key,it):nt.set(it.index,it),it=it.sibling;return nt}function c(nt,it){return nt=Pg(nt,it),nt.index=0,nt.sibling=null,nt}function d(nt,it,at){return nt.index=at,s?(at=nt.alternate,at!==null?(at=at.index,at<it?(nt.flags|=2,it):at):(nt.flags|=2,it)):(nt.flags|=1048576,it)}function h(nt){return s&&nt.alternate===null&&(nt.flags|=2),nt}function g(nt,it,at,dt){return it===null||it.tag!==6?(it=Qg(at,nt.mode,dt),it.return=nt,it):(it=c(it,at),it.return=nt,it)}function _(nt,it,at,dt){var ot=at.type;return ot===ya?j(nt,it,at.props.children,dt,at.key):it!==null&&(it.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===Ha&&Ng(ot)===it.type)?(dt=c(it,at.props),dt.ref=Lg(nt,it,at),dt.return=nt,dt):(dt=Rg(at.type,at.key,at.props,null,nt.mode,dt),dt.ref=Lg(nt,it,at),dt.return=nt,dt)}function b(nt,it,at,dt){return it===null||it.tag!==4||it.stateNode.containerInfo!==at.containerInfo||it.stateNode.implementation!==at.implementation?(it=Sg(at,nt.mode,dt),it.return=nt,it):(it=c(it,at.children||[]),it.return=nt,it)}function j(nt,it,at,dt,ot){return it===null||it.tag!==7?(it=Tg(at,nt.mode,dt,ot),it.return=nt,it):(it=c(it,at),it.return=nt,it)}function $(nt,it,at){if(typeof it=="string"&&it!==""||typeof it=="number")return it=Qg(""+it,nt.mode,at),it.return=nt,it;if(typeof it=="object"&&it!==null){switch(it.$$typeof){case va:return at=Rg(it.type,it.key,it.props,null,nt.mode,at),at.ref=Lg(nt,null,it),at.return=nt,at;case wa:return it=Sg(it,nt.mode,at),it.return=nt,it;case Ha:var dt=it._init;return $(nt,dt(it._payload),at)}if(eb(it)||Ka(it))return it=Tg(it,nt.mode,at,null),it.return=nt,it;Mg(nt,it)}return null}function _e(nt,it,at,dt){var ot=it!==null?it.key:null;if(typeof at=="string"&&at!==""||typeof at=="number")return ot!==null?null:g(nt,it,""+at,dt);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case va:return at.key===ot?_(nt,it,at,dt):null;case wa:return at.key===ot?b(nt,it,at,dt):null;case Ha:return ot=at._init,_e(nt,it,ot(at._payload),dt)}if(eb(at)||Ka(at))return ot!==null?null:j(nt,it,at,dt,null);Mg(nt,at)}return null}function tt(nt,it,at,dt,ot){if(typeof dt=="string"&&dt!==""||typeof dt=="number")return nt=nt.get(at)||null,g(it,nt,""+dt,ot);if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case va:return nt=nt.get(dt.key===null?at:dt.key)||null,_(it,nt,dt,ot);case wa:return nt=nt.get(dt.key===null?at:dt.key)||null,b(it,nt,dt,ot);case Ha:var ht=dt._init;return tt(nt,it,at,ht(dt._payload),ot)}if(eb(dt)||Ka(dt))return nt=nt.get(at)||null,j(it,nt,dt,ot,null);Mg(it,dt)}return null}function et(nt,it,at,dt){for(var ot=null,ht=null,ut=it,pt=it=0,_t=null;ut!==null&&pt<at.length;pt++){ut.index>pt?(_t=ut,ut=null):_t=ut.sibling;var wt=_e(nt,ut,at[pt],dt);if(wt===null){ut===null&&(ut=_t);break}s&&ut&&wt.alternate===null&&e(nt,ut),it=d(wt,it,pt),ht===null?ot=wt:ht.sibling=wt,ht=wt,ut=_t}if(pt===at.length)return a(nt,ut),I&&tg(nt,pt),ot;if(ut===null){for(;pt<at.length;pt++)ut=$(nt,at[pt],dt),ut!==null&&(it=d(ut,it,pt),ht===null?ot=ut:ht.sibling=ut,ht=ut);return I&&tg(nt,pt),ot}for(ut=o(nt,ut);pt<at.length;pt++)_t=tt(ut,nt,pt,at[pt],dt),_t!==null&&(s&&_t.alternate!==null&&ut.delete(_t.key===null?pt:_t.key),it=d(_t,it,pt),ht===null?ot=_t:ht.sibling=_t,ht=_t);return s&&ut.forEach(function(mt){return e(nt,mt)}),I&&tg(nt,pt),ot}function st(nt,it,at,dt){var ot=Ka(at);if(typeof ot!="function")throw Error(p(150));if(at=ot.call(at),at==null)throw Error(p(151));for(var ht=ot=null,ut=it,pt=it=0,_t=null,wt=at.next();ut!==null&&!wt.done;pt++,wt=at.next()){ut.index>pt?(_t=ut,ut=null):_t=ut.sibling;var mt=_e(nt,ut,wt.value,dt);if(mt===null){ut===null&&(ut=_t);break}s&&ut&&mt.alternate===null&&e(nt,ut),it=d(mt,it,pt),ht===null?ot=mt:ht.sibling=mt,ht=mt,ut=_t}if(wt.done)return a(nt,ut),I&&tg(nt,pt),ot;if(ut===null){for(;!wt.done;pt++,wt=at.next())wt=$(nt,wt.value,dt),wt!==null&&(it=d(wt,it,pt),ht===null?ot=wt:ht.sibling=wt,ht=wt);return I&&tg(nt,pt),ot}for(ut=o(nt,ut);!wt.done;pt++,wt=at.next())wt=tt(ut,nt,pt,wt.value,dt),wt!==null&&(s&&wt.alternate!==null&&ut.delete(wt.key===null?pt:wt.key),it=d(wt,it,pt),ht===null?ot=wt:ht.sibling=wt,ht=wt);return s&&ut.forEach(function(Et){return e(nt,Et)}),I&&tg(nt,pt),ot}function rt(nt,it,at,dt){if(typeof at=="object"&&at!==null&&at.type===ya&&at.key===null&&(at=at.props.children),typeof at=="object"&&at!==null){switch(at.$$typeof){case va:e:{for(var ot=at.key,ht=it;ht!==null;){if(ht.key===ot){if(ot=at.type,ot===ya){if(ht.tag===7){a(nt,ht.sibling),it=c(ht,at.props.children),it.return=nt,nt=it;break e}}else if(ht.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===Ha&&Ng(ot)===ht.type){a(nt,ht.sibling),it=c(ht,at.props),it.ref=Lg(nt,ht,at),it.return=nt,nt=it;break e}a(nt,ht);break}else e(nt,ht);ht=ht.sibling}at.type===ya?(it=Tg(at.props.children,nt.mode,dt,at.key),it.return=nt,nt=it):(dt=Rg(at.type,at.key,at.props,null,nt.mode,dt),dt.ref=Lg(nt,it,at),dt.return=nt,nt=dt)}return h(nt);case wa:e:{for(ht=at.key;it!==null;){if(it.key===ht)if(it.tag===4&&it.stateNode.containerInfo===at.containerInfo&&it.stateNode.implementation===at.implementation){a(nt,it.sibling),it=c(it,at.children||[]),it.return=nt,nt=it;break e}else{a(nt,it);break}else e(nt,it);it=it.sibling}it=Sg(at,nt.mode,dt),it.return=nt,nt=it}return h(nt);case Ha:return ht=at._init,rt(nt,it,ht(at._payload),dt)}if(eb(at))return et(nt,it,at,dt);if(Ka(at))return st(nt,it,at,dt);Mg(nt,at)}return typeof at=="string"&&at!==""||typeof at=="number"?(at=""+at,it!==null&&it.tag===6?(a(nt,it.sibling),it=c(it,at),it.return=nt,nt=it):(a(nt,it),it=Qg(at,nt.mode,dt),it.return=nt,nt=it),h(nt)):a(nt,it)}return rt}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(s){var e=Wg.current;E(Wg),s._currentValue=e}function bh(s,e,a){for(;s!==null;){var o=s.alternate;if((s.childLanes&e)!==e?(s.childLanes|=e,o!==null&&(o.childLanes|=e)):o!==null&&(o.childLanes&e)!==e&&(o.childLanes|=e),s===a)break;s=s.return}}function ch(s,e){Xg=s,Zg=Yg=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&e&&(dh=!0),s.firstContext=null)}function eh(s){var e=s._currentValue;if(Zg!==s)if(s={context:s,memoizedValue:e,next:null},Yg===null){if(Xg===null)throw Error(p(308));Yg=s,Xg.dependencies={lanes:0,firstContext:s}}else Yg=Yg.next=s;return e}var fh=null;function gh(s){fh===null?fh=[s]:fh.push(s)}function hh(s,e,a,o){var c=e.interleaved;return c===null?(a.next=a,gh(e)):(a.next=c.next,c.next=a),e.interleaved=a,ih(s,o)}function ih(s,e){s.lanes|=e;var a=s.alternate;for(a!==null&&(a.lanes|=e),a=s,s=s.return;s!==null;)s.childLanes|=e,a=s.alternate,a!==null&&(a.childLanes|=e),a=s,s=s.return;return a.tag===3?a.stateNode:null}var jh=!1;function kh(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(s,e){s=s.updateQueue,e.updateQueue===s&&(e.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function mh(s,e){return{eventTime:s,lane:e,tag:0,payload:null,callback:null,next:null}}function nh(s,e,a){var o=s.updateQueue;if(o===null)return null;if(o=o.shared,K&2){var c=o.pending;return c===null?e.next=e:(e.next=c.next,c.next=e),o.pending=e,ih(s,a)}return c=o.interleaved,c===null?(e.next=e,gh(o)):(e.next=c.next,c.next=e),o.interleaved=e,ih(s,a)}function oh(s,e,a){if(e=e.updateQueue,e!==null&&(e=e.shared,(a&4194240)!==0)){var o=e.lanes;o&=s.pendingLanes,a|=o,e.lanes=a,Cc(s,a)}}function ph(s,e){var a=s.updateQueue,o=s.alternate;if(o!==null&&(o=o.updateQueue,a===o)){var c=null,d=null;if(a=a.firstBaseUpdate,a!==null){do{var h={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};d===null?c=d=h:d=d.next=h,a=a.next}while(a!==null);d===null?c=d=e:d=d.next=e}else c=d=e;a={baseState:o.baseState,firstBaseUpdate:c,lastBaseUpdate:d,shared:o.shared,effects:o.effects},s.updateQueue=a;return}s=a.lastBaseUpdate,s===null?a.firstBaseUpdate=e:s.next=e,a.lastBaseUpdate=e}function qh(s,e,a,o){var c=s.updateQueue;jh=!1;var d=c.firstBaseUpdate,h=c.lastBaseUpdate,g=c.shared.pending;if(g!==null){c.shared.pending=null;var _=g,b=_.next;_.next=null,h===null?d=b:h.next=b,h=_;var j=s.alternate;j!==null&&(j=j.updateQueue,g=j.lastBaseUpdate,g!==h&&(g===null?j.firstBaseUpdate=b:g.next=b,j.lastBaseUpdate=_))}if(d!==null){var $=c.baseState;h=0,j=b=_=null,g=d;do{var _e=g.lane,tt=g.eventTime;if((o&_e)===_e){j!==null&&(j=j.next={eventTime:tt,lane:0,tag:g.tag,payload:g.payload,callback:g.callback,next:null});e:{var et=s,st=g;switch(_e=e,tt=a,st.tag){case 1:if(et=st.payload,typeof et=="function"){$=et.call(tt,$,_e);break e}$=et;break e;case 3:et.flags=et.flags&-65537|128;case 0:if(et=st.payload,_e=typeof et=="function"?et.call(tt,$,_e):et,_e==null)break e;$=A({},$,_e);break e;case 2:jh=!0}}g.callback!==null&&g.lane!==0&&(s.flags|=64,_e=c.effects,_e===null?c.effects=[g]:_e.push(g))}else tt={eventTime:tt,lane:_e,tag:g.tag,payload:g.payload,callback:g.callback,next:null},j===null?(b=j=tt,_=$):j=j.next=tt,h|=_e;if(g=g.next,g===null){if(g=c.shared.pending,g===null)break;_e=g,g=_e.next,_e.next=null,c.lastBaseUpdate=_e,c.shared.pending=null}}while(!0);if(j===null&&(_=$),c.baseState=_,c.firstBaseUpdate=b,c.lastBaseUpdate=j,e=c.shared.interleaved,e!==null){c=e;do h|=c.lane,c=c.next;while(c!==e)}else d===null&&(c.shared.lanes=0);rh|=h,s.lanes=h,s.memoizedState=$}}function sh(s,e,a){if(s=e.effects,e.effects=null,s!==null)for(e=0;e<s.length;e++){var o=s[e],c=o.callback;if(c!==null){if(o.callback=null,o=a,typeof c!="function")throw Error(p(191,c));c.call(o)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(s){if(s===th)throw Error(p(174));return s}function yh(s,e){switch(G(wh,e),G(vh,s),G(uh,th),s=e.nodeType,s){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lb(null,"");break;default:s=s===8?e.parentNode:e,e=s.namespaceURI||null,s=s.tagName,e=lb(e,s)}E(uh),G(uh,e)}function zh(){E(uh),E(vh),E(wh)}function Ah(s){xh(wh.current);var e=xh(uh.current),a=lb(e,s.type);e!==a&&(G(vh,s),G(uh,a))}function Bh(s){vh.current===s&&(E(uh),E(vh))}var L=Uf(0);function Ch(s){for(var e=s;e!==null;){if(e.tag===13){var a=e.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===s)break;for(;e.sibling===null;){if(e.return===null||e.return===s)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Dh=[];function Eh(){for(var s=0;s<Dh.length;s++)Dh[s]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p(321))}function Mh(s,e){if(e===null)return!1;for(var a=0;a<e.length&&a<s.length;a++)if(!He(s[a],e[a]))return!1;return!0}function Nh(s,e,a,o,c,d){if(Hh=d,M=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Fh.current=s===null||s.memoizedState===null?Oh:Ph,s=a(o,c),Jh){d=0;do{if(Jh=!1,Kh=0,25<=d)throw Error(p(301));d+=1,O=N=null,e.updateQueue=null,Fh.current=Qh,s=a(o,c)}while(Jh)}if(Fh.current=Rh,e=N!==null&&N.next!==null,Hh=0,O=N=M=null,Ih=!1,e)throw Error(p(300));return s}function Sh(){var s=Kh!==0;return Kh=0,s}function Th(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M.memoizedState=O=s:O=O.next=s,O}function Uh(){if(N===null){var s=M.alternate;s=s!==null?s.memoizedState:null}else s=N.next;var e=O===null?M.memoizedState:O.next;if(e!==null)O=e,N=s;else{if(s===null)throw Error(p(310));N=s,s={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},O===null?M.memoizedState=O=s:O=O.next=s}return O}function Vh(s,e){return typeof e=="function"?e(s):e}function Wh(s){var e=Uh(),a=e.queue;if(a===null)throw Error(p(311));a.lastRenderedReducer=s;var o=N,c=o.baseQueue,d=a.pending;if(d!==null){if(c!==null){var h=c.next;c.next=d.next,d.next=h}o.baseQueue=c=d,a.pending=null}if(c!==null){d=c.next,o=o.baseState;var g=h=null,_=null,b=d;do{var j=b.lane;if((Hh&j)===j)_!==null&&(_=_.next={lane:0,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null}),o=b.hasEagerState?b.eagerState:s(o,b.action);else{var $={lane:j,action:b.action,hasEagerState:b.hasEagerState,eagerState:b.eagerState,next:null};_===null?(g=_=$,h=o):_=_.next=$,M.lanes|=j,rh|=j}b=b.next}while(b!==null&&b!==d);_===null?h=o:_.next=g,He(o,e.memoizedState)||(dh=!0),e.memoizedState=o,e.baseState=h,e.baseQueue=_,a.lastRenderedState=o}if(s=a.interleaved,s!==null){c=s;do d=c.lane,M.lanes|=d,rh|=d,c=c.next;while(c!==s)}else c===null&&(a.lanes=0);return[e.memoizedState,a.dispatch]}function Xh(s){var e=Uh(),a=e.queue;if(a===null)throw Error(p(311));a.lastRenderedReducer=s;var o=a.dispatch,c=a.pending,d=e.memoizedState;if(c!==null){a.pending=null;var h=c=c.next;do d=s(d,h.action),h=h.next;while(h!==c);He(d,e.memoizedState)||(dh=!0),e.memoizedState=d,e.baseQueue===null&&(e.baseState=d),a.lastRenderedState=d}return[d,o]}function Yh(){}function Zh(s,e){var a=M,o=Uh(),c=e(),d=!He(o.memoizedState,c);if(d&&(o.memoizedState=c,dh=!0),o=o.queue,$h(ai.bind(null,a,o,s),[s]),o.getSnapshot!==e||d||O!==null&&O.memoizedState.tag&1){if(a.flags|=2048,bi(9,ci.bind(null,a,o,c,e),void 0,null),Q===null)throw Error(p(349));Hh&30||di(a,e,c)}return c}function di(s,e,a){s.flags|=16384,s={getSnapshot:e,value:a},e=M.updateQueue,e===null?(e={lastEffect:null,stores:null},M.updateQueue=e,e.stores=[s]):(a=e.stores,a===null?e.stores=[s]:a.push(s))}function ci(s,e,a,o){e.value=a,e.getSnapshot=o,ei(e)&&fi(s)}function ai(s,e,a){return a(function(){ei(e)&&fi(s)})}function ei(s){var e=s.getSnapshot;s=s.value;try{var a=e();return!He(s,a)}catch{return!0}}function fi(s){var e=ih(s,1);e!==null&&gi(e,s,1,-1)}function hi(s){var e=Th();return typeof s=="function"&&(s=s()),e.memoizedState=e.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:s},e.queue=s,s=s.dispatch=ii.bind(null,M,s),[e.memoizedState,s]}function bi(s,e,a,o){return s={tag:s,create:e,destroy:a,deps:o,next:null},e=M.updateQueue,e===null?(e={lastEffect:null,stores:null},M.updateQueue=e,e.lastEffect=s.next=s):(a=e.lastEffect,a===null?e.lastEffect=s.next=s:(o=a.next,a.next=s,s.next=o,e.lastEffect=s)),s}function ji(){return Uh().memoizedState}function ki(s,e,a,o){var c=Th();M.flags|=s,c.memoizedState=bi(1|e,a,void 0,o===void 0?null:o)}function li(s,e,a,o){var c=Uh();o=o===void 0?null:o;var d=void 0;if(N!==null){var h=N.memoizedState;if(d=h.destroy,o!==null&&Mh(o,h.deps)){c.memoizedState=bi(e,a,d,o);return}}M.flags|=s,c.memoizedState=bi(1|e,a,d,o)}function mi(s,e){return ki(8390656,8,s,e)}function $h(s,e){return li(2048,8,s,e)}function ni(s,e){return li(4,2,s,e)}function oi(s,e){return li(4,4,s,e)}function pi(s,e){if(typeof e=="function")return s=s(),e(s),function(){e(null)};if(e!=null)return s=s(),e.current=s,function(){e.current=null}}function qi(s,e,a){return a=a!=null?a.concat([s]):null,li(4,4,pi.bind(null,e,s),a)}function ri(){}function si(s,e){var a=Uh();e=e===void 0?null:e;var o=a.memoizedState;return o!==null&&e!==null&&Mh(e,o[1])?o[0]:(a.memoizedState=[s,e],s)}function ti(s,e){var a=Uh();e=e===void 0?null:e;var o=a.memoizedState;return o!==null&&e!==null&&Mh(e,o[1])?o[0]:(s=s(),a.memoizedState=[s,e],s)}function ui(s,e,a){return Hh&21?(He(a,e)||(a=yc(),M.lanes|=a,rh|=a,s.baseState=!0),e):(s.baseState&&(s.baseState=!1,dh=!0),s.memoizedState=a)}function vi(s,e){var a=C;C=a!==0&&4>a?a:4,s(!0);var o=Gh.transition;Gh.transition={};try{s(!1),e()}finally{C=a,Gh.transition=o}}function wi(){return Uh().memoizedState}function xi(s,e,a){var o=yi(s);if(a={lane:o,action:a,hasEagerState:!1,eagerState:null,next:null},zi(s))Ai(e,a);else if(a=hh(s,e,a,o),a!==null){var c=R();gi(a,s,o,c),Bi(a,e,o)}}function ii(s,e,a){var o=yi(s),c={lane:o,action:a,hasEagerState:!1,eagerState:null,next:null};if(zi(s))Ai(e,c);else{var d=s.alternate;if(s.lanes===0&&(d===null||d.lanes===0)&&(d=e.lastRenderedReducer,d!==null))try{var h=e.lastRenderedState,g=d(h,a);if(c.hasEagerState=!0,c.eagerState=g,He(g,h)){var _=e.interleaved;_===null?(c.next=c,gh(e)):(c.next=_.next,_.next=c),e.interleaved=c;return}}catch{}finally{}a=hh(s,e,c,o),a!==null&&(c=R(),gi(a,s,o,c),Bi(a,e,o))}}function zi(s){var e=s.alternate;return s===M||e!==null&&e===M}function Ai(s,e){Jh=Ih=!0;var a=s.pending;a===null?e.next=e:(e.next=a.next,a.next=e),s.pending=e}function Bi(s,e,a){if(a&4194240){var o=e.lanes;o&=s.pendingLanes,a|=o,e.lanes=a,Cc(s,a)}}var Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(s,e){return Th().memoizedState=[s,e===void 0?null:e],s},useContext:eh,useEffect:mi,useImperativeHandle:function(s,e,a){return a=a!=null?a.concat([s]):null,ki(4194308,4,pi.bind(null,e,s),a)},useLayoutEffect:function(s,e){return ki(4194308,4,s,e)},useInsertionEffect:function(s,e){return ki(4,2,s,e)},useMemo:function(s,e){var a=Th();return e=e===void 0?null:e,s=s(),a.memoizedState=[s,e],s},useReducer:function(s,e,a){var o=Th();return e=a!==void 0?a(e):e,o.memoizedState=o.baseState=e,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:e},o.queue=s,s=s.dispatch=xi.bind(null,M,s),[o.memoizedState,s]},useRef:function(s){var e=Th();return s={current:s},e.memoizedState=s},useState:hi,useDebugValue:ri,useDeferredValue:function(s){return Th().memoizedState=s},useTransition:function(){var s=hi(!1),e=s[0];return s=vi.bind(null,s[1]),Th().memoizedState=s,[e,s]},useMutableSource:function(){},useSyncExternalStore:function(s,e,a){var o=M,c=Th();if(I){if(a===void 0)throw Error(p(407));a=a()}else{if(a=e(),Q===null)throw Error(p(349));Hh&30||di(o,e,a)}c.memoizedState=a;var d={value:a,getSnapshot:e};return c.queue=d,mi(ai.bind(null,o,d,s),[s]),o.flags|=2048,bi(9,ci.bind(null,o,d,a,e),void 0,null),a},useId:function(){var s=Th(),e=Q.identifierPrefix;if(I){var a=sg,o=rg;a=(o&~(1<<32-oc(o)-1)).toString(32)+a,e=":"+e+"R"+a,a=Kh++,0<a&&(e+="H"+a.toString(32)),e+=":"}else a=Lh++,e=":"+e+"r"+a.toString(32)+":";return s.memoizedState=e},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(s){var e=Uh();return ui(e,N.memoizedState,s)},useTransition:function(){var s=Wh(Vh)[0],e=Uh().memoizedState;return[s,e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(s){var e=Uh();return N===null?e.memoizedState=s:ui(e,N.memoizedState,s)},useTransition:function(){var s=Xh(Vh)[0],e=Uh().memoizedState;return[s,e]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(s,e){if(s&&s.defaultProps){e=A({},e),s=s.defaultProps;for(var a in s)e[a]===void 0&&(e[a]=s[a]);return e}return e}function Di(s,e,a,o){e=s.memoizedState,a=a(o,e),a=a==null?e:A({},e,a),s.memoizedState=a,s.lanes===0&&(s.updateQueue.baseState=a)}var Ei={isMounted:function(s){return(s=s._reactInternals)?Vb(s)===s:!1},enqueueSetState:function(s,e,a){s=s._reactInternals;var o=R(),c=yi(s),d=mh(o,c);d.payload=e,a!=null&&(d.callback=a),e=nh(s,d,c),e!==null&&(gi(e,s,c,o),oh(e,s,c))},enqueueReplaceState:function(s,e,a){s=s._reactInternals;var o=R(),c=yi(s),d=mh(o,c);d.tag=1,d.payload=e,a!=null&&(d.callback=a),e=nh(s,d,c),e!==null&&(gi(e,s,c,o),oh(e,s,c))},enqueueForceUpdate:function(s,e){s=s._reactInternals;var a=R(),o=yi(s),c=mh(a,o);c.tag=2,e!=null&&(c.callback=e),e=nh(s,c,o),e!==null&&(gi(e,s,o,a),oh(e,s,o))}};function Fi(s,e,a,o,c,d,h){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(o,d,h):e.prototype&&e.prototype.isPureReactComponent?!Ie(a,o)||!Ie(c,d):!0}function Gi(s,e,a){var o=!1,c=Vf,d=e.contextType;return typeof d=="object"&&d!==null?d=eh(d):(c=Zf(e)?Xf:H.current,o=e.contextTypes,d=(o=o!=null)?Yf(s,c):Vf),e=new e(a,d),s.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ei,s.stateNode=e,e._reactInternals=s,o&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=c,s.__reactInternalMemoizedMaskedChildContext=d),e}function Hi(s,e,a,o){s=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(a,o),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(a,o),e.state!==s&&Ei.enqueueReplaceState(e,e.state,null)}function Ii(s,e,a,o){var c=s.stateNode;c.props=a,c.state=s.memoizedState,c.refs={},kh(s);var d=e.contextType;typeof d=="object"&&d!==null?c.context=eh(d):(d=Zf(e)?Xf:H.current,c.context=Yf(s,d)),c.state=s.memoizedState,d=e.getDerivedStateFromProps,typeof d=="function"&&(Di(s,e,d,a),c.state=s.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(e=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),e!==c.state&&Ei.enqueueReplaceState(c,c.state,null),qh(s,a,c,o),c.state=s.memoizedState),typeof c.componentDidMount=="function"&&(s.flags|=4194308)}function Ji(s,e){try{var a="",o=e;do a+=Pa(o),o=o.return;while(o);var c=a}catch(d){c=`
Error generating stack: `+d.message+`
`+d.stack}return{value:s,source:e,stack:c,digest:null}}function Ki(s,e,a){return{value:s,source:null,stack:a??null,digest:e??null}}function Li(s,e){try{console.error(e.value)}catch(a){setTimeout(function(){throw a})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(s,e,a){a=mh(-1,a),a.tag=3,a.payload={element:null};var o=e.value;return a.callback=function(){Oi||(Oi=!0,Pi=o),Li(s,e)},a}function Qi(s,e,a){a=mh(-1,a),a.tag=3;var o=s.type.getDerivedStateFromError;if(typeof o=="function"){var c=e.value;a.payload=function(){return o(c)},a.callback=function(){Li(s,e)}}var d=s.stateNode;return d!==null&&typeof d.componentDidCatch=="function"&&(a.callback=function(){Li(s,e),typeof o!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var h=e.stack;this.componentDidCatch(e.value,{componentStack:h!==null?h:""})}),a}function Si(s,e,a){var o=s.pingCache;if(o===null){o=s.pingCache=new Mi;var c=new Set;o.set(e,c)}else c=o.get(e),c===void 0&&(c=new Set,o.set(e,c));c.has(a)||(c.add(a),s=Ti.bind(null,s,e,a),e.then(s,s))}function Ui(s){do{var e;if((e=s.tag===13)&&(e=s.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return s;s=s.return}while(s!==null);return null}function Vi(s,e,a,o,c){return s.mode&1?(s.flags|=65536,s.lanes=c,s):(s===e?s.flags|=65536:(s.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(e=mh(-1,1),e.tag=2,nh(a,e,1))),a.lanes|=1),s)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(s,e,a,o){e.child=s===null?Vg(e,null,a,o):Ug(e,s.child,a,o)}function Yi(s,e,a,o,c){a=a.render;var d=e.ref;return ch(e,c),o=Nh(s,e,a,o,d,c),a=Sh(),s!==null&&!dh?(e.updateQueue=s.updateQueue,e.flags&=-2053,s.lanes&=~c,Zi(s,e,c)):(I&&a&&vg(e),e.flags|=1,Xi(s,e,o,c),e.child)}function $i(s,e,a,o,c){if(s===null){var d=a.type;return typeof d=="function"&&!aj(d)&&d.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(e.tag=15,e.type=d,bj(s,e,d,o,c)):(s=Rg(a.type,null,o,e,e.mode,c),s.ref=e.ref,s.return=e,e.child=s)}if(d=s.child,!(s.lanes&c)){var h=d.memoizedProps;if(a=a.compare,a=a!==null?a:Ie,a(h,o)&&s.ref===e.ref)return Zi(s,e,c)}return e.flags|=1,s=Pg(d,o),s.ref=e.ref,s.return=e,e.child=s}function bj(s,e,a,o,c){if(s!==null){var d=s.memoizedProps;if(Ie(d,o)&&s.ref===e.ref)if(dh=!1,e.pendingProps=o=d,(s.lanes&c)!==0)s.flags&131072&&(dh=!0);else return e.lanes=s.lanes,Zi(s,e,c)}return cj(s,e,a,o,c)}function dj(s,e,a){var o=e.pendingProps,c=o.children,d=s!==null?s.memoizedState:null;if(o.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=a;else{if(!(a&1073741824))return s=d!==null?d.baseLanes|a:a,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:s,cachePool:null,transitions:null},e.updateQueue=null,G(ej,fj),fj|=s,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=d!==null?d.baseLanes:a,G(ej,fj),fj|=o}else d!==null?(o=d.baseLanes|a,e.memoizedState=null):o=a,G(ej,fj),fj|=o;return Xi(s,e,c,a),e.child}function gj(s,e){var a=e.ref;(s===null&&a!==null||s!==null&&s.ref!==a)&&(e.flags|=512,e.flags|=2097152)}function cj(s,e,a,o,c){var d=Zf(a)?Xf:H.current;return d=Yf(e,d),ch(e,c),a=Nh(s,e,a,o,d,c),o=Sh(),s!==null&&!dh?(e.updateQueue=s.updateQueue,e.flags&=-2053,s.lanes&=~c,Zi(s,e,c)):(I&&o&&vg(e),e.flags|=1,Xi(s,e,a,c),e.child)}function hj(s,e,a,o,c){if(Zf(a)){var d=!0;cg(e)}else d=!1;if(ch(e,c),e.stateNode===null)ij(s,e),Gi(e,a,o),Ii(e,a,o,c),o=!0;else if(s===null){var h=e.stateNode,g=e.memoizedProps;h.props=g;var _=h.context,b=a.contextType;typeof b=="object"&&b!==null?b=eh(b):(b=Zf(a)?Xf:H.current,b=Yf(e,b));var j=a.getDerivedStateFromProps,$=typeof j=="function"||typeof h.getSnapshotBeforeUpdate=="function";$||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(g!==o||_!==b)&&Hi(e,h,o,b),jh=!1;var _e=e.memoizedState;h.state=_e,qh(e,o,h,c),_=e.memoizedState,g!==o||_e!==_||Wf.current||jh?(typeof j=="function"&&(Di(e,a,j,o),_=e.memoizedState),(g=jh||Fi(e,a,g,o,_e,_,b))?($||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(e.flags|=4194308)):(typeof h.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=o,e.memoizedState=_),h.props=o,h.state=_,h.context=b,o=g):(typeof h.componentDidMount=="function"&&(e.flags|=4194308),o=!1)}else{h=e.stateNode,lh(s,e),g=e.memoizedProps,b=e.type===e.elementType?g:Ci(e.type,g),h.props=b,$=e.pendingProps,_e=h.context,_=a.contextType,typeof _=="object"&&_!==null?_=eh(_):(_=Zf(a)?Xf:H.current,_=Yf(e,_));var tt=a.getDerivedStateFromProps;(j=typeof tt=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(g!==$||_e!==_)&&Hi(e,h,o,_),jh=!1,_e=e.memoizedState,h.state=_e,qh(e,o,h,c);var et=e.memoizedState;g!==$||_e!==et||Wf.current||jh?(typeof tt=="function"&&(Di(e,a,tt,o),et=e.memoizedState),(b=jh||Fi(e,a,b,o,_e,et,_)||!1)?(j||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(o,et,_),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(o,et,_)),typeof h.componentDidUpdate=="function"&&(e.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof h.componentDidUpdate!="function"||g===s.memoizedProps&&_e===s.memoizedState||(e.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||g===s.memoizedProps&&_e===s.memoizedState||(e.flags|=1024),e.memoizedProps=o,e.memoizedState=et),h.props=o,h.state=et,h.context=_,o=b):(typeof h.componentDidUpdate!="function"||g===s.memoizedProps&&_e===s.memoizedState||(e.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||g===s.memoizedProps&&_e===s.memoizedState||(e.flags|=1024),o=!1)}return jj(s,e,a,o,d,c)}function jj(s,e,a,o,c,d){gj(s,e);var h=(e.flags&128)!==0;if(!o&&!h)return c&&dg(e,a,!1),Zi(s,e,d);o=e.stateNode,Wi.current=e;var g=h&&typeof a.getDerivedStateFromError!="function"?null:o.render();return e.flags|=1,s!==null&&h?(e.child=Ug(e,s.child,null,d),e.child=Ug(e,null,g,d)):Xi(s,e,g,d),e.memoizedState=o.state,c&&dg(e,a,!0),e.child}function kj(s){var e=s.stateNode;e.pendingContext?ag(s,e.pendingContext,e.pendingContext!==e.context):e.context&&ag(s,e.context,!1),yh(s,e.containerInfo)}function lj(s,e,a,o,c){return Ig(),Jg(c),e.flags|=256,Xi(s,e,a,o),e.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(s){return{baseLanes:s,cachePool:null,transitions:null}}function oj(s,e,a){var o=e.pendingProps,c=L.current,d=!1,h=(e.flags&128)!==0,g;if((g=h)||(g=s!==null&&s.memoizedState===null?!1:(c&2)!==0),g?(d=!0,e.flags&=-129):(s===null||s.memoizedState!==null)&&(c|=1),G(L,c&1),s===null)return Eg(e),s=e.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(e.mode&1?s.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(h=o.children,s=o.fallback,d?(o=e.mode,d=e.child,h={mode:"hidden",children:h},!(o&1)&&d!==null?(d.childLanes=0,d.pendingProps=h):d=pj(h,o,0,null),s=Tg(s,o,a,null),d.return=e,s.return=e,d.sibling=s,e.child=d,e.child.memoizedState=nj(a),e.memoizedState=mj,s):qj(e,h));if(c=s.memoizedState,c!==null&&(g=c.dehydrated,g!==null))return rj(s,e,h,o,g,c,a);if(d){d=o.fallback,h=e.mode,c=s.child,g=c.sibling;var _={mode:"hidden",children:o.children};return!(h&1)&&e.child!==c?(o=e.child,o.childLanes=0,o.pendingProps=_,e.deletions=null):(o=Pg(c,_),o.subtreeFlags=c.subtreeFlags&14680064),g!==null?d=Pg(g,d):(d=Tg(d,h,a,null),d.flags|=2),d.return=e,o.return=e,o.sibling=d,e.child=o,o=d,d=e.child,h=s.child.memoizedState,h=h===null?nj(a):{baseLanes:h.baseLanes|a,cachePool:null,transitions:h.transitions},d.memoizedState=h,d.childLanes=s.childLanes&~a,e.memoizedState=mj,o}return d=s.child,s=d.sibling,o=Pg(d,{mode:"visible",children:o.children}),!(e.mode&1)&&(o.lanes=a),o.return=e,o.sibling=null,s!==null&&(a=e.deletions,a===null?(e.deletions=[s],e.flags|=16):a.push(s)),e.child=o,e.memoizedState=null,o}function qj(s,e){return e=pj({mode:"visible",children:e},s.mode,0,null),e.return=s,s.child=e}function sj(s,e,a,o){return o!==null&&Jg(o),Ug(e,s.child,null,a),s=qj(e,e.pendingProps.children),s.flags|=2,e.memoizedState=null,s}function rj(s,e,a,o,c,d,h){if(a)return e.flags&256?(e.flags&=-257,o=Ki(Error(p(422))),sj(s,e,h,o)):e.memoizedState!==null?(e.child=s.child,e.flags|=128,null):(d=o.fallback,c=e.mode,o=pj({mode:"visible",children:o.children},c,0,null),d=Tg(d,c,h,null),d.flags|=2,o.return=e,d.return=e,o.sibling=d,e.child=o,e.mode&1&&Ug(e,s.child,null,h),e.child.memoizedState=nj(h),e.memoizedState=mj,d);if(!(e.mode&1))return sj(s,e,h,null);if(c.data==="$!"){if(o=c.nextSibling&&c.nextSibling.dataset,o)var g=o.dgst;return o=g,d=Error(p(419)),o=Ki(d,o,void 0),sj(s,e,h,o)}if(g=(h&s.childLanes)!==0,dh||g){if(o=Q,o!==null){switch(h&-h){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=c&(o.suspendedLanes|h)?0:c,c!==0&&c!==d.retryLane&&(d.retryLane=c,ih(s,c),gi(o,s,c,-1))}return tj(),o=Ki(Error(p(421))),sj(s,e,h,o)}return c.data==="$?"?(e.flags|=128,e.child=s.child,e=uj.bind(null,s),c._reactRetry=e,null):(s=d.treeContext,yg=Lf(c.nextSibling),xg=e,I=!0,zg=null,s!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=s.id,sg=s.overflow,qg=e),e=qj(e,o.children),e.flags|=4096,e)}function vj(s,e,a){s.lanes|=e;var o=s.alternate;o!==null&&(o.lanes|=e),bh(s.return,e,a)}function wj(s,e,a,o,c){var d=s.memoizedState;d===null?s.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:o,tail:a,tailMode:c}:(d.isBackwards=e,d.rendering=null,d.renderingStartTime=0,d.last=o,d.tail=a,d.tailMode=c)}function xj(s,e,a){var o=e.pendingProps,c=o.revealOrder,d=o.tail;if(Xi(s,e,o.children,a),o=L.current,o&2)o=o&1|2,e.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=e.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&vj(s,a,e);else if(s.tag===19)vj(s,a,e);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break e;for(;s.sibling===null;){if(s.return===null||s.return===e)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}o&=1}if(G(L,o),!(e.mode&1))e.memoizedState=null;else switch(c){case"forwards":for(a=e.child,c=null;a!==null;)s=a.alternate,s!==null&&Ch(s)===null&&(c=a),a=a.sibling;a=c,a===null?(c=e.child,e.child=null):(c=a.sibling,a.sibling=null),wj(e,!1,c,a,d);break;case"backwards":for(a=null,c=e.child,e.child=null;c!==null;){if(s=c.alternate,s!==null&&Ch(s)===null){e.child=c;break}s=c.sibling,c.sibling=a,a=c,c=s}wj(e,!0,a,null,d);break;case"together":wj(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ij(s,e){!(e.mode&1)&&s!==null&&(s.alternate=null,e.alternate=null,e.flags|=2)}function Zi(s,e,a){if(s!==null&&(e.dependencies=s.dependencies),rh|=e.lanes,!(a&e.childLanes))return null;if(s!==null&&e.child!==s.child)throw Error(p(153));if(e.child!==null){for(s=e.child,a=Pg(s,s.pendingProps),e.child=a,a.return=e;s.sibling!==null;)s=s.sibling,a=a.sibling=Pg(s,s.pendingProps),a.return=e;a.sibling=null}return e.child}function yj(s,e,a){switch(e.tag){case 3:kj(e),Ig();break;case 5:Ah(e);break;case 1:Zf(e.type)&&cg(e);break;case 4:yh(e,e.stateNode.containerInfo);break;case 10:var o=e.type._context,c=e.memoizedProps.value;G(Wg,o._currentValue),o._currentValue=c;break;case 13:if(o=e.memoizedState,o!==null)return o.dehydrated!==null?(G(L,L.current&1),e.flags|=128,null):a&e.child.childLanes?oj(s,e,a):(G(L,L.current&1),s=Zi(s,e,a),s!==null?s.sibling:null);G(L,L.current&1);break;case 19:if(o=(a&e.childLanes)!==0,s.flags&128){if(o)return xj(s,e,a);e.flags|=128}if(c=e.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),G(L,L.current),o)break;return null;case 22:case 23:return e.lanes=0,dj(s,e,a)}return Zi(s,e,a)}var zj,Aj,Bj,Cj;zj=function(s,e){for(var a=e.child;a!==null;){if(a.tag===5||a.tag===6)s.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break;for(;a.sibling===null;){if(a.return===null||a.return===e)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};Aj=function(){};Bj=function(s,e,a,o){var c=s.memoizedProps;if(c!==o){s=e.stateNode,xh(uh.current);var d=null;switch(a){case"input":c=Ya(s,c),o=Ya(s,o),d=[];break;case"select":c=A({},c,{value:void 0}),o=A({},o,{value:void 0}),d=[];break;case"textarea":c=gb(s,c),o=gb(s,o),d=[];break;default:typeof c.onClick!="function"&&typeof o.onClick=="function"&&(s.onclick=Bf)}ub(a,o);var h;a=null;for(b in c)if(!o.hasOwnProperty(b)&&c.hasOwnProperty(b)&&c[b]!=null)if(b==="style"){var g=c[b];for(h in g)g.hasOwnProperty(h)&&(a||(a={}),a[h]="")}else b!=="dangerouslySetInnerHTML"&&b!=="children"&&b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(ea.hasOwnProperty(b)?d||(d=[]):(d=d||[]).push(b,null));for(b in o){var _=o[b];if(g=c!=null?c[b]:void 0,o.hasOwnProperty(b)&&_!==g&&(_!=null||g!=null))if(b==="style")if(g){for(h in g)!g.hasOwnProperty(h)||_&&_.hasOwnProperty(h)||(a||(a={}),a[h]="");for(h in _)_.hasOwnProperty(h)&&g[h]!==_[h]&&(a||(a={}),a[h]=_[h])}else a||(d||(d=[]),d.push(b,a)),a=_;else b==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,g=g?g.__html:void 0,_!=null&&g!==_&&(d=d||[]).push(b,_)):b==="children"?typeof _!="string"&&typeof _!="number"||(d=d||[]).push(b,""+_):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&(ea.hasOwnProperty(b)?(_!=null&&b==="onScroll"&&D("scroll",s),d||g===_||(d=[])):(d=d||[]).push(b,_))}a&&(d=d||[]).push("style",a);var b=d;(e.updateQueue=b)&&(e.flags|=4)}};Cj=function(s,e,a,o){a!==o&&(e.flags|=4)};function Dj(s,e){if(!I)switch(s.tailMode){case"hidden":e=s.tail;for(var a=null;e!==null;)e.alternate!==null&&(a=e),e=e.sibling;a===null?s.tail=null:a.sibling=null;break;case"collapsed":a=s.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?e||s.tail===null?s.tail=null:s.tail.sibling=null:o.sibling=null}}function S(s){var e=s.alternate!==null&&s.alternate.child===s.child,a=0,o=0;if(e)for(var c=s.child;c!==null;)a|=c.lanes|c.childLanes,o|=c.subtreeFlags&14680064,o|=c.flags&14680064,c.return=s,c=c.sibling;else for(c=s.child;c!==null;)a|=c.lanes|c.childLanes,o|=c.subtreeFlags,o|=c.flags,c.return=s,c=c.sibling;return s.subtreeFlags|=o,s.childLanes=a,e}function Ej(s,e,a){var o=e.pendingProps;switch(wg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(e),null;case 1:return Zf(e.type)&&$f(),S(e),null;case 3:return o=e.stateNode,zh(),E(Wf),E(H),Eh(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(Gg(e)?e.flags|=4:s===null||s.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(s,e),S(e),null;case 5:Bh(e);var c=xh(wh.current);if(a=e.type,s!==null&&e.stateNode!=null)Bj(s,e,a,o,c),s.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!o){if(e.stateNode===null)throw Error(p(166));return S(e),null}if(s=xh(uh.current),Gg(e)){o=e.stateNode,a=e.type;var d=e.memoizedProps;switch(o[Of]=e,o[Pf]=d,s=(e.mode&1)!==0,a){case"dialog":D("cancel",o),D("close",o);break;case"iframe":case"object":case"embed":D("load",o);break;case"video":case"audio":for(c=0;c<lf.length;c++)D(lf[c],o);break;case"source":D("error",o);break;case"img":case"image":case"link":D("error",o),D("load",o);break;case"details":D("toggle",o);break;case"input":Za(o,d),D("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!d.multiple},D("invalid",o);break;case"textarea":hb(o,d),D("invalid",o)}ub(a,d),c=null;for(var h in d)if(d.hasOwnProperty(h)){var g=d[h];h==="children"?typeof g=="string"?o.textContent!==g&&(d.suppressHydrationWarning!==!0&&Af(o.textContent,g,s),c=["children",g]):typeof g=="number"&&o.textContent!==""+g&&(d.suppressHydrationWarning!==!0&&Af(o.textContent,g,s),c=["children",""+g]):ea.hasOwnProperty(h)&&g!=null&&h==="onScroll"&&D("scroll",o)}switch(a){case"input":Va(o),db(o,d,!0);break;case"textarea":Va(o),jb(o);break;case"select":case"option":break;default:typeof d.onClick=="function"&&(o.onclick=Bf)}o=c,e.updateQueue=o,o!==null&&(e.flags|=4)}else{h=c.nodeType===9?c:c.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=kb(a)),s==="http://www.w3.org/1999/xhtml"?a==="script"?(s=h.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof o.is=="string"?s=h.createElement(a,{is:o.is}):(s=h.createElement(a),a==="select"&&(h=s,o.multiple?h.multiple=!0:o.size&&(h.size=o.size))):s=h.createElementNS(s,a),s[Of]=e,s[Pf]=o,zj(s,e,!1,!1),e.stateNode=s;e:{switch(h=vb(a,o),a){case"dialog":D("cancel",s),D("close",s),c=o;break;case"iframe":case"object":case"embed":D("load",s),c=o;break;case"video":case"audio":for(c=0;c<lf.length;c++)D(lf[c],s);c=o;break;case"source":D("error",s),c=o;break;case"img":case"image":case"link":D("error",s),D("load",s),c=o;break;case"details":D("toggle",s),c=o;break;case"input":Za(s,o),c=Ya(s,o),D("invalid",s);break;case"option":c=o;break;case"select":s._wrapperState={wasMultiple:!!o.multiple},c=A({},o,{value:void 0}),D("invalid",s);break;case"textarea":hb(s,o),c=gb(s,o),D("invalid",s);break;default:c=o}ub(a,c),g=c;for(d in g)if(g.hasOwnProperty(d)){var _=g[d];d==="style"?sb(s,_):d==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,_!=null&&nb(s,_)):d==="children"?typeof _=="string"?(a!=="textarea"||_!=="")&&ob(s,_):typeof _=="number"&&ob(s,""+_):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ea.hasOwnProperty(d)?_!=null&&d==="onScroll"&&D("scroll",s):_!=null&&ta(s,d,_,h))}switch(a){case"input":Va(s),db(s,o,!1);break;case"textarea":Va(s),jb(s);break;case"option":o.value!=null&&s.setAttribute("value",""+Sa(o.value));break;case"select":s.multiple=!!o.multiple,d=o.value,d!=null?fb(s,!!o.multiple,d,!1):o.defaultValue!=null&&fb(s,!!o.multiple,o.defaultValue,!0);break;default:typeof c.onClick=="function"&&(s.onclick=Bf)}switch(a){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return S(e),null;case 6:if(s&&e.stateNode!=null)Cj(s,e,s.memoizedProps,o);else{if(typeof o!="string"&&e.stateNode===null)throw Error(p(166));if(a=xh(wh.current),xh(uh.current),Gg(e)){if(o=e.stateNode,a=e.memoizedProps,o[Of]=e,(d=o.nodeValue!==a)&&(s=xg,s!==null))switch(s.tag){case 3:Af(o.nodeValue,a,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Af(o.nodeValue,a,(s.mode&1)!==0)}d&&(e.flags|=4)}else o=(a.nodeType===9?a:a.ownerDocument).createTextNode(o),o[Of]=e,e.stateNode=o}return S(e),null;case 13:if(E(L),o=e.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(I&&yg!==null&&e.mode&1&&!(e.flags&128))Hg(),Ig(),e.flags|=98560,d=!1;else if(d=Gg(e),o!==null&&o.dehydrated!==null){if(s===null){if(!d)throw Error(p(318));if(d=e.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(p(317));d[Of]=e}else Ig(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;S(e),d=!1}else zg!==null&&(Fj(zg),zg=null),d=!0;if(!d)return e.flags&65536?e:null}return e.flags&128?(e.lanes=a,e):(o=o!==null,o!==(s!==null&&s.memoizedState!==null)&&o&&(e.child.flags|=8192,e.mode&1&&(s===null||L.current&1?T===0&&(T=3):tj())),e.updateQueue!==null&&(e.flags|=4),S(e),null);case 4:return zh(),Aj(s,e),s===null&&sf(e.stateNode.containerInfo),S(e),null;case 10:return ah(e.type._context),S(e),null;case 17:return Zf(e.type)&&$f(),S(e),null;case 19:if(E(L),d=e.memoizedState,d===null)return S(e),null;if(o=(e.flags&128)!==0,h=d.rendering,h===null)if(o)Dj(d,!1);else{if(T!==0||s!==null&&s.flags&128)for(s=e.child;s!==null;){if(h=Ch(s),h!==null){for(e.flags|=128,Dj(d,!1),o=h.updateQueue,o!==null&&(e.updateQueue=o,e.flags|=4),e.subtreeFlags=0,o=a,a=e.child;a!==null;)d=a,s=o,d.flags&=14680066,h=d.alternate,h===null?(d.childLanes=0,d.lanes=s,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=h.childLanes,d.lanes=h.lanes,d.child=h.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=h.memoizedProps,d.memoizedState=h.memoizedState,d.updateQueue=h.updateQueue,d.type=h.type,s=h.dependencies,d.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),a=a.sibling;return G(L,L.current&1|2),e.child}s=s.sibling}d.tail!==null&&B()>Gj&&(e.flags|=128,o=!0,Dj(d,!1),e.lanes=4194304)}else{if(!o)if(s=Ch(h),s!==null){if(e.flags|=128,o=!0,a=s.updateQueue,a!==null&&(e.updateQueue=a,e.flags|=4),Dj(d,!0),d.tail===null&&d.tailMode==="hidden"&&!h.alternate&&!I)return S(e),null}else 2*B()-d.renderingStartTime>Gj&&a!==1073741824&&(e.flags|=128,o=!0,Dj(d,!1),e.lanes=4194304);d.isBackwards?(h.sibling=e.child,e.child=h):(a=d.last,a!==null?a.sibling=h:e.child=h,d.last=h)}return d.tail!==null?(e=d.tail,d.rendering=e,d.tail=e.sibling,d.renderingStartTime=B(),e.sibling=null,a=L.current,G(L,o?a&1|2:a&1),e):(S(e),null);case 22:case 23:return Hj(),o=e.memoizedState!==null,s!==null&&s.memoizedState!==null!==o&&(e.flags|=8192),o&&e.mode&1?fj&1073741824&&(S(e),e.subtreeFlags&6&&(e.flags|=8192)):S(e),null;case 24:return null;case 25:return null}throw Error(p(156,e.tag))}function Ij(s,e){switch(wg(e),e.tag){case 1:return Zf(e.type)&&$f(),s=e.flags,s&65536?(e.flags=s&-65537|128,e):null;case 3:return zh(),E(Wf),E(H),Eh(),s=e.flags,s&65536&&!(s&128)?(e.flags=s&-65537|128,e):null;case 5:return Bh(e),null;case 13:if(E(L),s=e.memoizedState,s!==null&&s.dehydrated!==null){if(e.alternate===null)throw Error(p(340));Ig()}return s=e.flags,s&65536?(e.flags=s&-65537|128,e):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(e.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(s,e){var a=s.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(o){W(s,e,o)}else a.current=null}function Mj(s,e,a){try{a()}catch(o){W(s,e,o)}}var Nj=!1;function Oj(s,e){if(Cf=dd,s=Me(),Ne(s)){if("selectionStart"in s)var a={start:s.selectionStart,end:s.selectionEnd};else e:{a=(a=s.ownerDocument)&&a.defaultView||window;var o=a.getSelection&&a.getSelection();if(o&&o.rangeCount!==0){a=o.anchorNode;var c=o.anchorOffset,d=o.focusNode;o=o.focusOffset;try{a.nodeType,d.nodeType}catch{a=null;break e}var h=0,g=-1,_=-1,b=0,j=0,$=s,_e=null;t:for(;;){for(var tt;$!==a||c!==0&&$.nodeType!==3||(g=h+c),$!==d||o!==0&&$.nodeType!==3||(_=h+o),$.nodeType===3&&(h+=$.nodeValue.length),(tt=$.firstChild)!==null;)_e=$,$=tt;for(;;){if($===s)break t;if(_e===a&&++b===c&&(g=h),_e===d&&++j===o&&(_=h),(tt=$.nextSibling)!==null)break;$=_e,_e=$.parentNode}$=tt}a=g===-1||_===-1?null:{start:g,end:_}}else a=null}a=a||{start:0,end:0}}else a=null;for(Df={focusedElem:s,selectionRange:a},dd=!1,V=e;V!==null;)if(e=V,s=e.child,(e.subtreeFlags&1028)!==0&&s!==null)s.return=e,V=s;else for(;V!==null;){e=V;try{var et=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(et!==null){var st=et.memoizedProps,rt=et.memoizedState,nt=e.stateNode,it=nt.getSnapshotBeforeUpdate(e.elementType===e.type?st:Ci(e.type,st),rt);nt.__reactInternalSnapshotBeforeUpdate=it}break;case 3:var at=e.stateNode.containerInfo;at.nodeType===1?at.textContent="":at.nodeType===9&&at.documentElement&&at.removeChild(at.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(dt){W(e,e.return,dt)}if(s=e.sibling,s!==null){s.return=e.return,V=s;break}V=e.return}return et=Nj,Nj=!1,et}function Pj(s,e,a){var o=e.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var c=o=o.next;do{if((c.tag&s)===s){var d=c.destroy;c.destroy=void 0,d!==void 0&&Mj(e,a,d)}c=c.next}while(c!==o)}}function Qj(s,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var a=e=e.next;do{if((a.tag&s)===s){var o=a.create;a.destroy=o()}a=a.next}while(a!==e)}}function Rj(s){var e=s.ref;if(e!==null){var a=s.stateNode;switch(s.tag){case 5:s=a;break;default:s=a}typeof e=="function"?e(s):e.current=s}}function Sj(s){var e=s.alternate;e!==null&&(s.alternate=null,Sj(e)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(e=s.stateNode,e!==null&&(delete e[Of],delete e[Pf],delete e[of],delete e[Qf],delete e[Rf])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Tj(s){return s.tag===5||s.tag===3||s.tag===4}function Uj(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Tj(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Vj(s,e,a){var o=s.tag;if(o===5||o===6)s=s.stateNode,e?a.nodeType===8?a.parentNode.insertBefore(s,e):a.insertBefore(s,e):(a.nodeType===8?(e=a.parentNode,e.insertBefore(s,a)):(e=a,e.appendChild(s)),a=a._reactRootContainer,a!=null||e.onclick!==null||(e.onclick=Bf));else if(o!==4&&(s=s.child,s!==null))for(Vj(s,e,a),s=s.sibling;s!==null;)Vj(s,e,a),s=s.sibling}function Wj(s,e,a){var o=s.tag;if(o===5||o===6)s=s.stateNode,e?a.insertBefore(s,e):a.appendChild(s);else if(o!==4&&(s=s.child,s!==null))for(Wj(s,e,a),s=s.sibling;s!==null;)Wj(s,e,a),s=s.sibling}var X=null,Xj=!1;function Yj(s,e,a){for(a=a.child;a!==null;)Zj(s,e,a),a=a.sibling}function Zj(s,e,a){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,a)}catch{}switch(a.tag){case 5:U||Lj(a,e);case 6:var o=X,c=Xj;X=null,Yj(s,e,a),X=o,Xj=c,X!==null&&(Xj?(s=X,a=a.stateNode,s.nodeType===8?s.parentNode.removeChild(a):s.removeChild(a)):X.removeChild(a.stateNode));break;case 18:X!==null&&(Xj?(s=X,a=a.stateNode,s.nodeType===8?Kf(s.parentNode,a):s.nodeType===1&&Kf(s,a),bd(s)):Kf(X,a.stateNode));break;case 4:o=X,c=Xj,X=a.stateNode.containerInfo,Xj=!0,Yj(s,e,a),X=o,Xj=c;break;case 0:case 11:case 14:case 15:if(!U&&(o=a.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){c=o=o.next;do{var d=c,h=d.destroy;d=d.tag,h!==void 0&&(d&2||d&4)&&Mj(a,e,h),c=c.next}while(c!==o)}Yj(s,e,a);break;case 1:if(!U&&(Lj(a,e),o=a.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=a.memoizedProps,o.state=a.memoizedState,o.componentWillUnmount()}catch(g){W(a,e,g)}Yj(s,e,a);break;case 21:Yj(s,e,a);break;case 22:a.mode&1?(U=(o=U)||a.memoizedState!==null,Yj(s,e,a),U=o):Yj(s,e,a);break;default:Yj(s,e,a)}}function ak(s){var e=s.updateQueue;if(e!==null){s.updateQueue=null;var a=s.stateNode;a===null&&(a=s.stateNode=new Kj),e.forEach(function(o){var c=bk.bind(null,s,o);a.has(o)||(a.add(o),o.then(c,c))})}}function ck(s,e){var a=e.deletions;if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];try{var d=s,h=e,g=h;e:for(;g!==null;){switch(g.tag){case 5:X=g.stateNode,Xj=!1;break e;case 3:X=g.stateNode.containerInfo,Xj=!0;break e;case 4:X=g.stateNode.containerInfo,Xj=!0;break e}g=g.return}if(X===null)throw Error(p(160));Zj(d,h,c),X=null,Xj=!1;var _=c.alternate;_!==null&&(_.return=null),c.return=null}catch(b){W(c,e,b)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)dk(e,s),e=e.sibling}function dk(s,e){var a=s.alternate,o=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(ck(e,s),ek(s),o&4){try{Pj(3,s,s.return),Qj(3,s)}catch(st){W(s,s.return,st)}try{Pj(5,s,s.return)}catch(st){W(s,s.return,st)}}break;case 1:ck(e,s),ek(s),o&512&&a!==null&&Lj(a,a.return);break;case 5:if(ck(e,s),ek(s),o&512&&a!==null&&Lj(a,a.return),s.flags&32){var c=s.stateNode;try{ob(c,"")}catch(st){W(s,s.return,st)}}if(o&4&&(c=s.stateNode,c!=null)){var d=s.memoizedProps,h=a!==null?a.memoizedProps:d,g=s.type,_=s.updateQueue;if(s.updateQueue=null,_!==null)try{g==="input"&&d.type==="radio"&&d.name!=null&&ab(c,d),vb(g,h);var b=vb(g,d);for(h=0;h<_.length;h+=2){var j=_[h],$=_[h+1];j==="style"?sb(c,$):j==="dangerouslySetInnerHTML"?nb(c,$):j==="children"?ob(c,$):ta(c,j,$,b)}switch(g){case"input":bb(c,d);break;case"textarea":ib(c,d);break;case"select":var _e=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!d.multiple;var tt=d.value;tt!=null?fb(c,!!d.multiple,tt,!1):_e!==!!d.multiple&&(d.defaultValue!=null?fb(c,!!d.multiple,d.defaultValue,!0):fb(c,!!d.multiple,d.multiple?[]:"",!1))}c[Pf]=d}catch(st){W(s,s.return,st)}}break;case 6:if(ck(e,s),ek(s),o&4){if(s.stateNode===null)throw Error(p(162));c=s.stateNode,d=s.memoizedProps;try{c.nodeValue=d}catch(st){W(s,s.return,st)}}break;case 3:if(ck(e,s),ek(s),o&4&&a!==null&&a.memoizedState.isDehydrated)try{bd(e.containerInfo)}catch(st){W(s,s.return,st)}break;case 4:ck(e,s),ek(s);break;case 13:ck(e,s),ek(s),c=s.child,c.flags&8192&&(d=c.memoizedState!==null,c.stateNode.isHidden=d,!d||c.alternate!==null&&c.alternate.memoizedState!==null||(fk=B())),o&4&&ak(s);break;case 22:if(j=a!==null&&a.memoizedState!==null,s.mode&1?(U=(b=U)||j,ck(e,s),U=b):ck(e,s),ek(s),o&8192){if(b=s.memoizedState!==null,(s.stateNode.isHidden=b)&&!j&&s.mode&1)for(V=s,j=s.child;j!==null;){for($=V=j;V!==null;){switch(_e=V,tt=_e.child,_e.tag){case 0:case 11:case 14:case 15:Pj(4,_e,_e.return);break;case 1:Lj(_e,_e.return);var et=_e.stateNode;if(typeof et.componentWillUnmount=="function"){o=_e,a=_e.return;try{e=o,et.props=e.memoizedProps,et.state=e.memoizedState,et.componentWillUnmount()}catch(st){W(o,a,st)}}break;case 5:Lj(_e,_e.return);break;case 22:if(_e.memoizedState!==null){gk($);continue}}tt!==null?(tt.return=_e,V=tt):gk($)}j=j.sibling}e:for(j=null,$=s;;){if($.tag===5){if(j===null){j=$;try{c=$.stateNode,b?(d=c.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none"):(g=$.stateNode,_=$.memoizedProps.style,h=_!=null&&_.hasOwnProperty("display")?_.display:null,g.style.display=rb("display",h))}catch(st){W(s,s.return,st)}}}else if($.tag===6){if(j===null)try{$.stateNode.nodeValue=b?"":$.memoizedProps}catch(st){W(s,s.return,st)}}else if(($.tag!==22&&$.tag!==23||$.memoizedState===null||$===s)&&$.child!==null){$.child.return=$,$=$.child;continue}if($===s)break e;for(;$.sibling===null;){if($.return===null||$.return===s)break e;j===$&&(j=null),$=$.return}j===$&&(j=null),$.sibling.return=$.return,$=$.sibling}}break;case 19:ck(e,s),ek(s),o&4&&ak(s);break;case 21:break;default:ck(e,s),ek(s)}}function ek(s){var e=s.flags;if(e&2){try{e:{for(var a=s.return;a!==null;){if(Tj(a)){var o=a;break e}a=a.return}throw Error(p(160))}switch(o.tag){case 5:var c=o.stateNode;o.flags&32&&(ob(c,""),o.flags&=-33);var d=Uj(s);Wj(s,d,c);break;case 3:case 4:var h=o.stateNode.containerInfo,g=Uj(s);Vj(s,g,h);break;default:throw Error(p(161))}}catch(_){W(s,s.return,_)}s.flags&=-3}e&4096&&(s.flags&=-4097)}function hk(s,e,a){V=s,ik(s)}function ik(s,e,a){for(var o=(s.mode&1)!==0;V!==null;){var c=V,d=c.child;if(c.tag===22&&o){var h=c.memoizedState!==null||Jj;if(!h){var g=c.alternate,_=g!==null&&g.memoizedState!==null||U;g=Jj;var b=U;if(Jj=h,(U=_)&&!b)for(V=c;V!==null;)h=V,_=h.child,h.tag===22&&h.memoizedState!==null?jk(c):_!==null?(_.return=h,V=_):jk(c);for(;d!==null;)V=d,ik(d),d=d.sibling;V=c,Jj=g,U=b}kk(s)}else c.subtreeFlags&8772&&d!==null?(d.return=c,V=d):kk(s)}}function kk(s){for(;V!==null;){var e=V;if(e.flags&8772){var a=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:U||Qj(5,e);break;case 1:var o=e.stateNode;if(e.flags&4&&!U)if(a===null)o.componentDidMount();else{var c=e.elementType===e.type?a.memoizedProps:Ci(e.type,a.memoizedProps);o.componentDidUpdate(c,a.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var d=e.updateQueue;d!==null&&sh(e,d,o);break;case 3:var h=e.updateQueue;if(h!==null){if(a=null,e.child!==null)switch(e.child.tag){case 5:a=e.child.stateNode;break;case 1:a=e.child.stateNode}sh(e,h,a)}break;case 5:var g=e.stateNode;if(a===null&&e.flags&4){a=g;var _=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":_.autoFocus&&a.focus();break;case"img":_.src&&(a.src=_.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var b=e.alternate;if(b!==null){var j=b.memoizedState;if(j!==null){var $=j.dehydrated;$!==null&&bd($)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U||e.flags&512&&Rj(e)}catch(_e){W(e,e.return,_e)}}if(e===s){V=null;break}if(a=e.sibling,a!==null){a.return=e.return,V=a;break}V=e.return}}function gk(s){for(;V!==null;){var e=V;if(e===s){V=null;break}var a=e.sibling;if(a!==null){a.return=e.return,V=a;break}V=e.return}}function jk(s){for(;V!==null;){var e=V;try{switch(e.tag){case 0:case 11:case 15:var a=e.return;try{Qj(4,e)}catch(_){W(e,a,_)}break;case 1:var o=e.stateNode;if(typeof o.componentDidMount=="function"){var c=e.return;try{o.componentDidMount()}catch(_){W(e,c,_)}}var d=e.return;try{Rj(e)}catch(_){W(e,d,_)}break;case 5:var h=e.return;try{Rj(e)}catch(_){W(e,h,_)}}}catch(_){W(e,e.return,_)}if(e===s){V=null;break}var g=e.sibling;if(g!==null){g.return=e.return,V=g;break}V=e.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(s){return s.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(s=C,s!==0||(s=window.event,s=s===void 0?16:jd(s.type)),s):1}function gi(s,e,a,o){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(s,a,o),(!(K&2)||s!==Q)&&(s===Q&&(!(K&2)&&(qk|=a),T===4&&Ck(s,Z)),Dk(s,o),a===1&&K===0&&!(e.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(s,e){var a=s.callbackNode;wc(s,e);var o=uc(s,s===Q?Z:0);if(o===0)a!==null&&bc(a),s.callbackNode=null,s.callbackPriority=0;else if(e=o&-o,s.callbackPriority!==e){if(a!=null&&bc(a),e===1)s.tag===0?ig(Ek.bind(null,s)):hg(Ek.bind(null,s)),Jf(function(){!(K&6)&&jg()}),a=null;else{switch(Dc(o)){case 1:a=fc;break;case 4:a=gc;break;case 16:a=hc;break;case 536870912:a=jc;break;default:a=hc}a=Fk(a,Gk.bind(null,s))}s.callbackPriority=e,s.callbackNode=a}}function Gk(s,e){if(Ak=-1,Bk=0,K&6)throw Error(p(327));var a=s.callbackNode;if(Hk()&&s.callbackNode!==a)return null;var o=uc(s,s===Q?Z:0);if(o===0)return null;if(o&30||o&s.expiredLanes||e)e=Ik(s,o);else{e=o;var c=K;K|=2;var d=Jk();(Q!==s||Z!==e)&&(uk=null,Gj=B()+500,Kk(s,e));do try{Lk();break}catch(g){Mk(s,g)}while(!0);$g(),mk.current=d,K=c,Y!==null?e=0:(Q=null,Z=0,e=T)}if(e!==0){if(e===2&&(c=xc(s),c!==0&&(o=c,e=Nk(s,c))),e===1)throw a=pk,Kk(s,0),Ck(s,o),Dk(s,B()),a;if(e===6)Ck(s,o);else{if(c=s.current.alternate,!(o&30)&&!Ok(c)&&(e=Ik(s,o),e===2&&(d=xc(s),d!==0&&(o=d,e=Nk(s,d))),e===1))throw a=pk,Kk(s,0),Ck(s,o),Dk(s,B()),a;switch(s.finishedWork=c,s.finishedLanes=o,e){case 0:case 1:throw Error(p(345));case 2:Pk(s,tk,uk);break;case 3:if(Ck(s,o),(o&130023424)===o&&(e=fk+500-B(),10<e)){if(uc(s,0)!==0)break;if(c=s.suspendedLanes,(c&o)!==o){R(),s.pingedLanes|=s.suspendedLanes&c;break}s.timeoutHandle=Ff(Pk.bind(null,s,tk,uk),e);break}Pk(s,tk,uk);break;case 4:if(Ck(s,o),(o&4194240)===o)break;for(e=s.eventTimes,c=-1;0<o;){var h=31-oc(o);d=1<<h,h=e[h],h>c&&(c=h),o&=~d}if(o=c,o=B()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*lk(o/1960))-o,10<o){s.timeoutHandle=Ff(Pk.bind(null,s,tk,uk),o);break}Pk(s,tk,uk);break;case 5:Pk(s,tk,uk);break;default:throw Error(p(329))}}}return Dk(s,B()),s.callbackNode===a?Gk.bind(null,s):null}function Nk(s,e){var a=sk;return s.current.memoizedState.isDehydrated&&(Kk(s,e).flags|=256),s=Ik(s,e),s!==2&&(e=tk,tk=a,e!==null&&Fj(e)),s}function Fj(s){tk===null?tk=s:tk.push.apply(tk,s)}function Ok(s){for(var e=s;;){if(e.flags&16384){var a=e.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var o=0;o<a.length;o++){var c=a[o],d=c.getSnapshot;c=c.value;try{if(!He(d(),c))return!1}catch{return!1}}}if(a=e.child,e.subtreeFlags&16384&&a!==null)a.return=e,e=a;else{if(e===s)break;for(;e.sibling===null;){if(e.return===null||e.return===s)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ck(s,e){for(e&=~rk,e&=~qk,s.suspendedLanes|=e,s.pingedLanes&=~e,s=s.expirationTimes;0<e;){var a=31-oc(e),o=1<<a;s[a]=-1,e&=~o}}function Ek(s){if(K&6)throw Error(p(327));Hk();var e=uc(s,0);if(!(e&1))return Dk(s,B()),null;var a=Ik(s,e);if(s.tag!==0&&a===2){var o=xc(s);o!==0&&(e=o,a=Nk(s,o))}if(a===1)throw a=pk,Kk(s,0),Ck(s,e),Dk(s,B()),a;if(a===6)throw Error(p(345));return s.finishedWork=s.current.alternate,s.finishedLanes=e,Pk(s,tk,uk),Dk(s,B()),null}function Qk(s,e){var a=K;K|=1;try{return s(e)}finally{K=a,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(s){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var e=K;K|=1;var a=ok.transition,o=C;try{if(ok.transition=null,C=1,s)return s()}finally{C=o,ok.transition=a,K=e,!(K&6)&&jg()}}function Hj(){fj=ej.current,E(ej)}function Kk(s,e){s.finishedWork=null,s.finishedLanes=0;var a=s.timeoutHandle;if(a!==-1&&(s.timeoutHandle=-1,Gf(a)),Y!==null)for(a=Y.return;a!==null;){var o=a;switch(wg(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&$f();break;case 3:zh(),E(Wf),E(H),Eh();break;case 5:Bh(o);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah(o.type._context);break;case 22:case 23:Hj()}a=a.return}if(Q=s,Y=s=Pg(s.current,null),Z=fj=e,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(e=0;e<fh.length;e++)if(a=fh[e],o=a.interleaved,o!==null){a.interleaved=null;var c=o.next,d=a.pending;if(d!==null){var h=d.next;d.next=c,o.next=h}a.pending=o}fh=null}return s}function Mk(s,e){do{var a=Y;try{if($g(),Fh.current=Rh,Ih){for(var o=M.memoizedState;o!==null;){var c=o.queue;c!==null&&(c.pending=null),o=o.next}Ih=!1}if(Hh=0,O=N=M=null,Jh=!1,Kh=0,nk.current=null,a===null||a.return===null){T=1,pk=e,Y=null;break}e:{var d=s,h=a.return,g=a,_=e;if(e=Z,g.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){var b=_,j=g,$=j.tag;if(!(j.mode&1)&&($===0||$===11||$===15)){var _e=j.alternate;_e?(j.updateQueue=_e.updateQueue,j.memoizedState=_e.memoizedState,j.lanes=_e.lanes):(j.updateQueue=null,j.memoizedState=null)}var tt=Ui(h);if(tt!==null){tt.flags&=-257,Vi(tt,h,g,d,e),tt.mode&1&&Si(d,b,e),e=tt,_=b;var et=e.updateQueue;if(et===null){var st=new Set;st.add(_),e.updateQueue=st}else et.add(_);break e}else{if(!(e&1)){Si(d,b,e),tj();break e}_=Error(p(426))}}else if(I&&g.mode&1){var rt=Ui(h);if(rt!==null){!(rt.flags&65536)&&(rt.flags|=256),Vi(rt,h,g,d,e),Jg(Ji(_,g));break e}}d=_=Ji(_,g),T!==4&&(T=2),sk===null?sk=[d]:sk.push(d),d=h;do{switch(d.tag){case 3:d.flags|=65536,e&=-e,d.lanes|=e;var nt=Ni(d,_,e);ph(d,nt);break e;case 1:g=_;var it=d.type,at=d.stateNode;if(!(d.flags&128)&&(typeof it.getDerivedStateFromError=="function"||at!==null&&typeof at.componentDidCatch=="function"&&(Ri===null||!Ri.has(at)))){d.flags|=65536,e&=-e,d.lanes|=e;var dt=Qi(d,g,e);ph(d,dt);break e}}d=d.return}while(d!==null)}Sk(a)}catch(ot){e=ot,Y===a&&a!==null&&(Y=a=a.return);continue}break}while(!0)}function Jk(){var s=mk.current;return mk.current=Rh,s===null?Rh:s}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(s,e){var a=K;K|=2;var o=Jk();(Q!==s||Z!==e)&&(uk=null,Kk(s,e));do try{Tk();break}catch(c){Mk(s,c)}while(!0);if($g(),K=a,mk.current=o,Y!==null)throw Error(p(261));return Q=null,Z=0,T}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc();)Uk(Y)}function Uk(s){var e=Vk(s.alternate,s,fj);s.memoizedProps=s.pendingProps,e===null?Sk(s):Y=e,nk.current=null}function Sk(s){var e=s;do{var a=e.alternate;if(s=e.return,e.flags&32768){if(a=Ij(a,e),a!==null){a.flags&=32767,Y=a;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{T=6,Y=null;return}}else if(a=Ej(a,e,fj),a!==null){Y=a;return}if(e=e.sibling,e!==null){Y=e;return}Y=e=s}while(e!==null);T===0&&(T=5)}function Pk(s,e,a){var o=C,c=ok.transition;try{ok.transition=null,C=1,Wk(s,e,a,o)}finally{ok.transition=c,C=o}return null}function Wk(s,e,a,o){do Hk();while(wk!==null);if(K&6)throw Error(p(327));a=s.finishedWork;var c=s.finishedLanes;if(a===null)return null;if(s.finishedWork=null,s.finishedLanes=0,a===s.current)throw Error(p(177));s.callbackNode=null,s.callbackPriority=0;var d=a.lanes|a.childLanes;if(Bc(s,d),s===Q&&(Y=Q=null,Z=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),d=(a.flags&15990)!==0,a.subtreeFlags&15990||d){d=ok.transition,ok.transition=null;var h=C;C=1;var g=K;K|=4,nk.current=null,Oj(s,a),dk(a,s),Oe(Df),dd=!!Cf,Df=Cf=null,s.current=a,hk(a),dc(),K=g,C=h,ok.transition=d}else s.current=a;if(vk&&(vk=!1,wk=s,xk=c),d=s.pendingLanes,d===0&&(Ri=null),mc(a.stateNode),Dk(s,B()),e!==null)for(o=s.onRecoverableError,a=0;a<e.length;a++)c=e[a],o(c.value,{componentStack:c.stack,digest:c.digest});if(Oi)throw Oi=!1,s=Pi,Pi=null,s;return xk&1&&s.tag!==0&&Hk(),d=s.pendingLanes,d&1?s===zk?yk++:(yk=0,zk=s):yk=0,jg(),null}function Hk(){if(wk!==null){var s=Dc(xk),e=ok.transition,a=C;try{if(ok.transition=null,C=16>s?16:s,wk===null)var o=!1;else{if(s=wk,wk=null,xk=0,K&6)throw Error(p(331));var c=K;for(K|=4,V=s.current;V!==null;){var d=V,h=d.child;if(V.flags&16){var g=d.deletions;if(g!==null){for(var _=0;_<g.length;_++){var b=g[_];for(V=b;V!==null;){var j=V;switch(j.tag){case 0:case 11:case 15:Pj(8,j,d)}var $=j.child;if($!==null)$.return=j,V=$;else for(;V!==null;){j=V;var _e=j.sibling,tt=j.return;if(Sj(j),j===b){V=null;break}if(_e!==null){_e.return=tt,V=_e;break}V=tt}}}var et=d.alternate;if(et!==null){var st=et.child;if(st!==null){et.child=null;do{var rt=st.sibling;st.sibling=null,st=rt}while(st!==null)}}V=d}}if(d.subtreeFlags&2064&&h!==null)h.return=d,V=h;else e:for(;V!==null;){if(d=V,d.flags&2048)switch(d.tag){case 0:case 11:case 15:Pj(9,d,d.return)}var nt=d.sibling;if(nt!==null){nt.return=d.return,V=nt;break e}V=d.return}}var it=s.current;for(V=it;V!==null;){h=V;var at=h.child;if(h.subtreeFlags&2064&&at!==null)at.return=h,V=at;else e:for(h=it;V!==null;){if(g=V,g.flags&2048)try{switch(g.tag){case 0:case 11:case 15:Qj(9,g)}}catch(ot){W(g,g.return,ot)}if(g===h){V=null;break e}var dt=g.sibling;if(dt!==null){dt.return=g.return,V=dt;break e}V=g.return}}if(K=c,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,s)}catch{}o=!0}return o}finally{C=a,ok.transition=e}}return!1}function Xk(s,e,a){e=Ji(a,e),e=Ni(s,e,1),s=nh(s,e,1),e=R(),s!==null&&(Ac(s,1,e),Dk(s,e))}function W(s,e,a){if(s.tag===3)Xk(s,s,a);else for(;e!==null;){if(e.tag===3){Xk(e,s,a);break}else if(e.tag===1){var o=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Ri===null||!Ri.has(o))){s=Ji(a,s),s=Qi(e,s,1),e=nh(e,s,1),s=R(),e!==null&&(Ac(e,1,s),Dk(e,s));break}}e=e.return}}function Ti(s,e,a){var o=s.pingCache;o!==null&&o.delete(e),e=R(),s.pingedLanes|=s.suspendedLanes&a,Q===s&&(Z&a)===a&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(s,0):rk|=a),Dk(s,e)}function Yk(s,e){e===0&&(s.mode&1?(e=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):e=1);var a=R();s=ih(s,e),s!==null&&(Ac(s,e,a),Dk(s,a))}function uj(s){var e=s.memoizedState,a=0;e!==null&&(a=e.retryLane),Yk(s,a)}function bk(s,e){var a=0;switch(s.tag){case 13:var o=s.stateNode,c=s.memoizedState;c!==null&&(a=c.retryLane);break;case 19:o=s.stateNode;break;default:throw Error(p(314))}o!==null&&o.delete(e),Yk(s,a)}var Vk;Vk=function(s,e,a){if(s!==null)if(s.memoizedProps!==e.pendingProps||Wf.current)dh=!0;else{if(!(s.lanes&a)&&!(e.flags&128))return dh=!1,yj(s,e,a);dh=!!(s.flags&131072)}else dh=!1,I&&e.flags&1048576&&ug(e,ng,e.index);switch(e.lanes=0,e.tag){case 2:var o=e.type;ij(s,e),s=e.pendingProps;var c=Yf(e,H.current);ch(e,a),c=Nh(null,e,o,s,c,a);var d=Sh();return e.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Zf(o)?(d=!0,cg(e)):d=!1,e.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,kh(e),c.updater=Ei,e.stateNode=c,c._reactInternals=e,Ii(e,o,s,a),e=jj(null,e,o,!0,d,a)):(e.tag=0,I&&d&&vg(e),Xi(null,e,c,a),e=e.child),e;case 16:o=e.elementType;e:{switch(ij(s,e),s=e.pendingProps,c=o._init,o=c(o._payload),e.type=o,c=e.tag=Zk(o),s=Ci(o,s),c){case 0:e=cj(null,e,o,s,a);break e;case 1:e=hj(null,e,o,s,a);break e;case 11:e=Yi(null,e,o,s,a);break e;case 14:e=$i(null,e,o,Ci(o.type,s),a);break e}throw Error(p(306,o,""))}return e;case 0:return o=e.type,c=e.pendingProps,c=e.elementType===o?c:Ci(o,c),cj(s,e,o,c,a);case 1:return o=e.type,c=e.pendingProps,c=e.elementType===o?c:Ci(o,c),hj(s,e,o,c,a);case 3:e:{if(kj(e),s===null)throw Error(p(387));o=e.pendingProps,d=e.memoizedState,c=d.element,lh(s,e),qh(e,o,null,a);var h=e.memoizedState;if(o=h.element,d.isDehydrated)if(d={element:o,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},e.updateQueue.baseState=d,e.memoizedState=d,e.flags&256){c=Ji(Error(p(423)),e),e=lj(s,e,o,a,c);break e}else if(o!==c){c=Ji(Error(p(424)),e),e=lj(s,e,o,a,c);break e}else for(yg=Lf(e.stateNode.containerInfo.firstChild),xg=e,I=!0,zg=null,a=Vg(e,null,o,a),e.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(Ig(),o===c){e=Zi(s,e,a);break e}Xi(s,e,o,a)}e=e.child}return e;case 5:return Ah(e),s===null&&Eg(e),o=e.type,c=e.pendingProps,d=s!==null?s.memoizedProps:null,h=c.children,Ef(o,c)?h=null:d!==null&&Ef(o,d)&&(e.flags|=32),gj(s,e),Xi(s,e,h,a),e.child;case 6:return s===null&&Eg(e),null;case 13:return oj(s,e,a);case 4:return yh(e,e.stateNode.containerInfo),o=e.pendingProps,s===null?e.child=Ug(e,null,o,a):Xi(s,e,o,a),e.child;case 11:return o=e.type,c=e.pendingProps,c=e.elementType===o?c:Ci(o,c),Yi(s,e,o,c,a);case 7:return Xi(s,e,e.pendingProps,a),e.child;case 8:return Xi(s,e,e.pendingProps.children,a),e.child;case 12:return Xi(s,e,e.pendingProps.children,a),e.child;case 10:e:{if(o=e.type._context,c=e.pendingProps,d=e.memoizedProps,h=c.value,G(Wg,o._currentValue),o._currentValue=h,d!==null)if(He(d.value,h)){if(d.children===c.children&&!Wf.current){e=Zi(s,e,a);break e}}else for(d=e.child,d!==null&&(d.return=e);d!==null;){var g=d.dependencies;if(g!==null){h=d.child;for(var _=g.firstContext;_!==null;){if(_.context===o){if(d.tag===1){_=mh(-1,a&-a),_.tag=2;var b=d.updateQueue;if(b!==null){b=b.shared;var j=b.pending;j===null?_.next=_:(_.next=j.next,j.next=_),b.pending=_}}d.lanes|=a,_=d.alternate,_!==null&&(_.lanes|=a),bh(d.return,a,e),g.lanes|=a;break}_=_.next}}else if(d.tag===10)h=d.type===e.type?null:d.child;else if(d.tag===18){if(h=d.return,h===null)throw Error(p(341));h.lanes|=a,g=h.alternate,g!==null&&(g.lanes|=a),bh(h,a,e),h=d.sibling}else h=d.child;if(h!==null)h.return=d;else for(h=d;h!==null;){if(h===e){h=null;break}if(d=h.sibling,d!==null){d.return=h.return,h=d;break}h=h.return}d=h}Xi(s,e,c.children,a),e=e.child}return e;case 9:return c=e.type,o=e.pendingProps.children,ch(e,a),c=eh(c),o=o(c),e.flags|=1,Xi(s,e,o,a),e.child;case 14:return o=e.type,c=Ci(o,e.pendingProps),c=Ci(o.type,c),$i(s,e,o,c,a);case 15:return bj(s,e,e.type,e.pendingProps,a);case 17:return o=e.type,c=e.pendingProps,c=e.elementType===o?c:Ci(o,c),ij(s,e),e.tag=1,Zf(o)?(s=!0,cg(e)):s=!1,ch(e,a),Gi(e,o,c),Ii(e,o,c,a),jj(null,e,o,!0,s,a);case 19:return xj(s,e,a);case 22:return dj(s,e,a)}throw Error(p(156,e.tag))};function Fk(s,e){return ac(s,e)}function $k(s,e,a,o){this.tag=s,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(s,e,a,o){return new $k(s,e,a,o)}function aj(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Zk(s){if(typeof s=="function")return aj(s)?1:0;if(s!=null){if(s=s.$$typeof,s===Da)return 11;if(s===Ga)return 14}return 2}function Pg(s,e){var a=s.alternate;return a===null?(a=Bg(s.tag,e,s.key,s.mode),a.elementType=s.elementType,a.type=s.type,a.stateNode=s.stateNode,a.alternate=s,s.alternate=a):(a.pendingProps=e,a.type=s.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=s.flags&14680064,a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,e=s.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},a.sibling=s.sibling,a.index=s.index,a.ref=s.ref,a}function Rg(s,e,a,o,c,d){var h=2;if(o=s,typeof s=="function")aj(s)&&(h=1);else if(typeof s=="string")h=5;else e:switch(s){case ya:return Tg(a.children,c,d,e);case za:h=8,c|=8;break;case Aa:return s=Bg(12,a,e,c|2),s.elementType=Aa,s.lanes=d,s;case Ea:return s=Bg(13,a,e,c),s.elementType=Ea,s.lanes=d,s;case Fa:return s=Bg(19,a,e,c),s.elementType=Fa,s.lanes=d,s;case Ia:return pj(a,c,d,e);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case Ba:h=10;break e;case Ca:h=9;break e;case Da:h=11;break e;case Ga:h=14;break e;case Ha:h=16,o=null;break e}throw Error(p(130,s==null?s:typeof s,""))}return e=Bg(h,a,e,c),e.elementType=s,e.type=o,e.lanes=d,e}function Tg(s,e,a,o){return s=Bg(7,s,o,e),s.lanes=a,s}function pj(s,e,a,o){return s=Bg(22,s,o,e),s.elementType=Ia,s.lanes=a,s.stateNode={isHidden:!1},s}function Qg(s,e,a){return s=Bg(6,s,null,e),s.lanes=a,s}function Sg(s,e,a){return e=Bg(4,s.children!==null?s.children:[],s.key,e),e.lanes=a,e.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},e}function al(s,e,a,o,c){this.tag=e,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=o,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function bl(s,e,a,o,c,d,h,g,_){return s=new al(s,e,a,g,_),e===1?(e=1,d===!0&&(e|=8)):e=0,d=Bg(3,null,null,e),s.current=d,d.stateNode=s,d.memoizedState={element:o,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(d),s}function cl(s,e,a){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:o==null?null:""+o,children:s,containerInfo:e,implementation:a}}function dl(s){if(!s)return Vf;s=s._reactInternals;e:{if(Vb(s)!==s||s.tag!==1)throw Error(p(170));var e=s;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Zf(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(p(171))}if(s.tag===1){var a=s.type;if(Zf(a))return bg(s,a,e)}return e}function el(s,e,a,o,c,d,h,g,_){return s=bl(a,o,!0,s,c,d,h,g,_),s.context=dl(null),a=s.current,o=R(),c=yi(a),d=mh(o,c),d.callback=e??null,nh(a,d,c),s.current.lanes=c,Ac(s,c,o),Dk(s,o),s}function fl(s,e,a,o){var c=e.current,d=R(),h=yi(c);return a=dl(a),e.context===null?e.context=a:e.pendingContext=a,e=mh(d,h),e.payload={element:s},o=o===void 0?null:o,o!==null&&(e.callback=o),s=nh(c,e,h),s!==null&&(gi(s,c,h,d),oh(s,c,h)),h}function gl(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function hl(s,e){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var a=s.retryLane;s.retryLane=a!==0&&a<e?a:e}}function il(s,e){hl(s,e),(s=s.alternate)&&hl(s,e)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(s){console.error(s)};function ll(s){this._internalRoot=s}ml.prototype.render=ll.prototype.render=function(s){var e=this._internalRoot;if(e===null)throw Error(p(409));fl(s,e,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var e=s.containerInfo;Rk(function(){fl(null,s,null,null)}),e[uf]=null}};function ml(s){this._internalRoot=s}ml.prototype.unstable_scheduleHydration=function(s){if(s){var e=Hc();s={blockedOn:null,target:s,priority:e};for(var a=0;a<Qc.length&&e!==0&&e<Qc[a].priority;a++);Qc.splice(a,0,s),a===0&&Vc(s)}};function nl(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function ol(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(s,e,a,o,c){if(c){if(typeof o=="function"){var d=o;o=function(){var b=gl(h);d.call(b)}}var h=el(e,o,s,0,null,!1,!1,"",pl);return s._reactRootContainer=h,s[uf]=h.current,sf(s.nodeType===8?s.parentNode:s),Rk(),h}for(;c=s.lastChild;)s.removeChild(c);if(typeof o=="function"){var g=o;o=function(){var b=gl(_);g.call(b)}}var _=bl(s,0,!1,null,null,!1,!1,"",pl);return s._reactRootContainer=_,s[uf]=_.current,sf(s.nodeType===8?s.parentNode:s),Rk(function(){fl(e,_,a,o)}),_}function rl(s,e,a,o,c){var d=a._reactRootContainer;if(d){var h=d;if(typeof c=="function"){var g=c;c=function(){var _=gl(h);g.call(_)}}fl(e,h,s,c)}else h=ql(a,e,s,c,o);return gl(h)}Ec=function(s){switch(s.tag){case 3:var e=s.stateNode;if(e.current.memoizedState.isDehydrated){var a=tc(e.pendingLanes);a!==0&&(Cc(e,a|1),Dk(e,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var o=ih(s,1);if(o!==null){var c=R();gi(o,s,1,c)}}),il(s,1)}};Fc=function(s){if(s.tag===13){var e=ih(s,134217728);if(e!==null){var a=R();gi(e,s,134217728,a)}il(s,134217728)}};Gc=function(s){if(s.tag===13){var e=yi(s),a=ih(s,e);if(a!==null){var o=R();gi(a,s,e,o)}il(s,e)}};Hc=function(){return C};Ic=function(s,e){var a=C;try{return C=s,e()}finally{C=a}};yb=function(s,e,a){switch(e){case"input":if(bb(s,a),e=a.name,a.type==="radio"&&e!=null){for(a=s;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<a.length;e++){var o=a[e];if(o!==s&&o.form===s.form){var c=Db(o);if(!c)throw Error(p(90));Wa(o),bb(o,c)}}}break;case"textarea":ib(s,a);break;case"select":e=a.value,e!=null&&fb(s,!!a.multiple,e,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=Zb(s),s===null?null:s.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(s,e){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(e))throw Error(p(200));return cl(s,e,null,a)};reactDom_production_min.createRoot=function(s,e){if(!nl(s))throw Error(p(299));var a=!1,o="",c=kl;return e!=null&&(e.unstable_strictMode===!0&&(a=!0),e.identifierPrefix!==void 0&&(o=e.identifierPrefix),e.onRecoverableError!==void 0&&(c=e.onRecoverableError)),e=bl(s,1,!1,null,null,a,!1,o,c),s[uf]=e.current,sf(s.nodeType===8?s.parentNode:s),new ll(e)};reactDom_production_min.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var e=s._reactInternals;if(e===void 0)throw typeof s.render=="function"?Error(p(188)):(s=Object.keys(s).join(","),Error(p(268,s)));return s=Zb(e),s=s===null?null:s.stateNode,s};reactDom_production_min.flushSync=function(s){return Rk(s)};reactDom_production_min.hydrate=function(s,e,a){if(!ol(e))throw Error(p(200));return rl(null,s,e,!0,a)};reactDom_production_min.hydrateRoot=function(s,e,a){if(!nl(s))throw Error(p(405));var o=a!=null&&a.hydratedSources||null,c=!1,d="",h=kl;if(a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onRecoverableError!==void 0&&(h=a.onRecoverableError)),e=el(e,null,s,1,a??null,c,!1,d,h),s[uf]=e.current,sf(s),o)for(s=0;s<o.length;s++)a=o[s],c=a._getVersion,c=c(a._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[a,c]:e.mutableSourceEagerHydrationData.push(a,c);return new ml(e)};reactDom_production_min.render=function(s,e,a){if(!ol(e))throw Error(p(200));return rl(null,s,e,!1,a)};reactDom_production_min.unmountComponentAtNode=function(s){if(!ol(s))throw Error(p(40));return s._reactRootContainer?(Rk(function(){rl(null,null,s,!1,function(){s._reactRootContainer=null,s[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(s,e,a,o){if(!ol(a))throw Error(p(200));if(s==null||s._reactInternals===void 0)throw Error(p(38));return rl(s,e,a,!1,o)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(s){console.error(s)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,createRoot,m=reactDomExports;createRoot=m.createRoot,m.hydrateRoot;/**
 * @remix-run/router v1.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(s[o]=a[o])}return s},_extends$2.apply(this,arguments)}var Action;(function(s){s.Pop="POP",s.Push="PUSH",s.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(s){s===void 0&&(s={});function e(o,c){let{pathname:d,search:h,hash:g}=o.location;return createLocation("",{pathname:d,search:h,hash:g},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function a(o,c){return typeof c=="string"?c:createPath(c)}return getUrlBasedHistory(e,a,null,s)}function invariant(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function warning(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(s,e){return{usr:s.state,key:s.key,idx:e}}function createLocation(s,e,a,o){return a===void 0&&(a=null),_extends$2({pathname:typeof s=="string"?s:s.pathname,search:"",hash:""},typeof e=="string"?parsePath(e):e,{state:a,key:e&&e.key||o||createKey()})}function createPath(s){let{pathname:e="/",search:a="",hash:o=""}=s;return a&&a!=="?"&&(e+=a.charAt(0)==="?"?a:"?"+a),o&&o!=="#"&&(e+=o.charAt(0)==="#"?o:"#"+o),e}function parsePath(s){let e={};if(s){let a=s.indexOf("#");a>=0&&(e.hash=s.substr(a),s=s.substr(0,a));let o=s.indexOf("?");o>=0&&(e.search=s.substr(o),s=s.substr(0,o)),s&&(e.pathname=s)}return e}function getUrlBasedHistory(s,e,a,o){o===void 0&&(o={});let{window:c=document.defaultView,v5Compat:d=!1}=o,h=c.history,g=Action.Pop,_=null,b=j();b==null&&(b=0,h.replaceState(_extends$2({},h.state,{idx:b}),""));function j(){return(h.state||{idx:null}).idx}function $(){g=Action.Pop;let rt=j(),nt=rt==null?null:rt-b;b=rt,_&&_({action:g,location:st.location,delta:nt})}function _e(rt,nt){g=Action.Push;let it=createLocation(st.location,rt,nt);b=j()+1;let at=getHistoryState(it,b),dt=st.createHref(it);try{h.pushState(at,"",dt)}catch(ot){if(ot instanceof DOMException&&ot.name==="DataCloneError")throw ot;c.location.assign(dt)}d&&_&&_({action:g,location:st.location,delta:1})}function tt(rt,nt){g=Action.Replace;let it=createLocation(st.location,rt,nt);b=j();let at=getHistoryState(it,b),dt=st.createHref(it);h.replaceState(at,"",dt),d&&_&&_({action:g,location:st.location,delta:0})}function et(rt){let nt=c.location.origin!=="null"?c.location.origin:c.location.href,it=typeof rt=="string"?rt:createPath(rt);return it=it.replace(/ $/,"%20"),invariant(nt,"No window.location.(origin|href) available to create URL for href: "+it),new URL(it,nt)}let st={get action(){return g},get location(){return s(c,h)},listen(rt){if(_)throw new Error("A history only accepts one active listener");return c.addEventListener(PopStateEventType,$),_=rt,()=>{c.removeEventListener(PopStateEventType,$),_=null}},createHref(rt){return e(c,rt)},createURL:et,encodeLocation(rt){let nt=et(rt);return{pathname:nt.pathname,search:nt.search,hash:nt.hash}},push:_e,replace:tt,go(rt){return h.go(rt)}};return st}var ResultType;(function(s){s.data="data",s.deferred="deferred",s.redirect="redirect",s.error="error"})(ResultType||(ResultType={}));function matchRoutes(s,e,a){return a===void 0&&(a="/"),matchRoutesImpl(s,e,a)}function matchRoutesImpl(s,e,a,o){let c=typeof e=="string"?parsePath(e):e,d=stripBasename(c.pathname||"/",a);if(d==null)return null;let h=flattenRoutes(s);rankRouteBranches(h);let g=null;for(let _=0;g==null&&_<h.length;++_){let b=decodePath(d);g=matchRouteBranch(h[_],b)}return g}function flattenRoutes(s,e,a,o){e===void 0&&(e=[]),a===void 0&&(a=[]),o===void 0&&(o="");let c=(d,h,g)=>{let _={relativePath:g===void 0?d.path||"":g,caseSensitive:d.caseSensitive===!0,childrenIndex:h,route:d};_.relativePath.startsWith("/")&&(invariant(_.relativePath.startsWith(o),'Absolute route path "'+_.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),_.relativePath=_.relativePath.slice(o.length));let b=joinPaths([o,_.relativePath]),j=a.concat(_);d.children&&d.children.length>0&&(invariant(d.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+b+'".')),flattenRoutes(d.children,e,j,b)),!(d.path==null&&!d.index)&&e.push({path:b,score:computeScore(b,d.index),routesMeta:j})};return s.forEach((d,h)=>{var g;if(d.path===""||!((g=d.path)!=null&&g.includes("?")))c(d,h);else for(let _ of explodeOptionalSegments(d.path))c(d,h,_)}),e}function explodeOptionalSegments(s){let e=s.split("/");if(e.length===0)return[];let[a,...o]=e,c=a.endsWith("?"),d=a.replace(/\?$/,"");if(o.length===0)return c?[d,""]:[d];let h=explodeOptionalSegments(o.join("/")),g=[];return g.push(...h.map(_=>_===""?d:[d,_].join("/"))),c&&g.push(...h),g.map(_=>s.startsWith("/")&&_===""?"/":_)}function rankRouteBranches(s){s.sort((e,a)=>e.score!==a.score?a.score-e.score:compareIndexes(e.routesMeta.map(o=>o.childrenIndex),a.routesMeta.map(o=>o.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=s=>s==="*";function computeScore(s,e){let a=s.split("/"),o=a.length;return a.some(isSplat)&&(o+=splatPenalty),e&&(o+=indexRouteValue),a.filter(c=>!isSplat(c)).reduce((c,d)=>c+(paramRe.test(d)?dynamicSegmentValue:d===""?emptySegmentValue:staticSegmentValue),o)}function compareIndexes(s,e){return s.length===e.length&&s.slice(0,-1).every((o,c)=>o===e[c])?s[s.length-1]-e[e.length-1]:0}function matchRouteBranch(s,e,a){let{routesMeta:o}=s,c={},d="/",h=[];for(let g=0;g<o.length;++g){let _=o[g],b=g===o.length-1,j=d==="/"?e:e.slice(d.length)||"/",$=matchPath({path:_.relativePath,caseSensitive:_.caseSensitive,end:b},j),_e=_.route;if(!$)return null;Object.assign(c,$.params),h.push({params:c,pathname:joinPaths([d,$.pathname]),pathnameBase:normalizePathname(joinPaths([d,$.pathnameBase])),route:_e}),$.pathnameBase!=="/"&&(d=joinPaths([d,$.pathnameBase]))}return h}function matchPath(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[a,o]=compilePath(s.path,s.caseSensitive,s.end),c=e.match(a);if(!c)return null;let d=c[0],h=d.replace(/(.)\/+$/,"$1"),g=c.slice(1);return{params:o.reduce((b,j,$)=>{let{paramName:_e,isOptional:tt}=j;if(_e==="*"){let st=g[$]||"";h=d.slice(0,d.length-st.length).replace(/(.)\/+$/,"$1")}const et=g[$];return tt&&!et?b[_e]=void 0:b[_e]=(et||"").replace(/%2F/g,"/"),b},{}),pathname:d,pathnameBase:h,pattern:s}}function compilePath(s,e,a){e===void 0&&(e=!1),a===void 0&&(a=!0),warning(s==="*"||!s.endsWith("*")||s.endsWith("/*"),'Route path "'+s+'" will be treated as if it were '+('"'+s.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+s.replace(/\*$/,"/*")+'".'));let o=[],c="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,g,_)=>(o.push({paramName:g,isOptional:_!=null}),_?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(o.push({paramName:"*"}),c+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?c+="\\/*$":s!==""&&s!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,e?void 0:"i"),o]}function decodePath(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return warning(!1,'The URL path "'+s+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),s}}function stripBasename(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let a=e.endsWith("/")?e.length-1:e.length,o=s.charAt(a);return o&&o!=="/"?null:s.slice(a)||"/"}function resolvePath(s,e){e===void 0&&(e="/");let{pathname:a,search:o="",hash:c=""}=typeof s=="string"?parsePath(s):s;return{pathname:a?a.startsWith("/")?a:resolvePathname(a,e):e,search:normalizeSearch(o),hash:normalizeHash(c)}}function resolvePathname(s,e){let a=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(c=>{c===".."?a.length>1&&a.pop():c!=="."&&a.push(c)}),a.length>1?a.join("/"):"/"}function getInvalidPathError(s,e,a,o){return"Cannot include a '"+s+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(s){return s.filter((e,a)=>a===0||e.route.path&&e.route.path.length>0)}function getResolveToMatches(s,e){let a=getPathContributingMatches(s);return e?a.map((o,c)=>c===a.length-1?o.pathname:o.pathnameBase):a.map(o=>o.pathnameBase)}function resolveTo(s,e,a,o){o===void 0&&(o=!1);let c;typeof s=="string"?c=parsePath(s):(c=_extends$2({},s),invariant(!c.pathname||!c.pathname.includes("?"),getInvalidPathError("?","pathname","search",c)),invariant(!c.pathname||!c.pathname.includes("#"),getInvalidPathError("#","pathname","hash",c)),invariant(!c.search||!c.search.includes("#"),getInvalidPathError("#","search","hash",c)));let d=s===""||c.pathname==="",h=d?"/":c.pathname,g;if(h==null)g=a;else{let $=e.length-1;if(!o&&h.startsWith("..")){let _e=h.split("/");for(;_e[0]==="..";)_e.shift(),$-=1;c.pathname=_e.join("/")}g=$>=0?e[$]:"/"}let _=resolvePath(c,g),b=h&&h!=="/"&&h.endsWith("/"),j=(d||h===".")&&a.endsWith("/");return!_.pathname.endsWith("/")&&(b||j)&&(_.pathname+="/"),_}const joinPaths=s=>s.join("/").replace(/\/\/+/g,"/"),normalizePathname=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,normalizeHash=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function isRouteErrorResponse(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.29.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(s[o]=a[o])}return s},_extends$1.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useHref(s,e){let{relative:a}=e===void 0?{}:e;useInRouterContext()||invariant(!1);let{basename:o,navigator:c}=reactExports.useContext(NavigationContext),{hash:d,pathname:h,search:g}=useResolvedPath(s,{relative:a}),_=h;return o!=="/"&&(_=h==="/"?o:joinPaths([o,h])),c.createHref({pathname:_,search:g,hash:d})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect(s){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(s)}function useNavigate(){let{isDataRoute:s}=reactExports.useContext(RouteContext);return s?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant(!1);let s=reactExports.useContext(DataRouterContext),{basename:e,future:a,navigator:o}=reactExports.useContext(NavigationContext),{matches:c}=reactExports.useContext(RouteContext),{pathname:d}=useLocation(),h=JSON.stringify(getResolveToMatches(c,a.v7_relativeSplatPath)),g=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{g.current=!0}),reactExports.useCallback(function(b,j){if(j===void 0&&(j={}),!g.current)return;if(typeof b=="number"){o.go(b);return}let $=resolveTo(b,JSON.parse(h),d,j.relative==="path");s==null&&e!=="/"&&($.pathname=$.pathname==="/"?e:joinPaths([e,$.pathname])),(j.replace?o.replace:o.push)($,j.state,j)},[e,o,h,d,s])}function useResolvedPath(s,e){let{relative:a}=e===void 0?{}:e,{future:o}=reactExports.useContext(NavigationContext),{matches:c}=reactExports.useContext(RouteContext),{pathname:d}=useLocation(),h=JSON.stringify(getResolveToMatches(c,o.v7_relativeSplatPath));return reactExports.useMemo(()=>resolveTo(s,JSON.parse(h),d,a==="path"),[s,h,d,a])}function useRoutes(s,e){return useRoutesImpl(s,e)}function useRoutesImpl(s,e,a,o){useInRouterContext()||invariant(!1);let{navigator:c,static:d}=reactExports.useContext(NavigationContext),{matches:h}=reactExports.useContext(RouteContext),g=h[h.length-1],_=g?g.params:{};g&&g.pathname;let b=g?g.pathnameBase:"/";g&&g.route;let j=useLocation(),$;if(e){var _e;let nt=typeof e=="string"?parsePath(e):e;b==="/"||(_e=nt.pathname)!=null&&_e.startsWith(b)||invariant(!1),$=nt}else $=j;let tt=$.pathname||"/",et=tt;if(b!=="/"){let nt=b.replace(/^\//,"").split("/");et="/"+tt.replace(/^\//,"").split("/").slice(nt.length).join("/")}let st=matchRoutes(s,{pathname:et}),rt=_renderMatches(st&&st.map(nt=>Object.assign({},nt,{params:Object.assign({},_,nt.params),pathname:joinPaths([b,c.encodeLocation?c.encodeLocation(nt.pathname).pathname:nt.pathname]),pathnameBase:nt.pathnameBase==="/"?b:joinPaths([b,c.encodeLocation?c.encodeLocation(nt.pathnameBase).pathname:nt.pathnameBase])})),h,a,o);return e&&rt?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$1({pathname:"/",search:"",hash:"",state:null,key:"default"},$),navigationType:Action.Pop}},rt):rt}function DefaultErrorComponent(){let s=useRouteError(),e=isRouteErrorResponse(s)?s.status+" "+s.statusText:s instanceof Error?s.message:JSON.stringify(s),a=s instanceof Error?s.stack:null,c={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},e),a?reactExports.createElement("pre",{style:c},a):null,null)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,a){return a.location!==e.location||a.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:a.error,location:a.location,revalidation:e.revalidation||a.revalidation}}componentDidCatch(e,a){console.error("React Router caught the following error during render",e,a)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(s){let{routeContext:e,match:a,children:o}=s,c=reactExports.useContext(DataRouterContext);return c&&c.static&&c.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(c.staticContext._deepestRenderedBoundaryId=a.route.id),reactExports.createElement(RouteContext.Provider,{value:e},o)}function _renderMatches(s,e,a,o){var c;if(e===void 0&&(e=[]),a===void 0&&(a=null),o===void 0&&(o=null),s==null){var d;if(!a)return null;if(a.errors)s=a.matches;else if((d=o)!=null&&d.v7_partialHydration&&e.length===0&&!a.initialized&&a.matches.length>0)s=a.matches;else return null}let h=s,g=(c=a)==null?void 0:c.errors;if(g!=null){let j=h.findIndex($=>$.route.id&&(g==null?void 0:g[$.route.id])!==void 0);j>=0||invariant(!1),h=h.slice(0,Math.min(h.length,j+1))}let _=!1,b=-1;if(a&&o&&o.v7_partialHydration)for(let j=0;j<h.length;j++){let $=h[j];if(($.route.HydrateFallback||$.route.hydrateFallbackElement)&&(b=j),$.route.id){let{loaderData:_e,errors:tt}=a,et=$.route.loader&&_e[$.route.id]===void 0&&(!tt||tt[$.route.id]===void 0);if($.route.lazy||et){_=!0,b>=0?h=h.slice(0,b+1):h=[h[0]];break}}}return h.reduceRight((j,$,_e)=>{let tt,et=!1,st=null,rt=null;a&&(tt=g&&$.route.id?g[$.route.id]:void 0,st=$.route.errorElement||defaultErrorElement,_&&(b<0&&_e===0?(warningOnce("route-fallback"),et=!0,rt=null):b===_e&&(et=!0,rt=$.route.hydrateFallbackElement||null)));let nt=e.concat(h.slice(0,_e+1)),it=()=>{let at;return tt?at=st:et?at=rt:$.route.Component?at=reactExports.createElement($.route.Component,null):$.route.element?at=$.route.element:at=j,reactExports.createElement(RenderedRoute,{match:$,routeContext:{outlet:j,matches:nt,isDataRoute:a!=null},children:at})};return a&&($.route.ErrorBoundary||$.route.errorElement||_e===0)?reactExports.createElement(RenderErrorBoundary,{location:a.location,revalidation:a.revalidation,component:st,error:tt,children:it(),routeContext:{outlet:null,matches:nt,isDataRoute:!0}}):it()},null)}var DataRouterHook$1=function(s){return s.UseBlocker="useBlocker",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s}(DataRouterHook$1||{}),DataRouterStateHook$1=function(s){return s.UseBlocker="useBlocker",s.UseLoaderData="useLoaderData",s.UseActionData="useActionData",s.UseRouteError="useRouteError",s.UseNavigation="useNavigation",s.UseRouteLoaderData="useRouteLoaderData",s.UseMatches="useMatches",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s.UseRouteId="useRouteId",s}(DataRouterStateHook$1||{});function useDataRouterContext(s){let e=reactExports.useContext(DataRouterContext);return e||invariant(!1),e}function useDataRouterState(s){let e=reactExports.useContext(DataRouterStateContext);return e||invariant(!1),e}function useRouteContext(s){let e=reactExports.useContext(RouteContext);return e||invariant(!1),e}function useCurrentRouteId(s){let e=useRouteContext(),a=e.matches[e.matches.length-1];return a.route.id||invariant(!1),a.route.id}function useRouteError(){var s;let e=reactExports.useContext(RouteErrorContext),a=useDataRouterState(DataRouterStateHook$1.UseRouteError),o=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return e!==void 0?e:(s=a.errors)==null?void 0:s[o]}function useNavigateStable(){let{router:s}=useDataRouterContext(DataRouterHook$1.UseNavigateStable),e=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),a=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{a.current=!0}),reactExports.useCallback(function(c,d){d===void 0&&(d={}),a.current&&(typeof c=="number"?s.navigate(c):s.navigate(c,_extends$1({fromRouteId:e},d)))},[s,e])}const alreadyWarned$1={};function warningOnce(s,e,a){alreadyWarned$1[s]||(alreadyWarned$1[s]=!0)}function logV6DeprecationWarnings(s,e){s==null||s.v7_startTransition,s==null||s.v7_relativeSplatPath}function Navigate(s){let{to:e,replace:a,state:o,relative:c}=s;useInRouterContext()||invariant(!1);let{future:d,static:h}=reactExports.useContext(NavigationContext),{matches:g}=reactExports.useContext(RouteContext),{pathname:_}=useLocation(),b=useNavigate(),j=resolveTo(e,getResolveToMatches(g,d.v7_relativeSplatPath),_,c==="path"),$=JSON.stringify(j);return reactExports.useEffect(()=>b(JSON.parse($),{replace:a,state:o,relative:c}),[b,$,c,a,o]),null}function Route(s){invariant(!1)}function Router(s){let{basename:e="/",children:a=null,location:o,navigationType:c=Action.Pop,navigator:d,static:h=!1,future:g}=s;useInRouterContext()&&invariant(!1);let _=e.replace(/^\/*/,"/"),b=reactExports.useMemo(()=>({basename:_,navigator:d,static:h,future:_extends$1({v7_relativeSplatPath:!1},g)}),[_,g,d,h]);typeof o=="string"&&(o=parsePath(o));let{pathname:j="/",search:$="",hash:_e="",state:tt=null,key:et="default"}=o,st=reactExports.useMemo(()=>{let rt=stripBasename(j,_);return rt==null?null:{location:{pathname:rt,search:$,hash:_e,state:tt,key:et},navigationType:c}},[_,j,$,_e,tt,et,c]);return st==null?null:reactExports.createElement(NavigationContext.Provider,{value:b},reactExports.createElement(LocationContext.Provider,{children:a,value:st}))}function Routes(s){let{children:e,location:a}=s;return useRoutes(createRoutesFromChildren(e),a)}new Promise(()=>{});function createRoutesFromChildren(s,e){e===void 0&&(e=[]);let a=[];return reactExports.Children.forEach(s,(o,c)=>{if(!reactExports.isValidElement(o))return;let d=[...e,c];if(o.type===reactExports.Fragment){a.push.apply(a,createRoutesFromChildren(o.props.children,d));return}o.type!==Route&&invariant(!1),!o.props.index||!o.props.children||invariant(!1);let h={id:o.props.id||d.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(h.children=createRoutesFromChildren(o.props.children,d)),a.push(h)}),a}/**
 * React Router DOM v6.29.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends(){return _extends=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(s[o]=a[o])}return s},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(s,e){if(s==null)return{};var a={},o=Object.keys(s),c,d;for(d=0;d<o.length;d++)c=o[d],!(e.indexOf(c)>=0)&&(a[c]=s[c]);return a}function isModifiedEvent(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function shouldProcessLinkClick(s,e){return s.button===0&&(!e||e==="_self")&&!isModifiedEvent(s)}const _excluded=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],REACT_ROUTER_VERSION="6";try{window.__reactRouterVersion=REACT_ROUTER_VERSION}catch{}const START_TRANSITION="startTransition",startTransitionImpl=React$1[START_TRANSITION];function BrowserRouter(s){let{basename:e,children:a,future:o,window:c}=s,d=reactExports.useRef();d.current==null&&(d.current=createBrowserHistory({window:c,v5Compat:!0}));let h=d.current,[g,_]=reactExports.useState({action:h.action,location:h.location}),{v7_startTransition:b}=o||{},j=reactExports.useCallback($=>{b&&startTransitionImpl?startTransitionImpl(()=>_($)):_($)},[_,b]);return reactExports.useLayoutEffect(()=>h.listen(j),[h,j]),reactExports.useEffect(()=>logV6DeprecationWarnings(o),[o]),reactExports.createElement(Router,{basename:e,children:a,location:g.location,navigationType:g.action,navigator:h,future:o})}const isBrowser$2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function(e,a){let{onClick:o,relative:c,reloadDocument:d,replace:h,state:g,target:_,to:b,preventScrollReset:j,viewTransition:$}=e,_e=_objectWithoutPropertiesLoose(e,_excluded),{basename:tt}=reactExports.useContext(NavigationContext),et,st=!1;if(typeof b=="string"&&ABSOLUTE_URL_REGEX.test(b)&&(et=b,isBrowser$2))try{let at=new URL(window.location.href),dt=b.startsWith("//")?new URL(at.protocol+b):new URL(b),ot=stripBasename(dt.pathname,tt);dt.origin===at.origin&&ot!=null?b=ot+dt.search+dt.hash:st=!0}catch{}let rt=useHref(b,{relative:c}),nt=useLinkClickHandler(b,{replace:h,state:g,target:_,preventScrollReset:j,relative:c,viewTransition:$});function it(at){o&&o(at),at.defaultPrevented||nt(at)}return reactExports.createElement("a",_extends({},_e,{href:et||rt,onClick:st||d?o:it,ref:a,target:_}))});var DataRouterHook;(function(s){s.UseScrollRestoration="useScrollRestoration",s.UseSubmit="useSubmit",s.UseSubmitFetcher="useSubmitFetcher",s.UseFetcher="useFetcher",s.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(s){s.UseFetcher="useFetcher",s.UseFetchers="useFetchers",s.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useLinkClickHandler(s,e){let{target:a,replace:o,state:c,preventScrollReset:d,relative:h,viewTransition:g}=e===void 0?{}:e,_=useNavigate(),b=useLocation(),j=useResolvedPath(s,{relative:h});return reactExports.useCallback($=>{if(shouldProcessLinkClick($,a)){$.preventDefault();let _e=o!==void 0?o:createPath(b)===createPath(j);_(s,{replace:_e,state:c,preventScrollReset:d,relative:h,viewTransition:g})}},[b,_,j,o,c,a,s,d,h,g])}const Header=()=>{const s=useLocation(),e=[{name:"Assessment",path:"/terms"},{name:"Teacher Assistant",path:"/teacher-assistant"},{name:"Student Assistant",path:"/student-assistant"}];return jsxRuntimeExports.jsx("header",{children:jsxRuntimeExports.jsx("div",{className:"top-header",children:jsxRuntimeExports.jsxs("div",{className:"header-container",children:[jsxRuntimeExports.jsx(Link,{to:"/",className:"logo-link",children:jsxRuntimeExports.jsx("span",{className:"ontario-text",children:"Ontario"})}),jsxRuntimeExports.jsx("nav",{className:"assistant-nav",children:jsxRuntimeExports.jsx("ul",{className:"nav-list",children:e.map((a,o)=>jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx(Link,{to:a.path,className:s.pathname===a.path?"active":"",children:a.name})},o))})}),jsxRuntimeExports.jsxs("div",{className:"header-right",children:[jsxRuntimeExports.jsx("a",{href:"#francais",className:"language-toggle",children:"Franais"}),jsxRuntimeExports.jsx("button",{className:"sign-in",children:jsxRuntimeExports.jsx("i",{className:"fas fa-user-circle"})}),jsxRuntimeExports.jsx("button",{className:"help-button",children:jsxRuntimeExports.jsx("i",{className:"fas fa-question-circle"})})]})]})})})},Introduction=()=>{const s=useNavigate(),[e,a]=reactExports.useState(!1),[o,c]=reactExports.useState(""),[d,h]=reactExports.useState(""),[g,_]=reactExports.useState(""),[b,j]=reactExports.useState(""),$=[{id:"ontario",name:"Ontario Curriculum"},{id:"common-core",name:"US Common Core Curriculum"},{id:"canadian",name:"Canadian Curriculum"}],_e=[{id:"english",name:"English"},{id:"computer",name:"Computer"},{id:"science",name:"Science"}],tt=[2,3,4,5],et=[2,3,4],st=async()=>{try{a(!0);const rt={curriculum:o,subject:d,grade:g.toString(),numberOfTerms:parseInt(b)};console.log("Sending data:",rt);const nt=await fetch("https://apis.earlyagedevelopment.com/api/lesson-terms/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(rt)});if(!nt.ok)throw new Error("Failed to generate lesson plan");const it=await nt.json();console.log("Received data:",it),localStorage.setItem("lessonPlanData",JSON.stringify({formData:rt,termPlan:it}));const at={curriculum:o,subject:d,grade:g,numberOfTerms:b};localStorage.setItem("selectedProject",JSON.stringify(at)),s("/terms")}catch(rt){console.error("Error:",rt),alert("Failed to generate lesson plan. Please try again.")}finally{a(!1)}};return jsxRuntimeExports.jsx("section",{className:"introduction",children:jsxRuntimeExports.jsx("div",{className:"intro-container",children:jsxRuntimeExports.jsxs("div",{className:"intro-content",children:[jsxRuntimeExports.jsx("h1",{className:"intro-title",children:"Lesson Planning"}),jsxRuntimeExports.jsxs("div",{className:"notification-banner",children:[jsxRuntimeExports.jsx("i",{className:"fas fa-info-circle"}),jsxRuntimeExports.jsx("p",{children:"Through this platform you can make lesson plans by your curriculum"}),jsxRuntimeExports.jsx("button",{className:"close-notification",children:jsxRuntimeExports.jsx("i",{className:"fas fa-times"})})]}),jsxRuntimeExports.jsxs("div",{className:"main-grid",children:[jsxRuntimeExports.jsxs("div",{className:"selection-panel",children:[jsxRuntimeExports.jsxs("div",{className:"section-title",children:[jsxRuntimeExports.jsx("h2",{children:"Create Your Lesson Plan"}),jsxRuntimeExports.jsx("div",{className:"title-underline"}),jsxRuntimeExports.jsx("p",{className:"section-subtitle",children:"Select your preferences to get started"})]}),jsxRuntimeExports.jsxs("div",{className:"selection-steps",children:[jsxRuntimeExports.jsxs("div",{className:"selection-step",children:[jsxRuntimeExports.jsxs("h3",{children:[jsxRuntimeExports.jsx("span",{children:"1"}),"Select Curriculum"]}),jsxRuntimeExports.jsx("div",{className:"options-grid",children:$.map(rt=>jsxRuntimeExports.jsxs("button",{className:`option-card ${o===rt.id?"selected":""}`,onClick:()=>c(rt.id),children:[jsxRuntimeExports.jsx("div",{className:"option-icon",children:jsxRuntimeExports.jsx("i",{className:"fas fa-book"})}),jsxRuntimeExports.jsx("span",{children:rt.name})]},rt.id))})]}),jsxRuntimeExports.jsxs("div",{className:"selection-step",children:[jsxRuntimeExports.jsxs("h3",{children:[jsxRuntimeExports.jsx("span",{children:"2"}),"Select Subject"]}),jsxRuntimeExports.jsx("div",{className:"options-grid",children:_e.map(rt=>jsxRuntimeExports.jsxs("button",{className:`option-card ${d===rt.id?"selected":""}`,onClick:()=>h(rt.id),children:[jsxRuntimeExports.jsx("div",{className:"option-icon",children:jsxRuntimeExports.jsx("i",{className:`fas fa-${rt.id==="english"?"book-open":rt.id==="computer"?"laptop-code":"flask"}`})}),jsxRuntimeExports.jsx("span",{children:rt.name})]},rt.id))})]}),jsxRuntimeExports.jsxs("div",{className:"selection-step",children:[jsxRuntimeExports.jsxs("h3",{children:[jsxRuntimeExports.jsx("span",{children:"3"}),"Select Grade Level"]}),jsxRuntimeExports.jsx("div",{className:"options-grid",children:tt.map(rt=>jsxRuntimeExports.jsxs("button",{className:`option-card ${g===rt?"selected":""}`,onClick:()=>_(rt),children:[jsxRuntimeExports.jsx("div",{className:"option-icon",children:jsxRuntimeExports.jsx("i",{className:"fas fa-graduation-cap"})}),jsxRuntimeExports.jsxs("span",{children:["Grade ",rt]})]},rt))})]}),jsxRuntimeExports.jsxs("div",{className:"selection-step",children:[jsxRuntimeExports.jsxs("h3",{children:[jsxRuntimeExports.jsx("span",{children:"4"}),"Number of Terms"]}),jsxRuntimeExports.jsx("div",{className:"options-grid",children:et.map(rt=>jsxRuntimeExports.jsxs("button",{className:`option-card ${b===rt?"selected":""}`,onClick:()=>j(rt),children:[jsxRuntimeExports.jsx("div",{className:"option-icon",children:jsxRuntimeExports.jsx("i",{className:"fas fa-calendar-alt"})}),jsxRuntimeExports.jsxs("span",{children:[rt," Terms"]})]},rt))})]})]}),jsxRuntimeExports.jsx("div",{className:"selection-actions",children:jsxRuntimeExports.jsx("button",{className:`generate-button ${o&&d&&g&&b?"active":"disabled"}`,disabled:!o||!d||!g||!b||e,onClick:st,children:e?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("i",{className:"fas fa-spinner fa-spin"}),"Generating..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["Generate Curriculum Plan",jsxRuntimeExports.jsx("i",{className:"fas fa-arrow-right"})]})})})]}),jsxRuntimeExports.jsxs("div",{className:"features-panel",children:[jsxRuntimeExports.jsx("div",{className:"illustration-container",children:jsxRuntimeExports.jsx("img",{src:new URL("../../assets/images/mango.PNG",import.meta.url).href,alt:"Curriculum illustration showing teachers and students",className:"curriculum-illustration"})}),jsxRuntimeExports.jsxs("div",{className:"features",children:[jsxRuntimeExports.jsxs("div",{className:"feature-card",children:[jsxRuntimeExports.jsx("div",{className:"feature-icon-wrapper",children:jsxRuntimeExports.jsx("i",{className:"fas fa-file-pdf"})}),jsxRuntimeExports.jsx("h3",{children:"Smart PDF Processing"}),jsxRuntimeExports.jsx("p",{children:"Upload curriculum PDFs and let our AI-powered system organize content intelligently"})]}),jsxRuntimeExports.jsxs("div",{className:"feature-card",children:[jsxRuntimeExports.jsx("div",{className:"feature-icon-wrapper",children:jsxRuntimeExports.jsx("i",{className:"fas fa-calendar-alt"})}),jsxRuntimeExports.jsx("h3",{children:"Term Planning"}),jsxRuntimeExports.jsx("p",{children:"Automatically divide curriculum into balanced terms with smart scheduling"})]})]})]})]})]})})})},LessonPlan=()=>{var d;const s=useLocation(),e=useNavigate(),a=(d=s.state)==null?void 0:d.mcqData;if(console.log("Received MCQ Data:",a),!a||!a.mcqs)return jsxRuntimeExports.jsxs("div",{className:"lesson-plan",children:[jsxRuntimeExports.jsx("div",{className:"error-message",children:"No assessment data available. Please go back and start a new assessment."}),jsxRuntimeExports.jsx("button",{onClick:()=>e("/terms"),className:"back-button",children:"Go Back"})]});const c=(h=>{try{return h.split(/Q\d+\./).filter(_=>_.trim()).map(_=>{const b=_.split(`
`).filter(j=>j.trim());return{question:b[0],options:b.slice(1,-1),correctAnswer:b[b.length-1]}})}catch(g){return console.error("Error parsing MCQs:",g),[]}})(a.mcqs);return jsxRuntimeExports.jsxs("div",{className:"lesson-plan",children:[jsxRuntimeExports.jsxs("div",{className:"assessment-header",children:[jsxRuntimeExports.jsx("h2",{children:a.projectName}),jsxRuntimeExports.jsxs("p",{className:"criteria",children:["Assessment Criteria: ",a.assessmentCriteria]})]}),jsxRuntimeExports.jsx("div",{className:"mcq-container",children:c.map((h,g)=>jsxRuntimeExports.jsxs("div",{className:"mcq-question",children:[jsxRuntimeExports.jsxs("h3",{children:["Question ",g+1]}),jsxRuntimeExports.jsxs("div",{className:"question-content",children:[jsxRuntimeExports.jsx("p",{className:"question-text",children:h.question}),h.options.map((_,b)=>jsxRuntimeExports.jsx("p",{className:"option",children:_},b)),jsxRuntimeExports.jsx("div",{className:"correct-answer",children:h.correctAnswer})]})]},g))}),jsxRuntimeExports.jsx("button",{onClick:()=>e("/terms"),className:"back-button",children:"Start New Assessment"})]})},Footer=()=>jsxRuntimeExports.jsx("footer",{className:"footer",children:jsxRuntimeExports.jsxs("div",{className:"footer-container",children:[jsxRuntimeExports.jsxs("div",{className:"footer-grid",children:[jsxRuntimeExports.jsxs("div",{className:"footer-section",children:[jsxRuntimeExports.jsx("h3",{children:"About Ontario Curriculum"}),jsxRuntimeExports.jsx("p",{children:"Empowering educators with modern tools to create, manage, and deliver exceptional learning experiences across Ontario."})]}),jsxRuntimeExports.jsxs("div",{className:"footer-section",children:[jsxRuntimeExports.jsx("h3",{children:"Quick Links"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"#curriculum",children:"Curriculum"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"#assessment",children:"Assessment"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"#resources",children:"Resources"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"#contact",children:"Contact Us"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"footer-section",children:[jsxRuntimeExports.jsx("h3",{children:"Resources"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"#help",children:"Help Center"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"#guides",children:"Teacher Guides"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"#updates",children:"Latest Updates"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"#community",children:"Community"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"footer-section",children:[jsxRuntimeExports.jsx("h3",{children:"Connect With Us"}),jsxRuntimeExports.jsxs("div",{className:"social-links",children:[jsxRuntimeExports.jsx("a",{href:"#twitter","aria-label":"Twitter",children:jsxRuntimeExports.jsx("i",{className:"fab fa-twitter"})}),jsxRuntimeExports.jsx("a",{href:"#linkedin","aria-label":"LinkedIn",children:jsxRuntimeExports.jsx("i",{className:"fab fa-linkedin"})}),jsxRuntimeExports.jsx("a",{href:"#youtube","aria-label":"YouTube",children:jsxRuntimeExports.jsx("i",{className:"fab fa-youtube"})})]}),jsxRuntimeExports.jsxs("div",{className:"newsletter",children:[jsxRuntimeExports.jsx("h4",{children:"Stay Updated"}),jsxRuntimeExports.jsxs("div",{className:"newsletter-input",children:[jsxRuntimeExports.jsx("input",{type:"email",placeholder:"Enter your email"}),jsxRuntimeExports.jsx("button",{type:"button",children:jsxRuntimeExports.jsx("i",{className:"fas fa-paper-plane"})})]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"footer-bottom",children:[jsxRuntimeExports.jsxs("div",{className:"footer-info",children:[jsxRuntimeExports.jsx("p",{children:" 2024 Early Age Development. All rights reserved."}),jsxRuntimeExports.jsxs("div",{className:"footer-links",children:[jsxRuntimeExports.jsx("a",{href:"#privacy",children:"Privacy Policy"}),jsxRuntimeExports.jsx("a",{href:"#terms",children:"Terms of Use"}),jsxRuntimeExports.jsx("a",{href:"#accessibility",children:"Accessibility"})]})]}),jsxRuntimeExports.jsx("div",{className:"ontario-brand",children:jsxRuntimeExports.jsx("span",{className:"ontario-text",children:"Ontario.ca"})})]})]})});function bind(s,e){return function(){return s.apply(e,arguments)}}const{toString}=Object.prototype,{getPrototypeOf:getPrototypeOf$1}=Object,kindOf=(s=>e=>{const a=toString.call(e);return s[a]||(s[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=s=>(s=s.toLowerCase(),e=>kindOf(e)===s),typeOfTest=s=>e=>typeof e===s,{isArray:isArray$1}=Array,isUndefined=typeOfTest("undefined");function isBuffer(s){return s!==null&&!isUndefined(s)&&s.constructor!==null&&!isUndefined(s.constructor)&&isFunction$1(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(s){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(s):e=s&&s.buffer&&isArrayBuffer(s.buffer),e}const isString=typeOfTest("string"),isFunction$1=typeOfTest("function"),isNumber$1=typeOfTest("number"),isObject$1=s=>s!==null&&typeof s=="object",isBoolean=s=>s===!0||s===!1,isPlainObject=s=>{if(kindOf(s)!=="object")return!1;const e=getPrototypeOf$1(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=s=>isObject$1(s)&&isFunction$1(s.pipe),isFormData=s=>{let e;return s&&(typeof FormData=="function"&&s instanceof FormData||isFunction$1(s.append)&&((e=kindOf(s))==="formdata"||e==="object"&&isFunction$1(s.toString)&&s.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),[isReadableStream,isRequest,isResponse,isHeaders]=["ReadableStream","Request","Response","Headers"].map(kindOfTest),trim=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(s,e,{allOwnKeys:a=!1}={}){if(s===null||typeof s>"u")return;let o,c;if(typeof s!="object"&&(s=[s]),isArray$1(s))for(o=0,c=s.length;o<c;o++)e.call(null,s[o],o,s);else{const d=a?Object.getOwnPropertyNames(s):Object.keys(s),h=d.length;let g;for(o=0;o<h;o++)g=d[o],e.call(null,s[g],g,s)}}function findKey(s,e){e=e.toLowerCase();const a=Object.keys(s);let o=a.length,c;for(;o-- >0;)if(c=a[o],e===c.toLowerCase())return c;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=s=>!isUndefined(s)&&s!==_global;function merge$1(){const{caseless:s}=isContextDefined(this)&&this||{},e={},a=(o,c)=>{const d=s&&findKey(e,c)||c;isPlainObject(e[d])&&isPlainObject(o)?e[d]=merge$1(e[d],o):isPlainObject(o)?e[d]=merge$1({},o):isArray$1(o)?e[d]=o.slice():e[d]=o};for(let o=0,c=arguments.length;o<c;o++)arguments[o]&&forEach(arguments[o],a);return e}const extend=(s,e,a,{allOwnKeys:o}={})=>(forEach(e,(c,d)=>{a&&isFunction$1(c)?s[d]=bind(c,a):s[d]=c},{allOwnKeys:o}),s),stripBOM=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),inherits=(s,e,a,o)=>{s.prototype=Object.create(e.prototype,o),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:e.prototype}),a&&Object.assign(s.prototype,a)},toFlatObject=(s,e,a,o)=>{let c,d,h;const g={};if(e=e||{},s==null)return e;do{for(c=Object.getOwnPropertyNames(s),d=c.length;d-- >0;)h=c[d],(!o||o(h,s,e))&&!g[h]&&(e[h]=s[h],g[h]=!0);s=a!==!1&&getPrototypeOf$1(s)}while(s&&(!a||a(s,e))&&s!==Object.prototype);return e},endsWith=(s,e,a)=>{s=String(s),(a===void 0||a>s.length)&&(a=s.length),a-=e.length;const o=s.indexOf(e,a);return o!==-1&&o===a},toArray$1=s=>{if(!s)return null;if(isArray$1(s))return s;let e=s.length;if(!isNumber$1(e))return null;const a=new Array(e);for(;e-- >0;)a[e]=s[e];return a},isTypedArray=(s=>e=>s&&e instanceof s)(typeof Uint8Array<"u"&&getPrototypeOf$1(Uint8Array)),forEachEntry=(s,e)=>{const o=(s&&s[Symbol.iterator]).call(s);let c;for(;(c=o.next())&&!c.done;){const d=c.value;e.call(s,d[0],d[1])}},matchAll=(s,e)=>{let a;const o=[];for(;(a=s.exec(e))!==null;)o.push(a);return o},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,o,c){return o.toUpperCase()+c}),hasOwnProperty$1=(({hasOwnProperty:s})=>(e,a)=>s.call(e,a))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(s,e)=>{const a=Object.getOwnPropertyDescriptors(s),o={};forEach(a,(c,d)=>{let h;(h=e(c,d,s))!==!1&&(o[d]=h||c)}),Object.defineProperties(s,o)},freezeMethods=s=>{reduceDescriptors(s,(e,a)=>{if(isFunction$1(s)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const o=s[a];if(isFunction$1(o)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},toObjectSet=(s,e)=>{const a={},o=c=>{c.forEach(d=>{a[d]=!0})};return isArray$1(s)?o(s):o(String(s).split(e)),a},noop$1=()=>{},toFiniteNumber=(s,e)=>s!=null&&Number.isFinite(s=+s)?s:e,ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(s=16,e=ALPHABET.ALPHA_DIGIT)=>{let a="";const{length:o}=e;for(;s--;)a+=e[Math.random()*o|0];return a};function isSpecCompliantForm(s){return!!(s&&isFunction$1(s.append)&&s[Symbol.toStringTag]==="FormData"&&s[Symbol.iterator])}const toJSONObject=s=>{const e=new Array(10),a=(o,c)=>{if(isObject$1(o)){if(e.indexOf(o)>=0)return;if(!("toJSON"in o)){e[c]=o;const d=isArray$1(o)?[]:{};return forEach(o,(h,g)=>{const _=a(h,c+1);!isUndefined(_)&&(d[g]=_)}),e[c]=void 0,d}}return o};return a(s,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=s=>s&&(isObject$1(s)||isFunction$1(s))&&isFunction$1(s.then)&&isFunction$1(s.catch),_setImmediate=((s,e)=>s?setImmediate:e?((a,o)=>(_global.addEventListener("message",({source:c,data:d})=>{c===_global&&d===a&&o.length&&o.shift()()},!1),c=>{o.push(c),_global.postMessage(a,"*")}))(`axios@${Math.random()}`,[]):a=>setTimeout(a))(typeof setImmediate=="function",isFunction$1(_global.postMessage)),asap=typeof queueMicrotask<"u"?queueMicrotask.bind(_global):typeof process<"u"&&process.nextTick||_setImmediate,utils$1={isArray:isArray$1,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber:isNumber$1,isBoolean,isObject:isObject$1,isPlainObject,isReadableStream,isRequest,isResponse,isHeaders,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction:isFunction$1,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge:merge$1,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray:toArray$1,forEachEntry,matchAll,isHTMLForm,hasOwnProperty:hasOwnProperty$1,hasOwnProp:hasOwnProperty$1,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop:noop$1,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable,setImmediate:_setImmediate,asap};function AxiosError$1(s,e,a,o,c){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",e&&(this.code=e),a&&(this.config=a),o&&(this.request=o),c&&(this.response=c,this.status=c.status?c.status:null)}utils$1.inherits(AxiosError$1,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.status}}});const prototype$1=AxiosError$1.prototype,descriptors$1={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{descriptors$1[s]={value:s}});Object.defineProperties(AxiosError$1,descriptors$1);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError$1.from=(s,e,a,o,c,d)=>{const h=Object.create(prototype$1);return utils$1.toFlatObject(s,h,function(_){return _!==Error.prototype},g=>g!=="isAxiosError"),AxiosError$1.call(h,s.message,e,a,o,c),h.cause=s,h.name=s.name,d&&Object.assign(h,d),h};const httpAdapter=null;function isVisitable(s){return utils$1.isPlainObject(s)||utils$1.isArray(s)}function removeBrackets(s){return utils$1.endsWith(s,"[]")?s.slice(0,-2):s}function renderKey(s,e,a){return s?s.concat(e).map(function(c,d){return c=removeBrackets(c),!a&&d?"["+c+"]":c}).join(a?".":""):e}function isFlatArray(s){return utils$1.isArray(s)&&!s.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(e){return/^is[A-Z]/.test(e)});function toFormData$1(s,e,a){if(!utils$1.isObject(s))throw new TypeError("target must be an object");e=e||new FormData,a=utils$1.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(st,rt){return!utils$1.isUndefined(rt[st])});const o=a.metaTokens,c=a.visitor||j,d=a.dots,h=a.indexes,_=(a.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(e);if(!utils$1.isFunction(c))throw new TypeError("visitor must be a function");function b(et){if(et===null)return"";if(utils$1.isDate(et))return et.toISOString();if(!_&&utils$1.isBlob(et))throw new AxiosError$1("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(et)||utils$1.isTypedArray(et)?_&&typeof Blob=="function"?new Blob([et]):Buffer.from(et):et}function j(et,st,rt){let nt=et;if(et&&!rt&&typeof et=="object"){if(utils$1.endsWith(st,"{}"))st=o?st:st.slice(0,-2),et=JSON.stringify(et);else if(utils$1.isArray(et)&&isFlatArray(et)||(utils$1.isFileList(et)||utils$1.endsWith(st,"[]"))&&(nt=utils$1.toArray(et)))return st=removeBrackets(st),nt.forEach(function(at,dt){!(utils$1.isUndefined(at)||at===null)&&e.append(h===!0?renderKey([st],dt,d):h===null?st:st+"[]",b(at))}),!1}return isVisitable(et)?!0:(e.append(renderKey(rt,st,d),b(et)),!1)}const $=[],_e=Object.assign(predicates,{defaultVisitor:j,convertValue:b,isVisitable});function tt(et,st){if(!utils$1.isUndefined(et)){if($.indexOf(et)!==-1)throw Error("Circular reference detected in "+st.join("."));$.push(et),utils$1.forEach(et,function(nt,it){(!(utils$1.isUndefined(nt)||nt===null)&&c.call(e,nt,utils$1.isString(it)?it.trim():it,st,_e))===!0&&tt(nt,st?st.concat(it):[it])}),$.pop()}}if(!utils$1.isObject(s))throw new TypeError("data must be an object");return tt(s),e}function encode$1(s){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(o){return e[o]})}function AxiosURLSearchParams(s,e){this._pairs=[],s&&toFormData$1(s,this,e)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(e,a){this._pairs.push([e,a])};prototype.toString=function(e){const a=e?function(o){return e.call(this,o,encode$1)}:encode$1;return this._pairs.map(function(c){return a(c[0])+"="+a(c[1])},"").join("&")};function encode(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(s,e,a){if(!e)return s;const o=a&&a.encode||encode;utils$1.isFunction(a)&&(a={serialize:a});const c=a&&a.serialize;let d;if(c?d=c(e,a):d=utils$1.isURLSearchParams(e)?e.toString():new AxiosURLSearchParams(e,a).toString(o),d){const h=s.indexOf("#");h!==-1&&(s=s.slice(0,h)),s+=(s.indexOf("?")===-1?"?":"&")+d}return s}class InterceptorManager{constructor(){this.handlers=[]}use(e,a,o){return this.handlers.push({fulfilled:e,rejected:a,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){utils$1.forEach(this.handlers,function(o){o!==null&&e(o)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$2=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$2,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",_navigator=typeof navigator=="object"&&navigator||void 0,hasStandardBrowserEnv=hasBrowserEnv&&(!_navigator||["ReactNative","NativeScript","NS"].indexOf(_navigator.product)<0),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",origin=hasBrowserEnv&&window.location.href||"http://localhost",utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv,navigator:_navigator,origin},Symbol.toStringTag,{value:"Module"})),platform={...utils,...platform$1};function toURLEncodedForm(s,e){return toFormData$1(s,new platform.classes.URLSearchParams,Object.assign({visitor:function(a,o,c,d){return platform.isNode&&utils$1.isBuffer(a)?(this.append(o,a.toString("base64")),!1):d.defaultVisitor.apply(this,arguments)}},e))}function parsePropPath(s){return utils$1.matchAll(/\w+|\[(\w*)]/g,s).map(e=>e[0]==="[]"?"":e[1]||e[0])}function arrayToObject(s){const e={},a=Object.keys(s);let o;const c=a.length;let d;for(o=0;o<c;o++)d=a[o],e[d]=s[d];return e}function formDataToJSON(s){function e(a,o,c,d){let h=a[d++];if(h==="__proto__")return!0;const g=Number.isFinite(+h),_=d>=a.length;return h=!h&&utils$1.isArray(c)?c.length:h,_?(utils$1.hasOwnProp(c,h)?c[h]=[c[h],o]:c[h]=o,!g):((!c[h]||!utils$1.isObject(c[h]))&&(c[h]=[]),e(a,o,c[h],d)&&utils$1.isArray(c[h])&&(c[h]=arrayToObject(c[h])),!g)}if(utils$1.isFormData(s)&&utils$1.isFunction(s.entries)){const a={};return utils$1.forEachEntry(s,(o,c)=>{e(parsePropPath(o),c,a,0)}),a}return null}function stringifySafely(s,e,a){if(utils$1.isString(s))try{return(e||JSON.parse)(s),utils$1.trim(s)}catch(o){if(o.name!=="SyntaxError")throw o}return(a||JSON.stringify)(s)}const defaults$1={transitional:transitionalDefaults,adapter:["xhr","http","fetch"],transformRequest:[function(e,a){const o=a.getContentType()||"",c=o.indexOf("application/json")>-1,d=utils$1.isObject(e);if(d&&utils$1.isHTMLForm(e)&&(e=new FormData(e)),utils$1.isFormData(e))return c?JSON.stringify(formDataToJSON(e)):e;if(utils$1.isArrayBuffer(e)||utils$1.isBuffer(e)||utils$1.isStream(e)||utils$1.isFile(e)||utils$1.isBlob(e)||utils$1.isReadableStream(e))return e;if(utils$1.isArrayBufferView(e))return e.buffer;if(utils$1.isURLSearchParams(e))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let g;if(d){if(o.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(e,this.formSerializer).toString();if((g=utils$1.isFileList(e))||o.indexOf("multipart/form-data")>-1){const _=this.env&&this.env.FormData;return toFormData$1(g?{"files[]":e}:e,_&&new _,this.formSerializer)}}return d||c?(a.setContentType("application/json",!1),stringifySafely(e)):e}],transformResponse:[function(e){const a=this.transitional||defaults$1.transitional,o=a&&a.forcedJSONParsing,c=this.responseType==="json";if(utils$1.isResponse(e)||utils$1.isReadableStream(e))return e;if(e&&utils$1.isString(e)&&(o&&!this.responseType||c)){const h=!(a&&a.silentJSONParsing)&&c;try{return JSON.parse(e)}catch(g){if(h)throw g.name==="SyntaxError"?AxiosError$1.from(g,AxiosError$1.ERR_BAD_RESPONSE,this,null,this.response):g}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],s=>{defaults$1.headers[s]={}});const ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=s=>{const e={};let a,o,c;return s&&s.split(`
`).forEach(function(h){c=h.indexOf(":"),a=h.substring(0,c).trim().toLowerCase(),o=h.substring(c+1).trim(),!(!a||e[a]&&ignoreDuplicateOf[a])&&(a==="set-cookie"?e[a]?e[a].push(o):e[a]=[o]:e[a]=e[a]?e[a]+", "+o:o)}),e},$internals=Symbol("internals");function normalizeHeader(s){return s&&String(s).trim().toLowerCase()}function normalizeValue(s){return s===!1||s==null?s:utils$1.isArray(s)?s.map(normalizeValue):String(s)}function parseTokens(s){const e=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=a.exec(s);)e[o[1]]=o[2];return e}const isValidHeaderName=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function matchHeaderValue(s,e,a,o,c){if(utils$1.isFunction(o))return o.call(this,e,a);if(c&&(e=a),!!utils$1.isString(e)){if(utils$1.isString(o))return e.indexOf(o)!==-1;if(utils$1.isRegExp(o))return o.test(e)}}function formatHeader(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,a,o)=>a.toUpperCase()+o)}function buildAccessors(s,e){const a=utils$1.toCamelCase(" "+e);["get","set","has"].forEach(o=>{Object.defineProperty(s,o+a,{value:function(c,d,h){return this[o].call(this,e,c,d,h)},configurable:!0})})}let AxiosHeaders$1=class{constructor(e){e&&this.set(e)}set(e,a,o){const c=this;function d(g,_,b){const j=normalizeHeader(_);if(!j)throw new Error("header name must be a non-empty string");const $=utils$1.findKey(c,j);(!$||c[$]===void 0||b===!0||b===void 0&&c[$]!==!1)&&(c[$||_]=normalizeValue(g))}const h=(g,_)=>utils$1.forEach(g,(b,j)=>d(b,j,_));if(utils$1.isPlainObject(e)||e instanceof this.constructor)h(e,a);else if(utils$1.isString(e)&&(e=e.trim())&&!isValidHeaderName(e))h(parseHeaders(e),a);else if(utils$1.isHeaders(e))for(const[g,_]of e.entries())d(_,g,o);else e!=null&&d(a,e,o);return this}get(e,a){if(e=normalizeHeader(e),e){const o=utils$1.findKey(this,e);if(o){const c=this[o];if(!a)return c;if(a===!0)return parseTokens(c);if(utils$1.isFunction(a))return a.call(this,c,o);if(utils$1.isRegExp(a))return a.exec(c);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,a){if(e=normalizeHeader(e),e){const o=utils$1.findKey(this,e);return!!(o&&this[o]!==void 0&&(!a||matchHeaderValue(this,this[o],o,a)))}return!1}delete(e,a){const o=this;let c=!1;function d(h){if(h=normalizeHeader(h),h){const g=utils$1.findKey(o,h);g&&(!a||matchHeaderValue(o,o[g],g,a))&&(delete o[g],c=!0)}}return utils$1.isArray(e)?e.forEach(d):d(e),c}clear(e){const a=Object.keys(this);let o=a.length,c=!1;for(;o--;){const d=a[o];(!e||matchHeaderValue(this,this[d],d,e,!0))&&(delete this[d],c=!0)}return c}normalize(e){const a=this,o={};return utils$1.forEach(this,(c,d)=>{const h=utils$1.findKey(o,d);if(h){a[h]=normalizeValue(c),delete a[d];return}const g=e?formatHeader(d):String(d).trim();g!==d&&delete a[d],a[g]=normalizeValue(c),o[g]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const a=Object.create(null);return utils$1.forEach(this,(o,c)=>{o!=null&&o!==!1&&(a[c]=e&&utils$1.isArray(o)?o.join(", "):o)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,a])=>e+": "+a).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...a){const o=new this(e);return a.forEach(c=>o.set(c)),o}static accessor(e){const o=(this[$internals]=this[$internals]={accessors:{}}).accessors,c=this.prototype;function d(h){const g=normalizeHeader(h);o[g]||(buildAccessors(c,h),o[g]=!0)}return utils$1.isArray(e)?e.forEach(d):d(e),this}};AxiosHeaders$1.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders$1.prototype,({value:s},e)=>{let a=e[0].toUpperCase()+e.slice(1);return{get:()=>s,set(o){this[a]=o}}});utils$1.freezeMethods(AxiosHeaders$1);function transformData(s,e){const a=this||defaults$1,o=e||a,c=AxiosHeaders$1.from(o.headers);let d=o.data;return utils$1.forEach(s,function(g){d=g.call(a,d,c.normalize(),e?e.status:void 0)}),c.normalize(),d}function isCancel$1(s){return!!(s&&s.__CANCEL__)}function CanceledError$1(s,e,a){AxiosError$1.call(this,s??"canceled",AxiosError$1.ERR_CANCELED,e,a),this.name="CanceledError"}utils$1.inherits(CanceledError$1,AxiosError$1,{__CANCEL__:!0});function settle(s,e,a){const o=a.config.validateStatus;!a.status||!o||o(a.status)?s(a):e(new AxiosError$1("Request failed with status code "+a.status,[AxiosError$1.ERR_BAD_REQUEST,AxiosError$1.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}function parseProtocol(s){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return e&&e[1]||""}function speedometer(s,e){s=s||10;const a=new Array(s),o=new Array(s);let c=0,d=0,h;return e=e!==void 0?e:1e3,function(_){const b=Date.now(),j=o[d];h||(h=b),a[c]=_,o[c]=b;let $=d,_e=0;for(;$!==c;)_e+=a[$++],$=$%s;if(c=(c+1)%s,c===d&&(d=(d+1)%s),b-h<e)return;const tt=j&&b-j;return tt?Math.round(_e*1e3/tt):void 0}}function throttle(s,e){let a=0,o=1e3/e,c,d;const h=(b,j=Date.now())=>{a=j,c=null,d&&(clearTimeout(d),d=null),s.apply(null,b)};return[(...b)=>{const j=Date.now(),$=j-a;$>=o?h(b,j):(c=b,d||(d=setTimeout(()=>{d=null,h(c)},o-$)))},()=>c&&h(c)]}const progressEventReducer=(s,e,a=3)=>{let o=0;const c=speedometer(50,250);return throttle(d=>{const h=d.loaded,g=d.lengthComputable?d.total:void 0,_=h-o,b=c(_),j=h<=g;o=h;const $={loaded:h,total:g,progress:g?h/g:void 0,bytes:_,rate:b||void 0,estimated:b&&g&&j?(g-h)/b:void 0,event:d,lengthComputable:g!=null,[e?"download":"upload"]:!0};s($)},a)},progressEventDecorator=(s,e)=>{const a=s!=null;return[o=>e[0]({lengthComputable:a,total:s,loaded:o}),e[1]]},asyncDecorator=s=>(...e)=>utils$1.asap(()=>s(...e)),isURLSameOrigin=platform.hasStandardBrowserEnv?((s,e)=>a=>(a=new URL(a,platform.origin),s.protocol===a.protocol&&s.host===a.host&&(e||s.port===a.port)))(new URL(platform.origin),platform.navigator&&/(msie|trident)/i.test(platform.navigator.userAgent)):()=>!0,cookies=platform.hasStandardBrowserEnv?{write(s,e,a,o,c,d){const h=[s+"="+encodeURIComponent(e)];utils$1.isNumber(a)&&h.push("expires="+new Date(a).toGMTString()),utils$1.isString(o)&&h.push("path="+o),utils$1.isString(c)&&h.push("domain="+c),d===!0&&h.push("secure"),document.cookie=h.join("; ")},read(s){const e=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(s){this.write(s,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL$1(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function combineURLs(s,e){return e?s.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):s}function buildFullPath(s,e){return s&&!isAbsoluteURL$1(e)?combineURLs(s,e):e}const headersToObject=s=>s instanceof AxiosHeaders$1?{...s}:s;function mergeConfig$1(s,e){e=e||{};const a={};function o(b,j,$,_e){return utils$1.isPlainObject(b)&&utils$1.isPlainObject(j)?utils$1.merge.call({caseless:_e},b,j):utils$1.isPlainObject(j)?utils$1.merge({},j):utils$1.isArray(j)?j.slice():j}function c(b,j,$,_e){if(utils$1.isUndefined(j)){if(!utils$1.isUndefined(b))return o(void 0,b,$,_e)}else return o(b,j,$,_e)}function d(b,j){if(!utils$1.isUndefined(j))return o(void 0,j)}function h(b,j){if(utils$1.isUndefined(j)){if(!utils$1.isUndefined(b))return o(void 0,b)}else return o(void 0,j)}function g(b,j,$){if($ in e)return o(b,j);if($ in s)return o(void 0,b)}const _={url:d,method:d,data:d,baseURL:h,transformRequest:h,transformResponse:h,paramsSerializer:h,timeout:h,timeoutMessage:h,withCredentials:h,withXSRFToken:h,adapter:h,responseType:h,xsrfCookieName:h,xsrfHeaderName:h,onUploadProgress:h,onDownloadProgress:h,decompress:h,maxContentLength:h,maxBodyLength:h,beforeRedirect:h,transport:h,httpAgent:h,httpsAgent:h,cancelToken:h,socketPath:h,responseEncoding:h,validateStatus:g,headers:(b,j,$)=>c(headersToObject(b),headersToObject(j),$,!0)};return utils$1.forEach(Object.keys(Object.assign({},s,e)),function(j){const $=_[j]||c,_e=$(s[j],e[j],j);utils$1.isUndefined(_e)&&$!==g||(a[j]=_e)}),a}const resolveConfig=s=>{const e=mergeConfig$1({},s);let{data:a,withXSRFToken:o,xsrfHeaderName:c,xsrfCookieName:d,headers:h,auth:g}=e;e.headers=h=AxiosHeaders$1.from(h),e.url=buildURL(buildFullPath(e.baseURL,e.url),s.params,s.paramsSerializer),g&&h.set("Authorization","Basic "+btoa((g.username||"")+":"+(g.password?unescape(encodeURIComponent(g.password)):"")));let _;if(utils$1.isFormData(a)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)h.setContentType(void 0);else if((_=h.getContentType())!==!1){const[b,...j]=_?_.split(";").map($=>$.trim()).filter(Boolean):[];h.setContentType([b||"multipart/form-data",...j].join("; "))}}if(platform.hasStandardBrowserEnv&&(o&&utils$1.isFunction(o)&&(o=o(e)),o||o!==!1&&isURLSameOrigin(e.url))){const b=c&&d&&cookies.read(d);b&&h.set(c,b)}return e},isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(s){return new Promise(function(a,o){const c=resolveConfig(s);let d=c.data;const h=AxiosHeaders$1.from(c.headers).normalize();let{responseType:g,onUploadProgress:_,onDownloadProgress:b}=c,j,$,_e,tt,et;function st(){tt&&tt(),et&&et(),c.cancelToken&&c.cancelToken.unsubscribe(j),c.signal&&c.signal.removeEventListener("abort",j)}let rt=new XMLHttpRequest;rt.open(c.method.toUpperCase(),c.url,!0),rt.timeout=c.timeout;function nt(){if(!rt)return;const at=AxiosHeaders$1.from("getAllResponseHeaders"in rt&&rt.getAllResponseHeaders()),ot={data:!g||g==="text"||g==="json"?rt.responseText:rt.response,status:rt.status,statusText:rt.statusText,headers:at,config:s,request:rt};settle(function(ut){a(ut),st()},function(ut){o(ut),st()},ot),rt=null}"onloadend"in rt?rt.onloadend=nt:rt.onreadystatechange=function(){!rt||rt.readyState!==4||rt.status===0&&!(rt.responseURL&&rt.responseURL.indexOf("file:")===0)||setTimeout(nt)},rt.onabort=function(){rt&&(o(new AxiosError$1("Request aborted",AxiosError$1.ECONNABORTED,s,rt)),rt=null)},rt.onerror=function(){o(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,s,rt)),rt=null},rt.ontimeout=function(){let dt=c.timeout?"timeout of "+c.timeout+"ms exceeded":"timeout exceeded";const ot=c.transitional||transitionalDefaults;c.timeoutErrorMessage&&(dt=c.timeoutErrorMessage),o(new AxiosError$1(dt,ot.clarifyTimeoutError?AxiosError$1.ETIMEDOUT:AxiosError$1.ECONNABORTED,s,rt)),rt=null},d===void 0&&h.setContentType(null),"setRequestHeader"in rt&&utils$1.forEach(h.toJSON(),function(dt,ot){rt.setRequestHeader(ot,dt)}),utils$1.isUndefined(c.withCredentials)||(rt.withCredentials=!!c.withCredentials),g&&g!=="json"&&(rt.responseType=c.responseType),b&&([_e,et]=progressEventReducer(b,!0),rt.addEventListener("progress",_e)),_&&rt.upload&&([$,tt]=progressEventReducer(_),rt.upload.addEventListener("progress",$),rt.upload.addEventListener("loadend",tt)),(c.cancelToken||c.signal)&&(j=at=>{rt&&(o(!at||at.type?new CanceledError$1(null,s,rt):at),rt.abort(),rt=null)},c.cancelToken&&c.cancelToken.subscribe(j),c.signal&&(c.signal.aborted?j():c.signal.addEventListener("abort",j)));const it=parseProtocol(c.url);if(it&&platform.protocols.indexOf(it)===-1){o(new AxiosError$1("Unsupported protocol "+it+":",AxiosError$1.ERR_BAD_REQUEST,s));return}rt.send(d||null)})},composeSignals=(s,e)=>{const{length:a}=s=s?s.filter(Boolean):[];if(e||a){let o=new AbortController,c;const d=function(b){if(!c){c=!0,g();const j=b instanceof Error?b:this.reason;o.abort(j instanceof AxiosError$1?j:new CanceledError$1(j instanceof Error?j.message:j))}};let h=e&&setTimeout(()=>{h=null,d(new AxiosError$1(`timeout ${e} of ms exceeded`,AxiosError$1.ETIMEDOUT))},e);const g=()=>{s&&(h&&clearTimeout(h),h=null,s.forEach(b=>{b.unsubscribe?b.unsubscribe(d):b.removeEventListener("abort",d)}),s=null)};s.forEach(b=>b.addEventListener("abort",d));const{signal:_}=o;return _.unsubscribe=()=>utils$1.asap(g),_}},streamChunk=function*(s,e){let a=s.byteLength;if(a<e){yield s;return}let o=0,c;for(;o<a;)c=o+e,yield s.slice(o,c),o=c},readBytes=async function*(s,e){for await(const a of readStream(s))yield*streamChunk(a,e)},readStream=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const e=s.getReader();try{for(;;){const{done:a,value:o}=await e.read();if(a)break;yield o}}finally{await e.cancel()}},trackStream=(s,e,a,o)=>{const c=readBytes(s,e);let d=0,h,g=_=>{h||(h=!0,o&&o(_))};return new ReadableStream({async pull(_){try{const{done:b,value:j}=await c.next();if(b){g(),_.close();return}let $=j.byteLength;if(a){let _e=d+=$;a(_e)}_.enqueue(new Uint8Array(j))}catch(b){throw g(b),b}},cancel(_){return g(_),c.return()}},{highWaterMark:2})},isFetchSupported=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",isReadableStreamSupported=isFetchSupported&&typeof ReadableStream=="function",encodeText=isFetchSupported&&(typeof TextEncoder=="function"?(s=>e=>s.encode(e))(new TextEncoder):async s=>new Uint8Array(await new Response(s).arrayBuffer())),test=(s,...e)=>{try{return!!s(...e)}catch{return!1}},supportsRequestStream=isReadableStreamSupported&&test(()=>{let s=!1;const e=new Request(platform.origin,{body:new ReadableStream,method:"POST",get duplex(){return s=!0,"half"}}).headers.has("Content-Type");return s&&!e}),DEFAULT_CHUNK_SIZE=64*1024,supportsResponseStream=isReadableStreamSupported&&test(()=>utils$1.isReadableStream(new Response("").body)),resolvers={stream:supportsResponseStream&&(s=>s.body)};isFetchSupported&&(s=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!resolvers[e]&&(resolvers[e]=utils$1.isFunction(s[e])?a=>a[e]():(a,o)=>{throw new AxiosError$1(`Response type '${e}' is not supported`,AxiosError$1.ERR_NOT_SUPPORT,o)})})})(new Response);const getBodyLength=async s=>{if(s==null)return 0;if(utils$1.isBlob(s))return s.size;if(utils$1.isSpecCompliantForm(s))return(await new Request(platform.origin,{method:"POST",body:s}).arrayBuffer()).byteLength;if(utils$1.isArrayBufferView(s)||utils$1.isArrayBuffer(s))return s.byteLength;if(utils$1.isURLSearchParams(s)&&(s=s+""),utils$1.isString(s))return(await encodeText(s)).byteLength},resolveBodyLength=async(s,e)=>{const a=utils$1.toFiniteNumber(s.getContentLength());return a??getBodyLength(e)},fetchAdapter=isFetchSupported&&(async s=>{let{url:e,method:a,data:o,signal:c,cancelToken:d,timeout:h,onDownloadProgress:g,onUploadProgress:_,responseType:b,headers:j,withCredentials:$="same-origin",fetchOptions:_e}=resolveConfig(s);b=b?(b+"").toLowerCase():"text";let tt=composeSignals([c,d&&d.toAbortSignal()],h),et;const st=tt&&tt.unsubscribe&&(()=>{tt.unsubscribe()});let rt;try{if(_&&supportsRequestStream&&a!=="get"&&a!=="head"&&(rt=await resolveBodyLength(j,o))!==0){let ot=new Request(e,{method:"POST",body:o,duplex:"half"}),ht;if(utils$1.isFormData(o)&&(ht=ot.headers.get("content-type"))&&j.setContentType(ht),ot.body){const[ut,pt]=progressEventDecorator(rt,progressEventReducer(asyncDecorator(_)));o=trackStream(ot.body,DEFAULT_CHUNK_SIZE,ut,pt)}}utils$1.isString($)||($=$?"include":"omit");const nt="credentials"in Request.prototype;et=new Request(e,{..._e,signal:tt,method:a.toUpperCase(),headers:j.normalize().toJSON(),body:o,duplex:"half",credentials:nt?$:void 0});let it=await fetch(et);const at=supportsResponseStream&&(b==="stream"||b==="response");if(supportsResponseStream&&(g||at&&st)){const ot={};["status","statusText","headers"].forEach(_t=>{ot[_t]=it[_t]});const ht=utils$1.toFiniteNumber(it.headers.get("content-length")),[ut,pt]=g&&progressEventDecorator(ht,progressEventReducer(asyncDecorator(g),!0))||[];it=new Response(trackStream(it.body,DEFAULT_CHUNK_SIZE,ut,()=>{pt&&pt(),st&&st()}),ot)}b=b||"text";let dt=await resolvers[utils$1.findKey(resolvers,b)||"text"](it,s);return!at&&st&&st(),await new Promise((ot,ht)=>{settle(ot,ht,{data:dt,headers:AxiosHeaders$1.from(it.headers),status:it.status,statusText:it.statusText,config:s,request:et})})}catch(nt){throw st&&st(),nt&&nt.name==="TypeError"&&/fetch/i.test(nt.message)?Object.assign(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,s,et),{cause:nt.cause||nt}):AxiosError$1.from(nt,nt&&nt.code,s,et)}}),knownAdapters={http:httpAdapter,xhr:xhrAdapter,fetch:fetchAdapter};utils$1.forEach(knownAdapters,(s,e)=>{if(s){try{Object.defineProperty(s,"name",{value:e})}catch{}Object.defineProperty(s,"adapterName",{value:e})}});const renderReason=s=>`- ${s}`,isResolvedHandle=s=>utils$1.isFunction(s)||s===null||s===!1,adapters$1={getAdapter:s=>{s=utils$1.isArray(s)?s:[s];const{length:e}=s;let a,o;const c={};for(let d=0;d<e;d++){a=s[d];let h;if(o=a,!isResolvedHandle(a)&&(o=knownAdapters[(h=String(a)).toLowerCase()],o===void 0))throw new AxiosError$1(`Unknown adapter '${h}'`);if(o)break;c[h||"#"+d]=o}if(!o){const d=Object.entries(c).map(([g,_])=>`adapter ${g} `+(_===!1?"is not supported by the environment":"is not available in the build"));let h=e?d.length>1?`since :
`+d.map(renderReason).join(`
`):" "+renderReason(d[0]):"as no adapter specified";throw new AxiosError$1("There is no suitable adapter to dispatch the request "+h,"ERR_NOT_SUPPORT")}return o},adapters:knownAdapters};function throwIfCancellationRequested(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new CanceledError$1(null,s)}function dispatchRequest(s){return throwIfCancellationRequested(s),s.headers=AxiosHeaders$1.from(s.headers),s.data=transformData.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),adapters$1.getAdapter(s.adapter||defaults$1.adapter)(s).then(function(o){return throwIfCancellationRequested(s),o.data=transformData.call(s,s.transformResponse,o),o.headers=AxiosHeaders$1.from(o.headers),o},function(o){return isCancel$1(o)||(throwIfCancellationRequested(s),o&&o.response&&(o.response.data=transformData.call(s,s.transformResponse,o.response),o.response.headers=AxiosHeaders$1.from(o.response.headers))),Promise.reject(o)})}const VERSION$2="1.7.9",validators$1={};["object","boolean","number","function","string","symbol"].forEach((s,e)=>{validators$1[s]=function(o){return typeof o===s||"a"+(e<1?"n ":" ")+s}});const deprecatedWarnings={};validators$1.transitional=function(e,a,o){function c(d,h){return"[Axios v"+VERSION$2+"] Transitional option '"+d+"'"+h+(o?". "+o:"")}return(d,h,g)=>{if(e===!1)throw new AxiosError$1(c(h," has been removed"+(a?" in "+a:"")),AxiosError$1.ERR_DEPRECATED);return a&&!deprecatedWarnings[h]&&(deprecatedWarnings[h]=!0,console.warn(c(h," has been deprecated since v"+a+" and will be removed in the near future"))),e?e(d,h,g):!0}};validators$1.spelling=function(e){return(a,o)=>(console.warn(`${o} is likely a misspelling of ${e}`),!0)};function assertOptions(s,e,a){if(typeof s!="object")throw new AxiosError$1("options must be an object",AxiosError$1.ERR_BAD_OPTION_VALUE);const o=Object.keys(s);let c=o.length;for(;c-- >0;){const d=o[c],h=e[d];if(h){const g=s[d],_=g===void 0||h(g,d,s);if(_!==!0)throw new AxiosError$1("option "+d+" must be "+_,AxiosError$1.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new AxiosError$1("Unknown option "+d,AxiosError$1.ERR_BAD_OPTION)}}const validator$1={assertOptions,validators:validators$1},validators=validator$1.validators;let Axios$1=class{constructor(e){this.defaults=e,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(e,a){try{return await this._request(e,a)}catch(o){if(o instanceof Error){let c={};Error.captureStackTrace?Error.captureStackTrace(c):c=new Error;const d=c.stack?c.stack.replace(/^.+\n/,""):"";try{o.stack?d&&!String(o.stack).endsWith(d.replace(/^.+\n.+\n/,""))&&(o.stack+=`
`+d):o.stack=d}catch{}}throw o}}_request(e,a){typeof e=="string"?(a=a||{},a.url=e):a=e||{},a=mergeConfig$1(this.defaults,a);const{transitional:o,paramsSerializer:c,headers:d}=a;o!==void 0&&validator$1.assertOptions(o,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),c!=null&&(utils$1.isFunction(c)?a.paramsSerializer={serialize:c}:validator$1.assertOptions(c,{encode:validators.function,serialize:validators.function},!0)),validator$1.assertOptions(a,{baseUrl:validators.spelling("baseURL"),withXsrfToken:validators.spelling("withXSRFToken")},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();let h=d&&utils$1.merge(d.common,d[a.method]);d&&utils$1.forEach(["delete","get","head","post","put","patch","common"],et=>{delete d[et]}),a.headers=AxiosHeaders$1.concat(h,d);const g=[];let _=!0;this.interceptors.request.forEach(function(st){typeof st.runWhen=="function"&&st.runWhen(a)===!1||(_=_&&st.synchronous,g.unshift(st.fulfilled,st.rejected))});const b=[];this.interceptors.response.forEach(function(st){b.push(st.fulfilled,st.rejected)});let j,$=0,_e;if(!_){const et=[dispatchRequest.bind(this),void 0];for(et.unshift.apply(et,g),et.push.apply(et,b),_e=et.length,j=Promise.resolve(a);$<_e;)j=j.then(et[$++],et[$++]);return j}_e=g.length;let tt=a;for($=0;$<_e;){const et=g[$++],st=g[$++];try{tt=et(tt)}catch(rt){st.call(this,rt);break}}try{j=dispatchRequest.call(this,tt)}catch(et){return Promise.reject(et)}for($=0,_e=b.length;$<_e;)j=j.then(b[$++],b[$++]);return j}getUri(e){e=mergeConfig$1(this.defaults,e);const a=buildFullPath(e.baseURL,e.url);return buildURL(a,e.params,e.paramsSerializer)}};utils$1.forEach(["delete","get","head","options"],function(e){Axios$1.prototype[e]=function(a,o){return this.request(mergeConfig$1(o||{},{method:e,url:a,data:(o||{}).data}))}});utils$1.forEach(["post","put","patch"],function(e){function a(o){return function(d,h,g){return this.request(mergeConfig$1(g||{},{method:e,headers:o?{"Content-Type":"multipart/form-data"}:{},url:d,data:h}))}}Axios$1.prototype[e]=a(),Axios$1.prototype[e+"Form"]=a(!0)});let CancelToken$1=class ms{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(d){a=d});const o=this;this.promise.then(c=>{if(!o._listeners)return;let d=o._listeners.length;for(;d-- >0;)o._listeners[d](c);o._listeners=null}),this.promise.then=c=>{let d;const h=new Promise(g=>{o.subscribe(g),d=g}).then(c);return h.cancel=function(){o.unsubscribe(d)},h},e(function(d,h,g){o.reason||(o.reason=new CanceledError$1(d,h,g),a(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const a=this._listeners.indexOf(e);a!==-1&&this._listeners.splice(a,1)}toAbortSignal(){const e=new AbortController,a=o=>{e.abort(o)};return this.subscribe(a),e.signal.unsubscribe=()=>this.unsubscribe(a),e.signal}static source(){let e;return{token:new ms(function(c){e=c}),cancel:e}}};function spread$1(s){return function(a){return s.apply(null,a)}}function isAxiosError$1(s){return utils$1.isObject(s)&&s.isAxiosError===!0}const HttpStatusCode$1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode$1).forEach(([s,e])=>{HttpStatusCode$1[e]=s});function createInstance(s){const e=new Axios$1(s),a=bind(Axios$1.prototype.request,e);return utils$1.extend(a,Axios$1.prototype,e,{allOwnKeys:!0}),utils$1.extend(a,e,null,{allOwnKeys:!0}),a.create=function(c){return createInstance(mergeConfig$1(s,c))},a}const axios=createInstance(defaults$1);axios.Axios=Axios$1;axios.CanceledError=CanceledError$1;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel$1;axios.VERSION=VERSION$2;axios.toFormData=toFormData$1;axios.AxiosError=AxiosError$1;axios.Cancel=axios.CanceledError;axios.all=function(e){return Promise.all(e)};axios.spread=spread$1;axios.isAxiosError=isAxiosError$1;axios.mergeConfig=mergeConfig$1;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=s=>formDataToJSON(utils$1.isHTMLForm(s)?new FormData(s):s);axios.getAdapter=adapters$1.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const{Axios,AxiosError,CanceledError,isCancel,CancelToken,VERSION:VERSION$1,all,Cancel,isAxiosError,spread,toFormData,AxiosHeaders,HttpStatusCode,formToJSON,getAdapter,mergeConfig}=axios,Terms=()=>{const s=useNavigate(),[e,a]=reactExports.useState([]),[o,c]=reactExports.useState([]),[d,h]=reactExports.useState(""),[g,_]=reactExports.useState(""),[b,j]=reactExports.useState(!1),[$,_e]=reactExports.useState(null);reactExports.useEffect(()=>{(async()=>{var st;j(!0);try{const rt=await axios.get("https://apis.earlyagedevelopment.com/api/projects");a(rt.data||[]);const nt=await axios.get("https://apis.earlyagedevelopment.com/api/assessment-criteria");c(((st=nt.data)==null?void 0:st.data)||[])}catch(rt){_e("Failed to fetch data"),console.error("Error fetching data:",rt)}finally{j(!1)}})()},[]);const tt=async et=>{et.preventDefault();const st=e.find(nt=>nt.id===parseInt(d)),rt=o.find(nt=>nt.id===parseInt(g));if(!st||!rt){_e("Please select both project and assessment criteria");return}s("/assessment",{state:{project:{id:st.id,title:st.project_title},criteria:rt}})};return b?jsxRuntimeExports.jsx("div",{children:"Loading..."}):$?jsxRuntimeExports.jsxs("div",{children:["Error: ",$]}):jsxRuntimeExports.jsx("div",{className:"terms-page",children:jsxRuntimeExports.jsx("div",{className:"content",children:jsxRuntimeExports.jsxs("form",{onSubmit:tt,children:[jsxRuntimeExports.jsxs("div",{className:"dropdown-section",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"project",children:"Select Project"}),jsxRuntimeExports.jsxs("div",{className:"custom-select",children:[jsxRuntimeExports.jsxs("select",{id:"project",value:d,onChange:et=>h(et.target.value),className:"form-control",required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select a project"}),e.map(et=>jsxRuntimeExports.jsx("option",{value:et.id,children:et.project_title},et.id))]}),d&&jsxRuntimeExports.jsx("div",{className:"selected-project",children:e.map(et=>et.id===parseInt(d)&&jsxRuntimeExports.jsx("img",{src:et.project_picture,alt:et.project_title,className:"project-thumbnail"},et.id))})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"criteria",children:"Select Assessment Criteria"}),jsxRuntimeExports.jsxs("select",{id:"criteria",value:g,onChange:et=>_(et.target.value),className:"form-control",required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select criteria"}),o.map(et=>jsxRuntimeExports.jsx("option",{value:et.id,children:et.name},et.id))]})]})]}),jsxRuntimeExports.jsx("button",{type:"submit",className:"submit-button",disabled:b,children:b?"Loading...":"Start Assessment"})]})})})},ignoreOverride=Symbol("Let zodToJsonSchema decide on which parser to use"),defaultOptions$1={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},getDefaultOptions=s=>({...defaultOptions$1,...s}),getRefs=s=>{const e=getDefaultOptions(s),a=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:a,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([o,c])=>[c._def,{def:c._def,path:[...e.basePath,e.definitionPath,o],jsonSchema:void 0}]))}};function addErrorMessage(s,e,a,o){o!=null&&o.errorMessages&&a&&(s.errorMessage={...s.errorMessage,[e]:a})}function setResponseValueAndErrors(s,e,a,o,c){s[e]=a,addErrorMessage(s,e,o,c)}var util;(function(s){s.assertEqual=c=>c;function e(c){}s.assertIs=e;function a(c){throw new Error}s.assertNever=a,s.arrayToEnum=c=>{const d={};for(const h of c)d[h]=h;return d},s.getValidEnumValues=c=>{const d=s.objectKeys(c).filter(g=>typeof c[c[g]]!="number"),h={};for(const g of d)h[g]=c[g];return s.objectValues(h)},s.objectValues=c=>s.objectKeys(c).map(function(d){return c[d]}),s.objectKeys=typeof Object.keys=="function"?c=>Object.keys(c):c=>{const d=[];for(const h in c)Object.prototype.hasOwnProperty.call(c,h)&&d.push(h);return d},s.find=(c,d)=>{for(const h of c)if(d(h))return h},s.isInteger=typeof Number.isInteger=="function"?c=>Number.isInteger(c):c=>typeof c=="number"&&isFinite(c)&&Math.floor(c)===c;function o(c,d=" | "){return c.map(h=>typeof h=="string"?`'${h}'`:h).join(d)}s.joinValues=o,s.jsonStringifyReplacer=(c,d)=>typeof d=="bigint"?d.toString():d})(util||(util={}));var objectUtil;(function(s){s.mergeShapes=(e,a)=>({...e,...a})})(objectUtil||(objectUtil={}));const ZodParsedType=util.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),getParsedType=s=>{switch(typeof s){case"undefined":return ZodParsedType.undefined;case"string":return ZodParsedType.string;case"number":return isNaN(s)?ZodParsedType.nan:ZodParsedType.number;case"boolean":return ZodParsedType.boolean;case"function":return ZodParsedType.function;case"bigint":return ZodParsedType.bigint;case"symbol":return ZodParsedType.symbol;case"object":return Array.isArray(s)?ZodParsedType.array:s===null?ZodParsedType.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?ZodParsedType.promise:typeof Map<"u"&&s instanceof Map?ZodParsedType.map:typeof Set<"u"&&s instanceof Set?ZodParsedType.set:typeof Date<"u"&&s instanceof Date?ZodParsedType.date:ZodParsedType.object;default:return ZodParsedType.unknown}},ZodIssueCode=util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),quotelessJson=s=>JSON.stringify(s,null,2).replace(/"([^"]+)":/g,"$1:");class ZodError extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=o=>{this.issues=[...this.issues,o]},this.addIssues=(o=[])=>{this.issues=[...this.issues,...o]};const a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}format(e){const a=e||function(d){return d.message},o={_errors:[]},c=d=>{for(const h of d.issues)if(h.code==="invalid_union")h.unionErrors.map(c);else if(h.code==="invalid_return_type")c(h.returnTypeError);else if(h.code==="invalid_arguments")c(h.argumentsError);else if(h.path.length===0)o._errors.push(a(h));else{let g=o,_=0;for(;_<h.path.length;){const b=h.path[_];_===h.path.length-1?(g[b]=g[b]||{_errors:[]},g[b]._errors.push(a(h))):g[b]=g[b]||{_errors:[]},g=g[b],_++}}};return c(this),o}static assert(e){if(!(e instanceof ZodError))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,util.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){const a={},o=[];for(const c of this.issues)c.path.length>0?(a[c.path[0]]=a[c.path[0]]||[],a[c.path[0]].push(e(c))):o.push(e(c));return{formErrors:o,fieldErrors:a}}get formErrors(){return this.flatten()}}ZodError.create=s=>new ZodError(s);const errorMap=(s,e)=>{let a;switch(s.code){case ZodIssueCode.invalid_type:s.received===ZodParsedType.undefined?a="Required":a=`Expected ${s.expected}, received ${s.received}`;break;case ZodIssueCode.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(s.expected,util.jsonStringifyReplacer)}`;break;case ZodIssueCode.unrecognized_keys:a=`Unrecognized key(s) in object: ${util.joinValues(s.keys,", ")}`;break;case ZodIssueCode.invalid_union:a="Invalid input";break;case ZodIssueCode.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${util.joinValues(s.options)}`;break;case ZodIssueCode.invalid_enum_value:a=`Invalid enum value. Expected ${util.joinValues(s.options)}, received '${s.received}'`;break;case ZodIssueCode.invalid_arguments:a="Invalid function arguments";break;case ZodIssueCode.invalid_return_type:a="Invalid function return type";break;case ZodIssueCode.invalid_date:a="Invalid date";break;case ZodIssueCode.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(a=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?a=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?a=`Invalid input: must end with "${s.validation.endsWith}"`:util.assertNever(s.validation):s.validation!=="regex"?a=`Invalid ${s.validation}`:a="Invalid";break;case ZodIssueCode.too_small:s.type==="array"?a=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?a=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?a=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?a=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:a="Invalid input";break;case ZodIssueCode.too_big:s.type==="array"?a=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?a=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?a=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?a=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?a=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:a="Invalid input";break;case ZodIssueCode.custom:a="Invalid input";break;case ZodIssueCode.invalid_intersection_types:a="Intersection results could not be merged";break;case ZodIssueCode.not_multiple_of:a=`Number must be a multiple of ${s.multipleOf}`;break;case ZodIssueCode.not_finite:a="Number must be finite";break;default:a=e.defaultError,util.assertNever(s)}return{message:a}};let overrideErrorMap=errorMap;function setErrorMap(s){overrideErrorMap=s}function getErrorMap(){return overrideErrorMap}const makeIssue=s=>{const{data:e,path:a,errorMaps:o,issueData:c}=s,d=[...a,...c.path||[]],h={...c,path:d};if(c.message!==void 0)return{...c,path:d,message:c.message};let g="";const _=o.filter(b=>!!b).slice().reverse();for(const b of _)g=b(h,{data:e,defaultError:g}).message;return{...c,path:d,message:g}},EMPTY_PATH=[];function addIssueToContext(s,e){const a=getErrorMap(),o=makeIssue({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,a,a===errorMap?void 0:errorMap].filter(c=>!!c)});s.common.issues.push(o)}class ParseStatus{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){const o=[];for(const c of a){if(c.status==="aborted")return INVALID;c.status==="dirty"&&e.dirty(),o.push(c.value)}return{status:e.value,value:o}}static async mergeObjectAsync(e,a){const o=[];for(const c of a){const d=await c.key,h=await c.value;o.push({key:d,value:h})}return ParseStatus.mergeObjectSync(e,o)}static mergeObjectSync(e,a){const o={};for(const c of a){const{key:d,value:h}=c;if(d.status==="aborted"||h.status==="aborted")return INVALID;d.status==="dirty"&&e.dirty(),h.status==="dirty"&&e.dirty(),d.value!=="__proto__"&&(typeof h.value<"u"||c.alwaysSet)&&(o[d.value]=h.value)}return{status:e.value,value:o}}}const INVALID=Object.freeze({status:"aborted"}),DIRTY=s=>({status:"dirty",value:s}),OK=s=>({status:"valid",value:s}),isAborted=s=>s.status==="aborted",isDirty=s=>s.status==="dirty",isValid=s=>s.status==="valid",isAsync=s=>typeof Promise<"u"&&s instanceof Promise;function __classPrivateFieldGet(s,e,a,o){if(typeof e=="function"?s!==e||!0:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(s)}function __classPrivateFieldSet(s,e,a,o,c){if(typeof e=="function"?s!==e||!0:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(s,a),a}typeof SuppressedError=="function"&&SuppressedError;var errorUtil;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(errorUtil||(errorUtil={}));var _ZodEnum_cache,_ZodNativeEnum_cache;class ParseInputLazyPath{constructor(e,a,o,c){this._cachedPath=[],this.parent=e,this.data=a,this._path=o,this._key=c}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const handleResult=(s,e)=>{if(isValid(e))return{success:!0,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const a=new ZodError(s.common.issues);return this._error=a,this._error}}};function processCreateParams(s){if(!s)return{};const{errorMap:e,invalid_type_error:a,required_error:o,description:c}=s;if(e&&(a||o))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:c}:{errorMap:(h,g)=>{var _,b;const{message:j}=s;return h.code==="invalid_enum_value"?{message:j??g.defaultError}:typeof g.data>"u"?{message:(_=j??o)!==null&&_!==void 0?_:g.defaultError}:h.code!=="invalid_type"?{message:g.defaultError}:{message:(b=j??a)!==null&&b!==void 0?b:g.defaultError}},description:c}}class ZodType{get description(){return this._def.description}_getType(e){return getParsedType(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:getParsedType(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:getParsedType(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const a=this._parse(e);if(isAsync(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){const a=this._parse(e);return Promise.resolve(a)}parse(e,a){const o=this.safeParse(e,a);if(o.success)return o.data;throw o.error}safeParse(e,a){var o;const c={common:{issues:[],async:(o=a==null?void 0:a.async)!==null&&o!==void 0?o:!1,contextualErrorMap:a==null?void 0:a.errorMap},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)},d=this._parseSync({data:e,path:c.path,parent:c});return handleResult(c,d)}"~validate"(e){var a,o;const c={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)};if(!this["~standard"].async)try{const d=this._parseSync({data:e,path:[],parent:c});return isValid(d)?{value:d.value}:{issues:c.common.issues}}catch(d){!((o=(a=d==null?void 0:d.message)===null||a===void 0?void 0:a.toLowerCase())===null||o===void 0)&&o.includes("encountered")&&(this["~standard"].async=!0),c.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:c}).then(d=>isValid(d)?{value:d.value}:{issues:c.common.issues})}async parseAsync(e,a){const o=await this.safeParseAsync(e,a);if(o.success)return o.data;throw o.error}async safeParseAsync(e,a){const o={common:{issues:[],contextualErrorMap:a==null?void 0:a.errorMap,async:!0},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)},c=this._parse({data:e,path:o.path,parent:o}),d=await(isAsync(c)?c:Promise.resolve(c));return handleResult(o,d)}refine(e,a){const o=c=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(c):a;return this._refinement((c,d)=>{const h=e(c),g=()=>d.addIssue({code:ZodIssueCode.custom,...o(c)});return typeof Promise<"u"&&h instanceof Promise?h.then(_=>_?!0:(g(),!1)):h?!0:(g(),!1)})}refinement(e,a){return this._refinement((o,c)=>e(o)?!0:(c.addIssue(typeof a=="function"?a(o,c):a),!1))}_refinement(e){return new ZodEffects({schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this)}promise(){return ZodPromise.create(this,this._def)}or(e){return ZodUnion.create([this,e],this._def)}and(e){return ZodIntersection.create(this,e,this._def)}transform(e){return new ZodEffects({...processCreateParams(this._def),schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const a=typeof e=="function"?e:()=>e;return new ZodDefault({...processCreateParams(this._def),innerType:this,defaultValue:a,typeName:ZodFirstPartyTypeKind.ZodDefault})}brand(){return new ZodBranded({typeName:ZodFirstPartyTypeKind.ZodBranded,type:this,...processCreateParams(this._def)})}catch(e){const a=typeof e=="function"?e:()=>e;return new ZodCatch({...processCreateParams(this._def),innerType:this,catchValue:a,typeName:ZodFirstPartyTypeKind.ZodCatch})}describe(e){const a=this.constructor;return new a({...this._def,description:e})}pipe(e){return ZodPipeline.create(this,e)}readonly(){return ZodReadonly.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const cuidRegex=/^c[^\s-]{8,}$/i,cuid2Regex=/^[0-9a-z]+$/,ulidRegex=/^[0-9A-HJKMNP-TV-Z]{26}$/i,uuidRegex=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,nanoidRegex=/^[a-z0-9_-]{21}$/i,jwtRegex=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,durationRegex=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,emailRegex=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,_emojiRegex="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let emojiRegex$1;const ipv4Regex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4CidrRegex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6Regex=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,ipv6CidrRegex=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64Regex=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64urlRegex=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,dateRegexSource="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dateRegex=new RegExp(`^${dateRegexSource}$`);function timeRegexSource(s){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return s.precision?e=`${e}\\.\\d{${s.precision}}`:s.precision==null&&(e=`${e}(\\.\\d+)?`),e}function timeRegex(s){return new RegExp(`^${timeRegexSource(s)}$`)}function datetimeRegex(s){let e=`${dateRegexSource}T${timeRegexSource(s)}`;const a=[];return a.push(s.local?"Z?":"Z"),s.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function isValidIP(s,e){return!!((e==="v4"||!e)&&ipv4Regex.test(s)||(e==="v6"||!e)&&ipv6Regex.test(s))}function isValidJWT(s,e){if(!jwtRegex.test(s))return!1;try{const[a]=s.split("."),o=a.replace(/-/g,"+").replace(/_/g,"/").padEnd(a.length+(4-a.length%4)%4,"="),c=JSON.parse(atob(o));return!(typeof c!="object"||c===null||!c.typ||!c.alg||e&&c.alg!==e)}catch{return!1}}function isValidCidr(s,e){return!!((e==="v4"||!e)&&ipv4CidrRegex.test(s)||(e==="v6"||!e)&&ipv6CidrRegex.test(s))}class ZodString extends ZodType{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ZodParsedType.string){const d=this._getOrReturnCtx(e);return addIssueToContext(d,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.string,received:d.parsedType}),INVALID}const o=new ParseStatus;let c;for(const d of this._def.checks)if(d.kind==="min")e.data.length<d.value&&(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{code:ZodIssueCode.too_small,minimum:d.value,type:"string",inclusive:!0,exact:!1,message:d.message}),o.dirty());else if(d.kind==="max")e.data.length>d.value&&(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{code:ZodIssueCode.too_big,maximum:d.value,type:"string",inclusive:!0,exact:!1,message:d.message}),o.dirty());else if(d.kind==="length"){const h=e.data.length>d.value,g=e.data.length<d.value;(h||g)&&(c=this._getOrReturnCtx(e,c),h?addIssueToContext(c,{code:ZodIssueCode.too_big,maximum:d.value,type:"string",inclusive:!0,exact:!0,message:d.message}):g&&addIssueToContext(c,{code:ZodIssueCode.too_small,minimum:d.value,type:"string",inclusive:!0,exact:!0,message:d.message}),o.dirty())}else if(d.kind==="email")emailRegex.test(e.data)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{validation:"email",code:ZodIssueCode.invalid_string,message:d.message}),o.dirty());else if(d.kind==="emoji")emojiRegex$1||(emojiRegex$1=new RegExp(_emojiRegex,"u")),emojiRegex$1.test(e.data)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{validation:"emoji",code:ZodIssueCode.invalid_string,message:d.message}),o.dirty());else if(d.kind==="uuid")uuidRegex.test(e.data)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{validation:"uuid",code:ZodIssueCode.invalid_string,message:d.message}),o.dirty());else if(d.kind==="nanoid")nanoidRegex.test(e.data)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{validation:"nanoid",code:ZodIssueCode.invalid_string,message:d.message}),o.dirty());else if(d.kind==="cuid")cuidRegex.test(e.data)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{validation:"cuid",code:ZodIssueCode.invalid_string,message:d.message}),o.dirty());else if(d.kind==="cuid2")cuid2Regex.test(e.data)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{validation:"cuid2",code:ZodIssueCode.invalid_string,message:d.message}),o.dirty());else if(d.kind==="ulid")ulidRegex.test(e.data)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{validation:"ulid",code:ZodIssueCode.invalid_string,message:d.message}),o.dirty());else if(d.kind==="url")try{new URL(e.data)}catch{c=this._getOrReturnCtx(e,c),addIssueToContext(c,{validation:"url",code:ZodIssueCode.invalid_string,message:d.message}),o.dirty()}else d.kind==="regex"?(d.regex.lastIndex=0,d.regex.test(e.data)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{validation:"regex",code:ZodIssueCode.invalid_string,message:d.message}),o.dirty())):d.kind==="trim"?e.data=e.data.trim():d.kind==="includes"?e.data.includes(d.value,d.position)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{code:ZodIssueCode.invalid_string,validation:{includes:d.value,position:d.position},message:d.message}),o.dirty()):d.kind==="toLowerCase"?e.data=e.data.toLowerCase():d.kind==="toUpperCase"?e.data=e.data.toUpperCase():d.kind==="startsWith"?e.data.startsWith(d.value)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{code:ZodIssueCode.invalid_string,validation:{startsWith:d.value},message:d.message}),o.dirty()):d.kind==="endsWith"?e.data.endsWith(d.value)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{code:ZodIssueCode.invalid_string,validation:{endsWith:d.value},message:d.message}),o.dirty()):d.kind==="datetime"?datetimeRegex(d).test(e.data)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{code:ZodIssueCode.invalid_string,validation:"datetime",message:d.message}),o.dirty()):d.kind==="date"?dateRegex.test(e.data)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{code:ZodIssueCode.invalid_string,validation:"date",message:d.message}),o.dirty()):d.kind==="time"?timeRegex(d).test(e.data)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{code:ZodIssueCode.invalid_string,validation:"time",message:d.message}),o.dirty()):d.kind==="duration"?durationRegex.test(e.data)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{validation:"duration",code:ZodIssueCode.invalid_string,message:d.message}),o.dirty()):d.kind==="ip"?isValidIP(e.data,d.version)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{validation:"ip",code:ZodIssueCode.invalid_string,message:d.message}),o.dirty()):d.kind==="jwt"?isValidJWT(e.data,d.alg)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{validation:"jwt",code:ZodIssueCode.invalid_string,message:d.message}),o.dirty()):d.kind==="cidr"?isValidCidr(e.data,d.version)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{validation:"cidr",code:ZodIssueCode.invalid_string,message:d.message}),o.dirty()):d.kind==="base64"?base64Regex.test(e.data)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{validation:"base64",code:ZodIssueCode.invalid_string,message:d.message}),o.dirty()):d.kind==="base64url"?base64urlRegex.test(e.data)||(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{validation:"base64url",code:ZodIssueCode.invalid_string,message:d.message}),o.dirty()):util.assertNever(d);return{status:o.value,value:e.data}}_regex(e,a,o){return this.refinement(c=>e.test(c),{validation:a,code:ZodIssueCode.invalid_string,...errorUtil.errToObj(o)})}_addCheck(e){return new ZodString({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...errorUtil.errToObj(e)})}url(e){return this._addCheck({kind:"url",...errorUtil.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...errorUtil.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...errorUtil.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...errorUtil.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...errorUtil.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...errorUtil.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...errorUtil.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...errorUtil.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...errorUtil.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...errorUtil.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...errorUtil.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...errorUtil.errToObj(e)})}datetime(e){var a,o;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(a=e==null?void 0:e.offset)!==null&&a!==void 0?a:!1,local:(o=e==null?void 0:e.local)!==null&&o!==void 0?o:!1,...errorUtil.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...errorUtil.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...errorUtil.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...errorUtil.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a==null?void 0:a.position,...errorUtil.errToObj(a==null?void 0:a.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...errorUtil.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...errorUtil.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...errorUtil.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...errorUtil.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...errorUtil.errToObj(a)})}nonempty(e){return this.min(1,errorUtil.errToObj(e))}trim(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(const a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}}ZodString.create=s=>{var e;return new ZodString({checks:[],typeName:ZodFirstPartyTypeKind.ZodString,coerce:(e=s==null?void 0:s.coerce)!==null&&e!==void 0?e:!1,...processCreateParams(s)})};function floatSafeRemainder(s,e){const a=(s.toString().split(".")[1]||"").length,o=(e.toString().split(".")[1]||"").length,c=a>o?a:o,d=parseInt(s.toFixed(c).replace(".","")),h=parseInt(e.toFixed(c).replace(".",""));return d%h/Math.pow(10,c)}class ZodNumber extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ZodParsedType.number){const d=this._getOrReturnCtx(e);return addIssueToContext(d,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.number,received:d.parsedType}),INVALID}let o;const c=new ParseStatus;for(const d of this._def.checks)d.kind==="int"?util.isInteger(e.data)||(o=this._getOrReturnCtx(e,o),addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:"integer",received:"float",message:d.message}),c.dirty()):d.kind==="min"?(d.inclusive?e.data<d.value:e.data<=d.value)&&(o=this._getOrReturnCtx(e,o),addIssueToContext(o,{code:ZodIssueCode.too_small,minimum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):d.kind==="max"?(d.inclusive?e.data>d.value:e.data>=d.value)&&(o=this._getOrReturnCtx(e,o),addIssueToContext(o,{code:ZodIssueCode.too_big,maximum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):d.kind==="multipleOf"?floatSafeRemainder(e.data,d.value)!==0&&(o=this._getOrReturnCtx(e,o),addIssueToContext(o,{code:ZodIssueCode.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):d.kind==="finite"?Number.isFinite(e.data)||(o=this._getOrReturnCtx(e,o),addIssueToContext(o,{code:ZodIssueCode.not_finite,message:d.message}),c.dirty()):util.assertNever(d);return{status:c.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,errorUtil.toString(a))}gt(e,a){return this.setLimit("min",e,!1,errorUtil.toString(a))}lte(e,a){return this.setLimit("max",e,!0,errorUtil.toString(a))}lt(e,a){return this.setLimit("max",e,!1,errorUtil.toString(a))}setLimit(e,a,o,c){return new ZodNumber({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:o,message:errorUtil.toString(c)}]})}_addCheck(e){return new ZodNumber({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:errorUtil.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:errorUtil.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:errorUtil.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:errorUtil.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:errorUtil.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:errorUtil.toString(e)})}get minValue(){let e=null;for(const a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(const a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&util.isInteger(e.value))}get isFinite(){let e=null,a=null;for(const o of this._def.checks){if(o.kind==="finite"||o.kind==="int"||o.kind==="multipleOf")return!0;o.kind==="min"?(a===null||o.value>a)&&(a=o.value):o.kind==="max"&&(e===null||o.value<e)&&(e=o.value)}return Number.isFinite(a)&&Number.isFinite(e)}}ZodNumber.create=s=>new ZodNumber({checks:[],typeName:ZodFirstPartyTypeKind.ZodNumber,coerce:(s==null?void 0:s.coerce)||!1,...processCreateParams(s)});class ZodBigInt extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ZodParsedType.bigint)return this._getInvalidInput(e);let o;const c=new ParseStatus;for(const d of this._def.checks)d.kind==="min"?(d.inclusive?e.data<d.value:e.data<=d.value)&&(o=this._getOrReturnCtx(e,o),addIssueToContext(o,{code:ZodIssueCode.too_small,type:"bigint",minimum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):d.kind==="max"?(d.inclusive?e.data>d.value:e.data>=d.value)&&(o=this._getOrReturnCtx(e,o),addIssueToContext(o,{code:ZodIssueCode.too_big,type:"bigint",maximum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):d.kind==="multipleOf"?e.data%d.value!==BigInt(0)&&(o=this._getOrReturnCtx(e,o),addIssueToContext(o,{code:ZodIssueCode.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):util.assertNever(d);return{status:c.value,value:e.data}}_getInvalidInput(e){const a=this._getOrReturnCtx(e);return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.bigint,received:a.parsedType}),INVALID}gte(e,a){return this.setLimit("min",e,!0,errorUtil.toString(a))}gt(e,a){return this.setLimit("min",e,!1,errorUtil.toString(a))}lte(e,a){return this.setLimit("max",e,!0,errorUtil.toString(a))}lt(e,a){return this.setLimit("max",e,!1,errorUtil.toString(a))}setLimit(e,a,o,c){return new ZodBigInt({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:o,message:errorUtil.toString(c)}]})}_addCheck(e){return new ZodBigInt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:errorUtil.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:errorUtil.toString(a)})}get minValue(){let e=null;for(const a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(const a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}}ZodBigInt.create=s=>{var e;return new ZodBigInt({checks:[],typeName:ZodFirstPartyTypeKind.ZodBigInt,coerce:(e=s==null?void 0:s.coerce)!==null&&e!==void 0?e:!1,...processCreateParams(s)})};class ZodBoolean extends ZodType{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ZodParsedType.boolean){const o=this._getOrReturnCtx(e);return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.boolean,received:o.parsedType}),INVALID}return OK(e.data)}}ZodBoolean.create=s=>new ZodBoolean({typeName:ZodFirstPartyTypeKind.ZodBoolean,coerce:(s==null?void 0:s.coerce)||!1,...processCreateParams(s)});class ZodDate extends ZodType{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ZodParsedType.date){const d=this._getOrReturnCtx(e);return addIssueToContext(d,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.date,received:d.parsedType}),INVALID}if(isNaN(e.data.getTime())){const d=this._getOrReturnCtx(e);return addIssueToContext(d,{code:ZodIssueCode.invalid_date}),INVALID}const o=new ParseStatus;let c;for(const d of this._def.checks)d.kind==="min"?e.data.getTime()<d.value&&(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{code:ZodIssueCode.too_small,message:d.message,inclusive:!0,exact:!1,minimum:d.value,type:"date"}),o.dirty()):d.kind==="max"?e.data.getTime()>d.value&&(c=this._getOrReturnCtx(e,c),addIssueToContext(c,{code:ZodIssueCode.too_big,message:d.message,inclusive:!0,exact:!1,maximum:d.value,type:"date"}),o.dirty()):util.assertNever(d);return{status:o.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ZodDate({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:errorUtil.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:errorUtil.toString(a)})}get minDate(){let e=null;for(const a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}}ZodDate.create=s=>new ZodDate({checks:[],coerce:(s==null?void 0:s.coerce)||!1,typeName:ZodFirstPartyTypeKind.ZodDate,...processCreateParams(s)});class ZodSymbol extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.symbol){const o=this._getOrReturnCtx(e);return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.symbol,received:o.parsedType}),INVALID}return OK(e.data)}}ZodSymbol.create=s=>new ZodSymbol({typeName:ZodFirstPartyTypeKind.ZodSymbol,...processCreateParams(s)});class ZodUndefined extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.undefined){const o=this._getOrReturnCtx(e);return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.undefined,received:o.parsedType}),INVALID}return OK(e.data)}}ZodUndefined.create=s=>new ZodUndefined({typeName:ZodFirstPartyTypeKind.ZodUndefined,...processCreateParams(s)});class ZodNull extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.null){const o=this._getOrReturnCtx(e);return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.null,received:o.parsedType}),INVALID}return OK(e.data)}}ZodNull.create=s=>new ZodNull({typeName:ZodFirstPartyTypeKind.ZodNull,...processCreateParams(s)});class ZodAny extends ZodType{constructor(){super(...arguments),this._any=!0}_parse(e){return OK(e.data)}}ZodAny.create=s=>new ZodAny({typeName:ZodFirstPartyTypeKind.ZodAny,...processCreateParams(s)});class ZodUnknown extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse(e){return OK(e.data)}}ZodUnknown.create=s=>new ZodUnknown({typeName:ZodFirstPartyTypeKind.ZodUnknown,...processCreateParams(s)});class ZodNever extends ZodType{_parse(e){const a=this._getOrReturnCtx(e);return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.never,received:a.parsedType}),INVALID}}ZodNever.create=s=>new ZodNever({typeName:ZodFirstPartyTypeKind.ZodNever,...processCreateParams(s)});class ZodVoid extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.undefined){const o=this._getOrReturnCtx(e);return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.void,received:o.parsedType}),INVALID}return OK(e.data)}}ZodVoid.create=s=>new ZodVoid({typeName:ZodFirstPartyTypeKind.ZodVoid,...processCreateParams(s)});class ZodArray extends ZodType{_parse(e){const{ctx:a,status:o}=this._processInputParams(e),c=this._def;if(a.parsedType!==ZodParsedType.array)return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:a.parsedType}),INVALID;if(c.exactLength!==null){const h=a.data.length>c.exactLength.value,g=a.data.length<c.exactLength.value;(h||g)&&(addIssueToContext(a,{code:h?ZodIssueCode.too_big:ZodIssueCode.too_small,minimum:g?c.exactLength.value:void 0,maximum:h?c.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:c.exactLength.message}),o.dirty())}if(c.minLength!==null&&a.data.length<c.minLength.value&&(addIssueToContext(a,{code:ZodIssueCode.too_small,minimum:c.minLength.value,type:"array",inclusive:!0,exact:!1,message:c.minLength.message}),o.dirty()),c.maxLength!==null&&a.data.length>c.maxLength.value&&(addIssueToContext(a,{code:ZodIssueCode.too_big,maximum:c.maxLength.value,type:"array",inclusive:!0,exact:!1,message:c.maxLength.message}),o.dirty()),a.common.async)return Promise.all([...a.data].map((h,g)=>c.type._parseAsync(new ParseInputLazyPath(a,h,a.path,g)))).then(h=>ParseStatus.mergeArray(o,h));const d=[...a.data].map((h,g)=>c.type._parseSync(new ParseInputLazyPath(a,h,a.path,g)));return ParseStatus.mergeArray(o,d)}get element(){return this._def.type}min(e,a){return new ZodArray({...this._def,minLength:{value:e,message:errorUtil.toString(a)}})}max(e,a){return new ZodArray({...this._def,maxLength:{value:e,message:errorUtil.toString(a)}})}length(e,a){return new ZodArray({...this._def,exactLength:{value:e,message:errorUtil.toString(a)}})}nonempty(e){return this.min(1,e)}}ZodArray.create=(s,e)=>new ZodArray({type:s,minLength:null,maxLength:null,exactLength:null,typeName:ZodFirstPartyTypeKind.ZodArray,...processCreateParams(e)});function deepPartialify(s){if(s instanceof ZodObject){const e={};for(const a in s.shape){const o=s.shape[a];e[a]=ZodOptional.create(deepPartialify(o))}return new ZodObject({...s._def,shape:()=>e})}else return s instanceof ZodArray?new ZodArray({...s._def,type:deepPartialify(s.element)}):s instanceof ZodOptional?ZodOptional.create(deepPartialify(s.unwrap())):s instanceof ZodNullable?ZodNullable.create(deepPartialify(s.unwrap())):s instanceof ZodTuple?ZodTuple.create(s.items.map(e=>deepPartialify(e))):s}class ZodObject extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),a=util.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==ZodParsedType.object){const b=this._getOrReturnCtx(e);return addIssueToContext(b,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:b.parsedType}),INVALID}const{status:o,ctx:c}=this._processInputParams(e),{shape:d,keys:h}=this._getCached(),g=[];if(!(this._def.catchall instanceof ZodNever&&this._def.unknownKeys==="strip"))for(const b in c.data)h.includes(b)||g.push(b);const _=[];for(const b of h){const j=d[b],$=c.data[b];_.push({key:{status:"valid",value:b},value:j._parse(new ParseInputLazyPath(c,$,c.path,b)),alwaysSet:b in c.data})}if(this._def.catchall instanceof ZodNever){const b=this._def.unknownKeys;if(b==="passthrough")for(const j of g)_.push({key:{status:"valid",value:j},value:{status:"valid",value:c.data[j]}});else if(b==="strict")g.length>0&&(addIssueToContext(c,{code:ZodIssueCode.unrecognized_keys,keys:g}),o.dirty());else if(b!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const b=this._def.catchall;for(const j of g){const $=c.data[j];_.push({key:{status:"valid",value:j},value:b._parse(new ParseInputLazyPath(c,$,c.path,j)),alwaysSet:j in c.data})}}return c.common.async?Promise.resolve().then(async()=>{const b=[];for(const j of _){const $=await j.key,_e=await j.value;b.push({key:$,value:_e,alwaysSet:j.alwaysSet})}return b}).then(b=>ParseStatus.mergeObjectSync(o,b)):ParseStatus.mergeObjectSync(o,_)}get shape(){return this._def.shape()}strict(e){return errorUtil.errToObj,new ZodObject({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(a,o)=>{var c,d,h,g;const _=(h=(d=(c=this._def).errorMap)===null||d===void 0?void 0:d.call(c,a,o).message)!==null&&h!==void 0?h:o.defaultError;return a.code==="unrecognized_keys"?{message:(g=errorUtil.errToObj(e).message)!==null&&g!==void 0?g:_}:{message:_}}}:{}})}strip(){return new ZodObject({...this._def,unknownKeys:"strip"})}passthrough(){return new ZodObject({...this._def,unknownKeys:"passthrough"})}extend(e){return new ZodObject({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ZodObject({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ZodFirstPartyTypeKind.ZodObject})}setKey(e,a){return this.augment({[e]:a})}catchall(e){return new ZodObject({...this._def,catchall:e})}pick(e){const a={};return util.objectKeys(e).forEach(o=>{e[o]&&this.shape[o]&&(a[o]=this.shape[o])}),new ZodObject({...this._def,shape:()=>a})}omit(e){const a={};return util.objectKeys(this.shape).forEach(o=>{e[o]||(a[o]=this.shape[o])}),new ZodObject({...this._def,shape:()=>a})}deepPartial(){return deepPartialify(this)}partial(e){const a={};return util.objectKeys(this.shape).forEach(o=>{const c=this.shape[o];e&&!e[o]?a[o]=c:a[o]=c.optional()}),new ZodObject({...this._def,shape:()=>a})}required(e){const a={};return util.objectKeys(this.shape).forEach(o=>{if(e&&!e[o])a[o]=this.shape[o];else{let d=this.shape[o];for(;d instanceof ZodOptional;)d=d._def.innerType;a[o]=d}}),new ZodObject({...this._def,shape:()=>a})}keyof(){return createZodEnum(util.objectKeys(this.shape))}}ZodObject.create=(s,e)=>new ZodObject({shape:()=>s,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(e)});ZodObject.strictCreate=(s,e)=>new ZodObject({shape:()=>s,unknownKeys:"strict",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(e)});ZodObject.lazycreate=(s,e)=>new ZodObject({shape:s,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(e)});class ZodUnion extends ZodType{_parse(e){const{ctx:a}=this._processInputParams(e),o=this._def.options;function c(d){for(const g of d)if(g.result.status==="valid")return g.result;for(const g of d)if(g.result.status==="dirty")return a.common.issues.push(...g.ctx.common.issues),g.result;const h=d.map(g=>new ZodError(g.ctx.common.issues));return addIssueToContext(a,{code:ZodIssueCode.invalid_union,unionErrors:h}),INVALID}if(a.common.async)return Promise.all(o.map(async d=>{const h={...a,common:{...a.common,issues:[]},parent:null};return{result:await d._parseAsync({data:a.data,path:a.path,parent:h}),ctx:h}})).then(c);{let d;const h=[];for(const _ of o){const b={...a,common:{...a.common,issues:[]},parent:null},j=_._parseSync({data:a.data,path:a.path,parent:b});if(j.status==="valid")return j;j.status==="dirty"&&!d&&(d={result:j,ctx:b}),b.common.issues.length&&h.push(b.common.issues)}if(d)return a.common.issues.push(...d.ctx.common.issues),d.result;const g=h.map(_=>new ZodError(_));return addIssueToContext(a,{code:ZodIssueCode.invalid_union,unionErrors:g}),INVALID}}get options(){return this._def.options}}ZodUnion.create=(s,e)=>new ZodUnion({options:s,typeName:ZodFirstPartyTypeKind.ZodUnion,...processCreateParams(e)});const getDiscriminator=s=>s instanceof ZodLazy?getDiscriminator(s.schema):s instanceof ZodEffects?getDiscriminator(s.innerType()):s instanceof ZodLiteral?[s.value]:s instanceof ZodEnum?s.options:s instanceof ZodNativeEnum?util.objectValues(s.enum):s instanceof ZodDefault?getDiscriminator(s._def.innerType):s instanceof ZodUndefined?[void 0]:s instanceof ZodNull?[null]:s instanceof ZodOptional?[void 0,...getDiscriminator(s.unwrap())]:s instanceof ZodNullable?[null,...getDiscriminator(s.unwrap())]:s instanceof ZodBranded||s instanceof ZodReadonly?getDiscriminator(s.unwrap()):s instanceof ZodCatch?getDiscriminator(s._def.innerType):[];class ZodDiscriminatedUnion extends ZodType{_parse(e){const{ctx:a}=this._processInputParams(e);if(a.parsedType!==ZodParsedType.object)return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:a.parsedType}),INVALID;const o=this.discriminator,c=a.data[o],d=this.optionsMap.get(c);return d?a.common.async?d._parseAsync({data:a.data,path:a.path,parent:a}):d._parseSync({data:a.data,path:a.path,parent:a}):(addIssueToContext(a,{code:ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[o]}),INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,a,o){const c=new Map;for(const d of a){const h=getDiscriminator(d.shape[e]);if(!h.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const g of h){if(c.has(g))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(g)}`);c.set(g,d)}}return new ZodDiscriminatedUnion({typeName:ZodFirstPartyTypeKind.ZodDiscriminatedUnion,discriminator:e,options:a,optionsMap:c,...processCreateParams(o)})}}function mergeValues(s,e){const a=getParsedType(s),o=getParsedType(e);if(s===e)return{valid:!0,data:s};if(a===ZodParsedType.object&&o===ZodParsedType.object){const c=util.objectKeys(e),d=util.objectKeys(s).filter(g=>c.indexOf(g)!==-1),h={...s,...e};for(const g of d){const _=mergeValues(s[g],e[g]);if(!_.valid)return{valid:!1};h[g]=_.data}return{valid:!0,data:h}}else if(a===ZodParsedType.array&&o===ZodParsedType.array){if(s.length!==e.length)return{valid:!1};const c=[];for(let d=0;d<s.length;d++){const h=s[d],g=e[d],_=mergeValues(h,g);if(!_.valid)return{valid:!1};c.push(_.data)}return{valid:!0,data:c}}else return a===ZodParsedType.date&&o===ZodParsedType.date&&+s==+e?{valid:!0,data:s}:{valid:!1}}class ZodIntersection extends ZodType{_parse(e){const{status:a,ctx:o}=this._processInputParams(e),c=(d,h)=>{if(isAborted(d)||isAborted(h))return INVALID;const g=mergeValues(d.value,h.value);return g.valid?((isDirty(d)||isDirty(h))&&a.dirty(),{status:a.value,value:g.data}):(addIssueToContext(o,{code:ZodIssueCode.invalid_intersection_types}),INVALID)};return o.common.async?Promise.all([this._def.left._parseAsync({data:o.data,path:o.path,parent:o}),this._def.right._parseAsync({data:o.data,path:o.path,parent:o})]).then(([d,h])=>c(d,h)):c(this._def.left._parseSync({data:o.data,path:o.path,parent:o}),this._def.right._parseSync({data:o.data,path:o.path,parent:o}))}}ZodIntersection.create=(s,e,a)=>new ZodIntersection({left:s,right:e,typeName:ZodFirstPartyTypeKind.ZodIntersection,...processCreateParams(a)});class ZodTuple extends ZodType{_parse(e){const{status:a,ctx:o}=this._processInputParams(e);if(o.parsedType!==ZodParsedType.array)return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:o.parsedType}),INVALID;if(o.data.length<this._def.items.length)return addIssueToContext(o,{code:ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),INVALID;!this._def.rest&&o.data.length>this._def.items.length&&(addIssueToContext(o,{code:ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());const d=[...o.data].map((h,g)=>{const _=this._def.items[g]||this._def.rest;return _?_._parse(new ParseInputLazyPath(o,h,o.path,g)):null}).filter(h=>!!h);return o.common.async?Promise.all(d).then(h=>ParseStatus.mergeArray(a,h)):ParseStatus.mergeArray(a,d)}get items(){return this._def.items}rest(e){return new ZodTuple({...this._def,rest:e})}}ZodTuple.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:s,typeName:ZodFirstPartyTypeKind.ZodTuple,rest:null,...processCreateParams(e)})};class ZodRecord extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:a,ctx:o}=this._processInputParams(e);if(o.parsedType!==ZodParsedType.object)return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:o.parsedType}),INVALID;const c=[],d=this._def.keyType,h=this._def.valueType;for(const g in o.data)c.push({key:d._parse(new ParseInputLazyPath(o,g,o.path,g)),value:h._parse(new ParseInputLazyPath(o,o.data[g],o.path,g)),alwaysSet:g in o.data});return o.common.async?ParseStatus.mergeObjectAsync(a,c):ParseStatus.mergeObjectSync(a,c)}get element(){return this._def.valueType}static create(e,a,o){return a instanceof ZodType?new ZodRecord({keyType:e,valueType:a,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(o)}):new ZodRecord({keyType:ZodString.create(),valueType:e,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(a)})}}class ZodMap extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:a,ctx:o}=this._processInputParams(e);if(o.parsedType!==ZodParsedType.map)return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.map,received:o.parsedType}),INVALID;const c=this._def.keyType,d=this._def.valueType,h=[...o.data.entries()].map(([g,_],b)=>({key:c._parse(new ParseInputLazyPath(o,g,o.path,[b,"key"])),value:d._parse(new ParseInputLazyPath(o,_,o.path,[b,"value"]))}));if(o.common.async){const g=new Map;return Promise.resolve().then(async()=>{for(const _ of h){const b=await _.key,j=await _.value;if(b.status==="aborted"||j.status==="aborted")return INVALID;(b.status==="dirty"||j.status==="dirty")&&a.dirty(),g.set(b.value,j.value)}return{status:a.value,value:g}})}else{const g=new Map;for(const _ of h){const b=_.key,j=_.value;if(b.status==="aborted"||j.status==="aborted")return INVALID;(b.status==="dirty"||j.status==="dirty")&&a.dirty(),g.set(b.value,j.value)}return{status:a.value,value:g}}}}ZodMap.create=(s,e,a)=>new ZodMap({valueType:e,keyType:s,typeName:ZodFirstPartyTypeKind.ZodMap,...processCreateParams(a)});class ZodSet extends ZodType{_parse(e){const{status:a,ctx:o}=this._processInputParams(e);if(o.parsedType!==ZodParsedType.set)return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.set,received:o.parsedType}),INVALID;const c=this._def;c.minSize!==null&&o.data.size<c.minSize.value&&(addIssueToContext(o,{code:ZodIssueCode.too_small,minimum:c.minSize.value,type:"set",inclusive:!0,exact:!1,message:c.minSize.message}),a.dirty()),c.maxSize!==null&&o.data.size>c.maxSize.value&&(addIssueToContext(o,{code:ZodIssueCode.too_big,maximum:c.maxSize.value,type:"set",inclusive:!0,exact:!1,message:c.maxSize.message}),a.dirty());const d=this._def.valueType;function h(_){const b=new Set;for(const j of _){if(j.status==="aborted")return INVALID;j.status==="dirty"&&a.dirty(),b.add(j.value)}return{status:a.value,value:b}}const g=[...o.data.values()].map((_,b)=>d._parse(new ParseInputLazyPath(o,_,o.path,b)));return o.common.async?Promise.all(g).then(_=>h(_)):h(g)}min(e,a){return new ZodSet({...this._def,minSize:{value:e,message:errorUtil.toString(a)}})}max(e,a){return new ZodSet({...this._def,maxSize:{value:e,message:errorUtil.toString(a)}})}size(e,a){return this.min(e,a).max(e,a)}nonempty(e){return this.min(1,e)}}ZodSet.create=(s,e)=>new ZodSet({valueType:s,minSize:null,maxSize:null,typeName:ZodFirstPartyTypeKind.ZodSet,...processCreateParams(e)});class ZodFunction extends ZodType{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:a}=this._processInputParams(e);if(a.parsedType!==ZodParsedType.function)return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.function,received:a.parsedType}),INVALID;function o(g,_){return makeIssue({data:g,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,getErrorMap(),errorMap].filter(b=>!!b),issueData:{code:ZodIssueCode.invalid_arguments,argumentsError:_}})}function c(g,_){return makeIssue({data:g,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,getErrorMap(),errorMap].filter(b=>!!b),issueData:{code:ZodIssueCode.invalid_return_type,returnTypeError:_}})}const d={errorMap:a.common.contextualErrorMap},h=a.data;if(this._def.returns instanceof ZodPromise){const g=this;return OK(async function(..._){const b=new ZodError([]),j=await g._def.args.parseAsync(_,d).catch(tt=>{throw b.addIssue(o(_,tt)),b}),$=await Reflect.apply(h,this,j);return await g._def.returns._def.type.parseAsync($,d).catch(tt=>{throw b.addIssue(c($,tt)),b})})}else{const g=this;return OK(function(..._){const b=g._def.args.safeParse(_,d);if(!b.success)throw new ZodError([o(_,b.error)]);const j=Reflect.apply(h,this,b.data),$=g._def.returns.safeParse(j,d);if(!$.success)throw new ZodError([c(j,$.error)]);return $.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ZodFunction({...this._def,args:ZodTuple.create(e).rest(ZodUnknown.create())})}returns(e){return new ZodFunction({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,a,o){return new ZodFunction({args:e||ZodTuple.create([]).rest(ZodUnknown.create()),returns:a||ZodUnknown.create(),typeName:ZodFirstPartyTypeKind.ZodFunction,...processCreateParams(o)})}}class ZodLazy extends ZodType{get schema(){return this._def.getter()}_parse(e){const{ctx:a}=this._processInputParams(e);return this._def.getter()._parse({data:a.data,path:a.path,parent:a})}}ZodLazy.create=(s,e)=>new ZodLazy({getter:s,typeName:ZodFirstPartyTypeKind.ZodLazy,...processCreateParams(e)});class ZodLiteral extends ZodType{_parse(e){if(e.data!==this._def.value){const a=this._getOrReturnCtx(e);return addIssueToContext(a,{received:a.data,code:ZodIssueCode.invalid_literal,expected:this._def.value}),INVALID}return{status:"valid",value:e.data}}get value(){return this._def.value}}ZodLiteral.create=(s,e)=>new ZodLiteral({value:s,typeName:ZodFirstPartyTypeKind.ZodLiteral,...processCreateParams(e)});function createZodEnum(s,e){return new ZodEnum({values:s,typeName:ZodFirstPartyTypeKind.ZodEnum,...processCreateParams(e)})}class ZodEnum extends ZodType{constructor(){super(...arguments),_ZodEnum_cache.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const a=this._getOrReturnCtx(e),o=this._def.values;return addIssueToContext(a,{expected:util.joinValues(o),received:a.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodEnum_cache)||__classPrivateFieldSet(this,_ZodEnum_cache,new Set(this._def.values)),!__classPrivateFieldGet(this,_ZodEnum_cache).has(e.data)){const a=this._getOrReturnCtx(e),o=this._def.values;return addIssueToContext(a,{received:a.data,code:ZodIssueCode.invalid_enum_value,options:o}),INVALID}return OK(e.data)}get options(){return this._def.values}get enum(){const e={};for(const a of this._def.values)e[a]=a;return e}get Values(){const e={};for(const a of this._def.values)e[a]=a;return e}get Enum(){const e={};for(const a of this._def.values)e[a]=a;return e}extract(e,a=this._def){return ZodEnum.create(e,{...this._def,...a})}exclude(e,a=this._def){return ZodEnum.create(this.options.filter(o=>!e.includes(o)),{...this._def,...a})}}_ZodEnum_cache=new WeakMap;ZodEnum.create=createZodEnum;class ZodNativeEnum extends ZodType{constructor(){super(...arguments),_ZodNativeEnum_cache.set(this,void 0)}_parse(e){const a=util.getValidEnumValues(this._def.values),o=this._getOrReturnCtx(e);if(o.parsedType!==ZodParsedType.string&&o.parsedType!==ZodParsedType.number){const c=util.objectValues(a);return addIssueToContext(o,{expected:util.joinValues(c),received:o.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodNativeEnum_cache)||__classPrivateFieldSet(this,_ZodNativeEnum_cache,new Set(util.getValidEnumValues(this._def.values))),!__classPrivateFieldGet(this,_ZodNativeEnum_cache).has(e.data)){const c=util.objectValues(a);return addIssueToContext(o,{received:o.data,code:ZodIssueCode.invalid_enum_value,options:c}),INVALID}return OK(e.data)}get enum(){return this._def.values}}_ZodNativeEnum_cache=new WeakMap;ZodNativeEnum.create=(s,e)=>new ZodNativeEnum({values:s,typeName:ZodFirstPartyTypeKind.ZodNativeEnum,...processCreateParams(e)});class ZodPromise extends ZodType{unwrap(){return this._def.type}_parse(e){const{ctx:a}=this._processInputParams(e);if(a.parsedType!==ZodParsedType.promise&&a.common.async===!1)return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.promise,received:a.parsedType}),INVALID;const o=a.parsedType===ZodParsedType.promise?a.data:Promise.resolve(a.data);return OK(o.then(c=>this._def.type.parseAsync(c,{path:a.path,errorMap:a.common.contextualErrorMap})))}}ZodPromise.create=(s,e)=>new ZodPromise({type:s,typeName:ZodFirstPartyTypeKind.ZodPromise,...processCreateParams(e)});class ZodEffects extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ZodFirstPartyTypeKind.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:a,ctx:o}=this._processInputParams(e),c=this._def.effect||null,d={addIssue:h=>{addIssueToContext(o,h),h.fatal?a.abort():a.dirty()},get path(){return o.path}};if(d.addIssue=d.addIssue.bind(d),c.type==="preprocess"){const h=c.transform(o.data,d);if(o.common.async)return Promise.resolve(h).then(async g=>{if(a.value==="aborted")return INVALID;const _=await this._def.schema._parseAsync({data:g,path:o.path,parent:o});return _.status==="aborted"?INVALID:_.status==="dirty"||a.value==="dirty"?DIRTY(_.value):_});{if(a.value==="aborted")return INVALID;const g=this._def.schema._parseSync({data:h,path:o.path,parent:o});return g.status==="aborted"?INVALID:g.status==="dirty"||a.value==="dirty"?DIRTY(g.value):g}}if(c.type==="refinement"){const h=g=>{const _=c.refinement(g,d);if(o.common.async)return Promise.resolve(_);if(_ instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return g};if(o.common.async===!1){const g=this._def.schema._parseSync({data:o.data,path:o.path,parent:o});return g.status==="aborted"?INVALID:(g.status==="dirty"&&a.dirty(),h(g.value),{status:a.value,value:g.value})}else return this._def.schema._parseAsync({data:o.data,path:o.path,parent:o}).then(g=>g.status==="aborted"?INVALID:(g.status==="dirty"&&a.dirty(),h(g.value).then(()=>({status:a.value,value:g.value}))))}if(c.type==="transform")if(o.common.async===!1){const h=this._def.schema._parseSync({data:o.data,path:o.path,parent:o});if(!isValid(h))return h;const g=c.transform(h.value,d);if(g instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:a.value,value:g}}else return this._def.schema._parseAsync({data:o.data,path:o.path,parent:o}).then(h=>isValid(h)?Promise.resolve(c.transform(h.value,d)).then(g=>({status:a.value,value:g})):h);util.assertNever(c)}}ZodEffects.create=(s,e,a)=>new ZodEffects({schema:s,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:e,...processCreateParams(a)});ZodEffects.createWithPreprocess=(s,e,a)=>new ZodEffects({schema:e,effect:{type:"preprocess",transform:s},typeName:ZodFirstPartyTypeKind.ZodEffects,...processCreateParams(a)});class ZodOptional extends ZodType{_parse(e){return this._getType(e)===ZodParsedType.undefined?OK(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ZodOptional.create=(s,e)=>new ZodOptional({innerType:s,typeName:ZodFirstPartyTypeKind.ZodOptional,...processCreateParams(e)});class ZodNullable extends ZodType{_parse(e){return this._getType(e)===ZodParsedType.null?OK(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ZodNullable.create=(s,e)=>new ZodNullable({innerType:s,typeName:ZodFirstPartyTypeKind.ZodNullable,...processCreateParams(e)});class ZodDefault extends ZodType{_parse(e){const{ctx:a}=this._processInputParams(e);let o=a.data;return a.parsedType===ZodParsedType.undefined&&(o=this._def.defaultValue()),this._def.innerType._parse({data:o,path:a.path,parent:a})}removeDefault(){return this._def.innerType}}ZodDefault.create=(s,e)=>new ZodDefault({innerType:s,typeName:ZodFirstPartyTypeKind.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...processCreateParams(e)});class ZodCatch extends ZodType{_parse(e){const{ctx:a}=this._processInputParams(e),o={...a,common:{...a.common,issues:[]}},c=this._def.innerType._parse({data:o.data,path:o.path,parent:{...o}});return isAsync(c)?c.then(d=>({status:"valid",value:d.status==="valid"?d.value:this._def.catchValue({get error(){return new ZodError(o.common.issues)},input:o.data})})):{status:"valid",value:c.status==="valid"?c.value:this._def.catchValue({get error(){return new ZodError(o.common.issues)},input:o.data})}}removeCatch(){return this._def.innerType}}ZodCatch.create=(s,e)=>new ZodCatch({innerType:s,typeName:ZodFirstPartyTypeKind.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...processCreateParams(e)});class ZodNaN extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.nan){const o=this._getOrReturnCtx(e);return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.nan,received:o.parsedType}),INVALID}return{status:"valid",value:e.data}}}ZodNaN.create=s=>new ZodNaN({typeName:ZodFirstPartyTypeKind.ZodNaN,...processCreateParams(s)});const BRAND=Symbol("zod_brand");class ZodBranded extends ZodType{_parse(e){const{ctx:a}=this._processInputParams(e),o=a.data;return this._def.type._parse({data:o,path:a.path,parent:a})}unwrap(){return this._def.type}}class ZodPipeline extends ZodType{_parse(e){const{status:a,ctx:o}=this._processInputParams(e);if(o.common.async)return(async()=>{const d=await this._def.in._parseAsync({data:o.data,path:o.path,parent:o});return d.status==="aborted"?INVALID:d.status==="dirty"?(a.dirty(),DIRTY(d.value)):this._def.out._parseAsync({data:d.value,path:o.path,parent:o})})();{const c=this._def.in._parseSync({data:o.data,path:o.path,parent:o});return c.status==="aborted"?INVALID:c.status==="dirty"?(a.dirty(),{status:"dirty",value:c.value}):this._def.out._parseSync({data:c.value,path:o.path,parent:o})}}static create(e,a){return new ZodPipeline({in:e,out:a,typeName:ZodFirstPartyTypeKind.ZodPipeline})}}class ZodReadonly extends ZodType{_parse(e){const a=this._def.innerType._parse(e),o=c=>(isValid(c)&&(c.value=Object.freeze(c.value)),c);return isAsync(a)?a.then(c=>o(c)):o(a)}unwrap(){return this._def.innerType}}ZodReadonly.create=(s,e)=>new ZodReadonly({innerType:s,typeName:ZodFirstPartyTypeKind.ZodReadonly,...processCreateParams(e)});function cleanParams(s,e){const a=typeof s=="function"?s(e):typeof s=="string"?{message:s}:s;return typeof a=="string"?{message:a}:a}function custom(s,e={},a){return s?ZodAny.create().superRefine((o,c)=>{var d,h;const g=s(o);if(g instanceof Promise)return g.then(_=>{var b,j;if(!_){const $=cleanParams(e,o),_e=(j=(b=$.fatal)!==null&&b!==void 0?b:a)!==null&&j!==void 0?j:!0;c.addIssue({code:"custom",...$,fatal:_e})}});if(!g){const _=cleanParams(e,o),b=(h=(d=_.fatal)!==null&&d!==void 0?d:a)!==null&&h!==void 0?h:!0;c.addIssue({code:"custom",..._,fatal:b})}}):ZodAny.create()}const late={object:ZodObject.lazycreate};var ZodFirstPartyTypeKind;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(ZodFirstPartyTypeKind||(ZodFirstPartyTypeKind={}));const instanceOfType=(s,e={message:`Input not instance of ${s.name}`})=>custom(a=>a instanceof s,e),stringType=ZodString.create,numberType=ZodNumber.create,nanType=ZodNaN.create,bigIntType=ZodBigInt.create,booleanType=ZodBoolean.create,dateType=ZodDate.create,symbolType=ZodSymbol.create,undefinedType=ZodUndefined.create,nullType=ZodNull.create,anyType=ZodAny.create,unknownType=ZodUnknown.create,neverType=ZodNever.create,voidType=ZodVoid.create,arrayType=ZodArray.create,objectType=ZodObject.create,strictObjectType=ZodObject.strictCreate,unionType=ZodUnion.create,discriminatedUnionType=ZodDiscriminatedUnion.create,intersectionType=ZodIntersection.create,tupleType=ZodTuple.create,recordType=ZodRecord.create,mapType=ZodMap.create,setType=ZodSet.create,functionType=ZodFunction.create,lazyType=ZodLazy.create,literalType=ZodLiteral.create,enumType=ZodEnum.create,nativeEnumType=ZodNativeEnum.create,promiseType=ZodPromise.create,effectsType=ZodEffects.create,optionalType=ZodOptional.create,nullableType=ZodNullable.create,preprocessType=ZodEffects.createWithPreprocess,pipelineType=ZodPipeline.create,ostring=()=>stringType().optional(),onumber=()=>numberType().optional(),oboolean=()=>booleanType().optional(),coerce={string:s=>ZodString.create({...s,coerce:!0}),number:s=>ZodNumber.create({...s,coerce:!0}),boolean:s=>ZodBoolean.create({...s,coerce:!0}),bigint:s=>ZodBigInt.create({...s,coerce:!0}),date:s=>ZodDate.create({...s,coerce:!0})},NEVER=INVALID;var z=Object.freeze({__proto__:null,defaultErrorMap:errorMap,setErrorMap,getErrorMap,makeIssue,EMPTY_PATH,addIssueToContext,ParseStatus,INVALID,DIRTY,OK,isAborted,isDirty,isValid,isAsync,get util(){return util},get objectUtil(){return objectUtil},ZodParsedType,getParsedType,ZodType,datetimeRegex,ZodString,ZodNumber,ZodBigInt,ZodBoolean,ZodDate,ZodSymbol,ZodUndefined,ZodNull,ZodAny,ZodUnknown,ZodNever,ZodVoid,ZodArray,ZodObject,ZodUnion,ZodDiscriminatedUnion,ZodIntersection,ZodTuple,ZodRecord,ZodMap,ZodSet,ZodFunction,ZodLazy,ZodLiteral,ZodEnum,ZodNativeEnum,ZodPromise,ZodEffects,ZodTransformer:ZodEffects,ZodOptional,ZodNullable,ZodDefault,ZodCatch,ZodNaN,BRAND,ZodBranded,ZodPipeline,ZodReadonly,custom,Schema:ZodType,ZodSchema:ZodType,late,get ZodFirstPartyTypeKind(){return ZodFirstPartyTypeKind},coerce,any:anyType,array:arrayType,bigint:bigIntType,boolean:booleanType,date:dateType,discriminatedUnion:discriminatedUnionType,effect:effectsType,enum:enumType,function:functionType,instanceof:instanceOfType,intersection:intersectionType,lazy:lazyType,literal:literalType,map:mapType,nan:nanType,nativeEnum:nativeEnumType,never:neverType,null:nullType,nullable:nullableType,number:numberType,object:objectType,oboolean,onumber,optional:optionalType,ostring,pipeline:pipelineType,preprocess:preprocessType,promise:promiseType,record:recordType,set:setType,strictObject:strictObjectType,string:stringType,symbol:symbolType,transformer:effectsType,tuple:tupleType,undefined:undefinedType,union:unionType,unknown:unknownType,void:voidType,NEVER,ZodIssueCode,quotelessJson,ZodError});function parseAnyDef(){return{}}function parseArrayDef(s,e){var o,c,d;const a={type:"array"};return(o=s.type)!=null&&o._def&&((d=(c=s.type)==null?void 0:c._def)==null?void 0:d.typeName)!==ZodFirstPartyTypeKind.ZodAny&&(a.items=parseDef(s.type._def,{...e,currentPath:[...e.currentPath,"items"]})),s.minLength&&setResponseValueAndErrors(a,"minItems",s.minLength.value,s.minLength.message,e),s.maxLength&&setResponseValueAndErrors(a,"maxItems",s.maxLength.value,s.maxLength.message,e),s.exactLength&&(setResponseValueAndErrors(a,"minItems",s.exactLength.value,s.exactLength.message,e),setResponseValueAndErrors(a,"maxItems",s.exactLength.value,s.exactLength.message,e)),a}function parseBigintDef(s,e){const a={type:"integer",format:"int64"};if(!s.checks)return a;for(const o of s.checks)switch(o.kind){case"min":e.target==="jsonSchema7"?o.inclusive?setResponseValueAndErrors(a,"minimum",o.value,o.message,e):setResponseValueAndErrors(a,"exclusiveMinimum",o.value,o.message,e):(o.inclusive||(a.exclusiveMinimum=!0),setResponseValueAndErrors(a,"minimum",o.value,o.message,e));break;case"max":e.target==="jsonSchema7"?o.inclusive?setResponseValueAndErrors(a,"maximum",o.value,o.message,e):setResponseValueAndErrors(a,"exclusiveMaximum",o.value,o.message,e):(o.inclusive||(a.exclusiveMaximum=!0),setResponseValueAndErrors(a,"maximum",o.value,o.message,e));break;case"multipleOf":setResponseValueAndErrors(a,"multipleOf",o.value,o.message,e);break}return a}function parseBooleanDef(){return{type:"boolean"}}function parseBrandedDef(s,e){return parseDef(s.type._def,e)}const parseCatchDef=(s,e)=>parseDef(s.innerType._def,e);function parseDateDef(s,e,a){const o=a??e.dateStrategy;if(Array.isArray(o))return{anyOf:o.map((c,d)=>parseDateDef(s,e,c))};switch(o){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return integerDateParser(s,e)}}const integerDateParser=(s,e)=>{const a={type:"integer",format:"unix-time"};if(e.target==="openApi3")return a;for(const o of s.checks)switch(o.kind){case"min":setResponseValueAndErrors(a,"minimum",o.value,o.message,e);break;case"max":setResponseValueAndErrors(a,"maximum",o.value,o.message,e);break}return a};function parseDefaultDef(s,e){return{...parseDef(s.innerType._def,e),default:s.defaultValue()}}function parseEffectsDef(s,e){return e.effectStrategy==="input"?parseDef(s.schema._def,e):{}}function parseEnumDef(s){return{type:"string",enum:Array.from(s.values)}}const isJsonSchema7AllOfType=s=>"type"in s&&s.type==="string"?!1:"allOf"in s;function parseIntersectionDef(s,e){const a=[parseDef(s.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),parseDef(s.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(d=>!!d);let o=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const c=[];return a.forEach(d=>{if(isJsonSchema7AllOfType(d))c.push(...d.allOf),d.unevaluatedProperties===void 0&&(o=void 0);else{let h=d;if("additionalProperties"in d&&d.additionalProperties===!1){const{additionalProperties:g,..._}=d;h=_}else o=void 0;c.push(h)}}),c.length?{allOf:c,...o}:void 0}function parseLiteralDef(s,e){const a=typeof s.value;return a!=="bigint"&&a!=="number"&&a!=="boolean"&&a!=="string"?{type:Array.isArray(s.value)?"array":"object"}:e.target==="openApi3"?{type:a==="bigint"?"integer":a,enum:[s.value]}:{type:a==="bigint"?"integer":a,const:s.value}}let emojiRegex;const zodPatterns={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(emojiRegex===void 0&&(emojiRegex=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),emojiRegex),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function parseStringDef(s,e){const a={type:"string"};if(s.checks)for(const o of s.checks)switch(o.kind){case"min":setResponseValueAndErrors(a,"minLength",typeof a.minLength=="number"?Math.max(a.minLength,o.value):o.value,o.message,e);break;case"max":setResponseValueAndErrors(a,"maxLength",typeof a.maxLength=="number"?Math.min(a.maxLength,o.value):o.value,o.message,e);break;case"email":switch(e.emailStrategy){case"format:email":addFormat(a,"email",o.message,e);break;case"format:idn-email":addFormat(a,"idn-email",o.message,e);break;case"pattern:zod":addPattern(a,zodPatterns.email,o.message,e);break}break;case"url":addFormat(a,"uri",o.message,e);break;case"uuid":addFormat(a,"uuid",o.message,e);break;case"regex":addPattern(a,o.regex,o.message,e);break;case"cuid":addPattern(a,zodPatterns.cuid,o.message,e);break;case"cuid2":addPattern(a,zodPatterns.cuid2,o.message,e);break;case"startsWith":addPattern(a,RegExp(`^${escapeLiteralCheckValue(o.value,e)}`),o.message,e);break;case"endsWith":addPattern(a,RegExp(`${escapeLiteralCheckValue(o.value,e)}$`),o.message,e);break;case"datetime":addFormat(a,"date-time",o.message,e);break;case"date":addFormat(a,"date",o.message,e);break;case"time":addFormat(a,"time",o.message,e);break;case"duration":addFormat(a,"duration",o.message,e);break;case"length":setResponseValueAndErrors(a,"minLength",typeof a.minLength=="number"?Math.max(a.minLength,o.value):o.value,o.message,e),setResponseValueAndErrors(a,"maxLength",typeof a.maxLength=="number"?Math.min(a.maxLength,o.value):o.value,o.message,e);break;case"includes":{addPattern(a,RegExp(escapeLiteralCheckValue(o.value,e)),o.message,e);break}case"ip":{o.version!=="v6"&&addFormat(a,"ipv4",o.message,e),o.version!=="v4"&&addFormat(a,"ipv6",o.message,e);break}case"base64url":addPattern(a,zodPatterns.base64url,o.message,e);break;case"jwt":addPattern(a,zodPatterns.jwt,o.message,e);break;case"cidr":{o.version!=="v6"&&addPattern(a,zodPatterns.ipv4Cidr,o.message,e),o.version!=="v4"&&addPattern(a,zodPatterns.ipv6Cidr,o.message,e);break}case"emoji":addPattern(a,zodPatterns.emoji(),o.message,e);break;case"ulid":{addPattern(a,zodPatterns.ulid,o.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{addFormat(a,"binary",o.message,e);break}case"contentEncoding:base64":{setResponseValueAndErrors(a,"contentEncoding","base64",o.message,e);break}case"pattern:zod":{addPattern(a,zodPatterns.base64,o.message,e);break}}break}case"nanoid":addPattern(a,zodPatterns.nanoid,o.message,e)}return a}function escapeLiteralCheckValue(s,e){return e.patternStrategy==="escape"?escapeNonAlphaNumeric(s):s}const ALPHA_NUMERIC=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function escapeNonAlphaNumeric(s){let e="";for(let a=0;a<s.length;a++)ALPHA_NUMERIC.has(s[a])||(e+="\\"),e+=s[a];return e}function addFormat(s,e,a,o){var c;s.format||(c=s.anyOf)!=null&&c.some(d=>d.format)?(s.anyOf||(s.anyOf=[]),s.format&&(s.anyOf.push({format:s.format,...s.errorMessage&&o.errorMessages&&{errorMessage:{format:s.errorMessage.format}}}),delete s.format,s.errorMessage&&(delete s.errorMessage.format,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.anyOf.push({format:e,...a&&o.errorMessages&&{errorMessage:{format:a}}})):setResponseValueAndErrors(s,"format",e,a,o)}function addPattern(s,e,a,o){var c;s.pattern||(c=s.allOf)!=null&&c.some(d=>d.pattern)?(s.allOf||(s.allOf=[]),s.pattern&&(s.allOf.push({pattern:s.pattern,...s.errorMessage&&o.errorMessages&&{errorMessage:{pattern:s.errorMessage.pattern}}}),delete s.pattern,s.errorMessage&&(delete s.errorMessage.pattern,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.allOf.push({pattern:stringifyRegExpWithFlags(e,o),...a&&o.errorMessages&&{errorMessage:{pattern:a}}})):setResponseValueAndErrors(s,"pattern",stringifyRegExpWithFlags(e,o),a,o)}function stringifyRegExpWithFlags(s,e){var _;if(!e.applyRegexFlags||!s.flags)return s.source;const a={i:s.flags.includes("i"),m:s.flags.includes("m"),s:s.flags.includes("s")},o=a.i?s.source.toLowerCase():s.source;let c="",d=!1,h=!1,g=!1;for(let b=0;b<o.length;b++){if(d){c+=o[b],d=!1;continue}if(a.i){if(h){if(o[b].match(/[a-z]/)){g?(c+=o[b],c+=`${o[b-2]}-${o[b]}`.toUpperCase(),g=!1):o[b+1]==="-"&&((_=o[b+2])!=null&&_.match(/[a-z]/))?(c+=o[b],g=!0):c+=`${o[b]}${o[b].toUpperCase()}`;continue}}else if(o[b].match(/[a-z]/)){c+=`[${o[b]}${o[b].toUpperCase()}]`;continue}}if(a.m){if(o[b]==="^"){c+=`(^|(?<=[\r
]))`;continue}else if(o[b]==="$"){c+=`($|(?=[\r
]))`;continue}}if(a.s&&o[b]==="."){c+=h?`${o[b]}\r
`:`[${o[b]}\r
]`;continue}c+=o[b],o[b]==="\\"?d=!0:h&&o[b]==="]"?h=!1:!h&&o[b]==="["&&(h=!0)}try{new RegExp(c)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),s.source}return c}function parseRecordDef(s,e){var o,c,d,h,g,_;if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&((o=s.keyType)==null?void 0:o._def.typeName)===ZodFirstPartyTypeKind.ZodEnum)return{type:"object",required:s.keyType._def.values,properties:s.keyType._def.values.reduce((b,j)=>({...b,[j]:parseDef(s.valueType._def,{...e,currentPath:[...e.currentPath,"properties",j]})??{}}),{}),additionalProperties:!1};const a={type:"object",additionalProperties:parseDef(s.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return a;if(((c=s.keyType)==null?void 0:c._def.typeName)===ZodFirstPartyTypeKind.ZodString&&((d=s.keyType._def.checks)!=null&&d.length)){const{type:b,...j}=parseStringDef(s.keyType._def,e);return{...a,propertyNames:j}}else{if(((h=s.keyType)==null?void 0:h._def.typeName)===ZodFirstPartyTypeKind.ZodEnum)return{...a,propertyNames:{enum:s.keyType._def.values}};if(((g=s.keyType)==null?void 0:g._def.typeName)===ZodFirstPartyTypeKind.ZodBranded&&s.keyType._def.type._def.typeName===ZodFirstPartyTypeKind.ZodString&&((_=s.keyType._def.type._def.checks)!=null&&_.length)){const{type:b,...j}=parseBrandedDef(s.keyType._def,e);return{...a,propertyNames:j}}}return a}function parseMapDef(s,e){if(e.mapStrategy==="record")return parseRecordDef(s,e);const a=parseDef(s.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},o=parseDef(s.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[a,o],minItems:2,maxItems:2}}}function parseNativeEnumDef(s){const e=s.values,o=Object.keys(s.values).filter(d=>typeof e[e[d]]!="number").map(d=>e[d]),c=Array.from(new Set(o.map(d=>typeof d)));return{type:c.length===1?c[0]==="string"?"string":"number":["string","number"],enum:o}}function parseNeverDef(){return{not:{}}}function parseNullDef(s){return s.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const primitiveMappings={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function parseUnionDef(s,e){if(e.target==="openApi3")return asAnyOf(s,e);const a=s.options instanceof Map?Array.from(s.options.values()):s.options;if(a.every(o=>o._def.typeName in primitiveMappings&&(!o._def.checks||!o._def.checks.length))){const o=a.reduce((c,d)=>{const h=primitiveMappings[d._def.typeName];return h&&!c.includes(h)?[...c,h]:c},[]);return{type:o.length>1?o:o[0]}}else if(a.every(o=>o._def.typeName==="ZodLiteral"&&!o.description)){const o=a.reduce((c,d)=>{const h=typeof d._def.value;switch(h){case"string":case"number":case"boolean":return[...c,h];case"bigint":return[...c,"integer"];case"object":if(d._def.value===null)return[...c,"null"];case"symbol":case"undefined":case"function":default:return c}},[]);if(o.length===a.length){const c=o.filter((d,h,g)=>g.indexOf(d)===h);return{type:c.length>1?c:c[0],enum:a.reduce((d,h)=>d.includes(h._def.value)?d:[...d,h._def.value],[])}}}else if(a.every(o=>o._def.typeName==="ZodEnum"))return{type:"string",enum:a.reduce((o,c)=>[...o,...c._def.values.filter(d=>!o.includes(d))],[])};return asAnyOf(s,e)}const asAnyOf=(s,e)=>{const a=(s.options instanceof Map?Array.from(s.options.values()):s.options).map((o,c)=>parseDef(o._def,{...e,currentPath:[...e.currentPath,"anyOf",`${c}`]})).filter(o=>!!o&&(!e.strictUnions||typeof o=="object"&&Object.keys(o).length>0));return a.length?{anyOf:a}:void 0};function parseNullableDef(s,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(s.innerType._def.typeName)&&(!s.innerType._def.checks||!s.innerType._def.checks.length))return e.target==="openApi3"?{type:primitiveMappings[s.innerType._def.typeName],nullable:!0}:{type:[primitiveMappings[s.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const o=parseDef(s.innerType._def,{...e,currentPath:[...e.currentPath]});return o&&"$ref"in o?{allOf:[o],nullable:!0}:o&&{...o,nullable:!0}}const a=parseDef(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return a&&{anyOf:[a,{type:"null"}]}}function parseNumberDef(s,e){const a={type:"number"};if(!s.checks)return a;for(const o of s.checks)switch(o.kind){case"int":a.type="integer",addErrorMessage(a,"type",o.message,e);break;case"min":e.target==="jsonSchema7"?o.inclusive?setResponseValueAndErrors(a,"minimum",o.value,o.message,e):setResponseValueAndErrors(a,"exclusiveMinimum",o.value,o.message,e):(o.inclusive||(a.exclusiveMinimum=!0),setResponseValueAndErrors(a,"minimum",o.value,o.message,e));break;case"max":e.target==="jsonSchema7"?o.inclusive?setResponseValueAndErrors(a,"maximum",o.value,o.message,e):setResponseValueAndErrors(a,"exclusiveMaximum",o.value,o.message,e):(o.inclusive||(a.exclusiveMaximum=!0),setResponseValueAndErrors(a,"maximum",o.value,o.message,e));break;case"multipleOf":setResponseValueAndErrors(a,"multipleOf",o.value,o.message,e);break}return a}function decideAdditionalProperties(s,e){return e.removeAdditionalStrategy==="strict"?s.catchall._def.typeName==="ZodNever"?s.unknownKeys!=="strict":parseDef(s.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:s.catchall._def.typeName==="ZodNever"?s.unknownKeys==="passthrough":parseDef(s.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function parseObjectDef(s,e){const a=e.target==="openAi",o={type:"object",...Object.entries(s.shape()).reduce((c,[d,h])=>{if(h===void 0||h._def===void 0)return c;let g=h.isOptional();g&&a&&(h instanceof ZodOptional&&(h=h._def.innerType),h.isNullable()||(h=h.nullable()),g=!1);const _=parseDef(h._def,{...e,currentPath:[...e.currentPath,"properties",d],propertyPath:[...e.currentPath,"properties",d]});return _===void 0?c:{properties:{...c.properties,[d]:_},required:g?c.required:[...c.required,d]}},{properties:{},required:[]}),additionalProperties:decideAdditionalProperties(s,e)};return o.required.length||delete o.required,o}const parseOptionalDef=(s,e)=>{var o;if(e.currentPath.toString()===((o=e.propertyPath)==null?void 0:o.toString()))return parseDef(s.innerType._def,e);const a=parseDef(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return a?{anyOf:[{not:{}},a]}:{}},parsePipelineDef=(s,e)=>{if(e.pipeStrategy==="input")return parseDef(s.in._def,e);if(e.pipeStrategy==="output")return parseDef(s.out._def,e);const a=parseDef(s.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),o=parseDef(s.out._def,{...e,currentPath:[...e.currentPath,"allOf",a?"1":"0"]});return{allOf:[a,o].filter(c=>c!==void 0)}};function parsePromiseDef(s,e){return parseDef(s.type._def,e)}function parseSetDef(s,e){const o={type:"array",uniqueItems:!0,items:parseDef(s.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return s.minSize&&setResponseValueAndErrors(o,"minItems",s.minSize.value,s.minSize.message,e),s.maxSize&&setResponseValueAndErrors(o,"maxItems",s.maxSize.value,s.maxSize.message,e),o}function parseTupleDef(s,e){return s.rest?{type:"array",minItems:s.items.length,items:s.items.map((a,o)=>parseDef(a._def,{...e,currentPath:[...e.currentPath,"items",`${o}`]})).reduce((a,o)=>o===void 0?a:[...a,o],[]),additionalItems:parseDef(s.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:s.items.length,maxItems:s.items.length,items:s.items.map((a,o)=>parseDef(a._def,{...e,currentPath:[...e.currentPath,"items",`${o}`]})).reduce((a,o)=>o===void 0?a:[...a,o],[])}}function parseUndefinedDef(){return{not:{}}}function parseUnknownDef(){return{}}const parseReadonlyDef=(s,e)=>parseDef(s.innerType._def,e);function parseDef(s,e,a=!1){var h;const o=e.seen.get(s);if(e.override){const g=(h=e.override)==null?void 0:h.call(e,s,e,o,a);if(g!==ignoreOverride)return g}if(o&&!a){const g=get$ref(o,e);if(g!==void 0)return g}const c={def:s,path:e.currentPath,jsonSchema:void 0};e.seen.set(s,c);const d=selectParser(s,s.typeName,e);return d&&addMeta(s,e,d),c.jsonSchema=d,d}const get$ref=(s,e)=>{switch(e.$refStrategy){case"root":return{$ref:s.path.join("/")};case"relative":return{$ref:getRelativePath(e.currentPath,s.path)};case"none":case"seen":return s.path.length<e.currentPath.length&&s.path.every((a,o)=>e.currentPath[o]===a)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},getRelativePath=(s,e)=>{let a=0;for(;a<s.length&&a<e.length&&s[a]===e[a];a++);return[(s.length-a).toString(),...e.slice(a)].join("/")},selectParser=(s,e,a)=>{switch(e){case ZodFirstPartyTypeKind.ZodString:return parseStringDef(s,a);case ZodFirstPartyTypeKind.ZodNumber:return parseNumberDef(s,a);case ZodFirstPartyTypeKind.ZodObject:return parseObjectDef(s,a);case ZodFirstPartyTypeKind.ZodBigInt:return parseBigintDef(s,a);case ZodFirstPartyTypeKind.ZodBoolean:return parseBooleanDef();case ZodFirstPartyTypeKind.ZodDate:return parseDateDef(s,a);case ZodFirstPartyTypeKind.ZodUndefined:return parseUndefinedDef();case ZodFirstPartyTypeKind.ZodNull:return parseNullDef(a);case ZodFirstPartyTypeKind.ZodArray:return parseArrayDef(s,a);case ZodFirstPartyTypeKind.ZodUnion:case ZodFirstPartyTypeKind.ZodDiscriminatedUnion:return parseUnionDef(s,a);case ZodFirstPartyTypeKind.ZodIntersection:return parseIntersectionDef(s,a);case ZodFirstPartyTypeKind.ZodTuple:return parseTupleDef(s,a);case ZodFirstPartyTypeKind.ZodRecord:return parseRecordDef(s,a);case ZodFirstPartyTypeKind.ZodLiteral:return parseLiteralDef(s,a);case ZodFirstPartyTypeKind.ZodEnum:return parseEnumDef(s);case ZodFirstPartyTypeKind.ZodNativeEnum:return parseNativeEnumDef(s);case ZodFirstPartyTypeKind.ZodNullable:return parseNullableDef(s,a);case ZodFirstPartyTypeKind.ZodOptional:return parseOptionalDef(s,a);case ZodFirstPartyTypeKind.ZodMap:return parseMapDef(s,a);case ZodFirstPartyTypeKind.ZodSet:return parseSetDef(s,a);case ZodFirstPartyTypeKind.ZodLazy:return parseDef(s.getter()._def,a);case ZodFirstPartyTypeKind.ZodPromise:return parsePromiseDef(s,a);case ZodFirstPartyTypeKind.ZodNaN:case ZodFirstPartyTypeKind.ZodNever:return parseNeverDef();case ZodFirstPartyTypeKind.ZodEffects:return parseEffectsDef(s,a);case ZodFirstPartyTypeKind.ZodAny:return parseAnyDef();case ZodFirstPartyTypeKind.ZodUnknown:return parseUnknownDef();case ZodFirstPartyTypeKind.ZodDefault:return parseDefaultDef(s,a);case ZodFirstPartyTypeKind.ZodBranded:return parseBrandedDef(s,a);case ZodFirstPartyTypeKind.ZodReadonly:return parseReadonlyDef(s,a);case ZodFirstPartyTypeKind.ZodCatch:return parseCatchDef(s,a);case ZodFirstPartyTypeKind.ZodPipeline:return parsePipelineDef(s,a);case ZodFirstPartyTypeKind.ZodFunction:case ZodFirstPartyTypeKind.ZodVoid:case ZodFirstPartyTypeKind.ZodSymbol:return;default:return(o=>{})()}},addMeta=(s,e,a)=>(s.description&&(a.description=s.description,e.markdownDescription&&(a.markdownDescription=s.description)),a),zodToJsonSchema=(s,e)=>{const a=getRefs(e),o=void 0,c=e==null?void 0:e.name,d=parseDef(s._def,a,!1)??{},h=c===void 0?o?{...d,[a.definitionPath]:o}:d:{$ref:[...a.$refStrategy==="relative"?[]:a.basePath,a.definitionPath,c].join("/"),[a.definitionPath]:{...o,[c]:d}};return a.target==="jsonSchema7"?h.$schema="http://json-schema.org/draft-07/schema#":(a.target==="jsonSchema2019-09"||a.target==="openAi")&&(h.$schema="https://json-schema.org/draft/2019-09/schema#"),a.target==="openAi"&&("anyOf"in h||"oneOf"in h||"allOf"in h||"type"in h&&Array.isArray(h.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),h};function parseJsonMarkdown(s,e=parsePartialJson){s=s.trim();const a=/```(json)?(.*)```/s.exec(s);return e(a?a[2]:s)}function parsePartialJson(s){if(typeof s>"u")return null;try{return JSON.parse(s)}catch{}let e="";const a=[];let o=!1,c=!1;for(let d of s){if(o)d==='"'&&!c?o=!1:d===`
`&&!c?d="\\n":d==="\\"?c=!c:c=!1;else if(d==='"')o=!0,c=!1;else if(d==="{")a.push("}");else if(d==="[")a.push("]");else if(d==="}"||d==="]")if(a&&a[a.length-1]===d)a.pop();else return null;e+=d}o&&(e+='"');for(let d=a.length-1;d>=0;d-=1)e+=a[d];try{return JSON.parse(e)}catch{return null}}var decamelize=function(s,e){if(typeof s!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,s.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()};const snakeCase=getDefaultExportFromCjs(decamelize);var camelcase={exports:{}};const UPPERCASE=/[\p{Lu}]/u,LOWERCASE=/[\p{Ll}]/u,LEADING_CAPITAL=/^[\p{Lu}](?![\p{Lu}])/gu,IDENTIFIER=/([\p{Alpha}\p{N}_]|$)/u,SEPARATORS=/[_.\- ]+/,LEADING_SEPARATORS=new RegExp("^"+SEPARATORS.source),SEPARATORS_AND_IDENTIFIER=new RegExp(SEPARATORS.source+IDENTIFIER.source,"gu"),NUMBERS_AND_IDENTIFIER=new RegExp("\\d+"+IDENTIFIER.source,"gu"),preserveCamelCase=(s,e,a)=>{let o=!1,c=!1,d=!1;for(let h=0;h<s.length;h++){const g=s[h];o&&UPPERCASE.test(g)?(s=s.slice(0,h)+"-"+s.slice(h),o=!1,d=c,c=!0,h++):c&&d&&LOWERCASE.test(g)?(s=s.slice(0,h-1)+"-"+s.slice(h-1),d=c,c=!1,o=!0):(o=e(g)===g&&a(g)!==g,d=c,c=a(g)===g&&e(g)!==g)}return s},preserveConsecutiveUppercase=(s,e)=>(LEADING_CAPITAL.lastIndex=0,s.replace(LEADING_CAPITAL,a=>e(a))),postProcess=(s,e)=>(SEPARATORS_AND_IDENTIFIER.lastIndex=0,NUMBERS_AND_IDENTIFIER.lastIndex=0,s.replace(SEPARATORS_AND_IDENTIFIER,(a,o)=>e(o)).replace(NUMBERS_AND_IDENTIFIER,a=>e(a))),camelCase=(s,e)=>{if(!(typeof s=="string"||Array.isArray(s)))throw new TypeError("Expected the input to be `string | string[]`");if(e={pascalCase:!1,preserveConsecutiveUppercase:!1,...e},Array.isArray(s)?s=s.map(d=>d.trim()).filter(d=>d.length).join("-"):s=s.trim(),s.length===0)return"";const a=e.locale===!1?d=>d.toLowerCase():d=>d.toLocaleLowerCase(e.locale),o=e.locale===!1?d=>d.toUpperCase():d=>d.toLocaleUpperCase(e.locale);return s.length===1?e.pascalCase?o(s):a(s):(s!==a(s)&&(s=preserveCamelCase(s,a,o)),s=s.replace(LEADING_SEPARATORS,""),e.preserveConsecutiveUppercase?s=preserveConsecutiveUppercase(s,a):s=a(s),e.pascalCase&&(s=o(s.charAt(0))+s.slice(1)),postProcess(s,o))};camelcase.exports=camelCase;camelcase.exports.default=camelCase;function keyToJson(s,e){return(e==null?void 0:e[s])||snakeCase(s)}function mapKeys(s,e,a){const o={};for(const c in s)Object.hasOwn(s,c)&&(o[e(c,a)]=s[c]);return o}function shallowCopy(s){return Array.isArray(s)?[...s]:{...s}}function replaceSecrets(s,e){const a=shallowCopy(s);for(const[o,c]of Object.entries(e)){const[d,...h]=o.split(".").reverse();let g=a;for(const _ of h.reverse()){if(g[_]===void 0)break;g[_]=shallowCopy(g[_]),g=g[_]}g[d]!==void 0&&(g[d]={lc:1,type:"secret",id:[c]})}return a}function get_lc_unique_name(s){const e=Object.getPrototypeOf(s);return typeof s.lc_name=="function"&&(typeof e.lc_name!="function"||s.lc_name()!==e.lc_name())?s.lc_name():s.name}class Serializable{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,get_lc_unique_name(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}constructor(e,...a){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_serializable_keys!==void 0?this.lc_kwargs=Object.fromEntries(Object.entries(e||{}).filter(([o])=>{var c;return(c=this.lc_serializable_keys)==null?void 0:c.includes(o)})):this.lc_kwargs=e??{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof Serializable||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},a={},o=Object.keys(this.lc_kwargs).reduce((c,d)=>(c[d]=d in this?this[d]:this.lc_kwargs[d],c),{});for(let c=Object.getPrototypeOf(this);c;c=Object.getPrototypeOf(c))Object.assign(e,Reflect.get(c,"lc_aliases",this)),Object.assign(a,Reflect.get(c,"lc_secrets",this)),Object.assign(o,Reflect.get(c,"lc_attributes",this));return Object.keys(a).forEach(c=>{let d=this,h=o;const[g,..._]=c.split(".").reverse();for(const b of _.reverse()){if(!(b in d)||d[b]===void 0)return;(!(b in h)||h[b]===void 0)&&(typeof d[b]=="object"&&d[b]!=null?h[b]={}:Array.isArray(d[b])&&(h[b]=[])),d=d[b],h=h[b]}g in d&&d[g]!==void 0&&(h[g]=h[g]||d[g])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:mapKeys(Object.keys(a).length?replaceSecrets(o,a):o,keyToJson,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}function mergeContent(s,e){return typeof s=="string"?typeof e=="string"?s+e:[{type:"text",text:s},...e]:Array.isArray(e)?_mergeLists(s,e)??[...s,...e]:[...s,{type:"text",text:e}]}function stringifyWithDepthLimit(s,e){function a(o,c){if(typeof o!="object"||o===null||o===void 0)return o;if(c>=e)return Array.isArray(o)?"[Array]":"[Object]";if(Array.isArray(o))return o.map(h=>a(h,c+1));const d={};for(const h of Object.keys(o))d[h]=a(o[h],c+1);return d}return JSON.stringify(a(s,0),null,2)}class BaseMessage extends Serializable{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:""}getType(){return this._getType()}constructor(e,a){typeof e=="string"&&(e={content:e,additional_kwargs:a,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;const a=stringifyWithDepthLimit(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${a}`}}function _mergeDicts(s,e){const a={...s};for(const[o,c]of Object.entries(e))if(a[o]==null)a[o]=c;else{if(c==null)continue;if(typeof a[o]!=typeof c||Array.isArray(a[o])!==Array.isArray(c))throw new Error(`field[${o}] already exists in the message chunk, but with a different type.`);if(typeof a[o]=="string"){if(o==="type")continue;a[o]+=c}else if(typeof a[o]=="object"&&!Array.isArray(a[o]))a[o]=_mergeDicts(a[o],c);else if(Array.isArray(a[o]))a[o]=_mergeLists(a[o],c);else{if(a[o]===c)continue;console.warn(`field[${o}] already exists in this message chunk and value has unsupported type.`)}}return a}function _mergeLists(s,e){if(!(s===void 0&&e===void 0)){if(s===void 0||e===void 0)return s||e;{const a=[...s];for(const o of e)if(typeof o=="object"&&"index"in o&&typeof o.index=="number"){const c=a.findIndex(d=>d.index===o.index);c!==-1?a[c]=_mergeDicts(a[c],o):a.push(o)}else{if(typeof o=="object"&&"text"in o&&o.text==="")continue;a.push(o)}return a}}}class BaseMessageChunk extends BaseMessage{}function _isMessageFieldWithRole(s){return typeof s.role=="string"}function isBaseMessage(s){return typeof(s==null?void 0:s._getType)=="function"}function isBaseMessageChunk(s){return isBaseMessage(s)&&typeof s.concat=="function"}class ToolMessage extends BaseMessage{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(e,a,o){typeof e=="string"&&(e={content:e,name:o,tool_call_id:a}),super(e),Object.defineProperty(this,"lc_direct_tool_output",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}_getType(){return"tool"}static isInstance(e){return e._getType()==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}function defaultToolCallParser(s){const e=[],a=[];for(const o of s)if(o.function){const c=o.function.name;try{const d=JSON.parse(o.function.arguments),h={name:c||"",args:d||{},id:o.id};e.push(h)}catch{a.push({name:c,args:o.function.arguments,id:o.id,error:"Malformed args."})}}else continue;return[e,a]}class AIMessage extends BaseMessage{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,a){var c;let o;if(typeof e=="string")o={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:a??{}};else{o=e;const d=(c=o.additional_kwargs)==null?void 0:c.tool_calls,h=o.tool_calls;d!=null&&d.length>0&&(h===void 0||h.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(d!=null&&h===void 0){const[g,_]=defaultToolCallParser(d);o.tool_calls=g??[],o.invalid_tool_calls=_??[]}else o.tool_calls=o.tool_calls??[],o.invalid_tool_calls=o.invalid_tool_calls??[]}catch{o.tool_calls=[],o.invalid_tool_calls=[]}}super(o),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof o!="string"&&(this.tool_calls=o.tool_calls??this.tool_calls,this.invalid_tool_calls=o.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=o.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}}function isAIMessage(s){return s._getType()==="ai"}function isAIMessageChunk(s){return s._getType()==="ai"}class AIMessageChunk extends BaseMessageChunk{constructor(e){let a;if(typeof e=="string")a={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0)a={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0};else{const o=[],c=[];for(const d of e.tool_call_chunks){let h={};try{if(h=parsePartialJson(d.args||"{}"),h===null||typeof h!="object"||Array.isArray(h))throw new Error("Malformed tool call chunk args.");o.push({name:d.name??"",args:h,id:d.id,type:"tool_call"})}catch{c.push({name:d.name,args:d.args,id:d.id,error:"Malformed args.",type:"invalid_tool_call"})}}a={...e,tool_calls:o,invalid_tool_calls:c,usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0}}super(a),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=a.tool_call_chunks??this.tool_call_chunks,this.tool_calls=a.tool_calls??this.tool_calls,this.invalid_tool_calls=a.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=a.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){var o,c,d,h,g,_,b,j,$,_e,tt,et,st,rt,nt,it,at,dt,ot,ht,ut,pt,_t,wt,mt,Et,Pt,jt,St,Ot,Ct,Rt,bt,Tt,$t,xt,ft,yt,vt,It;const a={content:mergeContent(this.content,e.content),additional_kwargs:_mergeDicts(this.additional_kwargs,e.additional_kwargs),response_metadata:_mergeDicts(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){const Lt=_mergeLists(this.tool_call_chunks,e.tool_call_chunks);Lt!==void 0&&Lt.length>0&&(a.tool_call_chunks=Lt)}if(this.usage_metadata!==void 0||e.usage_metadata!==void 0){const Lt={...(((c=(o=this.usage_metadata)==null?void 0:o.input_token_details)==null?void 0:c.audio)!==void 0||((h=(d=e.usage_metadata)==null?void 0:d.input_token_details)==null?void 0:h.audio)!==void 0)&&{audio:(((_=(g=this.usage_metadata)==null?void 0:g.input_token_details)==null?void 0:_.audio)??0)+(((j=(b=e.usage_metadata)==null?void 0:b.input_token_details)==null?void 0:j.audio)??0)},...(((_e=($=this.usage_metadata)==null?void 0:$.input_token_details)==null?void 0:_e.cache_read)!==void 0||((et=(tt=e.usage_metadata)==null?void 0:tt.input_token_details)==null?void 0:et.cache_read)!==void 0)&&{cache_read:(((rt=(st=this.usage_metadata)==null?void 0:st.input_token_details)==null?void 0:rt.cache_read)??0)+(((it=(nt=e.usage_metadata)==null?void 0:nt.input_token_details)==null?void 0:it.cache_read)??0)},...(((dt=(at=this.usage_metadata)==null?void 0:at.input_token_details)==null?void 0:dt.cache_creation)!==void 0||((ht=(ot=e.usage_metadata)==null?void 0:ot.input_token_details)==null?void 0:ht.cache_creation)!==void 0)&&{cache_creation:(((pt=(ut=this.usage_metadata)==null?void 0:ut.input_token_details)==null?void 0:pt.cache_creation)??0)+(((wt=(_t=e.usage_metadata)==null?void 0:_t.input_token_details)==null?void 0:wt.cache_creation)??0)}},Nt={...(((Et=(mt=this.usage_metadata)==null?void 0:mt.output_token_details)==null?void 0:Et.audio)!==void 0||((jt=(Pt=e.usage_metadata)==null?void 0:Pt.output_token_details)==null?void 0:jt.audio)!==void 0)&&{audio:(((Ot=(St=this.usage_metadata)==null?void 0:St.output_token_details)==null?void 0:Ot.audio)??0)+(((Rt=(Ct=e.usage_metadata)==null?void 0:Ct.output_token_details)==null?void 0:Rt.audio)??0)},...(((Tt=(bt=this.usage_metadata)==null?void 0:bt.output_token_details)==null?void 0:Tt.reasoning)!==void 0||((xt=($t=e.usage_metadata)==null?void 0:$t.output_token_details)==null?void 0:xt.reasoning)!==void 0)&&{reasoning:(((yt=(ft=this.usage_metadata)==null?void 0:ft.output_token_details)==null?void 0:yt.reasoning)??0)+(((It=(vt=e.usage_metadata)==null?void 0:vt.output_token_details)==null?void 0:It.reasoning)??0)}},Bt=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},Kt=e.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},rn={input_tokens:Bt.input_tokens+Kt.input_tokens,output_tokens:Bt.output_tokens+Kt.output_tokens,total_tokens:Bt.total_tokens+Kt.total_tokens,...Object.keys(Lt).length>0&&{input_token_details:Lt},...Object.keys(Nt).length>0&&{output_token_details:Nt}};a.usage_metadata=rn}return new AIMessageChunk(a)}}class ChatMessage extends BaseMessage{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return ChatMessage}constructor(e,a){typeof e=="string"&&(e={content:e,role:a}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return e._getType()==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}}class ChatMessageChunk extends BaseMessageChunk{static lc_name(){return"ChatMessageChunk"}constructor(e,a){typeof e=="string"&&(e={content:e,role:a}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new ChatMessageChunk({content:mergeContent(this.content,e.content),additional_kwargs:_mergeDicts(this.additional_kwargs,e.additional_kwargs),response_metadata:_mergeDicts(this.response_metadata,e.response_metadata),role:this.role,id:this.id??e.id})}get _printableFields(){return{...super._printableFields,role:this.role}}}class FunctionMessageChunk extends BaseMessageChunk{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new FunctionMessageChunk({content:mergeContent(this.content,e.content),additional_kwargs:_mergeDicts(this.additional_kwargs,e.additional_kwargs),response_metadata:_mergeDicts(this.response_metadata,e.response_metadata),name:this.name??"",id:this.id??e.id})}}class HumanMessage extends BaseMessage{static lc_name(){return"HumanMessage"}_getType(){return"human"}}class HumanMessageChunk extends BaseMessageChunk{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}concat(e){return new HumanMessageChunk({content:mergeContent(this.content,e.content),additional_kwargs:_mergeDicts(this.additional_kwargs,e.additional_kwargs),response_metadata:_mergeDicts(this.response_metadata,e.response_metadata),id:this.id??e.id})}}class SystemMessage extends BaseMessage{static lc_name(){return"SystemMessage"}_getType(){return"system"}}class SystemMessageChunk extends BaseMessageChunk{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}concat(e){return new SystemMessageChunk({content:mergeContent(this.content,e.content),additional_kwargs:_mergeDicts(this.additional_kwargs,e.additional_kwargs),response_metadata:_mergeDicts(this.response_metadata,e.response_metadata),id:this.id??e.id})}}function addLangChainErrorFields(s,e){return s.lc_error_code=e,s.message=`${s.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,s}function _isToolCall(s){return!!(s&&typeof s=="object"&&"type"in s&&s.type==="tool_call")}class ToolInputParsingException extends Error{constructor(e,a){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=a}}function _coerceToolCall(s){return _isToolCall(s)?s:typeof s.id=="string"&&s.type==="function"&&typeof s.function=="object"&&s.function!==null&&"arguments"in s.function&&typeof s.function.arguments=="string"&&"name"in s.function&&typeof s.function.name=="string"?{id:s.id,args:JSON.parse(s.function.arguments),name:s.function.name,type:"tool_call"}:s}function isSerializedConstructor(s){return typeof s=="object"&&s!=null&&s.lc===1&&Array.isArray(s.id)&&s.kwargs!=null&&typeof s.kwargs=="object"}function _constructMessageFromParams(s){let e,a;if(isSerializedConstructor(s)){const o=s.id.at(-1);o==="HumanMessage"||o==="HumanMessageChunk"?e="user":o==="AIMessage"||o==="AIMessageChunk"?e="assistant":o==="SystemMessage"||o==="SystemMessageChunk"?e="system":o==="FunctionMessage"||o==="FunctionMessageChunk"?e="function":o==="ToolMessage"||o==="ToolMessageChunk"?e="tool":e="unknown",a=s.kwargs}else{const{type:o,...c}=s;e=o,a=c}if(e==="human"||e==="user")return new HumanMessage(a);if(e==="ai"||e==="assistant"){const{tool_calls:o,...c}=a;if(!Array.isArray(o))return new AIMessage(a);const d=o.map(_coerceToolCall);return new AIMessage({...c,tool_calls:d})}else{if(e==="system")return new SystemMessage(a);if(e==="developer")return new SystemMessage({...a,additional_kwargs:{...a.additional_kwargs,__openai_role__:"developer"}});if(e==="tool"&&"tool_call_id"in a)return new ToolMessage({...a,content:a.content,tool_call_id:a.tool_call_id,name:a.name});throw addLangChainErrorFields(new Error(`Unable to coerce message from array: only human, AI, system, developer, or tool message coercion is currently supported.

Received: ${JSON.stringify(s,null,2)}`),"MESSAGE_COERCION_FAILURE")}}function coerceMessageLikeToMessage(s){if(typeof s=="string")return new HumanMessage(s);if(isBaseMessage(s))return s;if(Array.isArray(s)){const[e,a]=s;return _constructMessageFromParams({type:e,content:a})}else if(_isMessageFieldWithRole(s)){const{role:e,...a}=s;return _constructMessageFromParams({...a,type:e})}else return _constructMessageFromParams(s)}function getBufferString(s,e="Human",a="AI"){const o=[];for(const c of s){let d;if(c._getType()==="human")d=e;else if(c._getType()==="ai")d=a;else if(c._getType()==="system")d="System";else if(c._getType()==="function")d="Function";else if(c._getType()==="tool")d="Tool";else if(c._getType()==="generic")d=c.role;else throw new Error(`Got unsupported message type: ${c._getType()}`);const h=c.name?`${c.name}, `:"",g=typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2);o.push(`${d}: ${h}${g}`)}return o.join(`
`)}function convertToChunk(s){var a;const e=s._getType();if(e==="human")return new HumanMessageChunk({...s});if(e==="ai"){let o={...s};return"tool_calls"in o&&(o={...o,tool_call_chunks:(a=o.tool_calls)==null?void 0:a.map(c=>({...c,type:"tool_call_chunk",index:void 0,args:JSON.stringify(c.args)}))}),new AIMessageChunk({...o})}else{if(e==="system")return new SystemMessageChunk({...s});if(e==="function")return new FunctionMessageChunk({...s});if(ChatMessage.isInstance(s))return new ChatMessageChunk({...s});throw new Error("Unknown message type.")}}var pRetry$2={exports:{}},retry$2={};function RetryOperation(s,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(s)),this._timeouts=s,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var retry_operation=RetryOperation;RetryOperation.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};RetryOperation.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};RetryOperation.prototype.retry=function(s){if(this._timeout&&clearTimeout(this._timeout),!s)return!1;var e=new Date().getTime();if(s&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(s),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(s);var a=this._timeouts.shift();if(a===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),a=this._cachedTimeouts.slice(-1);else return!1;var o=this;return this._timer=setTimeout(function(){o._attempts++,o._operationTimeoutCb&&(o._timeout=setTimeout(function(){o._operationTimeoutCb(o._attempts)},o._operationTimeout),o._options.unref&&o._timeout.unref()),o._fn(o._attempts)},a),this._options.unref&&this._timer.unref(),!0};RetryOperation.prototype.attempt=function(s,e){this._fn=s,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var a=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){a._operationTimeoutCb()},a._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};RetryOperation.prototype.try=function(s){console.log("Using RetryOperation.try() is deprecated"),this.attempt(s)};RetryOperation.prototype.start=function(s){console.log("Using RetryOperation.start() is deprecated"),this.attempt(s)};RetryOperation.prototype.start=RetryOperation.prototype.try;RetryOperation.prototype.errors=function(){return this._errors};RetryOperation.prototype.attempts=function(){return this._attempts};RetryOperation.prototype.mainError=function(){if(this._errors.length===0)return null;for(var s={},e=null,a=0,o=0;o<this._errors.length;o++){var c=this._errors[o],d=c.message,h=(s[d]||0)+1;s[d]=h,h>=a&&(e=c,a=h)}return e};(function(s){var e=retry_operation;s.operation=function(a){var o=s.timeouts(a);return new e(o,{forever:a&&(a.forever||a.retries===1/0),unref:a&&a.unref,maxRetryTime:a&&a.maxRetryTime})},s.timeouts=function(a){if(a instanceof Array)return[].concat(a);var o={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var c in a)o[c]=a[c];if(o.minTimeout>o.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var d=[],h=0;h<o.retries;h++)d.push(this.createTimeout(h,o));return a&&a.forever&&!d.length&&d.push(this.createTimeout(h,o)),d.sort(function(g,_){return g-_}),d},s.createTimeout=function(a,o){var c=o.randomize?Math.random()+1:1,d=Math.round(c*Math.max(o.minTimeout,1)*Math.pow(o.factor,a));return d=Math.min(d,o.maxTimeout),d},s.wrap=function(a,o,c){if(o instanceof Array&&(c=o,o=null),!c){c=[];for(var d in a)typeof a[d]=="function"&&c.push(d)}for(var h=0;h<c.length;h++){var g=c[h],_=a[g];a[g]=(function(j){var $=s.operation(o),_e=Array.prototype.slice.call(arguments,1),tt=_e.pop();_e.push(function(et){$.retry(et)||(et&&(arguments[0]=$.mainError()),tt.apply(this,arguments))}),$.attempt(function(){j.apply(a,_e)})}).bind(a,_),a[g].options=o}}})(retry$2);var retry$1=retry$2;const retry=retry$1,networkErrorMsgs=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class AbortError extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const decorateErrorWithCounts=(s,e,a)=>{const o=a.retries-(e-1);return s.attemptNumber=e,s.retriesLeft=o,s},isNetworkError=s=>networkErrorMsgs.includes(s),pRetry=(s,e)=>new Promise((a,o)=>{e={onFailedAttempt:()=>{},retries:10,...e};const c=retry.operation(e);c.attempt(async d=>{try{a(await s(d))}catch(h){if(!(h instanceof Error)){o(new TypeError(`Non-error was thrown: "${h}". You should only throw errors.`));return}if(h instanceof AbortError)c.stop(),o(h.originalError);else if(h instanceof TypeError&&!isNetworkError(h.message))c.stop(),o(h);else{decorateErrorWithCounts(h,d,e);try{await e.onFailedAttempt(h)}catch(g){o(g);return}c.retry(h)||o(c.mainError())}}})});pRetry$2.exports=pRetry;pRetry$2.exports.default=pRetry;pRetry$2.exports.AbortError=AbortError;var pRetryExports=pRetry$2.exports;const pRetry$1=getDefaultExportFromCjs(pRetryExports),REGEX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function validate$1(s){return typeof s=="string"&&REGEX.test(s)}var byteToHex=[];for(var i$1=0;i$1<256;++i$1)byteToHex.push((i$1+256).toString(16).slice(1));function unsafeStringify(s,e=0){return(byteToHex[s[e+0]]+byteToHex[s[e+1]]+byteToHex[s[e+2]]+byteToHex[s[e+3]]+"-"+byteToHex[s[e+4]]+byteToHex[s[e+5]]+"-"+byteToHex[s[e+6]]+byteToHex[s[e+7]]+"-"+byteToHex[s[e+8]]+byteToHex[s[e+9]]+"-"+byteToHex[s[e+10]]+byteToHex[s[e+11]]+byteToHex[s[e+12]]+byteToHex[s[e+13]]+byteToHex[s[e+14]]+byteToHex[s[e+15]]).toLowerCase()}var getRandomValues,rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}var randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const native={randomUUID};function v4(s,e,a){if(native.randomUUID&&!s)return native.randomUUID();s=s||{};var o=s.random||(s.rng||rng)();return o[6]=o[6]&15|64,o[8]=o[8]&63|128,unsafeStringify(o)}var dist={},eventemitter3={exports:{}};(function(s){var e=Object.prototype.hasOwnProperty,a="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(a=!1));function c(_,b,j){this.fn=_,this.context=b,this.once=j||!1}function d(_,b,j,$,_e){if(typeof j!="function")throw new TypeError("The listener must be a function");var tt=new c(j,$||_,_e),et=a?a+b:b;return _._events[et]?_._events[et].fn?_._events[et]=[_._events[et],tt]:_._events[et].push(tt):(_._events[et]=tt,_._eventsCount++),_}function h(_,b){--_._eventsCount===0?_._events=new o:delete _._events[b]}function g(){this._events=new o,this._eventsCount=0}g.prototype.eventNames=function(){var b=[],j,$;if(this._eventsCount===0)return b;for($ in j=this._events)e.call(j,$)&&b.push(a?$.slice(1):$);return Object.getOwnPropertySymbols?b.concat(Object.getOwnPropertySymbols(j)):b},g.prototype.listeners=function(b){var j=a?a+b:b,$=this._events[j];if(!$)return[];if($.fn)return[$.fn];for(var _e=0,tt=$.length,et=new Array(tt);_e<tt;_e++)et[_e]=$[_e].fn;return et},g.prototype.listenerCount=function(b){var j=a?a+b:b,$=this._events[j];return $?$.fn?1:$.length:0},g.prototype.emit=function(b,j,$,_e,tt,et){var st=a?a+b:b;if(!this._events[st])return!1;var rt=this._events[st],nt=arguments.length,it,at;if(rt.fn){switch(rt.once&&this.removeListener(b,rt.fn,void 0,!0),nt){case 1:return rt.fn.call(rt.context),!0;case 2:return rt.fn.call(rt.context,j),!0;case 3:return rt.fn.call(rt.context,j,$),!0;case 4:return rt.fn.call(rt.context,j,$,_e),!0;case 5:return rt.fn.call(rt.context,j,$,_e,tt),!0;case 6:return rt.fn.call(rt.context,j,$,_e,tt,et),!0}for(at=1,it=new Array(nt-1);at<nt;at++)it[at-1]=arguments[at];rt.fn.apply(rt.context,it)}else{var dt=rt.length,ot;for(at=0;at<dt;at++)switch(rt[at].once&&this.removeListener(b,rt[at].fn,void 0,!0),nt){case 1:rt[at].fn.call(rt[at].context);break;case 2:rt[at].fn.call(rt[at].context,j);break;case 3:rt[at].fn.call(rt[at].context,j,$);break;case 4:rt[at].fn.call(rt[at].context,j,$,_e);break;default:if(!it)for(ot=1,it=new Array(nt-1);ot<nt;ot++)it[ot-1]=arguments[ot];rt[at].fn.apply(rt[at].context,it)}}return!0},g.prototype.on=function(b,j,$){return d(this,b,j,$,!1)},g.prototype.once=function(b,j,$){return d(this,b,j,$,!0)},g.prototype.removeListener=function(b,j,$,_e){var tt=a?a+b:b;if(!this._events[tt])return this;if(!j)return h(this,tt),this;var et=this._events[tt];if(et.fn)et.fn===j&&(!_e||et.once)&&(!$||et.context===$)&&h(this,tt);else{for(var st=0,rt=[],nt=et.length;st<nt;st++)(et[st].fn!==j||_e&&!et[st].once||$&&et[st].context!==$)&&rt.push(et[st]);rt.length?this._events[tt]=rt.length===1?rt[0]:rt:h(this,tt)}return this},g.prototype.removeAllListeners=function(b){var j;return b?(j=a?a+b:b,this._events[j]&&h(this,j)):(this._events=new o,this._eventsCount=0),this},g.prototype.off=g.prototype.removeListener,g.prototype.addListener=g.prototype.on,g.prefixed=a,g.EventEmitter=g,s.exports=g})(eventemitter3);var eventemitter3Exports=eventemitter3.exports,pTimeout$1={exports:{}},pFinally$1=(s,e)=>(e=e||(()=>{}),s.then(a=>new Promise(o=>{o(e())}).then(()=>a),a=>new Promise(o=>{o(e())}).then(()=>{throw a})));const pFinally=pFinally$1;class TimeoutError extends Error{constructor(e){super(e),this.name="TimeoutError"}}const pTimeout=(s,e,a)=>new Promise((o,c)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){o(s);return}const d=setTimeout(()=>{if(typeof a=="function"){try{o(a())}catch(_){c(_)}return}const h=typeof a=="string"?a:`Promise timed out after ${e} milliseconds`,g=a instanceof Error?a:new TimeoutError(h);typeof s.cancel=="function"&&s.cancel(),c(g)},e);pFinally(s.then(o,c),()=>{clearTimeout(d)})});pTimeout$1.exports=pTimeout;pTimeout$1.exports.default=pTimeout;pTimeout$1.exports.TimeoutError=TimeoutError;var pTimeoutExports=pTimeout$1.exports,priorityQueue={},lowerBound$1={};Object.defineProperty(lowerBound$1,"__esModule",{value:!0});function lowerBound(s,e,a){let o=0,c=s.length;for(;c>0;){const d=c/2|0;let h=o+d;a(s[h],e)<=0?(o=++h,c-=d+1):c=d}return o}lowerBound$1.default=lowerBound;Object.defineProperty(priorityQueue,"__esModule",{value:!0});const lower_bound_1=lowerBound$1;class PriorityQueue{constructor(){this._queue=[]}enqueue(e,a){a=Object.assign({priority:0},a);const o={priority:a.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=a.priority){this._queue.push(o);return}const c=lower_bound_1.default(this._queue,o,(d,h)=>h.priority-d.priority);this._queue.splice(c,0,o)}dequeue(){const e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(a=>a.priority===e.priority).map(a=>a.run)}get size(){return this._queue.length}}priorityQueue.default=PriorityQueue;Object.defineProperty(dist,"__esModule",{value:!0});const EventEmitter=eventemitter3Exports,p_timeout_1=pTimeoutExports,priority_queue_1=priorityQueue,empty=()=>{},timeoutError=new p_timeout_1.TimeoutError;class PQueue extends EventEmitter{constructor(e){var a,o,c,d;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=empty,this._resolveIdle=empty,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:priority_queue_1.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(o=(a=e.intervalCap)===null||a===void 0?void 0:a.toString())!==null&&o!==void 0?o:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(d=(c=e.interval)===null||c===void 0?void 0:c.toString())!==null&&d!==void 0?d:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=empty,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=empty,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(this._intervalId===void 0){const a=this._intervalEnd-e;if(a<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},a)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const a=this._queue.dequeue();return a?(this.emit("active"),a(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,a={}){return new Promise((o,c)=>{const d=async()=>{this._pendingCount++,this._intervalCount++;try{const h=this._timeout===void 0&&a.timeout===void 0?e():p_timeout_1.default(Promise.resolve(e()),a.timeout===void 0?this._timeout:a.timeout,()=>{(a.throwOnTimeout===void 0?this._throwOnTimeout:a.throwOnTimeout)&&c(timeoutError)});o(await h)}catch(h){c(h)}this._next()};this._queue.enqueue(d,a),this._tryToStartAnother(),this.emit("add")})}async addAll(e,a){return Promise.all(e.map(async o=>this.add(o,a)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{const a=this._resolveEmpty;this._resolveEmpty=()=>{a(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{const a=this._resolveIdle;this._resolveIdle=()=>{a(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}var _default=dist.default=PQueue;const DEFAULT_FETCH_IMPLEMENTATION=(...s)=>fetch(...s),LANGSMITH_FETCH_IMPLEMENTATION_KEY=Symbol.for("ls:fetch_implementation"),_getFetchImplementation=()=>globalThis[LANGSMITH_FETCH_IMPLEMENTATION_KEY]??DEFAULT_FETCH_IMPLEMENTATION,STATUS_NO_RETRY$1=[400,401,403,404,405,406,407,408],STATUS_IGNORE=[409];let AsyncCaller$1=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,"default"in _default?this.queue=new _default.default({concurrency:this.maxConcurrency}):this.queue=new _default({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e==null?void 0:e.onFailedResponseHook}call(e,...a){const o=this.onFailedResponseHook;return this.queue.add(()=>pRetry$1(()=>e(...a).catch(c=>{throw c instanceof Error?c:new Error(c)}),{async onFailedAttempt(c){if(c.message.startsWith("Cancel")||c.message.startsWith("TimeoutError")||c.message.startsWith("AbortError")||(c==null?void 0:c.code)==="ECONNABORTED")throw c;const d=c==null?void 0:c.response,h=d==null?void 0:d.status;if(h){if(STATUS_NO_RETRY$1.includes(+h))throw c;if(STATUS_IGNORE.includes(+h))return;o&&await o(d)}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,a,...o){return e.signal?Promise.race([this.call(a,...o),new Promise((c,d)=>{var h;(h=e.signal)==null||h.addEventListener("abort",()=>{d(new Error("AbortError"))})})]):this.call(a,...o)}fetch(...e){return this.call(()=>_getFetchImplementation()(...e).then(a=>a.ok?a:Promise.reject(a)))}};function isLangChainMessage(s){return typeof(s==null?void 0:s._getType)=="function"}function convertLangChainMessageToExample(s){const e={type:s._getType(),data:{content:s.content}};return s!=null&&s.additional_kwargs&&Object.keys(s.additional_kwargs).length>0&&(e.data.additional_kwargs={...s.additional_kwargs}),e}function assertUuid(s,e){if(!validate$1(s)){const a=e!==void 0?`Invalid UUID for ${e}: ${s}`:`Invalid UUID: ${s}`;throw new Error(a)}return s}const warnedMessages={};function warnOnce(s){warnedMessages[s]||(console.warn(s),warnedMessages[s]=!0)}var re$2={exports:{}};const SEMVER_SPEC_VERSION="2.0.0",MAX_LENGTH$1=256,MAX_SAFE_INTEGER$1=Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH=16,MAX_SAFE_BUILD_LENGTH=MAX_LENGTH$1-6,RELEASE_TYPES=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var constants$1={MAX_LENGTH:MAX_LENGTH$1,MAX_SAFE_COMPONENT_LENGTH,MAX_SAFE_BUILD_LENGTH,MAX_SAFE_INTEGER:MAX_SAFE_INTEGER$1,RELEASE_TYPES,SEMVER_SPEC_VERSION,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},define_process_env_default$3={};const debug$2=typeof process=="object"&&define_process_env_default$3&&define_process_env_default$3.NODE_DEBUG&&/\bsemver\b/i.test(define_process_env_default$3.NODE_DEBUG)?(...s)=>console.error("SEMVER",...s):()=>{};var debug_1=debug$2;(function(s,e){const{MAX_SAFE_COMPONENT_LENGTH:a,MAX_SAFE_BUILD_LENGTH:o,MAX_LENGTH:c}=constants$1,d=debug_1;e=s.exports={};const h=e.re=[],g=e.safeRe=[],_=e.src=[],b=e.safeSrc=[],j=e.t={};let $=0;const _e="[a-zA-Z0-9-]",tt=[["\\s",1],["\\d",c],[_e,o]],et=rt=>{for(const[nt,it]of tt)rt=rt.split(`${nt}*`).join(`${nt}{0,${it}}`).split(`${nt}+`).join(`${nt}{1,${it}}`);return rt},st=(rt,nt,it)=>{const at=et(nt),dt=$++;d(rt,dt,nt),j[rt]=dt,_[dt]=nt,b[dt]=at,h[dt]=new RegExp(nt,it?"g":void 0),g[dt]=new RegExp(at,it?"g":void 0)};st("NUMERICIDENTIFIER","0|[1-9]\\d*"),st("NUMERICIDENTIFIERLOOSE","\\d+"),st("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${_e}*`),st("MAINVERSION",`(${_[j.NUMERICIDENTIFIER]})\\.(${_[j.NUMERICIDENTIFIER]})\\.(${_[j.NUMERICIDENTIFIER]})`),st("MAINVERSIONLOOSE",`(${_[j.NUMERICIDENTIFIERLOOSE]})\\.(${_[j.NUMERICIDENTIFIERLOOSE]})\\.(${_[j.NUMERICIDENTIFIERLOOSE]})`),st("PRERELEASEIDENTIFIER",`(?:${_[j.NUMERICIDENTIFIER]}|${_[j.NONNUMERICIDENTIFIER]})`),st("PRERELEASEIDENTIFIERLOOSE",`(?:${_[j.NUMERICIDENTIFIERLOOSE]}|${_[j.NONNUMERICIDENTIFIER]})`),st("PRERELEASE",`(?:-(${_[j.PRERELEASEIDENTIFIER]}(?:\\.${_[j.PRERELEASEIDENTIFIER]})*))`),st("PRERELEASELOOSE",`(?:-?(${_[j.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${_[j.PRERELEASEIDENTIFIERLOOSE]})*))`),st("BUILDIDENTIFIER",`${_e}+`),st("BUILD",`(?:\\+(${_[j.BUILDIDENTIFIER]}(?:\\.${_[j.BUILDIDENTIFIER]})*))`),st("FULLPLAIN",`v?${_[j.MAINVERSION]}${_[j.PRERELEASE]}?${_[j.BUILD]}?`),st("FULL",`^${_[j.FULLPLAIN]}$`),st("LOOSEPLAIN",`[v=\\s]*${_[j.MAINVERSIONLOOSE]}${_[j.PRERELEASELOOSE]}?${_[j.BUILD]}?`),st("LOOSE",`^${_[j.LOOSEPLAIN]}$`),st("GTLT","((?:<|>)?=?)"),st("XRANGEIDENTIFIERLOOSE",`${_[j.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),st("XRANGEIDENTIFIER",`${_[j.NUMERICIDENTIFIER]}|x|X|\\*`),st("XRANGEPLAIN",`[v=\\s]*(${_[j.XRANGEIDENTIFIER]})(?:\\.(${_[j.XRANGEIDENTIFIER]})(?:\\.(${_[j.XRANGEIDENTIFIER]})(?:${_[j.PRERELEASE]})?${_[j.BUILD]}?)?)?`),st("XRANGEPLAINLOOSE",`[v=\\s]*(${_[j.XRANGEIDENTIFIERLOOSE]})(?:\\.(${_[j.XRANGEIDENTIFIERLOOSE]})(?:\\.(${_[j.XRANGEIDENTIFIERLOOSE]})(?:${_[j.PRERELEASELOOSE]})?${_[j.BUILD]}?)?)?`),st("XRANGE",`^${_[j.GTLT]}\\s*${_[j.XRANGEPLAIN]}$`),st("XRANGELOOSE",`^${_[j.GTLT]}\\s*${_[j.XRANGEPLAINLOOSE]}$`),st("COERCEPLAIN",`(^|[^\\d])(\\d{1,${a}})(?:\\.(\\d{1,${a}}))?(?:\\.(\\d{1,${a}}))?`),st("COERCE",`${_[j.COERCEPLAIN]}(?:$|[^\\d])`),st("COERCEFULL",_[j.COERCEPLAIN]+`(?:${_[j.PRERELEASE]})?(?:${_[j.BUILD]})?(?:$|[^\\d])`),st("COERCERTL",_[j.COERCE],!0),st("COERCERTLFULL",_[j.COERCEFULL],!0),st("LONETILDE","(?:~>?)"),st("TILDETRIM",`(\\s*)${_[j.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",st("TILDE",`^${_[j.LONETILDE]}${_[j.XRANGEPLAIN]}$`),st("TILDELOOSE",`^${_[j.LONETILDE]}${_[j.XRANGEPLAINLOOSE]}$`),st("LONECARET","(?:\\^)"),st("CARETTRIM",`(\\s*)${_[j.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",st("CARET",`^${_[j.LONECARET]}${_[j.XRANGEPLAIN]}$`),st("CARETLOOSE",`^${_[j.LONECARET]}${_[j.XRANGEPLAINLOOSE]}$`),st("COMPARATORLOOSE",`^${_[j.GTLT]}\\s*(${_[j.LOOSEPLAIN]})$|^$`),st("COMPARATOR",`^${_[j.GTLT]}\\s*(${_[j.FULLPLAIN]})$|^$`),st("COMPARATORTRIM",`(\\s*)${_[j.GTLT]}\\s*(${_[j.LOOSEPLAIN]}|${_[j.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",st("HYPHENRANGE",`^\\s*(${_[j.XRANGEPLAIN]})\\s+-\\s+(${_[j.XRANGEPLAIN]})\\s*$`),st("HYPHENRANGELOOSE",`^\\s*(${_[j.XRANGEPLAINLOOSE]})\\s+-\\s+(${_[j.XRANGEPLAINLOOSE]})\\s*$`),st("STAR","(<|>)?=?\\s*\\*"),st("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),st("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(re$2,re$2.exports);var reExports=re$2.exports;const looseOption=Object.freeze({loose:!0}),emptyOpts=Object.freeze({}),parseOptions$1=s=>s?typeof s!="object"?looseOption:s:emptyOpts;var parseOptions_1=parseOptions$1;const numeric=/^[0-9]+$/,compareIdentifiers$1=(s,e)=>{const a=numeric.test(s),o=numeric.test(e);return a&&o&&(s=+s,e=+e),s===e?0:a&&!o?-1:o&&!a?1:s<e?-1:1},rcompareIdentifiers=(s,e)=>compareIdentifiers$1(e,s);var identifiers$1={compareIdentifiers:compareIdentifiers$1,rcompareIdentifiers};const debug$1=debug_1,{MAX_LENGTH,MAX_SAFE_INTEGER}=constants$1,{safeRe:re$1,safeSrc:src,t:t$1}=reExports,parseOptions=parseOptions_1,{compareIdentifiers}=identifiers$1;let SemVer$1=class Qn{constructor(e,a){if(a=parseOptions(a),e instanceof Qn){if(e.loose===!!a.loose&&e.includePrerelease===!!a.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>MAX_LENGTH)throw new TypeError(`version is longer than ${MAX_LENGTH} characters`);debug$1("SemVer",e,a),this.options=a,this.loose=!!a.loose,this.includePrerelease=!!a.includePrerelease;const o=e.trim().match(a.loose?re$1[t$1.LOOSE]:re$1[t$1.FULL]);if(!o)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+o[1],this.minor=+o[2],this.patch=+o[3],this.major>MAX_SAFE_INTEGER||this.major<0)throw new TypeError("Invalid major version");if(this.minor>MAX_SAFE_INTEGER||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>MAX_SAFE_INTEGER||this.patch<0)throw new TypeError("Invalid patch version");o[4]?this.prerelease=o[4].split(".").map(c=>{if(/^[0-9]+$/.test(c)){const d=+c;if(d>=0&&d<MAX_SAFE_INTEGER)return d}return c}):this.prerelease=[],this.build=o[5]?o[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(debug$1("SemVer.compare",this.version,this.options,e),!(e instanceof Qn)){if(typeof e=="string"&&e===this.version)return 0;e=new Qn(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof Qn||(e=new Qn(e,this.options)),compareIdentifiers(this.major,e.major)||compareIdentifiers(this.minor,e.minor)||compareIdentifiers(this.patch,e.patch)}comparePre(e){if(e instanceof Qn||(e=new Qn(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let a=0;do{const o=this.prerelease[a],c=e.prerelease[a];if(debug$1("prerelease compare",a,o,c),o===void 0&&c===void 0)return 0;if(c===void 0)return 1;if(o===void 0)return-1;if(o===c)continue;return compareIdentifiers(o,c)}while(++a)}compareBuild(e){e instanceof Qn||(e=new Qn(e,this.options));let a=0;do{const o=this.build[a],c=e.build[a];if(debug$1("build compare",a,o,c),o===void 0&&c===void 0)return 0;if(c===void 0)return 1;if(o===void 0)return-1;if(o===c)continue;return compareIdentifiers(o,c)}while(++a)}inc(e,a,o){if(e.startsWith("pre")){if(!a&&o===!1)throw new Error("invalid increment argument: identifier is empty");if(a){const c=new RegExp(`^${this.options.loose?src[t$1.PRERELEASELOOSE]:src[t$1.PRERELEASE]}$`),d=`-${a}`.match(c);if(!d||d[1]!==a)throw new Error(`invalid identifier: ${a}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",a,o);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",a,o);break;case"prepatch":this.prerelease.length=0,this.inc("patch",a,o),this.inc("pre",a,o);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",a,o),this.inc("pre",a,o);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const c=Number(o)?1:0;if(this.prerelease.length===0)this.prerelease=[c];else{let d=this.prerelease.length;for(;--d>=0;)typeof this.prerelease[d]=="number"&&(this.prerelease[d]++,d=-2);if(d===-1){if(a===this.prerelease.join(".")&&o===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(c)}}if(a){let d=[a,c];o===!1&&(d=[a]),compareIdentifiers(this.prerelease[0],a)===0?isNaN(this.prerelease[1])&&(this.prerelease=d):this.prerelease=d}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var semver=SemVer$1;const SemVer=semver,compare$7=(s,e,a)=>new SemVer(s,a).compare(new SemVer(e,a));var compare_1=compare$7;const compare$6=compare_1,gt$1=(s,e,a)=>compare$6(s,e,a)>0;var gt_1=gt$1;const compare$5=compare_1,lt$1=(s,e,a)=>compare$5(s,e,a)<0;var lt_1=lt$1;const compare$4=compare_1,eq$2=(s,e,a)=>compare$4(s,e,a)===0;var eq_1=eq$2;const compare$3=compare_1,neq$1=(s,e,a)=>compare$3(s,e,a)!==0;var neq_1=neq$1;const compare$2=compare_1,gte$1=(s,e,a)=>compare$2(s,e,a)>=0;var gte_1=gte$1;const compare$1=compare_1,lte$1=(s,e,a)=>compare$1(s,e,a)<=0;var lte_1=lte$1;const eq$1=eq_1,neq=neq_1,gt=gt_1,gte=gte_1,lt=lt_1,lte=lte_1,cmp=(s,e,a,o)=>{switch(e){case"===":return typeof s=="object"&&(s=s.version),typeof a=="object"&&(a=a.version),s===a;case"!==":return typeof s=="object"&&(s=s.version),typeof a=="object"&&(a=a.version),s!==a;case"":case"=":case"==":return eq$1(s,a,o);case"!=":return neq(s,a,o);case">":return gt(s,a,o);case">=":return gte(s,a,o);case"<":return lt(s,a,o);case"<=":return lte(s,a,o);default:throw new TypeError(`Invalid operator: ${e}`)}};var cmp_1=cmp;const{safeRe:re,t}=reExports;class LRUCache{constructor(){this.max=1e3,this.map=new Map}get(e){const a=this.map.get(e);if(a!==void 0)return this.map.delete(e),this.map.set(e,a),a}delete(e){return this.map.delete(e)}set(e,a){if(!this.delete(e)&&a!==void 0){if(this.map.size>=this.max){const c=this.map.keys().next().value;this.delete(c)}this.map.set(e,a)}return this}}var lrucache=LRUCache,range,hasRequiredRange;function requireRange(){if(hasRequiredRange)return range;hasRequiredRange=1;const s=/\s+/g;class e{constructor(St,Ot){if(Ot=c(Ot),St instanceof e)return St.loose===!!Ot.loose&&St.includePrerelease===!!Ot.includePrerelease?St:new e(St.raw,Ot);if(St instanceof d)return this.raw=St.value,this.set=[[St]],this.formatted=void 0,this;if(this.options=Ot,this.loose=!!Ot.loose,this.includePrerelease=!!Ot.includePrerelease,this.raw=St.trim().replace(s," "),this.set=this.raw.split("||").map(Ct=>this.parseRange(Ct.trim())).filter(Ct=>Ct.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const Ct=this.set[0];if(this.set=this.set.filter(Rt=>!st(Rt[0])),this.set.length===0)this.set=[Ct];else if(this.set.length>1){for(const Rt of this.set)if(Rt.length===1&&rt(Rt[0])){this.set=[Rt];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let St=0;St<this.set.length;St++){St>0&&(this.formatted+="||");const Ot=this.set[St];for(let Ct=0;Ct<Ot.length;Ct++)Ct>0&&(this.formatted+=" "),this.formatted+=Ot[Ct].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(St){const Ct=((this.options.includePrerelease&&tt)|(this.options.loose&&et))+":"+St,Rt=o.get(Ct);if(Rt)return Rt;const bt=this.options.loose,Tt=bt?_[b.HYPHENRANGELOOSE]:_[b.HYPHENRANGE];St=St.replace(Tt,Et(this.options.includePrerelease)),h("hyphen replace",St),St=St.replace(_[b.COMPARATORTRIM],j),h("comparator trim",St),St=St.replace(_[b.TILDETRIM],$),h("tilde trim",St),St=St.replace(_[b.CARETTRIM],_e),h("caret trim",St);let $t=St.split(" ").map(vt=>it(vt,this.options)).join(" ").split(/\s+/).map(vt=>mt(vt,this.options));bt&&($t=$t.filter(vt=>(h("loose invalid filter",vt,this.options),!!vt.match(_[b.COMPARATORLOOSE])))),h("range list",$t);const xt=new Map,ft=$t.map(vt=>new d(vt,this.options));for(const vt of ft){if(st(vt))return[vt];xt.set(vt.value,vt)}xt.size>1&&xt.has("")&&xt.delete("");const yt=[...xt.values()];return o.set(Ct,yt),yt}intersects(St,Ot){if(!(St instanceof e))throw new TypeError("a Range is required");return this.set.some(Ct=>nt(Ct,Ot)&&St.set.some(Rt=>nt(Rt,Ot)&&Ct.every(bt=>Rt.every(Tt=>bt.intersects(Tt,Ot)))))}test(St){if(!St)return!1;if(typeof St=="string")try{St=new g(St,this.options)}catch{return!1}for(let Ot=0;Ot<this.set.length;Ot++)if(Pt(this.set[Ot],St,this.options))return!0;return!1}}range=e;const a=lrucache,o=new a,c=parseOptions_1,d=requireComparator(),h=debug_1,g=semver,{safeRe:_,t:b,comparatorTrimReplace:j,tildeTrimReplace:$,caretTrimReplace:_e}=reExports,{FLAG_INCLUDE_PRERELEASE:tt,FLAG_LOOSE:et}=constants$1,st=jt=>jt.value==="<0.0.0-0",rt=jt=>jt.value==="",nt=(jt,St)=>{let Ot=!0;const Ct=jt.slice();let Rt=Ct.pop();for(;Ot&&Ct.length;)Ot=Ct.every(bt=>Rt.intersects(bt,St)),Rt=Ct.pop();return Ot},it=(jt,St)=>(h("comp",jt,St),jt=ht(jt,St),h("caret",jt),jt=dt(jt,St),h("tildes",jt),jt=pt(jt,St),h("xrange",jt),jt=wt(jt,St),h("stars",jt),jt),at=jt=>!jt||jt.toLowerCase()==="x"||jt==="*",dt=(jt,St)=>jt.trim().split(/\s+/).map(Ot=>ot(Ot,St)).join(" "),ot=(jt,St)=>{const Ot=St.loose?_[b.TILDELOOSE]:_[b.TILDE];return jt.replace(Ot,(Ct,Rt,bt,Tt,$t)=>{h("tilde",jt,Ct,Rt,bt,Tt,$t);let xt;return at(Rt)?xt="":at(bt)?xt=`>=${Rt}.0.0 <${+Rt+1}.0.0-0`:at(Tt)?xt=`>=${Rt}.${bt}.0 <${Rt}.${+bt+1}.0-0`:$t?(h("replaceTilde pr",$t),xt=`>=${Rt}.${bt}.${Tt}-${$t} <${Rt}.${+bt+1}.0-0`):xt=`>=${Rt}.${bt}.${Tt} <${Rt}.${+bt+1}.0-0`,h("tilde return",xt),xt})},ht=(jt,St)=>jt.trim().split(/\s+/).map(Ot=>ut(Ot,St)).join(" "),ut=(jt,St)=>{h("caret",jt,St);const Ot=St.loose?_[b.CARETLOOSE]:_[b.CARET],Ct=St.includePrerelease?"-0":"";return jt.replace(Ot,(Rt,bt,Tt,$t,xt)=>{h("caret",jt,Rt,bt,Tt,$t,xt);let ft;return at(bt)?ft="":at(Tt)?ft=`>=${bt}.0.0${Ct} <${+bt+1}.0.0-0`:at($t)?bt==="0"?ft=`>=${bt}.${Tt}.0${Ct} <${bt}.${+Tt+1}.0-0`:ft=`>=${bt}.${Tt}.0${Ct} <${+bt+1}.0.0-0`:xt?(h("replaceCaret pr",xt),bt==="0"?Tt==="0"?ft=`>=${bt}.${Tt}.${$t}-${xt} <${bt}.${Tt}.${+$t+1}-0`:ft=`>=${bt}.${Tt}.${$t}-${xt} <${bt}.${+Tt+1}.0-0`:ft=`>=${bt}.${Tt}.${$t}-${xt} <${+bt+1}.0.0-0`):(h("no pr"),bt==="0"?Tt==="0"?ft=`>=${bt}.${Tt}.${$t}${Ct} <${bt}.${Tt}.${+$t+1}-0`:ft=`>=${bt}.${Tt}.${$t}${Ct} <${bt}.${+Tt+1}.0-0`:ft=`>=${bt}.${Tt}.${$t} <${+bt+1}.0.0-0`),h("caret return",ft),ft})},pt=(jt,St)=>(h("replaceXRanges",jt,St),jt.split(/\s+/).map(Ot=>_t(Ot,St)).join(" ")),_t=(jt,St)=>{jt=jt.trim();const Ot=St.loose?_[b.XRANGELOOSE]:_[b.XRANGE];return jt.replace(Ot,(Ct,Rt,bt,Tt,$t,xt)=>{h("xRange",jt,Ct,Rt,bt,Tt,$t,xt);const ft=at(bt),yt=ft||at(Tt),vt=yt||at($t),It=vt;return Rt==="="&&It&&(Rt=""),xt=St.includePrerelease?"-0":"",ft?Rt===">"||Rt==="<"?Ct="<0.0.0-0":Ct="*":Rt&&It?(yt&&(Tt=0),$t=0,Rt===">"?(Rt=">=",yt?(bt=+bt+1,Tt=0,$t=0):(Tt=+Tt+1,$t=0)):Rt==="<="&&(Rt="<",yt?bt=+bt+1:Tt=+Tt+1),Rt==="<"&&(xt="-0"),Ct=`${Rt+bt}.${Tt}.${$t}${xt}`):yt?Ct=`>=${bt}.0.0${xt} <${+bt+1}.0.0-0`:vt&&(Ct=`>=${bt}.${Tt}.0${xt} <${bt}.${+Tt+1}.0-0`),h("xRange return",Ct),Ct})},wt=(jt,St)=>(h("replaceStars",jt,St),jt.trim().replace(_[b.STAR],"")),mt=(jt,St)=>(h("replaceGTE0",jt,St),jt.trim().replace(_[St.includePrerelease?b.GTE0PRE:b.GTE0],"")),Et=jt=>(St,Ot,Ct,Rt,bt,Tt,$t,xt,ft,yt,vt,It)=>(at(Ct)?Ot="":at(Rt)?Ot=`>=${Ct}.0.0${jt?"-0":""}`:at(bt)?Ot=`>=${Ct}.${Rt}.0${jt?"-0":""}`:Tt?Ot=`>=${Ot}`:Ot=`>=${Ot}${jt?"-0":""}`,at(ft)?xt="":at(yt)?xt=`<${+ft+1}.0.0-0`:at(vt)?xt=`<${ft}.${+yt+1}.0-0`:It?xt=`<=${ft}.${yt}.${vt}-${It}`:jt?xt=`<${ft}.${yt}.${+vt+1}-0`:xt=`<=${xt}`,`${Ot} ${xt}`.trim()),Pt=(jt,St,Ot)=>{for(let Ct=0;Ct<jt.length;Ct++)if(!jt[Ct].test(St))return!1;if(St.prerelease.length&&!Ot.includePrerelease){for(let Ct=0;Ct<jt.length;Ct++)if(h(jt[Ct].semver),jt[Ct].semver!==d.ANY&&jt[Ct].semver.prerelease.length>0){const Rt=jt[Ct].semver;if(Rt.major===St.major&&Rt.minor===St.minor&&Rt.patch===St.patch)return!0}return!1}return!0};return range}var comparator,hasRequiredComparator;function requireComparator(){if(hasRequiredComparator)return comparator;hasRequiredComparator=1;const s=Symbol("SemVer ANY");class e{static get ANY(){return s}constructor(j,$){if($=a($),j instanceof e){if(j.loose===!!$.loose)return j;j=j.value}j=j.trim().split(/\s+/).join(" "),h("comparator",j,$),this.options=$,this.loose=!!$.loose,this.parse(j),this.semver===s?this.value="":this.value=this.operator+this.semver.version,h("comp",this)}parse(j){const $=this.options.loose?o[c.COMPARATORLOOSE]:o[c.COMPARATOR],_e=j.match($);if(!_e)throw new TypeError(`Invalid comparator: ${j}`);this.operator=_e[1]!==void 0?_e[1]:"",this.operator==="="&&(this.operator=""),_e[2]?this.semver=new g(_e[2],this.options.loose):this.semver=s}toString(){return this.value}test(j){if(h("Comparator.test",j,this.options.loose),this.semver===s||j===s)return!0;if(typeof j=="string")try{j=new g(j,this.options)}catch{return!1}return d(j,this.operator,this.semver,this.options)}intersects(j,$){if(!(j instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new _(j.value,$).test(this.value):j.operator===""?j.value===""?!0:new _(this.value,$).test(j.semver):($=a($),$.includePrerelease&&(this.value==="<0.0.0-0"||j.value==="<0.0.0-0")||!$.includePrerelease&&(this.value.startsWith("<0.0.0")||j.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&j.operator.startsWith(">")||this.operator.startsWith("<")&&j.operator.startsWith("<")||this.semver.version===j.semver.version&&this.operator.includes("=")&&j.operator.includes("=")||d(this.semver,"<",j.semver,$)&&this.operator.startsWith(">")&&j.operator.startsWith("<")||d(this.semver,">",j.semver,$)&&this.operator.startsWith("<")&&j.operator.startsWith(">")))}}comparator=e;const a=parseOptions_1,{safeRe:o,t:c}=reExports,d=cmp_1,h=debug_1,g=semver,_=requireRange();return comparator}requireRange();requireRange();requireRange();requireRange();requireRange();requireRange();const Comparator$1=requireComparator(),{ANY:ANY$1}=Comparator$1;requireRange();requireRange();requireRange();const Comparator=requireComparator(),{ANY}=Comparator;new Comparator(">=0.0.0-0");new Comparator(">=0.0.0");const internalRe=reExports,constants=constants$1,identifiers=identifiers$1;requireComparator();requireRange();internalRe.re,internalRe.src,internalRe.t,constants.SEMVER_SPEC_VERSION,constants.RELEASE_TYPES,identifiers.compareIdentifiers,identifiers.rcompareIdentifiers;function parsePromptIdentifier(s){if(!s||s.split("/").length>2||s.startsWith("/")||s.endsWith("/")||s.split(":").length>2)throw new Error(`Invalid identifier format: ${s}`);const[e,a]=s.split(":"),o=a||"latest";if(e.includes("/")){const[c,d]=e.split("/",2);if(!c||!d)throw new Error(`Invalid identifier format: ${s}`);return[c,d,o]}else{if(!e)throw new Error(`Invalid identifier format: ${s}`);return["-",e,o]}}class LangSmithConflictError extends Error{constructor(e){super(e),this.name="LangSmithConflictError"}}async function raiseForStatus(s,e,a){let o;if(s.ok){a&&(o=await s.text());return}o=await s.text();const c=`Failed to ${e}. Received status [${s.status}]: ${s.statusText}. Server response: ${o}`;throw s.status===409?new LangSmithConflictError(c):new Error(c)}var LIMIT_REPLACE_NODE="[...]",CIRCULAR_REPLACE_NODE={result:"[Circular]"},arr=[],replacerStack=[];const encoder=new TextEncoder;function defaultOptions(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function encodeString(s){return encoder.encode(s)}function serialize(s,e,a,o){var c;try{const d=JSON.stringify(s,e,a);return encodeString(d)}catch(d){if(!((c=d.message)!=null&&c.includes("Converting circular structure to JSON")))return console.warn("[WARNING]: LangSmith received unserializable value."),encodeString("[Unserializable]");console.warn("[WARNING]: LangSmith received circular JSON. This will decrease tracer performance."),typeof o>"u"&&(o=defaultOptions()),decirc(s,"",0,[],void 0,0,o);let h;try{replacerStack.length===0?h=JSON.stringify(s,e,a):h=JSON.stringify(s,replaceGetterValues(e),a)}catch{return encodeString("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;arr.length!==0;){const g=arr.pop();g.length===4?Object.defineProperty(g[0],g[1],g[3]):g[0][g[1]]=g[2]}}return encodeString(h)}}function setReplace(s,e,a,o){var c=Object.getOwnPropertyDescriptor(o,a);c.get!==void 0?c.configurable?(Object.defineProperty(o,a,{value:s}),arr.push([o,a,e,c])):replacerStack.push([e,a,s]):(o[a]=s,arr.push([o,a,e]))}function decirc(s,e,a,o,c,d,h){d+=1;var g;if(typeof s=="object"&&s!==null){for(g=0;g<o.length;g++)if(o[g]===s){setReplace(CIRCULAR_REPLACE_NODE,s,e,c);return}if(typeof h.depthLimit<"u"&&d>h.depthLimit){setReplace(LIMIT_REPLACE_NODE,s,e,c);return}if(typeof h.edgesLimit<"u"&&a+1>h.edgesLimit){setReplace(LIMIT_REPLACE_NODE,s,e,c);return}if(o.push(s),Array.isArray(s))for(g=0;g<s.length;g++)decirc(s[g],g,g,o,s,d,h);else{var _=Object.keys(s);for(g=0;g<_.length;g++){var b=_[g];decirc(s[b],b,g,o,s,d,h)}}o.pop()}}function replaceGetterValues(s){return s=typeof s<"u"?s:function(e,a){return a},function(e,a){if(replacerStack.length>0)for(var o=0;o<replacerStack.length;o++){var c=replacerStack[o];if(c[1]===e&&c[0]===a){a=c[2],replacerStack.splice(o,1);break}}return s.call(this,e,a)}}function mergeRuntimeEnvIntoRunCreate(s){const e=getRuntimeEnvironment$1(),a=getLangChainEnvVarsMetadata(),o=s.extra??{},c=o.metadata;return s.extra={...o,runtime:{...e,...o==null?void 0:o.runtime},metadata:{...a,...a.revision_id||s.revision_id?{revision_id:s.revision_id??a.revision_id}:{},...c}},s}const getTracingSamplingRate=()=>{const s=getLangSmithEnvironmentVariable("TRACING_SAMPLING_RATE");if(s===void 0)return;const e=parseFloat(s);if(e<0||e>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${e}`);return e},isLocalhost=s=>{const a=s.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return a==="localhost"||a==="127.0.0.1"||a==="::1"};async function toArray(s){const e=[];for await(const a of s)e.push(a);return e}function trimQuotes(s){if(s!==void 0)return s.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const handle429=async s=>{if((s==null?void 0:s.status)===429){const e=parseInt(s.headers.get("retry-after")??"30",10)*1e3;if(e>0)return await new Promise(a=>setTimeout(a,e)),!0}return!1};class AutoBatchQueue{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}peek(){return this.items[0]}push(e){let a;const o=new Promise(d=>{a=d}),c=serialize(e.item).length;return this.items.push({action:e.action,payload:e.item,itemPromiseResolve:a,itemPromise:o,size:c}),this.sizeBytes+=c,o}pop(e){var c;if(e<1)throw new Error("Number of bytes to pop off may not be less than 1.");const a=[];let o=0;for(;o+(((c=this.peek())==null?void 0:c.size)??0)<e&&this.items.length>0;){const d=this.items.shift();d&&(a.push(d),o+=d.size,this.sizeBytes-=d.size)}if(a.length===0&&this.items.length>0){const d=this.items.shift();a.push(d),o+=d.size,this.sizeBytes-=d.size}return[a.map(d=>({action:d.action,item:d.payload})),()=>a.forEach(d=>d.itemPromiseResolve())]}}const DEFAULT_BATCH_SIZE_LIMIT_BYTES=20971520,SERVER_INFO_REQUEST_TIMEOUT=2500;class Client{constructor(e={}){var o;Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new AutoBatchQueue}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:getEnvironmentVariable$1("LANGSMITH_TRACING_BACKGROUND")==="false"}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"manualFlushMode",{enumerable:!0,configurable:!0,writable:!0,value:!1});const a=Client.getDefaultClientConfig();if(this.tracingSampleRate=getTracingSamplingRate(),this.apiUrl=trimQuotes(e.apiUrl??a.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=trimQuotes(e.apiKey??a.apiKey),this.webUrl=trimQuotes(e.webUrl??a.webUrl),(o=this.webUrl)!=null&&o.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.timeout_ms=e.timeout_ms??9e4,this.caller=new AsyncCaller$1(e.callerOptions??{}),this.traceBatchConcurrency=e.traceBatchConcurrency??this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw new Error("Trace batch concurrency must be positive.");this.batchIngestCaller=new AsyncCaller$1({maxRetries:2,maxConcurrency:this.traceBatchConcurrency,...e.callerOptions??{},onFailedResponseHook:handle429}),this.hideInputs=e.hideInputs??e.anonymizer??a.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??a.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.fetchOptions=e.fetchOptions||{},this.manualFlushMode=e.manualFlushMode??this.manualFlushMode}static getDefaultClientConfig(){const e=getLangSmithEnvironmentVariable("API_KEY"),a=getLangSmithEnvironmentVariable("ENDPOINT")??"https://api.smith.langchain.com",o=getLangSmithEnvironmentVariable("HIDE_INPUTS")==="true",c=getLangSmithEnvironmentVariable("HIDE_OUTPUTS")==="true";return{apiUrl:a,apiKey:e,webUrl:void 0,hideInputs:o,hideOutputs:c}}getHostUrl(){return this.webUrl?this.webUrl:isLocalhost(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.endsWith("/api/v1")?(this.webUrl=this.apiUrl.replace("/api/v1",""),this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("beta")?(this.webUrl="https://beta.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const e={"User-Agent":`langsmith-js/${__version__}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}prepareRunCreateOrUpdateInputs(e){const a={...e};return a.inputs!==void 0&&(a.inputs=this.processInputs(a.inputs)),a.outputs!==void 0&&(a.outputs=this.processOutputs(a.outputs)),a}async _getResponse(e,a){const o=(a==null?void 0:a.toString())??"",c=`${this.apiUrl}${e}?${o}`,d=await this.caller.call(_getFetchImplementation(),c,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(d,`Failed to fetch ${e}`),d}async _get(e,a){return(await this._getResponse(e,a)).json()}async*_getPaginated(e,a=new URLSearchParams,o){let c=Number(a.get("offset"))||0;const d=Number(a.get("limit"))||100;for(;;){a.set("offset",String(c)),a.set("limit",String(d));const h=`${this.apiUrl}${e}?${a}`,g=await this.caller.call(_getFetchImplementation(),h,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(g,`Failed to fetch ${e}`);const _=o?o(await g.json()):await g.json();if(_.length===0||(yield _,_.length<d))break;c+=_.length}}async*_getCursorPaginatedList(e,a=null,o="POST",c="runs"){const d=a?{...a}:{};for(;;){const g=await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}${e}`,{method:o,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(d)})).json();if(!g||!g[c])break;yield g[c];const _=g.cursors;if(!_||!_.next)break;d.cursor=_.next}}_filterForSampling(e,a=!1){if(this.tracingSampleRate===void 0)return e;if(a){const o=[];for(const c of e)this.filteredPostUuids.has(c.id)?this.filteredPostUuids.delete(c.id):o.push(c);return o}else{const o=[];for(const c of e)c.id!==c.trace_id&&!this.filteredPostUuids.has(c.trace_id)||Math.random()<this.tracingSampleRate?o.push(c):this.filteredPostUuids.add(c.id);return o}}async _getBatchSizeLimitBytes(){var a;const e=await this._ensureServerInfo();return this.batchSizeBytesLimit??((a=e.batch_ingest_config)==null?void 0:a.size_limit_bytes)??DEFAULT_BATCH_SIZE_LIMIT_BYTES}async _getMultiPartSupport(){var a;return((a=(await this._ensureServerInfo()).instance_flags)==null?void 0:a.dataset_examples_multipart_enabled)??!1}drainAutoBatchQueue(e){const a=[];for(;this.autoBatchQueue.items.length>0;){const[o,c]=this.autoBatchQueue.pop(e);if(!o.length){c();break}const d=this._processBatch(o,c).catch(console.error);a.push(d)}return Promise.all(a)}async _processBatch(e,a){var o;if(!e.length){a();return}try{const c={runCreates:e.filter(h=>h.action==="create").map(h=>h.item),runUpdates:e.filter(h=>h.action==="update").map(h=>h.item)},d=await this._ensureServerInfo();(o=d==null?void 0:d.batch_ingest_config)!=null&&o.use_multipart_endpoint?await this.multipartIngestRuns(c):await this.batchIngestRuns(c)}finally{a()}}async processRunOperation(e){clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,e.action==="create"&&(e.item=mergeRuntimeEnvIntoRunCreate(e.item));const a=this.autoBatchQueue.push(e);if(this.manualFlushMode)return a;const o=await this._getBatchSizeLimitBytes();return this.autoBatchQueue.sizeBytes>o&&this.drainAutoBatchQueue(o),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue(o)},this.autoBatchAggregationDelayMs)),a}async _getServerInfo(){const e=await _getFetchImplementation()(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(SERVER_INFO_REQUEST_TIMEOUT),...this.fetchOptions});return await raiseForStatus(e,"get server info"),e.json()}async _ensureServerInfo(){return this._getServerInfoPromise===void 0&&(this._getServerInfoPromise=(async()=>{if(this._serverInfo===void 0)try{this._serverInfo=await this._getServerInfo()}catch{console.warn("[WARNING]: LangSmith failed to fetch info on supported operations. Falling back to batch operations and default limits.")}return this._serverInfo??{}})()),this._getServerInfoPromise.then(e=>(this._serverInfo===void 0&&(this._getServerInfoPromise=void 0),e))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async flush(){const e=await this._getBatchSizeLimitBytes();await this.drainAutoBatchQueue(e)}async createRun(e){if(!this._filterForSampling([e]).length)return;const a={...this.headers,"Content-Type":"application/json"},o=e.project_name;delete e.project_name;const c=this.prepareRunCreateOrUpdateInputs({session_name:o,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&c.trace_id!==void 0&&c.dotted_order!==void 0){this.processRunOperation({action:"create",item:c}).catch(console.error);return}const d=mergeRuntimeEnvIntoRunCreate(c),h=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/runs`,{method:"POST",headers:a,body:serialize(d),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(h,"create run",!0)}async batchIngestRuns({runCreates:e,runUpdates:a}){if(e===void 0&&a===void 0)return;let o=(e==null?void 0:e.map(g=>this.prepareRunCreateOrUpdateInputs(g)))??[],c=(a==null?void 0:a.map(g=>this.prepareRunCreateOrUpdateInputs(g)))??[];if(o.length>0&&c.length>0){const g=o.reduce((b,j)=>(j.id&&(b[j.id]=j),b),{}),_=[];for(const b of c)b.id!==void 0&&g[b.id]?g[b.id]={...g[b.id],...b}:_.push(b);o=Object.values(g),c=_}const d={post:this._filterForSampling(o),patch:this._filterForSampling(c,!0)};if(!d.post.length&&!d.patch.length)return;const h={post:[],patch:[]};for(const g of["post","patch"]){const _=g,b=d[_].reverse();let j=b.pop();for(;j!==void 0;)h[_].push(j),j=b.pop()}(h.post.length>0||h.patch.length>0)&&await this._postBatchIngestRuns(serialize(h))}async _postBatchIngestRuns(e){const a={...this.headers,"Content-Type":"application/json",Accept:"application/json"},o=await this.batchIngestCaller.call(_getFetchImplementation(),`${this.apiUrl}/runs/batch`,{method:"POST",headers:a,body:e,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(o,"batch create run",!0)}async multipartIngestRuns({runCreates:e,runUpdates:a}){if(e===void 0&&a===void 0)return;const o={};let c=[];for(const j of e??[]){const $=this.prepareRunCreateOrUpdateInputs(j);$.id!==void 0&&$.attachments!==void 0&&(o[$.id]=$.attachments),delete $.attachments,c.push($)}let d=[];for(const j of a??[])d.push(this.prepareRunCreateOrUpdateInputs(j));if(c.find(j=>j.trace_id===void 0||j.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(d.find(j=>j.trace_id===void 0||j.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(c.length>0&&d.length>0){const j=c.reduce((_e,tt)=>(tt.id&&(_e[tt.id]=tt),_e),{}),$=[];for(const _e of d)_e.id!==void 0&&j[_e.id]?j[_e.id]={...j[_e.id],..._e}:$.push(_e);c=Object.values(j),d=$}if(c.length===0&&d.length===0)return;const _=[],b=[];for(const[j,$]of[["post",c],["patch",d]])for(const _e of $){const{inputs:tt,outputs:et,events:st,attachments:rt,...nt}=_e,it={inputs:tt,outputs:et,events:st},at=serialize(nt);b.push({name:`${j}.${nt.id}`,payload:new Blob([at],{type:`application/json; length=${at.length}`})});for(const[dt,ot]of Object.entries(it)){if(ot===void 0)continue;const ht=serialize(ot);b.push({name:`${j}.${nt.id}.${dt}`,payload:new Blob([ht],{type:`application/json; length=${ht.length}`})})}if(nt.id!==void 0){const dt=o[nt.id];if(dt){delete o[nt.id];for(const[ot,ht]of Object.entries(dt)){let ut,pt;if(Array.isArray(ht)?[ut,pt]=ht:(ut=ht.mimeType,pt=ht.data),ot.includes(".")){console.warn(`Skipping attachment '${ot}' for run ${nt.id}: Invalid attachment name. Attachment names must not contain periods ('.'). Please rename the attachment and try again.`);continue}b.push({name:`attachment.${nt.id}.${ot}`,payload:new Blob([pt],{type:`${ut}; length=${pt.byteLength}`})})}}}_.push(`trace=${nt.trace_id},id=${nt.id}`)}await this._sendMultipartRequest(b,_.join("; "))}async _sendMultipartRequest(e,a){try{const o="----LangSmithFormBoundary"+Math.random().toString(36).slice(2),c=[];for(const _ of e)c.push(new Blob([`--${o}\r
`])),c.push(new Blob([`Content-Disposition: form-data; name="${_.name}"\r
`,`Content-Type: ${_.payload.type}\r
\r
`])),c.push(_.payload),c.push(new Blob([`\r
`]));c.push(new Blob([`--${o}--\r
`]));const h=await new Blob(c).arrayBuffer(),g=await this.batchIngestCaller.call(_getFetchImplementation(),`${this.apiUrl}/runs/multipart`,{method:"POST",headers:{...this.headers,"Content-Type":`multipart/form-data; boundary=${o}`},body:h,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(g,"ingest multipart runs",!0)}catch(o){console.warn(`${o.message.trim()}

Context: ${a}`)}}async updateRun(e,a){assertUuid(e),a.inputs&&(a.inputs=this.processInputs(a.inputs)),a.outputs&&(a.outputs=this.processOutputs(a.outputs));const o={...a,id:e};if(!this._filterForSampling([o],!0).length)return;if(this.autoBatchTracing&&o.trace_id!==void 0&&o.dotted_order!==void 0){if(a.end_time!==void 0&&o.parent_run_id===void 0&&this.blockOnRootRunFinalization&&!this.manualFlushMode){await this.processRunOperation({action:"update",item:o}).catch(console.error);return}else this.processRunOperation({action:"update",item:o}).catch(console.error);return}const c={...this.headers,"Content-Type":"application/json"},d=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:c,body:serialize(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(d,"update run",!0)}async readRun(e,{loadChildRuns:a}={loadChildRuns:!1}){assertUuid(e);let o=await this._get(`/runs/${e}`);return a&&o.child_run_ids&&(o=await this._loadChildRuns(o)),o}async getRunUrl({runId:e,run:a,projectOpts:o}){if(a!==void 0){let c;a.session_id?c=a.session_id:o!=null&&o.projectName?c=(await this.readProject({projectName:o==null?void 0:o.projectName})).id:o!=null&&o.projectId?c=o==null?void 0:o.projectId:c=(await this.readProject({projectName:getLangSmithEnvironmentVariable("PROJECT")||"default"})).id;const d=await this._getTenantId();return`${this.getHostUrl()}/o/${d}/projects/p/${c}/r/${a.id}?poll=true`}else if(e!==void 0){const c=await this.readRun(e);if(!c.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${c.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){const a=await toArray(this.listRuns({id:e.child_run_ids})),o={},c={};a.sort((d,h)=>((d==null?void 0:d.dotted_order)??"").localeCompare((h==null?void 0:h.dotted_order)??""));for(const d of a){if(d.parent_run_id===null||d.parent_run_id===void 0)throw new Error(`Child run ${d.id} has no parent`);d.parent_run_id in o||(o[d.parent_run_id]=[]),o[d.parent_run_id].push(d),c[d.id]=d}e.child_runs=o[e.id]||[];for(const d in o)d!==e.id&&(c[d].child_runs=o[d]);return e}async*listRuns(e){const{projectId:a,projectName:o,parentRunId:c,traceId:d,referenceExampleId:h,startTime:g,executionOrder:_,isRoot:b,runType:j,error:$,id:_e,query:tt,filter:et,traceFilter:st,treeFilter:rt,limit:nt,select:it}=e;let at=[];if(a&&(at=Array.isArray(a)?a:[a]),o){const ut=Array.isArray(o)?o:[o],pt=await Promise.all(ut.map(_t=>this.readProject({projectName:_t}).then(wt=>wt.id)));at.push(...pt)}const dt=["app_path","child_run_ids","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],ot={session:at.length?at:null,run_type:j,reference_example:h,query:tt,filter:et,trace_filter:st,tree_filter:rt,execution_order:_,parent_run:c,start_time:g?g.toISOString():null,error:$,id:_e,limit:nt,trace:d,select:it||dt,is_root:b};let ht=0;for await(const ut of this._getCursorPaginatedList("/runs/query",ot))if(nt){if(ht>=nt)break;if(ut.length+ht>nt){yield*ut.slice(0,nt-ht);break}ht+=ut.length,yield*ut}else yield*ut}async getRunStats({id:e,trace:a,parentRun:o,runType:c,projectNames:d,projectIds:h,referenceExampleIds:g,startTime:_,endTime:b,error:j,query:$,filter:_e,traceFilter:tt,treeFilter:et,isRoot:st,dataSourceType:rt}){let nt=h||[];d&&(nt=[...h||[],...await Promise.all(d.map(ht=>this.readProject({projectName:ht}).then(ut=>ut.id)))]);const at=Object.fromEntries(Object.entries({id:e,trace:a,parent_run:o,run_type:c,session:nt,reference_example:g,start_time:_,end_time:b,error:j,query:$,filter:_e,trace_filter:tt,tree_filter:et,is_root:st,data_source_type:rt}).filter(([ht,ut])=>ut!==void 0));return await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/runs/stats`,{method:"POST",headers:this.headers,body:JSON.stringify(at),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async shareRun(e,{shareId:a}={}){const o={run_id:e,share_token:a||v4()};assertUuid(e);const d=await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(d===null||!("share_token"in d))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${d.share_token}/r`}async unshareRun(e){assertUuid(e);const a=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(a,"unshare run",!0)}async readRunSharedLink(e){assertUuid(e);const o=await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(!(o===null||!("share_token"in o)))return`${this.getHostUrl()}/public/${o.share_token}/r`}async listSharedRuns(e,{runIds:a}={}){const o=new URLSearchParams({share_token:e});if(a!==void 0)for(const h of a)o.append("id",h);return assertUuid(e),await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/public/${e}/runs${o}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async readDatasetSharedSchema(e,a){if(!e&&!a)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:a})).id),assertUuid(e);const c=await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return c.url=`${this.getHostUrl()}/public/${c.share_token}/d`,c}async shareDataset(e,a){if(!e&&!a)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:a})).id);const o={dataset_id:e};assertUuid(e);const d=await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return d.url=`${this.getHostUrl()}/public/${d.share_token}/d`,d}async unshareDataset(e){assertUuid(e);const a=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(a,"unshare dataset",!0)}async readSharedDataset(e){return assertUuid(e),await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async listSharedExamples(e,a){const o={};a!=null&&a.exampleIds&&(o.id=a.exampleIds);const c=new URLSearchParams;Object.entries(o).forEach(([g,_])=>{Array.isArray(_)?_.forEach(b=>c.append(g,b)):c.append(g,_)});const d=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/public/${e}/examples?${c.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),h=await d.json();if(!d.ok)throw"detail"in h?new Error(`Failed to list shared examples.
Status: ${d.status}
Message: ${h.detail.join(`
`)}`):new Error(`Failed to list shared examples: ${d.status} ${d.statusText}`);return h.map(g=>({...g,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:a=null,metadata:o=null,upsert:c=!1,projectExtra:d=null,referenceDatasetId:h=null}){const g=c?"?upsert=true":"",_=`${this.apiUrl}/sessions${g}`,b=d||{};o&&(b.metadata=o);const j={name:e,extra:b,description:a};h!==null&&(j.reference_dataset_id=h);const $=await this.caller.call(_getFetchImplementation(),_,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(j),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus($,"create project"),await $.json()}async updateProject(e,{name:a=null,description:o=null,metadata:c=null,projectExtra:d=null,endTime:h=null}){const g=`${this.apiUrl}/sessions/${e}`;let _=d;c&&(_={..._||{},metadata:c});const b={name:a,extra:_,description:o,end_time:h?new Date(h).toISOString():null},j=await this.caller.call(_getFetchImplementation(),g,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(b),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(j,"update project"),await j.json()}async hasProject({projectId:e,projectName:a}){let o="/sessions";const c=new URLSearchParams;if(e!==void 0&&a!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)assertUuid(e),o+=`/${e}`;else if(a!==void 0)c.append("name",a);else throw new Error("Must provide projectName or projectId");const d=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}${o}?${c}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});try{const h=await d.json();return d.ok?Array.isArray(h)?h.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:a,includeStats:o}){let c="/sessions";const d=new URLSearchParams;if(e!==void 0&&a!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)assertUuid(e),c+=`/${e}`;else if(a!==void 0)d.append("name",a);else throw new Error("Must provide projectName or projectId");o!==void 0&&d.append("include_stats",o.toString());const h=await this._get(c,d);let g;if(Array.isArray(h)){if(h.length===0)throw new Error(`Project[id=${e}, name=${a}] not found`);g=h[0]}else g=h;return g}async getProjectUrl({projectId:e,projectName:a}){if(e===void 0&&a===void 0)throw new Error("Must provide either projectName or projectId");const o=await this.readProject({projectId:e,projectName:a}),c=await this._getTenantId();return`${this.getHostUrl()}/o/${c}/projects/p/${o.id}`}async getDatasetUrl({datasetId:e,datasetName:a}){if(e===void 0&&a===void 0)throw new Error("Must provide either datasetName or datasetId");const o=await this.readDataset({datasetId:e,datasetName:a}),c=await this._getTenantId();return`${this.getHostUrl()}/o/${c}/datasets/${o.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const a of this._getPaginated("/sessions",e))return this._tenantId=a[0].tenant_id,a[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:a,nameContains:o,referenceDatasetId:c,referenceDatasetName:d,referenceFree:h,metadata:g}={}){const _=new URLSearchParams;if(e!==void 0)for(const b of e)_.append("id",b);if(a!==void 0&&_.append("name",a),o!==void 0&&_.append("name_contains",o),c!==void 0)_.append("reference_dataset",c);else if(d!==void 0){const b=await this.readDataset({datasetName:d});_.append("reference_dataset",b.id)}h!==void 0&&_.append("reference_free",h.toString()),g!==void 0&&_.append("metadata",JSON.stringify(g));for await(const b of this._getPaginated("/sessions",_))yield*b}async deleteProject({projectId:e,projectName:a}){let o;if(e===void 0&&a===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&a!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?o=(await this.readProject({projectName:a})).id:o=e,assertUuid(o);const c=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/sessions/${o}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(c,`delete session ${o} (${a})`,!0)}async uploadCsv({csvFile:e,fileName:a,inputKeys:o,outputKeys:c,description:d,dataType:h,name:g}){const _=`${this.apiUrl}/datasets/upload`,b=new FormData;b.append("file",e,a),o.forEach(_e=>{b.append("input_keys",_e)}),c.forEach(_e=>{b.append("output_keys",_e)}),d&&b.append("description",d),h&&b.append("data_type",h),g&&b.append("name",g);const j=await this.caller.call(_getFetchImplementation(),_,{method:"POST",headers:this.headers,body:b,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(j,"upload CSV"),await j.json()}async createDataset(e,{description:a,dataType:o,inputsSchema:c,outputsSchema:d,metadata:h}={}){const g={name:e,description:a,extra:h?{metadata:h}:void 0};o&&(g.data_type=o),c&&(g.inputs_schema_definition=c),d&&(g.outputs_schema_definition=d);const _=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(g),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(_,"create dataset"),await _.json()}async readDataset({datasetId:e,datasetName:a}){let o="/datasets";const c=new URLSearchParams({limit:"1"});if(e!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)assertUuid(e),o+=`/${e}`;else if(a!==void 0)c.append("name",a);else throw new Error("Must provide datasetName or datasetId");const d=await this._get(o,c);let h;if(Array.isArray(d)){if(d.length===0)throw new Error(`Dataset[id=${e}, name=${a}] not found`);h=d[0]}else h=d;return h}async hasDataset({datasetId:e,datasetName:a}){try{return await this.readDataset({datasetId:e,datasetName:a}),!0}catch(o){if(o instanceof Error&&o.message.toLocaleLowerCase().includes("not found"))return!1;throw o}}async diffDatasetVersions({datasetId:e,datasetName:a,fromVersion:o,toVersion:c}){let d=e;if(d===void 0&&a===void 0)throw new Error("Must provide either datasetName or datasetId");if(d!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");d===void 0&&(d=(await this.readDataset({datasetName:a})).id);const h=new URLSearchParams({from_version:typeof o=="string"?o:o.toISOString(),to_version:typeof c=="string"?c:c.toISOString()});return await this._get(`/datasets/${d}/versions/diff`,h)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:a}){const o="/datasets";if(e===void 0)if(a!==void 0)e=(await this.readDataset({datasetName:a})).id;else throw new Error("Must provide datasetName or datasetId");return(await(await this._getResponse(`${o}/${e}/openai_ft`)).text()).trim().split(`
`).map(g=>JSON.parse(g))}async*listDatasets({limit:e=100,offset:a=0,datasetIds:o,datasetName:c,datasetNameContains:d,metadata:h}={}){const g="/datasets",_=new URLSearchParams({limit:e.toString(),offset:a.toString()});if(o!==void 0)for(const b of o)_.append("id",b);c!==void 0&&_.append("name",c),d!==void 0&&_.append("name_contains",d),h!==void 0&&_.append("metadata",JSON.stringify(h));for await(const b of this._getPaginated(g,_))yield*b}async updateDataset(e){const{datasetId:a,datasetName:o,...c}=e;if(!a&&!o)throw new Error("Must provide either datasetName or datasetId");const d=a??(await this.readDataset({datasetName:o})).id;assertUuid(d);const h=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${d}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(h,"update dataset"),await h.json()}async updateDatasetTag(e){const{datasetId:a,datasetName:o,asOf:c,tag:d}=e;if(!a&&!o)throw new Error("Must provide either datasetName or datasetId");const h=a??(await this.readDataset({datasetName:o})).id;assertUuid(h);const g=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${h}/tags`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({as_of:typeof c=="string"?c:c.toISOString(),tag:d}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(g,"update dataset tags")}async deleteDataset({datasetId:e,datasetName:a}){let o="/datasets",c=e;if(e!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(a!==void 0&&(c=(await this.readDataset({datasetName:a})).id),c!==void 0)assertUuid(c),o+=`/${c}`;else throw new Error("Must provide datasetName or datasetId");const d=await this.caller.call(_getFetchImplementation(),this.apiUrl+o,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(d,`delete ${o}`),await d.json()}async indexDataset({datasetId:e,datasetName:a,tag:o}){let c=e;if(!c&&!a)throw new Error("Must provide either datasetName or datasetId");if(c&&a)throw new Error("Must provide either datasetName or datasetId, not both");c||(c=(await this.readDataset({datasetName:a})).id),assertUuid(c);const d={tag:o},h=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${c}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(d),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(h,"index dataset"),await h.json()}async similarExamples(e,a,o,{filter:c}={}){const d={limit:o,inputs:e};c!==void 0&&(d.filter=c),assertUuid(a);const h=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${a}/search`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(d),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(h,"fetch similar examples"),(await h.json()).examples}async createExample(e,a,{datasetId:o,datasetName:c,createdAt:d,exampleId:h,metadata:g,split:_,sourceRunId:b}){let j=o;if(j===void 0&&c===void 0)throw new Error("Must provide either datasetName or datasetId");if(j!==void 0&&c!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");j===void 0&&(j=(await this.readDataset({datasetName:c})).id);const $=d||new Date,_e={dataset_id:j,inputs:e,outputs:a,created_at:$==null?void 0:$.toISOString(),id:h,metadata:g,split:_,source_run_id:b},tt=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/examples`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(_e),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(tt,"create example"),await tt.json()}async createExamples(e){const{inputs:a,outputs:o,metadata:c,sourceRunIds:d,exampleIds:h,datasetId:g,datasetName:_}=e;let b=g;if(b===void 0&&_===void 0)throw new Error("Must provide either datasetName or datasetId");if(b!==void 0&&_!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");b===void 0&&(b=(await this.readDataset({datasetName:_})).id);const j=a.map((tt,et)=>({dataset_id:b,inputs:tt,outputs:o?o[et]:void 0,metadata:c?c[et]:void 0,split:e.splits?e.splits[et]:void 0,id:h?h[et]:void 0,source_run_id:d?d[et]:void 0})),$=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/examples/bulk`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(j),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus($,"create examples"),await $.json()}async createLLMExample(e,a,o){return this.createExample({input:e},{output:a},o)}async createChatExample(e,a,o){const c=e.map(h=>isLangChainMessage(h)?convertLangChainMessageToExample(h):h),d=isLangChainMessage(a)?convertLangChainMessageToExample(a):a;return this.createExample({input:c},{output:d},o)}async readExample(e){assertUuid(e);const a=`/examples/${e}`,o=await this._get(a),{attachment_urls:c,...d}=o,h=d;return c&&(h.attachments=Object.entries(c).reduce((g,[_,b])=>(g[_.slice(11)]={presigned_url:b.presigned_url,mime_type:b.mime_type},g),{})),h}async*listExamples({datasetId:e,datasetName:a,exampleIds:o,asOf:c,splits:d,inlineS3Urls:h,metadata:g,limit:_,offset:b,filter:j,includeAttachments:$}={}){let _e;if(e!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)_e=e;else if(a!==void 0)_e=(await this.readDataset({datasetName:a})).id;else throw new Error("Must provide a datasetName or datasetId");const tt=new URLSearchParams({dataset:_e}),et=c?typeof c=="string"?c:c==null?void 0:c.toISOString():void 0;et&&tt.append("as_of",et);const st=h??!0;if(tt.append("inline_s3_urls",st.toString()),o!==void 0)for(const nt of o)tt.append("id",nt);if(d!==void 0)for(const nt of d)tt.append("splits",nt);if(g!==void 0){const nt=JSON.stringify(g);tt.append("metadata",nt)}_!==void 0&&tt.append("limit",_.toString()),b!==void 0&&tt.append("offset",b.toString()),j!==void 0&&tt.append("filter",j),$===!0&&["attachment_urls","outputs","metadata"].forEach(nt=>tt.append("select",nt));let rt=0;for await(const nt of this._getPaginated("/examples",tt)){for(const it of nt){const{attachment_urls:at,...dt}=it,ot=dt;at&&(ot.attachments=Object.entries(at).reduce((ht,[ut,pt])=>(ht[ut.slice(11)]={presigned_url:pt.presigned_url,mime_type:pt.mime_type||void 0},ht),{})),yield ot,rt++}if(_!==void 0&&rt>=_)break}}async deleteExample(e){assertUuid(e);const a=`/examples/${e}`,o=await this.caller.call(_getFetchImplementation(),this.apiUrl+a,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(o,`delete ${a}`),await o.json()}async updateExample(e,a){assertUuid(e);const o=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/examples/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(o,"update example"),await o.json()}async updateExamples(e){const a=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/examples/bulk`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(e),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(a,"update examples"),await a.json()}async readDatasetVersion({datasetId:e,datasetName:a,asOf:o,tag:c}){let d;if(e?d=e:d=(await this.readDataset({datasetName:a})).id,assertUuid(d),o&&c||!o&&!c)throw new Error("Exactly one of asOf and tag must be specified.");const h=new URLSearchParams;o!==void 0&&h.append("as_of",typeof o=="string"?o:o.toISOString()),c!==void 0&&h.append("tag",c);const g=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${d}/version?${h.toString()}`,{method:"GET",headers:{...this.headers},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(g,"read dataset version"),await g.json()}async listDatasetSplits({datasetId:e,datasetName:a,asOf:o}){let c;if(e===void 0&&a===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?c=(await this.readDataset({datasetName:a})).id:c=e,assertUuid(c);const d=new URLSearchParams,h=o?typeof o=="string"?o:o==null?void 0:o.toISOString():void 0;return h&&d.append("as_of",h),await this._get(`/datasets/${c}/splits`,d)}async updateDatasetSplits({datasetId:e,datasetName:a,splitName:o,exampleIds:c,remove:d=!1}){let h;if(e===void 0&&a===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?h=(await this.readDataset({datasetName:a})).id:h=e,assertUuid(h);const g={split_name:o,examples:c.map(b=>(assertUuid(b),b)),remove:d},_=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${h}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(g),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(_,"update dataset splits",!0)}async evaluateRun(e,a,{sourceInfo:o,loadChildRuns:c,referenceExample:d}={loadChildRuns:!1}){warnOnce("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead.");let h;if(typeof e=="string")h=await this.readRun(e,{loadChildRuns:c});else if(typeof e=="object"&&"id"in e)h=e;else throw new Error(`Invalid run type: ${typeof e}`);h.reference_example_id!==null&&h.reference_example_id!==void 0&&(d=await this.readExample(h.reference_example_id));const g=await a.evaluateRun(h,d),[_,b]=await this._logEvaluationFeedback(g,h,o);return b[0]}async createFeedback(e,a,{score:o,value:c,correction:d,comment:h,sourceInfo:g,feedbackSourceType:_="api",sourceRunId:b,feedbackId:j,feedbackConfig:$,projectId:_e,comparativeExperimentId:tt}){var it;if(!e&&!_e)throw new Error("One of runId or projectId must be provided");if(e&&_e)throw new Error("Only one of runId or projectId can be provided");const et={type:_??"api",metadata:g??{}};b!==void 0&&(et==null?void 0:et.metadata)!==void 0&&!et.metadata.__run&&(et.metadata.__run={run_id:b}),(et==null?void 0:et.metadata)!==void 0&&((it=et.metadata.__run)==null?void 0:it.run_id)!==void 0&&assertUuid(et.metadata.__run.run_id);const st={id:j??v4(),run_id:e,key:a,score:o,value:c,correction:d,comment:h,feedback_source:et,comparative_experiment_id:tt,feedbackConfig:$,session_id:_e},rt=`${this.apiUrl}/feedback`,nt=await this.caller.call(_getFetchImplementation(),rt,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(st),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(nt,"create feedback",!0),st}async updateFeedback(e,{score:a,value:o,correction:c,comment:d}){const h={};a!=null&&(h.score=a),o!=null&&(h.value=o),c!=null&&(h.correction=c),d!=null&&(h.comment=d),assertUuid(e);const g=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(h),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(g,"update feedback",!0)}async readFeedback(e){assertUuid(e);const a=`/feedback/${e}`;return await this._get(a)}async deleteFeedback(e){assertUuid(e);const a=`/feedback/${e}`,o=await this.caller.call(_getFetchImplementation(),this.apiUrl+a,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(o,`delete ${a}`),await o.json()}async*listFeedback({runIds:e,feedbackKeys:a,feedbackSourceTypes:o}={}){const c=new URLSearchParams;if(e&&c.append("run",e.join(",")),a)for(const d of a)c.append("key",d);if(o)for(const d of o)c.append("source",d);for await(const d of this._getPaginated("/feedback",c))yield*d}async createPresignedFeedbackToken(e,a,{expiration:o,feedbackConfig:c}={}){const d={run_id:e,feedback_key:a,feedback_config:c};return o?typeof o=="string"?d.expires_at=o:(o!=null&&o.hours||o!=null&&o.minutes||o!=null&&o.days)&&(d.expires_in=o):d.expires_in={hours:3},await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(d),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async createComparativeExperiment({name:e,experimentIds:a,referenceDatasetId:o,createdAt:c,description:d,metadata:h,id:g}){var j;if(a.length===0)throw new Error("At least one experiment is required");if(o||(o=(await this.readProject({projectId:a[0]})).reference_dataset_id),!o==null)throw new Error("A reference dataset is required");const _={id:g,name:e,experiment_ids:a,reference_dataset_id:o,description:d,created_at:(j=c??new Date)==null?void 0:j.toISOString(),extra:{}};return h&&(_.extra.metadata=h),await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(_),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async*listPresignedFeedbackTokens(e){assertUuid(e);const a=new URLSearchParams({run_id:e});for await(const o of this._getPaginated("/feedback/tokens",a))yield*o}_selectEvalResults(e){let a;return"results"in e?a=e.results:a=[e],a}async _logEvaluationFeedback(e,a,o){const c=this._selectEvalResults(e),d=[];for(const h of c){let g=o||{};h.evaluatorInfo&&(g={...h.evaluatorInfo,...g});let _=null;h.targetRunId?_=h.targetRunId:a&&(_=a.id),d.push(await this.createFeedback(_,h.key,{score:h.score,value:h.value,comment:h.comment,correction:h.correction,sourceInfo:g,sourceRunId:h.sourceRunId,feedbackConfig:h.feedbackConfig,feedbackSourceType:"model"}))}return[c,d]}async logEvaluationFeedback(e,a,o){const[c]=await this._logEvaluationFeedback(e,a,o);return c}async*listAnnotationQueues(e={}){const{queueIds:a,name:o,nameContains:c,limit:d}=e,h=new URLSearchParams;a&&a.forEach((_,b)=>{assertUuid(_,`queueIds[${b}]`),h.append("ids",_)}),o&&h.append("name",o),c&&h.append("name_contains",c),h.append("limit",(d!==void 0?Math.min(d,100):100).toString());let g=0;for await(const _ of this._getPaginated("/annotation-queues",h))if(yield*_,g++,d!==void 0&&g>=d)break}async createAnnotationQueue(e){const{name:a,description:o,queueId:c}=e,d={name:a,description:o,id:c||v4()},h=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(Object.entries(d).filter(([_,b])=>b!==void 0))),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(h,"create annotation queue"),await h.json()}async readAnnotationQueue(e){const a=await this.listAnnotationQueues({queueIds:[e]}).next();if(a.done)throw new Error(`Annotation queue with ID ${e} not found`);return a.value}async updateAnnotationQueue(e,a){const{name:o,description:c}=a,d=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/annotation-queues/${assertUuid(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:o,description:c}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(d,"update annotation queue")}async deleteAnnotationQueue(e){const a=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/annotation-queues/${assertUuid(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(a,"delete annotation queue")}async addRunsToAnnotationQueue(e,a){const o=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/annotation-queues/${assertUuid(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a.map((c,d)=>assertUuid(c,`runIds[${d}]`).toString())),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(o,"add runs to annotation queue")}async getRunFromAnnotationQueue(e,a){const o=`/annotation-queues/${assertUuid(e,"queueId")}/run`,c=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}${o}/${a}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(c,"get run from annotation queue"),await c.json()}async deleteRunFromAnnotationQueue(e,a){const o=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/annotation-queues/${assertUuid(e,"queueId")}/runs/${assertUuid(a,"queueRunId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(o,"delete run from annotation queue")}async getSizeFromAnnotationQueue(e){const a=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/annotation-queues/${assertUuid(e,"queueId")}/size`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(a,"get size from annotation queue"),await a.json()}async _currentTenantIsOwner(e){const a=await this._getSettings();return e=="-"||a.tenant_handle===e}async _ownerConflictError(e,a){const o=await this._getSettings();return new Error(`Cannot ${e} for another tenant.

      Current tenant: ${o.tenant_handle}

      Requested tenant: ${a}`)}async _getLatestCommitHash(e){const a=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),o=await a.json();if(!a.ok){const c=typeof o.detail=="string"?o.detail:JSON.stringify(o.detail),d=new Error(`Error ${a.status}: ${a.statusText}
${c}`);throw d.statusCode=a.status,d}if(o.commits.length!==0)return o.commits[0].commit_hash}async _likeOrUnlikePrompt(e,a){const[o,c,d]=parsePromptIdentifier(e),h=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/likes/${o}/${c}`,{method:"POST",body:JSON.stringify({like:a}),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(h,`${a?"like":"unlike"} prompt`),await h.json()}async _getPromptUrl(e){const[a,o,c]=parsePromptIdentifier(e);if(await this._currentTenantIsOwner(a)){const d=await this._getSettings();return c!=="latest"?`${this.getHostUrl()}/prompts/${o}/${c.substring(0,8)}?organizationId=${d.id}`:`${this.getHostUrl()}/prompts/${o}?organizationId=${d.id}`}else return c!=="latest"?`${this.getHostUrl()}/hub/${a}/${o}/${c.substring(0,8)}`:`${this.getHostUrl()}/hub/${a}/${o}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(const a of this._getPaginated(`/commits/${e}/`,new URLSearchParams,o=>o.commits))yield*a}async*listPrompts(e){const a=new URLSearchParams;a.append("sort_field",(e==null?void 0:e.sortField)??"updated_at"),a.append("sort_direction","desc"),a.append("is_archived",(!!(e!=null&&e.isArchived)).toString()),(e==null?void 0:e.isPublic)!==void 0&&a.append("is_public",e.isPublic.toString()),e!=null&&e.query&&a.append("query",e.query);for await(const o of this._getPaginated("/repos",a,c=>c.repos))yield*o}async getPrompt(e){const[a,o,c]=parsePromptIdentifier(e),d=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/repos/${a}/${o}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(d.status===404)return null;await raiseForStatus(d,"get prompt");const h=await d.json();return h.repo?h.repo:null}async createPrompt(e,a){const o=await this._getSettings();if(a!=null&&a.isPublic&&!o.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle. 
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);const[c,d,h]=parsePromptIdentifier(e);if(!await this._currentTenantIsOwner(c))throw await this._ownerConflictError("create a prompt",c);const g={repo_handle:d,...(a==null?void 0:a.description)&&{description:a.description},...(a==null?void 0:a.readme)&&{readme:a.readme},...(a==null?void 0:a.tags)&&{tags:a.tags},is_public:!!(a!=null&&a.isPublic)},_=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(g),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(_,"create prompt");const{repo:b}=await _.json();return b}async createCommit(e,a,o){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[c,d,h]=parsePromptIdentifier(e),g=(o==null?void 0:o.parentCommitHash)==="latest"||!(o!=null&&o.parentCommitHash)?await this._getLatestCommitHash(`${c}/${d}`):o==null?void 0:o.parentCommitHash,_={manifest:JSON.parse(JSON.stringify(a)),parent_commit:g},b=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/commits/${c}/${d}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(_),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(b,"create commit");const j=await b.json();return this._getPromptUrl(`${c}/${d}${j.commit_hash?`:${j.commit_hash}`:""}`)}async updateExamplesMultipart(e,a=[]){if(!await this._getMultiPartSupport())throw new Error("Your LangSmith version does not allow using the multipart examples endpoint, please update to the latest version.");const o=new FormData;for(const h of a){const g=h.id,_={...h.metadata&&{metadata:h.metadata},...h.split&&{split:h.split}},b=serialize(_),j=new Blob([b],{type:"application/json"});if(o.append(g,j),h.inputs){const $=serialize(h.inputs),_e=new Blob([$],{type:"application/json"});o.append(`${g}.inputs`,_e)}if(h.outputs){const $=serialize(h.outputs),_e=new Blob([$],{type:"application/json"});o.append(`${g}.outputs`,_e)}if(h.attachments)for(const[$,_e]of Object.entries(h.attachments)){let tt,et;Array.isArray(_e)?[tt,et]=_e:(tt=_e.mimeType,et=_e.data);const st=new Blob([et],{type:`${tt}; length=${et.byteLength}`});o.append(`${g}.attachment.${$}`,st)}if(h.attachments_operations){const $=serialize(h.attachments_operations),_e=new Blob([$],{type:"application/json"});o.append(`${g}.attachments_operations`,_e)}}return await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/v1/platform/datasets/${e}/examples`,{method:"PATCH",headers:this.headers,body:o})).json()}async uploadExamplesMultipart(e,a=[]){if(!await this._getMultiPartSupport())throw new Error("Your LangSmith version does not allow using the multipart examples endpoint, please update to the latest version.");const o=new FormData;for(const h of a){const g=(h.id??v4()).toString(),_={created_at:h.created_at,...h.metadata&&{metadata:h.metadata},...h.split&&{split:h.split}},b=serialize(_),j=new Blob([b],{type:"application/json"});o.append(g,j);const $=serialize(h.inputs),_e=new Blob([$],{type:"application/json"});if(o.append(`${g}.inputs`,_e),h.outputs){const tt=serialize(h.outputs),et=new Blob([tt],{type:"application/json"});o.append(`${g}.outputs`,et)}if(h.attachments)for(const[tt,et]of Object.entries(h.attachments)){let st,rt;Array.isArray(et)?[st,rt]=et:(st=et.mimeType,rt=et.data);const nt=new Blob([rt],{type:`${st}; length=${rt.byteLength}`});o.append(`${g}.attachment.${tt}`,nt)}}return await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/v1/platform/datasets/${e}/examples`,{method:"POST",headers:this.headers,body:o})).json()}async updatePrompt(e,a){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[o,c]=parsePromptIdentifier(e);if(!await this._currentTenantIsOwner(o))throw await this._ownerConflictError("update a prompt",o);const d={};if((a==null?void 0:a.description)!==void 0&&(d.description=a.description),(a==null?void 0:a.readme)!==void 0&&(d.readme=a.readme),(a==null?void 0:a.tags)!==void 0&&(d.tags=a.tags),(a==null?void 0:a.isPublic)!==void 0&&(d.is_public=a.isPublic),(a==null?void 0:a.isArchived)!==void 0&&(d.is_archived=a.isArchived),Object.keys(d).length===0)throw new Error("No valid update options provided");const h=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/repos/${o}/${c}`,{method:"PATCH",body:JSON.stringify(d),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(h,"update prompt"),h.json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[a,o,c]=parsePromptIdentifier(e);if(!await this._currentTenantIsOwner(a))throw await this._ownerConflictError("delete a prompt",a);return await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/repos/${a}/${o}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async pullPromptCommit(e,a){const[o,c,d]=parsePromptIdentifier(e),h=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/commits/${o}/${c}/${d}${a!=null&&a.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(h,"pull prompt commit");const g=await h.json();return{owner:o,repo:c,commit_hash:g.commit_hash,manifest:g.manifest,examples:g.examples}}async _pullPrompt(e,a){const o=await this.pullPromptCommit(e,{includeModel:a==null?void 0:a.includeModel});return JSON.stringify(o.manifest)}async pushPrompt(e,a){return await this.promptExists(e)?a&&Object.keys(a).some(c=>c!=="object")&&await this.updatePrompt(e,{description:a==null?void 0:a.description,readme:a==null?void 0:a.readme,tags:a==null?void 0:a.tags,isPublic:a==null?void 0:a.isPublic}):await this.createPrompt(e,{description:a==null?void 0:a.description,readme:a==null?void 0:a.readme,tags:a==null?void 0:a.tags,isPublic:a==null?void 0:a.isPublic}),a!=null&&a.object?await this.createCommit(e,a==null?void 0:a.object,{parentCommitHash:a==null?void 0:a.parentCommitHash}):await this._getPromptUrl(e)}async clonePublicDataset(e,a={}){const{sourceApiUrl:o=this.apiUrl,datasetName:c}=a,[d,h]=this.parseTokenOrUrl(e,o),g=new Client({apiUrl:d,apiKey:"placeholder"}),_=await g.readSharedDataset(h),b=c||_.name;try{if(await this.hasDataset({datasetId:b})){console.log(`Dataset ${b} already exists in your tenant. Skipping.`);return}}catch{}const j=await g.listSharedExamples(h),$=await this.createDataset(b,{description:_.description,dataType:_.data_type||"kv",inputsSchema:_.inputs_schema_definition??void 0,outputsSchema:_.outputs_schema_definition??void 0});try{await this.createExamples({inputs:j.map(_e=>_e.inputs),outputs:j.flatMap(_e=>_e.outputs?[_e.outputs]:[]),datasetId:$.id})}catch(_e){throw console.error(`An error occurred while creating dataset ${b}. You should delete it manually.`),_e}}parseTokenOrUrl(e,a,o=2,c="dataset"){try{return assertUuid(e),[a,e]}catch{}try{const h=new URL(e).pathname.split("/").filter(g=>g!=="");if(h.length>=o){const g=h[h.length-o];return[a,g]}else throw new Error(`Invalid public ${c} URL: ${e}`)}catch{throw new Error(`Invalid public ${c} URL or token: ${e}`)}}awaitPendingTraceBatches(){return this.manualFlushMode?(console.warn("[WARNING]: When tracing in manual flush mode, you must call `await client.flush()` manually to submit trace batches."),Promise.resolve()):Promise.all([...this.autoBatchQueue.items.map(({itemPromise:e})=>e),this.batchIngestCaller.queue.onIdle()])}}const __version__="0.3.7";var define_process_env_default$2={};let globalEnv;const isBrowser$1=()=>typeof window<"u"&&typeof window.document<"u",isWebWorker$1=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",isJsDom$1=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),isDeno$1=()=>typeof Deno<"u",isNode$1=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!isDeno$1(),getEnv$1=()=>globalEnv||(isBrowser$1()?globalEnv="browser":isNode$1()?globalEnv="node":isWebWorker$1()?globalEnv="webworker":isJsDom$1()?globalEnv="jsdom":isDeno$1()?globalEnv="deno":globalEnv="other",globalEnv);let runtimeEnvironment$1;function getRuntimeEnvironment$1(){if(runtimeEnvironment$1===void 0){const s=getEnv$1(),e=getShas();runtimeEnvironment$1={library:"langsmith",runtime:s,sdk:"langsmith-js",sdk_version:__version__,...e}}return runtimeEnvironment$1}function getLangChainEnvVarsMetadata(){const s=getEnvironmentVariables()||{},e={},a=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION","LANGSMITH_API_KEY","LANGSMITH_ENDPOINT","LANGSMITH_TRACING_V2","LANGSMITH_PROJECT","LANGSMITH_SESSION"];for(const[o,c]of Object.entries(s))(o.startsWith("LANGCHAIN_")||o.startsWith("LANGSMITH_"))&&typeof c=="string"&&!a.includes(o)&&!o.toLowerCase().includes("key")&&!o.toLowerCase().includes("secret")&&!o.toLowerCase().includes("token")&&(o==="LANGCHAIN_REVISION_ID"?e.revision_id=c:e[o]=c);return e}function getEnvironmentVariables(){try{return typeof process<"u"&&define_process_env_default$2?Object.entries(define_process_env_default$2).reduce((s,[e,a])=>(s[e]=String(a),s),{}):void 0}catch{return}}function getEnvironmentVariable$1(s){try{return typeof process<"u"?define_process_env_default$2==null?void 0:define_process_env_default$2[s]:void 0}catch{return}}function getLangSmithEnvironmentVariable(s){return getEnvironmentVariable$1(`LANGSMITH_${s}`)||getEnvironmentVariable$1(`LANGCHAIN_${s}`)}let cachedCommitSHAs;function getShas(){if(cachedCommitSHAs!==void 0)return cachedCommitSHAs;const s=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const a of s){const o=getEnvironmentVariable$1(a);o!==void 0&&(e[a]=o)}return cachedCommitSHAs=e,e}const isTracingEnabled$1=s=>!!["TRACING_V2","TRACING"].find(a=>getLangSmithEnvironmentVariable(a)==="true"),_LC_CONTEXT_VARIABLES_KEY=Symbol.for("lc:context_variables");function stripNonAlphanumeric$1(s){return s.replace(/[-:.]/g,"")}function convertToDottedOrderFormat$1(s,e,a=1){const o=a.toFixed(0).slice(0,3).padStart(3,"0");return stripNonAlphanumeric$1(`${new Date(s).toISOString().slice(0,-1)}${o}Z`)+e}class Baggage{constructor(e,a){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=a}static fromHeader(e){const a=e.split(",");let o={},c=[];for(const d of a){const[h,g]=d.split("="),_=decodeURIComponent(g);h==="langsmith-metadata"?o=JSON.parse(_):h==="langsmith-tags"&&(c=_.split(","))}return new Baggage(o,c)}toHeader(){const e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),e.join(",")}}class RunTree{constructor(e){var g;if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"attachments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),isRunTree(e)){Object.assign(this,{...e});return}const a=RunTree.getDefaultConfig(),{metadata:o,...c}=e,d=c.client??RunTree.getSharedClient(),h={...o,...(g=c==null?void 0:c.extra)==null?void 0:g.metadata};if(c.extra={...c.extra,metadata:h},Object.assign(this,{...a,...c,client:d}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.execution_order??(this.execution_order=1),this.child_execution_order??(this.child_execution_order=1),!this.dotted_order){const _=convertToDottedOrderFormat$1(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+_:this.dotted_order=_}}static getDefaultConfig(){return{id:v4(),run_type:"chain",project_name:getLangSmithEnvironmentVariable("PROJECT")??getEnvironmentVariable$1("LANGCHAIN_SESSION")??"default",child_runs:[],api_url:getEnvironmentVariable$1("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:getEnvironmentVariable$1("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}static getSharedClient(){return RunTree.sharedClient||(RunTree.sharedClient=new Client),RunTree.sharedClient}createChild(e){var _,b,j,$,_e,tt;const a=this.child_execution_order+1,o=new RunTree({...e,parent_run:this,project_name:this.project_name,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:a,child_execution_order:a});_LC_CONTEXT_VARIABLES_KEY in this&&(o[_LC_CONTEXT_VARIABLES_KEY]=this[_LC_CONTEXT_VARIABLES_KEY]);const c=Symbol.for("lc:child_config"),d=((_=e.extra)==null?void 0:_[c])??this.extra[c];if(isRunnableConfigLike(d)){const et={...d},st=isCallbackManagerLike(et.callbacks)?(j=(b=et.callbacks).copy)==null?void 0:j.call(b):void 0;st&&(Object.assign(st,{_parentRunId:o.id}),(tt=(_e=($=st.handlers)==null?void 0:$.find(isLangChainTracerLike))==null?void 0:_e.updateFromRunTree)==null||tt.call(_e,o),et.callbacks=st),o.extra[c]=et}const h=new Set;let g=this;for(;g!=null&&!h.has(g.id);)h.add(g.id),g.child_execution_order=Math.max(g.child_execution_order,a),g=g.parent_run;return this.child_runs.push(o),o}async end(e,a,o=Date.now(),c){this.outputs=this.outputs??e,this.error=this.error??a,this.end_time=this.end_time??o,c&&Object.keys(c).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...c}}:{metadata:c})}_convertToCreate(e,a,o=!0){var _;const c=e.extra??{};if(c.runtime||(c.runtime={}),a)for(const[b,j]of Object.entries(a))c.runtime[b]||(c.runtime[b]=j);let d,h;return o?(h=(_=e.parent_run)==null?void 0:_.id,d=[]):(d=e.child_runs.map(b=>this._convertToCreate(b,a,o)),h=void 0),{id:e.id,name:e.name,start_time:e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:c,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:d,parent_run_id:h,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags,attachments:e.attachments}}async postRun(e=!0){try{const a=getRuntimeEnvironment$1(),o=await this._convertToCreate(this,a,!0);if(await this.client.createRun(o),!e){warnOnce("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const c of this.child_runs)await c.postRun(!1)}}catch(a){console.error(`Error in postRun for run ${this.id}:`,a)}}async patchRun(){var e;try{const a={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:(e=this.parent_run)==null?void 0:e.id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags,attachments:this.attachments};await this.client.updateRun(this.id,a)}catch(a){console.error(`Error in patchRun for run ${this.id}`,a)}}toJSON(){return this._convertToCreate(this,void 0,!1)}static fromRunnableConfig(e,a){var b,j,$,_e;const o=e==null?void 0:e.callbacks;let c,d,h,g=isTracingEnabled$1();if(o){const tt=((b=o==null?void 0:o.getParentRunId)==null?void 0:b.call(o))??"",et=(j=o==null?void 0:o.handlers)==null?void 0:j.find(st=>(st==null?void 0:st.name)=="langchain_tracer");c=($=et==null?void 0:et.getRun)==null?void 0:$.call(et,tt),d=et==null?void 0:et.projectName,h=et==null?void 0:et.client,g=g||!!et}return c?new RunTree({name:c.name,id:c.id,trace_id:c.trace_id,dotted_order:c.dotted_order,client:h,tracingEnabled:g,project_name:d,tags:[...new Set(((c==null?void 0:c.tags)??[]).concat((e==null?void 0:e.tags)??[]))],extra:{metadata:{...(_e=c==null?void 0:c.extra)==null?void 0:_e.metadata,...e==null?void 0:e.metadata}}}).createChild(a):new RunTree({...a,client:h,tracingEnabled:g,project_name:d})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,a){var b;const o="get"in e&&typeof e.get=="function"?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,c=o["langsmith-trace"];if(!c||typeof c!="string")return;const d=c.trim(),h=d.split(".").map(j=>{const[$,_e]=j.split("Z");return{strTime:$,time:Date.parse($+"Z"),uuid:_e}}),g=h[0].uuid,_={...a,name:(a==null?void 0:a.name)??"parent",run_type:(a==null?void 0:a.run_type)??"chain",start_time:(a==null?void 0:a.start_time)??Date.now(),id:(b=h.at(-1))==null?void 0:b.uuid,trace_id:g,dotted_order:d};if(o.baggage&&typeof o.baggage=="string"){const j=Baggage.fromHeader(o.baggage);_.metadata=j.metadata,_.tags=j.tags}return new RunTree(_)}toHeaders(e){var o;const a={"langsmith-trace":this.dotted_order,baggage:new Baggage((o=this.extra)==null?void 0:o.metadata,this.tags).toHeader()};if(e)for(const[c,d]of Object.entries(a))e.set(c,d);return a}}Object.defineProperty(RunTree,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});function isRunTree(s){return s!==void 0&&typeof s.createChild=="function"&&typeof s.postRun=="function"}function isLangChainTracerLike(s){return typeof s=="object"&&s!=null&&typeof s.name=="string"&&s.name==="langchain_tracer"}function containsLangChainTracerLike(s){return Array.isArray(s)&&s.some(e=>isLangChainTracerLike(e))}function isCallbackManagerLike(s){return typeof s=="object"&&s!=null&&Array.isArray(s.handlers)}function isRunnableConfigLike(s){var e;return s!==void 0&&typeof s.callbacks=="object"&&(containsLangChainTracerLike((e=s.callbacks)==null?void 0:e.handlers)||containsLangChainTracerLike(s.callbacks))}let MockAsyncLocalStorage$1=class{getStore(){}run(e,a){return a()}};const TRACING_ALS_KEY$1=Symbol.for("ls:tracing_async_local_storage"),mockAsyncLocalStorage$1=new MockAsyncLocalStorage$1;let AsyncLocalStorageProvider$1=class{getInstance(){return globalThis[TRACING_ALS_KEY$1]??mockAsyncLocalStorage$1}initializeGlobalInstance(e){globalThis[TRACING_ALS_KEY$1]===void 0&&(globalThis[TRACING_ALS_KEY$1]=e)}};const AsyncLocalStorageProviderSingleton$1=new AsyncLocalStorageProvider$1,getCurrentRunTree=()=>{const s=AsyncLocalStorageProviderSingleton$1.getInstance().getStore();if(!isRunTree(s))throw new Error(["Could not get the current run tree.","","Please make sure you are calling this method within a traceable function and that tracing is enabled."].join(`
`));return s};function isTraceableFunction(s){return typeof s=="function"&&"langsmith:traceable"in s}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */const _hasOwnProperty=Object.prototype.hasOwnProperty;function hasOwnProperty(s,e){return _hasOwnProperty.call(s,e)}function _objectKeys(s){if(Array.isArray(s)){const a=new Array(s.length);for(let o=0;o<a.length;o++)a[o]=""+o;return a}if(Object.keys)return Object.keys(s);let e=[];for(let a in s)hasOwnProperty(s,a)&&e.push(a);return e}function _deepClone(s){switch(typeof s){case"object":return JSON.parse(JSON.stringify(s));case"undefined":return null;default:return s}}function isInteger(s){let e=0;const a=s.length;let o;for(;e<a;){if(o=s.charCodeAt(e),o>=48&&o<=57){e++;continue}return!1}return!0}function escapePathComponent(s){return s.indexOf("/")===-1&&s.indexOf("~")===-1?s:s.replace(/~/g,"~0").replace(/\//g,"~1")}function unescapePathComponent(s){return s.replace(/~1/g,"/").replace(/~0/g,"~")}function hasUndefined(s){if(s===void 0)return!0;if(s){if(Array.isArray(s)){for(let a=0,o=s.length;a<o;a++)if(hasUndefined(s[a]))return!0}else if(typeof s=="object"){const a=_objectKeys(s),o=a.length;for(var e=0;e<o;e++)if(hasUndefined(s[a[e]]))return!0}}return!1}function patchErrorMessageFormatter(s,e){const a=[s];for(const o in e){const c=typeof e[o]=="object"?JSON.stringify(e[o],null,2):e[o];typeof c<"u"&&a.push(`${o}: ${c}`)}return a.join(`
`)}class PatchError extends Error{constructor(e,a,o,c,d){super(patchErrorMessageFormatter(e,{name:a,index:o,operation:c,tree:d})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:c}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:d}),Object.setPrototypeOf(this,new.target.prototype),this.message=patchErrorMessageFormatter(e,{name:a,index:o,operation:c,tree:d})}}const JsonPatchError=PatchError,objOps={add:function(s,e,a){return s[e]=this.value,{newDocument:a}},remove:function(s,e,a){var o=s[e];return delete s[e],{newDocument:a,removed:o}},replace:function(s,e,a){var o=s[e];return s[e]=this.value,{newDocument:a,removed:o}},move:function(s,e,a){let o=getValueByPointer(a,this.path);o&&(o=_deepClone(o));const c=applyOperation(a,{op:"remove",path:this.from}).removed;return applyOperation(a,{op:"add",path:this.path,value:c}),{newDocument:a,removed:o}},copy:function(s,e,a){const o=getValueByPointer(a,this.from);return applyOperation(a,{op:"add",path:this.path,value:_deepClone(o)}),{newDocument:a}},test:function(s,e,a){return{newDocument:a,test:_areEquals(s[e],this.value)}},_get:function(s,e,a){return this.value=s[e],{newDocument:a}}};var arrOps={add:function(s,e,a){return isInteger(e)?s.splice(e,0,this.value):s[e]=this.value,{newDocument:a,index:e}},remove:function(s,e,a){var o=s.splice(e,1);return{newDocument:a,removed:o[0]}},replace:function(s,e,a){var o=s[e];return s[e]=this.value,{newDocument:a,removed:o}},move:objOps.move,copy:objOps.copy,test:objOps.test,_get:objOps._get};function getValueByPointer(s,e){if(e=="")return s;var a={op:"_get",path:e};return applyOperation(s,a),a.value}function applyOperation(s,e,a=!1,o=!0,c=!0,d=0){if(a&&(typeof a=="function"?a(e,0,s,e.path):validator(e,0)),e.path===""){let h={newDocument:s};if(e.op==="add")return h.newDocument=e.value,h;if(e.op==="replace")return h.newDocument=e.value,h.removed=s,h;if(e.op==="move"||e.op==="copy")return h.newDocument=getValueByPointer(s,e.from),e.op==="move"&&(h.removed=s),h;if(e.op==="test"){if(h.test=_areEquals(s,e.value),h.test===!1)throw new JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",d,e,s);return h.newDocument=s,h}else{if(e.op==="remove")return h.removed=s,h.newDocument=null,h;if(e.op==="_get")return e.value=s,h;if(a)throw new JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",d,e,s);return h}}else{o||(s=_deepClone(s));const g=(e.path||"").split("/");let _=s,b=1,j=g.length,$,_e,tt;for(typeof a=="function"?tt=a:tt=validator;;){if(_e=g[b],_e&&_e.indexOf("~")!=-1&&(_e=unescapePathComponent(_e)),c&&(_e=="__proto__"||_e=="prototype"&&b>0&&g[b-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(a&&$===void 0&&(_[_e]===void 0?$=g.slice(0,b).join("/"):b==j-1&&($=e.path),$!==void 0&&tt(e,0,s,$)),b++,Array.isArray(_)){if(_e==="-")_e=_.length;else{if(a&&!isInteger(_e))throw new JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",d,e,s);isInteger(_e)&&(_e=~~_e)}if(b>=j){if(a&&e.op==="add"&&_e>_.length)throw new JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",d,e,s);const et=arrOps[e.op].call(e,_,_e,s);if(et.test===!1)throw new JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",d,e,s);return et}}else if(b>=j){const et=objOps[e.op].call(e,_,_e,s);if(et.test===!1)throw new JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",d,e,s);return et}if(_=_[_e],a&&b<j&&(!_||typeof _!="object"))throw new JsonPatchError("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",d,e,s)}}}function applyPatch(s,e,a,o=!0,c=!0){if(a&&!Array.isArray(e))throw new JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");o||(s=_deepClone(s));const d=new Array(e.length);for(let h=0,g=e.length;h<g;h++)d[h]=applyOperation(s,e[h],a,!0,c,h),s=d[h].newDocument;return d.newDocument=s,d}function validator(s,e,a,o){if(typeof s!="object"||s===null||Array.isArray(s))throw new JsonPatchError("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,s,a);if(objOps[s.op]){if(typeof s.path!="string")throw new JsonPatchError("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,s,a);if(s.path.indexOf("/")!==0&&s.path.length>0)throw new JsonPatchError('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,s,a);if((s.op==="move"||s.op==="copy")&&typeof s.from!="string")throw new JsonPatchError("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,s,a);if((s.op==="add"||s.op==="replace"||s.op==="test")&&s.value===void 0)throw new JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,s,a);if((s.op==="add"||s.op==="replace"||s.op==="test")&&hasUndefined(s.value))throw new JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,s,a);if(a){if(s.op=="add"){var c=s.path.split("/").length,d=o.split("/").length;if(c!==d+1&&c!==d)throw new JsonPatchError("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,s,a)}else if(s.op==="replace"||s.op==="remove"||s.op==="_get"){if(s.path!==o)throw new JsonPatchError("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,s,a)}else if(s.op==="move"||s.op==="copy"){var h={op:"_get",path:s.from,value:void 0},g=validate([h],a);if(g&&g.name==="OPERATION_PATH_UNRESOLVABLE")throw new JsonPatchError("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,s,a)}}}else throw new JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,s,a)}function validate(s,e,a){try{if(!Array.isArray(s))throw new JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)applyPatch(_deepClone(e),_deepClone(s),a||!0);else{a=a||validator;for(var o=0;o<s.length;o++)a(s[o],o,e,void 0)}}catch(c){if(c instanceof JsonPatchError)return c;throw c}}function _areEquals(s,e){if(s===e)return!0;if(s&&e&&typeof s=="object"&&typeof e=="object"){var a=Array.isArray(s),o=Array.isArray(e),c,d,h;if(a&&o){if(d=s.length,d!=e.length)return!1;for(c=d;c--!==0;)if(!_areEquals(s[c],e[c]))return!1;return!0}if(a!=o)return!1;var g=Object.keys(s);if(d=g.length,d!==Object.keys(e).length)return!1;for(c=d;c--!==0;)if(!e.hasOwnProperty(g[c]))return!1;for(c=d;c--!==0;)if(h=g[c],!_areEquals(s[h],e[h]))return!1;return!0}return s!==s&&e!==e}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2013-2021 Joachim Wester
 * MIT license
 */function _generate(s,e,a,o,c){if(e!==s){typeof e.toJSON=="function"&&(e=e.toJSON());for(var d=_objectKeys(e),h=_objectKeys(s),g=!1,_=h.length-1;_>=0;_--){var b=h[_],j=s[b];if(hasOwnProperty(e,b)&&!(e[b]===void 0&&j!==void 0&&Array.isArray(e)===!1)){var $=e[b];typeof j=="object"&&j!=null&&typeof $=="object"&&$!=null&&Array.isArray(j)===Array.isArray($)?_generate(j,$,a,o+"/"+escapePathComponent(b),c):j!==$&&(c&&a.push({op:"test",path:o+"/"+escapePathComponent(b),value:_deepClone(j)}),a.push({op:"replace",path:o+"/"+escapePathComponent(b),value:_deepClone($)}))}else Array.isArray(s)===Array.isArray(e)?(c&&a.push({op:"test",path:o+"/"+escapePathComponent(b),value:_deepClone(j)}),a.push({op:"remove",path:o+"/"+escapePathComponent(b)}),g=!0):(c&&a.push({op:"test",path:o,value:s}),a.push({op:"replace",path:o,value:e}))}if(!(!g&&d.length==h.length))for(var _=0;_<d.length;_++){var b=d[_];!hasOwnProperty(s,b)&&e[b]!==void 0&&a.push({op:"add",path:o+"/"+escapePathComponent(b),value:_deepClone(e[b])})}}}function compare(s,e,a=!1){var o=[];return _generate(s,e,o,"",a),o}var define_process_env_default$1={};const isBrowser=()=>typeof window<"u"&&typeof window.document<"u",isWebWorker=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",isJsDom=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),isDeno=()=>typeof Deno<"u",isNode=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!isDeno(),getEnv=()=>{let s;return isBrowser()?s="browser":isNode()?s="node":isWebWorker()?s="webworker":isJsDom()?s="jsdom":isDeno()?s="deno":s="other",s};let runtimeEnvironment;async function getRuntimeEnvironment(){return runtimeEnvironment===void 0&&(runtimeEnvironment={library:"langchain-js",runtime:getEnv()}),runtimeEnvironment}function getEnvironmentVariable(s){try{return typeof process<"u"?define_process_env_default$1==null?void 0:define_process_env_default$1[s]:isDeno()?Deno==null?void 0:Deno.env.get(s):void 0}catch{return}}class BaseCallbackHandlerMethodsClass{}function callbackHandlerPrefersStreaming(s){return"lc_prefer_streaming"in s&&s.lc_prefer_streaming}class BaseCallbackHandler extends BaseCallbackHandlerMethodsClass{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,get_lc_unique_name(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:getEnvironmentVariable("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return Serializable.prototype.toJSON.call(this)}toJSONNotImplemented(){return Serializable.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class a extends BaseCallbackHandler{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:v4()}),Object.assign(this,e)}}return new a}}const isBaseCallbackHandler=s=>{const e=s;return e!==void 0&&typeof e.copy=="function"&&typeof e.name=="string"&&typeof e.awaitHandlers=="boolean"};function _coerceToDict$1(s,e){return s&&!Array.isArray(s)&&typeof s=="object"?s:{[e]:s}}function stripNonAlphanumeric(s){return s.replace(/[-:.]/g,"")}function convertToDottedOrderFormat(s,e,a){const o=a.toFixed(0).slice(0,3).padStart(3,"0");return stripNonAlphanumeric(`${new Date(s).toISOString().slice(0,-1)}${o}Z`)+e}function isBaseTracer(s){return typeof s._addRunToRunMap=="function"}class BaseTracer extends BaseCallbackHandler{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}stringifyError(e){return e instanceof Error?e.message+(e!=null&&e.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,a){e.child_runs.push(a)}_addRunToRunMap(e){const a=convertToDottedOrderFormat(e.start_time,e.id,e.execution_order),o={...e};if(o.parent_run_id!==void 0){const c=this.runMap.get(o.parent_run_id);c&&(this._addChildRun(c,o),c.child_execution_order=Math.max(c.child_execution_order,o.child_execution_order),o.trace_id=c.trace_id,c.dotted_order!==void 0&&(o.dotted_order=[c.dotted_order,a].join(".")))}else o.trace_id=o.id,o.dotted_order=a;return this.runMap.set(o.id,o),o}async _endTrace(e){var o;const a=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);a?a.child_execution_order=Math.max(a.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id),await((o=this.onRunUpdate)==null?void 0:o.call(this,e))}_getExecutionOrder(e){const a=e!==void 0&&this.runMap.get(e);return a?a.child_execution_order+1:1}_createRunForLLMStart(e,a,o,c,d,h,g,_){const b=this._getExecutionOrder(c),j=Date.now(),$=g?{...d,metadata:g}:d,_e={id:o,name:_??e.id[e.id.length-1],parent_run_id:c,start_time:j,serialized:e,events:[{name:"start",time:new Date(j).toISOString()}],inputs:{prompts:a},execution_order:b,child_runs:[],child_execution_order:b,run_type:"llm",extra:$??{},tags:h||[]};return this._addRunToRunMap(_e)}async handleLLMStart(e,a,o,c,d,h,g,_){var j,$;const b=this.runMap.get(o)??this._createRunForLLMStart(e,a,o,c,d,h,g,_);return await((j=this.onRunCreate)==null?void 0:j.call(this,b)),await(($=this.onLLMStart)==null?void 0:$.call(this,b)),b}_createRunForChatModelStart(e,a,o,c,d,h,g,_){const b=this._getExecutionOrder(c),j=Date.now(),$=g?{...d,metadata:g}:d,_e={id:o,name:_??e.id[e.id.length-1],parent_run_id:c,start_time:j,serialized:e,events:[{name:"start",time:new Date(j).toISOString()}],inputs:{messages:a},execution_order:b,child_runs:[],child_execution_order:b,run_type:"llm",extra:$??{},tags:h||[]};return this._addRunToRunMap(_e)}async handleChatModelStart(e,a,o,c,d,h,g,_){var j,$;const b=this.runMap.get(o)??this._createRunForChatModelStart(e,a,o,c,d,h,g,_);return await((j=this.onRunCreate)==null?void 0:j.call(this,b)),await(($=this.onLLMStart)==null?void 0:$.call(this,b)),b}async handleLLMEnd(e,a,o,c,d){var g;const h=this.runMap.get(a);if(!h||(h==null?void 0:h.run_type)!=="llm")throw new Error("No LLM run to end.");return h.end_time=Date.now(),h.outputs=e,h.events.push({name:"end",time:new Date(h.end_time).toISOString()}),h.extra={...h.extra,...d},await((g=this.onLLMEnd)==null?void 0:g.call(this,h)),await this._endTrace(h),h}async handleLLMError(e,a,o,c,d){var g;const h=this.runMap.get(a);if(!h||(h==null?void 0:h.run_type)!=="llm")throw new Error("No LLM run to end.");return h.end_time=Date.now(),h.error=this.stringifyError(e),h.events.push({name:"error",time:new Date(h.end_time).toISOString()}),h.extra={...h.extra,...d},await((g=this.onLLMError)==null?void 0:g.call(this,h)),await this._endTrace(h),h}_createRunForChainStart(e,a,o,c,d,h,g,_){const b=this._getExecutionOrder(c),j=Date.now(),$={id:o,name:_??e.id[e.id.length-1],parent_run_id:c,start_time:j,serialized:e,events:[{name:"start",time:new Date(j).toISOString()}],inputs:a,execution_order:b,child_execution_order:b,run_type:g??"chain",child_runs:[],extra:h?{metadata:h}:{},tags:d||[]};return this._addRunToRunMap($)}async handleChainStart(e,a,o,c,d,h,g,_){var j,$;const b=this.runMap.get(o)??this._createRunForChainStart(e,a,o,c,d,h,g,_);return await((j=this.onRunCreate)==null?void 0:j.call(this,b)),await(($=this.onChainStart)==null?void 0:$.call(this,b)),b}async handleChainEnd(e,a,o,c,d){var g;const h=this.runMap.get(a);if(!h)throw new Error("No chain run to end.");return h.end_time=Date.now(),h.outputs=_coerceToDict$1(e,"output"),h.events.push({name:"end",time:new Date(h.end_time).toISOString()}),(d==null?void 0:d.inputs)!==void 0&&(h.inputs=_coerceToDict$1(d.inputs,"input")),await((g=this.onChainEnd)==null?void 0:g.call(this,h)),await this._endTrace(h),h}async handleChainError(e,a,o,c,d){var g;const h=this.runMap.get(a);if(!h)throw new Error("No chain run to end.");return h.end_time=Date.now(),h.error=this.stringifyError(e),h.events.push({name:"error",time:new Date(h.end_time).toISOString()}),(d==null?void 0:d.inputs)!==void 0&&(h.inputs=_coerceToDict$1(d.inputs,"input")),await((g=this.onChainError)==null?void 0:g.call(this,h)),await this._endTrace(h),h}_createRunForToolStart(e,a,o,c,d,h,g){const _=this._getExecutionOrder(c),b=Date.now(),j={id:o,name:g??e.id[e.id.length-1],parent_run_id:c,start_time:b,serialized:e,events:[{name:"start",time:new Date(b).toISOString()}],inputs:{input:a},execution_order:_,child_execution_order:_,run_type:"tool",child_runs:[],extra:h?{metadata:h}:{},tags:d||[]};return this._addRunToRunMap(j)}async handleToolStart(e,a,o,c,d,h,g){var b,j;const _=this.runMap.get(o)??this._createRunForToolStart(e,a,o,c,d,h,g);return await((b=this.onRunCreate)==null?void 0:b.call(this,_)),await((j=this.onToolStart)==null?void 0:j.call(this,_)),_}async handleToolEnd(e,a){var c;const o=this.runMap.get(a);if(!o||(o==null?void 0:o.run_type)!=="tool")throw new Error("No tool run to end");return o.end_time=Date.now(),o.outputs={output:e},o.events.push({name:"end",time:new Date(o.end_time).toISOString()}),await((c=this.onToolEnd)==null?void 0:c.call(this,o)),await this._endTrace(o),o}async handleToolError(e,a){var c;const o=this.runMap.get(a);if(!o||(o==null?void 0:o.run_type)!=="tool")throw new Error("No tool run to end");return o.end_time=Date.now(),o.error=this.stringifyError(e),o.events.push({name:"error",time:new Date(o.end_time).toISOString()}),await((c=this.onToolError)==null?void 0:c.call(this,o)),await this._endTrace(o),o}async handleAgentAction(e,a){var d;const o=this.runMap.get(a);if(!o||(o==null?void 0:o.run_type)!=="chain")return;const c=o;c.actions=c.actions||[],c.actions.push(e),c.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await((d=this.onAgentAction)==null?void 0:d.call(this,o))}async handleAgentEnd(e,a){var c;const o=this.runMap.get(a);!o||(o==null?void 0:o.run_type)!=="chain"||(o.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await((c=this.onAgentEnd)==null?void 0:c.call(this,o)))}_createRunForRetrieverStart(e,a,o,c,d,h,g){const _=this._getExecutionOrder(c),b=Date.now(),j={id:o,name:g??e.id[e.id.length-1],parent_run_id:c,start_time:b,serialized:e,events:[{name:"start",time:new Date(b).toISOString()}],inputs:{query:a},execution_order:_,child_execution_order:_,run_type:"retriever",child_runs:[],extra:h?{metadata:h}:{},tags:d||[]};return this._addRunToRunMap(j)}async handleRetrieverStart(e,a,o,c,d,h,g){var b,j;const _=this.runMap.get(o)??this._createRunForRetrieverStart(e,a,o,c,d,h,g);return await((b=this.onRunCreate)==null?void 0:b.call(this,_)),await((j=this.onRetrieverStart)==null?void 0:j.call(this,_)),_}async handleRetrieverEnd(e,a){var c;const o=this.runMap.get(a);if(!o||(o==null?void 0:o.run_type)!=="retriever")throw new Error("No retriever run to end");return o.end_time=Date.now(),o.outputs={documents:e},o.events.push({name:"end",time:new Date(o.end_time).toISOString()}),await((c=this.onRetrieverEnd)==null?void 0:c.call(this,o)),await this._endTrace(o),o}async handleRetrieverError(e,a){var c;const o=this.runMap.get(a);if(!o||(o==null?void 0:o.run_type)!=="retriever")throw new Error("No retriever run to end");return o.end_time=Date.now(),o.error=this.stringifyError(e),o.events.push({name:"error",time:new Date(o.end_time).toISOString()}),await((c=this.onRetrieverError)==null?void 0:c.call(this,o)),await this._endTrace(o),o}async handleText(e,a){var c;const o=this.runMap.get(a);!o||(o==null?void 0:o.run_type)!=="chain"||(o.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await((c=this.onText)==null?void 0:c.call(this,o)))}async handleLLMNewToken(e,a,o,c,d,h){var _;const g=this.runMap.get(o);if(!g||(g==null?void 0:g.run_type)!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return g.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:a,chunk:h==null?void 0:h.chunk}}),await((_=this.onLLMNewToken)==null?void 0:_.call(this,g,e,{chunk:h==null?void 0:h.chunk})),g}}var ansiStyles={exports:{}};ansiStyles.exports;(function(s){const a=(d=0)=>h=>`\x1B[${38+d};5;${h}m`,o=(d=0)=>(h,g,_)=>`\x1B[${38+d};2;${h};${g};${_}m`;function c(){const d=new Map,h={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};h.color.gray=h.color.blackBright,h.bgColor.bgGray=h.bgColor.bgBlackBright,h.color.grey=h.color.blackBright,h.bgColor.bgGrey=h.bgColor.bgBlackBright;for(const[g,_]of Object.entries(h)){for(const[b,j]of Object.entries(_))h[b]={open:`\x1B[${j[0]}m`,close:`\x1B[${j[1]}m`},_[b]=h[b],d.set(j[0],j[1]);Object.defineProperty(h,g,{value:_,enumerable:!1})}return Object.defineProperty(h,"codes",{value:d,enumerable:!1}),h.color.close="\x1B[39m",h.bgColor.close="\x1B[49m",h.color.ansi256=a(),h.color.ansi16m=o(),h.bgColor.ansi256=a(10),h.bgColor.ansi16m=o(10),Object.defineProperties(h,{rgbToAnsi256:{value:(g,_,b)=>g===_&&_===b?g<8?16:g>248?231:Math.round((g-8)/247*24)+232:16+36*Math.round(g/255*5)+6*Math.round(_/255*5)+Math.round(b/255*5),enumerable:!1},hexToRgb:{value:g=>{const _=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(g.toString(16));if(!_)return[0,0,0];let{colorString:b}=_.groups;b.length===3&&(b=b.split("").map($=>$+$).join(""));const j=Number.parseInt(b,16);return[j>>16&255,j>>8&255,j&255]},enumerable:!1},hexToAnsi256:{value:g=>h.rgbToAnsi256(...h.hexToRgb(g)),enumerable:!1}}),h}Object.defineProperty(s,"exports",{enumerable:!0,get:c})})(ansiStyles);var ansiStylesExports=ansiStyles.exports;const styles=getDefaultExportFromCjs(ansiStylesExports);function wrap(s,e){return`${s.open}${e}${s.close}`}function tryJsonStringify(s,e){try{return JSON.stringify(s,null,2)}catch{return e}}function formatKVMapItem(s){return typeof s=="string"?s.trim():s==null?s:tryJsonStringify(s,s.toString())}function elapsed(s){if(!s.end_time)return"";const e=s.end_time-s.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:color$1}=styles;class ConsoleCallbackHandler extends BaseTracer{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const a=[];let o=e;for(;o.parent_run_id;){const c=this.runMap.get(o.parent_run_id);if(c)a.push(c),o=c;else break}return a}getBreadcrumbs(e){const o=[...this.getParents(e).reverse(),e].map((c,d,h)=>{const g=`${c.execution_order}:${c.run_type}:${c.name}`;return d===h.length-1?wrap(styles.bold,g):g}).join(" > ");return wrap(color$1.grey,o)}onChainStart(e){const a=this.getBreadcrumbs(e);console.log(`${wrap(color$1.green,"[chain/start]")} [${a}] Entering Chain run with input: ${tryJsonStringify(e.inputs,"[inputs]")}`)}onChainEnd(e){const a=this.getBreadcrumbs(e);console.log(`${wrap(color$1.cyan,"[chain/end]")} [${a}] [${elapsed(e)}] Exiting Chain run with output: ${tryJsonStringify(e.outputs,"[outputs]")}`)}onChainError(e){const a=this.getBreadcrumbs(e);console.log(`${wrap(color$1.red,"[chain/error]")} [${a}] [${elapsed(e)}] Chain run errored with error: ${tryJsonStringify(e.error,"[error]")}`)}onLLMStart(e){const a=this.getBreadcrumbs(e),o="prompts"in e.inputs?{prompts:e.inputs.prompts.map(c=>c.trim())}:e.inputs;console.log(`${wrap(color$1.green,"[llm/start]")} [${a}] Entering LLM run with input: ${tryJsonStringify(o,"[inputs]")}`)}onLLMEnd(e){const a=this.getBreadcrumbs(e);console.log(`${wrap(color$1.cyan,"[llm/end]")} [${a}] [${elapsed(e)}] Exiting LLM run with output: ${tryJsonStringify(e.outputs,"[response]")}`)}onLLMError(e){const a=this.getBreadcrumbs(e);console.log(`${wrap(color$1.red,"[llm/error]")} [${a}] [${elapsed(e)}] LLM run errored with error: ${tryJsonStringify(e.error,"[error]")}`)}onToolStart(e){const a=this.getBreadcrumbs(e);console.log(`${wrap(color$1.green,"[tool/start]")} [${a}] Entering Tool run with input: "${formatKVMapItem(e.inputs.input)}"`)}onToolEnd(e){var o;const a=this.getBreadcrumbs(e);console.log(`${wrap(color$1.cyan,"[tool/end]")} [${a}] [${elapsed(e)}] Exiting Tool run with output: "${formatKVMapItem((o=e.outputs)==null?void 0:o.output)}"`)}onToolError(e){const a=this.getBreadcrumbs(e);console.log(`${wrap(color$1.red,"[tool/error]")} [${a}] [${elapsed(e)}] Tool run errored with error: ${tryJsonStringify(e.error,"[error]")}`)}onRetrieverStart(e){const a=this.getBreadcrumbs(e);console.log(`${wrap(color$1.green,"[retriever/start]")} [${a}] Entering Retriever run with input: ${tryJsonStringify(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const a=this.getBreadcrumbs(e);console.log(`${wrap(color$1.cyan,"[retriever/end]")} [${a}] [${elapsed(e)}] Exiting Retriever run with output: ${tryJsonStringify(e.outputs,"[outputs]")}`)}onRetrieverError(e){const a=this.getBreadcrumbs(e);console.log(`${wrap(color$1.red,"[retriever/error]")} [${a}] [${elapsed(e)}] Retriever run errored with error: ${tryJsonStringify(e.error,"[error]")}`)}onAgentAction(e){const a=e,o=this.getBreadcrumbs(e);console.log(`${wrap(color$1.blue,"[agent/action]")} [${o}] Agent selected action: ${tryJsonStringify(a.actions[a.actions.length-1],"[action]")}`)}}let client;const getDefaultLangChainClientSingleton=()=>{if(client===void 0){const s=getEnvironmentVariable("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"?{blockOnRootRunFinalization:!0}:{};client=new Client(s)}return client};class LangChainTracer extends BaseTracer{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:a,projectName:o,client:c}=e;this.projectName=o??getEnvironmentVariable("LANGCHAIN_PROJECT")??getEnvironmentVariable("LANGCHAIN_SESSION"),this.exampleId=a,this.client=c??getDefaultLangChainClientSingleton();const d=LangChainTracer.getTraceableRunTree();d&&this.updateFromRunTree(d)}async _convertToCreate(e,a=void 0){return{...e,extra:{...e.extra,runtime:await getRuntimeEnvironment()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:a}}async persistRun(e){}async onRunCreate(e){const a=await this._convertToCreate(e,this.exampleId);await this.client.createRun(a)}async onRunUpdate(e){const a={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs,trace_id:e.trace_id,dotted_order:e.dotted_order,parent_run_id:e.parent_run_id,extra:e.extra};await this.client.updateRun(e.id,a)}getRun(e){return this.runMap.get(e)}updateFromRunTree(e){let a=e;const o=new Set;for(;a.parent_run&&!(o.has(a.id)||(o.add(a.id),!a.parent_run));)a=a.parent_run;o.clear();const c=[a];for(;c.length>0;){const d=c.shift();!d||o.has(d.id)||(o.add(d.id),this.runMap.set(d.id,d),d.child_runs&&c.push(...d.child_runs))}this.client=e.client??this.client,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}convertToRunTree(e){const a={},o=[];for(const[c,d]of this.runMap){const h=new RunTree({...d,child_runs:[],parent_run:void 0,client:this.client,project_name:this.projectName,reference_example_id:this.exampleId,tracingEnabled:!0});a[c]=h,o.push([c,d.dotted_order])}o.sort((c,d)=>!c[1]||!d[1]?0:c[1].localeCompare(d[1]));for(const[c]of o){const d=this.runMap.get(c),h=a[c];if(!(!d||!h)&&d.parent_run_id){const g=a[d.parent_run_id];g&&(g.child_runs.push(h),h.parent_run=g)}}return a[e]}static getTraceableRunTree(){try{return getCurrentRunTree()}catch{return}}}const TRACING_ALS_KEY=Symbol.for("ls:tracing_async_local_storage"),_CONTEXT_VARIABLES_KEY=Symbol.for("lc:context_variables"),setGlobalAsyncLocalStorageInstance=s=>{globalThis[TRACING_ALS_KEY]=s},getGlobalAsyncLocalStorageInstance=()=>globalThis[TRACING_ALS_KEY];let queue;function createQueue(){const s="default"in _default?_default.default:_default;return new s({autoStart:!0,concurrency:1})}function getQueue(){return typeof queue>"u"&&(queue=createQueue()),queue}async function consumeCallback(s,e){if(e===!0){const a=getGlobalAsyncLocalStorageInstance();a!==void 0?await a.run(void 0,async()=>s()):await s()}else queue=getQueue(),queue.add(async()=>{const a=getGlobalAsyncLocalStorageInstance();a!==void 0?await a.run(void 0,async()=>s()):await s()})}const isTracingEnabled=s=>!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(a=>getEnvironmentVariable(a)==="true");function getContextVariable(s){var o;const e=getGlobalAsyncLocalStorageInstance();if(e===void 0)return;const a=e.getStore();return(o=a==null?void 0:a[_CONTEXT_VARIABLES_KEY])==null?void 0:o[s]}const LC_CONFIGURE_HOOKS_KEY=Symbol("lc:configure_hooks"),_getConfigureHooks=()=>getContextVariable(LC_CONFIGURE_HOOKS_KEY)||[];class BaseCallbackManager{setHandler(e){return this.setHandlers([e])}}class BaseRunManager{constructor(e,a,o,c,d,h,g,_){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:c}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:d}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:h}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:g}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:_})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(a=>consumeCallback(async()=>{var o;try{await((o=a.handleText)==null?void 0:o.call(a,e,this.runId,this._parentRunId,this.tags))}catch(c){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleText: ${c}`),a.raiseError)throw c}},a.awaitHandlers)))}async handleCustomEvent(e,a,o,c,d){await Promise.all(this.handlers.map(h=>consumeCallback(async()=>{var g;try{await((g=h.handleCustomEvent)==null?void 0:g.call(h,e,a,this.runId,this.tags,this.metadata))}catch(_){if((h.raiseError?console.error:console.warn)(`Error in handler ${h.constructor.name}, handleCustomEvent: ${_}`),h.raiseError)throw _}},h.awaitHandlers)))}}class CallbackManagerForRetrieverRun extends BaseRunManager{getChild(e){const a=new CallbackManager(this.runId);return a.setHandlers(this.inheritableHandlers),a.addTags(this.inheritableTags),a.addMetadata(this.inheritableMetadata),e&&a.addTags([e],!1),a}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(a=>consumeCallback(async()=>{var o;if(!a.ignoreRetriever)try{await((o=a.handleRetrieverEnd)==null?void 0:o.call(a,e,this.runId,this._parentRunId,this.tags))}catch(c){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleRetriever`),a.raiseError)throw c}},a.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(a=>consumeCallback(async()=>{var o;if(!a.ignoreRetriever)try{await((o=a.handleRetrieverError)==null?void 0:o.call(a,e,this.runId,this._parentRunId,this.tags))}catch(c){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleRetrieverError: ${c}`),a.raiseError)throw e}},a.awaitHandlers)))}}class CallbackManagerForLLMRun extends BaseRunManager{async handleLLMNewToken(e,a,o,c,d,h){await Promise.all(this.handlers.map(g=>consumeCallback(async()=>{var _;if(!g.ignoreLLM)try{await((_=g.handleLLMNewToken)==null?void 0:_.call(g,e,a??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,h))}catch(b){if((g.raiseError?console.error:console.warn)(`Error in handler ${g.constructor.name}, handleLLMNewToken: ${b}`),g.raiseError)throw b}},g.awaitHandlers)))}async handleLLMError(e,a,o,c,d){await Promise.all(this.handlers.map(h=>consumeCallback(async()=>{var g;if(!h.ignoreLLM)try{await((g=h.handleLLMError)==null?void 0:g.call(h,e,this.runId,this._parentRunId,this.tags,d))}catch(_){if((h.raiseError?console.error:console.warn)(`Error in handler ${h.constructor.name}, handleLLMError: ${_}`),h.raiseError)throw _}},h.awaitHandlers)))}async handleLLMEnd(e,a,o,c,d){await Promise.all(this.handlers.map(h=>consumeCallback(async()=>{var g;if(!h.ignoreLLM)try{await((g=h.handleLLMEnd)==null?void 0:g.call(h,e,this.runId,this._parentRunId,this.tags,d))}catch(_){if((h.raiseError?console.error:console.warn)(`Error in handler ${h.constructor.name}, handleLLMEnd: ${_}`),h.raiseError)throw _}},h.awaitHandlers)))}}class CallbackManagerForChainRun extends BaseRunManager{getChild(e){const a=new CallbackManager(this.runId);return a.setHandlers(this.inheritableHandlers),a.addTags(this.inheritableTags),a.addMetadata(this.inheritableMetadata),e&&a.addTags([e],!1),a}async handleChainError(e,a,o,c,d){await Promise.all(this.handlers.map(h=>consumeCallback(async()=>{var g;if(!h.ignoreChain)try{await((g=h.handleChainError)==null?void 0:g.call(h,e,this.runId,this._parentRunId,this.tags,d))}catch(_){if((h.raiseError?console.error:console.warn)(`Error in handler ${h.constructor.name}, handleChainError: ${_}`),h.raiseError)throw _}},h.awaitHandlers)))}async handleChainEnd(e,a,o,c,d){await Promise.all(this.handlers.map(h=>consumeCallback(async()=>{var g;if(!h.ignoreChain)try{await((g=h.handleChainEnd)==null?void 0:g.call(h,e,this.runId,this._parentRunId,this.tags,d))}catch(_){if((h.raiseError?console.error:console.warn)(`Error in handler ${h.constructor.name}, handleChainEnd: ${_}`),h.raiseError)throw _}},h.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(a=>consumeCallback(async()=>{var o;if(!a.ignoreAgent)try{await((o=a.handleAgentAction)==null?void 0:o.call(a,e,this.runId,this._parentRunId,this.tags))}catch(c){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleAgentAction: ${c}`),a.raiseError)throw c}},a.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(a=>consumeCallback(async()=>{var o;if(!a.ignoreAgent)try{await((o=a.handleAgentEnd)==null?void 0:o.call(a,e,this.runId,this._parentRunId,this.tags))}catch(c){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleAgentEnd: ${c}`),a.raiseError)throw c}},a.awaitHandlers)))}}class CallbackManagerForToolRun extends BaseRunManager{getChild(e){const a=new CallbackManager(this.runId);return a.setHandlers(this.inheritableHandlers),a.addTags(this.inheritableTags),a.addMetadata(this.inheritableMetadata),e&&a.addTags([e],!1),a}async handleToolError(e){await Promise.all(this.handlers.map(a=>consumeCallback(async()=>{var o;if(!a.ignoreAgent)try{await((o=a.handleToolError)==null?void 0:o.call(a,e,this.runId,this._parentRunId,this.tags))}catch(c){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleToolError: ${c}`),a.raiseError)throw c}},a.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(a=>consumeCallback(async()=>{var o;if(!a.ignoreAgent)try{await((o=a.handleToolEnd)==null?void 0:o.call(a,e,this.runId,this._parentRunId,this.tags))}catch(c){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleToolEnd: ${c}`),a.raiseError)throw c}},a.awaitHandlers)))}}class CallbackManager extends BaseCallbackManager{constructor(e,a){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=(a==null?void 0:a.handlers)??this.handlers,this.inheritableHandlers=(a==null?void 0:a.inheritableHandlers)??this.inheritableHandlers,this.tags=(a==null?void 0:a.tags)??this.tags,this.inheritableTags=(a==null?void 0:a.inheritableTags)??this.inheritableTags,this.metadata=(a==null?void 0:a.metadata)??this.metadata,this.inheritableMetadata=(a==null?void 0:a.inheritableMetadata)??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,a,o=void 0,c=void 0,d=void 0,h=void 0,g=void 0,_=void 0){return Promise.all(a.map(async(b,j)=>{const $=j===0&&o?o:v4();return await Promise.all(this.handlers.map(_e=>{if(!_e.ignoreLLM)return isBaseTracer(_e)&&_e._createRunForLLMStart(e,[b],$,this._parentRunId,d,this.tags,this.metadata,_),consumeCallback(async()=>{var tt;try{await((tt=_e.handleLLMStart)==null?void 0:tt.call(_e,e,[b],$,this._parentRunId,d,this.tags,this.metadata,_))}catch(et){if((_e.raiseError?console.error:console.warn)(`Error in handler ${_e.constructor.name}, handleLLMStart: ${et}`),_e.raiseError)throw et}},_e.awaitHandlers)})),new CallbackManagerForLLMRun($,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,a,o=void 0,c=void 0,d=void 0,h=void 0,g=void 0,_=void 0){return Promise.all(a.map(async(b,j)=>{const $=j===0&&o?o:v4();return await Promise.all(this.handlers.map(_e=>{if(!_e.ignoreLLM)return isBaseTracer(_e)&&_e._createRunForChatModelStart(e,[b],$,this._parentRunId,d,this.tags,this.metadata,_),consumeCallback(async()=>{var tt,et;try{if(_e.handleChatModelStart)await((tt=_e.handleChatModelStart)==null?void 0:tt.call(_e,e,[b],$,this._parentRunId,d,this.tags,this.metadata,_));else if(_e.handleLLMStart){const st=getBufferString(b);await((et=_e.handleLLMStart)==null?void 0:et.call(_e,e,[st],$,this._parentRunId,d,this.tags,this.metadata,_))}}catch(st){if((_e.raiseError?console.error:console.warn)(`Error in handler ${_e.constructor.name}, handleLLMStart: ${st}`),_e.raiseError)throw st}},_e.awaitHandlers)})),new CallbackManagerForLLMRun($,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,a,o=v4(),c=void 0,d=void 0,h=void 0,g=void 0){return await Promise.all(this.handlers.map(_=>{if(!_.ignoreChain)return isBaseTracer(_)&&_._createRunForChainStart(e,a,o,this._parentRunId,this.tags,this.metadata,c,g),consumeCallback(async()=>{var b;try{await((b=_.handleChainStart)==null?void 0:b.call(_,e,a,o,this._parentRunId,this.tags,this.metadata,c,g))}catch(j){if((_.raiseError?console.error:console.warn)(`Error in handler ${_.constructor.name}, handleChainStart: ${j}`),_.raiseError)throw j}},_.awaitHandlers)})),new CallbackManagerForChainRun(o,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,a,o=v4(),c=void 0,d=void 0,h=void 0,g=void 0){return await Promise.all(this.handlers.map(_=>{if(!_.ignoreAgent)return isBaseTracer(_)&&_._createRunForToolStart(e,a,o,this._parentRunId,this.tags,this.metadata,g),consumeCallback(async()=>{var b;try{await((b=_.handleToolStart)==null?void 0:b.call(_,e,a,o,this._parentRunId,this.tags,this.metadata,g))}catch(j){if((_.raiseError?console.error:console.warn)(`Error in handler ${_.constructor.name}, handleToolStart: ${j}`),_.raiseError)throw j}},_.awaitHandlers)})),new CallbackManagerForToolRun(o,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,a,o=v4(),c=void 0,d=void 0,h=void 0,g=void 0){return await Promise.all(this.handlers.map(_=>{if(!_.ignoreRetriever)return isBaseTracer(_)&&_._createRunForRetrieverStart(e,a,o,this._parentRunId,this.tags,this.metadata,g),consumeCallback(async()=>{var b;try{await((b=_.handleRetrieverStart)==null?void 0:b.call(_,e,a,o,this._parentRunId,this.tags,this.metadata,g))}catch(j){if((_.raiseError?console.error:console.warn)(`Error in handler ${_.constructor.name}, handleRetrieverStart: ${j}`),_.raiseError)throw j}},_.awaitHandlers)})),new CallbackManagerForRetrieverRun(o,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(e,a,o,c,d){await Promise.all(this.handlers.map(h=>consumeCallback(async()=>{var g;if(!h.ignoreCustomEvent)try{await((g=h.handleCustomEvent)==null?void 0:g.call(h,e,a,o,this.tags,this.metadata))}catch(_){if((h.raiseError?console.error:console.warn)(`Error in handler ${h.constructor.name}, handleCustomEvent: ${_}`),h.raiseError)throw _}},h.awaitHandlers)))}addHandler(e,a=!0){this.handlers.push(e),a&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(a=>a!==e),this.inheritableHandlers=this.inheritableHandlers.filter(a=>a!==e)}setHandlers(e,a=!0){this.handlers=[],this.inheritableHandlers=[];for(const o of e)this.addHandler(o,a)}addTags(e,a=!0){this.removeTags(e),this.tags.push(...e),a&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(a=>!e.includes(a)),this.inheritableTags=this.inheritableTags.filter(a=>!e.includes(a))}addMetadata(e,a=!0){this.metadata={...this.metadata,...e},a&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const a of Object.keys(e))delete this.metadata[a],delete this.inheritableMetadata[a]}copy(e=[],a=!0){const o=new CallbackManager(this._parentRunId);for(const c of this.handlers){const d=this.inheritableHandlers.includes(c);o.addHandler(c,d)}for(const c of this.tags){const d=this.inheritableTags.includes(c);o.addTags([c],d)}for(const c of Object.keys(this.metadata)){const d=Object.keys(this.inheritableMetadata).includes(c);o.addMetadata({[c]:this.metadata[c]},d)}for(const c of e)o.handlers.filter(d=>d.name==="console_callback_handler").some(d=>d.name===c.name)||o.addHandler(c,a);return o}static fromHandlers(e){class a extends BaseCallbackHandler{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:v4()}),Object.assign(this,e)}}const o=new this;return o.addHandler(new a),o}static configure(e,a,o,c,d,h,g){return this._configureSync(e,a,o,c,d,h,g)}static _configureSync(e,a,o,c,d,h,g){var _e,tt;let _;(e||a)&&(Array.isArray(e)||!e?(_=new CallbackManager,_.setHandlers((e==null?void 0:e.map(ensureHandler))??[],!0)):_=e,_=_.copy(Array.isArray(a)?a.map(ensureHandler):a==null?void 0:a.handlers,!1));const b=getEnvironmentVariable("LANGCHAIN_VERBOSE")==="true"||(g==null?void 0:g.verbose),j=((_e=LangChainTracer.getTraceableRunTree())==null?void 0:_e.tracingEnabled)||isTracingEnabled(),$=j||(getEnvironmentVariable("LANGCHAIN_TRACING")??!1);if(b||$){if(_||(_=new CallbackManager),b&&!_.handlers.some(et=>et.name===ConsoleCallbackHandler.prototype.name)){const et=new ConsoleCallbackHandler;_.addHandler(et,!0)}if($&&!_.handlers.some(et=>et.name==="langchain_tracer")&&j){const et=new LangChainTracer;_.addHandler(et,!0),_._parentRunId=((tt=LangChainTracer.getTraceableRunTree())==null?void 0:tt.id)??_._parentRunId}}for(const{contextVar:et,inheritable:st=!0,handlerClass:rt,envVar:nt}of _getConfigureHooks()){const it=nt&&getEnvironmentVariable(nt)==="true"&&rt;let at;const dt=et!==void 0?getContextVariable(et):void 0;dt&&isBaseCallbackHandler(dt)?at=dt:it&&(at=new rt({})),at!==void 0&&(_||(_=new CallbackManager),_.handlers.some(ot=>ot.name===at.name)||_.addHandler(at,st))}return(o||c)&&_&&(_.addTags(o??[]),_.addTags(c??[],!1)),(d||h)&&_&&(_.addMetadata(d??{}),_.addMetadata(h??{},!1)),_}}function ensureHandler(s){return"name"in s?s:BaseCallbackHandler.fromMethods(s)}class MockAsyncLocalStorage{getStore(){}run(e,a){return a()}enterWith(e){}}const mockAsyncLocalStorage=new MockAsyncLocalStorage,LC_CHILD_KEY=Symbol.for("lc:child_config");class AsyncLocalStorageProvider{getInstance(){return getGlobalAsyncLocalStorageInstance()??mockAsyncLocalStorage}getRunnableConfig(){var a,o;return(o=(a=this.getInstance().getStore())==null?void 0:a.extra)==null?void 0:o[LC_CHILD_KEY]}runWithConfig(e,a,o){var j;const c=CallbackManager._configureSync(e==null?void 0:e.callbacks,void 0,e==null?void 0:e.tags,void 0,e==null?void 0:e.metadata),d=this.getInstance(),h=d.getStore(),g=c==null?void 0:c.getParentRunId(),_=(j=c==null?void 0:c.handlers)==null?void 0:j.find($=>($==null?void 0:$.name)==="langchain_tracer");let b;return _&&g?b=_.convertToRunTree(g):o||(b=new RunTree({name:"<runnable_lambda>",tracingEnabled:!1})),b&&(b.extra={...b.extra,[LC_CHILD_KEY]:e}),h!==void 0&&h[_CONTEXT_VARIABLES_KEY]!==void 0&&(b[_CONTEXT_VARIABLES_KEY]=h[_CONTEXT_VARIABLES_KEY]),d.run(b,a)}initializeGlobalInstance(e){getGlobalAsyncLocalStorageInstance()===void 0&&setGlobalAsyncLocalStorageInstance(e)}}const AsyncLocalStorageProviderSingleton=new AsyncLocalStorageProvider,DEFAULT_RECURSION_LIMIT=25;async function getCallbackManagerForConfig(s){return CallbackManager._configureSync(s==null?void 0:s.callbacks,void 0,s==null?void 0:s.tags,void 0,s==null?void 0:s.metadata)}function mergeConfigs(...s){const e={};for(const a of s.filter(o=>!!o))for(const o of Object.keys(a))if(o==="metadata")e[o]={...e[o],...a[o]};else if(o==="tags"){const c=e[o]??[];e[o]=[...new Set(c.concat(a[o]??[]))]}else if(o==="configurable")e[o]={...e[o],...a[o]};else if(o==="timeout")e.timeout===void 0?e.timeout=a.timeout:a.timeout!==void 0&&(e.timeout=Math.min(e.timeout,a.timeout));else if(o==="signal")e.signal===void 0?e.signal=a.signal:a.signal!==void 0&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,a.signal]):e.signal=a.signal);else if(o==="callbacks"){const c=e.callbacks,d=a.callbacks;if(Array.isArray(d))if(!c)e.callbacks=d;else if(Array.isArray(c))e.callbacks=c.concat(d);else{const h=c.copy();for(const g of d)h.addHandler(ensureHandler(g),!0);e.callbacks=h}else if(d)if(!c)e.callbacks=d;else if(Array.isArray(c)){const h=d.copy();for(const g of c)h.addHandler(ensureHandler(g),!0);e.callbacks=h}else e.callbacks=new CallbackManager(d._parentRunId,{handlers:c.handlers.concat(d.handlers),inheritableHandlers:c.inheritableHandlers.concat(d.inheritableHandlers),tags:Array.from(new Set(c.tags.concat(d.tags))),inheritableTags:Array.from(new Set(c.inheritableTags.concat(d.inheritableTags))),metadata:{...c.metadata,...d.metadata}})}else{const c=o;e[c]=a[c]??e[c]}return e}const PRIMITIVES=new Set(["string","number","boolean"]);function ensureConfig(s){var o;const e=AsyncLocalStorageProviderSingleton.getRunnableConfig();let a={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(e){const{runId:c,runName:d,...h}=e;a=Object.entries(h).reduce((g,[_,b])=>(b!==void 0&&(g[_]=b),g),a)}if(s&&(a=Object.entries(s).reduce((c,[d,h])=>(h!==void 0&&(c[d]=h),c),a)),a!=null&&a.configurable)for(const c of Object.keys(a.configurable))PRIMITIVES.has(typeof a.configurable[c])&&!((o=a.metadata)!=null&&o[c])&&(a.metadata||(a.metadata={}),a.metadata[c]=a.configurable[c]);if(a.timeout!==void 0){if(a.timeout<=0)throw new Error("Timeout must be a positive number");const c=AbortSignal.timeout(a.timeout);a.signal!==void 0?"any"in AbortSignal&&(a.signal=AbortSignal.any([a.signal,c])):a.signal=c,delete a.timeout}return a}function patchConfig(s={},{callbacks:e,maxConcurrency:a,recursionLimit:o,runName:c,configurable:d,runId:h}={}){const g=ensureConfig(s);return e!==void 0&&(delete g.runName,g.callbacks=e),o!==void 0&&(g.recursionLimit=o),a!==void 0&&(g.maxConcurrency=a),c!==void 0&&(g.runName=c),d!==void 0&&(g.configurable={...g.configurable,...d}),h!==void 0&&delete g.runId,g}function pickRunnableConfigKeys(s){return s?{configurable:s.configurable,recursionLimit:s.recursionLimit,callbacks:s.callbacks,tags:s.tags,metadata:s.metadata,maxConcurrency:s.maxConcurrency,timeout:s.timeout,signal:s.signal}:void 0}async function raceWithSignal(s,e){if(e===void 0)return s;let a;return Promise.race([s.catch(o=>{if(!(e!=null&&e.aborted))throw o}),new Promise((o,c)=>{a=()=>{c(new Error("Aborted"))},e.addEventListener("abort",a),e.aborted&&c(new Error("Aborted"))})]).finally(()=>e.removeEventListener("abort",a))}class IterableReadableStream extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){const a=this.reader.cancel();this.reader.releaseLock(),await a}throw e}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(e){const a=e.getReader();return new IterableReadableStream({start(o){return c();function c(){return a.read().then(({done:d,value:h})=>{if(d){o.close();return}return o.enqueue(h),c()})}},cancel(){a.releaseLock()}})}static fromAsyncGenerator(e){return new IterableReadableStream({async pull(a){const{value:o,done:c}=await e.next();c&&a.close(),a.enqueue(o)},async cancel(a){await e.return(a)}})}}function atee(s,e=2){const a=Array.from({length:e},()=>[]);return a.map(async function*(c){for(;;)if(c.length===0){const d=await s.next();for(const h of a)h.push(d)}else{if(c[0].done)return;yield c.shift().value}})}function concat(s,e){if(Array.isArray(s)&&Array.isArray(e))return s.concat(e);if(typeof s=="string"&&typeof e=="string")return s+e;if(typeof s=="number"&&typeof e=="number")return s+e;if("concat"in s&&typeof s.concat=="function")return s.concat(e);if(typeof s=="object"&&typeof e=="object"){const a={...s};for(const[o,c]of Object.entries(e))o in a&&!Array.isArray(a[o])?a[o]=concat(a[o],c):a[o]=c;return a}else throw new Error(`Cannot concat ${typeof s} and ${typeof e}`)}class AsyncGeneratorWithSetup{constructor(e){var a;Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??((a=this.config)==null?void 0:a.signal),this.setup=new Promise((o,c)=>{AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(e.config),async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(o,c):this.firstResult.then(d=>o(void 0),c)},!0)})}async next(...e){var a;return(a=this.signal)==null||a.throwIfAborted(),this.firstResultUsed?AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(this.config),this.signal?async()=>raceWithSignal(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}}async function pipeGeneratorWithSetup(s,e,a,o,...c){const d=new AsyncGeneratorWithSetup({generator:e,startSetup:a,signal:o}),h=await d.setup;return{output:s(d,h,...c),setup:h}}class RunLogPatch{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){const a=this.ops.concat(e.ops),o=applyPatch({},a);return new RunLog({ops:a,state:o[o.length-1].newDocument})}}class RunLog extends RunLogPatch{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){const a=this.ops.concat(e.ops),o=applyPatch(this.state,e.ops);return new RunLog({ops:a,state:o[o.length-1].newDocument})}static fromRunLogPatch(e){const a=applyPatch({},e.ops);return new RunLog({ops:e.ops,state:a[a.length-1].newDocument})}}const isLogStreamHandler=s=>s.name==="log_stream_tracer";async function _getStandardizedInputs(s,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:a}=s;if(["retriever","llm","prompt"].includes(s.run_type))return a;if(!(Object.keys(a).length===1&&(a==null?void 0:a.input)===""))return a.input}async function _getStandardizedOutputs(s,e){const{outputs:a}=s;return e==="original"||["retriever","llm","prompt"].includes(s.run_type)?a:a!==void 0&&Object.keys(a).length===1&&(a==null?void 0:a.output)!==void 0?a.output:a}function isChatGenerationChunk(s){return s!==void 0&&s.message!==void 0}class LogStreamCallbackHandler extends BaseTracer{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this._schemaFormat=(e==null?void 0:e._schemaFormat)??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=IterableReadableStream.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const a=e.tags??[];let o=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(o=o||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(o=o||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(o=o||a.find(c=>{var d;return(d=this.includeTags)==null?void 0:d.includes(c)})!==void 0),this.excludeNames!==void 0&&(o=o&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(o=o&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(o=o&&a.every(c=>{var d;return!((d=this.excludeTags)!=null&&d.includes(c))})),o}async*tapOutputIterable(e,a){for await(const o of a){if(e!==this.rootId){const c=this.keyMapByRunId[e];c&&await this.writer.write(new RunLogPatch({ops:[{op:"add",path:`/logs/${c}/streamed_output/-`,value:o}]}))}yield o}}async onRunCreate(e){var c;if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new RunLogPatch({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const a=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=a===1?e.name:`${e.name}:${a}`;const o={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:((c=e.extra)==null?void 0:c.metadata)??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(o.inputs=await _getStandardizedInputs(e,this._schemaFormat)),await this.writer.write(new RunLogPatch({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:o}]}))}async onRunUpdate(e){try{const a=this.keyMapByRunId[e.id];if(a===void 0)return;const o=[];this._schemaFormat==="streaming_events"&&o.push({op:"replace",path:`/logs/${a}/inputs`,value:await _getStandardizedInputs(e,this._schemaFormat)}),o.push({op:"add",path:`/logs/${a}/final_output`,value:await _getStandardizedOutputs(e,this._schemaFormat)}),e.end_time!==void 0&&o.push({op:"add",path:`/logs/${a}/end_time`,value:new Date(e.end_time).toISOString()});const c=new RunLogPatch({ops:o});await this.writer.write(c)}finally{if(e.id===this.rootId){const a=new RunLogPatch({ops:[{op:"replace",path:"/final_output",value:await _getStandardizedOutputs(e,this._schemaFormat)}]});await this.writer.write(a),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,a,o){const c=this.keyMapByRunId[e.id];if(c===void 0)return;const d=e.inputs.messages!==void 0;let h;d?isChatGenerationChunk(o==null?void 0:o.chunk)?h=o==null?void 0:o.chunk:h=new AIMessageChunk({id:`run-${e.id}`,content:a}):h=a;const g=new RunLogPatch({ops:[{op:"add",path:`/logs/${c}/streamed_output_str/-`,value:a},{op:"add",path:`/logs/${c}/streamed_output/-`,value:h}]});await this.writer.write(g)}}const RUN_KEY="__run";class GenerationChunk{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new GenerationChunk({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class ChatGenerationChunk extends GenerationChunk{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new ChatGenerationChunk({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}function assignName({name:s,serialized:e}){return s!==void 0?s:(e==null?void 0:e.name)!==void 0?e.name:(e==null?void 0:e.id)!==void 0&&Array.isArray(e==null?void 0:e.id)?e.id[e.id.length-1]:"Unnamed"}const isStreamEventsHandler=s=>s.name==="event_stream_tracer";class EventStreamCallbackHandler extends BaseTracer{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=IterableReadableStream.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const a=e.tags??[];let o=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(o=o||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(o=o||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(o=o||a.find(c=>{var d;return(d=this.includeTags)==null?void 0:d.includes(c)})!==void 0),this.excludeNames!==void 0&&(o=o&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(o=o&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(o=o&&a.every(c=>{var d;return!((d=this.excludeTags)!=null&&d.includes(c))})),o}async*tapOutputIterable(e,a){const o=await a.next();if(o.done)return;const c=this.runInfoMap.get(e);if(c===void 0){yield o.value;return}function d(g,_){return g==="llm"&&typeof _=="string"?new GenerationChunk({text:_}):_}let h=this.tappedPromises.get(e);if(h===void 0){let g;h=new Promise(_=>{g=_}),this.tappedPromises.set(e,h);try{const _={event:`on_${c.runType}_stream`,run_id:e,name:c.name,tags:c.tags,metadata:c.metadata,data:{}};await this.send({..._,data:{chunk:d(c.runType,o.value)}},c),yield o.value;for await(const b of a)c.runType!=="tool"&&c.runType!=="retriever"&&await this.send({..._,data:{chunk:d(c.runType,b)}},c),yield b}finally{g()}}else{yield o.value;for await(const g of a)yield g}}async send(e,a){this._includeRun(a)&&await this.writer.write(e)}async sendEndEvent(e,a){const o=this.tappedPromises.get(e.run_id);o!==void 0?o.then(()=>{this.send(e,a)}):await this.send(e,a)}async onLLMStart(e){var h,g;const a=assignName(e),o=e.inputs.messages!==void 0?"chat_model":"llm",c={tags:e.tags??[],metadata:((h=e.extra)==null?void 0:h.metadata)??{},name:a,runType:o,inputs:e.inputs};this.runInfoMap.set(e.id,c);const d=`on_${o}_start`;await this.send({event:d,data:{input:e.inputs},name:a,tags:e.tags??[],run_id:e.id,metadata:((g=e.extra)==null?void 0:g.metadata)??{}},c)}async onLLMNewToken(e,a,o){const c=this.runInfoMap.get(e.id);let d,h;if(c===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(this.runInfoMap.size!==1){if(c.runType==="chat_model")h="on_chat_model_stream",(o==null?void 0:o.chunk)===void 0?d=new AIMessageChunk({content:a,id:`run-${e.id}`}):d=o.chunk.message;else if(c.runType==="llm")h="on_llm_stream",(o==null?void 0:o.chunk)===void 0?d=new GenerationChunk({text:a}):d=o.chunk;else throw new Error(`Unexpected run type ${c.runType}`);await this.send({event:h,data:{chunk:d},run_id:e.id,name:c.name,tags:c.tags,metadata:c.metadata},c)}}async onLLMEnd(e){var h,g,_;const a=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let o;if(a===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const c=(h=e.outputs)==null?void 0:h.generations;let d;if(a.runType==="chat_model"){for(const b of c??[]){if(d!==void 0)break;d=(g=b[0])==null?void 0:g.message}o="on_chat_model_end"}else if(a.runType==="llm")d={generations:c==null?void 0:c.map(b=>b.map(j=>({text:j.text,generationInfo:j.generationInfo}))),llmOutput:((_=e.outputs)==null?void 0:_.llmOutput)??{}},o="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${a.runType}`);await this.sendEndEvent({event:o,data:{output:d,input:a.inputs},run_id:e.id,name:a.name,tags:a.tags,metadata:a.metadata},a)}async onChainStart(e){var h,g;const a=assignName(e),o=e.run_type??"chain",c={tags:e.tags??[],metadata:((h=e.extra)==null?void 0:h.metadata)??{},name:a,runType:e.run_type};let d={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(d={},c.inputs={}):e.inputs.input!==void 0?(d.input=e.inputs.input,c.inputs=e.inputs.input):(d.input=e.inputs,c.inputs=e.inputs),this.runInfoMap.set(e.id,c),await this.send({event:`on_${o}_start`,data:d,name:a,tags:e.tags??[],run_id:e.id,metadata:((g=e.extra)==null?void 0:g.metadata)??{}},c)}async onChainEnd(e){var g;const a=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),a===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const o=`on_${e.run_type}_end`,c=e.inputs??a.inputs??{},h={output:((g=e.outputs)==null?void 0:g.output)??e.outputs,input:c};c.input&&Object.keys(c).length===1&&(h.input=c.input,a.inputs=c.input),await this.sendEndEvent({event:o,data:h,run_id:e.id,name:a.name,tags:a.tags,metadata:a.metadata??{}},a)}async onToolStart(e){var c,d;const a=assignName(e),o={tags:e.tags??[],metadata:((c=e.extra)==null?void 0:c.metadata)??{},name:a,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,o),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:a,run_id:e.id,tags:e.tags??[],metadata:((d=e.extra)==null?void 0:d.metadata)??{}},o)}async onToolEnd(e){var c;const a=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),a===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(a.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const o=((c=e.outputs)==null?void 0:c.output)===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:o,input:a.inputs},run_id:e.id,name:a.name,tags:a.tags,metadata:a.metadata},a)}async onRetrieverStart(e){var d,h;const a=assignName(e),c={tags:e.tags??[],metadata:((d=e.extra)==null?void 0:d.metadata)??{},name:a,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,c),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:a,tags:e.tags??[],run_id:e.id,metadata:((h=e.extra)==null?void 0:h.metadata)??{}},c)}async onRetrieverEnd(e){var o;const a=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),a===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:((o=e.outputs)==null?void 0:o.documents)??e.outputs,input:a.inputs},run_id:e.id,name:a.name,tags:a.tags,metadata:a.metadata},a)}async handleCustomEvent(e,a,o){const c=this.runInfoMap.get(o);if(c===void 0)throw new Error(`handleCustomEvent: Run ID ${o} not found in run map.`);await this.send({event:"on_custom_event",run_id:o,name:e,tags:c.tags,metadata:c.metadata,data:a},c)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}}const STATUS_NO_RETRY=[400,401,402,403,404,405,406,407,409],defaultFailedAttemptHandler=s=>{var a,o;if(s.message.startsWith("Cancel")||s.message.startsWith("AbortError")||s.name==="AbortError"||(s==null?void 0:s.code)==="ECONNABORTED")throw s;const e=((a=s==null?void 0:s.response)==null?void 0:a.status)??(s==null?void 0:s.status);if(e&&STATUS_NO_RETRY.includes(+e))throw s;if(((o=s==null?void 0:s.error)==null?void 0:o.code)==="insufficient_quota"){const c=new Error(s==null?void 0:s.message);throw c.name="InsufficientQuotaError",c}};class AsyncCaller{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??defaultFailedAttemptHandler;const a="default"in _default?_default.default:_default;this.queue=new a({concurrency:this.maxConcurrency})}call(e,...a){return this.queue.add(()=>pRetry$1(()=>e(...a).catch(o=>{throw o instanceof Error?o:new Error(o)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,a,...o){return e.signal?Promise.race([this.call(a,...o),new Promise((c,d)=>{var h;(h=e.signal)==null||h.addEventListener("abort",()=>{d(new Error("AbortError"))})})]):this.call(a,...o)}fetch(...e){return this.call(()=>fetch(...e).then(a=>a.ok?a:Promise.reject(a)))}}class RootListenersTracer extends BaseTracer{constructor({config:e,onStart:a,onEnd:o,onError:c}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=a,this.argOnEnd=o,this.argOnError=c}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}}function isRunnableInterface(s){return s?s.lc_runnable:!1}class _RootEventFilter{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,a){let o=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const c=e.tags??[];return this.includeNames!==void 0&&(o=o||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(o=o||this.includeTypes.includes(a)),this.includeTags!==void 0&&(o=o||c.some(d=>{var h;return(h=this.includeTags)==null?void 0:h.includes(d)})),this.excludeNames!==void 0&&(o=o&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(o=o&&!this.excludeTypes.includes(a)),this.excludeTags!==void 0&&(o=o&&c.every(d=>{var h;return!((h=this.excludeTags)!=null&&h.includes(d))})),o}}function _escapeNodeLabel(s){return s.replace(/[^a-zA-Z-_0-9]/g,"_")}const MARKDOWN_SPECIAL_CHARS=["*","_","`"];function _generateMermaidGraphStyles(s){let e="";for(const[a,o]of Object.entries(s))e+=`	classDef ${a} ${o};
`;return e}function drawMermaid(s,e,a){const{firstNode:o,lastNode:c,nodeColors:d,withStyles:h=!0,curveStyle:g="linear",wrapLabelNWords:_=9}=a??{};let b=h?`%%{init: {'flowchart': {'curve': '${g}'}}}%%
graph TD;
`:`graph TD;
`;if(h){const tt="default",et={[tt]:"{0}({1})"};o!==void 0&&(et[o]="{0}([{1}]):::first"),c!==void 0&&(et[c]="{0}([{1}]):::last");for(const[st,rt]of Object.entries(s)){const nt=rt.name.split(":").pop()??"";let at=MARKDOWN_SPECIAL_CHARS.some(ot=>nt.startsWith(ot)&&nt.endsWith(ot))?`<p>${nt}</p>`:nt;Object.keys(rt.metadata??{}).length&&(at+=`<hr/><small><em>${Object.entries(rt.metadata??{}).map(([ot,ht])=>`${ot} = ${ht}`).join(`
`)}</em></small>`);const dt=(et[st]??et[tt]).replace("{0}",_escapeNodeLabel(st)).replace("{1}",at);b+=`	${dt}
`}}const j={};for(const tt of e){const et=tt.source.split(":"),st=tt.target.split(":"),rt=et.filter((nt,it)=>nt===st[it]).join(":");j[rt]||(j[rt]=[]),j[rt].push(tt)}const $=new Set;function _e(tt,et){const st=tt.length===1&&tt[0].source===tt[0].target;if(et&&!st){const rt=et.split(":").pop();if($.has(rt))throw new Error(`Found duplicate subgraph '${rt}' -- this likely means that you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.`);$.add(rt),b+=`	subgraph ${rt}
`}for(const rt of tt){const{source:nt,target:it,data:at,conditional:dt}=rt;let ot="";if(at!==void 0){let ht=at;const ut=ht.split(" ");ut.length>_&&(ht=Array.from({length:Math.ceil(ut.length/_)},(pt,_t)=>ut.slice(_t*_,(_t+1)*_).join(" ")).join("&nbsp;<br>&nbsp;")),ot=dt?` -. &nbsp;${ht}&nbsp; .-> `:` -- &nbsp;${ht}&nbsp; --> `}else ot=dt?" -.-> ":" --> ";b+=`	${_escapeNodeLabel(nt)}${ot}${_escapeNodeLabel(it)};
`}for(const rt in j)rt.startsWith(`${et}:`)&&rt!==et&&_e(j[rt],rt);et&&!st&&(b+=`	end
`)}_e(j[""]??[],"");for(const tt in j)!tt.includes(":")&&tt!==""&&_e(j[tt],tt);return h&&(b+=_generateMermaidGraphStyles(d??{})),b}async function drawMermaidPng(s,e){let{backgroundColor:a="white"}=e??{};const o=btoa(s);a!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(a)||(a=`!${a}`));const c=`https://mermaid.ink/img/${o}?bgColor=${a}`,d=await fetch(c);if(!d.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${d.status}`,`Status text: ${d.statusText}`].join(`
`));return await d.blob()}function nodeDataStr(s,e){if(s!==void 0&&!validate$1(s))return s;if(isRunnableInterface(e))try{let a=e.getName();return a=a.startsWith("Runnable")?a.slice(8):a,a}catch{return e.getName()}else return e.name??"UnknownSchema"}function nodeDataJson(s){return isRunnableInterface(s.data)?{type:"runnable",data:{id:s.data.lc_id,name:s.data.getName()}}:{type:"schema",data:{...zodToJsonSchema(s.data.schema),title:s.data.name}}}class Graph{constructor(e){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.nodes=(e==null?void 0:e.nodes)??this.nodes,this.edges=(e==null?void 0:e.edges)??this.edges}toJSON(){const e={};return Object.values(this.nodes).forEach((a,o)=>{e[a.id]=validate$1(a.id)?o:a.id}),{nodes:Object.values(this.nodes).map(a=>({id:e[a.id],...nodeDataJson(a)})),edges:this.edges.map(a=>{const o={source:e[a.source],target:e[a.target]};return typeof a.data<"u"&&(o.data=a.data),typeof a.conditional<"u"&&(o.conditional=a.conditional),o})}}addNode(e,a,o){if(a!==void 0&&this.nodes[a]!==void 0)throw new Error(`Node with id ${a} already exists`);const c=a??v4(),d={id:c,data:e,name:nodeDataStr(a,e),metadata:o};return this.nodes[c]=d,d}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(a=>a.source!==e.id&&a.target!==e.id)}addEdge(e,a,o,c){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[a.id]===void 0)throw new Error(`Target node ${a.id} not in graph`);const d={source:e.id,target:a.id,data:o,conditional:c};return this.edges.push(d),d}firstNode(){return _firstNode(this)}lastNode(){return _lastNode(this)}extend(e,a=""){let o=a;Object.values(e.nodes).map(b=>b.id).every(validate$1)&&(o="");const d=b=>o?`${o}:${b}`:b;Object.entries(e.nodes).forEach(([b,j])=>{this.nodes[d(b)]={...j,id:d(b)}});const h=e.edges.map(b=>({...b,source:d(b.source),target:d(b.target)}));this.edges=[...this.edges,...h];const g=e.firstNode(),_=e.lastNode();return[g?{id:d(g.id),data:g.data}:void 0,_?{id:d(_.id),data:_.data}:void 0]}trimFirstNode(){const e=this.firstNode();e&&_firstNode(this,[e.id])&&this.removeNode(e)}trimLastNode(){const e=this.lastNode();e&&_lastNode(this,[e.id])&&this.removeNode(e)}reid(){const e=Object.fromEntries(Object.values(this.nodes).map(c=>[c.id,c.name])),a=new Map;Object.values(e).forEach(c=>{a.set(c,(a.get(c)||0)+1)});const o=c=>{const d=e[c];return validate$1(c)&&a.get(d)===1?d:c};return new Graph({nodes:Object.fromEntries(Object.entries(this.nodes).map(([c,d])=>[o(c),{...d,id:o(c)}])),edges:this.edges.map(c=>({...c,source:o(c.source),target:o(c.target)}))})}drawMermaid(e){const{withStyles:a,curveStyle:o,nodeColors:c={default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"},wrapLabelNWords:d}=e??{},h=this.reid(),g=h.firstNode(),_=h.lastNode();return drawMermaid(h.nodes,h.edges,{firstNode:g==null?void 0:g.id,lastNode:_==null?void 0:_.id,withStyles:a,curveStyle:o,nodeColors:c,wrapLabelNWords:d})}async drawMermaidPng(e){const a=this.drawMermaid(e);return drawMermaidPng(a,{backgroundColor:e==null?void 0:e.backgroundColor})}}function _firstNode(s,e=[]){const a=new Set(s.edges.filter(c=>!e.includes(c.source)).map(c=>c.target)),o=[];for(const c of Object.values(s.nodes))!e.includes(c.id)&&!a.has(c.id)&&o.push(c);return o.length===1?o[0]:void 0}function _lastNode(s,e=[]){const a=new Set(s.edges.filter(c=>!e.includes(c.target)).map(c=>c.source)),o=[];for(const c of Object.values(s.nodes))!e.includes(c.id)&&!a.has(c.id)&&o.push(c);return o.length===1?o[0]:void 0}function convertToHttpEventStream(s){const e=new TextEncoder,a=new ReadableStream({async start(o){for await(const c of s)o.enqueue(e.encode(`event: data
data: ${JSON.stringify(c)}

`));o.enqueue(e.encode(`event: end

`)),o.close()}});return IterableReadableStream.fromReadableStream(a)}function isIterableIterator(s){return typeof s=="object"&&s!==null&&typeof s[Symbol.iterator]=="function"&&typeof s.next=="function"}const isIterator=s=>s!=null&&typeof s=="object"&&"next"in s&&typeof s.next=="function";function isAsyncIterable(s){return typeof s=="object"&&s!==null&&typeof s[Symbol.asyncIterator]=="function"}function*consumeIteratorInContext(s,e){for(;;){const{value:a,done:o}=AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(s),e.next.bind(e),!0);if(o)break;yield a}}async function*consumeAsyncIterableInContext(s,e){const a=e[Symbol.asyncIterator]();for(;;){const{value:o,done:c}=await AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(s),a.next.bind(e),!0);if(c)break;yield o}}function _coerceToDict(s,e){return s&&!Array.isArray(s)&&!(s instanceof Date)&&typeof s=="object"?s:{[e]:s}}class Runnable extends Serializable{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){const a=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${a}${e}`:a}bind(e){return new RunnableBinding({bound:this,kwargs:e,config:{}})}map(){return new RunnableEach({bound:this})}withRetry(e){return new RunnableRetry({bound:this,kwargs:{},config:{},maxAttemptNumber:e==null?void 0:e.stopAfterAttempt,...e})}withConfig(e){return new RunnableBinding({bound:this,config:e,kwargs:{}})}withFallbacks(e){const a=Array.isArray(e)?e:e.fallbacks;return new RunnableWithFallbacks({runnable:this,fallbacks:a})}_getOptionsList(e,a=0){if(Array.isArray(e)&&e.length!==a)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${a} inputs`);if(Array.isArray(e))return e.map(ensureConfig);if(a>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const o=Object.fromEntries(Object.entries(e).filter(([c])=>c!=="runId"));return Array.from({length:a},(c,d)=>ensureConfig(d===0?e:o))}return Array.from({length:a},()=>ensureConfig(e))}async batch(e,a,o){var _;const c=this._getOptionsList(a??{},e.length),d=((_=c[0])==null?void 0:_.maxConcurrency)??(o==null?void 0:o.maxConcurrency),h=new AsyncCaller({maxConcurrency:d,onFailedAttempt:b=>{throw b}}),g=e.map((b,j)=>h.call(async()=>{try{return await this.invoke(b,c[j])}catch($){if(o!=null&&o.returnExceptions)return $;throw $}}));return Promise.all(g)}async*_streamIterator(e,a){yield this.invoke(e,a)}async stream(e,a){const o=ensureConfig(a),c=new AsyncGeneratorWithSetup({generator:this._streamIterator(e,o),config:o});return await c.setup,IterableReadableStream.fromAsyncGenerator(c)}_separateRunnableConfigFromCallOptions(e){let a;e===void 0?a=ensureConfig(e):a=ensureConfig({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});const o={...e};return delete o.callbacks,delete o.tags,delete o.metadata,delete o.runName,delete o.configurable,delete o.recursionLimit,delete o.maxConcurrency,delete o.runId,delete o.timeout,delete o.signal,[a,o]}async _callWithConfig(e,a,o){const c=ensureConfig(o),d=await getCallbackManagerForConfig(c),h=await(d==null?void 0:d.handleChainStart(this.toJSON(),_coerceToDict(a,"input"),c.runId,c==null?void 0:c.runType,void 0,void 0,(c==null?void 0:c.runName)??this.getName()));delete c.runId;let g;try{const _=e.call(this,a,c,h);g=await raceWithSignal(_,o==null?void 0:o.signal)}catch(_){throw await(h==null?void 0:h.handleChainError(_)),_}return await(h==null?void 0:h.handleChainEnd(_coerceToDict(g,"output"))),g}async _batchWithConfig(e,a,o,c){var b;const d=this._getOptionsList(o??{},a.length),h=await Promise.all(d.map(getCallbackManagerForConfig)),g=await Promise.all(h.map(async(j,$)=>{const _e=await(j==null?void 0:j.handleChainStart(this.toJSON(),_coerceToDict(a[$],"input"),d[$].runId,d[$].runType,void 0,void 0,d[$].runName??this.getName()));return delete d[$].runId,_e}));let _;try{const j=e.call(this,a,d,g,c);_=await raceWithSignal(j,(b=d==null?void 0:d[0])==null?void 0:b.signal)}catch(j){throw await Promise.all(g.map($=>$==null?void 0:$.handleChainError(j))),j}return await Promise.all(g.map(j=>j==null?void 0:j.handleChainEnd(_coerceToDict(_,"output")))),_}async*_transformStreamWithConfig(e,a,o){let c,d=!0,h,g=!0;const _=ensureConfig(o),b=await getCallbackManagerForConfig(_);async function*j(){for await(const _e of e){if(d)if(c===void 0)c=_e;else try{c=concat(c,_e)}catch{c=void 0,d=!1}yield _e}}let $;try{const _e=await pipeGeneratorWithSetup(a.bind(this),j(),async()=>b==null?void 0:b.handleChainStart(this.toJSON(),{input:""},_.runId,_.runType,void 0,void 0,_.runName??this.getName()),o==null?void 0:o.signal,_);delete _.runId,$=_e.setup;const tt=$==null?void 0:$.handlers.find(isStreamEventsHandler);let et=_e.output;tt!==void 0&&$!==void 0&&(et=tt.tapOutputIterable($.runId,et));const st=$==null?void 0:$.handlers.find(isLogStreamHandler);st!==void 0&&$!==void 0&&(et=st.tapOutputIterable($.runId,et));for await(const rt of et)if(yield rt,g)if(h===void 0)h=rt;else try{h=concat(h,rt)}catch{h=void 0,g=!1}}catch(_e){throw await($==null?void 0:$.handleChainError(_e,void 0,void 0,void 0,{inputs:_coerceToDict(c,"input")})),_e}await($==null?void 0:$.handleChainEnd(h??{},void 0,void 0,void 0,{inputs:_coerceToDict(c,"input")}))}getGraph(e){const a=new Graph,o=a.addNode({name:`${this.getName()}Input`,schema:z.any()}),c=a.addNode(this),d=a.addNode({name:`${this.getName()}Output`,schema:z.any()});return a.addEdge(o,c),a.addEdge(c,d),a}pipe(e){return new RunnableSequence({first:this,last:_coerceToRunnable(e)})}pick(e){return this.pipe(new RunnablePick(e))}assign(e){return this.pipe(new RunnableAssign(new RunnableMap({steps:e})))}async*transform(e,a){let o;for await(const c of e)o===void 0?o=c:o=concat(o,c);yield*this._streamIterator(o,ensureConfig(a))}async*streamLog(e,a,o){const c=new LogStreamCallbackHandler({...o,autoClose:!1,_schemaFormat:"original"}),d=ensureConfig(a);yield*this._streamLog(e,c,d)}async*_streamLog(e,a,o){const{callbacks:c}=o;if(c===void 0)o.callbacks=[a];else if(Array.isArray(c))o.callbacks=c.concat([a]);else{const _=c.copy();_.addHandler(a,!0),o.callbacks=_}const d=this.stream(e,o);async function h(){try{const _=await d;for await(const b of _){const j=new RunLogPatch({ops:[{op:"add",path:"/streamed_output/-",value:b}]});await a.writer.write(j)}}finally{await a.writer.close()}}const g=h();try{for await(const _ of a)yield _}finally{await g}}streamEvents(e,a,o){let c;if(a.version==="v1")c=this._streamEventsV1(e,a,o);else if(a.version==="v2")c=this._streamEventsV2(e,a,o);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return a.encoding==="text/event-stream"?convertToHttpEventStream(c):IterableReadableStream.fromAsyncGenerator(c)}async*_streamEventsV2(e,a,o){var et;const c=new EventStreamCallbackHandler({...o,autoClose:!1}),d=ensureConfig(a),h=d.runId??v4();d.runId=h;const g=d.callbacks;if(g===void 0)d.callbacks=[c];else if(Array.isArray(g))d.callbacks=g.concat(c);else{const st=g.copy();st.addHandler(c,!0),d.callbacks=st}const _=new AbortController,b=this;async function j(){try{let st;a!=null&&a.signal?"any"in AbortSignal?st=AbortSignal.any([_.signal,a.signal]):(st=a.signal,a.signal.addEventListener("abort",()=>{_.abort()},{once:!0})):st=_.signal;const rt=await b.stream(e,{...d,signal:st}),nt=c.tapOutputIterable(h,rt);for await(const it of nt)if(_.signal.aborted)break}finally{await c.finish()}}const $=j();let _e=!1,tt;try{for await(const st of c){if(!_e){st.data.input=e,_e=!0,tt=st.run_id,yield st;continue}st.run_id===tt&&st.event.endsWith("_end")&&(et=st.data)!=null&&et.input&&delete st.data.input,yield st}}finally{_.abort(),await $}}async*_streamEventsV1(e,a,o){let c,d=!1;const h=ensureConfig(a),g=h.tags??[],_=h.metadata??{},b=h.runName??this.getName(),j=new LogStreamCallbackHandler({...o,autoClose:!1,_schemaFormat:"streaming_events"}),$=new _RootEventFilter({...o}),_e=this._streamLog(e,j,h);for await(const et of _e){if(c?c=c.concat(et):c=RunLog.fromRunLogPatch(et),c.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!d){d=!0;const it={...c.state},at={run_id:it.id,event:`on_${it.type}_start`,name:b,tags:g,metadata:_,data:{input:e}};$.includeEvent(at,it.type)&&(yield at)}const st=et.ops.filter(it=>it.path.startsWith("/logs/")).map(it=>it.path.split("/")[2]),rt=[...new Set(st)];for(const it of rt){let at,dt={};const ot=c.state.logs[it];if(ot.end_time===void 0?ot.streamed_output.length>0?at="stream":at="start":at="end",at==="start")ot.inputs!==void 0&&(dt.input=ot.inputs);else if(at==="end")ot.inputs!==void 0&&(dt.input=ot.inputs),dt.output=ot.final_output;else if(at==="stream"){const ht=ot.streamed_output.length;if(ht!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${ht} instead. Encountered in: "${ot.name}"`);dt={chunk:ot.streamed_output[0]},ot.streamed_output=[]}yield{event:`on_${ot.type}_${at}`,name:ot.name,run_id:ot.id,tags:ot.tags,metadata:ot.metadata,data:dt}}const{state:nt}=c;if(nt.streamed_output.length>0){const it=nt.streamed_output.length;if(it!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${it} instead. Encountered in: "${nt.name}"`);const at={chunk:nt.streamed_output[0]};nt.streamed_output=[];const dt={event:`on_${nt.type}_stream`,run_id:nt.id,tags:g,metadata:_,name:b,data:at};$.includeEvent(dt,nt.type)&&(yield dt)}}const tt=c==null?void 0:c.state;if(tt!==void 0){const et={event:`on_${tt.type}_end`,name:b,run_id:tt.id,tags:g,metadata:_,data:{output:tt.final_output}};$.includeEvent(et,tt.type)&&(yield et)}}static isRunnable(e){return isRunnableInterface(e)}withListeners({onStart:e,onEnd:a,onError:o}){return new RunnableBinding({bound:this,config:{},configFactories:[c=>({callbacks:[new RootListenersTracer({config:c,onStart:e,onEnd:a,onError:o})]})]})}asTool(e){return convertRunnableToTool(this,e)}}class RunnableBinding extends Runnable{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){const a=mergeConfigs(this.config,...e);return mergeConfigs(a,...this.configFactories?await Promise.all(this.configFactories.map(async o=>await o(a))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new this.constructor({bound:this.bound.withRetry(e),kwargs:this.kwargs,config:this.config})}async invoke(e,a){return this.bound.invoke(e,await this._mergeConfig(ensureConfig(a),this.kwargs))}async batch(e,a,o){const c=Array.isArray(a)?await Promise.all(a.map(async d=>this._mergeConfig(ensureConfig(d),this.kwargs))):await this._mergeConfig(ensureConfig(a),this.kwargs);return this.bound.batch(e,c,o)}async*_streamIterator(e,a){yield*this.bound._streamIterator(e,await this._mergeConfig(ensureConfig(a),this.kwargs))}async stream(e,a){return this.bound.stream(e,await this._mergeConfig(ensureConfig(a),this.kwargs))}async*transform(e,a){yield*this.bound.transform(e,await this._mergeConfig(ensureConfig(a),this.kwargs))}streamEvents(e,a,o){const c=this,d=async function*(){yield*c.bound.streamEvents(e,{...await c._mergeConfig(ensureConfig(a),c.kwargs),version:a.version},o)};return IterableReadableStream.fromAsyncGenerator(d())}static isRunnableBinding(e){return e.bound&&Runnable.isRunnable(e.bound)}withListeners({onStart:e,onEnd:a,onError:o}){return new RunnableBinding({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[c=>({callbacks:[new RootListenersTracer({config:c,onStart:e,onEnd:a,onError:o})]})]})}}class RunnableEach extends Runnable{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new RunnableEach({bound:this.bound.bind(e)})}async invoke(e,a){return this._callWithConfig(this._invoke.bind(this),e,a)}async _invoke(e,a,o){return this.bound.batch(e,patchConfig(a,{callbacks:o==null?void 0:o.getChild()}))}withListeners({onStart:e,onEnd:a,onError:o}){return new RunnableEach({bound:this.bound.withListeners({onStart:e,onEnd:a,onError:o})})}}class RunnableRetry extends RunnableBinding{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,a,o){const c=e>1?`retry:attempt:${e}`:void 0;return patchConfig(a,{callbacks:o==null?void 0:o.getChild(c)})}async _invoke(e,a,o){return pRetry$1(c=>super.invoke(e,this._patchConfigForRetry(c,a,o)),{onFailedAttempt:c=>this.onFailedAttempt(c,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,a){return this._callWithConfig(this._invoke.bind(this),e,a)}async _batch(e,a,o,c){const d={};try{await pRetry$1(async h=>{const g=e.map((_e,tt)=>tt).filter(_e=>d[_e.toString()]===void 0||d[_e.toString()]instanceof Error),_=g.map(_e=>e[_e]),b=g.map(_e=>this._patchConfigForRetry(h,a==null?void 0:a[_e],o==null?void 0:o[_e])),j=await super.batch(_,b,{...c,returnExceptions:!0});let $;for(let _e=0;_e<j.length;_e+=1){const tt=j[_e],et=g[_e];tt instanceof Error&&$===void 0&&($=tt,$.input=_[_e]),d[et.toString()]=tt}if($)throw $;return j},{onFailedAttempt:h=>this.onFailedAttempt(h,h.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(h){if((c==null?void 0:c.returnExceptions)!==!0)throw h}return Object.keys(d).sort((h,g)=>parseInt(h,10)-parseInt(g,10)).map(h=>d[parseInt(h,10)])}async batch(e,a,o){return this._batchWithConfig(this._batch.bind(this),e,a,o)}}class RunnableSequence extends Runnable{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"omitSequenceTags",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name,this.omitSequenceTags=e.omitSequenceTags??this.omitSequenceTags}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,a){var _;const o=ensureConfig(a),c=await getCallbackManagerForConfig(o),d=await(c==null?void 0:c.handleChainStart(this.toJSON(),_coerceToDict(e,"input"),o.runId,void 0,void 0,void 0,o==null?void 0:o.runName));delete o.runId;let h=e,g;try{const b=[this.first,...this.middle];for(let j=0;j<b.length;j+=1){const _e=b[j].invoke(h,patchConfig(o,{callbacks:d==null?void 0:d.getChild(this.omitSequenceTags?void 0:`seq:step:${j+1}`)}));h=await raceWithSignal(_e,a==null?void 0:a.signal)}if((_=a==null?void 0:a.signal)!=null&&_.aborted)throw new Error("Aborted");g=await this.last.invoke(h,patchConfig(o,{callbacks:d==null?void 0:d.getChild(this.omitSequenceTags?void 0:`seq:step:${this.steps.length}`)}))}catch(b){throw await(d==null?void 0:d.handleChainError(b)),b}return await(d==null?void 0:d.handleChainEnd(_coerceToDict(g,"output"))),g}async batch(e,a,o){var _;const c=this._getOptionsList(a??{},e.length),d=await Promise.all(c.map(getCallbackManagerForConfig)),h=await Promise.all(d.map(async(b,j)=>{const $=await(b==null?void 0:b.handleChainStart(this.toJSON(),_coerceToDict(e[j],"input"),c[j].runId,void 0,void 0,void 0,c[j].runName));return delete c[j].runId,$}));let g=e;try{for(let b=0;b<this.steps.length;b+=1){const $=this.steps[b].batch(g,h.map((_e,tt)=>{const et=_e==null?void 0:_e.getChild(this.omitSequenceTags?void 0:`seq:step:${b+1}`);return patchConfig(c[tt],{callbacks:et})}),o);g=await raceWithSignal($,(_=c[0])==null?void 0:_.signal)}}catch(b){throw await Promise.all(h.map(j=>j==null?void 0:j.handleChainError(b))),b}return await Promise.all(h.map(b=>b==null?void 0:b.handleChainEnd(_coerceToDict(g,"output")))),g}async*_streamIterator(e,a){var $;const o=await getCallbackManagerForConfig(a),{runId:c,...d}=a??{},h=await(o==null?void 0:o.handleChainStart(this.toJSON(),_coerceToDict(e,"input"),c,void 0,void 0,void 0,d==null?void 0:d.runName)),g=[this.first,...this.middle,this.last];let _=!0,b;async function*j(){yield e}try{let _e=g[0].transform(j(),patchConfig(d,{callbacks:h==null?void 0:h.getChild(this.omitSequenceTags?void 0:"seq:step:1")}));for(let tt=1;tt<g.length;tt+=1)_e=await g[tt].transform(_e,patchConfig(d,{callbacks:h==null?void 0:h.getChild(this.omitSequenceTags?void 0:`seq:step:${tt+1}`)}));for await(const tt of _e)if(($=a==null?void 0:a.signal)==null||$.throwIfAborted(),yield tt,_)if(b===void 0)b=tt;else try{b=concat(b,tt)}catch{b=void 0,_=!1}}catch(_e){throw await(h==null?void 0:h.handleChainError(_e)),_e}await(h==null?void 0:h.handleChainEnd(_coerceToDict(b,"output")))}getGraph(e){const a=new Graph;let o=null;return this.steps.forEach((c,d)=>{const h=c.getGraph(e);d!==0&&h.trimFirstNode(),d!==this.steps.length-1&&h.trimLastNode(),a.extend(h);const g=h.firstNode();if(!g)throw new Error(`Runnable ${c} has no first node`);o&&a.addEdge(o,g),o=h.lastNode()}),a}pipe(e){return RunnableSequence.isRunnableSequence(e)?new RunnableSequence({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}):new RunnableSequence({first:this.first,middle:[...this.middle,this.last],last:_coerceToRunnable(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&Runnable.isRunnable(e)}static from([e,...a],o){let c={};return typeof o=="string"?c.name=o:o!==void 0&&(c=o),new RunnableSequence({...c,first:_coerceToRunnable(e),middle:a.slice(0,-1).map(_coerceToRunnable),last:_coerceToRunnable(a[a.length-1])})}}class RunnableMap extends Runnable{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[a,o]of Object.entries(e.steps))this.steps[a]=_coerceToRunnable(o)}static from(e){return new RunnableMap({steps:e})}async invoke(e,a){const o=ensureConfig(a),c=await getCallbackManagerForConfig(o),d=await(c==null?void 0:c.handleChainStart(this.toJSON(),{input:e},o.runId,void 0,void 0,void 0,o==null?void 0:o.runName));delete o.runId;const h={};try{const g=Object.entries(this.steps).map(async([_,b])=>{h[_]=await b.invoke(e,patchConfig(o,{callbacks:d==null?void 0:d.getChild(`map:key:${_}`)}))});await raceWithSignal(Promise.all(g),a==null?void 0:a.signal)}catch(g){throw await(d==null?void 0:d.handleChainError(g)),g}return await(d==null?void 0:d.handleChainEnd(h)),h}async*_transform(e,a,o){const c={...this.steps},d=atee(e,Object.keys(c).length),h=new Map(Object.entries(c).map(([g,_],b)=>{const j=_.transform(d[b],patchConfig(o,{callbacks:a==null?void 0:a.getChild(`map:key:${g}`)}));return[g,j.next().then($=>({key:g,gen:j,result:$}))]}));for(;h.size;){const g=Promise.race(h.values()),{key:_,result:b,gen:j}=await raceWithSignal(g,o==null?void 0:o.signal);h.delete(_),b.done||(yield{[_]:b.value},h.set(_,j.next().then($=>({key:_,gen:j,result:$}))))}}transform(e,a){return this._transformStreamWithConfig(e,this._transform.bind(this),a)}async stream(e,a){async function*o(){yield e}const c=ensureConfig(a),d=new AsyncGeneratorWithSetup({generator:this.transform(o(),c),config:c});return await d.setup,IterableReadableStream.fromAsyncGenerator(d)}}class RunnableTraceable extends Runnable{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!isTraceableFunction(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,a){const[o]=this._getOptionsList(a??{},1),c=await getCallbackManagerForConfig(o),d=this.func(patchConfig(o,{callbacks:c}),e);return raceWithSignal(d,o==null?void 0:o.signal)}async*_streamIterator(e,a){var d,h;const[o]=this._getOptionsList(a??{},1),c=await this.invoke(e,a);if(isAsyncIterable(c)){for await(const g of c)(d=o==null?void 0:o.signal)==null||d.throwIfAborted(),yield g;return}if(isIterator(c)){for(;;){(h=o==null?void 0:o.signal)==null||h.throwIfAborted();const g=c.next();if(g.done)break;yield g.value}return}yield c}static from(e){return new RunnableTraceable({func:e})}}function assertNonTraceableFunction(s){if(isTraceableFunction(s))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}class RunnableLambda extends Runnable{static lc_name(){return"RunnableLambda"}constructor(e){if(isTraceableFunction(e.func))return RunnableTraceable.from(e.func);super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),assertNonTraceableFunction(e.func),this.func=e.func}static from(e){return new RunnableLambda({func:e})}async _invoke(e,a,o){return new Promise((c,d)=>{const h=patchConfig(a,{callbacks:o==null?void 0:o.getChild(),recursionLimit:((a==null?void 0:a.recursionLimit)??DEFAULT_RECURSION_LIMIT)-1});AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(h),async()=>{var g,_;try{let b=await this.func(e,{...h});if(b&&Runnable.isRunnable(b)){if((a==null?void 0:a.recursionLimit)===0)throw new Error("Recursion limit reached.");b=await b.invoke(e,{...h,recursionLimit:(h.recursionLimit??DEFAULT_RECURSION_LIMIT)-1})}else if(isAsyncIterable(b)){let j;for await(const $ of consumeAsyncIterableInContext(h,b))if((g=a==null?void 0:a.signal)==null||g.throwIfAborted(),j===void 0)j=$;else try{j=concat(j,$)}catch{j=$}b=j}else if(isIterableIterator(b)){let j;for(const $ of consumeIteratorInContext(h,b))if((_=a==null?void 0:a.signal)==null||_.throwIfAborted(),j===void 0)j=$;else try{j=concat(j,$)}catch{j=$}b=j}c(b)}catch(b){d(b)}})})}async invoke(e,a){return this._callWithConfig(this._invoke.bind(this),e,a)}async*_transform(e,a,o){var g,_;let c;for await(const b of e)if(c===void 0)c=b;else try{c=concat(c,b)}catch{c=b}const d=patchConfig(o,{callbacks:a==null?void 0:a.getChild(),recursionLimit:((o==null?void 0:o.recursionLimit)??DEFAULT_RECURSION_LIMIT)-1}),h=await new Promise((b,j)=>{AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(d),async()=>{try{const $=await this.func(c,{...d,config:d});b($)}catch($){j($)}})});if(h&&Runnable.isRunnable(h)){if((o==null?void 0:o.recursionLimit)===0)throw new Error("Recursion limit reached.");const b=await h.stream(c,d);for await(const j of b)yield j}else if(isAsyncIterable(h))for await(const b of consumeAsyncIterableInContext(d,h))(g=o==null?void 0:o.signal)==null||g.throwIfAborted(),yield b;else if(isIterableIterator(h))for(const b of consumeIteratorInContext(d,h))(_=o==null?void 0:o.signal)==null||_.throwIfAborted(),yield b;else yield h}transform(e,a){return this._transformStreamWithConfig(e,this._transform.bind(this),a)}async stream(e,a){async function*o(){yield e}const c=ensureConfig(a),d=new AsyncGeneratorWithSetup({generator:this.transform(o(),c),config:c});return await d.setup,IterableReadableStream.fromAsyncGenerator(d)}}class RunnableWithFallbacks extends Runnable{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,a){const o=ensureConfig(a),c=await getCallbackManagerForConfig(o),{runId:d,...h}=o,g=await(c==null?void 0:c.handleChainStart(this.toJSON(),_coerceToDict(e,"input"),d,void 0,void 0,void 0,h==null?void 0:h.runName)),_=patchConfig(h,{callbacks:g==null?void 0:g.getChild()});return await AsyncLocalStorageProviderSingleton.runWithConfig(_,async()=>{var $;let j;for(const _e of this.runnables()){($=o==null?void 0:o.signal)==null||$.throwIfAborted();try{const tt=await _e.invoke(e,_);return await(g==null?void 0:g.handleChainEnd(_coerceToDict(tt,"output"))),tt}catch(tt){j===void 0&&(j=tt)}}throw j===void 0?new Error("No error stored at end of fallback."):(await(g==null?void 0:g.handleChainError(j)),j)})}async*_streamIterator(e,a){var $;const o=ensureConfig(a),c=await getCallbackManagerForConfig(o),{runId:d,...h}=o,g=await(c==null?void 0:c.handleChainStart(this.toJSON(),_coerceToDict(e,"input"),d,void 0,void 0,void 0,h==null?void 0:h.runName));let _,b;for(const _e of this.runnables()){($=o==null?void 0:o.signal)==null||$.throwIfAborted();const tt=patchConfig(h,{callbacks:g==null?void 0:g.getChild()});try{const et=await _e.stream(e,tt);b=consumeAsyncIterableInContext(tt,et);break}catch(et){_===void 0&&(_=et)}}if(b===void 0){const _e=_??new Error("No error stored at end of fallback.");throw await(g==null?void 0:g.handleChainError(_e)),_e}let j;try{for await(const _e of b){yield _e;try{j=j===void 0?j:concat(j,_e)}catch{j=void 0}}}catch(_e){throw await(g==null?void 0:g.handleChainError(_e)),_e}await(g==null?void 0:g.handleChainEnd(_coerceToDict(j,"output")))}async batch(e,a,o){var _;if(o!=null&&o.returnExceptions)throw new Error("Not implemented.");const c=this._getOptionsList(a??{},e.length),d=await Promise.all(c.map(b=>getCallbackManagerForConfig(b))),h=await Promise.all(d.map(async(b,j)=>{const $=await(b==null?void 0:b.handleChainStart(this.toJSON(),_coerceToDict(e[j],"input"),c[j].runId,void 0,void 0,void 0,c[j].runName));return delete c[j].runId,$}));let g;for(const b of this.runnables()){(_=c[0].signal)==null||_.throwIfAborted();try{const j=await b.batch(e,h.map(($,_e)=>patchConfig(c[_e],{callbacks:$==null?void 0:$.getChild()})),o);return await Promise.all(h.map(($,_e)=>$==null?void 0:$.handleChainEnd(_coerceToDict(j[_e],"output")))),j}catch(j){g===void 0&&(g=j)}}throw g?(await Promise.all(h.map(b=>b==null?void 0:b.handleChainError(g))),g):new Error("No error stored at end of fallbacks.")}}function _coerceToRunnable(s){if(typeof s=="function")return new RunnableLambda({func:s});if(Runnable.isRunnable(s))return s;if(!Array.isArray(s)&&typeof s=="object"){const e={};for(const[a,o]of Object.entries(s))e[a]=_coerceToRunnable(o);return new RunnableMap({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}class RunnableAssign extends Runnable{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof RunnableMap&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,a){const o=await this.mapper.invoke(e,a);return{...e,...o}}async*_transform(e,a,o){const c=this.mapper.getStepsKeys(),[d,h]=atee(e),g=this.mapper.transform(h,patchConfig(o,{callbacks:a==null?void 0:a.getChild()})),_=g.next();for await(const b of d){if(typeof b!="object"||Array.isArray(b))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof b}`);const j=Object.fromEntries(Object.entries(b).filter(([$])=>!c.includes($)));Object.keys(j).length>0&&(yield j)}yield(await _).value;for await(const b of g)yield b}transform(e,a){return this._transformStreamWithConfig(e,this._transform.bind(this),a)}async stream(e,a){async function*o(){yield e}const c=ensureConfig(a),d=new AsyncGeneratorWithSetup({generator:this.transform(o(),c),config:c});return await d.setup,IterableReadableStream.fromAsyncGenerator(d)}}class RunnablePick extends Runnable{static lc_name(){return"RunnablePick"}constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const a=this.keys.map(o=>[o,e[o]]).filter(o=>o[1]!==void 0);return a.length===0?void 0:Object.fromEntries(a)}}async invoke(e,a){return this._callWithConfig(this._pick.bind(this),e,a)}async*_transform(e){for await(const a of e){const o=await this._pick(a);o!==void 0&&(yield o)}}transform(e,a){return this._transformStreamWithConfig(e,this._transform.bind(this),a)}async stream(e,a){async function*o(){yield e}const c=ensureConfig(a),d=new AsyncGeneratorWithSetup({generator:this.transform(o(),c),config:c});return await d.setup,IterableReadableStream.fromAsyncGenerator(d)}}class RunnableToolLike extends RunnableBinding{constructor(e){const a=RunnableSequence.from([RunnableLambda.from(async o=>{let c;if(_isToolCall(o))try{c=await this.schema.parseAsync(o.args)}catch{throw new ToolInputParsingException("Received tool input did not match expected schema",JSON.stringify(o.args))}else c=o;return c}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:a,config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}}function convertRunnableToTool(s,e){var c;const a=e.name??s.getName(),o=e.description??((c=e.schema)==null?void 0:c.description);return e.schema.constructor===z.ZodString?new RunnableToolLike({name:a,description:o,schema:z.object({input:z.string()}).transform(d=>d.input),bound:s}):new RunnableToolLike({name:a,description:o,schema:e.schema,bound:s})}/*
 * [js-sha1]{@link https://github.com/emn178/js-sha1}
 *
 * @version 0.6.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */var root=typeof window=="object"?window:{},HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],blocks=[];function Sha1(s){s?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Sha1.prototype.update=function(s){if(!this.finalized){var e=typeof s!="string";e&&s.constructor===root.ArrayBuffer&&(s=new Uint8Array(s));for(var a,o=0,c,d=s.length||0,h=this.blocks;o<d;){if(this.hashed&&(this.hashed=!1,h[0]=this.block,h[16]=h[1]=h[2]=h[3]=h[4]=h[5]=h[6]=h[7]=h[8]=h[9]=h[10]=h[11]=h[12]=h[13]=h[14]=h[15]=0),e)for(c=this.start;o<d&&c<64;++o)h[c>>2]|=s[o]<<SHIFT[c++&3];else for(c=this.start;o<d&&c<64;++o)a=s.charCodeAt(o),a<128?h[c>>2]|=a<<SHIFT[c++&3]:a<2048?(h[c>>2]|=(192|a>>6)<<SHIFT[c++&3],h[c>>2]|=(128|a&63)<<SHIFT[c++&3]):a<55296||a>=57344?(h[c>>2]|=(224|a>>12)<<SHIFT[c++&3],h[c>>2]|=(128|a>>6&63)<<SHIFT[c++&3],h[c>>2]|=(128|a&63)<<SHIFT[c++&3]):(a=65536+((a&1023)<<10|s.charCodeAt(++o)&1023),h[c>>2]|=(240|a>>18)<<SHIFT[c++&3],h[c>>2]|=(128|a>>12&63)<<SHIFT[c++&3],h[c>>2]|=(128|a>>6&63)<<SHIFT[c++&3],h[c>>2]|=(128|a&63)<<SHIFT[c++&3]);this.lastByteIndex=c,this.bytes+=c-this.start,c>=64?(this.block=h[16],this.start=c-64,this.hash(),this.hashed=!0):this.start=c}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};Sha1.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var s=this.blocks,e=this.lastByteIndex;s[16]=this.block,s[e>>2]|=EXTRA[e&3],this.block=s[16],e>=56&&(this.hashed||this.hash(),s[0]=this.block,s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),s[14]=this.hBytes<<3|this.bytes>>>29,s[15]=this.bytes<<3,this.hash()}};Sha1.prototype.hash=function(){var s=this.h0,e=this.h1,a=this.h2,o=this.h3,c=this.h4,d,h,g,_=this.blocks;for(h=16;h<80;++h)g=_[h-3]^_[h-8]^_[h-14]^_[h-16],_[h]=g<<1|g>>>31;for(h=0;h<20;h+=5)d=e&a|~e&o,g=s<<5|s>>>27,c=g+d+c+1518500249+_[h]<<0,e=e<<30|e>>>2,d=s&e|~s&a,g=c<<5|c>>>27,o=g+d+o+1518500249+_[h+1]<<0,s=s<<30|s>>>2,d=c&s|~c&e,g=o<<5|o>>>27,a=g+d+a+1518500249+_[h+2]<<0,c=c<<30|c>>>2,d=o&c|~o&s,g=a<<5|a>>>27,e=g+d+e+1518500249+_[h+3]<<0,o=o<<30|o>>>2,d=a&o|~a&c,g=e<<5|e>>>27,s=g+d+s+1518500249+_[h+4]<<0,a=a<<30|a>>>2;for(;h<40;h+=5)d=e^a^o,g=s<<5|s>>>27,c=g+d+c+1859775393+_[h]<<0,e=e<<30|e>>>2,d=s^e^a,g=c<<5|c>>>27,o=g+d+o+1859775393+_[h+1]<<0,s=s<<30|s>>>2,d=c^s^e,g=o<<5|o>>>27,a=g+d+a+1859775393+_[h+2]<<0,c=c<<30|c>>>2,d=o^c^s,g=a<<5|a>>>27,e=g+d+e+1859775393+_[h+3]<<0,o=o<<30|o>>>2,d=a^o^c,g=e<<5|e>>>27,s=g+d+s+1859775393+_[h+4]<<0,a=a<<30|a>>>2;for(;h<60;h+=5)d=e&a|e&o|a&o,g=s<<5|s>>>27,c=g+d+c-1894007588+_[h]<<0,e=e<<30|e>>>2,d=s&e|s&a|e&a,g=c<<5|c>>>27,o=g+d+o-1894007588+_[h+1]<<0,s=s<<30|s>>>2,d=c&s|c&e|s&e,g=o<<5|o>>>27,a=g+d+a-1894007588+_[h+2]<<0,c=c<<30|c>>>2,d=o&c|o&s|c&s,g=a<<5|a>>>27,e=g+d+e-1894007588+_[h+3]<<0,o=o<<30|o>>>2,d=a&o|a&c|o&c,g=e<<5|e>>>27,s=g+d+s-1894007588+_[h+4]<<0,a=a<<30|a>>>2;for(;h<80;h+=5)d=e^a^o,g=s<<5|s>>>27,c=g+d+c-899497514+_[h]<<0,e=e<<30|e>>>2,d=s^e^a,g=c<<5|c>>>27,o=g+d+o-899497514+_[h+1]<<0,s=s<<30|s>>>2,d=c^s^e,g=o<<5|o>>>27,a=g+d+a-899497514+_[h+2]<<0,c=c<<30|c>>>2,d=o^c^s,g=a<<5|a>>>27,e=g+d+e-899497514+_[h+3]<<0,o=o<<30|o>>>2,d=a^o^c,g=e<<5|e>>>27,s=g+d+s-899497514+_[h+4]<<0,a=a<<30|a>>>2;this.h0=this.h0+s<<0,this.h1=this.h1+e<<0,this.h2=this.h2+a<<0,this.h3=this.h3+o<<0,this.h4=this.h4+c<<0};Sha1.prototype.hex=function(){this.finalize();var s=this.h0,e=this.h1,a=this.h2,o=this.h3,c=this.h4;return HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[s&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[e&15]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[a&15]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[o&15]+HEX_CHARS[c>>28&15]+HEX_CHARS[c>>24&15]+HEX_CHARS[c>>20&15]+HEX_CHARS[c>>16&15]+HEX_CHARS[c>>12&15]+HEX_CHARS[c>>8&15]+HEX_CHARS[c>>4&15]+HEX_CHARS[c&15]};Sha1.prototype.toString=Sha1.prototype.hex;Sha1.prototype.digest=function(){this.finalize();var s=this.h0,e=this.h1,a=this.h2,o=this.h3,c=this.h4;return[s>>24&255,s>>16&255,s>>8&255,s&255,e>>24&255,e>>16&255,e>>8&255,e&255,a>>24&255,a>>16&255,a>>8&255,a&255,o>>24&255,o>>16&255,o>>8&255,o&255,c>>24&255,c>>16&255,c>>8&255,c&255]};Sha1.prototype.array=Sha1.prototype.digest;Sha1.prototype.arrayBuffer=function(){this.finalize();var s=new ArrayBuffer(20),e=new DataView(s);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),s};const insecureHash=s=>new Sha1(!0).update(s).hex(),getCacheKey=(...s)=>insecureHash(s.join("_"));class BaseCache{}const GLOBAL_MAP=new Map;class InMemoryCache extends BaseCache{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,a){return Promise.resolve(this.cache.get(getCacheKey(e,a))??null)}async update(e,a,o){this.cache.set(getCacheKey(e,a),o)}static global(){return new InMemoryCache(GLOBAL_MAP)}}class BasePromptValue extends Serializable{}class StringPromptValue extends BasePromptValue{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new HumanMessage(this.value)]}}class ChatPromptValue extends BasePromptValue{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return getBufferString(this.messages)}toChatMessages(){return this.messages}}var base64Js={};base64Js.byteLength=byteLength;base64Js.toByteArray=toByteArray;base64Js.fromByteArray=fromByteArray;var lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;revLookup[45]=62;revLookup[95]=63;function getLens(s){var e=s.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var a=s.indexOf("=");a===-1&&(a=e);var o=a===e?0:4-a%4;return[a,o]}function byteLength(s){var e=getLens(s),a=e[0],o=e[1];return(a+o)*3/4-o}function _byteLength(s,e,a){return(e+a)*3/4-a}function toByteArray(s){var e,a=getLens(s),o=a[0],c=a[1],d=new Arr(_byteLength(s,o,c)),h=0,g=c>0?o-4:o,_;for(_=0;_<g;_+=4)e=revLookup[s.charCodeAt(_)]<<18|revLookup[s.charCodeAt(_+1)]<<12|revLookup[s.charCodeAt(_+2)]<<6|revLookup[s.charCodeAt(_+3)],d[h++]=e>>16&255,d[h++]=e>>8&255,d[h++]=e&255;return c===2&&(e=revLookup[s.charCodeAt(_)]<<2|revLookup[s.charCodeAt(_+1)]>>4,d[h++]=e&255),c===1&&(e=revLookup[s.charCodeAt(_)]<<10|revLookup[s.charCodeAt(_+1)]<<4|revLookup[s.charCodeAt(_+2)]>>2,d[h++]=e>>8&255,d[h++]=e&255),d}function tripletToBase64(s){return lookup[s>>18&63]+lookup[s>>12&63]+lookup[s>>6&63]+lookup[s&63]}function encodeChunk(s,e,a){for(var o,c=[],d=e;d<a;d+=3)o=(s[d]<<16&16711680)+(s[d+1]<<8&65280)+(s[d+2]&255),c.push(tripletToBase64(o));return c.join("")}function fromByteArray(s){for(var e,a=s.length,o=a%3,c=[],d=16383,h=0,g=a-o;h<g;h+=d)c.push(encodeChunk(s,h,h+d>g?g:h+d));return o===1?(e=s[a-1],c.push(lookup[e>>2]+lookup[e<<4&63]+"==")):o===2&&(e=(s[a-2]<<8)+s[a-1],c.push(lookup[e>>10]+lookup[e>>4&63]+lookup[e<<2&63]+"=")),c.join("")}var __defProp=Object.defineProperty,__defNormalProp=(s,e,a)=>e in s?__defProp(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a,__publicField=(s,e,a)=>(__defNormalProp(s,e+"",a),a);function bytePairMerge(s,e){let a=Array.from({length:s.length},(o,c)=>({start:c,end:c+1}));for(;a.length>1;){let o=null;for(let c=0;c<a.length-1;c++){const d=s.slice(a[c].start,a[c+1].end),h=e.get(d.join(","));h!=null&&(o==null||h<o[0])&&(o=[h,c])}if(o!=null){const c=o[1];a[c]={start:a[c].start,end:a[c+1].end},a.splice(c+1,1)}else break}return a}function bytePairEncode(s,e){return s.length===1?[e.get(s.join(","))]:bytePairMerge(s,e).map(a=>e.get(s.slice(a.start,a.end).join(","))).filter(a=>a!=null)}function escapeRegex(s){return s.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var _Tiktoken=class{constructor(s,e){Sn(this,"specialTokens");Sn(this,"inverseSpecialTokens");Sn(this,"patStr");Sn(this,"textEncoder",new TextEncoder);Sn(this,"textDecoder",new TextDecoder("utf-8"));Sn(this,"rankMap",new Map);Sn(this,"textMap",new Map);this.patStr=s.pat_str;const a=s.bpe_ranks.split(`
`).filter(Boolean).reduce((o,c)=>{const[d,h,...g]=c.split(" "),_=Number.parseInt(h,10);return g.forEach((b,j)=>o[b]=_+j),o},{});for(const[o,c]of Object.entries(a)){const d=base64Js.toByteArray(o);this.rankMap.set(d.join(","),c),this.textMap.set(c,d)}this.specialTokens={...s.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((o,[c,d])=>(o[d]=this.textEncoder.encode(c),o),{})}encode(s,e=[],a="all"){const o=new RegExp(this.patStr,"ug"),c=_Tiktoken.specialTokenRegex(Object.keys(this.specialTokens)),d=[],h=new Set(e==="all"?Object.keys(this.specialTokens):e),g=new Set(a==="all"?Object.keys(this.specialTokens).filter(b=>!h.has(b)):a);if(g.size>0){const b=_Tiktoken.specialTokenRegex([...g]),j=s.match(b);if(j!=null)throw new Error(`The text contains a special token that is not allowed: ${j[0]}`)}let _=0;for(;;){let b=null,j=_;for(;c.lastIndex=j,b=c.exec(s),!(b==null||h.has(b[0]));)j=b.index+1;const $=(b==null?void 0:b.index)??s.length;for(const tt of s.substring(_,$).matchAll(o)){const et=this.textEncoder.encode(tt[0]),st=this.rankMap.get(et.join(","));if(st!=null){d.push(st);continue}d.push(...bytePairEncode(et,this.rankMap))}if(b==null)break;let _e=this.specialTokens[b[0]];d.push(_e),_=b.index+b[0].length}return d}decode(s){const e=[];let a=0;for(let d=0;d<s.length;++d){const h=s[d],g=this.textMap.get(h)??this.inverseSpecialTokens[h];g!=null&&(e.push(g),a+=g.length)}const o=new Uint8Array(a);let c=0;for(const d of e)o.set(d,c),c+=d.length;return this.textDecoder.decode(o)}},Tiktoken=_Tiktoken;__publicField(Tiktoken,"specialTokenRegex",s=>new RegExp(s.map(e=>escapeRegex(e)).join("|"),"g"));function getEncodingNameForModel(s){switch(s){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-2024-11-20":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"o1":case"o1-2024-12-17":case"o1-mini":case"o1-preview":case"o1-preview-2024-09-12":case"o1-mini-2024-09-12":case"o3-mini":case"o3-mini-2025-01-31":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":return"o200k_base";default:throw new Error("Unknown model")}}const cache={},caller=new AsyncCaller({});async function getEncoding(s){return s in cache||(cache[s]=caller.fetch(`https://tiktoken.pages.dev/js/${s}.json`).then(e=>e.json()).then(e=>new Tiktoken(e)).catch(e=>{throw delete cache[s],e})),await cache[s]}async function encodingForModel(s){return getEncoding(getEncodingNameForModel(s))}const getModelNameForTiktoken=s=>s.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":s.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":s.startsWith("gpt-4-32k")?"gpt-4-32k":s.startsWith("gpt-4-")?"gpt-4":s.startsWith("gpt-4o")?"gpt-4o":s,getVerbosity=()=>!1;class BaseLangChain extends Runnable{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??getVerbosity(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class BaseLanguageModel extends BaseLangChain{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:a,...o}){const{cache:c,...d}=o;super({callbacks:e??a,...d}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof c=="object"?this.cache=c:c?this.cache=InMemoryCache.global():this.cache=void 0,this.caller=new AsyncCaller(o??{})}async getNumTokens(e){if(typeof e!="string")return 0;let a=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await encodingForModel("modelName"in this?getModelNameForTiktoken(this.modelName):"gpt2")}catch(o){console.warn("Failed to calculate number of tokens, falling back to approximate count",o)}if(this._encoding)try{a=this._encoding.encode(e).length}catch(o){console.warn("Failed to calculate number of tokens, falling back to approximate count",o)}return a}static _convertInputToPromptValue(e){return typeof e=="string"?new StringPromptValue(e):Array.isArray(e)?new ChatPromptValue(e.map(coerceMessageLikeToMessage)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...a}){const o={...this._identifyingParams(),...a,_type:this._llmType(),_model:this._modelType()};return Object.entries(o).filter(([h,g])=>g!==void 0).map(([h,g])=>`${h}:${JSON.stringify(g)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}}class RunnablePassthrough extends Runnable{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}async invoke(e,a){const o=ensureConfig(a);return this.func&&await this.func(e,o),this._callWithConfig(c=>Promise.resolve(c),e,o)}async*transform(e,a){const o=ensureConfig(a);let c,d=!0;for await(const h of this._transformStreamWithConfig(e,g=>g,o))if(yield h,d)if(c===void 0)c=h;else try{c=concat(c,h)}catch{c=void 0,d=!1}this.func&&c!==void 0&&await this.func(c,o)}static assign(e){return new RunnableAssign(new RunnableMap({steps:e}))}}function isZodSchema(s){return typeof(s==null?void 0:s.parse)=="function"}class BaseChatModel extends BaseLanguageModel{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]}),Object.defineProperty(this,"disableStreaming",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_separateRunnableConfigFromCallOptionsCompat(e){const[a,o]=super._separateRunnableConfigFromCallOptions(e);return o.signal=a.signal,[a,o]}async invoke(e,a){const o=BaseChatModel._convertInputToPromptValue(e);return(await this.generatePrompt([o],a,a==null?void 0:a.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,a,o){throw new Error("Not implemented.")}async*_streamIterator(e,a){var o;if(this._streamResponseChunks===BaseChatModel.prototype._streamResponseChunks||this.disableStreaming)yield this.invoke(e,a);else{const d=BaseChatModel._convertInputToPromptValue(e).toChatMessages(),[h,g]=this._separateRunnableConfigFromCallOptionsCompat(a),_={...h.metadata,...this.getLsParams(g)},b=await CallbackManager.configure(h.callbacks,this.callbacks,h.tags,this.tags,_,this.metadata,{verbose:this.verbose}),j={options:g,invocation_params:this==null?void 0:this.invocationParams(g),batch_size:1},$=await(b==null?void 0:b.handleChatModelStart(this.toJSON(),[d],h.runId,void 0,j,void 0,void 0,h.runName));let _e,tt;try{for await(const et of this._streamResponseChunks(d,g,$==null?void 0:$[0])){if(et.message.id==null){const st=(o=$==null?void 0:$.at(0))==null?void 0:o.runId;st!=null&&et.message._updateId(`run-${st}`)}et.message.response_metadata={...et.generationInfo,...et.message.response_metadata},yield et.message,_e?_e=_e.concat(et):_e=et,isAIMessageChunk(et.message)&&et.message.usage_metadata!==void 0&&(tt={tokenUsage:{promptTokens:et.message.usage_metadata.input_tokens,completionTokens:et.message.usage_metadata.output_tokens,totalTokens:et.message.usage_metadata.total_tokens}})}}catch(et){throw await Promise.all(($??[]).map(st=>st==null?void 0:st.handleLLMError(et))),et}await Promise.all(($??[]).map(et=>et==null?void 0:et.handleLLMEnd({generations:[[_e]],llmOutput:tt})))}}getLsParams(e){const a=this.getName().startsWith("Chat")?this.getName().replace("Chat",""):this.getName();return{ls_model_type:"chat",ls_stop:e.stop,ls_provider:a}}async _generateUncached(e,a,o,c){var $,_e;const d=e.map(tt=>tt.map(coerceMessageLikeToMessage));let h;if(c!==void 0&&c.length===d.length)h=c;else{const tt={...o.metadata,...this.getLsParams(a)},et=await CallbackManager.configure(o.callbacks,this.callbacks,o.tags,this.tags,tt,this.metadata,{verbose:this.verbose}),st={options:a,invocation_params:this==null?void 0:this.invocationParams(a),batch_size:1};h=await(et==null?void 0:et.handleChatModelStart(this.toJSON(),d,o.runId,void 0,st,void 0,void 0,o.runName))}const g=[],_=[];if(!!(h!=null&&h[0].handlers.find(callbackHandlerPrefersStreaming))&&!this.disableStreaming&&d.length===1&&this._streamResponseChunks!==BaseChatModel.prototype._streamResponseChunks)try{const tt=await this._streamResponseChunks(d[0],a,h==null?void 0:h[0]);let et,st;for await(const rt of tt){if(rt.message.id==null){const nt=($=h==null?void 0:h.at(0))==null?void 0:$.runId;nt!=null&&rt.message._updateId(`run-${nt}`)}et===void 0?et=rt:et=concat(et,rt),isAIMessageChunk(rt.message)&&rt.message.usage_metadata!==void 0&&(st={tokenUsage:{promptTokens:rt.message.usage_metadata.input_tokens,completionTokens:rt.message.usage_metadata.output_tokens,totalTokens:rt.message.usage_metadata.total_tokens}})}if(et===void 0)throw new Error("Received empty response from chat model call.");g.push([et]),await(h==null?void 0:h[0].handleLLMEnd({generations:g,llmOutput:st}))}catch(tt){throw await(h==null?void 0:h[0].handleLLMError(tt)),tt}else{const tt=await Promise.allSettled(d.map((et,st)=>this._generate(et,{...a,promptIndex:st},h==null?void 0:h[st])));await Promise.all(tt.map(async(et,st)=>{var rt,nt,it;if(et.status==="fulfilled"){const at=et.value;for(const dt of at.generations){if(dt.message.id==null){const ot=(rt=h==null?void 0:h.at(0))==null?void 0:rt.runId;ot!=null&&dt.message._updateId(`run-${ot}`)}dt.message.response_metadata={...dt.generationInfo,...dt.message.response_metadata}}return at.generations.length===1&&(at.generations[0].message.response_metadata={...at.llmOutput,...at.generations[0].message.response_metadata}),g[st]=at.generations,_[st]=at.llmOutput,(nt=h==null?void 0:h[st])==null?void 0:nt.handleLLMEnd({generations:[at.generations],llmOutput:at.llmOutput})}else return await((it=h==null?void 0:h[st])==null?void 0:it.handleLLMError(et.reason)),Promise.reject(et.reason)}))}const j={generations:g,llmOutput:_.length?(_e=this._combineLLMOutput)==null?void 0:_e.call(this,..._):void 0};return Object.defineProperty(j,RUN_KEY,{value:h?{runIds:h==null?void 0:h.map(tt=>tt.runId)}:void 0,configurable:!0}),j}async _generateCached({messages:e,cache:a,llmStringKey:o,parsedOptions:c,handledOptions:d}){const h=e.map(rt=>rt.map(coerceMessageLikeToMessage)),g={...d.metadata,...this.getLsParams(c)},_=await CallbackManager.configure(d.callbacks,this.callbacks,d.tags,this.tags,g,this.metadata,{verbose:this.verbose}),b={options:c,invocation_params:this==null?void 0:this.invocationParams(c),batch_size:1},j=await(_==null?void 0:_.handleChatModelStart(this.toJSON(),h,d.runId,void 0,b,void 0,void 0,d.runName)),$=[],tt=(await Promise.allSettled(h.map(async(rt,nt)=>{const it=BaseChatModel._convertInputToPromptValue(rt).toString(),at=await a.lookup(it,o);return at==null&&$.push(nt),at}))).map((rt,nt)=>({result:rt,runManager:j==null?void 0:j[nt]})).filter(({result:rt})=>rt.status==="fulfilled"&&rt.value!=null||rt.status==="rejected"),et=[];await Promise.all(tt.map(async({result:rt,runManager:nt},it)=>{if(rt.status==="fulfilled"){const at=rt.value;return et[it]=at.map(dt=>("message"in dt&&isBaseMessage(dt.message)&&isAIMessage(dt.message)&&(dt.message.usage_metadata={input_tokens:0,output_tokens:0,total_tokens:0}),dt.generationInfo={...dt.generationInfo,tokenUsage:{}},dt)),at.length&&await(nt==null?void 0:nt.handleLLMNewToken(at[0].text)),nt==null?void 0:nt.handleLLMEnd({generations:[at]},void 0,void 0,void 0,{cached:!0})}else return await(nt==null?void 0:nt.handleLLMError(rt.reason,void 0,void 0,void 0,{cached:!0})),Promise.reject(rt.reason)}));const st={generations:et,missingPromptIndices:$,startedRunManagers:j};return Object.defineProperty(st,RUN_KEY,{value:j?{runIds:j==null?void 0:j.map(rt=>rt.runId)}:void 0,configurable:!0}),st}async generate(e,a,o){let c;Array.isArray(a)?c={stop:a}:c=a;const d=e.map(et=>et.map(coerceMessageLikeToMessage)),[h,g]=this._separateRunnableConfigFromCallOptionsCompat(c);if(h.callbacks=h.callbacks??o,!this.cache)return this._generateUncached(d,g,h);const{cache:_}=this,b=this._getSerializedCacheKeyParametersForCall(g),{generations:j,missingPromptIndices:$,startedRunManagers:_e}=await this._generateCached({messages:d,cache:_,llmStringKey:b,parsedOptions:g,handledOptions:h});let tt={};if($.length>0){const et=await this._generateUncached($.map(st=>d[st]),g,h,_e!==void 0?$.map(st=>_e==null?void 0:_e[st]):void 0);await Promise.all(et.generations.map(async(st,rt)=>{const nt=$[rt];j[nt]=st;const it=BaseChatModel._convertInputToPromptValue(d[nt]).toString();return _.update(it,b,st)})),tt=et.llmOutput??{}}return{generations:j,llmOutput:tt}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,a,o){const c=e.map(d=>d.toChatMessages());return this.generate(c,a,o)}async call(e,a,o){return(await this.generate([e.map(coerceMessageLikeToMessage)],a,o)).generations[0][0].message}async callPrompt(e,a,o){const c=e.toChatMessages();return this.call(c,a,o)}async predictMessages(e,a,o){return this.call(e,a,o)}async predict(e,a,o){const c=new HumanMessage(e),d=await this.call([c],a,o);if(typeof d.content!="string")throw new Error("Cannot use predict when output is not a string.");return d.content}withStructuredOutput(e,a){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');if(a!=null&&a.strict)throw new Error('"strict" mode is not supported for this model by default.');const o=e,c=a==null?void 0:a.name,d=o.description??"A function available to call.",h=a==null?void 0:a.method,g=a==null?void 0:a.includeRaw;if(h==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let _=c??"extract",b;isZodSchema(o)?b=[{type:"function",function:{name:_,description:d,parameters:zodToJsonSchema(o)}}]:("name"in o&&(_=o.name),b=[{type:"function",function:{name:_,description:d,parameters:o}}]);const j=this.bindTools(b),$=RunnableLambda.from(st=>{if(!st.tool_calls||st.tool_calls.length===0)throw new Error("No tool calls found in the response.");const rt=st.tool_calls.find(nt=>nt.name===_);if(!rt)throw new Error(`No tool call found with name ${_}.`);return rt.args});if(!g)return j.pipe($).withConfig({runName:"StructuredOutput"});const _e=RunnablePassthrough.assign({parsed:(st,rt)=>$.invoke(st.raw,rt)}),tt=RunnablePassthrough.assign({parsed:()=>null}),et=_e.withFallbacks({fallbacks:[tt]});return RunnableSequence.from([{raw:j},et]).withConfig({runName:"StructuredOutputRunnable"})}}const VERSION="0.5.0";let auto=!1,kind,fetch$1,FormData$1,File$1,ReadableStream$1,getMultipartRequestOptions,getDefaultAgent,fileFromPath,isFsReadStream;function setShims(s,e={auto:!1}){if(auto)throw new Error(`you must \`import 'groq-sdk/shims/${s.kind}'\` before importing anything else from groq-sdk`);if(kind)throw new Error(`can't \`import 'groq-sdk/shims/${s.kind}'\` after \`import 'groq-sdk/shims/${kind}'\``);auto=e.auto,kind=s.kind,fetch$1=s.fetch,FormData$1=s.FormData,File$1=s.File,ReadableStream$1=s.ReadableStream,getMultipartRequestOptions=s.getMultipartRequestOptions,getDefaultAgent=s.getDefaultAgent,fileFromPath=s.fileFromPath,isFsReadStream=s.isFsReadStream}class MultipartBody{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function getRuntime({manuallyImported:s}={}){const e=s?"You may need to use polyfills":"Add one of these imports before your first `import  from 'groq-sdk'`:\n- `import 'groq-sdk/shims/node'` (if you're running on Node)\n- `import 'groq-sdk/shims/web'` (otherwise)\n";let a,o,c,d;try{a=fetch,o=Request,c=Response,d=Headers}catch(h){throw new Error(`this environment is missing the following Web Fetch API type: ${h.message}. ${e}`)}return{kind:"web",fetch:a,Request:o,Response:c,Headers:d,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(h,g)=>({...g,body:new MultipartBody(h)}),getDefaultAgent:h=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/groq/groq-typescript#file-uploads")},isFsReadStream:h=>!1}}kind||setShims(getRuntime(),{auto:!0});class GroqError extends Error{}class APIError extends GroqError{constructor(e,a,o,c){super(`${APIError.makeMessage(e,a,o)}`),this.status=e,this.headers=c,this.error=a}static makeMessage(e,a,o){const c=a!=null&&a.message?typeof a.message=="string"?a.message:JSON.stringify(a.message):a?JSON.stringify(a):o;return e&&c?`${e} ${c}`:e?`${e} status code (no body)`:c||"(no status code or body)"}static generate(e,a,o,c){if(!e)return new APIConnectionError({cause:castToError(a)});const d=a;return e===400?new BadRequestError(e,d,o,c):e===401?new AuthenticationError(e,d,o,c):e===403?new PermissionDeniedError(e,d,o,c):e===404?new NotFoundError(e,d,o,c):e===409?new ConflictError(e,d,o,c):e===422?new UnprocessableEntityError(e,d,o,c):e===429?new RateLimitError(e,d,o,c):e>=500?new InternalServerError(e,d,o,c):new APIError(e,d,o,c)}}class APIUserAbortError extends APIError{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class APIConnectionError extends APIError{constructor({message:e,cause:a}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,a&&(this.cause=a)}}class APIConnectionTimeoutError extends APIConnectionError{constructor({message:e}={}){super({message:e??"Request timed out."})}}class BadRequestError extends APIError{constructor(){super(...arguments),this.status=400}}class AuthenticationError extends APIError{constructor(){super(...arguments),this.status=401}}class PermissionDeniedError extends APIError{constructor(){super(...arguments),this.status=403}}class NotFoundError extends APIError{constructor(){super(...arguments),this.status=404}}class ConflictError extends APIError{constructor(){super(...arguments),this.status=409}}class UnprocessableEntityError extends APIError{constructor(){super(...arguments),this.status=422}}class RateLimitError extends APIError{constructor(){super(...arguments),this.status=429}}class InternalServerError extends APIError{}class Stream{constructor(e,a){this.iterator=e,this.controller=a}static fromSSEResponse(e,a){let o=!1;const c=new SSEDecoder;async function*d(){if(!e.body)throw a.abort(),new GroqError("Attempted to iterate over a response with no body");const g=new LineDecoder,_=readableStreamAsyncIterable(e.body);for await(const b of _)for(const j of g.decode(b)){const $=c.decode(j);$&&(yield $)}for(const b of g.flush()){const j=c.decode(b);j&&(yield j)}}async function*h(){if(o)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let g=!1;try{for await(const _ of d())if(!g){if(_.data.startsWith("[DONE]")){g=!0;continue}if(_.event===null){let b;try{b=JSON.parse(_.data)}catch(j){throw console.error("Could not parse message into JSON:",_.data),console.error("From chunk:",_.raw),j}if(b&&b.error)throw new APIError(void 0,b.error,void 0,void 0);yield b}}g=!0}catch(_){if(_ instanceof Error&&_.name==="AbortError")return;throw _}finally{g||a.abort()}}return new Stream(h,a)}static fromReadableStream(e,a){let o=!1;async function*c(){const h=new LineDecoder,g=readableStreamAsyncIterable(e);for await(const _ of g)for(const b of h.decode(_))yield b;for(const _ of h.flush())yield _}async function*d(){if(o)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let h=!1;try{for await(const g of c())h||g&&(yield JSON.parse(g));h=!0}catch(g){if(g instanceof Error&&g.name==="AbortError")return;throw g}finally{h||a.abort()}}return new Stream(d,a)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],a=[],o=this.iterator(),c=d=>({next:()=>{if(d.length===0){const h=o.next();e.push(h),a.push(h)}return d.shift()}});return[new Stream(()=>c(e),this.controller),new Stream(()=>c(a),this.controller)]}toReadableStream(){const e=this;let a;const o=new TextEncoder;return new ReadableStream$1({async start(){a=e[Symbol.asyncIterator]()},async pull(c){try{const{value:d,done:h}=await a.next();if(h)return c.close();const g=o.encode(JSON.stringify(d)+`
`);c.enqueue(g)}catch(d){c.error(d)}},async cancel(){var c;await((c=a.return)==null?void 0:c.call(a))}})}}class SSEDecoder{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const d={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],d}if(this.chunks.push(e),e.startsWith(":"))return null;let[a,o,c]=partition(e,":");return c.startsWith(" ")&&(c=c.substring(1)),a==="event"?this.event=c:a==="data"&&this.data.push(c),null}}class LineDecoder{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let a=this.decodeText(e);if(this.trailingCR&&(a="\r"+a,this.trailingCR=!1),a.endsWith("\r")&&(this.trailingCR=!0,a=a.slice(0,-1)),!a)return[];const o=LineDecoder.NEWLINE_CHARS.has(a[a.length-1]||"");let c=a.split(LineDecoder.NEWLINE_REGEXP);return c.length===1&&!o?(this.buffer.push(c[0]),[]):(this.buffer.length>0&&(c=[this.buffer.join("")+c[0],...c.slice(1)],this.buffer=[]),o||(this.buffer=[c.pop()||""]),c)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new GroqError(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new GroqError(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new GroqError("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}LineDecoder.NEWLINE_CHARS=new Set([`
`,"\r","\v","\f","","","","","\u2028","\u2029"]);LineDecoder.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;function partition(s,e){const a=s.indexOf(e);return a!==-1?[s.substring(0,a),e,s.substring(a+e.length)]:[s,"",""]}function readableStreamAsyncIterable(s){if(s[Symbol.asyncIterator])return s;const e=s.getReader();return{async next(){try{const a=await e.read();return a!=null&&a.done&&e.releaseLock(),a}catch(a){throw e.releaseLock(),a}},async return(){const a=e.cancel();return e.releaseLock(),await a,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const isResponseLike=s=>s!=null&&typeof s=="object"&&typeof s.url=="string"&&typeof s.blob=="function",isFileLike=s=>s!=null&&typeof s=="object"&&typeof s.name=="string"&&typeof s.lastModified=="number"&&isBlobLike(s),isBlobLike=s=>s!=null&&typeof s=="object"&&typeof s.size=="number"&&typeof s.type=="string"&&typeof s.text=="function"&&typeof s.slice=="function"&&typeof s.arrayBuffer=="function",isUploadable=s=>isFileLike(s)||isResponseLike(s)||isFsReadStream(s);async function toFile(s,e,a){var c;if(s=await s,a??(a=isFileLike(s)?{lastModified:s.lastModified,type:s.type}:{}),isResponseLike(s)){const d=await s.blob();return e||(e=new URL(s.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new File$1([d],e,a)}const o=await getBytes(s);if(e||(e=getName(s)??"unknown_file"),!a.type){const d=(c=o[0])==null?void 0:c.type;typeof d=="string"&&(a={...a,type:d})}return new File$1(o,e,a)}async function getBytes(s){var a;let e=[];if(typeof s=="string"||ArrayBuffer.isView(s)||s instanceof ArrayBuffer)e.push(s);else if(isBlobLike(s))e.push(await s.arrayBuffer());else if(isAsyncIterableIterator(s))for await(const o of s)e.push(o);else throw new Error(`Unexpected data type: ${typeof s}; constructor: ${(a=s==null?void 0:s.constructor)==null?void 0:a.name}; props: ${propsForError(s)}`);return e}function propsForError(s){return`[${Object.getOwnPropertyNames(s).map(a=>`"${a}"`).join(", ")}]`}function getName(s){var e;return getStringFromMaybeBuffer(s.name)||getStringFromMaybeBuffer(s.filename)||((e=getStringFromMaybeBuffer(s.path))==null?void 0:e.split(/[\\/]/).pop())}const getStringFromMaybeBuffer=s=>{if(typeof s=="string")return s;if(typeof Buffer<"u"&&s instanceof Buffer)return String(s)},isAsyncIterableIterator=s=>s!=null&&typeof s=="object"&&typeof s[Symbol.asyncIterator]=="function",isMultipartBody=s=>s&&typeof s=="object"&&s.body&&s[Symbol.toStringTag]==="MultipartBody",multipartFormRequestOptions=async s=>{const e=await createForm(s.body);return getMultipartRequestOptions(e,s)},createForm=async s=>{const e=new FormData$1;return await Promise.all(Object.entries(s||{}).map(([a,o])=>addFormValue(e,a,o))),e},addFormValue=async(s,e,a)=>{if(a!==void 0){if(a==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof a=="string"||typeof a=="number"||typeof a=="boolean")s.append(e,String(a));else if(isUploadable(a)){const o=await toFile(a);s.append(e,o)}else if(Array.isArray(a))await Promise.all(a.map(o=>addFormValue(s,e+"[]",o)));else if(typeof a=="object")await Promise.all(Object.entries(a).map(([o,c])=>addFormValue(s,`${e}[${o}]`,c)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${a} instead`)}};var define_process_env_default={};async function defaultParseResponse(s){const{response:e}=s;if(s.options.stream)return debug("response",e.status,e.url,e.headers,e.body),s.options.__streamClass?s.options.__streamClass.fromSSEResponse(e,s.controller):Stream.fromSSEResponse(e,s.controller);if(e.status===204)return null;if(s.options.__binaryResponse)return e;const a=e.headers.get("content-type");if((a==null?void 0:a.includes("application/json"))||(a==null?void 0:a.includes("application/vnd.api+json"))){const d=await e.json();return debug("response",e.status,e.url,e.headers,d),d}const c=await e.text();return debug("response",e.status,e.url,e.headers,c),c}class APIPromise extends Promise{constructor(e,a=defaultParseResponse){super(o=>{o(null)}),this.responsePromise=e,this.parseResponse=a}_thenUnwrap(e){return new APIPromise(this.responsePromise,async a=>e(await this.parseResponse(a)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,a]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:a}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,a){return this.parse().then(e,a)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class APIClient{constructor({baseURL:e,maxRetries:a=2,timeout:o=6e4,httpAgent:c,fetch:d}){this.baseURL=e,this.maxRetries=validatePositiveInteger("maxRetries",a),this.timeout=validatePositiveInteger("timeout",o),this.httpAgent=c,this.fetch=d??fetch$1}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...getPlatformHeaders(),...this.authHeaders(e)}}validateHeaders(e,a){}defaultIdempotencyKey(){return`stainless-node-retry-${uuid4()}`}get(e,a){return this.methodRequest("get",e,a)}post(e,a){return this.methodRequest("post",e,a)}patch(e,a){return this.methodRequest("patch",e,a)}put(e,a){return this.methodRequest("put",e,a)}delete(e,a){return this.methodRequest("delete",e,a)}methodRequest(e,a,o){return this.request(Promise.resolve(o).then(async c=>{const d=c&&isBlobLike(c==null?void 0:c.body)?new DataView(await c.body.arrayBuffer()):(c==null?void 0:c.body)instanceof DataView?c.body:(c==null?void 0:c.body)instanceof ArrayBuffer?new DataView(c.body):c&&ArrayBuffer.isView(c==null?void 0:c.body)?new DataView(c.body.buffer):c==null?void 0:c.body;return{method:e,path:a,...c,body:d}}))}getAPIList(e,a,o){return this.requestAPIList(a,{method:"get",path:e,...o})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e){var et;const{method:a,path:o,query:c,headers:d={}}=e,h=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:isMultipartBody(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,g=this.calculateContentLength(h),_=this.buildURL(o,c);"timeout"in e&&validatePositiveInteger("timeout",e.timeout);const b=e.timeout??this.timeout,j=e.httpAgent??this.httpAgent??getDefaultAgent(_),$=b+1e3;typeof((et=j==null?void 0:j.options)==null?void 0:et.timeout)=="number"&&$>(j.options.timeout??0)&&(j.options.timeout=$),this.idempotencyHeader&&a!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),d[this.idempotencyHeader]=e.idempotencyKey);const _e=this.buildHeaders({options:e,headers:d,contentLength:g});return{req:{method:a,...h&&{body:h},headers:_e,...j&&{agent:j},signal:e.signal??null},url:_,timeout:b}}buildHeaders({options:e,headers:a,contentLength:o}){const c={};o&&(c["content-length"]=o);const d=this.defaultHeaders(e);return applyHeadersMut(c,d),applyHeadersMut(c,a),isMultipartBody(e.body)&&kind!=="node"&&delete c["content-type"],this.validateHeaders(c,a),c}async prepareOptions(e){}async prepareRequest(e,{url:a,options:o}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(a=>[...a])):{...e}:{}}makeStatusError(e,a,o,c){return APIError.generate(e,a,o,c)}request(e,a=null){return new APIPromise(this.makeRequest(e,a))}async makeRequest(e,a){var j,$;const o=await e;a==null&&(a=o.maxRetries??this.maxRetries),await this.prepareOptions(o);const{req:c,url:d,timeout:h}=this.buildRequest(o);if(await this.prepareRequest(c,{url:d,options:o}),debug("request",d,o,c.headers),(j=o.signal)!=null&&j.aborted)throw new APIUserAbortError;const g=new AbortController,_=await this.fetchWithTimeout(d,c,h,g).catch(castToError);if(_ instanceof Error){if(($=o.signal)!=null&&$.aborted)throw new APIUserAbortError;if(a)return this.retryRequest(o,a);throw _.name==="AbortError"?new APIConnectionTimeoutError:new APIConnectionError({cause:_})}const b=createResponseHeaders(_.headers);if(!_.ok){if(a&&this.shouldRetry(_)){const nt=`retrying, ${a} attempts remaining`;return debug(`response (error; ${nt})`,_.status,d,b),this.retryRequest(o,a,b)}const _e=await _.text().catch(nt=>castToError(nt).message),tt=safeJSON(_e),et=tt?void 0:_e;throw debug(`response (error; ${a?"(error; no more retries left)":"(error; not retryable)"})`,_.status,d,b,et),this.makeStatusError(_.status,tt,et,b)}return{response:_,options:o,controller:g}}requestAPIList(e,a){const o=this.makeRequest(a,null);return new PagePromise(this,o,e)}buildURL(e,a){const o=isAbsoluteURL(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),c=this.defaultQuery();return isEmptyObj(c)||(a={...c,...a}),typeof a=="object"&&a&&!Array.isArray(a)&&(o.search=this.stringifyQuery(a)),o.toString()}stringifyQuery(e){return Object.entries(e).filter(([a,o])=>typeof o<"u").map(([a,o])=>{if(typeof o=="string"||typeof o=="number"||typeof o=="boolean")return`${encodeURIComponent(a)}=${encodeURIComponent(o)}`;if(o===null)return`${encodeURIComponent(a)}=`;throw new GroqError(`Cannot stringify type ${typeof o}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,a,o,c){const{signal:d,...h}=a||{};d&&d.addEventListener("abort",()=>c.abort());const g=setTimeout(()=>c.abort(),o);return this.getRequestClient().fetch.call(void 0,e,{signal:c.signal,...h}).finally(()=>{clearTimeout(g)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const a=e.headers.get("x-should-retry");return a==="true"?!0:a==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,a,o){let c;const d=o==null?void 0:o["retry-after-ms"];if(d){const g=parseFloat(d);Number.isNaN(g)||(c=g)}const h=o==null?void 0:o["retry-after"];if(h&&!c){const g=parseFloat(h);Number.isNaN(g)?c=Date.parse(h)-Date.now():c=g*1e3}if(!(c&&0<=c&&c<60*1e3)){const g=e.maxRetries??this.maxRetries;c=this.calculateDefaultRetryTimeoutMillis(a,g)}return await sleep(c),this.makeRequest(e,a-1)}calculateDefaultRetryTimeoutMillis(e,a){const d=a-e,h=Math.min(.5*Math.pow(2,d),8),g=1-Math.random()*.25;return h*g*1e3}getUserAgent(){return`${this.constructor.name}/JS ${VERSION}`}}class PagePromise extends APIPromise{constructor(e,a,o){super(a,async c=>new o(e,c.response,await defaultParseResponse(c),c.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const a of e)yield a}}const createResponseHeaders=s=>new Proxy(Object.fromEntries(s.entries()),{get(e,a){const o=a.toString();return e[o.toLowerCase()]||e[o]}}),getPlatformProperties=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":VERSION,"X-Stainless-OS":normalizePlatform(Deno.build.os),"X-Stainless-Arch":normalizeArch(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":VERSION,"X-Stainless-OS":normalizePlatform(process.platform),"X-Stainless-Arch":normalizeArch(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const s=getBrowserInfo();return s?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${s.browser}`,"X-Stainless-Runtime-Version":s.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function getBrowserInfo(){if(typeof navigator>"u"||!navigator)return null;const s=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:a}of s){const o=a.exec(navigator.userAgent);if(o){const c=o[1]||0,d=o[2]||0,h=o[3]||0;return{browser:e,version:`${c}.${d}.${h}`}}}return null}const normalizeArch=s=>s==="x32"?"x32":s==="x86_64"||s==="x64"?"x64":s==="arm"?"arm":s==="aarch64"||s==="arm64"?"arm64":s?`other:${s}`:"unknown",normalizePlatform=s=>(s=s.toLowerCase(),s.includes("ios")?"iOS":s==="android"?"Android":s==="darwin"?"MacOS":s==="win32"?"Windows":s==="freebsd"?"FreeBSD":s==="openbsd"?"OpenBSD":s==="linux"?"Linux":s?`Other:${s}`:"Unknown");let _platformHeaders;const getPlatformHeaders=()=>_platformHeaders??(_platformHeaders=getPlatformProperties()),safeJSON=s=>{try{return JSON.parse(s)}catch{return}},startsWithSchemeRegexp=new RegExp("^(?:[a-z]+:)?//","i"),isAbsoluteURL=s=>startsWithSchemeRegexp.test(s),sleep=s=>new Promise(e=>setTimeout(e,s)),validatePositiveInteger=(s,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new GroqError(`${s} must be an integer`);if(e<0)throw new GroqError(`${s} must be a positive integer`);return e},castToError=s=>s instanceof Error?s:new Error(s),readEnv=s=>{var e,a,o,c;if(typeof process<"u")return((e=define_process_env_default==null?void 0:define_process_env_default[s])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(c=(o=(a=Deno.env)==null?void 0:a.get)==null?void 0:o.call(a,s))==null?void 0:c.trim()};function isEmptyObj(s){if(!s)return!0;for(const e in s)return!1;return!0}function hasOwn(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function applyHeadersMut(s,e){for(const a in e){if(!hasOwn(e,a))continue;const o=a.toLowerCase();if(!o)continue;const c=e[a];c===null?delete s[o]:c!==void 0&&(s[o]=c)}}function debug(s,...e){typeof process<"u"&&(define_process_env_default==null?void 0:define_process_env_default.DEBUG)==="true"&&console.log(`Groq:DEBUG:${s}`,...e)}const uuid4=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const e=Math.random()*16|0;return(s==="x"?e:e&3|8).toString(16)}),isRunningInBrowser=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";class APIResource{constructor(e){this._client=e}}class Transcriptions extends APIResource{create(e,a){return this._client.post("/openai/v1/audio/transcriptions",multipartFormRequestOptions({body:e,...a}))}}Transcriptions||(Transcriptions={});class Translations extends APIResource{create(e,a){return this._client.post("/openai/v1/audio/translations",multipartFormRequestOptions({body:e,...a}))}}Translations||(Translations={});class Audio extends APIResource{constructor(){super(...arguments),this.transcriptions=new Transcriptions(this._client),this.translations=new Translations(this._client)}}(function(s){s.Transcriptions=Transcriptions,s.Translations=Translations})(Audio||(Audio={}));let Completions$1=class extends APIResource{create(e,a){return this._client.post("/openai/v1/chat/completions",{body:e,...a,stream:e.stream??!1})}};Completions$1||(Completions$1={});class Chat extends APIResource{constructor(){super(...arguments),this.completions=new Completions$1(this._client)}}(function(s){s.Completions=Completions$1})(Chat||(Chat={}));class Completions extends APIResource{}Completions||(Completions={});class Embeddings extends APIResource{create(e,a){return this._client.post("/openai/v1/embeddings",{body:e,...a})}}Embeddings||(Embeddings={});class Models extends APIResource{retrieve(e,a){return this._client.get(`/openai/v1/models/${e}`,a)}list(e){return this._client.get("/openai/v1/models",e)}delete(e,a){return this._client.delete(`/openai/v1/models/${e}`,a)}}Models||(Models={});var _a;class Groq extends APIClient{constructor({baseURL:e=readEnv("GROQ_BASE_URL"),apiKey:a=readEnv("GROQ_API_KEY"),...o}={}){if(a===void 0)throw new GroqError("The GROQ_API_KEY environment variable is missing or empty; either provide it, or instantiate the Groq client with an apiKey option, like new Groq({ apiKey: 'My API Key' }).");const c={apiKey:a,...o,baseURL:e||"https://api.groq.com"};if(!c.dangerouslyAllowBrowser&&isRunningInBrowser())throw new GroqError(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Groq({ apiKey, dangerouslyAllowBrowser: true })`);super({baseURL:c.baseURL,timeout:c.timeout??6e4,httpAgent:c.httpAgent,maxRetries:c.maxRetries,fetch:c.fetch}),this.completions=new Completions(this),this.chat=new Chat(this),this.embeddings=new Embeddings(this),this.audio=new Audio(this),this.models=new Models(this),this._options=c,this.apiKey=a}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}}_a=Groq;Groq.Groq=_a;Groq.GroqError=GroqError;Groq.APIError=APIError;Groq.APIConnectionError=APIConnectionError;Groq.APIConnectionTimeoutError=APIConnectionTimeoutError;Groq.APIUserAbortError=APIUserAbortError;Groq.NotFoundError=NotFoundError;Groq.ConflictError=ConflictError;Groq.RateLimitError=RateLimitError;Groq.BadRequestError=BadRequestError;Groq.AuthenticationError=AuthenticationError;Groq.InternalServerError=InternalServerError;Groq.PermissionDeniedError=PermissionDeniedError;Groq.UnprocessableEntityError=UnprocessableEntityError;Groq.toFile=toFile;Groq.fileFromPath=fileFromPath;(function(s){s.Completions=Completions,s.Chat=Chat,s.Embeddings=Embeddings,s.Audio=Audio,s.Models=Models})(Groq||(Groq={}));class BaseLLMOutputParser extends Runnable{parseResultWithPrompt(e,a,o){return this.parseResult(e,o)}_baseMessageToString(e){return typeof e.content=="string"?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,a){return typeof e=="string"?this._callWithConfig(async(o,c)=>this.parseResult([{text:o}],c==null?void 0:c.callbacks),e,{...a,runType:"parser"}):this._callWithConfig(async(o,c)=>this.parseResult([{message:o,text:this._baseMessageToString(o)}],c==null?void 0:c.callbacks),e,{...a,runType:"parser"})}}class BaseOutputParser extends BaseLLMOutputParser{parseResult(e,a){return this.parse(e[0].text,a)}async parseWithPrompt(e,a,o){return this.parse(e,o)}_type(){throw new Error("_type not implemented")}}class OutputParserException extends Error{constructor(e,a,o,c=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=a,this.observation=o,this.sendToLLM=c,c&&(o===void 0||a===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");addLangChainErrorFields(this,"OUTPUT_PARSING_FAILURE")}}function deepCompareStrict(s,e){const a=typeof s;if(a!==typeof e)return!1;if(Array.isArray(s)){if(!Array.isArray(e))return!1;const o=s.length;if(o!==e.length)return!1;for(let c=0;c<o;c++)if(!deepCompareStrict(s[c],e[c]))return!1;return!0}if(a==="object"){if(!s||!e)return s===e;const o=Object.keys(s),c=Object.keys(e);if(o.length!==c.length)return!1;for(const h of o)if(!deepCompareStrict(s[h],e[h]))return!1;return!0}return s===e}class BaseTransformOutputParser extends BaseOutputParser{async*_transform(e){for await(const a of e)typeof a=="string"?yield this.parseResult([{text:a}]):yield this.parseResult([{message:a,text:this._baseMessageToString(a)}])}async*transform(e,a){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...a,runType:"parser"})}}class BaseCumulativeTransformOutputParser extends BaseTransformOutputParser{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=(e==null?void 0:e.diff)??this.diff}async*_transform(e){let a,o;for await(const c of e){if(typeof c!="string"&&typeof c.content!="string")throw new Error("Cannot handle non-string output.");let d;if(isBaseMessageChunk(c)){if(typeof c.content!="string")throw new Error("Cannot handle non-string message output.");d=new ChatGenerationChunk({message:c,text:c.content})}else if(isBaseMessage(c)){if(typeof c.content!="string")throw new Error("Cannot handle non-string message output.");d=new ChatGenerationChunk({message:convertToChunk(c),text:c.content})}else d=new GenerationChunk({text:c});o===void 0?o=d:o=o.concat(d);const h=await this.parsePartialResult([o]);h!=null&&!deepCompareStrict(h,a)&&(this.diff?yield this._diff(a,h):yield h,a=h)}}getFormatInstructions(){return""}}class StructuredOutputParser extends BaseOutputParser{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){const a=z.object(Object.fromEntries(Object.entries(e).map(([o,c])=>[o,z.string().describe(c)])));return new this(a)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(zodToJsonSchema(this.schema))}
\`\`\`
`}async parse(e){try{const o=(e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(c,d)=>`"${d.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(o))}catch(a){throw new OutputParserException(`Failed to parse. Text: "${e}". Error: ${a}`,e)}}}class JsonOutputParser extends BaseCumulativeTransformOutputParser{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(e,a){if(a)return e?compare(e,a):[{op:"replace",path:"",value:a}]}async parsePartialResult(e){return parseJsonMarkdown(e[0].text)}async parse(e){return parseJsonMarkdown(e,JSON.parse)}getFormatInstructions(){return""}}function parseToolCall(s,e){if(s.function===void 0)return;let a;if(e!=null&&e.partial)try{a=parsePartialJson(s.function.arguments??"{}")}catch{return}else try{a=JSON.parse(s.function.arguments)}catch(c){throw new OutputParserException([`Function "${s.function.name}" arguments:`,"",s.function.arguments,"","are not valid JSON.",`Error: ${c.message}`].join(`
`))}const o={name:s.function.name,args:a,type:"tool_call"};return e!=null&&e.returnId&&(o.id=s.id),o}function convertLangChainToolCallToOpenAI(s){if(s.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:s.id,type:"function",function:{name:s.name,arguments:JSON.stringify(s.args)}}}function makeInvalidToolCall(s,e){var a,o;return{name:(a=s.function)==null?void 0:a.name,args:(o=s.function)==null?void 0:o.arguments,id:s.id,error:e,type:"invalid_tool_call"}}class JsonOutputToolsParser extends BaseCumulativeTransformOutputParser{static lc_name(){return"JsonOutputToolsParser"}constructor(e){super(e),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=(e==null?void 0:e.returnId)??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(e){return await this.parsePartialResult(e,!1)}async parsePartialResult(e,a=!0){var h;const o=e[0].message;let c;if(isAIMessage(o)&&((h=o.tool_calls)!=null&&h.length)?c=o.tool_calls.map(g=>{const{id:_,...b}=g;return this.returnId?{id:_,...b}:b}):o.additional_kwargs.tool_calls!==void 0&&(c=JSON.parse(JSON.stringify(o.additional_kwargs.tool_calls)).map(_=>parseToolCall(_,{returnId:this.returnId,partial:a}))),!c)return[];const d=[];for(const g of c)if(g!==void 0){const _={type:g.name,args:g.args,id:g.id};d.push(_)}return d}}class JsonOutputKeyToolsParser extends JsonOutputToolsParser{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;const a=await this.zodSchema.safeParseAsync(e);if(a.success)return a.data;throw new OutputParserException(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(a.error.errors)}`,JSON.stringify(e,null,2))}async parsePartialResult(e){const o=(await super.parsePartialResult(e)).filter(d=>d.type===this.keyName);let c=o;if(o.length)return this.returnId||(c=o.map(d=>d.args)),this.returnSingle?c[0]:c}async parseResult(e){const o=(await super.parsePartialResult(e,!1)).filter(h=>h.type===this.keyName);let c=o;return o.length?(this.returnId||(c=o.map(h=>h.args)),this.returnSingle?this._validateResult(c[0]):await Promise.all(c.map(h=>this._validateResult(h)))):void 0}}function convertToOpenAIFunction(s,e){return{name:s.name,description:s.description,parameters:zodToJsonSchema(s.schema)}}function convertToOpenAITool(s,e){let a;return isLangChainTool(s)?a={type:"function",function:convertToOpenAIFunction(s)}:a=s,a}function isStructuredTool(s){return s!==void 0&&Array.isArray(s.lc_namespace)}function isRunnableToolLike(s){return s!==void 0&&Runnable.isRunnable(s)&&"lc_name"in s.constructor&&typeof s.constructor.lc_name=="function"&&s.constructor.lc_name()==="RunnableToolLike"}function isStructuredToolParams(s){return!!s&&typeof s=="object"&&"name"in s&&"schema"in s&&isZodSchema(s.schema)}function isLangChainTool(s){return isStructuredToolParams(s)||isRunnableToolLike(s)||isStructuredTool(s)}function messageToGroqRole(s){const e=s._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";default:throw new Error(`Unknown message type: ${e}`)}}function convertMessagesToGroqParams(s){return s.map(e=>{var o;if(typeof e.content!="string")throw new Error("Non string message content not supported");const a={role:messageToGroqRole(e),content:e.content,name:e.name,function_call:e.additional_kwargs.function_call,tool_calls:e.additional_kwargs.tool_calls,tool_call_id:e.tool_call_id};return isAIMessage(e)&&((o=e.tool_calls)!=null&&o.length)?a.tool_calls=e.tool_calls.map(convertLangChainToolCallToOpenAI):(e.additional_kwargs.tool_calls!=null&&(a.tool_calls=e.additional_kwargs.tool_calls),e.tool_call_id!=null&&(a.tool_call_id=e.tool_call_id)),a})}function groqResponseToChatMessage(s,e){const a=s.tool_calls;switch(s.role){case"assistant":{const o=[],c=[];for(const d of a??[])try{o.push(parseToolCall(d,{returnId:!0}))}catch(h){c.push(makeInvalidToolCall(d,h.message))}return new AIMessage({content:s.content||"",additional_kwargs:{tool_calls:a},tool_calls:o,invalid_tool_calls:c,usage_metadata:e})}default:return new ChatMessage(s.content||"",s.role??"unknown")}}function _convertDeltaToolCallToToolCallChunk(s,e){if(s!=null&&s.length)return s.map(a=>{var o,c;return{id:a.id,name:(o=a.function)==null?void 0:o.name,args:(c=a.function)==null?void 0:c.arguments,type:"tool_call_chunk",index:e}})}function _convertDeltaToMessageChunk(s,e,a){const{role:o}=s,c=s.content??"";let d;s.function_call?d={function_call:s.function_call}:s.tool_calls?d={tool_calls:s.tool_calls}:d={};let h,g;if(a!=null&&a.usage&&(h={input_tokens:a.usage.prompt_tokens,output_tokens:a.usage.completion_tokens,total_tokens:a.usage.total_tokens},g=a.id),o==="user")return{message:new HumanMessageChunk({content:c})};if(o==="assistant"){const _=_convertDeltaToolCallToToolCallChunk(s.tool_calls,e);return{message:new AIMessageChunk({content:c,additional_kwargs:d,tool_call_chunks:_?_.map(b=>({type:b.type,args:b.args,index:b.index})):void 0,usage_metadata:h,id:g}),toolCallData:_?_.map(b=>({id:b.id??"",name:b.name??"",index:b.index??e,type:"tool_call_chunk"})):void 0}}else return o==="system"?{message:new SystemMessageChunk({content:c})}:{message:new ChatMessageChunk({content:c,role:o})}}class ChatGroq extends BaseChatModel{static lc_name(){return"ChatGroq"}_llmType(){return"groq"}get lc_secrets(){return{apiKey:"GROQ_API_KEY"}}constructor(e){super(e??{}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models","groq"]}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"mixtral-8x7b-32768"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"mixtral-8x7b-32768"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0});const a=(e==null?void 0:e.apiKey)||getEnvironmentVariable("GROQ_API_KEY");if(!a)throw new Error('Groq API key not found. Please set the GROQ_API_KEY environment variable or provide the key into "apiKey"');const o={"User-Agent":"langchainjs",...(e==null?void 0:e.defaultHeaders)??{}};this.client=new Groq({apiKey:a,dangerouslyAllowBrowser:!0,baseURL:e==null?void 0:e.baseUrl,timeout:e==null?void 0:e.timeout,httpAgent:e==null?void 0:e.httpAgent,fetch:e==null?void 0:e.fetch,maxRetries:0,defaultHeaders:o,defaultQuery:e==null?void 0:e.defaultQuery}),this.apiKey=a,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.modelName=(e==null?void 0:e.model)??(e==null?void 0:e.modelName)??this.model,this.model=this.modelName,this.streaming=(e==null?void 0:e.streaming)??this.streaming,this.stop=(e==null?void 0:e.stopSequences)??(typeof(e==null?void 0:e.stop)=="string"?[e.stop]:e==null?void 0:e.stop)??[],this.stopSequences=this.stop,this.maxTokens=e==null?void 0:e.maxTokens}getLsParams(e){const a=this.invocationParams(e);return{ls_provider:"groq",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:a.temperature??this.temperature,ls_max_tokens:a.max_tokens??this.maxTokens,ls_stop:e.stop}}async completionWithRetry(e,a){return this.caller.call(async()=>this.client.chat.completions.create(e,a))}invocationParams(e){const a=super.invocationParams(e);return e.tool_choice!==void 0&&(a.tool_choice=e.tool_choice),e.tools!==void 0&&(a.tools=e.tools),e.response_format!==void 0&&(a.response_format=e.response_format),{...a,stop:e.stop??this.stopSequences,model:this.model,temperature:this.temperature,max_tokens:this.maxTokens}}bindTools(e,a){return this.bind({tools:e.map(o=>convertToOpenAITool(o)),...a})}async*_streamResponseChunks(e,a,o){var j,$;const c=this.invocationParams(a),d=convertMessagesToGroqParams(e),h=await this.completionWithRetry({...c,messages:d,stream:!0},{signal:a==null?void 0:a.signal,headers:a==null?void 0:a.headers});let g="";const _=[];let b;for await(const _e of h){b=_e;const tt=_e==null?void 0:_e.choices[0];if(!tt)continue;(j=tt.delta)!=null&&j.role&&(g=tt.delta.role);const{message:et,toolCallData:st}=_convertDeltaToMessageChunk({...tt.delta,role:g},tt.index,_e.x_groq);if(st){const nt=st.filter(it=>_.every(at=>at.id!==it.id));_.push(...nt),yield new ChatGenerationChunk({message:new AIMessageChunk({content:"",tool_call_chunks:nt}),text:""})}const rt=new ChatGenerationChunk({message:et,text:tt.delta.content??"",generationInfo:{finishReason:tt.finish_reason}});yield rt,o==null||o.handleLLMNewToken(rt.text??"")}if(b&&("choices"in b&&delete b.choices,yield new ChatGenerationChunk({message:new AIMessageChunk({content:"",response_metadata:b}),text:""})),($=a.signal)!=null&&$.aborted)throw new Error("AbortError")}async _generate(e,a,o){var c;if(this.streaming){const d={},h=this._streamResponseChunks(e,a,o),g={};for await(const b of h){const j=((c=b.generationInfo)==null?void 0:c.completion)??0;g[j]===void 0?g[j]=b:g[j]=g[j].concat(b)}return{generations:Object.entries(g).sort(([b],[j])=>parseInt(b,10)-parseInt(j,10)).map(([b,j])=>j),llmOutput:{estimatedTokenUsage:d}}}else return this._generateNonStreaming(e,a,o)}async _generateNonStreaming(e,a,o){var b;const c={},d=this.invocationParams(a),h=convertMessagesToGroqParams(e),g=await this.completionWithRetry({...d,stream:!1,messages:h},{signal:a==null?void 0:a.signal,headers:a==null?void 0:a.headers});if("usage"in g&&g.usage){const{completion_tokens:j,prompt_tokens:$,total_tokens:_e}=g.usage;j&&(c.completionTokens=(c.completionTokens??0)+j),$&&(c.promptTokens=(c.promptTokens??0)+$),_e&&(c.totalTokens=(c.totalTokens??0)+_e)}const _=[];if("choices"in g&&g.choices)for(const j of g.choices){const $=((b=j.message)==null?void 0:b.content)??"";let _e;c.totalTokens!==void 0&&(_e={input_tokens:c.promptTokens??0,output_tokens:c.completionTokens??0,total_tokens:c.totalTokens});const tt={text:$,message:groqResponseToChatMessage(j.message??{role:"assistant"},_e)};tt.generationInfo={...j.finish_reason?{finish_reason:j.finish_reason}:{},...j.logprobs?{logprobs:j.logprobs}:{}},_.push(tt)}return{generations:_,llmOutput:{tokenUsage:c}}}withStructuredOutput(e,a){const o=e,c=a==null?void 0:a.name,d=a==null?void 0:a.method,h=a==null?void 0:a.includeRaw;let g=c??"extract",_,b;if(d==="jsonMode")b=this.bind({response_format:{type:"json_object"}}),isZodSchema(o)?_=StructuredOutputParser.fromZodSchema(o):_=new JsonOutputParser;else if(isZodSchema(o)){const tt=zodToJsonSchema(o);b=this.bind({tools:[{type:"function",function:{name:g,description:tt.description,parameters:tt}}],tool_choice:{type:"function",function:{name:g}}}),_=new JsonOutputKeyToolsParser({returnSingle:!0,keyName:g,zodSchema:o})}else{let tt;typeof o.name=="string"&&typeof o.parameters=="object"&&o.parameters!=null?(tt=o,g=o.name):(g=o.title??g,tt={name:g,description:o.description??"",parameters:o}),b=this.bind({tools:[{type:"function",function:tt}],tool_choice:{type:"function",function:{name:g}}}),_=new JsonOutputKeyToolsParser({returnSingle:!0,keyName:g})}if(!h)return b.pipe(_).withConfig({runName:"ChatGroqStructuredOutput"});const j=RunnablePassthrough.assign({parsed:(tt,et)=>_.invoke(tt.raw,et)}),$=RunnablePassthrough.assign({parsed:()=>null}),_e=j.withFallbacks({fallbacks:[$]});return RunnableSequence.from([{raw:b},_e]).withConfig({runName:"ChatGroqStructuredOutput"})}}function commonjsRequire(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(e,a){module.exports=e.pdfjsLib=a()})(globalThis,()=>(()=>{var __webpack_modules__=[,(s,e)=>{var Hn;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=bt,e.bytesToString=rn,e.createValidAbsoluteUrl=$t,e.getModificationDate=mn,e.getUuid=In,e.getVerbosityLevel=St,e.info=Ot,e.isArrayBuffer=zt,e.isArrayEqual=gn,e.isNodeJS=void 0,e.normalizeUnicode=An,e.objectFromMap=hn,e.objectSize=cn,e.setVerbosityLevel=jt,e.shadow=xt,e.string32=on,e.stringToBytes=nn,e.stringToPDFString=an,e.stringToUTF8String=fn,e.unreachable=Rt,e.utf8StringToString=un,e.warn=Ct;const a=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=a;const o=[1,0,0,1,0,0];e.IDENTITY_MATRIX=o;const c=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=c;const d=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=d;const h=1.35;e.LINE_FACTOR=h;const g=.35;e.LINE_DESCENT_FACTOR=g;const _=g/h;e.BASELINE_FACTOR=_;const b={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=b;const j={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=j;const $="pdfjs_internal_editor_";e.AnnotationEditorPrefix=$;const _e={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=_e;const tt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=tt;const et={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=et;const st={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=st;const rt={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=rt;const nt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=nt;const it={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=it;const at={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=at;const dt={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=dt;const ot={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=ot;const ht={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=ht;const ut={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=ut;const pt={O:"PageOpen",C:"PageClose"};e.PageActionEventType=pt;const _t={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=_t;const wt={NONE:0,BINARY:1};e.CMapCompressionType=wt;const mt={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=mt;const Et={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=Et;let Pt=_t.WARNINGS;function jt(ln){Number.isInteger(ln)&&(Pt=ln)}function St(){return Pt}function Ot(ln){Pt>=_t.INFOS&&console.log(`Info: ${ln}`)}function Ct(ln){Pt>=_t.WARNINGS&&console.log(`Warning: ${ln}`)}function Rt(ln){throw new Error(ln)}function bt(ln,Xt){ln||Rt(Xt)}function Tt(ln){switch(ln==null?void 0:ln.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function $t(ln,Xt=null,Jt=null){if(!ln)return null;try{if(Jt&&typeof ln=="string"){if(Jt.addDefaultProtocol&&ln.startsWith("www.")){const $n=ln.match(/\./g);($n==null?void 0:$n.length)>=2&&(ln=`http://${ln}`)}if(Jt.tryConvertEncoding)try{ln=fn(ln)}catch{}}const xn=Xt?new URL(ln,Xt):new URL(ln);if(Tt(xn))return xn}catch{}return null}function xt(ln,Xt,Jt,xn=!1){return Object.defineProperty(ln,Xt,{value:Jt,enumerable:!xn,configurable:!0,writable:!1}),Jt}const ft=function(){function Xt(Jt,xn){this.constructor===Xt&&Rt("Cannot initialize BaseException."),this.message=Jt,this.name=xn}return Xt.prototype=new Error,Xt.constructor=Xt,Xt}();e.BaseException=ft;class yt extends ft{constructor(Xt,Jt){super(Xt,"PasswordException"),this.code=Jt}}e.PasswordException=yt;class vt extends ft{constructor(Xt,Jt){super(Xt,"UnknownErrorException"),this.details=Jt}}e.UnknownErrorException=vt;class It extends ft{constructor(Xt){super(Xt,"InvalidPDFException")}}e.InvalidPDFException=It;class Lt extends ft{constructor(Xt){super(Xt,"MissingPDFException")}}e.MissingPDFException=Lt;class Nt extends ft{constructor(Xt,Jt){super(Xt,"UnexpectedResponseException"),this.status=Jt}}e.UnexpectedResponseException=Nt;class Bt extends ft{constructor(Xt){super(Xt,"FormatError")}}e.FormatError=Bt;class Kt extends ft{constructor(Xt){super(Xt,"AbortException")}}e.AbortException=Kt;function rn(ln){(typeof ln!="object"||(ln==null?void 0:ln.length)===void 0)&&Rt("Invalid argument for bytesToString");const Xt=ln.length,Jt=8192;if(Xt<Jt)return String.fromCharCode.apply(null,ln);const xn=[];for(let $n=0;$n<Xt;$n+=Jt){const Dn=Math.min($n+Jt,Xt),Dt=ln.subarray($n,Dn);xn.push(String.fromCharCode.apply(null,Dt))}return xn.join("")}function nn(ln){typeof ln!="string"&&Rt("Invalid argument for stringToBytes");const Xt=ln.length,Jt=new Uint8Array(Xt);for(let xn=0;xn<Xt;++xn)Jt[xn]=ln.charCodeAt(xn)&255;return Jt}function on(ln){return String.fromCharCode(ln>>24&255,ln>>16&255,ln>>8&255,ln&255)}function cn(ln){return Object.keys(ln).length}function hn(ln){const Xt=Object.create(null);for(const[Jt,xn]of ln)Xt[Jt]=xn;return Xt}function Zt(){const ln=new Uint8Array(4);return ln[0]=1,new Uint32Array(ln.buffer,0,1)[0]===1}function Gt(){try{return new Function(""),!0}catch{return!1}}class At{static get isLittleEndian(){return xt(this,"isLittleEndian",Zt())}static get isEvalSupported(){return xt(this,"isEvalSupported",Gt())}static get isOffscreenCanvasSupported(){return xt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?xt(this,"platform",{isWin:!1,isMac:!1}):xt(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var Xt,Jt;return xt(this,"isCSSRoundSupported",(Jt=(Xt=globalThis.CSS)==null?void 0:Xt.supports)==null?void 0:Jt.call(Xt,"width: round(1.5px, 1px)"))}}e.FeatureTest=At;const Ft=[...Array(256).keys()].map(ln=>ln.toString(16).padStart(2,"0"));class Vt{static makeHexColor(Xt,Jt,xn){return`#${Ft[Xt]}${Ft[Jt]}${Ft[xn]}`}static scaleMinMax(Xt,Jt){let xn;Xt[0]?(Xt[0]<0&&(xn=Jt[0],Jt[0]=Jt[1],Jt[1]=xn),Jt[0]*=Xt[0],Jt[1]*=Xt[0],Xt[3]<0&&(xn=Jt[2],Jt[2]=Jt[3],Jt[3]=xn),Jt[2]*=Xt[3],Jt[3]*=Xt[3]):(xn=Jt[0],Jt[0]=Jt[2],Jt[2]=xn,xn=Jt[1],Jt[1]=Jt[3],Jt[3]=xn,Xt[1]<0&&(xn=Jt[2],Jt[2]=Jt[3],Jt[3]=xn),Jt[2]*=Xt[1],Jt[3]*=Xt[1],Xt[2]<0&&(xn=Jt[0],Jt[0]=Jt[1],Jt[1]=xn),Jt[0]*=Xt[2],Jt[1]*=Xt[2]),Jt[0]+=Xt[4],Jt[1]+=Xt[4],Jt[2]+=Xt[5],Jt[3]+=Xt[5]}static transform(Xt,Jt){return[Xt[0]*Jt[0]+Xt[2]*Jt[1],Xt[1]*Jt[0]+Xt[3]*Jt[1],Xt[0]*Jt[2]+Xt[2]*Jt[3],Xt[1]*Jt[2]+Xt[3]*Jt[3],Xt[0]*Jt[4]+Xt[2]*Jt[5]+Xt[4],Xt[1]*Jt[4]+Xt[3]*Jt[5]+Xt[5]]}static applyTransform(Xt,Jt){const xn=Xt[0]*Jt[0]+Xt[1]*Jt[2]+Jt[4],$n=Xt[0]*Jt[1]+Xt[1]*Jt[3]+Jt[5];return[xn,$n]}static applyInverseTransform(Xt,Jt){const xn=Jt[0]*Jt[3]-Jt[1]*Jt[2],$n=(Xt[0]*Jt[3]-Xt[1]*Jt[2]+Jt[2]*Jt[5]-Jt[4]*Jt[3])/xn,Dn=(-Xt[0]*Jt[1]+Xt[1]*Jt[0]+Jt[4]*Jt[1]-Jt[5]*Jt[0])/xn;return[$n,Dn]}static getAxialAlignedBoundingBox(Xt,Jt){const xn=this.applyTransform(Xt,Jt),$n=this.applyTransform(Xt.slice(2,4),Jt),Dn=this.applyTransform([Xt[0],Xt[3]],Jt),Dt=this.applyTransform([Xt[2],Xt[1]],Jt);return[Math.min(xn[0],$n[0],Dn[0],Dt[0]),Math.min(xn[1],$n[1],Dn[1],Dt[1]),Math.max(xn[0],$n[0],Dn[0],Dt[0]),Math.max(xn[1],$n[1],Dn[1],Dt[1])]}static inverseTransform(Xt){const Jt=Xt[0]*Xt[3]-Xt[1]*Xt[2];return[Xt[3]/Jt,-Xt[1]/Jt,-Xt[2]/Jt,Xt[0]/Jt,(Xt[2]*Xt[5]-Xt[4]*Xt[3])/Jt,(Xt[4]*Xt[1]-Xt[5]*Xt[0])/Jt]}static singularValueDecompose2dScale(Xt){const Jt=[Xt[0],Xt[2],Xt[1],Xt[3]],xn=Xt[0]*Jt[0]+Xt[1]*Jt[2],$n=Xt[0]*Jt[1]+Xt[1]*Jt[3],Dn=Xt[2]*Jt[0]+Xt[3]*Jt[2],Dt=Xt[2]*Jt[1]+Xt[3]*Jt[3],sn=(xn+Dt)/2,yn=Math.sqrt((xn+Dt)**2-4*(xn*Dt-Dn*$n))/2,Pn=sn+yn||1,vn=sn-yn||1;return[Math.sqrt(Pn),Math.sqrt(vn)]}static normalizeRect(Xt){const Jt=Xt.slice(0);return Xt[0]>Xt[2]&&(Jt[0]=Xt[2],Jt[2]=Xt[0]),Xt[1]>Xt[3]&&(Jt[1]=Xt[3],Jt[3]=Xt[1]),Jt}static intersect(Xt,Jt){const xn=Math.max(Math.min(Xt[0],Xt[2]),Math.min(Jt[0],Jt[2])),$n=Math.min(Math.max(Xt[0],Xt[2]),Math.max(Jt[0],Jt[2]));if(xn>$n)return null;const Dn=Math.max(Math.min(Xt[1],Xt[3]),Math.min(Jt[1],Jt[3])),Dt=Math.min(Math.max(Xt[1],Xt[3]),Math.max(Jt[1],Jt[3]));return Dn>Dt?null:[xn,Dn,$n,Dt]}static bezierBoundingBox(Xt,Jt,xn,$n,Dn,Dt,sn,yn){const Pn=[],vn=[[],[]];let wn,Mt,kt,Ut,en,tn,dn,pn;for(let Nn=0;Nn<2;++Nn){if(Nn===0?(Mt=6*Xt-12*xn+6*Dn,wn=-3*Xt+9*xn-9*Dn+3*sn,kt=3*xn-3*Xt):(Mt=6*Jt-12*$n+6*Dt,wn=-3*Jt+9*$n-9*Dt+3*yn,kt=3*$n-3*Jt),Math.abs(wn)<1e-12){if(Math.abs(Mt)<1e-12)continue;Ut=-kt/Mt,0<Ut&&Ut<1&&Pn.push(Ut);continue}dn=Mt*Mt-4*kt*wn,pn=Math.sqrt(dn),!(dn<0)&&(en=(-Mt+pn)/(2*wn),0<en&&en<1&&Pn.push(en),tn=(-Mt-pn)/(2*wn),0<tn&&tn<1&&Pn.push(tn))}let Tn=Pn.length,Cn;const bn=Tn;for(;Tn--;)Ut=Pn[Tn],Cn=1-Ut,vn[0][Tn]=Cn*Cn*Cn*Xt+3*Cn*Cn*Ut*xn+3*Cn*Ut*Ut*Dn+Ut*Ut*Ut*sn,vn[1][Tn]=Cn*Cn*Cn*Jt+3*Cn*Cn*Ut*$n+3*Cn*Ut*Ut*Dt+Ut*Ut*Ut*yn;return vn[0][bn]=Xt,vn[1][bn]=Jt,vn[0][bn+1]=sn,vn[1][bn+1]=yn,vn[0].length=vn[1].length=bn+2,[Math.min(...vn[0]),Math.min(...vn[1]),Math.max(...vn[0]),Math.max(...vn[1])]}}e.Util=Vt;const qt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function an(ln){if(ln[0]>=""){let Jt;if(ln[0]===""&&ln[1]===""?Jt="utf-16be":ln[0]===""&&ln[1]===""?Jt="utf-16le":ln[0]===""&&ln[1]===""&&ln[2]===""&&(Jt="utf-8"),Jt)try{const xn=new TextDecoder(Jt,{fatal:!0}),$n=nn(ln);return xn.decode($n)}catch(xn){Ct(`stringToPDFString: "${xn}".`)}}const Xt=[];for(let Jt=0,xn=ln.length;Jt<xn;Jt++){const $n=qt[ln.charCodeAt(Jt)];Xt.push($n?String.fromCharCode($n):ln.charAt(Jt))}return Xt.join("")}function fn(ln){return decodeURIComponent(escape(ln))}function un(ln){return unescape(encodeURIComponent(ln))}function zt(ln){return typeof ln=="object"&&(ln==null?void 0:ln.byteLength)!==void 0}function gn(ln,Xt){if(ln.length!==Xt.length)return!1;for(let Jt=0,xn=ln.length;Jt<xn;Jt++)if(ln[Jt]!==Xt[Jt])return!1;return!0}function mn(ln=new Date){return[ln.getUTCFullYear().toString(),(ln.getUTCMonth()+1).toString().padStart(2,"0"),ln.getUTCDate().toString().padStart(2,"0"),ln.getUTCHours().toString().padStart(2,"0"),ln.getUTCMinutes().toString().padStart(2,"0"),ln.getUTCSeconds().toString().padStart(2,"0")].join("")}class Fn{constructor(){Yt(this,Hn,!1);this.promise=new Promise((Xt,Jt)=>{this.resolve=xn=>{Qt(this,Hn,!0),Xt(xn)},this.reject=xn=>{Qt(this,Hn,!0),Jt(xn)}})}get settled(){return ct(this,Hn)}}Hn=new WeakMap,e.PromiseCapability=Fn;let Ln=null,Bn=null;function An(ln){return Ln||(Ln=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Bn=new Map([["","t"]])),ln.replaceAll(Ln,(Xt,Jt,xn)=>Jt?Jt.normalize("NFKC"):Bn.get(xn))}function In(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const ln=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(ln);else for(let Xt=0;Xt<32;Xt++)ln[Xt]=Math.floor(Math.random()*255);return rn(ln)}const Un="pdfjs_internal_id_";e.AnnotationPrefix=Un},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var s,a,o,c,rr,yr,g,_,b,j,$,_e,tt,et,st,_r,nt,it,Or,dt,ot;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(ut){if(typeof ut=="string"||ut instanceof URL?ut={url:ut}:(0,_util.isArrayBuffer)(ut)&&(ut={data:ut}),typeof ut!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!ut.url&&!ut.data&&!ut.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const pt=new PDFDocumentLoadingTask,{docId:_t}=pt,wt=ut.url?getUrlProp(ut.url):null,mt=ut.data?getDataProp(ut.data):null,Et=ut.httpHeaders||null,Pt=ut.withCredentials===!0,jt=ut.password??null,St=ut.range instanceof PDFDataRangeTransport?ut.range:null,Ot=Number.isInteger(ut.rangeChunkSize)&&ut.rangeChunkSize>0?ut.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let Ct=ut.worker instanceof PDFWorker?ut.worker:null;const Rt=ut.verbosity,bt=typeof ut.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(ut.docBaseUrl)?ut.docBaseUrl:null,Tt=typeof ut.cMapUrl=="string"?ut.cMapUrl:null,$t=ut.cMapPacked!==!1,xt=ut.CMapReaderFactory||DefaultCMapReaderFactory,ft=typeof ut.standardFontDataUrl=="string"?ut.standardFontDataUrl:null,yt=ut.StandardFontDataFactory||DefaultStandardFontDataFactory,vt=ut.stopAtErrors!==!0,It=Number.isInteger(ut.maxImageSize)&&ut.maxImageSize>-1?ut.maxImageSize:-1,Lt=ut.isEvalSupported!==!1,Nt=typeof ut.isOffscreenCanvasSupported=="boolean"?ut.isOffscreenCanvasSupported:!_util.isNodeJS,Bt=Number.isInteger(ut.canvasMaxAreaInBytes)?ut.canvasMaxAreaInBytes:-1,Kt=typeof ut.disableFontFace=="boolean"?ut.disableFontFace:_util.isNodeJS,rn=ut.fontExtraProperties===!0,nn=ut.enableXfa===!0,on=ut.ownerDocument||globalThis.document,cn=ut.disableRange===!0,hn=ut.disableStream===!0,Zt=ut.disableAutoFetch===!0,Gt=ut.pdfBug===!0,At=St?St.length:ut.length??NaN,Ft=typeof ut.useSystemFonts=="boolean"?ut.useSystemFonts:!_util.isNodeJS&&!Kt,Vt=typeof ut.useWorkerFetch=="boolean"?ut.useWorkerFetch:xt===_display_utils.DOMCMapReaderFactory&&yt===_display_utils.DOMStandardFontDataFactory&&Tt&&ft&&(0,_display_utils.isValidFetchUrl)(Tt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(ft,document.baseURI),qt=ut.canvasFactory||new DefaultCanvasFactory({ownerDocument:on}),an=ut.filterFactory||new DefaultFilterFactory({docId:_t,ownerDocument:on}),fn=null;(0,_util.setVerbosityLevel)(Rt);const un={canvasFactory:qt,filterFactory:an};if(Vt||(un.cMapReaderFactory=new xt({baseUrl:Tt,isCompressed:$t}),un.standardFontDataFactory=new yt({baseUrl:ft})),!Ct){const mn={verbosity:Rt,port:_worker_options.GlobalWorkerOptions.workerPort};Ct=mn.port?PDFWorker.fromPort(mn):new PDFWorker(mn),pt._worker=Ct}const zt={docId:_t,apiVersion:"3.11.174",data:mt,password:jt,disableAutoFetch:Zt,rangeChunkSize:Ot,length:At,docBaseUrl:bt,enableXfa:nn,evaluatorOptions:{maxImageSize:It,disableFontFace:Kt,ignoreErrors:vt,isEvalSupported:Lt,isOffscreenCanvasSupported:Nt,canvasMaxAreaInBytes:Bt,fontExtraProperties:rn,useSystemFonts:Ft,cMapUrl:Vt?Tt:null,standardFontDataUrl:Vt?ft:null}},gn={ignoreErrors:vt,isEvalSupported:Lt,disableFontFace:Kt,fontExtraProperties:rn,enableXfa:nn,ownerDocument:on,disableAutoFetch:Zt,pdfBug:Gt,styleElement:fn};return Ct.promise.then(function(){if(pt.destroyed)throw new Error("Loading aborted");const mn=_fetchDocument(Ct,zt),Fn=new Promise(function(Ln){let Bn;St?Bn=new _transport_stream.PDFDataTransportStream({length:At,initialData:St.initialData,progressiveDone:St.progressiveDone,contentDispositionFilename:St.contentDispositionFilename,disableRange:cn,disableStream:hn},St):mt||(Bn=(In=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(In):(0,_display_utils.isValidFetchUrl)(In.url)?new _displayFetch_stream.PDFFetchStream(In):new _displayNetwork.PDFNetworkStream(In))({url:wt,length:At,httpHeaders:Et,withCredentials:Pt,rangeChunkSize:Ot,disableRange:cn,disableStream:hn})),Ln(Bn)});return Promise.all([mn,Fn]).then(function([Ln,Bn]){if(pt.destroyed)throw new Error("Loading aborted");const An=new _message_handler.MessageHandler(_t,Ln,Ct.port),In=new WorkerTransport(An,pt,Bn,gn,un);pt._transport=In,An.send("Ready",null)})}).catch(pt._capability.reject),pt}async function _fetchDocument(ut,pt){if(ut.destroyed)throw new Error("Worker was destroyed");const _t=await ut.messageHandler.sendWithPromise("GetDocRequest",pt,pt.data?[pt.data.buffer]:null);if(ut.destroyed)throw new Error("Worker was destroyed");return _t}function getUrlProp(ut){if(ut instanceof URL)return ut.href;try{return new URL(ut,window.location).href}catch{if(_util.isNodeJS&&typeof ut=="string")return ut}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(ut){if(_util.isNodeJS&&typeof Buffer<"u"&&ut instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(ut instanceof Uint8Array&&ut.byteLength===ut.buffer.byteLength)return ut;if(typeof ut=="string")return(0,_util.stringToBytes)(ut);if(typeof ut=="object"&&!isNaN(ut==null?void 0:ut.length)||(0,_util.isArrayBuffer)(ut))return new Uint8Array(ut);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${cr(e,s)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var pt,_t,wt;this.destroyed=!0;try{(pt=this._worker)!=null&&pt.port&&(this._worker._pendingDestroy=!0),await((_t=this._transport)==null?void 0:_t.destroy())}catch(mt){throw(wt=this._worker)!=null&&wt.port&&delete this._worker._pendingDestroy,mt}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};s=new WeakMap,Yt(e,s,0);let PDFDocumentLoadingTask=e;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(pt,_t,wt=!1,mt=null){this.length=pt,this.initialData=_t,this.progressiveDone=wt,this.contentDispositionFilename=mt,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(pt){this._rangeListeners.push(pt)}addProgressListener(pt){this._progressListeners.push(pt)}addProgressiveReadListener(pt){this._progressiveReadListeners.push(pt)}addProgressiveDoneListener(pt){this._progressiveDoneListeners.push(pt)}onDataRange(pt,_t){for(const wt of this._rangeListeners)wt(pt,_t)}onDataProgress(pt,_t){this._readyCapability.promise.then(()=>{for(const wt of this._progressListeners)wt(pt,_t)})}onDataProgressiveRead(pt){this._readyCapability.promise.then(()=>{for(const _t of this._progressiveReadListeners)_t(pt)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const pt of this._progressiveDoneListeners)pt()})}transportReady(){this._readyCapability.resolve()}requestDataRange(pt,_t){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(pt,_t){this._pdfInfo=pt,this._transport=_t,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(wt=>{if(!wt)return wt;const mt=[];for(const Et in wt)mt.push(...wt[Et]);return mt}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(pt){return this._transport.getPage(pt)}getPageIndex(pt){return this._transport.getPageIndex(pt)}getDestinations(){return this._transport.getDestinations()}getDestination(pt){return this._transport.getDestination(pt)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(pt=!1){return this._transport.startCleanup(pt||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(pt,_t,wt,mt=!1){Yt(this,c);Yt(this,a,null);Yt(this,o,!1);this._pageIndex=pt,this._pageInfo=_t,this._transport=wt,this._stats=mt?new _display_utils.StatTimer:null,this._pdfBug=mt,this.commonObjs=wt.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:pt,rotation:_t=this.rotate,offsetX:wt=0,offsetY:mt=0,dontFlip:Et=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:pt,rotation:_t,offsetX:wt,offsetY:mt,dontFlip:Et})}getAnnotations({intent:pt="display"}={}){const _t=this._transport.getRenderingIntent(pt);return this._transport.getAnnotations(this._pageIndex,_t.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var pt;return((pt=this._transport._htmlForXfa)==null?void 0:pt.children[this._pageIndex])||null}render({canvasContext:pt,viewport:_t,intent:wt="display",annotationMode:mt=_util.AnnotationMode.ENABLE,transform:Et=null,background:Pt=null,optionalContentConfigPromise:jt=null,annotationCanvasMap:St=null,pageColors:Ot=null,printAnnotationStorage:Ct=null}){var yt,vt;(yt=this._stats)==null||yt.time("Overall");const Rt=this._transport.getRenderingIntent(wt,mt,Ct);Qt(this,o,!1),Ht(this,c,yr).call(this),jt||(jt=this._transport.getOptionalContentConfig());let bt=this._intentStates.get(Rt.cacheKey);bt||(bt=Object.create(null),this._intentStates.set(Rt.cacheKey,bt)),bt.streamReaderCancelTimeout&&(clearTimeout(bt.streamReaderCancelTimeout),bt.streamReaderCancelTimeout=null);const Tt=!!(Rt.renderingIntent&_util.RenderingIntentFlag.PRINT);bt.displayReadyCapability||(bt.displayReadyCapability=new _util.PromiseCapability,bt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(vt=this._stats)==null||vt.time("Page Request"),this._pumpOperatorList(Rt));const $t=It=>{var Lt,Nt;bt.renderTasks.delete(xt),(this._maybeCleanupAfterRender||Tt)&&Qt(this,o,!0),Ht(this,c,rr).call(this,!Tt),It?(xt.capability.reject(It),this._abortOperatorList({intentState:bt,reason:It instanceof Error?It:new Error(It)})):xt.capability.resolve(),(Lt=this._stats)==null||Lt.timeEnd("Rendering"),(Nt=this._stats)==null||Nt.timeEnd("Overall")},xt=new InternalRenderTask({callback:$t,params:{canvasContext:pt,viewport:_t,transform:Et,background:Pt},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:St,operatorList:bt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Tt,pdfBug:this._pdfBug,pageColors:Ot});(bt.renderTasks||(bt.renderTasks=new Set)).add(xt);const ft=xt.task;return Promise.all([bt.displayReadyCapability.promise,jt]).then(([It,Lt])=>{var Nt;if(this.destroyed){$t();return}(Nt=this._stats)==null||Nt.time("Rendering"),xt.initializeGraphics({transparency:It,optionalContentConfig:Lt}),xt.operatorListChanged()}).catch($t),ft}getOperatorList({intent:pt="display",annotationMode:_t=_util.AnnotationMode.ENABLE,printAnnotationStorage:wt=null}={}){var St;function mt(){Pt.operatorList.lastChunk&&(Pt.opListReadCapability.resolve(Pt.operatorList),Pt.renderTasks.delete(jt))}const Et=this._transport.getRenderingIntent(pt,_t,wt,!0);let Pt=this._intentStates.get(Et.cacheKey);Pt||(Pt=Object.create(null),this._intentStates.set(Et.cacheKey,Pt));let jt;return Pt.opListReadCapability||(jt=Object.create(null),jt.operatorListChanged=mt,Pt.opListReadCapability=new _util.PromiseCapability,(Pt.renderTasks||(Pt.renderTasks=new Set)).add(jt),Pt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(St=this._stats)==null||St.time("Page Request"),this._pumpOperatorList(Et)),Pt.opListReadCapability.promise}streamTextContent({includeMarkedContent:pt=!1,disableNormalization:_t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:pt===!0,disableNormalization:_t===!0},{highWaterMark:100,size(mt){return mt.items.length}})}getTextContent(pt={}){if(this._transport._htmlForXfa)return this.getXfa().then(wt=>_xfa_text.XfaText.textContent(wt));const _t=this.streamTextContent(pt);return new Promise(function(wt,mt){function Et(){Pt.read().then(function({value:St,done:Ot}){if(Ot){wt(jt);return}Object.assign(jt.styles,St.styles),jt.items.push(...St.items),Et()},mt)}const Pt=_t.getReader(),jt={items:[],styles:Object.create(null)};Et()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const pt=[];for(const _t of this._intentStates.values())if(this._abortOperatorList({intentState:_t,reason:new Error("Page was destroyed."),force:!0}),!_t.opListReadCapability)for(const wt of _t.renderTasks)pt.push(wt.completed),wt.cancel();return this.objs.clear(),Qt(this,o,!1),Ht(this,c,yr).call(this),Promise.all(pt)}cleanup(pt=!1){Qt(this,o,!0);const _t=Ht(this,c,rr).call(this,!1);return pt&&_t&&this._stats&&(this._stats=new _display_utils.StatTimer),_t}_startRenderPage(pt,_t){var mt,Et;const wt=this._intentStates.get(_t);wt&&((mt=this._stats)==null||mt.timeEnd("Page Request"),(Et=wt.displayReadyCapability)==null||Et.resolve(pt))}_renderPageChunk(pt,_t){for(let wt=0,mt=pt.length;wt<mt;wt++)_t.operatorList.fnArray.push(pt.fnArray[wt]),_t.operatorList.argsArray.push(pt.argsArray[wt]);_t.operatorList.lastChunk=pt.lastChunk,_t.operatorList.separateAnnots=pt.separateAnnots;for(const wt of _t.renderTasks)wt.operatorListChanged();pt.lastChunk&&Ht(this,c,rr).call(this,!0)}_pumpOperatorList({renderingIntent:pt,cacheKey:_t,annotationStorageSerializable:wt}){const{map:mt,transfers:Et}=wt,jt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:pt,cacheKey:_t,annotationStorage:mt},Et).getReader(),St=this._intentStates.get(_t);St.streamReader=jt;const Ot=()=>{jt.read().then(({value:Ct,done:Rt})=>{if(Rt){St.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Ct,St),Ot())},Ct=>{if(St.streamReader=null,!this._transport.destroyed){if(St.operatorList){St.operatorList.lastChunk=!0;for(const Rt of St.renderTasks)Rt.operatorListChanged();Ht(this,c,rr).call(this,!0)}if(St.displayReadyCapability)St.displayReadyCapability.reject(Ct);else if(St.opListReadCapability)St.opListReadCapability.reject(Ct);else throw Ct}})};Ot()}_abortOperatorList({intentState:pt,reason:_t,force:wt=!1}){if(pt.streamReader){if(pt.streamReaderCancelTimeout&&(clearTimeout(pt.streamReaderCancelTimeout),pt.streamReaderCancelTimeout=null),!wt){if(pt.renderTasks.size>0)return;if(_t instanceof _display_utils.RenderingCancelledException){let mt=RENDERING_CANCELLED_TIMEOUT;_t.extraDelay>0&&_t.extraDelay<1e3&&(mt+=_t.extraDelay),pt.streamReaderCancelTimeout=setTimeout(()=>{pt.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:pt,reason:_t,force:!0})},mt);return}}if(pt.streamReader.cancel(new _util.AbortException(_t.message)).catch(()=>{}),pt.streamReader=null,!this._transport.destroyed){for(const[mt,Et]of this._intentStates)if(Et===pt){this._intentStates.delete(mt);break}this.cleanup()}}}get stats(){return this._stats}}a=new WeakMap,o=new WeakMap,c=new WeakSet,rr=function(pt=!1){if(Ht(this,c,yr).call(this),!ct(this,o)||this.destroyed)return!1;if(pt)return Qt(this,a,setTimeout(()=>{Qt(this,a,null),Ht(this,c,rr).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:_t,operatorList:wt}of this._intentStates.values())if(_t.size>0||!wt.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Qt(this,o,!1),!0},yr=function(){ct(this,a)&&(clearTimeout(ct(this,a)),Qt(this,a,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){Yt(this,g,new Set);Yt(this,_,Promise.resolve())}postMessage(pt,_t){const wt={data:structuredClone(pt,_t?{transfer:_t}:null)};ct(this,_).then(()=>{for(const mt of ct(this,g))mt.call(this,wt)})}addEventListener(pt,_t){ct(this,g).add(_t)}removeEventListener(pt,_t){ct(this,g).delete(_t)}terminate(){ct(this,g).clear()}}g=new WeakMap,_=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const ut=(b=document==null?void 0:document.currentScript)==null?void 0:b.src;ut&&(PDFWorkerUtil.fallbackWorkerSrc=ut.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(ut,pt){let _t;try{if(_t=new URL(ut),!_t.origin||_t.origin==="null")return!1}catch{return!1}const wt=new URL(pt,_t);return _t.origin===wt.origin},PDFWorkerUtil.createCDNWrapper=function(ut){const pt=`importScripts("${ut}");`;return URL.createObjectURL(new Blob([pt]))}}const _PDFWorker=class _PDFWorker{constructor({name:ut=null,port:pt=null,verbosity:_t=(0,_util.getVerbosityLevel)()}={}){var wt;if(this.name=ut,this.destroyed=!1,this.verbosity=_t,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,pt){if((wt=ct(_PDFWorker,j))!=null&&wt.has(pt))throw new Error("Cannot use more than one PDFWorker per port.");(ct(_PDFWorker,j)||Qt(_PDFWorker,j,new WeakMap)).set(pt,this),this._initializeFromPort(pt);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(ut){this._port=ut,this._messageHandler=new _message_handler.MessageHandler("main","worker",ut),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:ut}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,ut)||(ut=PDFWorkerUtil.createCDNWrapper(new URL(ut,window.location).href));const pt=new Worker(ut),_t=new _message_handler.MessageHandler("main","worker",pt),wt=()=>{pt.removeEventListener("error",mt),_t.destroy(),pt.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},mt=()=>{this._webWorker||wt()};pt.addEventListener("error",mt),_t.on("test",Pt=>{if(pt.removeEventListener("error",mt),this.destroyed){wt();return}Pt?(this._messageHandler=_t,this._port=pt,this._webWorker=pt,this._readyCapability.resolve(),_t.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),_t.destroy(),pt.terminate())}),_t.on("ready",Pt=>{if(pt.removeEventListener("error",mt),this.destroyed){wt();return}try{Et()}catch{this._setupFakeWorker()}});const Et=()=>{const Pt=new Uint8Array;_t.send("test",Pt,[Pt.buffer])};Et();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(ut=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const pt=new LoopbackPort;this._port=pt;const _t=`fake${PDFWorkerUtil.fakeWorkerId++}`,wt=new _message_handler.MessageHandler(_t+"_worker",_t,pt);ut.setup(wt,pt);const mt=new _message_handler.MessageHandler(_t,_t+"_worker",pt);this._messageHandler=mt,this._readyCapability.resolve(),mt.send("configure",{verbosity:this.verbosity})}).catch(ut=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${ut.message}".`))})}destroy(){var ut;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(ut=ct(_PDFWorker,j))==null||ut.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(ut){var _t;if(!(ut!=null&&ut.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const pt=(_t=ct(this,j))==null?void 0:_t.get(ut.port);if(pt){if(pt._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return pt}return new _PDFWorker(ut)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var ut;try{return((ut=globalThis.pdfjsWorker)==null?void 0:ut.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};j=new WeakMap,Yt(_PDFWorker,j);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(pt,_t,wt,mt,Et){Yt(this,st);Yt(this,$,new Map);Yt(this,_e,new Map);Yt(this,tt,new Map);Yt(this,et,null);this.messageHandler=pt,this.loadingTask=_t,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:mt.ownerDocument,styleElement:mt.styleElement}),this._params=mt,this.canvasFactory=Et.canvasFactory,this.filterFactory=Et.filterFactory,this.cMapReaderFactory=Et.cMapReaderFactory,this.standardFontDataFactory=Et.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=wt,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(pt,_t=_util.AnnotationMode.ENABLE,wt=null,mt=!1){let Et=_util.RenderingIntentFlag.DISPLAY,Pt=_annotation_storage.SerializableEmpty;switch(pt){case"any":Et=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":Et=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${pt}`)}switch(_t){case _util.AnnotationMode.DISABLE:Et+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:Et+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:Et+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,Pt=(Et&_util.RenderingIntentFlag.PRINT&&wt instanceof _annotation_storage.PrintAnnotationStorage?wt:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${_t}`)}return mt&&(Et+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:Et,cacheKey:`${Et}_${Pt.hash}`,annotationStorageSerializable:Pt}}destroy(){var wt;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(wt=ct(this,et))==null||wt.reject(new Error("Worker was destroyed during onPassword callback"));const pt=[];for(const mt of ct(this,_e).values())pt.push(mt._destroy());ct(this,_e).clear(),ct(this,tt).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const _t=this.messageHandler.sendWithPromise("Terminate",null);return pt.push(_t),Promise.all(pt).then(()=>{var mt;this.commonObjs.clear(),this.fontLoader.clear(),ct(this,$).clear(),this.filterFactory.destroy(),(mt=this._networkStream)==null||mt.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:pt,loadingTask:_t}=this;pt.on("GetReader",(wt,mt)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=Et=>{this._lastProgress={loaded:Et.loaded,total:Et.total}},mt.onPull=()=>{this._fullReader.read().then(function({value:Et,done:Pt}){if(Pt){mt.close();return}(0,_util.assert)(Et instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),mt.enqueue(new Uint8Array(Et),1,[Et])}).catch(Et=>{mt.error(Et)})},mt.onCancel=Et=>{this._fullReader.cancel(Et),mt.ready.catch(Pt=>{if(!this.destroyed)throw Pt})}}),pt.on("ReaderHeadersReady",wt=>{const mt=new _util.PromiseCapability,Et=this._fullReader;return Et.headersReady.then(()=>{var Pt;(!Et.isStreamingSupported||!Et.isRangeSupported)&&(this._lastProgress&&((Pt=_t.onProgress)==null||Pt.call(_t,this._lastProgress)),Et.onProgress=jt=>{var St;(St=_t.onProgress)==null||St.call(_t,{loaded:jt.loaded,total:jt.total})}),mt.resolve({isStreamingSupported:Et.isStreamingSupported,isRangeSupported:Et.isRangeSupported,contentLength:Et.contentLength})},mt.reject),mt.promise}),pt.on("GetRangeReader",(wt,mt)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const Et=this._networkStream.getRangeReader(wt.begin,wt.end);if(!Et){mt.close();return}mt.onPull=()=>{Et.read().then(function({value:Pt,done:jt}){if(jt){mt.close();return}(0,_util.assert)(Pt instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),mt.enqueue(new Uint8Array(Pt),1,[Pt])}).catch(Pt=>{mt.error(Pt)})},mt.onCancel=Pt=>{Et.cancel(Pt),mt.ready.catch(jt=>{if(!this.destroyed)throw jt})}}),pt.on("GetDoc",({pdfInfo:wt})=>{this._numPages=wt.numPages,this._htmlForXfa=wt.htmlForXfa,delete wt.htmlForXfa,_t._capability.resolve(new PDFDocumentProxy(wt,this))}),pt.on("DocException",function(wt){let mt;switch(wt.name){case"PasswordException":mt=new _util.PasswordException(wt.message,wt.code);break;case"InvalidPDFException":mt=new _util.InvalidPDFException(wt.message);break;case"MissingPDFException":mt=new _util.MissingPDFException(wt.message);break;case"UnexpectedResponseException":mt=new _util.UnexpectedResponseException(wt.message,wt.status);break;case"UnknownErrorException":mt=new _util.UnknownErrorException(wt.message,wt.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}_t._capability.reject(mt)}),pt.on("PasswordRequest",wt=>{if(Qt(this,et,new _util.PromiseCapability),_t.onPassword){const mt=Et=>{Et instanceof Error?ct(this,et).reject(Et):ct(this,et).resolve({password:Et})};try{_t.onPassword(mt,wt.code)}catch(Et){ct(this,et).reject(Et)}}else ct(this,et).reject(new _util.PasswordException(wt.message,wt.code));return ct(this,et).promise}),pt.on("DataLoaded",wt=>{var mt;(mt=_t.onProgress)==null||mt.call(_t,{loaded:wt.length,total:wt.length}),this.downloadInfoCapability.resolve(wt)}),pt.on("StartRenderPage",wt=>{if(this.destroyed)return;ct(this,_e).get(wt.pageIndex)._startRenderPage(wt.transparency,wt.cacheKey)}),pt.on("commonobj",([wt,mt,Et])=>{var Pt;if(!this.destroyed&&!this.commonObjs.has(wt))switch(mt){case"Font":const jt=this._params;if("error"in Et){const Ct=Et.error;(0,_util.warn)(`Error during font loading: ${Ct}`),this.commonObjs.resolve(wt,Ct);break}const St=jt.pdfBug&&((Pt=globalThis.FontInspector)!=null&&Pt.enabled)?(Ct,Rt)=>globalThis.FontInspector.fontAdded(Ct,Rt):null,Ot=new _font_loader.FontFaceObject(Et,{isEvalSupported:jt.isEvalSupported,disableFontFace:jt.disableFontFace,ignoreErrors:jt.ignoreErrors,inspectFont:St});this.fontLoader.bind(Ot).catch(Ct=>pt.sendWithPromise("FontFallback",{id:wt})).finally(()=>{!jt.fontExtraProperties&&Ot.data&&(Ot.data=null),this.commonObjs.resolve(wt,Ot)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(wt,Et);break;default:throw new Error(`Got unknown common object type ${mt}`)}}),pt.on("obj",([wt,mt,Et,Pt])=>{var St;if(this.destroyed)return;const jt=ct(this,_e).get(mt);if(!jt.objs.has(wt))switch(Et){case"Image":if(jt.objs.resolve(wt,Pt),Pt){let Ot;if(Pt.bitmap){const{width:Ct,height:Rt}=Pt;Ot=Ct*Rt*4}else Ot=((St=Pt.data)==null?void 0:St.length)||0;Ot>_util.MAX_IMAGE_SIZE_TO_CACHE&&(jt._maybeCleanupAfterRender=!0)}break;case"Pattern":jt.objs.resolve(wt,Pt);break;default:throw new Error(`Got unknown object type ${Et}`)}}),pt.on("DocProgress",wt=>{var mt;this.destroyed||(mt=_t.onProgress)==null||mt.call(_t,{loaded:wt.loaded,total:wt.total})}),pt.on("FetchBuiltInCMap",wt=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(wt):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),pt.on("FetchStandardFontData",wt=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(wt):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var wt;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:pt,transfers:_t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:pt,filename:((wt=this._fullReader)==null?void 0:wt.filename)??null},_t).finally(()=>{this.annotationStorage.resetModified()})}getPage(pt){if(!Number.isInteger(pt)||pt<=0||pt>this._numPages)return Promise.reject(new Error("Invalid page request."));const _t=pt-1,wt=ct(this,tt).get(_t);if(wt)return wt;const mt=this.messageHandler.sendWithPromise("GetPage",{pageIndex:_t}).then(Et=>{if(this.destroyed)throw new Error("Transport destroyed");const Pt=new PDFPageProxy(_t,Et,this,this._params.pdfBug);return ct(this,_e).set(_t,Pt),Pt});return ct(this,tt).set(_t,mt),mt}getPageIndex(pt){return typeof pt!="object"||pt===null||!Number.isInteger(pt.num)||pt.num<0||!Number.isInteger(pt.gen)||pt.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:pt.num,gen:pt.gen})}getAnnotations(pt,_t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:pt,intent:_t})}getFieldObjects(){return Ht(this,st,_r).call(this,"GetFieldObjects")}hasJSActions(){return Ht(this,st,_r).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(pt){return typeof pt!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:pt})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Ht(this,st,_r).call(this,"GetDocJSActions")}getPageJSActions(pt){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:pt})}getStructTree(pt){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:pt})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(pt=>new _optional_content_config.OptionalContentConfig(pt))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const pt="GetMetadata",_t=ct(this,$).get(pt);if(_t)return _t;const wt=this.messageHandler.sendWithPromise(pt,null).then(mt=>{var Et,Pt;return{info:mt[0],metadata:mt[1]?new _metadata.Metadata(mt[1]):null,contentDispositionFilename:((Et=this._fullReader)==null?void 0:Et.filename)??null,contentLength:((Pt=this._fullReader)==null?void 0:Pt.contentLength)??null}});return ct(this,$).set(pt,wt),wt}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(pt=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const _t of ct(this,_e).values())if(!_t.cleanup())throw new Error(`startCleanup: Page ${_t.pageNumber} is currently rendering.`);this.commonObjs.clear(),pt||this.fontLoader.clear(),ct(this,$).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:pt,enableXfa:_t}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:pt,enableXfa:_t})}}$=new WeakMap,_e=new WeakMap,tt=new WeakMap,et=new WeakMap,st=new WeakSet,_r=function(pt,_t=null){const wt=ct(this,$).get(pt);if(wt)return wt;const mt=this.messageHandler.sendWithPromise(pt,_t);return ct(this,$).set(pt,mt),mt};class PDFObjects{constructor(){Yt(this,it);Yt(this,nt,Object.create(null))}get(pt,_t=null){if(_t){const mt=Ht(this,it,Or).call(this,pt);return mt.capability.promise.then(()=>_t(mt.data)),null}const wt=ct(this,nt)[pt];if(!(wt!=null&&wt.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${pt}.`);return wt.data}has(pt){const _t=ct(this,nt)[pt];return(_t==null?void 0:_t.capability.settled)||!1}resolve(pt,_t=null){const wt=Ht(this,it,Or).call(this,pt);wt.data=_t,wt.capability.resolve()}clear(){var pt;for(const _t in ct(this,nt)){const{data:wt}=ct(this,nt)[_t];(pt=wt==null?void 0:wt.bitmap)==null||pt.close()}Qt(this,nt,Object.create(null))}}nt=new WeakMap,it=new WeakSet,Or=function(pt){var _t;return(_t=ct(this,nt))[pt]||(_t[pt]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(pt){Yt(this,dt,null);Qt(this,dt,pt),this.onContinue=null}get promise(){return ct(this,dt).capability.promise}cancel(pt=0){ct(this,dt).cancel(null,pt)}get separateAnnots(){const{separateAnnots:pt}=ct(this,dt).operatorList;if(!pt)return!1;const{annotationCanvasMap:_t}=ct(this,dt);return pt.form||pt.canvas&&(_t==null?void 0:_t.size)>0}}dt=new WeakMap,exports.RenderTask=RenderTask;const ht=class ht{constructor({callback:pt,params:_t,objs:wt,commonObjs:mt,annotationCanvasMap:Et,operatorList:Pt,pageIndex:jt,canvasFactory:St,filterFactory:Ot,useRequestAnimationFrame:Ct=!1,pdfBug:Rt=!1,pageColors:bt=null}){this.callback=pt,this.params=_t,this.objs=wt,this.commonObjs=mt,this.annotationCanvasMap=Et,this.operatorListIdx=null,this.operatorList=Pt,this._pageIndex=jt,this.canvasFactory=St,this.filterFactory=Ot,this._pdfBug=Rt,this.pageColors=bt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=Ct===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=_t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:pt=!1,optionalContentConfig:_t}){var jt,St;if(this.cancelled)return;if(this._canvas){if(ct(ht,ot).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");ct(ht,ot).add(this._canvas)}this._pdfBug&&((jt=globalThis.StepperManager)!=null&&jt.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:wt,viewport:mt,transform:Et,background:Pt}=this.params;this.gfx=new _canvas.CanvasGraphics(wt,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:_t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:Et,viewport:mt,transparency:pt,background:Pt}),this.operatorListIdx=0,this.graphicsReady=!0,(St=this.graphicsReadyCallback)==null||St.call(this)}cancel(pt=null,_t=0){var wt;this.running=!1,this.cancelled=!0,(wt=this.gfx)==null||wt.endDrawing(),ct(ht,ot).delete(this._canvas),this.callback(pt||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,_t))}operatorListChanged(){var pt;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(pt=this.stepper)==null||pt.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),ct(ht,ot).delete(this._canvas),this.callback())))}};ot=new WeakMap,Yt(ht,ot,new WeakSet);let InternalRenderTask=ht;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(s,e,a)=>{var b,j,$,gs,tt;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var o=a(1),c=a(4),d=a(8);const h=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=h;class g{constructor(){Yt(this,$);Yt(this,b,!1);Yt(this,j,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(st,rt){const nt=ct(this,j).get(st);return nt===void 0?rt:Object.assign(rt,nt)}getRawValue(st){return ct(this,j).get(st)}remove(st){if(ct(this,j).delete(st),ct(this,j).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const rt of ct(this,j).values())if(rt instanceof c.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(st,rt){const nt=ct(this,j).get(st);let it=!1;if(nt!==void 0)for(const[at,dt]of Object.entries(rt))nt[at]!==dt&&(it=!0,nt[at]=dt);else it=!0,ct(this,j).set(st,rt);it&&Ht(this,$,gs).call(this),rt instanceof c.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(rt.constructor._type)}has(st){return ct(this,j).has(st)}getAll(){return ct(this,j).size>0?(0,o.objectFromMap)(ct(this,j)):null}setAll(st){for(const[rt,nt]of Object.entries(st))this.setValue(rt,nt)}get size(){return ct(this,j).size}resetModified(){ct(this,b)&&(Qt(this,b,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new _(this)}get serializable(){if(ct(this,j).size===0)return h;const st=new Map,rt=new d.MurmurHash3_64,nt=[],it=Object.create(null);let at=!1;for(const[dt,ot]of ct(this,j)){const ht=ot instanceof c.AnnotationEditor?ot.serialize(!1,it):ot;ht&&(st.set(dt,ht),rt.update(`${dt}:${JSON.stringify(ht)}`),at||(at=!!ht.bitmap))}if(at)for(const dt of st.values())dt.bitmap&&nt.push(dt.bitmap);return st.size>0?{map:st,hash:rt.hexdigest(),transfers:nt}:h}}b=new WeakMap,j=new WeakMap,$=new WeakSet,gs=function(){ct(this,b)||(Qt(this,b,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=g;class _ extends g{constructor(rt){super();Yt(this,tt);const{map:nt,hash:it,transfers:at}=rt.serializable,dt=structuredClone(nt,at?{transfer:at}:null);Qt(this,tt,{map:dt,hash:it,transfers:at})}get print(){(0,o.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return ct(this,tt)}}tt=new WeakMap,e.PrintAnnotationStorage=_},(s,e,a)=>{var _,b,j,$,_e,tt,et,st,rt,nt,it,at,dt,ot,ht,Lr,Mr,_t,Nr,Fr,ys,_s,bs,Dr,vs;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var o=a(5),c=a(1),d=a(6);const Ct=class Ct{constructor(bt){Yt(this,ht);Yt(this,_,"");Yt(this,b,!1);Yt(this,j,null);Yt(this,$,null);Yt(this,_e,null);Yt(this,tt,!1);Yt(this,et,null);Yt(this,st,this.focusin.bind(this));Yt(this,rt,this.focusout.bind(this));Yt(this,nt,!1);Yt(this,it,!1);Yt(this,at,!1);Sn(this,"_initialOptions",Object.create(null));Sn(this,"_uiManager",null);Sn(this,"_focusEventsAllowed",!0);Sn(this,"_l10nPromise",null);Yt(this,dt,!1);Yt(this,ot,Ct._zIndex++);this.constructor===Ct&&(0,c.unreachable)("Cannot initialize AnnotationEditor."),this.parent=bt.parent,this.id=bt.id,this.width=this.height=null,this.pageIndex=bt.parent.pageIndex,this.name=bt.name,this.div=null,this._uiManager=bt.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=bt.isCentered,this._structTreeParentId=null;const{rotation:Tt,rawDims:{pageWidth:$t,pageHeight:xt,pageX:ft,pageY:yt}}=this.parent.viewport;this.rotation=Tt,this.pageRotation=(360+Tt-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[$t,xt],this.pageTranslation=[ft,yt];const[vt,It]=this.parentDimensions;this.x=bt.x/vt,this.y=bt.y/It,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,c.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(bt){const Tt=new g({id:bt.parent.getNextId(),parent:bt.parent,uiManager:bt._uiManager});Tt.annotationElementId=bt.annotationElementId,Tt.deleted=!0,Tt._uiManager.addToAnnotationStorage(Tt)}static initialize(bt,Tt=null){if(Ct._l10nPromise||(Ct._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(xt=>[xt,bt.get(xt)]))),Tt!=null&&Tt.strings)for(const xt of Tt.strings)Ct._l10nPromise.set(xt,bt.get(xt));if(Ct._borderLineWidth!==-1)return;const $t=getComputedStyle(document.documentElement);Ct._borderLineWidth=parseFloat($t.getPropertyValue("--outline-width"))||0}static updateDefaultParams(bt,Tt){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(bt){return!1}static paste(bt,Tt){(0,c.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return ct(this,dt)}set _isDraggable(bt){var Tt;Qt(this,dt,bt),(Tt=this.div)==null||Tt.classList.toggle("draggable",bt)}center(){const[bt,Tt]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*Tt/(bt*2),this.y+=this.width*bt/(Tt*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*Tt/(bt*2),this.y-=this.width*bt/(Tt*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(bt){this._uiManager.addCommands(bt)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=ct(this,ot)}setParent(bt){bt!==null&&(this.pageIndex=bt.pageIndex,this.pageDimensions=bt.pageDimensions),this.parent=bt}focusin(bt){this._focusEventsAllowed&&(ct(this,nt)?Qt(this,nt,!1):this.parent.setSelected(this))}focusout(bt){var $t;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const Tt=bt.relatedTarget;Tt!=null&&Tt.closest(`#${this.id}`)||(bt.preventDefault(),($t=this.parent)!=null&&$t.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(bt,Tt,$t,xt){const[ft,yt]=this.parentDimensions;[$t,xt]=this.screenToPageTranslation($t,xt),this.x=(bt+$t)/ft,this.y=(Tt+xt)/yt,this.fixAndSetPosition()}translate(bt,Tt){Ht(this,ht,Lr).call(this,this.parentDimensions,bt,Tt)}translateInPage(bt,Tt){Ht(this,ht,Lr).call(this,this.pageDimensions,bt,Tt),this.div.scrollIntoView({block:"nearest"})}drag(bt,Tt){const[$t,xt]=this.parentDimensions;if(this.x+=bt/$t,this.y+=Tt/xt,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:Lt,y:Nt}=this.div.getBoundingClientRect();this.parent.findNewParent(this,Lt,Nt)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:ft,y:yt}=this;const[vt,It]=Ht(this,ht,Mr).call(this);ft+=vt,yt+=It,this.div.style.left=`${(100*ft).toFixed(2)}%`,this.div.style.top=`${(100*yt).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[bt,Tt]=this.pageDimensions;let{x:$t,y:xt,width:ft,height:yt}=this;switch(ft*=bt,yt*=Tt,$t*=bt,xt*=Tt,this.rotation){case 0:$t=Math.max(0,Math.min(bt-ft,$t)),xt=Math.max(0,Math.min(Tt-yt,xt));break;case 90:$t=Math.max(0,Math.min(bt-yt,$t)),xt=Math.min(Tt,Math.max(ft,xt));break;case 180:$t=Math.min(bt,Math.max(ft,$t)),xt=Math.min(Tt,Math.max(yt,xt));break;case 270:$t=Math.min(bt,Math.max(yt,$t)),xt=Math.max(0,Math.min(Tt-ft,xt));break}this.x=$t/=bt,this.y=xt/=Tt;const[vt,It]=Ht(this,ht,Mr).call(this);$t+=vt,xt+=It;const{style:Lt}=this.div;Lt.left=`${(100*$t).toFixed(2)}%`,Lt.top=`${(100*xt).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(bt,Tt){var $t;return Ht($t=Ct,_t,Nr).call($t,bt,Tt,this.parentRotation)}pageTranslationToScreen(bt,Tt){var $t;return Ht($t=Ct,_t,Nr).call($t,bt,Tt,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:bt,pageDimensions:[Tt,$t]}=this,xt=Tt*bt,ft=$t*bt;return c.FeatureTest.isCSSRoundSupported?[Math.round(xt),Math.round(ft)]:[xt,ft]}setDims(bt,Tt){var ft;const[$t,xt]=this.parentDimensions;this.div.style.width=`${(100*bt/$t).toFixed(2)}%`,ct(this,tt)||(this.div.style.height=`${(100*Tt/xt).toFixed(2)}%`),(ft=ct(this,j))==null||ft.classList.toggle("small",bt<Ct.SMALL_EDITOR_SIZE||Tt<Ct.SMALL_EDITOR_SIZE)}fixDims(){const{style:bt}=this.div,{height:Tt,width:$t}=bt,xt=$t.endsWith("%"),ft=!ct(this,tt)&&Tt.endsWith("%");if(xt&&ft)return;const[yt,vt]=this.parentDimensions;xt||(bt.width=`${(100*parseFloat($t)/yt).toFixed(2)}%`),!ct(this,tt)&&!ft&&(bt.height=`${(100*parseFloat(Tt)/vt).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(ct(this,j))return;const bt=Qt(this,j,document.createElement("button"));bt.className="altText";const Tt=await Ct._l10nPromise.get("editor_alt_text_button_label");bt.textContent=Tt,bt.setAttribute("aria-label",Tt),bt.tabIndex="0",bt.addEventListener("contextmenu",d.noContextMenu),bt.addEventListener("pointerdown",$t=>$t.stopPropagation()),bt.addEventListener("click",$t=>{$t.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),bt.addEventListener("keydown",$t=>{$t.target===bt&&$t.key==="Enter"&&($t.preventDefault(),this._uiManager.editAltText(this))}),Ht(this,ht,Dr).call(this),this.div.append(bt),Ct.SMALL_EDITOR_SIZE||(Ct.SMALL_EDITOR_SIZE=Math.min(128,Math.round(bt.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:ct(this,_),decorative:ct(this,b)}}set altTextData({altText:bt,decorative:Tt}){ct(this,_)===bt&&ct(this,b)===Tt||(Qt(this,_,bt),Qt(this,b,Tt),Ht(this,ht,Dr).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",ct(this,st)),this.div.addEventListener("focusout",ct(this,rt));const[bt,Tt]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*Tt/bt).toFixed(2)}%`,this.div.style.maxHeight=`${(100*bt/Tt).toFixed(2)}%`);const[$t,xt]=this.getInitialTranslation();return this.translate($t,xt),(0,o.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(bt){const{isMac:Tt}=c.FeatureTest.platform;if(bt.button!==0||bt.ctrlKey&&Tt){bt.preventDefault();return}Qt(this,nt,!0),Ht(this,ht,vs).call(this,bt)}moveInDOM(){var bt;(bt=this.parent)==null||bt.moveEditorInDOM(this)}_setParentAndPosition(bt,Tt,$t){bt.changeParent(this),this.x=Tt,this.y=$t,this.fixAndSetPosition()}getRect(bt,Tt){const $t=this.parentScale,[xt,ft]=this.pageDimensions,[yt,vt]=this.pageTranslation,It=bt/$t,Lt=Tt/$t,Nt=this.x*xt,Bt=this.y*ft,Kt=this.width*xt,rn=this.height*ft;switch(this.rotation){case 0:return[Nt+It+yt,ft-Bt-Lt-rn+vt,Nt+It+Kt+yt,ft-Bt-Lt+vt];case 90:return[Nt+Lt+yt,ft-Bt+It+vt,Nt+Lt+rn+yt,ft-Bt+It+Kt+vt];case 180:return[Nt-It-Kt+yt,ft-Bt+Lt+vt,Nt-It+yt,ft-Bt+Lt+rn+vt];case 270:return[Nt-Lt-rn+yt,ft-Bt-It-Kt+vt,Nt-Lt+yt,ft-Bt-It+vt];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(bt,Tt){const[$t,xt,ft,yt]=bt,vt=ft-$t,It=yt-xt;switch(this.rotation){case 0:return[$t,Tt-yt,vt,It];case 90:return[$t,Tt-xt,It,vt];case 180:return[ft,Tt-xt,vt,It];case 270:return[ft,Tt-yt,It,vt];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){Qt(this,at,!0)}disableEditMode(){Qt(this,at,!1)}isInEditMode(){return ct(this,at)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var bt,Tt;(bt=this.div)==null||bt.addEventListener("focusin",ct(this,st)),(Tt=this.div)==null||Tt.addEventListener("focusout",ct(this,rt))}serialize(bt=!1,Tt=null){(0,c.unreachable)("An editor must be serializable")}static deserialize(bt,Tt,$t){const xt=new this.prototype.constructor({parent:Tt,id:Tt.getNextId(),uiManager:$t});xt.rotation=bt.rotation;const[ft,yt]=xt.pageDimensions,[vt,It,Lt,Nt]=xt.getRectInCurrentCoords(bt.rect,yt);return xt.x=vt/ft,xt.y=It/yt,xt.width=Lt/ft,xt.height=Nt/yt,xt}remove(){var bt;this.div.removeEventListener("focusin",ct(this,st)),this.div.removeEventListener("focusout",ct(this,rt)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(bt=ct(this,j))==null||bt.remove(),Qt(this,j,null),Qt(this,$,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Ht(this,ht,ys).call(this),ct(this,et).classList.remove("hidden"))}select(){var bt;this.makeResizable(),(bt=this.div)==null||bt.classList.add("selectedEditor")}unselect(){var bt,Tt,$t;(bt=ct(this,et))==null||bt.classList.add("hidden"),(Tt=this.div)==null||Tt.classList.remove("selectedEditor"),($t=this.div)!=null&&$t.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(bt,Tt){}disableEditing(){ct(this,j)&&(ct(this,j).hidden=!0)}enableEditing(){ct(this,j)&&(ct(this,j).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return ct(this,it)}set isEditing(bt){Qt(this,it,bt),this.parent&&(bt?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(bt,Tt){Qt(this,tt,!0);const $t=bt/Tt,{style:xt}=this.div;xt.aspectRatio=$t,xt.height="auto"}static get MIN_SIZE(){return 16}};_=new WeakMap,b=new WeakMap,j=new WeakMap,$=new WeakMap,_e=new WeakMap,tt=new WeakMap,et=new WeakMap,st=new WeakMap,rt=new WeakMap,nt=new WeakMap,it=new WeakMap,at=new WeakMap,dt=new WeakMap,ot=new WeakMap,ht=new WeakSet,Lr=function([bt,Tt],$t,xt){[$t,xt]=this.screenToPageTranslation($t,xt),this.x+=$t/bt,this.y+=xt/Tt,this.fixAndSetPosition()},Mr=function(){const[bt,Tt]=this.parentDimensions,{_borderLineWidth:$t}=Ct,xt=$t/bt,ft=$t/Tt;switch(this.rotation){case 90:return[-xt,ft];case 180:return[xt,ft];case 270:return[xt,-ft];default:return[-xt,-ft]}},_t=new WeakSet,Nr=function(bt,Tt,$t){switch($t){case 90:return[Tt,-bt];case 180:return[-bt,-Tt];case 270:return[-Tt,bt];default:return[bt,Tt]}},Fr=function(bt){switch(bt){case 90:{const[Tt,$t]=this.pageDimensions;return[0,-Tt/$t,$t/Tt,0]}case 180:return[-1,0,0,-1];case 270:{const[Tt,$t]=this.pageDimensions;return[0,Tt/$t,-$t/Tt,0]}default:return[1,0,0,1]}},ys=function(){if(ct(this,et))return;Qt(this,et,document.createElement("div")),ct(this,et).classList.add("resizers");const bt=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||bt.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const Tt of bt){const $t=document.createElement("div");ct(this,et).append($t),$t.classList.add("resizer",Tt),$t.addEventListener("pointerdown",Ht(this,ht,_s).bind(this,Tt)),$t.addEventListener("contextmenu",d.noContextMenu)}this.div.prepend(ct(this,et))},_s=function(bt,Tt){Tt.preventDefault();const{isMac:$t}=c.FeatureTest.platform;if(Tt.button!==0||Tt.ctrlKey&&$t)return;const xt=Ht(this,ht,bs).bind(this,bt),ft=this._isDraggable;this._isDraggable=!1;const yt={passive:!0,capture:!0};window.addEventListener("pointermove",xt,yt);const vt=this.x,It=this.y,Lt=this.width,Nt=this.height,Bt=this.parent.div.style.cursor,Kt=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(Tt.target).cursor;const rn=()=>{this._isDraggable=ft,window.removeEventListener("pointerup",rn),window.removeEventListener("blur",rn),window.removeEventListener("pointermove",xt,yt),this.parent.div.style.cursor=Bt,this.div.style.cursor=Kt;const nn=this.x,on=this.y,cn=this.width,hn=this.height;nn===vt&&on===It&&cn===Lt&&hn===Nt||this.addCommands({cmd:()=>{this.width=cn,this.height=hn,this.x=nn,this.y=on;const[Zt,Gt]=this.parentDimensions;this.setDims(Zt*cn,Gt*hn),this.fixAndSetPosition()},undo:()=>{this.width=Lt,this.height=Nt,this.x=vt,this.y=It;const[Zt,Gt]=this.parentDimensions;this.setDims(Zt*Lt,Gt*Nt),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",rn),window.addEventListener("blur",rn)},bs=function(bt,Tt){const[$t,xt]=this.parentDimensions,ft=this.x,yt=this.y,vt=this.width,It=this.height,Lt=Ct.MIN_SIZE/$t,Nt=Ct.MIN_SIZE/xt,Bt=An=>Math.round(An*1e4)/1e4,Kt=Ht(this,ht,Fr).call(this,this.rotation),rn=(An,In)=>[Kt[0]*An+Kt[2]*In,Kt[1]*An+Kt[3]*In],nn=Ht(this,ht,Fr).call(this,360-this.rotation),on=(An,In)=>[nn[0]*An+nn[2]*In,nn[1]*An+nn[3]*In];let cn,hn,Zt=!1,Gt=!1;switch(bt){case"topLeft":Zt=!0,cn=(An,In)=>[0,0],hn=(An,In)=>[An,In];break;case"topMiddle":cn=(An,In)=>[An/2,0],hn=(An,In)=>[An/2,In];break;case"topRight":Zt=!0,cn=(An,In)=>[An,0],hn=(An,In)=>[0,In];break;case"middleRight":Gt=!0,cn=(An,In)=>[An,In/2],hn=(An,In)=>[0,In/2];break;case"bottomRight":Zt=!0,cn=(An,In)=>[An,In],hn=(An,In)=>[0,0];break;case"bottomMiddle":cn=(An,In)=>[An/2,In],hn=(An,In)=>[An/2,0];break;case"bottomLeft":Zt=!0,cn=(An,In)=>[0,In],hn=(An,In)=>[An,0];break;case"middleLeft":Gt=!0,cn=(An,In)=>[0,In/2],hn=(An,In)=>[An,In/2];break}const At=cn(vt,It),Ft=hn(vt,It);let Vt=rn(...Ft);const qt=Bt(ft+Vt[0]),an=Bt(yt+Vt[1]);let fn=1,un=1,[zt,gn]=this.screenToPageTranslation(Tt.movementX,Tt.movementY);if([zt,gn]=on(zt/$t,gn/xt),Zt){const An=Math.hypot(vt,It);fn=un=Math.max(Math.min(Math.hypot(Ft[0]-At[0]-zt,Ft[1]-At[1]-gn)/An,1/vt,1/It),Lt/vt,Nt/It)}else Gt?fn=Math.max(Lt,Math.min(1,Math.abs(Ft[0]-At[0]-zt)))/vt:un=Math.max(Nt,Math.min(1,Math.abs(Ft[1]-At[1]-gn)))/It;const mn=Bt(vt*fn),Fn=Bt(It*un);Vt=rn(...hn(mn,Fn));const Ln=qt-Vt[0],Bn=an-Vt[1];this.width=mn,this.height=Fn,this.x=Ln,this.y=Bn,this.setDims($t*mn,xt*Fn),this.fixAndSetPosition()},Dr=async function(){var $t;const bt=ct(this,j);if(!bt)return;if(!ct(this,_)&&!ct(this,b)){bt.classList.remove("done"),($t=ct(this,$))==null||$t.remove();return}Ct._l10nPromise.get("editor_alt_text_edit_button_label").then(xt=>{bt.setAttribute("aria-label",xt)});let Tt=ct(this,$);if(!Tt){Qt(this,$,Tt=document.createElement("span")),Tt.className="tooltip",Tt.setAttribute("role","tooltip");const xt=Tt.id=`alt-text-tooltip-${this.id}`;bt.setAttribute("aria-describedby",xt);const ft=100;bt.addEventListener("mouseenter",()=>{Qt(this,_e,setTimeout(()=>{Qt(this,_e,null),ct(this,$).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},ft))}),bt.addEventListener("mouseleave",()=>{var yt;clearTimeout(ct(this,_e)),Qt(this,_e,null),(yt=ct(this,$))==null||yt.classList.remove("show")})}bt.classList.add("done"),Tt.innerText=ct(this,b)?await Ct._l10nPromise.get("editor_alt_text_decorative_tooltip"):ct(this,_),Tt.parentNode||bt.append(Tt)},vs=function(bt){if(!this._isDraggable)return;const Tt=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let $t,xt;Tt&&($t={passive:!0,capture:!0},xt=yt=>{const[vt,It]=this.screenToPageTranslation(yt.movementX,yt.movementY);this._uiManager.dragSelectedEditors(vt,It)},window.addEventListener("pointermove",xt,$t));const ft=()=>{if(window.removeEventListener("pointerup",ft),window.removeEventListener("blur",ft),Tt&&window.removeEventListener("pointermove",xt,$t),Qt(this,nt,!1),!this._uiManager.endDragSession()){const{isMac:yt}=c.FeatureTest.platform;bt.ctrlKey&&!yt||bt.shiftKey||bt.metaKey&&yt?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",ft),window.addEventListener("blur",ft)},Yt(Ct,_t),Sn(Ct,"_borderLineWidth",-1),Sn(Ct,"_colorManager",new o.ColorManager),Sn(Ct,"_zIndex",1),Sn(Ct,"SMALL_EDITOR_SIZE",0);let h=Ct;e.AnnotationEditor=h;class g extends h{constructor(bt){super(bt),this.annotationElementId=bt.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(s,e,a)=>{var tt,et,st,rt,nt,jr,dt,ot,ht,ut,pt,ws,mt,Et,Pt,jt,St,Ot,Ct,Rt,bt,Tt,$t,xt,ft,yt,vt,It,Lt,Nt,Bt,Kt,rn,nn,on,cn,hn,Zt,Gt,At,Ft,Vt,qt,an,fn,un,zt,xs,$r,Ur,br,Br,Hr,Yn,ur,Es,Ss,zr,dr,Vr;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=d,e.opacityToHex=h;var o=a(1),c=a(6);function d(Dn,Dt,sn){for(const yn of sn)Dt.addEventListener(yn,Dn[yn].bind(Dn))}function h(Dn){return Math.round(Math.min(255,Math.max(1,255*Dn))).toString(16).padStart(2,"0")}class g{constructor(){Yt(this,tt,0)}getId(){return`${o.AnnotationEditorPrefix}${cr(this,tt)._++}`}}tt=new WeakMap;const at=class at{constructor(){Yt(this,nt);Yt(this,et,(0,o.getUuid)());Yt(this,st,0);Yt(this,rt,null)}static get _isSVGFittingCanvas(){const Dt='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',yn=new OffscreenCanvas(1,3).getContext("2d"),Pn=new Image;Pn.src=Dt;const vn=Pn.decode().then(()=>(yn.drawImage(Pn,0,0,1,1,0,0,1,3),new Uint32Array(yn.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,o.shadow)(this,"_isSVGFittingCanvas",vn)}async getFromFile(Dt){const{lastModified:sn,name:yn,size:Pn,type:vn}=Dt;return Ht(this,nt,jr).call(this,`${sn}_${yn}_${Pn}_${vn}`,Dt)}async getFromUrl(Dt){return Ht(this,nt,jr).call(this,Dt,Dt)}async getFromId(Dt){ct(this,rt)||Qt(this,rt,new Map);const sn=ct(this,rt).get(Dt);return sn?sn.bitmap?(sn.refCounter+=1,sn):sn.file?this.getFromFile(sn.file):this.getFromUrl(sn.url):null}getSvgUrl(Dt){const sn=ct(this,rt).get(Dt);return sn!=null&&sn.isSvg?sn.svgUrl:null}deleteId(Dt){ct(this,rt)||Qt(this,rt,new Map);const sn=ct(this,rt).get(Dt);sn&&(sn.refCounter-=1,sn.refCounter===0&&(sn.bitmap=null))}isValidId(Dt){return Dt.startsWith(`image_${ct(this,et)}_`)}};et=new WeakMap,st=new WeakMap,rt=new WeakMap,nt=new WeakSet,jr=async function(Dt,sn){ct(this,rt)||Qt(this,rt,new Map);let yn=ct(this,rt).get(Dt);if(yn===null)return null;if(yn!=null&&yn.bitmap)return yn.refCounter+=1,yn;try{yn||(yn={bitmap:null,id:`image_${ct(this,et)}_${cr(this,st)._++}`,refCounter:0,isSvg:!1});let Pn;if(typeof sn=="string"){yn.url=sn;const vn=await fetch(sn);if(!vn.ok)throw new Error(vn.statusText);Pn=await vn.blob()}else Pn=yn.file=sn;if(Pn.type==="image/svg+xml"){const vn=at._isSVGFittingCanvas,wn=new FileReader,Mt=new Image,kt=new Promise((Ut,en)=>{Mt.onload=()=>{yn.bitmap=Mt,yn.isSvg=!0,Ut()},wn.onload=async()=>{const tn=yn.svgUrl=wn.result;Mt.src=await vn?`${tn}#svgView(preserveAspectRatio(none))`:tn},Mt.onerror=wn.onerror=en});wn.readAsDataURL(Pn),await kt}else yn.bitmap=await createImageBitmap(Pn);yn.refCounter=1}catch(Pn){console.error(Pn),yn=null}return ct(this,rt).set(Dt,yn),yn&&ct(this,rt).set(yn.id,yn),yn};let _=at;class b{constructor(Dt=128){Yt(this,dt,[]);Yt(this,ot,!1);Yt(this,ht);Yt(this,ut,-1);Qt(this,ht,Dt)}add({cmd:Dt,undo:sn,mustExec:yn,type:Pn=NaN,overwriteIfSameType:vn=!1,keepUndo:wn=!1}){if(yn&&Dt(),ct(this,ot))return;const Mt={cmd:Dt,undo:sn,type:Pn};if(ct(this,ut)===-1){ct(this,dt).length>0&&(ct(this,dt).length=0),Qt(this,ut,0),ct(this,dt).push(Mt);return}if(vn&&ct(this,dt)[ct(this,ut)].type===Pn){wn&&(Mt.undo=ct(this,dt)[ct(this,ut)].undo),ct(this,dt)[ct(this,ut)]=Mt;return}const kt=ct(this,ut)+1;kt===ct(this,ht)?ct(this,dt).splice(0,1):(Qt(this,ut,kt),kt<ct(this,dt).length&&ct(this,dt).splice(kt)),ct(this,dt).push(Mt)}undo(){ct(this,ut)!==-1&&(Qt(this,ot,!0),ct(this,dt)[ct(this,ut)].undo(),Qt(this,ot,!1),Qt(this,ut,ct(this,ut)-1))}redo(){ct(this,ut)<ct(this,dt).length-1&&(Qt(this,ut,ct(this,ut)+1),Qt(this,ot,!0),ct(this,dt)[ct(this,ut)].cmd(),Qt(this,ot,!1))}hasSomethingToUndo(){return ct(this,ut)!==-1}hasSomethingToRedo(){return ct(this,ut)<ct(this,dt).length-1}destroy(){Qt(this,dt,null)}}dt=new WeakMap,ot=new WeakMap,ht=new WeakMap,ut=new WeakMap,e.CommandManager=b;class j{constructor(Dt){Yt(this,pt);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:sn}=o.FeatureTest.platform;for(const[yn,Pn,vn={}]of Dt)for(const wn of yn){const Mt=wn.startsWith("mac+");sn&&Mt?(this.callbacks.set(wn.slice(4),{callback:Pn,options:vn}),this.allKeys.add(wn.split("+").at(-1))):!sn&&!Mt&&(this.callbacks.set(wn,{callback:Pn,options:vn}),this.allKeys.add(wn.split("+").at(-1)))}}exec(Dt,sn){if(!this.allKeys.has(sn.key))return;const yn=this.callbacks.get(Ht(this,pt,ws).call(this,sn));if(!yn)return;const{callback:Pn,options:{bubbles:vn=!1,args:wn=[],checker:Mt=null}}=yn;Mt&&!Mt(Dt,sn)||(Pn.bind(Dt,...wn)(),vn||(sn.stopPropagation(),sn.preventDefault()))}}pt=new WeakSet,ws=function(Dt){Dt.altKey&&this.buffer.push("alt"),Dt.ctrlKey&&this.buffer.push("ctrl"),Dt.metaKey&&this.buffer.push("meta"),Dt.shiftKey&&this.buffer.push("shift"),this.buffer.push(Dt.key);const sn=this.buffer.join("+");return this.buffer.length=0,sn},e.KeyboardManager=j;const wt=class wt{get _colors(){const Dt=new Map([["CanvasText",null],["Canvas",null]]);return(0,c.getColorValues)(Dt),(0,o.shadow)(this,"_colors",Dt)}convert(Dt){const sn=(0,c.getRGB)(Dt);if(!window.matchMedia("(forced-colors: active)").matches)return sn;for(const[yn,Pn]of this._colors)if(Pn.every((vn,wn)=>vn===sn[wn]))return wt._colorsMapping.get(yn);return sn}getHexCode(Dt){const sn=this._colors.get(Dt);return sn?o.Util.makeHexColor(...sn):Dt}};Sn(wt,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let $=wt;e.ColorManager=$;const $n=class $n{constructor(Dt,sn,yn,Pn,vn,wn){Yt(this,zt);Yt(this,mt,null);Yt(this,Et,new Map);Yt(this,Pt,new Map);Yt(this,jt,null);Yt(this,St,null);Yt(this,Ot,new b);Yt(this,Ct,0);Yt(this,Rt,new Set);Yt(this,bt,null);Yt(this,Tt,null);Yt(this,$t,new Set);Yt(this,xt,null);Yt(this,ft,new g);Yt(this,yt,!1);Yt(this,vt,!1);Yt(this,It,null);Yt(this,Lt,o.AnnotationEditorType.NONE);Yt(this,Nt,new Set);Yt(this,Bt,null);Yt(this,Kt,this.blur.bind(this));Yt(this,rn,this.focus.bind(this));Yt(this,nn,this.copy.bind(this));Yt(this,on,this.cut.bind(this));Yt(this,cn,this.paste.bind(this));Yt(this,hn,this.keydown.bind(this));Yt(this,Zt,this.onEditingAction.bind(this));Yt(this,Gt,this.onPageChanging.bind(this));Yt(this,At,this.onScaleChanging.bind(this));Yt(this,Ft,this.onRotationChanging.bind(this));Yt(this,Vt,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Yt(this,qt,[0,0]);Yt(this,an,null);Yt(this,fn,null);Yt(this,un,null);Qt(this,fn,Dt),Qt(this,un,sn),Qt(this,jt,yn),this._eventBus=Pn,this._eventBus._on("editingaction",ct(this,Zt)),this._eventBus._on("pagechanging",ct(this,Gt)),this._eventBus._on("scalechanging",ct(this,At)),this._eventBus._on("rotationchanging",ct(this,Ft)),Qt(this,St,vn.annotationStorage),Qt(this,xt,vn.filterFactory),Qt(this,Bt,wn),this.viewParameters={realScale:c.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const Dt=$n.prototype,sn=vn=>{const{activeElement:wn}=document;return wn&&ct(vn,fn).contains(wn)&&vn.hasSomethingToControl()},yn=this.TRANSLATE_SMALL,Pn=this.TRANSLATE_BIG;return(0,o.shadow)(this,"_keyboardManager",new j([[["ctrl+a","mac+meta+a"],Dt.selectAll],[["ctrl+z","mac+meta+z"],Dt.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],Dt.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],Dt.delete],[["Escape","mac+Escape"],Dt.unselectAll],[["ArrowLeft","mac+ArrowLeft"],Dt.translateSelectedEditors,{args:[-yn,0],checker:sn}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Dt.translateSelectedEditors,{args:[-Pn,0],checker:sn}],[["ArrowRight","mac+ArrowRight"],Dt.translateSelectedEditors,{args:[yn,0],checker:sn}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Dt.translateSelectedEditors,{args:[Pn,0],checker:sn}],[["ArrowUp","mac+ArrowUp"],Dt.translateSelectedEditors,{args:[0,-yn],checker:sn}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Dt.translateSelectedEditors,{args:[0,-Pn],checker:sn}],[["ArrowDown","mac+ArrowDown"],Dt.translateSelectedEditors,{args:[0,yn],checker:sn}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Dt.translateSelectedEditors,{args:[0,Pn],checker:sn}]]))}destroy(){Ht(this,zt,br).call(this),Ht(this,zt,$r).call(this),this._eventBus._off("editingaction",ct(this,Zt)),this._eventBus._off("pagechanging",ct(this,Gt)),this._eventBus._off("scalechanging",ct(this,At)),this._eventBus._off("rotationchanging",ct(this,Ft));for(const Dt of ct(this,Pt).values())Dt.destroy();ct(this,Pt).clear(),ct(this,Et).clear(),ct(this,$t).clear(),Qt(this,mt,null),ct(this,Nt).clear(),ct(this,Ot).destroy(),ct(this,jt).destroy()}get hcmFilter(){return(0,o.shadow)(this,"hcmFilter",ct(this,Bt)?ct(this,xt).addHCMFilter(ct(this,Bt).foreground,ct(this,Bt).background):"none")}get direction(){return(0,o.shadow)(this,"direction",getComputedStyle(ct(this,fn)).direction)}editAltText(Dt){var sn;(sn=ct(this,jt))==null||sn.editAltText(this,Dt)}onPageChanging({pageNumber:Dt}){Qt(this,Ct,Dt-1)}focusMainContainer(){ct(this,fn).focus()}findParent(Dt,sn){for(const yn of ct(this,Pt).values()){const{x:Pn,y:vn,width:wn,height:Mt}=yn.div.getBoundingClientRect();if(Dt>=Pn&&Dt<=Pn+wn&&sn>=vn&&sn<=vn+Mt)return yn}return null}disableUserSelect(Dt=!1){ct(this,un).classList.toggle("noUserSelect",Dt)}addShouldRescale(Dt){ct(this,$t).add(Dt)}removeShouldRescale(Dt){ct(this,$t).delete(Dt)}onScaleChanging({scale:Dt}){this.commitOrRemove(),this.viewParameters.realScale=Dt*c.PixelsPerInch.PDF_TO_CSS_UNITS;for(const sn of ct(this,$t))sn.onScaleChanging()}onRotationChanging({pagesRotation:Dt}){this.commitOrRemove(),this.viewParameters.rotation=Dt}addToAnnotationStorage(Dt){!Dt.isEmpty()&&ct(this,St)&&!ct(this,St).has(Dt.id)&&ct(this,St).setValue(Dt.id,Dt)}blur(){if(!this.hasSelection)return;const{activeElement:Dt}=document;for(const sn of ct(this,Nt))if(sn.div.contains(Dt)){Qt(this,It,[sn,Dt]),sn._focusEventsAllowed=!1;break}}focus(){if(!ct(this,It))return;const[Dt,sn]=ct(this,It);Qt(this,It,null),sn.addEventListener("focusin",()=>{Dt._focusEventsAllowed=!0},{once:!0}),sn.focus()}addEditListeners(){Ht(this,zt,Ur).call(this),Ht(this,zt,Br).call(this)}removeEditListeners(){Ht(this,zt,br).call(this),Ht(this,zt,Hr).call(this)}copy(Dt){var yn;if(Dt.preventDefault(),(yn=ct(this,mt))==null||yn.commitOrRemove(),!this.hasSelection)return;const sn=[];for(const Pn of ct(this,Nt)){const vn=Pn.serialize(!0);vn&&sn.push(vn)}sn.length!==0&&Dt.clipboardData.setData("application/pdfjs",JSON.stringify(sn))}cut(Dt){this.copy(Dt),this.delete()}paste(Dt){Dt.preventDefault();const{clipboardData:sn}=Dt;for(const vn of sn.items)for(const wn of ct(this,Tt))if(wn.isHandlingMimeForPasting(vn.type)){wn.paste(vn,this.currentLayer);return}let yn=sn.getData("application/pdfjs");if(!yn)return;try{yn=JSON.parse(yn)}catch(vn){(0,o.warn)(`paste: "${vn.message}".`);return}if(!Array.isArray(yn))return;this.unselectAll();const Pn=this.currentLayer;try{const vn=[];for(const kt of yn){const Ut=Pn.deserialize(kt);if(!Ut)return;vn.push(Ut)}const wn=()=>{for(const kt of vn)Ht(this,zt,zr).call(this,kt);Ht(this,zt,Vr).call(this,vn)},Mt=()=>{for(const kt of vn)kt.remove()};this.addCommands({cmd:wn,undo:Mt,mustExec:!0})}catch(vn){(0,o.warn)(`paste: "${vn.message}".`)}}keydown(Dt){var sn;(sn=this.getActive())!=null&&sn.shouldGetKeyboardEvents()||$n._keyboardManager.exec(this,Dt)}onEditingAction(Dt){["undo","redo","delete","selectAll"].includes(Dt.name)&&this[Dt.name]()}setEditingState(Dt){Dt?(Ht(this,zt,xs).call(this),Ht(this,zt,Ur).call(this),Ht(this,zt,Br).call(this),Ht(this,zt,Yn).call(this,{isEditing:ct(this,Lt)!==o.AnnotationEditorType.NONE,isEmpty:Ht(this,zt,dr).call(this),hasSomethingToUndo:ct(this,Ot).hasSomethingToUndo(),hasSomethingToRedo:ct(this,Ot).hasSomethingToRedo(),hasSelectedEditor:!1})):(Ht(this,zt,$r).call(this),Ht(this,zt,br).call(this),Ht(this,zt,Hr).call(this),Ht(this,zt,Yn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(Dt){if(!ct(this,Tt)){Qt(this,Tt,Dt);for(const sn of ct(this,Tt))Ht(this,zt,ur).call(this,sn.defaultPropertiesToUpdate)}}getId(){return ct(this,ft).getId()}get currentLayer(){return ct(this,Pt).get(ct(this,Ct))}getLayer(Dt){return ct(this,Pt).get(Dt)}get currentPageIndex(){return ct(this,Ct)}addLayer(Dt){ct(this,Pt).set(Dt.pageIndex,Dt),ct(this,yt)?Dt.enable():Dt.disable()}removeLayer(Dt){ct(this,Pt).delete(Dt.pageIndex)}updateMode(Dt,sn=null){if(ct(this,Lt)!==Dt){if(Qt(this,Lt,Dt),Dt===o.AnnotationEditorType.NONE){this.setEditingState(!1),Ht(this,zt,Ss).call(this);return}this.setEditingState(!0),Ht(this,zt,Es).call(this),this.unselectAll();for(const yn of ct(this,Pt).values())yn.updateMode(Dt);if(sn){for(const yn of ct(this,Et).values())if(yn.annotationElementId===sn){this.setSelected(yn),yn.enterInEditMode();break}}}}updateToolbar(Dt){Dt!==ct(this,Lt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:Dt})}updateParams(Dt,sn){if(ct(this,Tt)){if(Dt===o.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(Dt);return}for(const yn of ct(this,Nt))yn.updateParams(Dt,sn);for(const yn of ct(this,Tt))yn.updateDefaultParams(Dt,sn)}}enableWaiting(Dt=!1){if(ct(this,vt)!==Dt){Qt(this,vt,Dt);for(const sn of ct(this,Pt).values())Dt?sn.disableClick():sn.enableClick(),sn.div.classList.toggle("waiting",Dt)}}getEditors(Dt){const sn=[];for(const yn of ct(this,Et).values())yn.pageIndex===Dt&&sn.push(yn);return sn}getEditor(Dt){return ct(this,Et).get(Dt)}addEditor(Dt){ct(this,Et).set(Dt.id,Dt)}removeEditor(Dt){var sn;ct(this,Et).delete(Dt.id),this.unselect(Dt),(!Dt.annotationElementId||!ct(this,Rt).has(Dt.annotationElementId))&&((sn=ct(this,St))==null||sn.remove(Dt.id))}addDeletedAnnotationElement(Dt){ct(this,Rt).add(Dt.annotationElementId),Dt.deleted=!0}isDeletedAnnotationElement(Dt){return ct(this,Rt).has(Dt)}removeDeletedAnnotationElement(Dt){ct(this,Rt).delete(Dt.annotationElementId),Dt.deleted=!1}setActiveEditor(Dt){ct(this,mt)!==Dt&&(Qt(this,mt,Dt),Dt&&Ht(this,zt,ur).call(this,Dt.propertiesToUpdate))}toggleSelected(Dt){if(ct(this,Nt).has(Dt)){ct(this,Nt).delete(Dt),Dt.unselect(),Ht(this,zt,Yn).call(this,{hasSelectedEditor:this.hasSelection});return}ct(this,Nt).add(Dt),Dt.select(),Ht(this,zt,ur).call(this,Dt.propertiesToUpdate),Ht(this,zt,Yn).call(this,{hasSelectedEditor:!0})}setSelected(Dt){for(const sn of ct(this,Nt))sn!==Dt&&sn.unselect();ct(this,Nt).clear(),ct(this,Nt).add(Dt),Dt.select(),Ht(this,zt,ur).call(this,Dt.propertiesToUpdate),Ht(this,zt,Yn).call(this,{hasSelectedEditor:!0})}isSelected(Dt){return ct(this,Nt).has(Dt)}unselect(Dt){Dt.unselect(),ct(this,Nt).delete(Dt),Ht(this,zt,Yn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return ct(this,Nt).size!==0}undo(){ct(this,Ot).undo(),Ht(this,zt,Yn).call(this,{hasSomethingToUndo:ct(this,Ot).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Ht(this,zt,dr).call(this)})}redo(){ct(this,Ot).redo(),Ht(this,zt,Yn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:ct(this,Ot).hasSomethingToRedo(),isEmpty:Ht(this,zt,dr).call(this)})}addCommands(Dt){ct(this,Ot).add(Dt),Ht(this,zt,Yn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Ht(this,zt,dr).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const Dt=[...ct(this,Nt)],sn=()=>{for(const Pn of Dt)Pn.remove()},yn=()=>{for(const Pn of Dt)Ht(this,zt,zr).call(this,Pn)};this.addCommands({cmd:sn,undo:yn,mustExec:!0})}commitOrRemove(){var Dt;(Dt=ct(this,mt))==null||Dt.commitOrRemove()}hasSomethingToControl(){return ct(this,mt)||this.hasSelection}selectAll(){for(const Dt of ct(this,Nt))Dt.commit();Ht(this,zt,Vr).call(this,ct(this,Et).values())}unselectAll(){if(ct(this,mt)){ct(this,mt).commitOrRemove();return}if(this.hasSelection){for(const Dt of ct(this,Nt))Dt.unselect();ct(this,Nt).clear(),Ht(this,zt,Yn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(Dt,sn,yn=!1){if(yn||this.commitOrRemove(),!this.hasSelection)return;ct(this,qt)[0]+=Dt,ct(this,qt)[1]+=sn;const[Pn,vn]=ct(this,qt),wn=[...ct(this,Nt)],Mt=1e3;ct(this,an)&&clearTimeout(ct(this,an)),Qt(this,an,setTimeout(()=>{Qt(this,an,null),ct(this,qt)[0]=ct(this,qt)[1]=0,this.addCommands({cmd:()=>{for(const kt of wn)ct(this,Et).has(kt.id)&&kt.translateInPage(Pn,vn)},undo:()=>{for(const kt of wn)ct(this,Et).has(kt.id)&&kt.translateInPage(-Pn,-vn)},mustExec:!1})},Mt));for(const kt of wn)kt.translateInPage(Dt,sn)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Qt(this,bt,new Map);for(const Dt of ct(this,Nt))ct(this,bt).set(Dt,{savedX:Dt.x,savedY:Dt.y,savedPageIndex:Dt.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!ct(this,bt))return!1;this.disableUserSelect(!1);const Dt=ct(this,bt);Qt(this,bt,null);let sn=!1;for(const[{x:Pn,y:vn,pageIndex:wn},Mt]of Dt)Mt.newX=Pn,Mt.newY=vn,Mt.newPageIndex=wn,sn||(sn=Pn!==Mt.savedX||vn!==Mt.savedY||wn!==Mt.savedPageIndex);if(!sn)return!1;const yn=(Pn,vn,wn,Mt)=>{if(ct(this,Et).has(Pn.id)){const kt=ct(this,Pt).get(Mt);kt?Pn._setParentAndPosition(kt,vn,wn):(Pn.pageIndex=Mt,Pn.x=vn,Pn.y=wn)}};return this.addCommands({cmd:()=>{for(const[Pn,{newX:vn,newY:wn,newPageIndex:Mt}]of Dt)yn(Pn,vn,wn,Mt)},undo:()=>{for(const[Pn,{savedX:vn,savedY:wn,savedPageIndex:Mt}]of Dt)yn(Pn,vn,wn,Mt)},mustExec:!0}),!0}dragSelectedEditors(Dt,sn){if(ct(this,bt))for(const yn of ct(this,bt).keys())yn.drag(Dt,sn)}rebuild(Dt){if(Dt.parent===null){const sn=this.getLayer(Dt.pageIndex);sn?(sn.changeParent(Dt),sn.addOrRebuild(Dt)):(this.addEditor(Dt),this.addToAnnotationStorage(Dt),Dt.rebuild())}else Dt.parent.addOrRebuild(Dt)}isActive(Dt){return ct(this,mt)===Dt}getActive(){return ct(this,mt)}getMode(){return ct(this,Lt)}get imageManager(){return(0,o.shadow)(this,"imageManager",new _)}};mt=new WeakMap,Et=new WeakMap,Pt=new WeakMap,jt=new WeakMap,St=new WeakMap,Ot=new WeakMap,Ct=new WeakMap,Rt=new WeakMap,bt=new WeakMap,Tt=new WeakMap,$t=new WeakMap,xt=new WeakMap,ft=new WeakMap,yt=new WeakMap,vt=new WeakMap,It=new WeakMap,Lt=new WeakMap,Nt=new WeakMap,Bt=new WeakMap,Kt=new WeakMap,rn=new WeakMap,nn=new WeakMap,on=new WeakMap,cn=new WeakMap,hn=new WeakMap,Zt=new WeakMap,Gt=new WeakMap,At=new WeakMap,Ft=new WeakMap,Vt=new WeakMap,qt=new WeakMap,an=new WeakMap,fn=new WeakMap,un=new WeakMap,zt=new WeakSet,xs=function(){window.addEventListener("focus",ct(this,rn)),window.addEventListener("blur",ct(this,Kt))},$r=function(){window.removeEventListener("focus",ct(this,rn)),window.removeEventListener("blur",ct(this,Kt))},Ur=function(){window.addEventListener("keydown",ct(this,hn),{capture:!0})},br=function(){window.removeEventListener("keydown",ct(this,hn),{capture:!0})},Br=function(){document.addEventListener("copy",ct(this,nn)),document.addEventListener("cut",ct(this,on)),document.addEventListener("paste",ct(this,cn))},Hr=function(){document.removeEventListener("copy",ct(this,nn)),document.removeEventListener("cut",ct(this,on)),document.removeEventListener("paste",ct(this,cn))},Yn=function(Dt){Object.entries(Dt).some(([yn,Pn])=>ct(this,Vt)[yn]!==Pn)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(ct(this,Vt),Dt)})},ur=function(Dt){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:Dt})},Es=function(){if(!ct(this,yt)){Qt(this,yt,!0);for(const Dt of ct(this,Pt).values())Dt.enable()}},Ss=function(){if(this.unselectAll(),ct(this,yt)){Qt(this,yt,!1);for(const Dt of ct(this,Pt).values())Dt.disable()}},zr=function(Dt){const sn=ct(this,Pt).get(Dt.pageIndex);sn?sn.addOrRebuild(Dt):this.addEditor(Dt)},dr=function(){if(ct(this,Et).size===0)return!0;if(ct(this,Et).size===1)for(const Dt of ct(this,Et).values())return Dt.isEmpty();return!1},Vr=function(Dt){ct(this,Nt).clear();for(const sn of Dt)sn.isEmpty()||(ct(this,Nt).add(sn),sn.select());Ht(this,zt,Yn).call(this,{hasSelectedEditor:!0})},Sn($n,"TRANSLATE_SMALL",1),Sn($n,"TRANSLATE_BIG",10);let _e=$n;e.AnnotationEditorUIManager=_e},(s,e,a)=>{var Ct,Rt,bt,Tt,$t,xt,ft,yt,vt,It,Lt,Nt,sr,ir,Wr,vr,wr,hr,fr;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=ut,e.getColorValues=Et,e.getCurrentTransform=Pt,e.getCurrentTransformInverse=jt,e.getFilenameFromUrl=nt,e.getPdfFilenameFromUrl=it,e.getRGB=mt,e.getXfaPageViewport=wt,e.isDataScheme=st,e.isPdfFile=rt,e.isValidFetchUrl=dt,e.loadScript=ht,e.noContextMenu=ot,e.setLayerDimensions=St;var o=a(7),c=a(1);const d="http://www.w3.org/2000/svg",Ot=class Ot{};Sn(Ot,"CSS",96),Sn(Ot,"PDF",72),Sn(Ot,"PDF_TO_CSS_UNITS",Ot.CSS/Ot.PDF);let h=Ot;e.PixelsPerInch=h;class g extends o.BaseFilterFactory{constructor({docId:At,ownerDocument:Ft=globalThis.document}={}){super();Yt(this,Nt);Yt(this,Ct);Yt(this,Rt);Yt(this,bt);Yt(this,Tt);Yt(this,$t);Yt(this,xt);Yt(this,ft);Yt(this,yt);Yt(this,vt);Yt(this,It);Yt(this,Lt,0);Qt(this,bt,At),Qt(this,Tt,Ft)}addFilter(At){if(!At)return"none";let Ft=ct(this,Nt,sr).get(At);if(Ft)return Ft;let Vt,qt,an,fn;if(At.length===1){const mn=At[0],Fn=new Array(256);for(let Ln=0;Ln<256;Ln++)Fn[Ln]=mn[Ln]/255;fn=Vt=qt=an=Fn.join(",")}else{const[mn,Fn,Ln]=At,Bn=new Array(256),An=new Array(256),In=new Array(256);for(let Un=0;Un<256;Un++)Bn[Un]=mn[Un]/255,An[Un]=Fn[Un]/255,In[Un]=Ln[Un]/255;Vt=Bn.join(","),qt=An.join(","),an=In.join(","),fn=`${Vt}${qt}${an}`}if(Ft=ct(this,Nt,sr).get(fn),Ft)return ct(this,Nt,sr).set(At,Ft),Ft;const un=`g_${ct(this,bt)}_transfer_map_${cr(this,Lt)._++}`,zt=`url(#${un})`;ct(this,Nt,sr).set(At,zt),ct(this,Nt,sr).set(fn,zt);const gn=Ht(this,Nt,vr).call(this,un);return Ht(this,Nt,hr).call(this,Vt,qt,an,gn),zt}addHCMFilter(At,Ft){var Fn;const Vt=`${At}-${Ft}`;if(ct(this,xt)===Vt)return ct(this,ft);if(Qt(this,xt,Vt),Qt(this,ft,"none"),(Fn=ct(this,$t))==null||Fn.remove(),!At||!Ft)return ct(this,ft);const qt=Ht(this,Nt,fr).call(this,At);At=c.Util.makeHexColor(...qt);const an=Ht(this,Nt,fr).call(this,Ft);if(Ft=c.Util.makeHexColor(...an),ct(this,Nt,ir).style.color="",At==="#000000"&&Ft==="#ffffff"||At===Ft)return ct(this,ft);const fn=new Array(256);for(let Ln=0;Ln<=255;Ln++){const Bn=Ln/255;fn[Ln]=Bn<=.03928?Bn/12.92:((Bn+.055)/1.055)**2.4}const un=fn.join(","),zt=`g_${ct(this,bt)}_hcm_filter`,gn=Qt(this,yt,Ht(this,Nt,vr).call(this,zt));Ht(this,Nt,hr).call(this,un,un,un,gn),Ht(this,Nt,Wr).call(this,gn);const mn=(Ln,Bn)=>{const An=qt[Ln]/255,In=an[Ln]/255,Un=new Array(Bn+1);for(let Hn=0;Hn<=Bn;Hn++)Un[Hn]=An+Hn/Bn*(In-An);return Un.join(",")};return Ht(this,Nt,hr).call(this,mn(0,5),mn(1,5),mn(2,5),gn),Qt(this,ft,`url(#${zt})`),ct(this,ft)}addHighlightHCMFilter(At,Ft,Vt,qt){var In;const an=`${At}-${Ft}-${Vt}-${qt}`;if(ct(this,vt)===an)return ct(this,It);if(Qt(this,vt,an),Qt(this,It,"none"),(In=ct(this,yt))==null||In.remove(),!At||!Ft)return ct(this,It);const[fn,un]=[At,Ft].map(Ht(this,Nt,fr).bind(this));let zt=Math.round(.2126*fn[0]+.7152*fn[1]+.0722*fn[2]),gn=Math.round(.2126*un[0]+.7152*un[1]+.0722*un[2]),[mn,Fn]=[Vt,qt].map(Ht(this,Nt,fr).bind(this));gn<zt&&([zt,gn,mn,Fn]=[gn,zt,Fn,mn]),ct(this,Nt,ir).style.color="";const Ln=(Un,Hn,ln)=>{const Xt=new Array(256),Jt=(gn-zt)/ln,xn=Un/255,$n=(Hn-Un)/(255*ln);let Dn=0;for(let Dt=0;Dt<=ln;Dt++){const sn=Math.round(zt+Dt*Jt),yn=xn+Dt*$n;for(let Pn=Dn;Pn<=sn;Pn++)Xt[Pn]=yn;Dn=sn+1}for(let Dt=Dn;Dt<256;Dt++)Xt[Dt]=Xt[Dn-1];return Xt.join(",")},Bn=`g_${ct(this,bt)}_hcm_highlight_filter`,An=Qt(this,yt,Ht(this,Nt,vr).call(this,Bn));return Ht(this,Nt,Wr).call(this,An),Ht(this,Nt,hr).call(this,Ln(mn[0],Fn[0],5),Ln(mn[1],Fn[1],5),Ln(mn[2],Fn[2],5),An),Qt(this,It,`url(#${Bn})`),ct(this,It)}destroy(At=!1){At&&(ct(this,ft)||ct(this,It))||(ct(this,Rt)&&(ct(this,Rt).parentNode.parentNode.remove(),Qt(this,Rt,null)),ct(this,Ct)&&(ct(this,Ct).clear(),Qt(this,Ct,null)),Qt(this,Lt,0))}}Ct=new WeakMap,Rt=new WeakMap,bt=new WeakMap,Tt=new WeakMap,$t=new WeakMap,xt=new WeakMap,ft=new WeakMap,yt=new WeakMap,vt=new WeakMap,It=new WeakMap,Lt=new WeakMap,Nt=new WeakSet,sr=function(){return ct(this,Ct)||Qt(this,Ct,new Map)},ir=function(){if(!ct(this,Rt)){const At=ct(this,Tt).createElement("div"),{style:Ft}=At;Ft.visibility="hidden",Ft.contain="strict",Ft.width=Ft.height=0,Ft.position="absolute",Ft.top=Ft.left=0,Ft.zIndex=-1;const Vt=ct(this,Tt).createElementNS(d,"svg");Vt.setAttribute("width",0),Vt.setAttribute("height",0),Qt(this,Rt,ct(this,Tt).createElementNS(d,"defs")),At.append(Vt),Vt.append(ct(this,Rt)),ct(this,Tt).body.append(At)}return ct(this,Rt)},Wr=function(At){const Ft=ct(this,Tt).createElementNS(d,"feColorMatrix");Ft.setAttribute("type","matrix"),Ft.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),At.append(Ft)},vr=function(At){const Ft=ct(this,Tt).createElementNS(d,"filter");return Ft.setAttribute("color-interpolation-filters","sRGB"),Ft.setAttribute("id",At),ct(this,Nt,ir).append(Ft),Ft},wr=function(At,Ft,Vt){const qt=ct(this,Tt).createElementNS(d,Ft);qt.setAttribute("type","discrete"),qt.setAttribute("tableValues",Vt),At.append(qt)},hr=function(At,Ft,Vt,qt){const an=ct(this,Tt).createElementNS(d,"feComponentTransfer");qt.append(an),Ht(this,Nt,wr).call(this,an,"feFuncR",At),Ht(this,Nt,wr).call(this,an,"feFuncG",Ft),Ht(this,Nt,wr).call(this,an,"feFuncB",Vt)},fr=function(At){return ct(this,Nt,ir).style.color=At,mt(getComputedStyle(ct(this,Nt,ir)).getPropertyValue("color"))},e.DOMFilterFactory=g;class _ extends o.BaseCanvasFactory{constructor({ownerDocument:Gt=globalThis.document}={}){super(),this._document=Gt}_createCanvas(Gt,At){const Ft=this._document.createElement("canvas");return Ft.width=Gt,Ft.height=At,Ft}}e.DOMCanvasFactory=_;async function b(Zt,Gt=!1){if(dt(Zt,document.baseURI)){const At=await fetch(Zt);if(!At.ok)throw new Error(At.statusText);return Gt?new Uint8Array(await At.arrayBuffer()):(0,c.stringToBytes)(await At.text())}return new Promise((At,Ft)=>{const Vt=new XMLHttpRequest;Vt.open("GET",Zt,!0),Gt&&(Vt.responseType="arraybuffer"),Vt.onreadystatechange=()=>{if(Vt.readyState===XMLHttpRequest.DONE){if(Vt.status===200||Vt.status===0){let qt;if(Gt&&Vt.response?qt=new Uint8Array(Vt.response):!Gt&&Vt.responseText&&(qt=(0,c.stringToBytes)(Vt.responseText)),qt){At(qt);return}}Ft(new Error(Vt.statusText))}},Vt.send(null)})}class j extends o.BaseCMapReaderFactory{_fetchData(Gt,At){return b(Gt,this.isCompressed).then(Ft=>({cMapData:Ft,compressionType:At}))}}e.DOMCMapReaderFactory=j;class $ extends o.BaseStandardFontDataFactory{_fetchData(Gt){return b(Gt,!0)}}e.DOMStandardFontDataFactory=$;class _e extends o.BaseSVGFactory{_createSVG(Gt){return document.createElementNS(d,Gt)}}e.DOMSVGFactory=_e;class tt{constructor({viewBox:Gt,scale:At,rotation:Ft,offsetX:Vt=0,offsetY:qt=0,dontFlip:an=!1}){this.viewBox=Gt,this.scale=At,this.rotation=Ft,this.offsetX=Vt,this.offsetY=qt;const fn=(Gt[2]+Gt[0])/2,un=(Gt[3]+Gt[1])/2;let zt,gn,mn,Fn;switch(Ft%=360,Ft<0&&(Ft+=360),Ft){case 180:zt=-1,gn=0,mn=0,Fn=1;break;case 90:zt=0,gn=1,mn=1,Fn=0;break;case 270:zt=0,gn=-1,mn=-1,Fn=0;break;case 0:zt=1,gn=0,mn=0,Fn=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}an&&(mn=-mn,Fn=-Fn);let Ln,Bn,An,In;zt===0?(Ln=Math.abs(un-Gt[1])*At+Vt,Bn=Math.abs(fn-Gt[0])*At+qt,An=(Gt[3]-Gt[1])*At,In=(Gt[2]-Gt[0])*At):(Ln=Math.abs(fn-Gt[0])*At+Vt,Bn=Math.abs(un-Gt[1])*At+qt,An=(Gt[2]-Gt[0])*At,In=(Gt[3]-Gt[1])*At),this.transform=[zt*At,gn*At,mn*At,Fn*At,Ln-zt*At*fn-mn*At*un,Bn-gn*At*fn-Fn*At*un],this.width=An,this.height=In}get rawDims(){const{viewBox:Gt}=this;return(0,c.shadow)(this,"rawDims",{pageWidth:Gt[2]-Gt[0],pageHeight:Gt[3]-Gt[1],pageX:Gt[0],pageY:Gt[1]})}clone({scale:Gt=this.scale,rotation:At=this.rotation,offsetX:Ft=this.offsetX,offsetY:Vt=this.offsetY,dontFlip:qt=!1}={}){return new tt({viewBox:this.viewBox.slice(),scale:Gt,rotation:At,offsetX:Ft,offsetY:Vt,dontFlip:qt})}convertToViewportPoint(Gt,At){return c.Util.applyTransform([Gt,At],this.transform)}convertToViewportRectangle(Gt){const At=c.Util.applyTransform([Gt[0],Gt[1]],this.transform),Ft=c.Util.applyTransform([Gt[2],Gt[3]],this.transform);return[At[0],At[1],Ft[0],Ft[1]]}convertToPdfPoint(Gt,At){return c.Util.applyInverseTransform([Gt,At],this.transform)}}e.PageViewport=tt;class et extends c.BaseException{constructor(Gt,At=0){super(Gt,"RenderingCancelledException"),this.extraDelay=At}}e.RenderingCancelledException=et;function st(Zt){const Gt=Zt.length;let At=0;for(;At<Gt&&Zt[At].trim()==="";)At++;return Zt.substring(At,At+5).toLowerCase()==="data:"}function rt(Zt){return typeof Zt=="string"&&/\.pdf$/i.test(Zt)}function nt(Zt,Gt=!1){return Gt||([Zt]=Zt.split(/[#?]/,1)),Zt.substring(Zt.lastIndexOf("/")+1)}function it(Zt,Gt="document.pdf"){if(typeof Zt!="string")return Gt;if(st(Zt))return(0,c.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Gt;const At=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,Ft=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Vt=At.exec(Zt);let qt=Ft.exec(Vt[1])||Ft.exec(Vt[2])||Ft.exec(Vt[3]);if(qt&&(qt=qt[0],qt.includes("%")))try{qt=Ft.exec(decodeURIComponent(qt))[0]}catch{}return qt||Gt}class at{constructor(){Sn(this,"started",Object.create(null));Sn(this,"times",[])}time(Gt){Gt in this.started&&(0,c.warn)(`Timer is already running for ${Gt}`),this.started[Gt]=Date.now()}timeEnd(Gt){Gt in this.started||(0,c.warn)(`Timer has not been started for ${Gt}`),this.times.push({name:Gt,start:this.started[Gt],end:Date.now()}),delete this.started[Gt]}toString(){const Gt=[];let At=0;for(const{name:Ft}of this.times)At=Math.max(Ft.length,At);for(const{name:Ft,start:Vt,end:qt}of this.times)Gt.push(`${Ft.padEnd(At)} ${qt-Vt}ms
`);return Gt.join("")}}e.StatTimer=at;function dt(Zt,Gt){try{const{protocol:At}=Gt?new URL(Zt,Gt):new URL(Zt);return At==="http:"||At==="https:"}catch{return!1}}function ot(Zt){Zt.preventDefault()}function ht(Zt,Gt=!1){return new Promise((At,Ft)=>{const Vt=document.createElement("script");Vt.src=Zt,Vt.onload=function(qt){Gt&&Vt.remove(),At(qt)},Vt.onerror=function(){Ft(new Error(`Cannot load script at: ${Vt.src}`))},(document.head||document.documentElement).append(Vt)})}function ut(Zt){console.log("Deprecated API usage: "+Zt)}let pt;class _t{static toDateObject(Gt){if(!Gt||typeof Gt!="string")return null;pt||(pt=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const At=pt.exec(Gt);if(!At)return null;const Ft=parseInt(At[1],10);let Vt=parseInt(At[2],10);Vt=Vt>=1&&Vt<=12?Vt-1:0;let qt=parseInt(At[3],10);qt=qt>=1&&qt<=31?qt:1;let an=parseInt(At[4],10);an=an>=0&&an<=23?an:0;let fn=parseInt(At[5],10);fn=fn>=0&&fn<=59?fn:0;let un=parseInt(At[6],10);un=un>=0&&un<=59?un:0;const zt=At[7]||"Z";let gn=parseInt(At[8],10);gn=gn>=0&&gn<=23?gn:0;let mn=parseInt(At[9],10)||0;return mn=mn>=0&&mn<=59?mn:0,zt==="-"?(an+=gn,fn+=mn):zt==="+"&&(an-=gn,fn-=mn),new Date(Date.UTC(Ft,Vt,qt,an,fn,un))}}e.PDFDateString=_t;function wt(Zt,{scale:Gt=1,rotation:At=0}){const{width:Ft,height:Vt}=Zt.attributes.style,qt=[0,0,parseInt(Ft),parseInt(Vt)];return new tt({viewBox:qt,scale:Gt,rotation:At})}function mt(Zt){if(Zt.startsWith("#")){const Gt=parseInt(Zt.slice(1),16);return[(Gt&16711680)>>16,(Gt&65280)>>8,Gt&255]}return Zt.startsWith("rgb(")?Zt.slice(4,-1).split(",").map(Gt=>parseInt(Gt)):Zt.startsWith("rgba(")?Zt.slice(5,-1).split(",").map(Gt=>parseInt(Gt)).slice(0,3):((0,c.warn)(`Not a valid color format: "${Zt}"`),[0,0,0])}function Et(Zt){const Gt=document.createElement("span");Gt.style.visibility="hidden",document.body.append(Gt);for(const At of Zt.keys()){Gt.style.color=At;const Ft=window.getComputedStyle(Gt).color;Zt.set(At,mt(Ft))}Gt.remove()}function Pt(Zt){const{a:Gt,b:At,c:Ft,d:Vt,e:qt,f:an}=Zt.getTransform();return[Gt,At,Ft,Vt,qt,an]}function jt(Zt){const{a:Gt,b:At,c:Ft,d:Vt,e:qt,f:an}=Zt.getTransform().invertSelf();return[Gt,At,Ft,Vt,qt,an]}function St(Zt,Gt,At=!1,Ft=!0){if(Gt instanceof tt){const{pageWidth:Vt,pageHeight:qt}=Gt.rawDims,{style:an}=Zt,fn=c.FeatureTest.isCSSRoundSupported,un=`var(--scale-factor) * ${Vt}px`,zt=`var(--scale-factor) * ${qt}px`,gn=fn?`round(${un}, 1px)`:`calc(${un})`,mn=fn?`round(${zt}, 1px)`:`calc(${zt})`;!At||Gt.rotation%180===0?(an.width=gn,an.height=mn):(an.width=mn,an.height=gn)}Ft&&Zt.setAttribute("data-main-rotation",Gt.rotation)}},(s,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var o=a(1);class c{constructor(){this.constructor===c&&(0,o.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(j){return"none"}addHCMFilter(j,$){return"none"}addHighlightHCMFilter(j,$,_e,tt){return"none"}destroy(j=!1){}}e.BaseFilterFactory=c;class d{constructor(){this.constructor===d&&(0,o.unreachable)("Cannot initialize BaseCanvasFactory.")}create(j,$){if(j<=0||$<=0)throw new Error("Invalid canvas size");const _e=this._createCanvas(j,$);return{canvas:_e,context:_e.getContext("2d")}}reset(j,$,_e){if(!j.canvas)throw new Error("Canvas is not specified");if($<=0||_e<=0)throw new Error("Invalid canvas size");j.canvas.width=$,j.canvas.height=_e}destroy(j){if(!j.canvas)throw new Error("Canvas is not specified");j.canvas.width=0,j.canvas.height=0,j.canvas=null,j.context=null}_createCanvas(j,$){(0,o.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=d;class h{constructor({baseUrl:j=null,isCompressed:$=!0}){this.constructor===h&&(0,o.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=j,this.isCompressed=$}async fetch({name:j}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!j)throw new Error("CMap name must be specified.");const $=this.baseUrl+j+(this.isCompressed?".bcmap":""),_e=this.isCompressed?o.CMapCompressionType.BINARY:o.CMapCompressionType.NONE;return this._fetchData($,_e).catch(tt=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${$}`)})}_fetchData(j,$){(0,o.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=h;class g{constructor({baseUrl:j=null}){this.constructor===g&&(0,o.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=j}async fetch({filename:j}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!j)throw new Error("Font filename must be specified.");const $=`${this.baseUrl}${j}`;return this._fetchData($).catch(_e=>{throw new Error(`Unable to load font data at: ${$}`)})}_fetchData(j){(0,o.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=g;class _{constructor(){this.constructor===_&&(0,o.unreachable)("Cannot initialize BaseSVGFactory.")}create(j,$,_e=!1){if(j<=0||$<=0)throw new Error("Invalid SVG dimensions");const tt=this._createSVG("svg:svg");return tt.setAttribute("version","1.1"),_e||(tt.setAttribute("width",`${j}px`),tt.setAttribute("height",`${$}px`)),tt.setAttribute("preserveAspectRatio","none"),tt.setAttribute("viewBox",`0 0 ${j} ${$}`),tt}createElement(j){if(typeof j!="string")throw new Error("Invalid SVG element type");return this._createSVG(j)}_createSVG(j){(0,o.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=_},(s,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var o=a(1);const c=3285377520,d=4294901760,h=65535;class g{constructor(b){this.h1=b?b&4294967295:c,this.h2=b?b&4294967295:c}update(b){let j,$;if(typeof b=="string"){j=new Uint8Array(b.length*2),$=0;for(let ut=0,pt=b.length;ut<pt;ut++){const _t=b.charCodeAt(ut);_t<=255?j[$++]=_t:(j[$++]=_t>>>8,j[$++]=_t&255)}}else if((0,o.isArrayBuffer)(b))j=b.slice(),$=j.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const _e=$>>2,tt=$-_e*4,et=new Uint32Array(j.buffer,0,_e);let st=0,rt=0,nt=this.h1,it=this.h2;const at=3432918353,dt=461845907,ot=at&h,ht=dt&h;for(let ut=0;ut<_e;ut++)ut&1?(st=et[ut],st=st*at&d|st*ot&h,st=st<<15|st>>>17,st=st*dt&d|st*ht&h,nt^=st,nt=nt<<13|nt>>>19,nt=nt*5+3864292196):(rt=et[ut],rt=rt*at&d|rt*ot&h,rt=rt<<15|rt>>>17,rt=rt*dt&d|rt*ht&h,it^=rt,it=it<<13|it>>>19,it=it*5+3864292196);switch(st=0,tt){case 3:st^=j[_e*4+2]<<16;case 2:st^=j[_e*4+1]<<8;case 1:st^=j[_e*4],st=st*at&d|st*ot&h,st=st<<15|st>>>17,st=st*dt&d|st*ht&h,_e&1?nt^=st:it^=st}this.h1=nt,this.h2=it}hexdigest(){let b=this.h1,j=this.h2;return b^=j>>>1,b=b*3981806797&d|b*36045&h,j=j*4283543511&d|((j<<16|b>>>16)*2950163797&d)>>>16,b^=j>>>1,b=b*444984403&d|b*60499&h,j=j*3301882366&d|((j<<16|b>>>16)*3120437893&d)>>>16,b^=j>>>1,(b>>>0).toString(16).padStart(8,"0")+(j>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=g},(s,e,a)=>{var h;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var o=a(1);class c{constructor({ownerDocument:_=globalThis.document,styleElement:b=null}){Yt(this,h,new Set);this._document=_,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(_){this.nativeFontFaces.add(_),this._document.fonts.add(_)}removeNativeFontFace(_){this.nativeFontFaces.delete(_),this._document.fonts.delete(_)}insertRule(_){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const b=this.styleElement.sheet;b.insertRule(_,b.cssRules.length)}clear(){for(const _ of this.nativeFontFaces)this._document.fonts.delete(_);this.nativeFontFaces.clear(),ct(this,h).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(_){if(!(!_||ct(this,h).has(_.loadedName))){if((0,o.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:b,src:j,style:$}=_,_e=new FontFace(b,j,$);this.addNativeFontFace(_e);try{await _e.load(),ct(this,h).add(b)}catch{(0,o.warn)(`Cannot load system font: ${_.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(_e)}return}(0,o.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(_){if(_.attached||_.missingFile&&!_.systemFontInfo)return;if(_.attached=!0,_.systemFontInfo){await this.loadSystemFont(_.systemFontInfo);return}if(this.isFontLoadingAPISupported){const j=_.createNativeFontFace();if(j){this.addNativeFontFace(j);try{await j.loaded}catch($){throw(0,o.warn)(`Failed to load font '${j.family}': '${$}'.`),_.disableFontFace=!0,$}}return}const b=_.createFontFaceRule();if(b){if(this.insertRule(b),this.isSyncFontLoadingSupported)return;await new Promise(j=>{const $=this._queueLoadingCallback(j);this._prepareFontLoadEvent(_,$)})}}get isFontLoadingAPISupported(){var b;const _=!!((b=this._document)!=null&&b.fonts);return(0,o.shadow)(this,"isFontLoadingAPISupported",_)}get isSyncFontLoadingSupported(){let _=!1;return(o.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(_=!0),(0,o.shadow)(this,"isSyncFontLoadingSupported",_)}_queueLoadingCallback(_){function b(){for((0,o.assert)(!$.done,"completeRequest() cannot be called twice."),$.done=!0;j.length>0&&j[0].done;){const _e=j.shift();setTimeout(_e.callback,0)}}const{loadingRequests:j}=this,$={done:!1,complete:b,callback:_};return j.push($),$}get _loadTestFont(){const _=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,o.shadow)(this,"_loadTestFont",_)}_prepareFontLoadEvent(_,b){function j(mt,Et){return mt.charCodeAt(Et)<<24|mt.charCodeAt(Et+1)<<16|mt.charCodeAt(Et+2)<<8|mt.charCodeAt(Et+3)&255}function $(mt,Et,Pt,jt){const St=mt.substring(0,Et),Ot=mt.substring(Et+Pt);return St+jt+Ot}let _e,tt;const et=this._document.createElement("canvas");et.width=1,et.height=1;const st=et.getContext("2d");let rt=0;function nt(mt,Et){if(++rt>30){(0,o.warn)("Load test font never loaded."),Et();return}if(st.font="30px "+mt,st.fillText(".",0,20),st.getImageData(0,0,1,1).data[3]>0){Et();return}setTimeout(nt.bind(null,mt,Et))}const it=`lt${Date.now()}${this.loadTestFontId++}`;let at=this._loadTestFont;at=$(at,976,it.length,it);const ot=16,ht=1482184792;let ut=j(at,ot);for(_e=0,tt=it.length-3;_e<tt;_e+=4)ut=ut-ht+j(it,_e)|0;_e<it.length&&(ut=ut-ht+j(it+"XXX",_e)|0),at=$(at,ot,4,(0,o.string32)(ut));const pt=`url(data:font/opentype;base64,${btoa(at)});`,_t=`@font-face {font-family:"${it}";src:${pt}}`;this.insertRule(_t);const wt=this._document.createElement("div");wt.style.visibility="hidden",wt.style.width=wt.style.height="10px",wt.style.position="absolute",wt.style.top=wt.style.left="0px";for(const mt of[_.loadedName,it]){const Et=this._document.createElement("span");Et.textContent="Hi",Et.style.fontFamily=mt,wt.append(Et)}this._document.body.append(wt),nt(it,()=>{wt.remove(),b.complete()})}}h=new WeakMap,e.FontLoader=c;class d{constructor(_,{isEvalSupported:b=!0,disableFontFace:j=!1,ignoreErrors:$=!1,inspectFont:_e=null}){this.compiledGlyphs=Object.create(null);for(const tt in _)this[tt]=_[tt];this.isEvalSupported=b!==!1,this.disableFontFace=j===!0,this.ignoreErrors=$===!0,this._inspectFont=_e}createNativeFontFace(){var b;if(!this.data||this.disableFontFace)return null;let _;if(!this.cssFontInfo)_=new FontFace(this.loadedName,this.data,{});else{const j={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(j.style=`oblique ${this.cssFontInfo.italicAngle}deg`),_=new FontFace(this.cssFontInfo.fontFamily,this.data,j)}return(b=this._inspectFont)==null||b.call(this,this),_}createFontFaceRule(){var $;if(!this.data||this.disableFontFace)return null;const _=(0,o.bytesToString)(this.data),b=`url(data:${this.mimetype};base64,${btoa(_)});`;let j;if(!this.cssFontInfo)j=`@font-face {font-family:"${this.loadedName}";src:${b}}`;else{let _e=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(_e+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),j=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${_e}src:${b}}`}return($=this._inspectFont)==null||$.call(this,this,b),j}getPathGenerator(_,b){if(this.compiledGlyphs[b]!==void 0)return this.compiledGlyphs[b];let j;try{j=_.get(this.loadedName+"_path_"+b)}catch($){if(!this.ignoreErrors)throw $;return(0,o.warn)(`getPathGenerator - ignoring character: "${$}".`),this.compiledGlyphs[b]=function(_e,tt){}}if(this.isEvalSupported&&o.FeatureTest.isEvalSupported){const $=[];for(const _e of j){const tt=_e.args!==void 0?_e.args.join(","):"";$.push("c.",_e.cmd,"(",tt,`);
`)}return this.compiledGlyphs[b]=new Function("c","size",$.join(""))}return this.compiledGlyphs[b]=function($,_e){for(const tt of j)tt.cmd==="scale"&&(tt.args=[_e,-_e]),$[tt.cmd].apply($,tt.args)}}}e.FontFaceObject=d},(s,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var o=a(7);a(1);const c=function(b){return new Promise((j,$)=>{require$$5.readFile(b,(tt,et)=>{if(tt||!et){$(new Error(tt));return}j(new Uint8Array(et))})})};class d extends o.BaseFilterFactory{}e.NodeFilterFactory=d;class h extends o.BaseCanvasFactory{_createCanvas(j,$){return require$$5.createCanvas(j,$)}}e.NodeCanvasFactory=h;class g extends o.BaseCMapReaderFactory{_fetchData(j,$){return c(j).then(_e=>({cMapData:_e,compressionType:$}))}}e.NodeCMapReaderFactory=g;class _ extends o.BaseStandardFontDataFactory{_fetchData(j){return c(j)}}e.NodeStandardFontDataFactory=_},(s,e,a)=>{var Rt,Zr,Gr;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var o=a(1),c=a(6),d=a(12),h=a(13);const g=16,_=100,b=4096,j=15,$=10,_e=1e3,tt=16;function et(xt,ft){if(xt._removeMirroring)throw new Error("Context is already forwarding operations.");xt.__originalSave=xt.save,xt.__originalRestore=xt.restore,xt.__originalRotate=xt.rotate,xt.__originalScale=xt.scale,xt.__originalTranslate=xt.translate,xt.__originalTransform=xt.transform,xt.__originalSetTransform=xt.setTransform,xt.__originalResetTransform=xt.resetTransform,xt.__originalClip=xt.clip,xt.__originalMoveTo=xt.moveTo,xt.__originalLineTo=xt.lineTo,xt.__originalBezierCurveTo=xt.bezierCurveTo,xt.__originalRect=xt.rect,xt.__originalClosePath=xt.closePath,xt.__originalBeginPath=xt.beginPath,xt._removeMirroring=()=>{xt.save=xt.__originalSave,xt.restore=xt.__originalRestore,xt.rotate=xt.__originalRotate,xt.scale=xt.__originalScale,xt.translate=xt.__originalTranslate,xt.transform=xt.__originalTransform,xt.setTransform=xt.__originalSetTransform,xt.resetTransform=xt.__originalResetTransform,xt.clip=xt.__originalClip,xt.moveTo=xt.__originalMoveTo,xt.lineTo=xt.__originalLineTo,xt.bezierCurveTo=xt.__originalBezierCurveTo,xt.rect=xt.__originalRect,xt.closePath=xt.__originalClosePath,xt.beginPath=xt.__originalBeginPath,delete xt._removeMirroring},xt.save=function(){ft.save(),this.__originalSave()},xt.restore=function(){ft.restore(),this.__originalRestore()},xt.translate=function(vt,It){ft.translate(vt,It),this.__originalTranslate(vt,It)},xt.scale=function(vt,It){ft.scale(vt,It),this.__originalScale(vt,It)},xt.transform=function(vt,It,Lt,Nt,Bt,Kt){ft.transform(vt,It,Lt,Nt,Bt,Kt),this.__originalTransform(vt,It,Lt,Nt,Bt,Kt)},xt.setTransform=function(vt,It,Lt,Nt,Bt,Kt){ft.setTransform(vt,It,Lt,Nt,Bt,Kt),this.__originalSetTransform(vt,It,Lt,Nt,Bt,Kt)},xt.resetTransform=function(){ft.resetTransform(),this.__originalResetTransform()},xt.rotate=function(vt){ft.rotate(vt),this.__originalRotate(vt)},xt.clip=function(vt){ft.clip(vt),this.__originalClip(vt)},xt.moveTo=function(yt,vt){ft.moveTo(yt,vt),this.__originalMoveTo(yt,vt)},xt.lineTo=function(yt,vt){ft.lineTo(yt,vt),this.__originalLineTo(yt,vt)},xt.bezierCurveTo=function(yt,vt,It,Lt,Nt,Bt){ft.bezierCurveTo(yt,vt,It,Lt,Nt,Bt),this.__originalBezierCurveTo(yt,vt,It,Lt,Nt,Bt)},xt.rect=function(yt,vt,It,Lt){ft.rect(yt,vt,It,Lt),this.__originalRect(yt,vt,It,Lt)},xt.closePath=function(){ft.closePath(),this.__originalClosePath()},xt.beginPath=function(){ft.beginPath(),this.__originalBeginPath()}}class st{constructor(ft){this.canvasFactory=ft,this.cache=Object.create(null)}getCanvas(ft,yt,vt){let It;return this.cache[ft]!==void 0?(It=this.cache[ft],this.canvasFactory.reset(It,yt,vt)):(It=this.canvasFactory.create(yt,vt),this.cache[ft]=It),It}delete(ft){delete this.cache[ft]}clear(){for(const ft in this.cache){const yt=this.cache[ft];this.canvasFactory.destroy(yt),delete this.cache[ft]}}}function rt(xt,ft,yt,vt,It,Lt,Nt,Bt,Kt,rn){const[nn,on,cn,hn,Zt,Gt]=(0,c.getCurrentTransform)(xt);if(on===0&&cn===0){const Vt=Nt*nn+Zt,qt=Math.round(Vt),an=Bt*hn+Gt,fn=Math.round(an),un=(Nt+Kt)*nn+Zt,zt=Math.abs(Math.round(un)-qt)||1,gn=(Bt+rn)*hn+Gt,mn=Math.abs(Math.round(gn)-fn)||1;return xt.setTransform(Math.sign(nn),0,0,Math.sign(hn),qt,fn),xt.drawImage(ft,yt,vt,It,Lt,0,0,zt,mn),xt.setTransform(nn,on,cn,hn,Zt,Gt),[zt,mn]}if(nn===0&&hn===0){const Vt=Bt*cn+Zt,qt=Math.round(Vt),an=Nt*on+Gt,fn=Math.round(an),un=(Bt+rn)*cn+Zt,zt=Math.abs(Math.round(un)-qt)||1,gn=(Nt+Kt)*on+Gt,mn=Math.abs(Math.round(gn)-fn)||1;return xt.setTransform(0,Math.sign(on),Math.sign(cn),0,qt,fn),xt.drawImage(ft,yt,vt,It,Lt,0,0,mn,zt),xt.setTransform(nn,on,cn,hn,Zt,Gt),[mn,zt]}xt.drawImage(ft,yt,vt,It,Lt,Nt,Bt,Kt,rn);const At=Math.hypot(nn,on),Ft=Math.hypot(cn,hn);return[At*Kt,Ft*rn]}function nt(xt){const{width:ft,height:yt}=xt;if(ft>_e||yt>_e)return null;const vt=1e3,It=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),Lt=ft+1;let Nt=new Uint8Array(Lt*(yt+1)),Bt,Kt,rn;const nn=ft+7&-8;let on=new Uint8Array(nn*yt),cn=0;for(const Ft of xt.data){let Vt=128;for(;Vt>0;)on[cn++]=Ft&Vt?0:255,Vt>>=1}let hn=0;for(cn=0,on[cn]!==0&&(Nt[0]=1,++hn),Kt=1;Kt<ft;Kt++)on[cn]!==on[cn+1]&&(Nt[Kt]=on[cn]?2:1,++hn),cn++;for(on[cn]!==0&&(Nt[Kt]=2,++hn),Bt=1;Bt<yt;Bt++){cn=Bt*nn,rn=Bt*Lt,on[cn-nn]!==on[cn]&&(Nt[rn]=on[cn]?1:8,++hn);let Ft=(on[cn]?4:0)+(on[cn-nn]?8:0);for(Kt=1;Kt<ft;Kt++)Ft=(Ft>>2)+(on[cn+1]?4:0)+(on[cn-nn+1]?8:0),It[Ft]&&(Nt[rn+Kt]=It[Ft],++hn),cn++;if(on[cn-nn]!==on[cn]&&(Nt[rn+Kt]=on[cn]?2:4,++hn),hn>vt)return null}for(cn=nn*(yt-1),rn=Bt*Lt,on[cn]!==0&&(Nt[rn]=8,++hn),Kt=1;Kt<ft;Kt++)on[cn]!==on[cn+1]&&(Nt[rn+Kt]=on[cn]?4:8,++hn),cn++;if(on[cn]!==0&&(Nt[rn+Kt]=4,++hn),hn>vt)return null;const Zt=new Int32Array([0,Lt,-1,0,-Lt,0,0,0,1]),Gt=new Path2D;for(Bt=0;hn&&Bt<=yt;Bt++){let Ft=Bt*Lt;const Vt=Ft+ft;for(;Ft<Vt&&!Nt[Ft];)Ft++;if(Ft===Vt)continue;Gt.moveTo(Ft%Lt,Bt);const qt=Ft;let an=Nt[Ft];do{const fn=Zt[an];do Ft+=fn;while(!Nt[Ft]);const un=Nt[Ft];un!==5&&un!==10?(an=un,Nt[Ft]=0):(an=un&51*an>>4,Nt[Ft]&=an>>2|an<<2),Gt.lineTo(Ft%Lt,Ft/Lt|0),Nt[Ft]||--hn}while(qt!==Ft);--Bt}return on=null,Nt=null,function(Ft){Ft.save(),Ft.scale(1/ft,-1/yt),Ft.translate(0,-yt),Ft.fill(Gt),Ft.beginPath(),Ft.restore()}}class it{constructor(ft,yt){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=o.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=o.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=o.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,ft,yt])}clone(){const ft=Object.create(this);return ft.clipBox=this.clipBox.slice(),ft}setCurrentPoint(ft,yt){this.x=ft,this.y=yt}updatePathMinMax(ft,yt,vt){[yt,vt]=o.Util.applyTransform([yt,vt],ft),this.minX=Math.min(this.minX,yt),this.minY=Math.min(this.minY,vt),this.maxX=Math.max(this.maxX,yt),this.maxY=Math.max(this.maxY,vt)}updateRectMinMax(ft,yt){const vt=o.Util.applyTransform(yt,ft),It=o.Util.applyTransform(yt.slice(2),ft);this.minX=Math.min(this.minX,vt[0],It[0]),this.minY=Math.min(this.minY,vt[1],It[1]),this.maxX=Math.max(this.maxX,vt[0],It[0]),this.maxY=Math.max(this.maxY,vt[1],It[1])}updateScalingPathMinMax(ft,yt){o.Util.scaleMinMax(ft,yt),this.minX=Math.min(this.minX,yt[0]),this.maxX=Math.max(this.maxX,yt[1]),this.minY=Math.min(this.minY,yt[2]),this.maxY=Math.max(this.maxY,yt[3])}updateCurvePathMinMax(ft,yt,vt,It,Lt,Nt,Bt,Kt,rn,nn){const on=o.Util.bezierBoundingBox(yt,vt,It,Lt,Nt,Bt,Kt,rn);if(nn){nn[0]=Math.min(nn[0],on[0],on[2]),nn[1]=Math.max(nn[1],on[0],on[2]),nn[2]=Math.min(nn[2],on[1],on[3]),nn[3]=Math.max(nn[3],on[1],on[3]);return}this.updateRectMinMax(ft,on)}getPathBoundingBox(ft=d.PathType.FILL,yt=null){const vt=[this.minX,this.minY,this.maxX,this.maxY];if(ft===d.PathType.STROKE){yt||(0,o.unreachable)("Stroke bounding box must include transform.");const It=o.Util.singularValueDecompose2dScale(yt),Lt=It[0]*this.lineWidth/2,Nt=It[1]*this.lineWidth/2;vt[0]-=Lt,vt[1]-=Nt,vt[2]+=Lt,vt[3]+=Nt}return vt}updateClipFromPath(){const ft=o.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(ft||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(ft){this.clipBox=ft,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(ft=d.PathType.FILL,yt=null){return o.Util.intersect(this.clipBox,this.getPathBoundingBox(ft,yt))}}function at(xt,ft){if(typeof ImageData<"u"&&ft instanceof ImageData){xt.putImageData(ft,0,0);return}const yt=ft.height,vt=ft.width,It=yt%tt,Lt=(yt-It)/tt,Nt=It===0?Lt:Lt+1,Bt=xt.createImageData(vt,tt);let Kt=0,rn;const nn=ft.data,on=Bt.data;let cn,hn,Zt,Gt;if(ft.kind===o.ImageKind.GRAYSCALE_1BPP){const At=nn.byteLength,Ft=new Uint32Array(on.buffer,0,on.byteLength>>2),Vt=Ft.length,qt=vt+7>>3,an=4294967295,fn=o.FeatureTest.isLittleEndian?4278190080:255;for(cn=0;cn<Nt;cn++){for(Zt=cn<Lt?tt:It,rn=0,hn=0;hn<Zt;hn++){const un=At-Kt;let zt=0;const gn=un>qt?vt:un*8-7,mn=gn&-8;let Fn=0,Ln=0;for(;zt<mn;zt+=8)Ln=nn[Kt++],Ft[rn++]=Ln&128?an:fn,Ft[rn++]=Ln&64?an:fn,Ft[rn++]=Ln&32?an:fn,Ft[rn++]=Ln&16?an:fn,Ft[rn++]=Ln&8?an:fn,Ft[rn++]=Ln&4?an:fn,Ft[rn++]=Ln&2?an:fn,Ft[rn++]=Ln&1?an:fn;for(;zt<gn;zt++)Fn===0&&(Ln=nn[Kt++],Fn=128),Ft[rn++]=Ln&Fn?an:fn,Fn>>=1}for(;rn<Vt;)Ft[rn++]=0;xt.putImageData(Bt,0,cn*tt)}}else if(ft.kind===o.ImageKind.RGBA_32BPP){for(hn=0,Gt=vt*tt*4,cn=0;cn<Lt;cn++)on.set(nn.subarray(Kt,Kt+Gt)),Kt+=Gt,xt.putImageData(Bt,0,hn),hn+=tt;cn<Nt&&(Gt=vt*It*4,on.set(nn.subarray(Kt,Kt+Gt)),xt.putImageData(Bt,0,hn))}else if(ft.kind===o.ImageKind.RGB_24BPP)for(Zt=tt,Gt=vt*Zt,cn=0;cn<Nt;cn++){for(cn>=Lt&&(Zt=It,Gt=vt*Zt),rn=0,hn=Gt;hn--;)on[rn++]=nn[Kt++],on[rn++]=nn[Kt++],on[rn++]=nn[Kt++],on[rn++]=255;xt.putImageData(Bt,0,cn*tt)}else throw new Error(`bad image kind: ${ft.kind}`)}function dt(xt,ft){if(ft.bitmap){xt.drawImage(ft.bitmap,0,0);return}const yt=ft.height,vt=ft.width,It=yt%tt,Lt=(yt-It)/tt,Nt=It===0?Lt:Lt+1,Bt=xt.createImageData(vt,tt);let Kt=0;const rn=ft.data,nn=Bt.data;for(let on=0;on<Nt;on++){const cn=on<Lt?tt:It;({srcPos:Kt}=(0,h.convertBlackAndWhiteToRGBA)({src:rn,srcPos:Kt,dest:nn,width:vt,height:cn,nonBlackColor:0})),xt.putImageData(Bt,0,on*tt)}}function ot(xt,ft){const yt=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const vt of yt)xt[vt]!==void 0&&(ft[vt]=xt[vt]);xt.setLineDash!==void 0&&(ft.setLineDash(xt.getLineDash()),ft.lineDashOffset=xt.lineDashOffset)}function ht(xt){if(xt.strokeStyle=xt.fillStyle="#000000",xt.fillRule="nonzero",xt.globalAlpha=1,xt.lineWidth=1,xt.lineCap="butt",xt.lineJoin="miter",xt.miterLimit=10,xt.globalCompositeOperation="source-over",xt.font="10px sans-serif",xt.setLineDash!==void 0&&(xt.setLineDash([]),xt.lineDashOffset=0),!o.isNodeJS){const{filter:ft}=xt;ft!=="none"&&ft!==""&&(xt.filter="none")}}function ut(xt,ft,yt,vt){const It=xt.length;for(let Lt=3;Lt<It;Lt+=4){const Nt=xt[Lt];if(Nt===0)xt[Lt-3]=ft,xt[Lt-2]=yt,xt[Lt-1]=vt;else if(Nt<255){const Bt=255-Nt;xt[Lt-3]=xt[Lt-3]*Nt+ft*Bt>>8,xt[Lt-2]=xt[Lt-2]*Nt+yt*Bt>>8,xt[Lt-1]=xt[Lt-1]*Nt+vt*Bt>>8}}}function pt(xt,ft,yt){const vt=xt.length,It=1/255;for(let Lt=3;Lt<vt;Lt+=4){const Nt=yt?yt[xt[Lt]]:xt[Lt];ft[Lt]=ft[Lt]*Nt*It|0}}function _t(xt,ft,yt){const vt=xt.length;for(let It=3;It<vt;It+=4){const Lt=xt[It-3]*77+xt[It-2]*152+xt[It-1]*28;ft[It]=yt?ft[It]*yt[Lt>>8]>>8:ft[It]*Lt>>16}}function wt(xt,ft,yt,vt,It,Lt,Nt,Bt,Kt,rn,nn){const on=!!Lt,cn=on?Lt[0]:0,hn=on?Lt[1]:0,Zt=on?Lt[2]:0,Gt=It==="Luminosity"?_t:pt,Ft=Math.min(vt,Math.ceil(1048576/yt));for(let Vt=0;Vt<vt;Vt+=Ft){const qt=Math.min(Ft,vt-Vt),an=xt.getImageData(Bt-rn,Vt+(Kt-nn),yt,qt),fn=ft.getImageData(Bt,Vt+Kt,yt,qt);on&&ut(an.data,cn,hn,Zt),Gt(an.data,fn.data,Nt),ft.putImageData(fn,Bt,Vt+Kt)}}function mt(xt,ft,yt,vt){const It=vt[0],Lt=vt[1],Nt=vt[2]-It,Bt=vt[3]-Lt;Nt===0||Bt===0||(wt(ft.context,yt,Nt,Bt,ft.subtype,ft.backdrop,ft.transferMap,It,Lt,ft.offsetX,ft.offsetY),xt.save(),xt.globalAlpha=1,xt.globalCompositeOperation="source-over",xt.setTransform(1,0,0,1,0,0),xt.drawImage(yt.canvas,0,0),xt.restore())}function Et(xt,ft){const yt=o.Util.singularValueDecompose2dScale(xt);yt[0]=Math.fround(yt[0]),yt[1]=Math.fround(yt[1]);const vt=Math.fround((globalThis.devicePixelRatio||1)*c.PixelsPerInch.PDF_TO_CSS_UNITS);return ft!==void 0?ft:yt[0]<=vt||yt[1]<=vt}const Pt=["butt","round","square"],jt=["miter","round","bevel"],St={},Ot={},$t=class $t{constructor(ft,yt,vt,It,Lt,{optionalContentConfig:Nt,markedContentStack:Bt=null},Kt,rn){Yt(this,Rt);this.ctx=ft,this.current=new it(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=yt,this.objs=vt,this.canvasFactory=It,this.filterFactory=Lt,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=Bt||[],this.optionalContentConfig=Nt,this.cachedCanvases=new st(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=Kt,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=rn,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(ft,yt=null){return typeof ft=="string"?ft.startsWith("g_")?this.commonObjs.get(ft):this.objs.get(ft):yt}beginDrawing({transform:ft,viewport:yt,transparency:vt=!1,background:It=null}){const Lt=this.ctx.canvas.width,Nt=this.ctx.canvas.height,Bt=this.ctx.fillStyle;if(this.ctx.fillStyle=It||"#ffffff",this.ctx.fillRect(0,0,Lt,Nt),this.ctx.fillStyle=Bt,vt){const Kt=this.cachedCanvases.getCanvas("transparent",Lt,Nt);this.compositeCtx=this.ctx,this.transparentCanvas=Kt.canvas,this.ctx=Kt.context,this.ctx.save(),this.ctx.transform(...(0,c.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),ht(this.ctx),ft&&(this.ctx.transform(...ft),this.outputScaleX=ft[0],this.outputScaleY=ft[0]),this.ctx.transform(...yt.transform),this.viewportScale=yt.scale,this.baseTransform=(0,c.getCurrentTransform)(this.ctx)}executeOperatorList(ft,yt,vt,It){const Lt=ft.argsArray,Nt=ft.fnArray;let Bt=yt||0;const Kt=Lt.length;if(Kt===Bt)return Bt;const rn=Kt-Bt>$&&typeof vt=="function",nn=rn?Date.now()+j:0;let on=0;const cn=this.commonObjs,hn=this.objs;let Zt;for(;;){if(It!==void 0&&Bt===It.nextBreakPoint)return It.breakIt(Bt,vt),Bt;if(Zt=Nt[Bt],Zt!==o.OPS.dependency)this[Zt].apply(this,Lt[Bt]);else for(const Gt of Lt[Bt]){const At=Gt.startsWith("g_")?cn:hn;if(!At.has(Gt))return At.get(Gt,vt),Bt}if(Bt++,Bt===Kt)return Bt;if(rn&&++on>$){if(Date.now()>nn)return vt(),Bt;on=0}}}endDrawing(){Ht(this,Rt,Zr).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const ft of this._cachedBitmapsMap.values()){for(const yt of ft.values())typeof HTMLCanvasElement<"u"&&yt instanceof HTMLCanvasElement&&(yt.width=yt.height=0);ft.clear()}this._cachedBitmapsMap.clear(),Ht(this,Rt,Gr).call(this)}_scaleImage(ft,yt){const vt=ft.width,It=ft.height;let Lt=Math.max(Math.hypot(yt[0],yt[1]),1),Nt=Math.max(Math.hypot(yt[2],yt[3]),1),Bt=vt,Kt=It,rn="prescale1",nn,on;for(;Lt>2&&Bt>1||Nt>2&&Kt>1;){let cn=Bt,hn=Kt;Lt>2&&Bt>1&&(cn=Bt>=16384?Math.floor(Bt/2)-1||1:Math.ceil(Bt/2),Lt/=Bt/cn),Nt>2&&Kt>1&&(hn=Kt>=16384?Math.floor(Kt/2)-1||1:Math.ceil(Kt)/2,Nt/=Kt/hn),nn=this.cachedCanvases.getCanvas(rn,cn,hn),on=nn.context,on.clearRect(0,0,cn,hn),on.drawImage(ft,0,0,Bt,Kt,0,0,cn,hn),ft=nn.canvas,Bt=cn,Kt=hn,rn=rn==="prescale1"?"prescale2":"prescale1"}return{img:ft,paintWidth:Bt,paintHeight:Kt}}_createMaskCanvas(ft){const yt=this.ctx,{width:vt,height:It}=ft,Lt=this.current.fillColor,Nt=this.current.patternFill,Bt=(0,c.getCurrentTransform)(yt);let Kt,rn,nn,on;if((ft.bitmap||ft.data)&&ft.count>1){const zt=ft.bitmap||ft.data.buffer;rn=JSON.stringify(Nt?Bt:[Bt.slice(0,4),Lt]),Kt=this._cachedBitmapsMap.get(zt),Kt||(Kt=new Map,this._cachedBitmapsMap.set(zt,Kt));const gn=Kt.get(rn);if(gn&&!Nt){const mn=Math.round(Math.min(Bt[0],Bt[2])+Bt[4]),Fn=Math.round(Math.min(Bt[1],Bt[3])+Bt[5]);return{canvas:gn,offsetX:mn,offsetY:Fn}}nn=gn}nn||(on=this.cachedCanvases.getCanvas("maskCanvas",vt,It),dt(on.context,ft));let cn=o.Util.transform(Bt,[1/vt,0,0,-1/It,0,0]);cn=o.Util.transform(cn,[1,0,0,1,0,-It]);const hn=o.Util.applyTransform([0,0],cn),Zt=o.Util.applyTransform([vt,It],cn),Gt=o.Util.normalizeRect([hn[0],hn[1],Zt[0],Zt[1]]),At=Math.round(Gt[2]-Gt[0])||1,Ft=Math.round(Gt[3]-Gt[1])||1,Vt=this.cachedCanvases.getCanvas("fillCanvas",At,Ft),qt=Vt.context,an=Math.min(hn[0],Zt[0]),fn=Math.min(hn[1],Zt[1]);qt.translate(-an,-fn),qt.transform(...cn),nn||(nn=this._scaleImage(on.canvas,(0,c.getCurrentTransformInverse)(qt)),nn=nn.img,Kt&&Nt&&Kt.set(rn,nn)),qt.imageSmoothingEnabled=Et((0,c.getCurrentTransform)(qt),ft.interpolate),rt(qt,nn,0,0,nn.width,nn.height,0,0,vt,It),qt.globalCompositeOperation="source-in";const un=o.Util.transform((0,c.getCurrentTransformInverse)(qt),[1,0,0,1,-an,-fn]);return qt.fillStyle=Nt?Lt.getPattern(yt,this,un,d.PathType.FILL):Lt,qt.fillRect(0,0,vt,It),Kt&&!Nt&&(this.cachedCanvases.delete("fillCanvas"),Kt.set(rn,Vt.canvas)),{canvas:Vt.canvas,offsetX:Math.round(an),offsetY:Math.round(fn)}}setLineWidth(ft){ft!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=ft,this.ctx.lineWidth=ft}setLineCap(ft){this.ctx.lineCap=Pt[ft]}setLineJoin(ft){this.ctx.lineJoin=jt[ft]}setMiterLimit(ft){this.ctx.miterLimit=ft}setDash(ft,yt){const vt=this.ctx;vt.setLineDash!==void 0&&(vt.setLineDash(ft),vt.lineDashOffset=yt)}setRenderingIntent(ft){}setFlatness(ft){}setGState(ft){for(const[yt,vt]of ft)switch(yt){case"LW":this.setLineWidth(vt);break;case"LC":this.setLineCap(vt);break;case"LJ":this.setLineJoin(vt);break;case"ML":this.setMiterLimit(vt);break;case"D":this.setDash(vt[0],vt[1]);break;case"RI":this.setRenderingIntent(vt);break;case"FL":this.setFlatness(vt);break;case"Font":this.setFont(vt[0],vt[1]);break;case"CA":this.current.strokeAlpha=vt;break;case"ca":this.current.fillAlpha=vt,this.ctx.globalAlpha=vt;break;case"BM":this.ctx.globalCompositeOperation=vt;break;case"SMask":this.current.activeSMask=vt?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(vt);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const ft=this.inSMaskMode;this.current.activeSMask&&!ft?this.beginSMaskMode():!this.current.activeSMask&&ft&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const ft=this.ctx.canvas.width,yt=this.ctx.canvas.height,vt="smaskGroupAt"+this.groupLevel,It=this.cachedCanvases.getCanvas(vt,ft,yt);this.suspendedCtx=this.ctx,this.ctx=It.context;const Lt=this.ctx;Lt.setTransform(...(0,c.getCurrentTransform)(this.suspendedCtx)),ot(this.suspendedCtx,Lt),et(Lt,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),ot(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(ft){if(!this.current.activeSMask)return;ft?(ft[0]=Math.floor(ft[0]),ft[1]=Math.floor(ft[1]),ft[2]=Math.ceil(ft[2]),ft[3]=Math.ceil(ft[3])):ft=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const yt=this.current.activeSMask,vt=this.suspendedCtx;mt(vt,yt,this.ctx,ft),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(ot(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const ft=this.current;this.stateStack.push(ft),this.current=ft.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),ot(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(ft,yt,vt,It,Lt,Nt){this.ctx.transform(ft,yt,vt,It,Lt,Nt),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(ft,yt,vt){const It=this.ctx,Lt=this.current;let Nt=Lt.x,Bt=Lt.y,Kt,rn;const nn=(0,c.getCurrentTransform)(It),on=nn[0]===0&&nn[3]===0||nn[1]===0&&nn[2]===0,cn=on?vt.slice(0):null;for(let hn=0,Zt=0,Gt=ft.length;hn<Gt;hn++)switch(ft[hn]|0){case o.OPS.rectangle:Nt=yt[Zt++],Bt=yt[Zt++];const At=yt[Zt++],Ft=yt[Zt++],Vt=Nt+At,qt=Bt+Ft;It.moveTo(Nt,Bt),At===0||Ft===0?It.lineTo(Vt,qt):(It.lineTo(Vt,Bt),It.lineTo(Vt,qt),It.lineTo(Nt,qt)),on||Lt.updateRectMinMax(nn,[Nt,Bt,Vt,qt]),It.closePath();break;case o.OPS.moveTo:Nt=yt[Zt++],Bt=yt[Zt++],It.moveTo(Nt,Bt),on||Lt.updatePathMinMax(nn,Nt,Bt);break;case o.OPS.lineTo:Nt=yt[Zt++],Bt=yt[Zt++],It.lineTo(Nt,Bt),on||Lt.updatePathMinMax(nn,Nt,Bt);break;case o.OPS.curveTo:Kt=Nt,rn=Bt,Nt=yt[Zt+4],Bt=yt[Zt+5],It.bezierCurveTo(yt[Zt],yt[Zt+1],yt[Zt+2],yt[Zt+3],Nt,Bt),Lt.updateCurvePathMinMax(nn,Kt,rn,yt[Zt],yt[Zt+1],yt[Zt+2],yt[Zt+3],Nt,Bt,cn),Zt+=6;break;case o.OPS.curveTo2:Kt=Nt,rn=Bt,It.bezierCurveTo(Nt,Bt,yt[Zt],yt[Zt+1],yt[Zt+2],yt[Zt+3]),Lt.updateCurvePathMinMax(nn,Kt,rn,Nt,Bt,yt[Zt],yt[Zt+1],yt[Zt+2],yt[Zt+3],cn),Nt=yt[Zt+2],Bt=yt[Zt+3],Zt+=4;break;case o.OPS.curveTo3:Kt=Nt,rn=Bt,Nt=yt[Zt+2],Bt=yt[Zt+3],It.bezierCurveTo(yt[Zt],yt[Zt+1],Nt,Bt,Nt,Bt),Lt.updateCurvePathMinMax(nn,Kt,rn,yt[Zt],yt[Zt+1],Nt,Bt,Nt,Bt,cn),Zt+=4;break;case o.OPS.closePath:It.closePath();break}on&&Lt.updateScalingPathMinMax(nn,cn),Lt.setCurrentPoint(Nt,Bt)}closePath(){this.ctx.closePath()}stroke(ft=!0){const yt=this.ctx,vt=this.current.strokeColor;yt.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof vt=="object"&&(vt!=null&&vt.getPattern)?(yt.save(),yt.strokeStyle=vt.getPattern(yt,this,(0,c.getCurrentTransformInverse)(yt),d.PathType.STROKE),this.rescaleAndStroke(!1),yt.restore()):this.rescaleAndStroke(!0)),ft&&this.consumePath(this.current.getClippedPathBoundingBox()),yt.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(ft=!0){const yt=this.ctx,vt=this.current.fillColor,It=this.current.patternFill;let Lt=!1;It&&(yt.save(),yt.fillStyle=vt.getPattern(yt,this,(0,c.getCurrentTransformInverse)(yt),d.PathType.FILL),Lt=!0);const Nt=this.current.getClippedPathBoundingBox();this.contentVisible&&Nt!==null&&(this.pendingEOFill?(yt.fill("evenodd"),this.pendingEOFill=!1):yt.fill()),Lt&&yt.restore(),ft&&this.consumePath(Nt)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=St}eoClip(){this.pendingClip=Ot}beginText(){this.current.textMatrix=o.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const ft=this.pendingTextPaths,yt=this.ctx;if(ft===void 0){yt.beginPath();return}yt.save(),yt.beginPath();for(const vt of ft)yt.setTransform(...vt.transform),yt.translate(vt.x,vt.y),vt.addToPath(yt,vt.fontSize);yt.restore(),yt.clip(),yt.beginPath(),delete this.pendingTextPaths}setCharSpacing(ft){this.current.charSpacing=ft}setWordSpacing(ft){this.current.wordSpacing=ft}setHScale(ft){this.current.textHScale=ft/100}setLeading(ft){this.current.leading=-ft}setFont(ft,yt){var nn;const vt=this.commonObjs.get(ft),It=this.current;if(!vt)throw new Error(`Can't find font for ${ft}`);if(It.fontMatrix=vt.fontMatrix||o.FONT_IDENTITY_MATRIX,(It.fontMatrix[0]===0||It.fontMatrix[3]===0)&&(0,o.warn)("Invalid font matrix for font "+ft),yt<0?(yt=-yt,It.fontDirection=-1):It.fontDirection=1,this.current.font=vt,this.current.fontSize=yt,vt.isType3Font)return;const Lt=vt.loadedName||"sans-serif",Nt=((nn=vt.systemFontInfo)==null?void 0:nn.css)||`"${Lt}", ${vt.fallbackName}`;let Bt="normal";vt.black?Bt="900":vt.bold&&(Bt="bold");const Kt=vt.italic?"italic":"normal";let rn=yt;yt<g?rn=g:yt>_&&(rn=_),this.current.fontSizeScale=yt/rn,this.ctx.font=`${Kt} ${Bt} ${rn}px ${Nt}`}setTextRenderingMode(ft){this.current.textRenderingMode=ft}setTextRise(ft){this.current.textRise=ft}moveText(ft,yt){this.current.x=this.current.lineX+=ft,this.current.y=this.current.lineY+=yt}setLeadingMoveText(ft,yt){this.setLeading(-yt),this.moveText(ft,yt)}setTextMatrix(ft,yt,vt,It,Lt,Nt){this.current.textMatrix=[ft,yt,vt,It,Lt,Nt],this.current.textMatrixScale=Math.hypot(ft,yt),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(ft,yt,vt,It){const Lt=this.ctx,Nt=this.current,Bt=Nt.font,Kt=Nt.textRenderingMode,rn=Nt.fontSize/Nt.fontSizeScale,nn=Kt&o.TextRenderingMode.FILL_STROKE_MASK,on=!!(Kt&o.TextRenderingMode.ADD_TO_PATH_FLAG),cn=Nt.patternFill&&!Bt.missingFile;let hn;(Bt.disableFontFace||on||cn)&&(hn=Bt.getPathGenerator(this.commonObjs,ft)),Bt.disableFontFace||cn?(Lt.save(),Lt.translate(yt,vt),Lt.beginPath(),hn(Lt,rn),It&&Lt.setTransform(...It),(nn===o.TextRenderingMode.FILL||nn===o.TextRenderingMode.FILL_STROKE)&&Lt.fill(),(nn===o.TextRenderingMode.STROKE||nn===o.TextRenderingMode.FILL_STROKE)&&Lt.stroke(),Lt.restore()):((nn===o.TextRenderingMode.FILL||nn===o.TextRenderingMode.FILL_STROKE)&&Lt.fillText(ft,yt,vt),(nn===o.TextRenderingMode.STROKE||nn===o.TextRenderingMode.FILL_STROKE)&&Lt.strokeText(ft,yt,vt)),on&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,c.getCurrentTransform)(Lt),x:yt,y:vt,fontSize:rn,addToPath:hn})}get isFontSubpixelAAEnabled(){const{context:ft}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);ft.scale(1.5,1),ft.fillText("I",0,10);const yt=ft.getImageData(0,0,10,10).data;let vt=!1;for(let It=3;It<yt.length;It+=4)if(yt[It]>0&&yt[It]<255){vt=!0;break}return(0,o.shadow)(this,"isFontSubpixelAAEnabled",vt)}showText(ft){const yt=this.current,vt=yt.font;if(vt.isType3Font)return this.showType3Text(ft);const It=yt.fontSize;if(It===0)return;const Lt=this.ctx,Nt=yt.fontSizeScale,Bt=yt.charSpacing,Kt=yt.wordSpacing,rn=yt.fontDirection,nn=yt.textHScale*rn,on=ft.length,cn=vt.vertical,hn=cn?1:-1,Zt=vt.defaultVMetrics,Gt=It*yt.fontMatrix[0],At=yt.textRenderingMode===o.TextRenderingMode.FILL&&!vt.disableFontFace&&!yt.patternFill;Lt.save(),Lt.transform(...yt.textMatrix),Lt.translate(yt.x,yt.y+yt.textRise),rn>0?Lt.scale(nn,-1):Lt.scale(nn,1);let Ft;if(yt.patternFill){Lt.save();const un=yt.fillColor.getPattern(Lt,this,(0,c.getCurrentTransformInverse)(Lt),d.PathType.FILL);Ft=(0,c.getCurrentTransform)(Lt),Lt.restore(),Lt.fillStyle=un}let Vt=yt.lineWidth;const qt=yt.textMatrixScale;if(qt===0||Vt===0){const un=yt.textRenderingMode&o.TextRenderingMode.FILL_STROKE_MASK;(un===o.TextRenderingMode.STROKE||un===o.TextRenderingMode.FILL_STROKE)&&(Vt=this.getSinglePixelWidth())}else Vt/=qt;if(Nt!==1&&(Lt.scale(Nt,Nt),Vt/=Nt),Lt.lineWidth=Vt,vt.isInvalidPDFjsFont){const un=[];let zt=0;for(const gn of ft)un.push(gn.unicode),zt+=gn.width;Lt.fillText(un.join(""),0,0),yt.x+=zt*Gt*nn,Lt.restore(),this.compose();return}let an=0,fn;for(fn=0;fn<on;++fn){const un=ft[fn];if(typeof un=="number"){an+=hn*un*It/1e3;continue}let zt=!1;const gn=(un.isSpace?Kt:0)+Bt,mn=un.fontChar,Fn=un.accent;let Ln,Bn,An=un.width;if(cn){const Un=un.vmetric||Zt,Hn=-(un.vmetric?Un[1]:An*.5)*Gt,ln=Un[2]*Gt;An=Un?-Un[0]:An,Ln=Hn/Nt,Bn=(an+ln)/Nt}else Ln=an/Nt,Bn=0;if(vt.remeasure&&An>0){const Un=Lt.measureText(mn).width*1e3/It*Nt;if(An<Un&&this.isFontSubpixelAAEnabled){const Hn=An/Un;zt=!0,Lt.save(),Lt.scale(Hn,1),Ln/=Hn}else An!==Un&&(Ln+=(An-Un)/2e3*It/Nt)}if(this.contentVisible&&(un.isInFont||vt.missingFile)){if(At&&!Fn)Lt.fillText(mn,Ln,Bn);else if(this.paintChar(mn,Ln,Bn,Ft),Fn){const Un=Ln+It*Fn.offset.x/Nt,Hn=Bn-It*Fn.offset.y/Nt;this.paintChar(Fn.fontChar,Un,Hn,Ft)}}const In=cn?An*Gt-gn*rn:An*Gt+gn*rn;an+=In,zt&&Lt.restore()}cn?yt.y-=an:yt.x+=an*nn,Lt.restore(),this.compose()}showType3Text(ft){const yt=this.ctx,vt=this.current,It=vt.font,Lt=vt.fontSize,Nt=vt.fontDirection,Bt=It.vertical?1:-1,Kt=vt.charSpacing,rn=vt.wordSpacing,nn=vt.textHScale*Nt,on=vt.fontMatrix||o.FONT_IDENTITY_MATRIX,cn=ft.length,hn=vt.textRenderingMode===o.TextRenderingMode.INVISIBLE;let Zt,Gt,At,Ft;if(!(hn||Lt===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,yt.save(),yt.transform(...vt.textMatrix),yt.translate(vt.x,vt.y),yt.scale(nn,Nt),Zt=0;Zt<cn;++Zt){if(Gt=ft[Zt],typeof Gt=="number"){Ft=Bt*Gt*Lt/1e3,this.ctx.translate(Ft,0),vt.x+=Ft*nn;continue}const Vt=(Gt.isSpace?rn:0)+Kt,qt=It.charProcOperatorList[Gt.operatorListId];if(!qt){(0,o.warn)(`Type3 character "${Gt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Gt,this.save(),yt.scale(Lt,Lt),yt.transform(...on),this.executeOperatorList(qt),this.restore()),At=o.Util.applyTransform([Gt.width,0],on)[0]*Lt+Vt,yt.translate(At,0),vt.x+=At*nn}yt.restore(),this.processingType3=null}}setCharWidth(ft,yt){}setCharWidthAndBounds(ft,yt,vt,It,Lt,Nt){this.ctx.rect(vt,It,Lt-vt,Nt-It),this.ctx.clip(),this.endPath()}getColorN_Pattern(ft){let yt;if(ft[0]==="TilingPattern"){const vt=ft[1],It=this.baseTransform||(0,c.getCurrentTransform)(this.ctx),Lt={createCanvasGraphics:Nt=>new $t(Nt,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};yt=new d.TilingPattern(ft,vt,this.ctx,Lt,It)}else yt=this._getPattern(ft[1],ft[2]);return yt}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(ft,yt,vt){const It=o.Util.makeHexColor(ft,yt,vt);this.ctx.strokeStyle=It,this.current.strokeColor=It}setFillRGBColor(ft,yt,vt){const It=o.Util.makeHexColor(ft,yt,vt);this.ctx.fillStyle=It,this.current.fillColor=It,this.current.patternFill=!1}_getPattern(ft,yt=null){let vt;return this.cachedPatterns.has(ft)?vt=this.cachedPatterns.get(ft):(vt=(0,d.getShadingPattern)(this.getObject(ft)),this.cachedPatterns.set(ft,vt)),yt&&(vt.matrix=yt),vt}shadingFill(ft){if(!this.contentVisible)return;const yt=this.ctx;this.save();const vt=this._getPattern(ft);yt.fillStyle=vt.getPattern(yt,this,(0,c.getCurrentTransformInverse)(yt),d.PathType.SHADING);const It=(0,c.getCurrentTransformInverse)(yt);if(It){const{width:Lt,height:Nt}=yt.canvas,[Bt,Kt,rn,nn]=o.Util.getAxialAlignedBoundingBox([0,0,Lt,Nt],It);this.ctx.fillRect(Bt,Kt,rn-Bt,nn-Kt)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,o.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,o.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(ft,yt){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(ft)&&ft.length===6&&this.transform(...ft),this.baseTransform=(0,c.getCurrentTransform)(this.ctx),yt)){const vt=yt[2]-yt[0],It=yt[3]-yt[1];this.ctx.rect(yt[0],yt[1],vt,It),this.current.updateRectMinMax((0,c.getCurrentTransform)(this.ctx),yt),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(ft){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const yt=this.ctx;ft.isolated||(0,o.info)("TODO: Support non-isolated groups."),ft.knockout&&(0,o.warn)("Knockout groups not supported.");const vt=(0,c.getCurrentTransform)(yt);if(ft.matrix&&yt.transform(...ft.matrix),!ft.bbox)throw new Error("Bounding box is required.");let It=o.Util.getAxialAlignedBoundingBox(ft.bbox,(0,c.getCurrentTransform)(yt));const Lt=[0,0,yt.canvas.width,yt.canvas.height];It=o.Util.intersect(It,Lt)||[0,0,0,0];const Nt=Math.floor(It[0]),Bt=Math.floor(It[1]);let Kt=Math.max(Math.ceil(It[2])-Nt,1),rn=Math.max(Math.ceil(It[3])-Bt,1),nn=1,on=1;Kt>b&&(nn=Kt/b,Kt=b),rn>b&&(on=rn/b,rn=b),this.current.startNewPathAndClipBox([0,0,Kt,rn]);let cn="groupAt"+this.groupLevel;ft.smask&&(cn+="_smask_"+this.smaskCounter++%2);const hn=this.cachedCanvases.getCanvas(cn,Kt,rn),Zt=hn.context;Zt.scale(1/nn,1/on),Zt.translate(-Nt,-Bt),Zt.transform(...vt),ft.smask?this.smaskStack.push({canvas:hn.canvas,context:Zt,offsetX:Nt,offsetY:Bt,scaleX:nn,scaleY:on,subtype:ft.smask.subtype,backdrop:ft.smask.backdrop,transferMap:ft.smask.transferMap||null,startTransformInverse:null}):(yt.setTransform(1,0,0,1,0,0),yt.translate(Nt,Bt),yt.scale(nn,on),yt.save()),ot(yt,Zt),this.ctx=Zt,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(yt),this.groupLevel++}endGroup(ft){if(!this.contentVisible)return;this.groupLevel--;const yt=this.ctx,vt=this.groupStack.pop();if(this.ctx=vt,this.ctx.imageSmoothingEnabled=!1,ft.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const It=(0,c.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...It);const Lt=o.Util.getAxialAlignedBoundingBox([0,0,yt.canvas.width,yt.canvas.height],It);this.ctx.drawImage(yt.canvas,0,0),this.ctx.restore(),this.compose(Lt)}}beginAnnotation(ft,yt,vt,It,Lt){if(Ht(this,Rt,Zr).call(this),ht(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(yt)&&yt.length===4){const Nt=yt[2]-yt[0],Bt=yt[3]-yt[1];if(Lt&&this.annotationCanvasMap){vt=vt.slice(),vt[4]-=yt[0],vt[5]-=yt[1],yt=yt.slice(),yt[0]=yt[1]=0,yt[2]=Nt,yt[3]=Bt;const[Kt,rn]=o.Util.singularValueDecompose2dScale((0,c.getCurrentTransform)(this.ctx)),{viewportScale:nn}=this,on=Math.ceil(Nt*this.outputScaleX*nn),cn=Math.ceil(Bt*this.outputScaleY*nn);this.annotationCanvas=this.canvasFactory.create(on,cn);const{canvas:hn,context:Zt}=this.annotationCanvas;this.annotationCanvasMap.set(ft,hn),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Zt,this.ctx.save(),this.ctx.setTransform(Kt,0,0,-rn,0,Bt*rn),ht(this.ctx)}else ht(this.ctx),this.ctx.rect(yt[0],yt[1],Nt,Bt),this.ctx.clip(),this.endPath()}this.current=new it(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...vt),this.transform(...It)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Ht(this,Rt,Gr).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(ft){if(!this.contentVisible)return;const yt=ft.count;ft=this.getObject(ft.data,ft),ft.count=yt;const vt=this.ctx,It=this.processingType3;if(It&&(It.compiled===void 0&&(It.compiled=nt(ft)),It.compiled)){It.compiled(vt);return}const Lt=this._createMaskCanvas(ft),Nt=Lt.canvas;vt.save(),vt.setTransform(1,0,0,1,0,0),vt.drawImage(Nt,Lt.offsetX,Lt.offsetY),vt.restore(),this.compose()}paintImageMaskXObjectRepeat(ft,yt,vt=0,It=0,Lt,Nt){if(!this.contentVisible)return;ft=this.getObject(ft.data,ft);const Bt=this.ctx;Bt.save();const Kt=(0,c.getCurrentTransform)(Bt);Bt.transform(yt,vt,It,Lt,0,0);const rn=this._createMaskCanvas(ft);Bt.setTransform(1,0,0,1,rn.offsetX-Kt[4],rn.offsetY-Kt[5]);for(let nn=0,on=Nt.length;nn<on;nn+=2){const cn=o.Util.transform(Kt,[yt,vt,It,Lt,Nt[nn],Nt[nn+1]]),[hn,Zt]=o.Util.applyTransform([0,0],cn);Bt.drawImage(rn.canvas,hn,Zt)}Bt.restore(),this.compose()}paintImageMaskXObjectGroup(ft){if(!this.contentVisible)return;const yt=this.ctx,vt=this.current.fillColor,It=this.current.patternFill;for(const Lt of ft){const{data:Nt,width:Bt,height:Kt,transform:rn}=Lt,nn=this.cachedCanvases.getCanvas("maskCanvas",Bt,Kt),on=nn.context;on.save();const cn=this.getObject(Nt,Lt);dt(on,cn),on.globalCompositeOperation="source-in",on.fillStyle=It?vt.getPattern(on,this,(0,c.getCurrentTransformInverse)(yt),d.PathType.FILL):vt,on.fillRect(0,0,Bt,Kt),on.restore(),yt.save(),yt.transform(...rn),yt.scale(1,-1),rt(yt,nn.canvas,0,0,Bt,Kt,0,-1,1,1),yt.restore()}this.compose()}paintImageXObject(ft){if(!this.contentVisible)return;const yt=this.getObject(ft);if(!yt){(0,o.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(yt)}paintImageXObjectRepeat(ft,yt,vt,It){if(!this.contentVisible)return;const Lt=this.getObject(ft);if(!Lt){(0,o.warn)("Dependent image isn't ready yet");return}const Nt=Lt.width,Bt=Lt.height,Kt=[];for(let rn=0,nn=It.length;rn<nn;rn+=2)Kt.push({transform:[yt,0,0,vt,It[rn],It[rn+1]],x:0,y:0,w:Nt,h:Bt});this.paintInlineImageXObjectGroup(Lt,Kt)}applyTransferMapsToCanvas(ft){return this.current.transferMaps!=="none"&&(ft.filter=this.current.transferMaps,ft.drawImage(ft.canvas,0,0),ft.filter="none"),ft.canvas}applyTransferMapsToBitmap(ft){if(this.current.transferMaps==="none")return ft.bitmap;const{bitmap:yt,width:vt,height:It}=ft,Lt=this.cachedCanvases.getCanvas("inlineImage",vt,It),Nt=Lt.context;return Nt.filter=this.current.transferMaps,Nt.drawImage(yt,0,0),Nt.filter="none",Lt.canvas}paintInlineImageXObject(ft){if(!this.contentVisible)return;const yt=ft.width,vt=ft.height,It=this.ctx;if(this.save(),!o.isNodeJS){const{filter:Bt}=It;Bt!=="none"&&Bt!==""&&(It.filter="none")}It.scale(1/yt,-1/vt);let Lt;if(ft.bitmap)Lt=this.applyTransferMapsToBitmap(ft);else if(typeof HTMLElement=="function"&&ft instanceof HTMLElement||!ft.data)Lt=ft;else{const Kt=this.cachedCanvases.getCanvas("inlineImage",yt,vt).context;at(Kt,ft),Lt=this.applyTransferMapsToCanvas(Kt)}const Nt=this._scaleImage(Lt,(0,c.getCurrentTransformInverse)(It));It.imageSmoothingEnabled=Et((0,c.getCurrentTransform)(It),ft.interpolate),rt(It,Nt.img,0,0,Nt.paintWidth,Nt.paintHeight,0,-vt,yt,vt),this.compose(),this.restore()}paintInlineImageXObjectGroup(ft,yt){if(!this.contentVisible)return;const vt=this.ctx;let It;if(ft.bitmap)It=ft.bitmap;else{const Lt=ft.width,Nt=ft.height,Kt=this.cachedCanvases.getCanvas("inlineImage",Lt,Nt).context;at(Kt,ft),It=this.applyTransferMapsToCanvas(Kt)}for(const Lt of yt)vt.save(),vt.transform(...Lt.transform),vt.scale(1,-1),rt(vt,It,Lt.x,Lt.y,Lt.w,Lt.h,0,-1,1,1),vt.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(ft){}markPointProps(ft,yt){}beginMarkedContent(ft){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(ft,yt){ft==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(yt)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(ft){const yt=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(ft);const vt=this.ctx;this.pendingClip&&(yt||(this.pendingClip===Ot?vt.clip("evenodd"):vt.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),vt.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const ft=(0,c.getCurrentTransform)(this.ctx);if(ft[1]===0&&ft[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(ft[0]),Math.abs(ft[3]));else{const yt=Math.abs(ft[0]*ft[3]-ft[2]*ft[1]),vt=Math.hypot(ft[0],ft[2]),It=Math.hypot(ft[1],ft[3]);this._cachedGetSinglePixelWidth=Math.max(vt,It)/yt}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:ft}=this.current,{a:yt,b:vt,c:It,d:Lt}=this.ctx.getTransform();let Nt,Bt;if(vt===0&&It===0){const Kt=Math.abs(yt),rn=Math.abs(Lt);if(Kt===rn)if(ft===0)Nt=Bt=1/Kt;else{const nn=Kt*ft;Nt=Bt=nn<1?1/nn:1}else if(ft===0)Nt=1/Kt,Bt=1/rn;else{const nn=Kt*ft,on=rn*ft;Nt=nn<1?1/nn:1,Bt=on<1?1/on:1}}else{const Kt=Math.abs(yt*Lt-vt*It),rn=Math.hypot(yt,vt),nn=Math.hypot(It,Lt);if(ft===0)Nt=nn/Kt,Bt=rn/Kt;else{const on=ft*Kt;Nt=nn>on?nn/on:1,Bt=rn>on?rn/on:1}}this._cachedScaleForStroking[0]=Nt,this._cachedScaleForStroking[1]=Bt}return this._cachedScaleForStroking}rescaleAndStroke(ft){const{ctx:yt}=this,{lineWidth:vt}=this.current,[It,Lt]=this.getScaleForStroking();if(yt.lineWidth=vt||1,It===1&&Lt===1){yt.stroke();return}const Nt=yt.getLineDash();if(ft&&yt.save(),yt.scale(It,Lt),Nt.length>0){const Bt=Math.max(It,Lt);yt.setLineDash(Nt.map(Kt=>Kt/Bt)),yt.lineDashOffset/=Bt}yt.stroke(),ft&&yt.restore()}isContentVisible(){for(let ft=this.markedContentStack.length-1;ft>=0;ft--)if(!this.markedContentStack[ft].visible)return!1;return!0}};Rt=new WeakSet,Zr=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Gr=function(){if(this.pageColors){const ft=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(ft!=="none"){const yt=this.ctx.filter;this.ctx.filter=ft,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=yt}}};let Ct=$t;e.CanvasGraphics=Ct;for(const xt in o.OPS)Ct.prototype[xt]!==void 0&&(Ct.prototype[o.OPS[xt]]=Ct.prototype[xt])},(s,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=tt;var o=a(1),c=a(6);const d={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=d;function h(nt,it){if(!it)return;const at=it[2]-it[0],dt=it[3]-it[1],ot=new Path2D;ot.rect(it[0],it[1],at,dt),nt.clip(ot)}class g{constructor(){this.constructor===g&&(0,o.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,o.unreachable)("Abstract method `getPattern` called.")}}class _ extends g{constructor(it){super(),this._type=it[1],this._bbox=it[2],this._colorStops=it[3],this._p0=it[4],this._p1=it[5],this._r0=it[6],this._r1=it[7],this.matrix=null}_createGradient(it){let at;this._type==="axial"?at=it.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(at=it.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const dt of this._colorStops)at.addColorStop(dt[0],dt[1]);return at}getPattern(it,at,dt,ot){let ht;if(ot===d.STROKE||ot===d.FILL){const ut=at.current.getClippedPathBoundingBox(ot,(0,c.getCurrentTransform)(it))||[0,0,0,0],pt=Math.ceil(ut[2]-ut[0])||1,_t=Math.ceil(ut[3]-ut[1])||1,wt=at.cachedCanvases.getCanvas("pattern",pt,_t,!0),mt=wt.context;mt.clearRect(0,0,mt.canvas.width,mt.canvas.height),mt.beginPath(),mt.rect(0,0,mt.canvas.width,mt.canvas.height),mt.translate(-ut[0],-ut[1]),dt=o.Util.transform(dt,[1,0,0,1,ut[0],ut[1]]),mt.transform(...at.baseTransform),this.matrix&&mt.transform(...this.matrix),h(mt,this._bbox),mt.fillStyle=this._createGradient(mt),mt.fill(),ht=it.createPattern(wt.canvas,"no-repeat");const Et=new DOMMatrix(dt);ht.setTransform(Et)}else h(it,this._bbox),ht=this._createGradient(it);return ht}}function b(nt,it,at,dt,ot,ht,ut,pt){const _t=it.coords,wt=it.colors,mt=nt.data,Et=nt.width*4;let Pt;_t[at+1]>_t[dt+1]&&(Pt=at,at=dt,dt=Pt,Pt=ht,ht=ut,ut=Pt),_t[dt+1]>_t[ot+1]&&(Pt=dt,dt=ot,ot=Pt,Pt=ut,ut=pt,pt=Pt),_t[at+1]>_t[dt+1]&&(Pt=at,at=dt,dt=Pt,Pt=ht,ht=ut,ut=Pt);const jt=(_t[at]+it.offsetX)*it.scaleX,St=(_t[at+1]+it.offsetY)*it.scaleY,Ot=(_t[dt]+it.offsetX)*it.scaleX,Ct=(_t[dt+1]+it.offsetY)*it.scaleY,Rt=(_t[ot]+it.offsetX)*it.scaleX,bt=(_t[ot+1]+it.offsetY)*it.scaleY;if(St>=bt)return;const Tt=wt[ht],$t=wt[ht+1],xt=wt[ht+2],ft=wt[ut],yt=wt[ut+1],vt=wt[ut+2],It=wt[pt],Lt=wt[pt+1],Nt=wt[pt+2],Bt=Math.round(St),Kt=Math.round(bt);let rn,nn,on,cn,hn,Zt,Gt,At;for(let Ft=Bt;Ft<=Kt;Ft++){if(Ft<Ct){const un=Ft<St?0:(St-Ft)/(St-Ct);rn=jt-(jt-Ot)*un,nn=Tt-(Tt-ft)*un,on=$t-($t-yt)*un,cn=xt-(xt-vt)*un}else{let un;Ft>bt?un=1:Ct===bt?un=0:un=(Ct-Ft)/(Ct-bt),rn=Ot-(Ot-Rt)*un,nn=ft-(ft-It)*un,on=yt-(yt-Lt)*un,cn=vt-(vt-Nt)*un}let Vt;Ft<St?Vt=0:Ft>bt?Vt=1:Vt=(St-Ft)/(St-bt),hn=jt-(jt-Rt)*Vt,Zt=Tt-(Tt-It)*Vt,Gt=$t-($t-Lt)*Vt,At=xt-(xt-Nt)*Vt;const qt=Math.round(Math.min(rn,hn)),an=Math.round(Math.max(rn,hn));let fn=Et*Ft+qt*4;for(let un=qt;un<=an;un++)Vt=(rn-un)/(rn-hn),Vt<0?Vt=0:Vt>1&&(Vt=1),mt[fn++]=nn-(nn-Zt)*Vt|0,mt[fn++]=on-(on-Gt)*Vt|0,mt[fn++]=cn-(cn-At)*Vt|0,mt[fn++]=255}}function j(nt,it,at){const dt=it.coords,ot=it.colors;let ht,ut;switch(it.type){case"lattice":const pt=it.verticesPerRow,_t=Math.floor(dt.length/pt)-1,wt=pt-1;for(ht=0;ht<_t;ht++){let mt=ht*pt;for(let Et=0;Et<wt;Et++,mt++)b(nt,at,dt[mt],dt[mt+1],dt[mt+pt],ot[mt],ot[mt+1],ot[mt+pt]),b(nt,at,dt[mt+pt+1],dt[mt+1],dt[mt+pt],ot[mt+pt+1],ot[mt+1],ot[mt+pt])}break;case"triangles":for(ht=0,ut=dt.length;ht<ut;ht+=3)b(nt,at,dt[ht],dt[ht+1],dt[ht+2],ot[ht],ot[ht+1],ot[ht+2]);break;default:throw new Error("illegal figure")}}class $ extends g{constructor(it){super(),this._coords=it[2],this._colors=it[3],this._figures=it[4],this._bounds=it[5],this._bbox=it[7],this._background=it[8],this.matrix=null}_createMeshCanvas(it,at,dt){const pt=Math.floor(this._bounds[0]),_t=Math.floor(this._bounds[1]),wt=Math.ceil(this._bounds[2])-pt,mt=Math.ceil(this._bounds[3])-_t,Et=Math.min(Math.ceil(Math.abs(wt*it[0]*1.1)),3e3),Pt=Math.min(Math.ceil(Math.abs(mt*it[1]*1.1)),3e3),jt=wt/Et,St=mt/Pt,Ot={coords:this._coords,colors:this._colors,offsetX:-pt,offsetY:-_t,scaleX:1/jt,scaleY:1/St},Ct=Et+2*2,Rt=Pt+2*2,bt=dt.getCanvas("mesh",Ct,Rt,!1),Tt=bt.context,$t=Tt.createImageData(Et,Pt);if(at){const ft=$t.data;for(let yt=0,vt=ft.length;yt<vt;yt+=4)ft[yt]=at[0],ft[yt+1]=at[1],ft[yt+2]=at[2],ft[yt+3]=255}for(const ft of this._figures)j($t,ft,Ot);return Tt.putImageData($t,2,2),{canvas:bt.canvas,offsetX:pt-2*jt,offsetY:_t-2*St,scaleX:jt,scaleY:St}}getPattern(it,at,dt,ot){h(it,this._bbox);let ht;if(ot===d.SHADING)ht=o.Util.singularValueDecompose2dScale((0,c.getCurrentTransform)(it));else if(ht=o.Util.singularValueDecompose2dScale(at.baseTransform),this.matrix){const pt=o.Util.singularValueDecompose2dScale(this.matrix);ht=[ht[0]*pt[0],ht[1]*pt[1]]}const ut=this._createMeshCanvas(ht,ot===d.SHADING?null:this._background,at.cachedCanvases);return ot!==d.SHADING&&(it.setTransform(...at.baseTransform),this.matrix&&it.transform(...this.matrix)),it.translate(ut.offsetX,ut.offsetY),it.scale(ut.scaleX,ut.scaleY),it.createPattern(ut.canvas,"no-repeat")}}class _e extends g{getPattern(){return"hotpink"}}function tt(nt){switch(nt[0]){case"RadialAxial":return new _(nt);case"Mesh":return new $(nt);case"Dummy":return new _e}throw new Error(`Unknown IR type: ${nt[0]}`)}const et={COLORED:1,UNCOLORED:2},rt=class rt{constructor(it,at,dt,ot,ht){this.operatorList=it[2],this.matrix=it[3]||[1,0,0,1,0,0],this.bbox=it[4],this.xstep=it[5],this.ystep=it[6],this.paintType=it[7],this.tilingType=it[8],this.color=at,this.ctx=dt,this.canvasGraphicsFactory=ot,this.baseTransform=ht}createPatternCanvas(it){const at=this.operatorList,dt=this.bbox,ot=this.xstep,ht=this.ystep,ut=this.paintType,pt=this.tilingType,_t=this.color,wt=this.canvasGraphicsFactory;(0,o.info)("TilingType: "+pt);const mt=dt[0],Et=dt[1],Pt=dt[2],jt=dt[3],St=o.Util.singularValueDecompose2dScale(this.matrix),Ot=o.Util.singularValueDecompose2dScale(this.baseTransform),Ct=[St[0]*Ot[0],St[1]*Ot[1]],Rt=this.getSizeAndScale(ot,this.ctx.canvas.width,Ct[0]),bt=this.getSizeAndScale(ht,this.ctx.canvas.height,Ct[1]),Tt=it.cachedCanvases.getCanvas("pattern",Rt.size,bt.size,!0),$t=Tt.context,xt=wt.createCanvasGraphics($t);xt.groupLevel=it.groupLevel,this.setFillAndStrokeStyleToContext(xt,ut,_t);let ft=mt,yt=Et,vt=Pt,It=jt;return mt<0&&(ft=0,vt+=Math.abs(mt)),Et<0&&(yt=0,It+=Math.abs(Et)),$t.translate(-(Rt.scale*ft),-(bt.scale*yt)),xt.transform(Rt.scale,0,0,bt.scale,0,0),$t.save(),this.clipBbox(xt,ft,yt,vt,It),xt.baseTransform=(0,c.getCurrentTransform)(xt.ctx),xt.executeOperatorList(at),xt.endDrawing(),{canvas:Tt.canvas,scaleX:Rt.scale,scaleY:bt.scale,offsetX:ft,offsetY:yt}}getSizeAndScale(it,at,dt){it=Math.abs(it);const ot=Math.max(rt.MAX_PATTERN_SIZE,at);let ht=Math.ceil(it*dt);return ht>=ot?ht=ot:dt=ht/it,{scale:dt,size:ht}}clipBbox(it,at,dt,ot,ht){const ut=ot-at,pt=ht-dt;it.ctx.rect(at,dt,ut,pt),it.current.updateRectMinMax((0,c.getCurrentTransform)(it.ctx),[at,dt,ot,ht]),it.clip(),it.endPath()}setFillAndStrokeStyleToContext(it,at,dt){const ot=it.ctx,ht=it.current;switch(at){case et.COLORED:const ut=this.ctx;ot.fillStyle=ut.fillStyle,ot.strokeStyle=ut.strokeStyle,ht.fillColor=ut.fillStyle,ht.strokeColor=ut.strokeStyle;break;case et.UNCOLORED:const pt=o.Util.makeHexColor(dt[0],dt[1],dt[2]);ot.fillStyle=pt,ot.strokeStyle=pt,ht.fillColor=pt,ht.strokeColor=pt;break;default:throw new o.FormatError(`Unsupported paint type: ${at}`)}}getPattern(it,at,dt,ot){let ht=dt;ot!==d.SHADING&&(ht=o.Util.transform(ht,at.baseTransform),this.matrix&&(ht=o.Util.transform(ht,this.matrix)));const ut=this.createPatternCanvas(at);let pt=new DOMMatrix(ht);pt=pt.translate(ut.offsetX,ut.offsetY),pt=pt.scale(1/ut.scaleX,1/ut.scaleY);const _t=it.createPattern(ut.canvas,"repeat");return _t.setTransform(pt),_t}};Sn(rt,"MAX_PATTERN_SIZE",3e3);let st=rt;e.TilingPattern=st},(s,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=d,e.convertToRGBA=c,e.grayToRGBA=g;var o=a(1);function c(_){switch(_.kind){case o.ImageKind.GRAYSCALE_1BPP:return d(_);case o.ImageKind.RGB_24BPP:return h(_)}return null}function d({src:_,srcPos:b=0,dest:j,width:$,height:_e,nonBlackColor:tt=4294967295,inverseDecode:et=!1}){const st=o.FeatureTest.isLittleEndian?4278190080:255,[rt,nt]=et?[tt,st]:[st,tt],it=$>>3,at=$&7,dt=_.length;j=new Uint32Array(j.buffer);let ot=0;for(let ht=0;ht<_e;ht++){for(const pt=b+it;b<pt;b++){const _t=b<dt?_[b]:255;j[ot++]=_t&128?nt:rt,j[ot++]=_t&64?nt:rt,j[ot++]=_t&32?nt:rt,j[ot++]=_t&16?nt:rt,j[ot++]=_t&8?nt:rt,j[ot++]=_t&4?nt:rt,j[ot++]=_t&2?nt:rt,j[ot++]=_t&1?nt:rt}if(at===0)continue;const ut=b<dt?_[b++]:255;for(let pt=0;pt<at;pt++)j[ot++]=ut&1<<7-pt?nt:rt}return{srcPos:b,destPos:ot}}function h({src:_,srcPos:b=0,dest:j,destPos:$=0,width:_e,height:tt}){let et=0;const st=_.length>>2,rt=new Uint32Array(_.buffer,b,st);if(o.FeatureTest.isLittleEndian){for(;et<st-2;et+=3,$+=4){const nt=rt[et],it=rt[et+1],at=rt[et+2];j[$]=nt|4278190080,j[$+1]=nt>>>24|it<<8|4278190080,j[$+2]=it>>>16|at<<16|4278190080,j[$+3]=at>>>8|4278190080}for(let nt=et*4,it=_.length;nt<it;nt+=3)j[$++]=_[nt]|_[nt+1]<<8|_[nt+2]<<16|4278190080}else{for(;et<st-2;et+=3,$+=4){const nt=rt[et],it=rt[et+1],at=rt[et+2];j[$]=nt|255,j[$+1]=nt<<24|it>>>8|255,j[$+2]=it<<16|at>>>16|255,j[$+3]=at<<8|255}for(let nt=et*4,it=_.length;nt<it;nt+=3)j[$++]=_[nt]<<24|_[nt+1]<<16|_[nt+2]<<8|255}return{srcPos:b,destPos:$}}function g(_,b){if(o.FeatureTest.isLittleEndian)for(let j=0,$=_.length;j<$;j++)b[j]=_[j]*65793|4278190080;else for(let j=0,$=_.length;j<$;j++)b[j]=_[j]*16843008|255}},(s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const a=Object.create(null);e.GlobalWorkerOptions=a,a.workerPort=null,a.workerSrc=""},(s,e,a)=>{var _,As,Ts,xr;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var o=a(1);const c={DATA:1,ERROR:2},d={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function h(_e){switch(_e instanceof Error||typeof _e=="object"&&_e!==null||(0,o.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),_e.name){case"AbortException":return new o.AbortException(_e.message);case"MissingPDFException":return new o.MissingPDFException(_e.message);case"PasswordException":return new o.PasswordException(_e.message,_e.code);case"UnexpectedResponseException":return new o.UnexpectedResponseException(_e.message,_e.status);case"UnknownErrorException":return new o.UnknownErrorException(_e.message,_e.details);default:return new o.UnknownErrorException(_e.message,_e.toString())}}class g{constructor(tt,et,st){Yt(this,_);this.sourceName=tt,this.targetName=et,this.comObj=st,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=rt=>{const nt=rt.data;if(nt.targetName!==this.sourceName)return;if(nt.stream){Ht(this,_,Ts).call(this,nt);return}if(nt.callback){const at=nt.callbackId,dt=this.callbackCapabilities[at];if(!dt)throw new Error(`Cannot resolve callback ${at}`);if(delete this.callbackCapabilities[at],nt.callback===c.DATA)dt.resolve(nt.data);else if(nt.callback===c.ERROR)dt.reject(h(nt.reason));else throw new Error("Unexpected callback case");return}const it=this.actionHandler[nt.action];if(!it)throw new Error(`Unknown action from worker: ${nt.action}`);if(nt.callbackId){const at=this.sourceName,dt=nt.sourceName;new Promise(function(ot){ot(it(nt.data))}).then(function(ot){st.postMessage({sourceName:at,targetName:dt,callback:c.DATA,callbackId:nt.callbackId,data:ot})},function(ot){st.postMessage({sourceName:at,targetName:dt,callback:c.ERROR,callbackId:nt.callbackId,reason:h(ot)})});return}if(nt.streamId){Ht(this,_,As).call(this,nt);return}it(nt.data)},st.addEventListener("message",this._onComObjOnMessage)}on(tt,et){const st=this.actionHandler;if(st[tt])throw new Error(`There is already an actionName called "${tt}"`);st[tt]=et}send(tt,et,st){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:tt,data:et},st)}sendWithPromise(tt,et,st){const rt=this.callbackId++,nt=new o.PromiseCapability;this.callbackCapabilities[rt]=nt;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:tt,callbackId:rt,data:et},st)}catch(it){nt.reject(it)}return nt.promise}sendWithStream(tt,et,st,rt){const nt=this.streamId++,it=this.sourceName,at=this.targetName,dt=this.comObj;return new ReadableStream({start:ot=>{const ht=new o.PromiseCapability;return this.streamControllers[nt]={controller:ot,startCall:ht,pullCall:null,cancelCall:null,isClosed:!1},dt.postMessage({sourceName:it,targetName:at,action:tt,streamId:nt,data:et,desiredSize:ot.desiredSize},rt),ht.promise},pull:ot=>{const ht=new o.PromiseCapability;return this.streamControllers[nt].pullCall=ht,dt.postMessage({sourceName:it,targetName:at,stream:d.PULL,streamId:nt,desiredSize:ot.desiredSize}),ht.promise},cancel:ot=>{(0,o.assert)(ot instanceof Error,"cancel must have a valid reason");const ht=new o.PromiseCapability;return this.streamControllers[nt].cancelCall=ht,this.streamControllers[nt].isClosed=!0,dt.postMessage({sourceName:it,targetName:at,stream:d.CANCEL,streamId:nt,reason:h(ot)}),ht.promise}},st)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}_=new WeakSet,As=function(tt){const et=tt.streamId,st=this.sourceName,rt=tt.sourceName,nt=this.comObj,it=this,at=this.actionHandler[tt.action],dt={enqueue(ot,ht=1,ut){if(this.isCancelled)return;const pt=this.desiredSize;this.desiredSize-=ht,pt>0&&this.desiredSize<=0&&(this.sinkCapability=new o.PromiseCapability,this.ready=this.sinkCapability.promise),nt.postMessage({sourceName:st,targetName:rt,stream:d.ENQUEUE,streamId:et,chunk:ot},ut)},close(){this.isCancelled||(this.isCancelled=!0,nt.postMessage({sourceName:st,targetName:rt,stream:d.CLOSE,streamId:et}),delete it.streamSinks[et])},error(ot){(0,o.assert)(ot instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,nt.postMessage({sourceName:st,targetName:rt,stream:d.ERROR,streamId:et,reason:h(ot)}))},sinkCapability:new o.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:tt.desiredSize,ready:null};dt.sinkCapability.resolve(),dt.ready=dt.sinkCapability.promise,this.streamSinks[et]=dt,new Promise(function(ot){ot(at(tt.data,dt))}).then(function(){nt.postMessage({sourceName:st,targetName:rt,stream:d.START_COMPLETE,streamId:et,success:!0})},function(ot){nt.postMessage({sourceName:st,targetName:rt,stream:d.START_COMPLETE,streamId:et,reason:h(ot)})})},Ts=function(tt){const et=tt.streamId,st=this.sourceName,rt=tt.sourceName,nt=this.comObj,it=this.streamControllers[et],at=this.streamSinks[et];switch(tt.stream){case d.START_COMPLETE:tt.success?it.startCall.resolve():it.startCall.reject(h(tt.reason));break;case d.PULL_COMPLETE:tt.success?it.pullCall.resolve():it.pullCall.reject(h(tt.reason));break;case d.PULL:if(!at){nt.postMessage({sourceName:st,targetName:rt,stream:d.PULL_COMPLETE,streamId:et,success:!0});break}at.desiredSize<=0&&tt.desiredSize>0&&at.sinkCapability.resolve(),at.desiredSize=tt.desiredSize,new Promise(function(dt){var ot;dt((ot=at.onPull)==null?void 0:ot.call(at))}).then(function(){nt.postMessage({sourceName:st,targetName:rt,stream:d.PULL_COMPLETE,streamId:et,success:!0})},function(dt){nt.postMessage({sourceName:st,targetName:rt,stream:d.PULL_COMPLETE,streamId:et,reason:h(dt)})});break;case d.ENQUEUE:if((0,o.assert)(it,"enqueue should have stream controller"),it.isClosed)break;it.controller.enqueue(tt.chunk);break;case d.CLOSE:if((0,o.assert)(it,"close should have stream controller"),it.isClosed)break;it.isClosed=!0,it.controller.close(),Ht(this,_,xr).call(this,it,et);break;case d.ERROR:(0,o.assert)(it,"error should have stream controller"),it.controller.error(h(tt.reason)),Ht(this,_,xr).call(this,it,et);break;case d.CANCEL_COMPLETE:tt.success?it.cancelCall.resolve():it.cancelCall.reject(h(tt.reason)),Ht(this,_,xr).call(this,it,et);break;case d.CANCEL:if(!at)break;new Promise(function(dt){var ot;dt((ot=at.onCancel)==null?void 0:ot.call(at,h(tt.reason)))}).then(function(){nt.postMessage({sourceName:st,targetName:rt,stream:d.CANCEL_COMPLETE,streamId:et,success:!0})},function(dt){nt.postMessage({sourceName:st,targetName:rt,stream:d.CANCEL_COMPLETE,streamId:et,reason:h(dt)})}),at.sinkCapability.reject(h(tt.reason)),at.isCancelled=!0,delete this.streamSinks[et];break;default:throw new Error("Unexpected stream case")}},xr=async function(tt,et){var st,rt,nt;await Promise.allSettled([(st=tt.startCall)==null?void 0:st.promise,(rt=tt.pullCall)==null?void 0:rt.promise,(nt=tt.cancelCall)==null?void 0:nt.promise]),delete this.streamControllers[et]},e.MessageHandler=g},(s,e,a)=>{var d,h;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var o=a(1);class c{constructor({parsedData:_,rawData:b}){Yt(this,d);Yt(this,h);Qt(this,d,_),Qt(this,h,b)}getRaw(){return ct(this,h)}get(_){return ct(this,d).get(_)??null}getAll(){return(0,o.objectFromMap)(ct(this,d))}has(_){return ct(this,d).has(_)}}d=new WeakMap,h=new WeakMap,e.Metadata=c},(s,e,a)=>{var _,b,j,$,_e,tt,qr;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var o=a(1),c=a(8);const d=Symbol("INTERNAL");class h{constructor(rt,nt){Yt(this,_,!0);this.name=rt,this.intent=nt}get visible(){return ct(this,_)}_setVisible(rt,nt){rt!==d&&(0,o.unreachable)("Internal method `_setVisible` called."),Qt(this,_,nt)}}_=new WeakMap;class g{constructor(rt){Yt(this,tt);Yt(this,b,null);Yt(this,j,new Map);Yt(this,$,null);Yt(this,_e,null);if(this.name=null,this.creator=null,rt!==null){this.name=rt.name,this.creator=rt.creator,Qt(this,_e,rt.order);for(const nt of rt.groups)ct(this,j).set(nt.id,new h(nt.name,nt.intent));if(rt.baseState==="OFF")for(const nt of ct(this,j).values())nt._setVisible(d,!1);for(const nt of rt.on)ct(this,j).get(nt)._setVisible(d,!0);for(const nt of rt.off)ct(this,j).get(nt)._setVisible(d,!1);Qt(this,$,this.getHash())}}isVisible(rt){if(ct(this,j).size===0)return!0;if(!rt)return(0,o.warn)("Optional content group not defined."),!0;if(rt.type==="OCG")return ct(this,j).has(rt.id)?ct(this,j).get(rt.id).visible:((0,o.warn)(`Optional content group not found: ${rt.id}`),!0);if(rt.type==="OCMD"){if(rt.expression)return Ht(this,tt,qr).call(this,rt.expression);if(!rt.policy||rt.policy==="AnyOn"){for(const nt of rt.ids){if(!ct(this,j).has(nt))return(0,o.warn)(`Optional content group not found: ${nt}`),!0;if(ct(this,j).get(nt).visible)return!0}return!1}else if(rt.policy==="AllOn"){for(const nt of rt.ids){if(!ct(this,j).has(nt))return(0,o.warn)(`Optional content group not found: ${nt}`),!0;if(!ct(this,j).get(nt).visible)return!1}return!0}else if(rt.policy==="AnyOff"){for(const nt of rt.ids){if(!ct(this,j).has(nt))return(0,o.warn)(`Optional content group not found: ${nt}`),!0;if(!ct(this,j).get(nt).visible)return!0}return!1}else if(rt.policy==="AllOff"){for(const nt of rt.ids){if(!ct(this,j).has(nt))return(0,o.warn)(`Optional content group not found: ${nt}`),!0;if(ct(this,j).get(nt).visible)return!1}return!0}return(0,o.warn)(`Unknown optional content policy ${rt.policy}.`),!0}return(0,o.warn)(`Unknown group type ${rt.type}.`),!0}setVisibility(rt,nt=!0){if(!ct(this,j).has(rt)){(0,o.warn)(`Optional content group not found: ${rt}`);return}ct(this,j).get(rt)._setVisible(d,!!nt),Qt(this,b,null)}get hasInitialVisibility(){return ct(this,$)===null||this.getHash()===ct(this,$)}getOrder(){return ct(this,j).size?ct(this,_e)?ct(this,_e).slice():[...ct(this,j).keys()]:null}getGroups(){return ct(this,j).size>0?(0,o.objectFromMap)(ct(this,j)):null}getGroup(rt){return ct(this,j).get(rt)||null}getHash(){if(ct(this,b)!==null)return ct(this,b);const rt=new c.MurmurHash3_64;for(const[nt,it]of ct(this,j))rt.update(`${nt}:${it.visible}`);return Qt(this,b,rt.hexdigest())}}b=new WeakMap,j=new WeakMap,$=new WeakMap,_e=new WeakMap,tt=new WeakSet,qr=function(rt){const nt=rt.length;if(nt<2)return!0;const it=rt[0];for(let at=1;at<nt;at++){const dt=rt[at];let ot;if(Array.isArray(dt))ot=Ht(this,tt,qr).call(this,dt);else if(ct(this,j).has(dt))ot=ct(this,j).get(dt).visible;else return(0,o.warn)(`Optional content group not found: ${dt}`),!0;switch(it){case"And":if(!ot)return!1;break;case"Or":if(ot)return!0;break;case"Not":return!ot;default:return!0}}return it==="And"},e.OptionalContentConfig=g},(s,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var o=a(1),c=a(6);class d{constructor({length:b,initialData:j,progressiveDone:$=!1,contentDispositionFilename:_e=null,disableRange:tt=!1,disableStream:et=!1},st){if((0,o.assert)(st,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=$,this._contentDispositionFilename=_e,(j==null?void 0:j.length)>0){const rt=j instanceof Uint8Array&&j.byteLength===j.buffer.byteLength?j.buffer:new Uint8Array(j).buffer;this._queuedChunks.push(rt)}this._pdfDataRangeTransport=st,this._isStreamingSupported=!et,this._isRangeSupported=!tt,this._contentLength=b,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((rt,nt)=>{this._onReceiveData({begin:rt,chunk:nt})}),this._pdfDataRangeTransport.addProgressListener((rt,nt)=>{this._onProgress({loaded:rt,total:nt})}),this._pdfDataRangeTransport.addProgressiveReadListener(rt=>{this._onReceiveData({chunk:rt})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:b,chunk:j}){const $=j instanceof Uint8Array&&j.byteLength===j.buffer.byteLength?j.buffer:new Uint8Array(j).buffer;if(b===void 0)this._fullRequestReader?this._fullRequestReader._enqueue($):this._queuedChunks.push($);else{const _e=this._rangeReaders.some(function(tt){return tt._begin!==b?!1:(tt._enqueue($),!0)});(0,o.assert)(_e,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var b;return((b=this._fullRequestReader)==null?void 0:b._loaded)??0}_onProgress(b){var j,$,_e,tt;b.total===void 0?($=(j=this._rangeReaders[0])==null?void 0:j.onProgress)==null||$.call(j,{loaded:b.loaded}):(tt=(_e=this._fullRequestReader)==null?void 0:_e.onProgress)==null||tt.call(_e,{loaded:b.loaded,total:b.total})}_onProgressiveDone(){var b;(b=this._fullRequestReader)==null||b.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(b){const j=this._rangeReaders.indexOf(b);j>=0&&this._rangeReaders.splice(j,1)}getFullReader(){(0,o.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const b=this._queuedChunks;return this._queuedChunks=null,new h(this,b,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(b,j){if(j<=this._progressiveDataLength)return null;const $=new g(this,b,j);return this._pdfDataRangeTransport.requestDataRange(b,j),this._rangeReaders.push($),$}cancelAllRequests(b){var j;(j=this._fullRequestReader)==null||j.cancel(b);for(const $ of this._rangeReaders.slice(0))$.cancel(b);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=d;class h{constructor(b,j,$=!1,_e=null){this._stream=b,this._done=$||!1,this._filename=(0,c.isPdfFile)(_e)?_e:null,this._queuedChunks=j||[],this._loaded=0;for(const tt of this._queuedChunks)this._loaded+=tt.byteLength;this._requests=[],this._headersReady=Promise.resolve(),b._fullRequestReader=this,this.onProgress=null}_enqueue(b){this._done||(this._requests.length>0?this._requests.shift().resolve({value:b,done:!1}):this._queuedChunks.push(b),this._loaded+=b.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const b=new o.PromiseCapability;return this._requests.push(b),b.promise}cancel(b){this._done=!0;for(const j of this._requests)j.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class g{constructor(b,j,$){this._stream=b,this._begin=j,this._end=$,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(b){if(!this._done){if(this._requests.length===0)this._queuedChunk=b;else{this._requests.shift().resolve({value:b,done:!1});for(const $ of this._requests)$.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const j=this._queuedChunk;return this._queuedChunk=null,{value:j,done:!1}}if(this._done)return{value:void 0,done:!0};const b=new o.PromiseCapability;return this._requests.push(b),b.promise}cancel(b){this._done=!0;for(const j of this._requests)j.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(s,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var o=a(1),c=a(20);function d($,_e,tt){return{method:"GET",headers:$,signal:tt.signal,mode:"cors",credentials:_e?"include":"same-origin",redirect:"follow"}}function h($){const _e=new Headers;for(const tt in $){const et=$[tt];et!==void 0&&_e.append(tt,et)}return _e}function g($){return $ instanceof Uint8Array?$.buffer:$ instanceof ArrayBuffer?$:((0,o.warn)(`getArrayBuffer - unexpected data format: ${$}`),new Uint8Array($).buffer)}class _{constructor(_e){this.source=_e,this.isHttp=/^https?:/i.test(_e.url),this.httpHeaders=this.isHttp&&_e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var _e;return((_e=this._fullRequestReader)==null?void 0:_e._loaded)??0}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new b(this),this._fullRequestReader}getRangeReader(_e,tt){if(tt<=this._progressiveDataLength)return null;const et=new j(this,_e,tt);return this._rangeRequestReaders.push(et),et}cancelAllRequests(_e){var tt;(tt=this._fullRequestReader)==null||tt.cancel(_e);for(const et of this._rangeRequestReaders.slice(0))et.cancel(_e)}}e.PDFFetchStream=_;class b{constructor(_e){this._stream=_e,this._reader=null,this._loaded=0,this._filename=null;const tt=_e.source;this._withCredentials=tt.withCredentials||!1,this._contentLength=tt.length,this._headersCapability=new o.PromiseCapability,this._disableRange=tt.disableRange||!1,this._rangeChunkSize=tt.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!tt.disableStream,this._isRangeSupported=!tt.disableRange,this._headers=h(this._stream.httpHeaders);const et=tt.url;fetch(et,d(this._headers,this._withCredentials,this._abortController)).then(st=>{if(!(0,c.validateResponseStatus)(st.status))throw(0,c.createResponseStatusError)(st.status,et);this._reader=st.body.getReader(),this._headersCapability.resolve();const rt=at=>st.headers.get(at),{allowRangeRequests:nt,suggestedLength:it}=(0,c.validateRangeRequestCapabilities)({getResponseHeader:rt,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=nt,this._contentLength=it||this._contentLength,this._filename=(0,c.extractFilenameFromHeader)(rt),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new o.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var et;await this._headersCapability.promise;const{value:_e,done:tt}=await this._reader.read();return tt?{value:_e,done:tt}:(this._loaded+=_e.byteLength,(et=this.onProgress)==null||et.call(this,{loaded:this._loaded,total:this._contentLength}),{value:g(_e),done:!1})}cancel(_e){var tt;(tt=this._reader)==null||tt.cancel(_e),this._abortController.abort()}}class j{constructor(_e,tt,et){this._stream=_e,this._reader=null,this._loaded=0;const st=_e.source;this._withCredentials=st.withCredentials||!1,this._readCapability=new o.PromiseCapability,this._isStreamingSupported=!st.disableStream,this._abortController=new AbortController,this._headers=h(this._stream.httpHeaders),this._headers.append("Range",`bytes=${tt}-${et-1}`);const rt=st.url;fetch(rt,d(this._headers,this._withCredentials,this._abortController)).then(nt=>{if(!(0,c.validateResponseStatus)(nt.status))throw(0,c.createResponseStatusError)(nt.status,rt);this._readCapability.resolve(),this._reader=nt.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var et;await this._readCapability.promise;const{value:_e,done:tt}=await this._reader.read();return tt?{value:_e,done:tt}:(this._loaded+=_e.byteLength,(et=this.onProgress)==null||et.call(this,{loaded:this._loaded}),{value:g(_e),done:!1})}cancel(_e){var tt;(tt=this._reader)==null||tt.cancel(_e),this._abortController.abort()}}},(s,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=_,e.extractFilenameFromHeader=g,e.validateRangeRequestCapabilities=h,e.validateResponseStatus=b;var o=a(1),c=a(21),d=a(6);function h({getResponseHeader:j,isHttp:$,rangeChunkSize:_e,disableRange:tt}){const et={allowRangeRequests:!1,suggestedLength:void 0},st=parseInt(j("Content-Length"),10);return!Number.isInteger(st)||(et.suggestedLength=st,st<=2*_e)||tt||!$||j("Accept-Ranges")!=="bytes"||(j("Content-Encoding")||"identity")!=="identity"||(et.allowRangeRequests=!0),et}function g(j){const $=j("Content-Disposition");if($){let _e=(0,c.getFilenameFromContentDispositionHeader)($);if(_e.includes("%"))try{_e=decodeURIComponent(_e)}catch{}if((0,d.isPdfFile)(_e))return _e}return null}function _(j,$){return j===404||j===0&&$.startsWith("file:")?new o.MissingPDFException('Missing PDF "'+$+'".'):new o.UnexpectedResponseException(`Unexpected server response (${j}) while retrieving PDF "${$}".`,j)}function b(j){return j===200||j===206}},(s,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=c;var o=a(1);function c(d){let h=!0,g=_("filename\\*","i").exec(d);if(g){g=g[1];let st=_e(g);return st=unescape(st),st=tt(st),st=et(st),j(st)}if(g=$(d),g){const st=et(g);return j(st)}if(g=_("filename","i").exec(d),g){g=g[1];let st=_e(g);return st=et(st),j(st)}function _(st,rt){return new RegExp("(?:^|;)\\s*"+st+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',rt)}function b(st,rt){if(st){if(!/^[\x00-\xFF]+$/.test(rt))return rt;try{const nt=new TextDecoder(st,{fatal:!0}),it=(0,o.stringToBytes)(rt);rt=nt.decode(it),h=!1}catch{}}return rt}function j(st){return h&&/[\x80-\xff]/.test(st)&&(st=b("utf-8",st),h&&(st=b("iso-8859-1",st))),st}function $(st){const rt=[];let nt;const it=_("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(nt=it.exec(st))!==null;){let[,dt,ot,ht]=nt;if(dt=parseInt(dt,10),dt in rt){if(dt===0)break;continue}rt[dt]=[ot,ht]}const at=[];for(let dt=0;dt<rt.length&&dt in rt;++dt){let[ot,ht]=rt[dt];ht=_e(ht),ot&&(ht=unescape(ht),dt===0&&(ht=tt(ht))),at.push(ht)}return at.join("")}function _e(st){if(st.startsWith('"')){const rt=st.slice(1).split('\\"');for(let nt=0;nt<rt.length;++nt){const it=rt[nt].indexOf('"');it!==-1&&(rt[nt]=rt[nt].slice(0,it),rt.length=nt+1),rt[nt]=rt[nt].replaceAll(/\\(.)/g,"$1")}st=rt.join('"')}return st}function tt(st){const rt=st.indexOf("'");if(rt===-1)return st;const nt=st.slice(0,rt),at=st.slice(rt+1).replace(/^[^']*'/,"");return b(nt,at)}function et(st){return!st.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(st)?st:st.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(rt,nt,it,at){if(it==="q"||it==="Q")return at=at.replaceAll("_"," "),at=at.replaceAll(/=([0-9a-fA-F]{2})/g,function(dt,ot){return String.fromCharCode(parseInt(ot,16))}),b(nt,at);try{at=atob(at)}catch{}return b(nt,at)})}return""}},(s,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var o=a(1),c=a(20);const d=200,h=206;function g(_e){const tt=_e.response;return typeof tt!="string"?tt:(0,o.stringToBytes)(tt).buffer}class _{constructor(tt,et={}){this.url=tt,this.isHttp=/^https?:/i.test(tt),this.httpHeaders=this.isHttp&&et.httpHeaders||Object.create(null),this.withCredentials=et.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(tt,et,st){const rt={begin:tt,end:et};for(const nt in st)rt[nt]=st[nt];return this.request(rt)}requestFull(tt){return this.request(tt)}request(tt){const et=new XMLHttpRequest,st=this.currXhrId++,rt=this.pendingRequests[st]={xhr:et};et.open("GET",this.url),et.withCredentials=this.withCredentials;for(const nt in this.httpHeaders){const it=this.httpHeaders[nt];it!==void 0&&et.setRequestHeader(nt,it)}return this.isHttp&&"begin"in tt&&"end"in tt?(et.setRequestHeader("Range",`bytes=${tt.begin}-${tt.end-1}`),rt.expectedStatus=h):rt.expectedStatus=d,et.responseType="arraybuffer",tt.onError&&(et.onerror=function(nt){tt.onError(et.status)}),et.onreadystatechange=this.onStateChange.bind(this,st),et.onprogress=this.onProgress.bind(this,st),rt.onHeadersReceived=tt.onHeadersReceived,rt.onDone=tt.onDone,rt.onError=tt.onError,rt.onProgress=tt.onProgress,et.send(null),st}onProgress(tt,et){var rt;const st=this.pendingRequests[tt];st&&((rt=st.onProgress)==null||rt.call(st,et))}onStateChange(tt,et){var dt,ot,ht;const st=this.pendingRequests[tt];if(!st)return;const rt=st.xhr;if(rt.readyState>=2&&st.onHeadersReceived&&(st.onHeadersReceived(),delete st.onHeadersReceived),rt.readyState!==4||!(tt in this.pendingRequests))return;if(delete this.pendingRequests[tt],rt.status===0&&this.isHttp){(dt=st.onError)==null||dt.call(st,rt.status);return}const nt=rt.status||d;if(!(nt===d&&st.expectedStatus===h)&&nt!==st.expectedStatus){(ot=st.onError)==null||ot.call(st,rt.status);return}const at=g(rt);if(nt===h){const ut=rt.getResponseHeader("Content-Range"),pt=/bytes (\d+)-(\d+)\/(\d+)/.exec(ut);st.onDone({begin:parseInt(pt[1],10),chunk:at})}else at?st.onDone({begin:0,chunk:at}):(ht=st.onError)==null||ht.call(st,rt.status)}getRequestXhr(tt){return this.pendingRequests[tt].xhr}isPendingRequest(tt){return tt in this.pendingRequests}abortRequest(tt){const et=this.pendingRequests[tt].xhr;delete this.pendingRequests[tt],et.abort()}}class b{constructor(tt){this._source=tt,this._manager=new _(tt.url,{httpHeaders:tt.httpHeaders,withCredentials:tt.withCredentials}),this._rangeChunkSize=tt.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(tt){const et=this._rangeRequestReaders.indexOf(tt);et>=0&&this._rangeRequestReaders.splice(et,1)}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new j(this._manager,this._source),this._fullRequestReader}getRangeReader(tt,et){const st=new $(this._manager,tt,et);return st.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(st),st}cancelAllRequests(tt){var et;(et=this._fullRequestReader)==null||et.cancel(tt);for(const st of this._rangeRequestReaders.slice(0))st.cancel(tt)}}e.PDFNetworkStream=b;class j{constructor(tt,et){this._manager=tt;const st={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=et.url,this._fullRequestId=tt.requestFull(st),this._headersReceivedCapability=new o.PromiseCapability,this._disableRange=et.disableRange||!1,this._contentLength=et.length,this._rangeChunkSize=et.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const tt=this._fullRequestId,et=this._manager.getRequestXhr(tt),st=it=>et.getResponseHeader(it),{allowRangeRequests:rt,suggestedLength:nt}=(0,c.validateRangeRequestCapabilities)({getResponseHeader:st,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});rt&&(this._isRangeSupported=!0),this._contentLength=nt||this._contentLength,this._filename=(0,c.extractFilenameFromHeader)(st),this._isRangeSupported&&this._manager.abortRequest(tt),this._headersReceivedCapability.resolve()}_onDone(tt){if(tt&&(this._requests.length>0?this._requests.shift().resolve({value:tt.chunk,done:!1}):this._cachedChunks.push(tt.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const et of this._requests)et.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(tt){this._storedError=(0,c.createResponseStatusError)(tt,this._url),this._headersReceivedCapability.reject(this._storedError);for(const et of this._requests)et.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(tt){var et;(et=this.onProgress)==null||et.call(this,{loaded:tt.loaded,total:tt.lengthComputable?tt.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const tt=new o.PromiseCapability;return this._requests.push(tt),tt.promise}cancel(tt){this._done=!0,this._headersReceivedCapability.reject(tt);for(const et of this._requests)et.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class ${constructor(tt,et,st){this._manager=tt;const rt={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=tt.url,this._requestId=tt.requestRange(et,st,rt),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var tt;(tt=this.onClosed)==null||tt.call(this,this)}_onDone(tt){const et=tt.chunk;this._requests.length>0?this._requests.shift().resolve({value:et,done:!1}):this._queuedChunk=et,this._done=!0;for(const st of this._requests)st.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(tt){this._storedError=(0,c.createResponseStatusError)(tt,this._url);for(const et of this._requests)et.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(tt){var et;this.isStreamingSupported||(et=this.onProgress)==null||et.call(this,{loaded:tt.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const et=this._queuedChunk;return this._queuedChunk=null,{value:et,done:!1}}if(this._done)return{value:void 0,done:!0};const tt=new o.PromiseCapability;return this._requests.push(tt),tt.promise}cancel(tt){this._done=!0;for(const et of this._requests)et.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(s,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var o=a(1),c=a(20);const d=/^file:\/\/\/[a-zA-Z]:\//;function h(st){const rt=require$$5,nt=rt.parse(st);return nt.protocol==="file:"||nt.host?nt:/^[a-z]:[/\\]/i.test(st)?rt.parse(`file:///${st}`):(nt.host||(nt.protocol="file:"),nt)}class g{constructor(rt){this.source=rt,this.url=h(rt.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&rt.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var rt;return((rt=this._fullRequestReader)==null?void 0:rt._loaded)??0}getFullReader(){return(0,o.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new tt(this):new $(this),this._fullRequestReader}getRangeReader(rt,nt){if(nt<=this._progressiveDataLength)return null;const it=this.isFsUrl?new et(this,rt,nt):new _e(this,rt,nt);return this._rangeRequestReaders.push(it),it}cancelAllRequests(rt){var nt;(nt=this._fullRequestReader)==null||nt.cancel(rt);for(const it of this._rangeRequestReaders.slice(0))it.cancel(rt)}}e.PDFNodeStream=g;class _{constructor(rt){this._url=rt.url,this._done=!1,this._storedError=null,this.onProgress=null;const nt=rt.source;this._contentLength=nt.length,this._loaded=0,this._filename=null,this._disableRange=nt.disableRange||!1,this._rangeChunkSize=nt.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!nt.disableStream,this._isRangeSupported=!nt.disableRange,this._readableStream=null,this._readCapability=new o.PromiseCapability,this._headersCapability=new o.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var it;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const rt=this._readableStream.read();return rt===null?(this._readCapability=new o.PromiseCapability,this.read()):(this._loaded+=rt.length,(it=this.onProgress)==null||it.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(rt).buffer,done:!1})}cancel(rt){if(!this._readableStream){this._error(rt);return}this._readableStream.destroy(rt)}_error(rt){this._storedError=rt,this._readCapability.resolve()}_setReadableStream(rt){this._readableStream=rt,rt.on("readable",()=>{this._readCapability.resolve()}),rt.on("end",()=>{rt.destroy(),this._done=!0,this._readCapability.resolve()}),rt.on("error",nt=>{this._error(nt)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new o.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class b{constructor(rt){this._url=rt.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new o.PromiseCapability;const nt=rt.source;this._isStreamingSupported=!nt.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var it;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const rt=this._readableStream.read();return rt===null?(this._readCapability=new o.PromiseCapability,this.read()):(this._loaded+=rt.length,(it=this.onProgress)==null||it.call(this,{loaded:this._loaded}),{value:new Uint8Array(rt).buffer,done:!1})}cancel(rt){if(!this._readableStream){this._error(rt);return}this._readableStream.destroy(rt)}_error(rt){this._storedError=rt,this._readCapability.resolve()}_setReadableStream(rt){this._readableStream=rt,rt.on("readable",()=>{this._readCapability.resolve()}),rt.on("end",()=>{rt.destroy(),this._done=!0,this._readCapability.resolve()}),rt.on("error",nt=>{this._error(nt)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function j(st,rt){return{protocol:st.protocol,auth:st.auth,host:st.hostname,port:st.port,path:st.path,method:"GET",headers:rt}}class $ extends _{constructor(rt){super(rt);const nt=it=>{if(it.statusCode===404){const ht=new o.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=ht,this._headersCapability.reject(ht);return}this._headersCapability.resolve(),this._setReadableStream(it);const at=ht=>this._readableStream.headers[ht.toLowerCase()],{allowRangeRequests:dt,suggestedLength:ot}=(0,c.validateRangeRequestCapabilities)({getResponseHeader:at,isHttp:rt.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=dt,this._contentLength=ot||this._contentLength,this._filename=(0,c.extractFilenameFromHeader)(at)};if(this._request=null,this._url.protocol==="http:"){const it=require$$5;this._request=it.request(j(this._url,rt.httpHeaders),nt)}else{const it=require$$5;this._request=it.request(j(this._url,rt.httpHeaders),nt)}this._request.on("error",it=>{this._storedError=it,this._headersCapability.reject(it)}),this._request.end()}}class _e extends b{constructor(rt,nt,it){super(rt),this._httpHeaders={};for(const dt in rt.httpHeaders){const ot=rt.httpHeaders[dt];ot!==void 0&&(this._httpHeaders[dt]=ot)}this._httpHeaders.Range=`bytes=${nt}-${it-1}`;const at=dt=>{if(dt.statusCode===404){const ot=new o.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=ot;return}this._setReadableStream(dt)};if(this._request=null,this._url.protocol==="http:"){const dt=require$$5;this._request=dt.request(j(this._url,this._httpHeaders),at)}else{const dt=require$$5;this._request=dt.request(j(this._url,this._httpHeaders),at)}this._request.on("error",dt=>{this._storedError=dt}),this._request.end()}}class tt extends _{constructor(rt){super(rt);let nt=decodeURIComponent(this._url.path);d.test(this._url.href)&&(nt=nt.replace(/^\//,""));const it=require$$5;it.lstat(nt,(at,dt)=>{if(at){at.code==="ENOENT"&&(at=new o.MissingPDFException(`Missing PDF "${nt}".`)),this._storedError=at,this._headersCapability.reject(at);return}this._contentLength=dt.size,this._setReadableStream(it.createReadStream(nt)),this._headersCapability.resolve()})}}class et extends b{constructor(rt,nt,it){super(rt);let at=decodeURIComponent(this._url.path);d.test(this._url.href)&&(at=at.replace(/^\//,""));const dt=require$$5;this._setReadableStream(dt.createReadStream(at,{start:nt,end:it-1}))}}},(s,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var o=a(6),c=a(1);const d={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},h="http://www.w3.org/XML/1998/namespace",g="http://www.w3.org/1999/xlink",_=["butt","round","square"],b=["miter","round","bevel"],j=function(dt,ot="",ht=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!ht)return URL.createObjectURL(new Blob([dt],{type:ot}));const ut="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let pt=`data:${ot};base64,`;for(let _t=0,wt=dt.length;_t<wt;_t+=3){const mt=dt[_t]&255,Et=dt[_t+1]&255,Pt=dt[_t+2]&255,jt=mt>>2,St=(mt&3)<<4|Et>>4,Ot=_t+1<wt?(Et&15)<<2|Pt>>6:64,Ct=_t+2<wt?Pt&63:64;pt+=ut[jt]+ut[St]+ut[Ot]+ut[Ct]}return pt},$=function(){const dt=new Uint8Array([137,80,78,71,13,10,26,10]),ot=12,ht=new Int32Array(256);for(let Pt=0;Pt<256;Pt++){let jt=Pt;for(let St=0;St<8;St++)jt=jt&1?3988292384^jt>>1&2147483647:jt>>1&2147483647;ht[Pt]=jt}function ut(Pt,jt,St){let Ot=-1;for(let Ct=jt;Ct<St;Ct++){const Rt=(Ot^Pt[Ct])&255,bt=ht[Rt];Ot=Ot>>>8^bt}return Ot^-1}function pt(Pt,jt,St,Ot){let Ct=Ot;const Rt=jt.length;St[Ct]=Rt>>24&255,St[Ct+1]=Rt>>16&255,St[Ct+2]=Rt>>8&255,St[Ct+3]=Rt&255,Ct+=4,St[Ct]=Pt.charCodeAt(0)&255,St[Ct+1]=Pt.charCodeAt(1)&255,St[Ct+2]=Pt.charCodeAt(2)&255,St[Ct+3]=Pt.charCodeAt(3)&255,Ct+=4,St.set(jt,Ct),Ct+=jt.length;const bt=ut(St,Ot+4,Ct);St[Ct]=bt>>24&255,St[Ct+1]=bt>>16&255,St[Ct+2]=bt>>8&255,St[Ct+3]=bt&255}function _t(Pt,jt,St){let Ot=1,Ct=0;for(let Rt=jt;Rt<St;++Rt)Ot=(Ot+(Pt[Rt]&255))%65521,Ct=(Ct+Ot)%65521;return Ct<<16|Ot}function wt(Pt){if(!c.isNodeJS)return mt(Pt);try{const jt=parseInt(process.versions.node)>=8?Pt:Buffer.from(Pt),St=require$$5.deflateSync(jt,{level:9});return St instanceof Uint8Array?St:new Uint8Array(St)}catch(jt){(0,c.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+jt)}return mt(Pt)}function mt(Pt){let jt=Pt.length;const St=65535,Ot=Math.ceil(jt/St),Ct=new Uint8Array(2+jt+Ot*5+4);let Rt=0;Ct[Rt++]=120,Ct[Rt++]=156;let bt=0;for(;jt>St;)Ct[Rt++]=0,Ct[Rt++]=255,Ct[Rt++]=255,Ct[Rt++]=0,Ct[Rt++]=0,Ct.set(Pt.subarray(bt,bt+St),Rt),Rt+=St,bt+=St,jt-=St;Ct[Rt++]=1,Ct[Rt++]=jt&255,Ct[Rt++]=jt>>8&255,Ct[Rt++]=~jt&65535&255,Ct[Rt++]=(~jt&65535)>>8&255,Ct.set(Pt.subarray(bt),Rt),Rt+=Pt.length-bt;const Tt=_t(Pt,0,Pt.length);return Ct[Rt++]=Tt>>24&255,Ct[Rt++]=Tt>>16&255,Ct[Rt++]=Tt>>8&255,Ct[Rt++]=Tt&255,Ct}function Et(Pt,jt,St,Ot){const Ct=Pt.width,Rt=Pt.height;let bt,Tt,$t;const xt=Pt.data;switch(jt){case c.ImageKind.GRAYSCALE_1BPP:Tt=0,bt=1,$t=Ct+7>>3;break;case c.ImageKind.RGB_24BPP:Tt=2,bt=8,$t=Ct*3;break;case c.ImageKind.RGBA_32BPP:Tt=6,bt=8,$t=Ct*4;break;default:throw new Error("invalid format")}const ft=new Uint8Array((1+$t)*Rt);let yt=0,vt=0;for(let rn=0;rn<Rt;++rn)ft[yt++]=0,ft.set(xt.subarray(vt,vt+$t),yt),vt+=$t,yt+=$t;if(jt===c.ImageKind.GRAYSCALE_1BPP&&Ot){yt=0;for(let rn=0;rn<Rt;rn++){yt++;for(let nn=0;nn<$t;nn++)ft[yt++]^=255}}const It=new Uint8Array([Ct>>24&255,Ct>>16&255,Ct>>8&255,Ct&255,Rt>>24&255,Rt>>16&255,Rt>>8&255,Rt&255,bt,Tt,0,0,0]),Lt=wt(ft),Nt=dt.length+ot*3+It.length+Lt.length,Bt=new Uint8Array(Nt);let Kt=0;return Bt.set(dt,Kt),Kt+=dt.length,pt("IHDR",It,Bt,Kt),Kt+=ot+It.length,pt("IDATA",Lt,Bt,Kt),Kt+=ot+Lt.length,pt("IEND",new Uint8Array(0),Bt,Kt),j(Bt,"image/png",St)}return function(jt,St,Ot){const Ct=jt.kind===void 0?c.ImageKind.GRAYSCALE_1BPP:jt.kind;return Et(jt,Ct,St,Ot)}}();class _e{constructor(){this.fontSizeScale=1,this.fontWeight=d.fontWeight,this.fontSize=0,this.textMatrix=c.IDENTITY_MATRIX,this.fontMatrix=c.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=c.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=d.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(ot,ht){this.x=ot,this.y=ht}}function tt(dt){let ot=[];const ht=[];for(const ut of dt){if(ut.fn==="save"){ot.push({fnId:92,fn:"group",items:[]}),ht.push(ot),ot=ot.at(-1).items;continue}ut.fn==="restore"?ot=ht.pop():ot.push(ut)}return ot}function et(dt){if(Number.isInteger(dt))return dt.toString();const ot=dt.toFixed(10);let ht=ot.length-1;if(ot[ht]!=="0")return ot;do ht--;while(ot[ht]==="0");return ot.substring(0,ot[ht]==="."?ht:ht+1)}function st(dt){if(dt[4]===0&&dt[5]===0){if(dt[1]===0&&dt[2]===0)return dt[0]===1&&dt[3]===1?"":`scale(${et(dt[0])} ${et(dt[3])})`;if(dt[0]===dt[3]&&dt[1]===-dt[2]){const ot=Math.acos(dt[0])*180/Math.PI;return`rotate(${et(ot)})`}}else if(dt[0]===1&&dt[1]===0&&dt[2]===0&&dt[3]===1)return`translate(${et(dt[4])} ${et(dt[5])})`;return`matrix(${et(dt[0])} ${et(dt[1])} ${et(dt[2])} ${et(dt[3])} ${et(dt[4])} ${et(dt[5])})`}let rt=0,nt=0,it=0;class at{constructor(ot,ht,ut=!1){(0,o.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new o.DOMSVGFactory,this.current=new _e,this.transformMatrix=c.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=ot,this.objs=ht,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!ut,this._operatorIdMapping=[];for(const pt in c.OPS)this._operatorIdMapping[c.OPS[pt]]=pt}getObject(ot,ht=null){return typeof ot=="string"?ot.startsWith("g_")?this.commonObjs.get(ot):this.objs.get(ot):ht}save(){this.transformStack.push(this.transformMatrix);const ot=this.current;this.extraStack.push(ot),this.current=ot.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(ot){this.save(),this.executeOpTree(ot),this.restore()}loadDependencies(ot){const ht=ot.fnArray,ut=ot.argsArray;for(let pt=0,_t=ht.length;pt<_t;pt++)if(ht[pt]===c.OPS.dependency)for(const wt of ut[pt]){const mt=wt.startsWith("g_")?this.commonObjs:this.objs,Et=new Promise(Pt=>{mt.get(wt,Pt)});this.current.dependencies.push(Et)}return Promise.all(this.current.dependencies)}transform(ot,ht,ut,pt,_t,wt){const mt=[ot,ht,ut,pt,_t,wt];this.transformMatrix=c.Util.transform(this.transformMatrix,mt),this.tgrp=null}getSVG(ot,ht){this.viewport=ht;const ut=this._initialize(ht);return this.loadDependencies(ot).then(()=>(this.transformMatrix=c.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(ot)),ut))}convertOpList(ot){const ht=this._operatorIdMapping,ut=ot.argsArray,pt=ot.fnArray,_t=[];for(let wt=0,mt=pt.length;wt<mt;wt++){const Et=pt[wt];_t.push({fnId:Et,fn:ht[Et],args:ut[wt]})}return tt(_t)}executeOpTree(ot){for(const ht of ot){const ut=ht.fn,pt=ht.fnId,_t=ht.args;switch(pt|0){case c.OPS.beginText:this.beginText();break;case c.OPS.dependency:break;case c.OPS.setLeading:this.setLeading(_t);break;case c.OPS.setLeadingMoveText:this.setLeadingMoveText(_t[0],_t[1]);break;case c.OPS.setFont:this.setFont(_t);break;case c.OPS.showText:this.showText(_t[0]);break;case c.OPS.showSpacedText:this.showText(_t[0]);break;case c.OPS.endText:this.endText();break;case c.OPS.moveText:this.moveText(_t[0],_t[1]);break;case c.OPS.setCharSpacing:this.setCharSpacing(_t[0]);break;case c.OPS.setWordSpacing:this.setWordSpacing(_t[0]);break;case c.OPS.setHScale:this.setHScale(_t[0]);break;case c.OPS.setTextMatrix:this.setTextMatrix(_t[0],_t[1],_t[2],_t[3],_t[4],_t[5]);break;case c.OPS.setTextRise:this.setTextRise(_t[0]);break;case c.OPS.setTextRenderingMode:this.setTextRenderingMode(_t[0]);break;case c.OPS.setLineWidth:this.setLineWidth(_t[0]);break;case c.OPS.setLineJoin:this.setLineJoin(_t[0]);break;case c.OPS.setLineCap:this.setLineCap(_t[0]);break;case c.OPS.setMiterLimit:this.setMiterLimit(_t[0]);break;case c.OPS.setFillRGBColor:this.setFillRGBColor(_t[0],_t[1],_t[2]);break;case c.OPS.setStrokeRGBColor:this.setStrokeRGBColor(_t[0],_t[1],_t[2]);break;case c.OPS.setStrokeColorN:this.setStrokeColorN(_t);break;case c.OPS.setFillColorN:this.setFillColorN(_t);break;case c.OPS.shadingFill:this.shadingFill(_t[0]);break;case c.OPS.setDash:this.setDash(_t[0],_t[1]);break;case c.OPS.setRenderingIntent:this.setRenderingIntent(_t[0]);break;case c.OPS.setFlatness:this.setFlatness(_t[0]);break;case c.OPS.setGState:this.setGState(_t[0]);break;case c.OPS.fill:this.fill();break;case c.OPS.eoFill:this.eoFill();break;case c.OPS.stroke:this.stroke();break;case c.OPS.fillStroke:this.fillStroke();break;case c.OPS.eoFillStroke:this.eoFillStroke();break;case c.OPS.clip:this.clip("nonzero");break;case c.OPS.eoClip:this.clip("evenodd");break;case c.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case c.OPS.paintImageXObject:this.paintImageXObject(_t[0]);break;case c.OPS.paintInlineImageXObject:this.paintInlineImageXObject(_t[0]);break;case c.OPS.paintImageMaskXObject:this.paintImageMaskXObject(_t[0]);break;case c.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(_t[0],_t[1]);break;case c.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case c.OPS.closePath:this.closePath();break;case c.OPS.closeStroke:this.closeStroke();break;case c.OPS.closeFillStroke:this.closeFillStroke();break;case c.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case c.OPS.nextLine:this.nextLine();break;case c.OPS.transform:this.transform(_t[0],_t[1],_t[2],_t[3],_t[4],_t[5]);break;case c.OPS.constructPath:this.constructPath(_t[0],_t[1]);break;case c.OPS.endPath:this.endPath();break;case 92:this.group(ht.items);break;default:(0,c.warn)(`Unimplemented operator ${ut}`);break}}}setWordSpacing(ot){this.current.wordSpacing=ot}setCharSpacing(ot){this.current.charSpacing=ot}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(ot,ht,ut,pt,_t,wt){const mt=this.current;mt.textMatrix=mt.lineMatrix=[ot,ht,ut,pt,_t,wt],mt.textMatrixScale=Math.hypot(ot,ht),mt.x=mt.lineX=0,mt.y=mt.lineY=0,mt.xcoords=[],mt.ycoords=[],mt.tspan=this.svgFactory.createElement("svg:tspan"),mt.tspan.setAttributeNS(null,"font-family",mt.fontFamily),mt.tspan.setAttributeNS(null,"font-size",`${et(mt.fontSize)}px`),mt.tspan.setAttributeNS(null,"y",et(-mt.y)),mt.txtElement=this.svgFactory.createElement("svg:text"),mt.txtElement.append(mt.tspan)}beginText(){const ot=this.current;ot.x=ot.lineX=0,ot.y=ot.lineY=0,ot.textMatrix=c.IDENTITY_MATRIX,ot.lineMatrix=c.IDENTITY_MATRIX,ot.textMatrixScale=1,ot.tspan=this.svgFactory.createElement("svg:tspan"),ot.txtElement=this.svgFactory.createElement("svg:text"),ot.txtgrp=this.svgFactory.createElement("svg:g"),ot.xcoords=[],ot.ycoords=[]}moveText(ot,ht){const ut=this.current;ut.x=ut.lineX+=ot,ut.y=ut.lineY+=ht,ut.xcoords=[],ut.ycoords=[],ut.tspan=this.svgFactory.createElement("svg:tspan"),ut.tspan.setAttributeNS(null,"font-family",ut.fontFamily),ut.tspan.setAttributeNS(null,"font-size",`${et(ut.fontSize)}px`),ut.tspan.setAttributeNS(null,"y",et(-ut.y))}showText(ot){const ht=this.current,ut=ht.font,pt=ht.fontSize;if(pt===0)return;const _t=ht.fontSizeScale,wt=ht.charSpacing,mt=ht.wordSpacing,Et=ht.fontDirection,Pt=ht.textHScale*Et,jt=ut.vertical,St=jt?1:-1,Ot=ut.defaultVMetrics,Ct=pt*ht.fontMatrix[0];let Rt=0;for(const $t of ot){if($t===null){Rt+=Et*mt;continue}else if(typeof $t=="number"){Rt+=St*$t*pt/1e3;continue}const xt=($t.isSpace?mt:0)+wt,ft=$t.fontChar;let yt,vt,It=$t.width;if(jt){let Nt;const Bt=$t.vmetric||Ot;Nt=$t.vmetric?Bt[1]:It*.5,Nt=-Nt*Ct;const Kt=Bt[2]*Ct;It=Bt?-Bt[0]:It,yt=Nt/_t,vt=(Rt+Kt)/_t}else yt=Rt/_t,vt=0;($t.isInFont||ut.missingFile)&&(ht.xcoords.push(ht.x+yt),jt&&ht.ycoords.push(-ht.y+vt),ht.tspan.textContent+=ft);const Lt=jt?It*Ct-xt*Et:It*Ct+xt*Et;Rt+=Lt}ht.tspan.setAttributeNS(null,"x",ht.xcoords.map(et).join(" ")),jt?ht.tspan.setAttributeNS(null,"y",ht.ycoords.map(et).join(" ")):ht.tspan.setAttributeNS(null,"y",et(-ht.y)),jt?ht.y-=Rt:ht.x+=Rt*Pt,ht.tspan.setAttributeNS(null,"font-family",ht.fontFamily),ht.tspan.setAttributeNS(null,"font-size",`${et(ht.fontSize)}px`),ht.fontStyle!==d.fontStyle&&ht.tspan.setAttributeNS(null,"font-style",ht.fontStyle),ht.fontWeight!==d.fontWeight&&ht.tspan.setAttributeNS(null,"font-weight",ht.fontWeight);const bt=ht.textRenderingMode&c.TextRenderingMode.FILL_STROKE_MASK;if(bt===c.TextRenderingMode.FILL||bt===c.TextRenderingMode.FILL_STROKE?(ht.fillColor!==d.fillColor&&ht.tspan.setAttributeNS(null,"fill",ht.fillColor),ht.fillAlpha<1&&ht.tspan.setAttributeNS(null,"fill-opacity",ht.fillAlpha)):ht.textRenderingMode===c.TextRenderingMode.ADD_TO_PATH?ht.tspan.setAttributeNS(null,"fill","transparent"):ht.tspan.setAttributeNS(null,"fill","none"),bt===c.TextRenderingMode.STROKE||bt===c.TextRenderingMode.FILL_STROKE){const $t=1/(ht.textMatrixScale||1);this._setStrokeAttributes(ht.tspan,$t)}let Tt=ht.textMatrix;ht.textRise!==0&&(Tt=Tt.slice(),Tt[5]+=ht.textRise),ht.txtElement.setAttributeNS(null,"transform",`${st(Tt)} scale(${et(Pt)}, -1)`),ht.txtElement.setAttributeNS(h,"xml:space","preserve"),ht.txtElement.append(ht.tspan),ht.txtgrp.append(ht.txtElement),this._ensureTransformGroup().append(ht.txtElement)}setLeadingMoveText(ot,ht){this.setLeading(-ht),this.moveText(ot,ht)}addFontStyle(ot){if(!ot.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const ht=j(ot.data,ot.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${ot.loadedName}"; src: url(${ht}); }
`}setFont(ot){const ht=this.current,ut=this.commonObjs.get(ot[0]);let pt=ot[1];ht.font=ut,this.embedFonts&&!ut.missingFile&&!this.embeddedFonts[ut.loadedName]&&(this.addFontStyle(ut),this.embeddedFonts[ut.loadedName]=ut),ht.fontMatrix=ut.fontMatrix||c.FONT_IDENTITY_MATRIX;let _t="normal";ut.black?_t="900":ut.bold&&(_t="bold");const wt=ut.italic?"italic":"normal";pt<0?(pt=-pt,ht.fontDirection=-1):ht.fontDirection=1,ht.fontSize=pt,ht.fontFamily=ut.loadedName,ht.fontWeight=_t,ht.fontStyle=wt,ht.tspan=this.svgFactory.createElement("svg:tspan"),ht.tspan.setAttributeNS(null,"y",et(-ht.y)),ht.xcoords=[],ht.ycoords=[]}endText(){var ht;const ot=this.current;ot.textRenderingMode&c.TextRenderingMode.ADD_TO_PATH_FLAG&&((ht=ot.txtElement)!=null&&ht.hasChildNodes())&&(ot.element=ot.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(ot){ot>0&&(this.current.lineWidth=ot)}setLineCap(ot){this.current.lineCap=_[ot]}setLineJoin(ot){this.current.lineJoin=b[ot]}setMiterLimit(ot){this.current.miterLimit=ot}setStrokeAlpha(ot){this.current.strokeAlpha=ot}setStrokeRGBColor(ot,ht,ut){this.current.strokeColor=c.Util.makeHexColor(ot,ht,ut)}setFillAlpha(ot){this.current.fillAlpha=ot}setFillRGBColor(ot,ht,ut){this.current.fillColor=c.Util.makeHexColor(ot,ht,ut),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(ot){this.current.strokeColor=this._makeColorN_Pattern(ot)}setFillColorN(ot){this.current.fillColor=this._makeColorN_Pattern(ot)}shadingFill(ot){const{width:ht,height:ut}=this.viewport,pt=c.Util.inverseTransform(this.transformMatrix),[_t,wt,mt,Et]=c.Util.getAxialAlignedBoundingBox([0,0,ht,ut],pt),Pt=this.svgFactory.createElement("svg:rect");Pt.setAttributeNS(null,"x",_t),Pt.setAttributeNS(null,"y",wt),Pt.setAttributeNS(null,"width",mt-_t),Pt.setAttributeNS(null,"height",Et-wt),Pt.setAttributeNS(null,"fill",this._makeShadingPattern(ot)),this.current.fillAlpha<1&&Pt.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Pt)}_makeColorN_Pattern(ot){return ot[0]==="TilingPattern"?this._makeTilingPattern(ot):this._makeShadingPattern(ot)}_makeTilingPattern(ot){const ht=ot[1],ut=ot[2],pt=ot[3]||c.IDENTITY_MATRIX,[_t,wt,mt,Et]=ot[4],Pt=ot[5],jt=ot[6],St=ot[7],Ot=`shading${it++}`,[Ct,Rt,bt,Tt]=c.Util.normalizeRect([...c.Util.applyTransform([_t,wt],pt),...c.Util.applyTransform([mt,Et],pt)]),[$t,xt]=c.Util.singularValueDecompose2dScale(pt),ft=Pt*$t,yt=jt*xt,vt=this.svgFactory.createElement("svg:pattern");vt.setAttributeNS(null,"id",Ot),vt.setAttributeNS(null,"patternUnits","userSpaceOnUse"),vt.setAttributeNS(null,"width",ft),vt.setAttributeNS(null,"height",yt),vt.setAttributeNS(null,"x",`${Ct}`),vt.setAttributeNS(null,"y",`${Rt}`);const It=this.svg,Lt=this.transformMatrix,Nt=this.current.fillColor,Bt=this.current.strokeColor,Kt=this.svgFactory.create(bt-Ct,Tt-Rt);if(this.svg=Kt,this.transformMatrix=pt,St===2){const rn=c.Util.makeHexColor(...ht);this.current.fillColor=rn,this.current.strokeColor=rn}return this.executeOpTree(this.convertOpList(ut)),this.svg=It,this.transformMatrix=Lt,this.current.fillColor=Nt,this.current.strokeColor=Bt,vt.append(Kt.childNodes[0]),this.defs.append(vt),`url(#${Ot})`}_makeShadingPattern(ot){switch(typeof ot=="string"&&(ot=this.objs.get(ot)),ot[0]){case"RadialAxial":const ht=`shading${it++}`,ut=ot[3];let pt;switch(ot[1]){case"axial":const _t=ot[4],wt=ot[5];pt=this.svgFactory.createElement("svg:linearGradient"),pt.setAttributeNS(null,"id",ht),pt.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),pt.setAttributeNS(null,"x1",_t[0]),pt.setAttributeNS(null,"y1",_t[1]),pt.setAttributeNS(null,"x2",wt[0]),pt.setAttributeNS(null,"y2",wt[1]);break;case"radial":const mt=ot[4],Et=ot[5],Pt=ot[6],jt=ot[7];pt=this.svgFactory.createElement("svg:radialGradient"),pt.setAttributeNS(null,"id",ht),pt.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),pt.setAttributeNS(null,"cx",Et[0]),pt.setAttributeNS(null,"cy",Et[1]),pt.setAttributeNS(null,"r",jt),pt.setAttributeNS(null,"fx",mt[0]),pt.setAttributeNS(null,"fy",mt[1]),pt.setAttributeNS(null,"fr",Pt);break;default:throw new Error(`Unknown RadialAxial type: ${ot[1]}`)}for(const _t of ut){const wt=this.svgFactory.createElement("svg:stop");wt.setAttributeNS(null,"offset",_t[0]),wt.setAttributeNS(null,"stop-color",_t[1]),pt.append(wt)}return this.defs.append(pt),`url(#${ht})`;case"Mesh":return(0,c.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${ot[0]}`)}}setDash(ot,ht){this.current.dashArray=ot,this.current.dashPhase=ht}constructPath(ot,ht){const ut=this.current;let pt=ut.x,_t=ut.y,wt=[],mt=0;for(const Et of ot)switch(Et|0){case c.OPS.rectangle:pt=ht[mt++],_t=ht[mt++];const Pt=ht[mt++],jt=ht[mt++],St=pt+Pt,Ot=_t+jt;wt.push("M",et(pt),et(_t),"L",et(St),et(_t),"L",et(St),et(Ot),"L",et(pt),et(Ot),"Z");break;case c.OPS.moveTo:pt=ht[mt++],_t=ht[mt++],wt.push("M",et(pt),et(_t));break;case c.OPS.lineTo:pt=ht[mt++],_t=ht[mt++],wt.push("L",et(pt),et(_t));break;case c.OPS.curveTo:pt=ht[mt+4],_t=ht[mt+5],wt.push("C",et(ht[mt]),et(ht[mt+1]),et(ht[mt+2]),et(ht[mt+3]),et(pt),et(_t)),mt+=6;break;case c.OPS.curveTo2:wt.push("C",et(pt),et(_t),et(ht[mt]),et(ht[mt+1]),et(ht[mt+2]),et(ht[mt+3])),pt=ht[mt+2],_t=ht[mt+3],mt+=4;break;case c.OPS.curveTo3:pt=ht[mt+2],_t=ht[mt+3],wt.push("C",et(ht[mt]),et(ht[mt+1]),et(pt),et(_t),et(pt),et(_t)),mt+=4;break;case c.OPS.closePath:wt.push("Z");break}wt=wt.join(" "),ut.path&&ot.length>0&&ot[0]!==c.OPS.rectangle&&ot[0]!==c.OPS.moveTo?wt=ut.path.getAttributeNS(null,"d")+wt:(ut.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(ut.path)),ut.path.setAttributeNS(null,"d",wt),ut.path.setAttributeNS(null,"fill","none"),ut.element=ut.path,ut.setCurrentPoint(pt,_t)}endPath(){const ot=this.current;if(ot.path=null,!this.pendingClip)return;if(!ot.element){this.pendingClip=null;return}const ht=`clippath${rt++}`,ut=this.svgFactory.createElement("svg:clipPath");ut.setAttributeNS(null,"id",ht),ut.setAttributeNS(null,"transform",st(this.transformMatrix));const pt=ot.element.cloneNode(!0);if(this.pendingClip==="evenodd"?pt.setAttributeNS(null,"clip-rule","evenodd"):pt.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,ut.append(pt),this.defs.append(ut),ot.activeClipUrl){ot.clipGroup=null;for(const _t of this.extraStack)_t.clipGroup=null;ut.setAttributeNS(null,"clip-path",ot.activeClipUrl)}ot.activeClipUrl=`url(#${ht})`,this.tgrp=null}clip(ot){this.pendingClip=ot}closePath(){const ot=this.current;if(ot.path){const ht=`${ot.path.getAttributeNS(null,"d")}Z`;ot.path.setAttributeNS(null,"d",ht)}}setLeading(ot){this.current.leading=-ot}setTextRise(ot){this.current.textRise=ot}setTextRenderingMode(ot){this.current.textRenderingMode=ot}setHScale(ot){this.current.textHScale=ot/100}setRenderingIntent(ot){}setFlatness(ot){}setGState(ot){for(const[ht,ut]of ot)switch(ht){case"LW":this.setLineWidth(ut);break;case"LC":this.setLineCap(ut);break;case"LJ":this.setLineJoin(ut);break;case"ML":this.setMiterLimit(ut);break;case"D":this.setDash(ut[0],ut[1]);break;case"RI":this.setRenderingIntent(ut);break;case"FL":this.setFlatness(ut);break;case"Font":this.setFont(ut);break;case"CA":this.setStrokeAlpha(ut);break;case"ca":this.setFillAlpha(ut);break;default:(0,c.warn)(`Unimplemented graphic state operator ${ht}`);break}}fill(){const ot=this.current;ot.element&&(ot.element.setAttributeNS(null,"fill",ot.fillColor),ot.element.setAttributeNS(null,"fill-opacity",ot.fillAlpha),this.endPath())}stroke(){const ot=this.current;ot.element&&(this._setStrokeAttributes(ot.element),ot.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(ot,ht=1){const ut=this.current;let pt=ut.dashArray;ht!==1&&pt.length>0&&(pt=pt.map(function(_t){return ht*_t})),ot.setAttributeNS(null,"stroke",ut.strokeColor),ot.setAttributeNS(null,"stroke-opacity",ut.strokeAlpha),ot.setAttributeNS(null,"stroke-miterlimit",et(ut.miterLimit)),ot.setAttributeNS(null,"stroke-linecap",ut.lineCap),ot.setAttributeNS(null,"stroke-linejoin",ut.lineJoin),ot.setAttributeNS(null,"stroke-width",et(ht*ut.lineWidth)+"px"),ot.setAttributeNS(null,"stroke-dasharray",pt.map(et).join(" ")),ot.setAttributeNS(null,"stroke-dashoffset",et(ht*ut.dashPhase)+"px")}eoFill(){var ot;(ot=this.current.element)==null||ot.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var ot;(ot=this.current.element)==null||ot.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const ot=this.svgFactory.createElement("svg:rect");ot.setAttributeNS(null,"x","0"),ot.setAttributeNS(null,"y","0"),ot.setAttributeNS(null,"width","1px"),ot.setAttributeNS(null,"height","1px"),ot.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(ot)}paintImageXObject(ot){const ht=this.getObject(ot);if(!ht){(0,c.warn)(`Dependent image with object ID ${ot} is not ready yet`);return}this.paintInlineImageXObject(ht)}paintInlineImageXObject(ot,ht){const ut=ot.width,pt=ot.height,_t=$(ot,this.forceDataSchema,!!ht),wt=this.svgFactory.createElement("svg:rect");wt.setAttributeNS(null,"x","0"),wt.setAttributeNS(null,"y","0"),wt.setAttributeNS(null,"width",et(ut)),wt.setAttributeNS(null,"height",et(pt)),this.current.element=wt,this.clip("nonzero");const mt=this.svgFactory.createElement("svg:image");mt.setAttributeNS(g,"xlink:href",_t),mt.setAttributeNS(null,"x","0"),mt.setAttributeNS(null,"y",et(-pt)),mt.setAttributeNS(null,"width",et(ut)+"px"),mt.setAttributeNS(null,"height",et(pt)+"px"),mt.setAttributeNS(null,"transform",`scale(${et(1/ut)} ${et(-1/pt)})`),ht?ht.append(mt):this._ensureTransformGroup().append(mt)}paintImageMaskXObject(ot){const ht=this.getObject(ot.data,ot);if(ht.bitmap){(0,c.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const ut=this.current,pt=ht.width,_t=ht.height,wt=ut.fillColor;ut.maskId=`mask${nt++}`;const mt=this.svgFactory.createElement("svg:mask");mt.setAttributeNS(null,"id",ut.maskId);const Et=this.svgFactory.createElement("svg:rect");Et.setAttributeNS(null,"x","0"),Et.setAttributeNS(null,"y","0"),Et.setAttributeNS(null,"width",et(pt)),Et.setAttributeNS(null,"height",et(_t)),Et.setAttributeNS(null,"fill",wt),Et.setAttributeNS(null,"mask",`url(#${ut.maskId})`),this.defs.append(mt),this._ensureTransformGroup().append(Et),this.paintInlineImageXObject(ht,mt)}paintFormXObjectBegin(ot,ht){if(Array.isArray(ot)&&ot.length===6&&this.transform(ot[0],ot[1],ot[2],ot[3],ot[4],ot[5]),ht){const ut=ht[2]-ht[0],pt=ht[3]-ht[1],_t=this.svgFactory.createElement("svg:rect");_t.setAttributeNS(null,"x",ht[0]),_t.setAttributeNS(null,"y",ht[1]),_t.setAttributeNS(null,"width",et(ut)),_t.setAttributeNS(null,"height",et(pt)),this.current.element=_t,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(ot){const ht=this.svgFactory.create(ot.width,ot.height),ut=this.svgFactory.createElement("svg:defs");ht.append(ut),this.defs=ut;const pt=this.svgFactory.createElement("svg:g");return pt.setAttributeNS(null,"transform",st(ot.transform)),ht.append(pt),this.svg=pt,ht}_ensureClipGroup(){if(!this.current.clipGroup){const ot=this.svgFactory.createElement("svg:g");ot.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(ot),this.current.clipGroup=ot}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",st(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=at},(s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class a{static textContent(c){const d=[],h={items:d,styles:Object.create(null)};function g(_){var $;if(!_)return;let b=null;const j=_.name;if(j==="#text")b=_.value;else if(a.shouldBuildText(j))($=_==null?void 0:_.attributes)!=null&&$.textContent?b=_.attributes.textContent:_.value&&(b=_.value);else return;if(b!==null&&d.push({str:b}),!!_.children)for(const _e of _.children)g(_e)}return g(c),h}static shouldBuildText(c){return!(c==="textarea"||c==="input"||c==="option"||c==="select")}}e.XfaText=a},(s,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=st,e.updateTextLayer=rt;var o=a(1),c=a(6);const d=1e5,h=30,g=.8,_=new Map;function b(nt,it){let at;if(it&&o.FeatureTest.isOffscreenCanvasSupported)at=new OffscreenCanvas(nt,nt).getContext("2d",{alpha:!1});else{const dt=document.createElement("canvas");dt.width=dt.height=nt,at=dt.getContext("2d",{alpha:!1})}return at}function j(nt,it){const at=_.get(nt);if(at)return at;const dt=b(h,it);dt.font=`${h}px ${nt}`;const ot=dt.measureText("");let ht=ot.fontBoundingBoxAscent,ut=Math.abs(ot.fontBoundingBoxDescent);if(ht){const _t=ht/(ht+ut);return _.set(nt,_t),dt.canvas.width=dt.canvas.height=0,_t}dt.strokeStyle="red",dt.clearRect(0,0,h,h),dt.strokeText("g",0,0);let pt=dt.getImageData(0,0,h,h).data;ut=0;for(let _t=pt.length-1-3;_t>=0;_t-=4)if(pt[_t]>0){ut=Math.ceil(_t/4/h);break}dt.clearRect(0,0,h,h),dt.strokeText("A",0,h),pt=dt.getImageData(0,0,h,h).data,ht=0;for(let _t=0,wt=pt.length;_t<wt;_t+=4)if(pt[_t]>0){ht=h-Math.floor(_t/4/h);break}if(dt.canvas.width=dt.canvas.height=0,ht){const _t=ht/(ht+ut);return _.set(nt,_t),_t}return _.set(nt,g),g}function $(nt,it,at){const dt=document.createElement("span"),ot={angle:0,canvasWidth:0,hasText:it.str!=="",hasEOL:it.hasEOL,fontSize:0};nt._textDivs.push(dt);const ht=o.Util.transform(nt._transform,it.transform);let ut=Math.atan2(ht[1],ht[0]);const pt=at[it.fontName];pt.vertical&&(ut+=Math.PI/2);const _t=Math.hypot(ht[2],ht[3]),wt=_t*j(pt.fontFamily,nt._isOffscreenCanvasSupported);let mt,Et;ut===0?(mt=ht[4],Et=ht[5]-wt):(mt=ht[4]+wt*Math.sin(ut),Et=ht[5]-wt*Math.cos(ut));const Pt="calc(var(--scale-factor)*",jt=dt.style;nt._container===nt._rootContainer?(jt.left=`${(100*mt/nt._pageWidth).toFixed(2)}%`,jt.top=`${(100*Et/nt._pageHeight).toFixed(2)}%`):(jt.left=`${Pt}${mt.toFixed(2)}px)`,jt.top=`${Pt}${Et.toFixed(2)}px)`),jt.fontSize=`${Pt}${_t.toFixed(2)}px)`,jt.fontFamily=pt.fontFamily,ot.fontSize=_t,dt.setAttribute("role","presentation"),dt.textContent=it.str,dt.dir=it.dir,nt._fontInspectorEnabled&&(dt.dataset.fontName=it.fontName),ut!==0&&(ot.angle=ut*(180/Math.PI));let St=!1;if(it.str.length>1)St=!0;else if(it.str!==" "&&it.transform[0]!==it.transform[3]){const Ot=Math.abs(it.transform[0]),Ct=Math.abs(it.transform[3]);Ot!==Ct&&Math.max(Ot,Ct)/Math.min(Ot,Ct)>1.5&&(St=!0)}St&&(ot.canvasWidth=pt.vertical?it.height:it.width),nt._textDivProperties.set(dt,ot),nt._isReadableStream&&nt._layoutText(dt)}function _e(nt){const{div:it,scale:at,properties:dt,ctx:ot,prevFontSize:ht,prevFontFamily:ut}=nt,{style:pt}=it;let _t="";if(dt.canvasWidth!==0&&dt.hasText){const{fontFamily:wt}=pt,{canvasWidth:mt,fontSize:Et}=dt;(ht!==Et||ut!==wt)&&(ot.font=`${Et*at}px ${wt}`,nt.prevFontSize=Et,nt.prevFontFamily=wt);const{width:Pt}=ot.measureText(it.textContent);Pt>0&&(_t=`scaleX(${mt*at/Pt})`)}dt.angle!==0&&(_t=`rotate(${dt.angle}deg) ${_t}`),_t.length>0&&(pt.transform=_t)}function tt(nt){if(nt._canceled)return;const it=nt._textDivs,at=nt._capability;if(it.length>d){at.resolve();return}if(!nt._isReadableStream)for(const ot of it)nt._layoutText(ot);at.resolve()}class et{constructor({textContentSource:it,container:at,viewport:dt,textDivs:ot,textDivProperties:ht,textContentItemsStr:ut,isOffscreenCanvasSupported:pt}){var Pt;this._textContentSource=it,this._isReadableStream=it instanceof ReadableStream,this._container=this._rootContainer=at,this._textDivs=ot||[],this._textContentItemsStr=ut||[],this._isOffscreenCanvasSupported=pt,this._fontInspectorEnabled=!!((Pt=globalThis.FontInspector)!=null&&Pt.enabled),this._reader=null,this._textDivProperties=ht||new WeakMap,this._canceled=!1,this._capability=new o.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:dt.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:b(0,pt)};const{pageWidth:_t,pageHeight:wt,pageX:mt,pageY:Et}=dt.rawDims;this._transform=[1,0,0,-1,-mt,Et+wt],this._pageWidth=_t,this._pageHeight=wt,(0,c.setLayerDimensions)(at,dt),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new o.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new o.AbortException("TextLayer task cancelled."))}_processItems(it,at){for(const dt of it){if(dt.str===void 0){if(dt.type==="beginMarkedContentProps"||dt.type==="beginMarkedContent"){const ot=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),dt.id!==null&&this._container.setAttribute("id",`${dt.id}`),ot.append(this._container)}else dt.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(dt.str),$(this,dt,at)}}_layoutText(it){const at=this._layoutTextParams.properties=this._textDivProperties.get(it);if(this._layoutTextParams.div=it,_e(this._layoutTextParams),at.hasText&&this._container.append(it),at.hasEOL){const dt=document.createElement("br");dt.setAttribute("role","presentation"),this._container.append(dt)}}_render(){const it=new o.PromiseCapability;let at=Object.create(null);if(this._isReadableStream){const dt=()=>{this._reader.read().then(({value:ot,done:ht})=>{if(ht){it.resolve();return}Object.assign(at,ot.styles),this._processItems(ot.items,at),dt()},it.reject)};this._reader=this._textContentSource.getReader(),dt()}else if(this._textContentSource){const{items:dt,styles:ot}=this._textContentSource;this._processItems(dt,ot),it.resolve()}else throw new Error('No "textContentSource" parameter specified.');it.promise.then(()=>{at=null,tt(this)},this._capability.reject)}}e.TextLayerRenderTask=et;function st(nt){!nt.textContentSource&&(nt.textContent||nt.textContentStream)&&((0,c.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),nt.textContentSource=nt.textContent||nt.textContentStream);const{container:it,viewport:at}=nt,dt=getComputedStyle(it),ot=dt.getPropertyValue("visibility"),ht=parseFloat(dt.getPropertyValue("--scale-factor"));ot==="visible"&&(!ht||Math.abs(ht-at.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const ut=new et(nt);return ut._render(),ut}function rt({container:nt,viewport:it,textDivs:at,textDivProperties:dt,isOffscreenCanvasSupported:ot,mustRotate:ht=!0,mustRescale:ut=!0}){if(ht&&(0,c.setLayerDimensions)(nt,{rotation:it.rotation}),ut){const pt=b(0,ot),wt={prevFontSize:null,prevFontFamily:null,div:null,scale:it.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:pt};for(const mt of at)wt.properties=dt.get(mt),wt.div=mt,_e(wt)}}},(s,e,a)=>{var j,$,_e,tt,et,st,rt,nt,it,at,dt,Xr,Er,Kr,Yr;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var o=a(1),c=a(4),d=a(28),h=a(33),g=a(6),_=a(34);const _t=class _t{constructor({uiManager:mt,pageIndex:Et,div:Pt,accessibilityManager:jt,annotationLayer:St,viewport:Ot,l10n:Ct}){Yt(this,dt);Yt(this,j);Yt(this,$,!1);Yt(this,_e,null);Yt(this,tt,this.pointerup.bind(this));Yt(this,et,this.pointerdown.bind(this));Yt(this,st,new Map);Yt(this,rt,!1);Yt(this,nt,!1);Yt(this,it,!1);Yt(this,at);const Rt=[d.FreeTextEditor,h.InkEditor,_.StampEditor];if(!_t._initialized){_t._initialized=!0;for(const bt of Rt)bt.initialize(Ct)}mt.registerEditorTypes(Rt),Qt(this,at,mt),this.pageIndex=Et,this.div=Pt,Qt(this,j,jt),Qt(this,_e,St),this.viewport=Ot,ct(this,at).addLayer(this)}get isEmpty(){return ct(this,st).size===0}updateToolbar(mt){ct(this,at).updateToolbar(mt)}updateMode(mt=ct(this,at).getMode()){Ht(this,dt,Yr).call(this),mt===o.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),mt!==o.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",mt===o.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",mt===o.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",mt===o.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(mt){if(!mt&&ct(this,at).getMode()!==o.AnnotationEditorType.INK)return;if(!mt){for(const Pt of ct(this,st).values())if(Pt.isEmpty()){Pt.setInBackground();return}}Ht(this,dt,Er).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(mt){ct(this,at).setEditingState(mt)}addCommands(mt){ct(this,at).addCommands(mt)}enable(){this.div.style.pointerEvents="auto";const mt=new Set;for(const Pt of ct(this,st).values())Pt.enableEditing(),Pt.annotationElementId&&mt.add(Pt.annotationElementId);if(!ct(this,_e))return;const Et=ct(this,_e).getEditableAnnotations();for(const Pt of Et){if(Pt.hide(),ct(this,at).isDeletedAnnotationElement(Pt.data.id)||mt.has(Pt.data.id))continue;const jt=this.deserialize(Pt);jt&&(this.addOrRebuild(jt),jt.enableEditing())}}disable(){var Et;Qt(this,it,!0),this.div.style.pointerEvents="none";const mt=new Set;for(const Pt of ct(this,st).values()){if(Pt.disableEditing(),!Pt.annotationElementId||Pt.serialize()!==null){mt.add(Pt.annotationElementId);continue}(Et=this.getEditableAnnotation(Pt.annotationElementId))==null||Et.show(),Pt.remove()}if(ct(this,_e)){const Pt=ct(this,_e).getEditableAnnotations();for(const jt of Pt){const{id:St}=jt.data;mt.has(St)||ct(this,at).isDeletedAnnotationElement(St)||jt.show()}}Ht(this,dt,Yr).call(this),this.isEmpty&&(this.div.hidden=!0),Qt(this,it,!1)}getEditableAnnotation(mt){var Et;return((Et=ct(this,_e))==null?void 0:Et.getEditableAnnotation(mt))||null}setActiveEditor(mt){ct(this,at).getActive()!==mt&&ct(this,at).setActiveEditor(mt)}enableClick(){this.div.addEventListener("pointerdown",ct(this,et)),this.div.addEventListener("pointerup",ct(this,tt))}disableClick(){this.div.removeEventListener("pointerdown",ct(this,et)),this.div.removeEventListener("pointerup",ct(this,tt))}attach(mt){ct(this,st).set(mt.id,mt);const{annotationElementId:Et}=mt;Et&&ct(this,at).isDeletedAnnotationElement(Et)&&ct(this,at).removeDeletedAnnotationElement(mt)}detach(mt){var Et;ct(this,st).delete(mt.id),(Et=ct(this,j))==null||Et.removePointerInTextLayer(mt.contentDiv),!ct(this,it)&&mt.annotationElementId&&ct(this,at).addDeletedAnnotationElement(mt)}remove(mt){this.detach(mt),ct(this,at).removeEditor(mt),mt.div.contains(document.activeElement)&&setTimeout(()=>{ct(this,at).focusMainContainer()},0),mt.div.remove(),mt.isAttachedToDOM=!1,ct(this,nt)||this.addInkEditorIfNeeded(!1)}changeParent(mt){var Et;mt.parent!==this&&(mt.annotationElementId&&(ct(this,at).addDeletedAnnotationElement(mt.annotationElementId),c.AnnotationEditor.deleteAnnotationElement(mt),mt.annotationElementId=null),this.attach(mt),(Et=mt.parent)==null||Et.detach(mt),mt.setParent(this),mt.div&&mt.isAttachedToDOM&&(mt.div.remove(),this.div.append(mt.div)))}add(mt){if(this.changeParent(mt),ct(this,at).addEditor(mt),this.attach(mt),!mt.isAttachedToDOM){const Et=mt.render();this.div.append(Et),mt.isAttachedToDOM=!0}mt.fixAndSetPosition(),mt.onceAdded(),ct(this,at).addToAnnotationStorage(mt)}moveEditorInDOM(mt){var Pt;if(!mt.isAttachedToDOM)return;const{activeElement:Et}=document;mt.div.contains(Et)&&(mt._focusEventsAllowed=!1,setTimeout(()=>{mt.div.contains(document.activeElement)?mt._focusEventsAllowed=!0:(mt.div.addEventListener("focusin",()=>{mt._focusEventsAllowed=!0},{once:!0}),Et.focus())},0)),mt._structTreeParentId=(Pt=ct(this,j))==null?void 0:Pt.moveElementInDOM(this.div,mt.div,mt.contentDiv,!0)}addOrRebuild(mt){mt.needsToBeRebuilt()?mt.rebuild():this.add(mt)}addUndoableEditor(mt){const Et=()=>mt._uiManager.rebuild(mt),Pt=()=>{mt.remove()};this.addCommands({cmd:Et,undo:Pt,mustExec:!1})}getNextId(){return ct(this,at).getId()}pasteEditor(mt,Et){ct(this,at).updateToolbar(mt),ct(this,at).updateMode(mt);const{offsetX:Pt,offsetY:jt}=Ht(this,dt,Kr).call(this),St=this.getNextId(),Ot=Ht(this,dt,Xr).call(this,{parent:this,id:St,x:Pt,y:jt,uiManager:ct(this,at),isCentered:!0,...Et});Ot&&this.add(Ot)}deserialize(mt){switch(mt.annotationType??mt.annotationEditorType){case o.AnnotationEditorType.FREETEXT:return d.FreeTextEditor.deserialize(mt,this,ct(this,at));case o.AnnotationEditorType.INK:return h.InkEditor.deserialize(mt,this,ct(this,at));case o.AnnotationEditorType.STAMP:return _.StampEditor.deserialize(mt,this,ct(this,at))}return null}addNewEditor(){Ht(this,dt,Er).call(this,Ht(this,dt,Kr).call(this),!0)}setSelected(mt){ct(this,at).setSelected(mt)}toggleSelected(mt){ct(this,at).toggleSelected(mt)}isSelected(mt){return ct(this,at).isSelected(mt)}unselect(mt){ct(this,at).unselect(mt)}pointerup(mt){const{isMac:Et}=o.FeatureTest.platform;if(!(mt.button!==0||mt.ctrlKey&&Et)&&mt.target===this.div&&ct(this,rt)){if(Qt(this,rt,!1),!ct(this,$)){Qt(this,$,!0);return}if(ct(this,at).getMode()===o.AnnotationEditorType.STAMP){ct(this,at).unselectAll();return}Ht(this,dt,Er).call(this,mt,!1)}}pointerdown(mt){if(ct(this,rt)){Qt(this,rt,!1);return}const{isMac:Et}=o.FeatureTest.platform;if(mt.button!==0||mt.ctrlKey&&Et||mt.target!==this.div)return;Qt(this,rt,!0);const Pt=ct(this,at).getActive();Qt(this,$,!Pt||Pt.isEmpty())}findNewParent(mt,Et,Pt){const jt=ct(this,at).findParent(Et,Pt);return jt===null||jt===this?!1:(jt.changeParent(mt),!0)}destroy(){var mt,Et;((mt=ct(this,at).getActive())==null?void 0:mt.parent)===this&&(ct(this,at).commitOrRemove(),ct(this,at).setActiveEditor(null));for(const Pt of ct(this,st).values())(Et=ct(this,j))==null||Et.removePointerInTextLayer(Pt.contentDiv),Pt.setParent(null),Pt.isAttachedToDOM=!1,Pt.div.remove();this.div=null,ct(this,st).clear(),ct(this,at).removeLayer(this)}render({viewport:mt}){this.viewport=mt,(0,g.setLayerDimensions)(this.div,mt);for(const Et of ct(this,at).getEditors(this.pageIndex))this.add(Et);this.updateMode()}update({viewport:mt}){ct(this,at).commitOrRemove(),this.viewport=mt,(0,g.setLayerDimensions)(this.div,{rotation:mt.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:mt,pageHeight:Et}=this.viewport.rawDims;return[mt,Et]}};j=new WeakMap,$=new WeakMap,_e=new WeakMap,tt=new WeakMap,et=new WeakMap,st=new WeakMap,rt=new WeakMap,nt=new WeakMap,it=new WeakMap,at=new WeakMap,dt=new WeakSet,Xr=function(mt){switch(ct(this,at).getMode()){case o.AnnotationEditorType.FREETEXT:return new d.FreeTextEditor(mt);case o.AnnotationEditorType.INK:return new h.InkEditor(mt);case o.AnnotationEditorType.STAMP:return new _.StampEditor(mt)}return null},Er=function(mt,Et){const Pt=this.getNextId(),jt=Ht(this,dt,Xr).call(this,{parent:this,id:Pt,x:mt.offsetX,y:mt.offsetY,uiManager:ct(this,at),isCentered:Et});return jt&&this.add(jt),jt},Kr=function(){const{x:mt,y:Et,width:Pt,height:jt}=this.div.getBoundingClientRect(),St=Math.max(0,mt),Ot=Math.max(0,Et),Ct=Math.min(window.innerWidth,mt+Pt),Rt=Math.min(window.innerHeight,Et+jt),bt=(St+Ct)/2-mt,Tt=(Ot+Rt)/2-Et,[$t,xt]=this.viewport.rotation%180===0?[bt,Tt]:[Tt,bt];return{offsetX:$t,offsetY:xt}},Yr=function(){Qt(this,nt,!0);for(const mt of ct(this,st).values())mt.isEmpty()&&mt.remove();Qt(this,nt,!1)},Sn(_t,"_initialized",!1);let b=_t;e.AnnotationEditorLayer=b},(s,e,a)=>{var _,b,j,$,_e,tt,et,st,rt,nt,Cs,ks,Rs,pr,Jr,Ps,Qr;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var o=a(1),c=a(5),d=a(4),h=a(29);const _t=class _t extends d.AnnotationEditor{constructor(Et){super({...Et,name:"freeTextEditor"});Yt(this,nt);Yt(this,_,this.editorDivBlur.bind(this));Yt(this,b,this.editorDivFocus.bind(this));Yt(this,j,this.editorDivInput.bind(this));Yt(this,$,this.editorDivKeydown.bind(this));Yt(this,_e);Yt(this,tt,"");Yt(this,et,`${this.id}-editor`);Yt(this,st);Yt(this,rt,null);Qt(this,_e,Et.color||_t._defaultColor||d.AnnotationEditor._defaultLineColor),Qt(this,st,Et.fontSize||_t._defaultFontSize)}static get _keyboardManager(){const Et=_t.prototype,Pt=Ot=>Ot.isEmpty(),jt=c.AnnotationEditorUIManager.TRANSLATE_SMALL,St=c.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,o.shadow)(this,"_keyboardManager",new c.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],Et.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],Et.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],Et._translateEmpty,{args:[-jt,0],checker:Pt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Et._translateEmpty,{args:[-St,0],checker:Pt}],[["ArrowRight","mac+ArrowRight"],Et._translateEmpty,{args:[jt,0],checker:Pt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Et._translateEmpty,{args:[St,0],checker:Pt}],[["ArrowUp","mac+ArrowUp"],Et._translateEmpty,{args:[0,-jt],checker:Pt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Et._translateEmpty,{args:[0,-St],checker:Pt}],[["ArrowDown","mac+ArrowDown"],Et._translateEmpty,{args:[0,jt],checker:Pt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Et._translateEmpty,{args:[0,St],checker:Pt}]]))}static initialize(Et){d.AnnotationEditor.initialize(Et,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const Pt=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(Pt.getPropertyValue("--freetext-padding"))}static updateDefaultParams(Et,Pt){switch(Et){case o.AnnotationEditorParamsType.FREETEXT_SIZE:_t._defaultFontSize=Pt;break;case o.AnnotationEditorParamsType.FREETEXT_COLOR:_t._defaultColor=Pt;break}}updateParams(Et,Pt){switch(Et){case o.AnnotationEditorParamsType.FREETEXT_SIZE:Ht(this,nt,Cs).call(this,Pt);break;case o.AnnotationEditorParamsType.FREETEXT_COLOR:Ht(this,nt,ks).call(this,Pt);break}}static get defaultPropertiesToUpdate(){return[[o.AnnotationEditorParamsType.FREETEXT_SIZE,_t._defaultFontSize],[o.AnnotationEditorParamsType.FREETEXT_COLOR,_t._defaultColor||d.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[o.AnnotationEditorParamsType.FREETEXT_SIZE,ct(this,st)],[o.AnnotationEditorParamsType.FREETEXT_COLOR,ct(this,_e)]]}_translateEmpty(Et,Pt){this._uiManager.translateSelectedEditors(Et,Pt,!0)}getInitialTranslation(){const Et=this.parentScale;return[-_t._internalPadding*Et,-(_t._internalPadding+ct(this,st))*Et]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(o.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",ct(this,$)),this.editorDiv.addEventListener("focus",ct(this,b)),this.editorDiv.addEventListener("blur",ct(this,_)),this.editorDiv.addEventListener("input",ct(this,j)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",ct(this,et)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",ct(this,$)),this.editorDiv.removeEventListener("focus",ct(this,b)),this.editorDiv.removeEventListener("blur",ct(this,_)),this.editorDiv.removeEventListener("input",ct(this,j)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(Et){this._focusEventsAllowed&&(super.focusin(Et),Et.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var Et;if(this.width){Ht(this,nt,Qr).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(Et=this._initialOptions)!=null&&Et.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const Et=ct(this,tt),Pt=Qt(this,tt,Ht(this,nt,Rs).call(this).trimEnd());if(Et===Pt)return;const jt=St=>{if(Qt(this,tt,St),!St){this.remove();return}Ht(this,nt,Jr).call(this),this._uiManager.rebuild(this),Ht(this,nt,pr).call(this)};this.addCommands({cmd:()=>{jt(Pt)},undo:()=>{jt(Et)},mustExec:!1}),Ht(this,nt,pr).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(Et){this.enterInEditMode()}keydown(Et){Et.target===this.div&&Et.key==="Enter"&&(this.enterInEditMode(),Et.preventDefault())}editorDivKeydown(Et){_t._keyboardManager.exec(this,Et)}editorDivFocus(Et){this.isEditing=!0}editorDivBlur(Et){this.isEditing=!1}editorDivInput(Et){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let Et,Pt;this.width&&(Et=this.x,Pt=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",ct(this,et)),this.enableEditing(),d.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(St=>{var Ot;return(Ot=this.editorDiv)==null?void 0:Ot.setAttribute("aria-label",St)}),d.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(St=>{var Ot;return(Ot=this.editorDiv)==null?void 0:Ot.setAttribute("default-content",St)}),this.editorDiv.contentEditable=!0;const{style:jt}=this.editorDiv;if(jt.fontSize=`calc(${ct(this,st)}px * var(--scale-factor))`,jt.color=ct(this,_e),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,c.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[St,Ot]=this.parentDimensions;if(this.annotationElementId){const{position:Ct}=ct(this,rt);let[Rt,bt]=this.getInitialTranslation();[Rt,bt]=this.pageTranslationToScreen(Rt,bt);const[Tt,$t]=this.pageDimensions,[xt,ft]=this.pageTranslation;let yt,vt;switch(this.rotation){case 0:yt=Et+(Ct[0]-xt)/Tt,vt=Pt+this.height-(Ct[1]-ft)/$t;break;case 90:yt=Et+(Ct[0]-xt)/Tt,vt=Pt-(Ct[1]-ft)/$t,[Rt,bt]=[bt,-Rt];break;case 180:yt=Et-this.width+(Ct[0]-xt)/Tt,vt=Pt-(Ct[1]-ft)/$t,[Rt,bt]=[-Rt,-bt];break;case 270:yt=Et+(Ct[0]-xt-this.height*$t)/Tt,vt=Pt+(Ct[1]-ft-this.width*Tt)/$t,[Rt,bt]=[-bt,Rt];break}this.setAt(yt*St,vt*Ot,Rt,bt)}else this.setAt(Et*St,Pt*Ot,this.width*St,this.height*Ot);Ht(this,nt,Jr).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(Et,Pt,jt){let St=null;if(Et instanceof h.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:Ct,fontColor:Rt},rect:bt,rotation:Tt,id:$t},textContent:xt,textPosition:ft,parent:{page:{pageNumber:yt}}}=Et;if(!xt||xt.length===0)return null;St=Et={annotationType:o.AnnotationEditorType.FREETEXT,color:Array.from(Rt),fontSize:Ct,value:xt.join(`
`),position:ft,pageIndex:yt-1,rect:bt,rotation:Tt,id:$t,deleted:!1}}const Ot=super.deserialize(Et,Pt,jt);return Qt(Ot,st,Et.fontSize),Qt(Ot,_e,o.Util.makeHexColor(...Et.color)),Qt(Ot,tt,Et.value),Ot.annotationElementId=Et.id||null,Qt(Ot,rt,St),Ot}serialize(Et=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const Pt=_t._internalPadding*this.parentScale,jt=this.getRect(Pt,Pt),St=d.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:ct(this,_e)),Ot={annotationType:o.AnnotationEditorType.FREETEXT,color:St,fontSize:ct(this,st),value:ct(this,tt),pageIndex:this.pageIndex,rect:jt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return Et?Ot:this.annotationElementId&&!Ht(this,nt,Ps).call(this,Ot)?null:(Ot.id=this.annotationElementId,Ot)}};_=new WeakMap,b=new WeakMap,j=new WeakMap,$=new WeakMap,_e=new WeakMap,tt=new WeakMap,et=new WeakMap,st=new WeakMap,rt=new WeakMap,nt=new WeakSet,Cs=function(Et){const Pt=St=>{this.editorDiv.style.fontSize=`calc(${St}px * var(--scale-factor))`,this.translate(0,-(St-ct(this,st))*this.parentScale),Qt(this,st,St),Ht(this,nt,pr).call(this)},jt=ct(this,st);this.addCommands({cmd:()=>{Pt(Et)},undo:()=>{Pt(jt)},mustExec:!0,type:o.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},ks=function(Et){const Pt=ct(this,_e);this.addCommands({cmd:()=>{Qt(this,_e,this.editorDiv.style.color=Et)},undo:()=>{Qt(this,_e,this.editorDiv.style.color=Pt)},mustExec:!0,type:o.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Rs=function(){const Et=this.editorDiv.getElementsByTagName("div");if(Et.length===0)return this.editorDiv.innerText;const Pt=[];for(const jt of Et)Pt.push(jt.innerText.replace(/\r\n?|\n/,""));return Pt.join(`
`)},pr=function(){const[Et,Pt]=this.parentDimensions;let jt;if(this.isAttachedToDOM)jt=this.div.getBoundingClientRect();else{const{currentLayer:St,div:Ot}=this,Ct=Ot.style.display;Ot.style.display="hidden",St.div.append(this.div),jt=Ot.getBoundingClientRect(),Ot.remove(),Ot.style.display=Ct}this.rotation%180===this.parentRotation%180?(this.width=jt.width/Et,this.height=jt.height/Pt):(this.width=jt.height/Et,this.height=jt.width/Pt),this.fixAndSetPosition()},Jr=function(){if(this.editorDiv.replaceChildren(),!!ct(this,tt))for(const Et of ct(this,tt).split(`
`)){const Pt=document.createElement("div");Pt.append(Et?document.createTextNode(Et):document.createElement("br")),this.editorDiv.append(Pt)}},Ps=function(Et){const{value:Pt,fontSize:jt,color:St,rect:Ot,pageIndex:Ct}=ct(this,rt);return Et.value!==Pt||Et.fontSize!==jt||Et.rect.some((Rt,bt)=>Math.abs(Rt-Ot[bt])>=1)||Et.color.some((Rt,bt)=>Rt!==St[bt])||Et.pageIndex!==Ct},Qr=function(Et=!1){if(!this.annotationElementId)return;if(Ht(this,nt,pr).call(this),!Et&&(this.width===0||this.height===0)){setTimeout(()=>Ht(this,nt,Qr).call(this,!0),0);return}const Pt=_t._internalPadding*this.parentScale;ct(this,rt).rect=this.getRect(Pt,Pt)},Sn(_t,"_freeTextDefaultContent",""),Sn(_t,"_internalPadding",0),Sn(_t,"_defaultColor",null),Sn(_t,"_defaultFontSize",10),Sn(_t,"_type","freetext");let g=_t;e.FreeTextEditor=g},(s,e,a)=>{var vt,Lt,nr,Is,Kt,rn,nn,on,cn,hn,Zt,Gt,At,Ft,Vt,qt,an,fn,un,zt,gn,mn,Os,Sr,es,ts,In,Un,Hn,ln,Xt,Jt,xn,ns,Dn,Dt,sn,yn,Ls,rs;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var o=a(1),c=a(6),d=a(3),h=a(30),g=a(31),_=a(32);const b=1e3,j=9,$=new WeakSet;function _e(wn){return{width:wn[2]-wn[0],height:wn[3]-wn[1]}}class tt{static create(Mt){switch(Mt.data.annotationType){case o.AnnotationType.LINK:return new st(Mt);case o.AnnotationType.TEXT:return new rt(Mt);case o.AnnotationType.WIDGET:switch(Mt.data.fieldType){case"Tx":return new it(Mt);case"Btn":return Mt.data.radioButton?new ot(Mt):Mt.data.checkBox?new dt(Mt):new ht(Mt);case"Ch":return new ut(Mt);case"Sig":return new at(Mt)}return new nt(Mt);case o.AnnotationType.POPUP:return new pt(Mt);case o.AnnotationType.FREETEXT:return new wt(Mt);case o.AnnotationType.LINE:return new mt(Mt);case o.AnnotationType.SQUARE:return new Et(Mt);case o.AnnotationType.CIRCLE:return new Pt(Mt);case o.AnnotationType.POLYLINE:return new jt(Mt);case o.AnnotationType.CARET:return new Ot(Mt);case o.AnnotationType.INK:return new Ct(Mt);case o.AnnotationType.POLYGON:return new St(Mt);case o.AnnotationType.HIGHLIGHT:return new Rt(Mt);case o.AnnotationType.UNDERLINE:return new bt(Mt);case o.AnnotationType.SQUIGGLY:return new Tt(Mt);case o.AnnotationType.STRIKEOUT:return new $t(Mt);case o.AnnotationType.STAMP:return new xt(Mt);case o.AnnotationType.FILEATTACHMENT:return new ft(Mt);default:return new et(Mt)}}}const It=class It{constructor(Mt,{isRenderable:kt=!1,ignoreBorder:Ut=!1,createQuadrilaterals:en=!1}={}){Yt(this,vt,!1);this.isRenderable=kt,this.data=Mt.data,this.layer=Mt.layer,this.linkService=Mt.linkService,this.downloadManager=Mt.downloadManager,this.imageResourcesPath=Mt.imageResourcesPath,this.renderForms=Mt.renderForms,this.svgFactory=Mt.svgFactory,this.annotationStorage=Mt.annotationStorage,this.enableScripting=Mt.enableScripting,this.hasJSActions=Mt.hasJSActions,this._fieldObjects=Mt.fieldObjects,this.parent=Mt.parent,kt&&(this.container=this._createContainer(Ut)),en&&this._createQuadrilaterals()}static _hasPopupData({titleObj:Mt,contentsObj:kt,richText:Ut}){return!!(Mt!=null&&Mt.str||kt!=null&&kt.str||Ut!=null&&Ut.str)}get hasPopupData(){return It._hasPopupData(this.data)}_createContainer(Mt){const{data:kt,parent:{page:Ut,viewport:en}}=this,tn=document.createElement("section");tn.setAttribute("data-annotation-id",kt.id),this instanceof nt||(tn.tabIndex=b),tn.style.zIndex=this.parent.zIndex++,this.data.popupRef&&tn.setAttribute("aria-haspopup","dialog"),kt.noRotate&&tn.classList.add("norotate");const{pageWidth:dn,pageHeight:pn,pageX:Tn,pageY:Cn}=en.rawDims;if(!kt.rect||this instanceof pt){const{rotation:Mn}=kt;return!kt.hasOwnCanvas&&Mn!==0&&this.setRotation(Mn,tn),tn}const{width:bn,height:Nn}=_e(kt.rect),kn=o.Util.normalizeRect([kt.rect[0],Ut.view[3]-kt.rect[1]+Ut.view[1],kt.rect[2],Ut.view[3]-kt.rect[3]+Ut.view[1]]);if(!Mt&&kt.borderStyle.width>0){tn.style.borderWidth=`${kt.borderStyle.width}px`;const Mn=kt.borderStyle.horizontalCornerRadius,jn=kt.borderStyle.verticalCornerRadius;if(Mn>0||jn>0){const Vn=`calc(${Mn}px * var(--scale-factor)) / calc(${jn}px * var(--scale-factor))`;tn.style.borderRadius=Vn}else if(this instanceof ot){const Vn=`calc(${bn}px * var(--scale-factor)) / calc(${Nn}px * var(--scale-factor))`;tn.style.borderRadius=Vn}switch(kt.borderStyle.style){case o.AnnotationBorderStyleType.SOLID:tn.style.borderStyle="solid";break;case o.AnnotationBorderStyleType.DASHED:tn.style.borderStyle="dashed";break;case o.AnnotationBorderStyleType.BEVELED:(0,o.warn)("Unimplemented border style: beveled");break;case o.AnnotationBorderStyleType.INSET:(0,o.warn)("Unimplemented border style: inset");break;case o.AnnotationBorderStyleType.UNDERLINE:tn.style.borderBottomStyle="solid";break}const zn=kt.borderColor||null;zn?(Qt(this,vt,!0),tn.style.borderColor=o.Util.makeHexColor(zn[0]|0,zn[1]|0,zn[2]|0)):tn.style.borderWidth=0}tn.style.left=`${100*(kn[0]-Tn)/dn}%`,tn.style.top=`${100*(kn[1]-Cn)/pn}%`;const{rotation:En}=kt;return kt.hasOwnCanvas||En===0?(tn.style.width=`${100*bn/dn}%`,tn.style.height=`${100*Nn/pn}%`):this.setRotation(En,tn),tn}setRotation(Mt,kt=this.container){if(!this.data.rect)return;const{pageWidth:Ut,pageHeight:en}=this.parent.viewport.rawDims,{width:tn,height:dn}=_e(this.data.rect);let pn,Tn;Mt%180===0?(pn=100*tn/Ut,Tn=100*dn/en):(pn=100*dn/Ut,Tn=100*tn/en),kt.style.width=`${pn}%`,kt.style.height=`${Tn}%`,kt.setAttribute("data-main-rotation",(360-Mt)%360)}get _commonActions(){const Mt=(kt,Ut,en)=>{const tn=en.detail[kt],dn=tn[0],pn=tn.slice(1);en.target.style[Ut]=h.ColorConverters[`${dn}_HTML`](pn),this.annotationStorage.setValue(this.data.id,{[Ut]:h.ColorConverters[`${dn}_rgb`](pn)})};return(0,o.shadow)(this,"_commonActions",{display:kt=>{const{display:Ut}=kt.detail,en=Ut%2===1;this.container.style.visibility=en?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:en,noPrint:Ut===1||Ut===2})},print:kt=>{this.annotationStorage.setValue(this.data.id,{noPrint:!kt.detail.print})},hidden:kt=>{const{hidden:Ut}=kt.detail;this.container.style.visibility=Ut?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:Ut,noView:Ut})},focus:kt=>{setTimeout(()=>kt.target.focus({preventScroll:!1}),0)},userName:kt=>{kt.target.title=kt.detail.userName},readonly:kt=>{kt.target.disabled=kt.detail.readonly},required:kt=>{this._setRequired(kt.target,kt.detail.required)},bgColor:kt=>{Mt("bgColor","backgroundColor",kt)},fillColor:kt=>{Mt("fillColor","backgroundColor",kt)},fgColor:kt=>{Mt("fgColor","color",kt)},textColor:kt=>{Mt("textColor","color",kt)},borderColor:kt=>{Mt("borderColor","borderColor",kt)},strokeColor:kt=>{Mt("strokeColor","borderColor",kt)},rotation:kt=>{const Ut=kt.detail.rotation;this.setRotation(Ut),this.annotationStorage.setValue(this.data.id,{rotation:Ut})}})}_dispatchEventFromSandbox(Mt,kt){const Ut=this._commonActions;for(const en of Object.keys(kt.detail)){const tn=Mt[en]||Ut[en];tn==null||tn(kt)}}_setDefaultPropertiesFromJS(Mt){if(!this.enableScripting)return;const kt=this.annotationStorage.getRawValue(this.data.id);if(!kt)return;const Ut=this._commonActions;for(const[en,tn]of Object.entries(kt)){const dn=Ut[en];if(dn){const pn={detail:{[en]:tn},target:Mt};dn(pn),delete kt[en]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:Mt}=this.data;if(!Mt)return;const[kt,Ut,en,tn]=this.data.rect;if(Mt.length===1){const[,{x:jn,y:zn},{x:Vn,y:Zn}]=Mt[0];if(en===jn&&tn===zn&&kt===Vn&&Ut===Zn)return}const{style:dn}=this.container;let pn;if(ct(this,vt)){const{borderColor:jn,borderWidth:zn}=dn;dn.borderWidth=0,pn=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${jn}" stroke-width="${zn}">`],this.container.classList.add("hasBorder")}const Tn=en-kt,Cn=tn-Ut,{svgFactory:bn}=this,Nn=bn.createElement("svg");Nn.classList.add("quadrilateralsContainer"),Nn.setAttribute("width",0),Nn.setAttribute("height",0);const kn=bn.createElement("defs");Nn.append(kn);const En=bn.createElement("clipPath"),Mn=`clippath_${this.data.id}`;En.setAttribute("id",Mn),En.setAttribute("clipPathUnits","objectBoundingBox"),kn.append(En);for(const[,{x:jn,y:zn},{x:Vn,y:Zn}]of Mt){const Rn=bn.createElement("rect"),Wt=(Vn-kt)/Tn,_n=(tn-zn)/Cn,On=(jn-Vn)/Tn,Wn=(zn-Zn)/Cn;Rn.setAttribute("x",Wt),Rn.setAttribute("y",_n),Rn.setAttribute("width",On),Rn.setAttribute("height",Wn),En.append(Rn),pn==null||pn.push(`<rect vector-effect="non-scaling-stroke" x="${Wt}" y="${_n}" width="${On}" height="${Wn}"/>`)}ct(this,vt)&&(pn.push("</g></svg>')"),dn.backgroundImage=pn.join("")),this.container.append(Nn),this.container.style.clipPath=`url(#${Mn})`}_createPopup(){const{container:Mt,data:kt}=this;Mt.setAttribute("aria-haspopup","dialog");const Ut=new pt({data:{color:kt.color,titleObj:kt.titleObj,modificationDate:kt.modificationDate,contentsObj:kt.contentsObj,richText:kt.richText,parentRect:kt.rect,borderStyle:0,id:`popup_${kt.id}`,rotation:kt.rotation},parent:this.parent,elements:[this]});this.parent.div.append(Ut.render())}render(){(0,o.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(Mt,kt=null){const Ut=[];if(this._fieldObjects){const en=this._fieldObjects[Mt];if(en)for(const{page:tn,id:dn,exportValues:pn}of en){if(tn===-1||dn===kt)continue;const Tn=typeof pn=="string"?pn:null,Cn=document.querySelector(`[data-element-id="${dn}"]`);if(Cn&&!$.has(Cn)){(0,o.warn)(`_getElementsByName - element not allowed: ${dn}`);continue}Ut.push({id:dn,exportValue:Tn,domElement:Cn})}return Ut}for(const en of document.getElementsByName(Mt)){const{exportValue:tn}=en,dn=en.getAttribute("data-element-id");dn!==kt&&$.has(en)&&Ut.push({id:dn,exportValue:tn,domElement:en})}return Ut}show(){var Mt;this.container&&(this.container.hidden=!1),(Mt=this.popup)==null||Mt.maybeShow()}hide(){var Mt;this.container&&(this.container.hidden=!0),(Mt=this.popup)==null||Mt.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const Mt=this.getElementsToTriggerPopup();if(Array.isArray(Mt))for(const kt of Mt)kt.classList.add("highlightArea");else Mt.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:Mt,data:{id:kt}}=this;this.container.addEventListener("dblclick",()=>{var Ut;(Ut=this.linkService.eventBus)==null||Ut.dispatch("switchannotationeditormode",{source:this,mode:Mt,editId:kt})})}};vt=new WeakMap;let et=It;class st extends et{constructor(kt,Ut=null){super(kt,{isRenderable:!0,ignoreBorder:!!(Ut!=null&&Ut.ignoreBorder),createQuadrilaterals:!0});Yt(this,Lt);this.isTooltipOnly=kt.data.isTooltipOnly}render(){const{data:kt,linkService:Ut}=this,en=document.createElement("a");en.setAttribute("data-element-id",kt.id);let tn=!1;return kt.url?(Ut.addLinkAttributes(en,kt.url,kt.newWindow),tn=!0):kt.action?(this._bindNamedAction(en,kt.action),tn=!0):kt.attachment?(this._bindAttachment(en,kt.attachment),tn=!0):kt.setOCGState?(Ht(this,Lt,Is).call(this,en,kt.setOCGState),tn=!0):kt.dest?(this._bindLink(en,kt.dest),tn=!0):(kt.actions&&(kt.actions.Action||kt.actions["Mouse Up"]||kt.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(en,kt),tn=!0),kt.resetForm?(this._bindResetFormAction(en,kt.resetForm),tn=!0):this.isTooltipOnly&&!tn&&(this._bindLink(en,""),tn=!0)),this.container.classList.add("linkAnnotation"),tn&&this.container.append(en),this.container}_bindLink(kt,Ut){kt.href=this.linkService.getDestinationHash(Ut),kt.onclick=()=>(Ut&&this.linkService.goToDestination(Ut),!1),(Ut||Ut==="")&&Ht(this,Lt,nr).call(this)}_bindNamedAction(kt,Ut){kt.href=this.linkService.getAnchorUrl(""),kt.onclick=()=>(this.linkService.executeNamedAction(Ut),!1),Ht(this,Lt,nr).call(this)}_bindAttachment(kt,Ut){kt.href=this.linkService.getAnchorUrl(""),kt.onclick=()=>{var en;return(en=this.downloadManager)==null||en.openOrDownloadData(this.container,Ut.content,Ut.filename),!1},Ht(this,Lt,nr).call(this)}_bindJSAction(kt,Ut){kt.href=this.linkService.getAnchorUrl("");const en=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const tn of Object.keys(Ut.actions)){const dn=en.get(tn);dn&&(kt[dn]=()=>{var pn;return(pn=this.linkService.eventBus)==null||pn.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Ut.id,name:tn}}),!1})}kt.onclick||(kt.onclick=()=>!1),Ht(this,Lt,nr).call(this)}_bindResetFormAction(kt,Ut){const en=kt.onclick;if(en||(kt.href=this.linkService.getAnchorUrl("")),Ht(this,Lt,nr).call(this),!this._fieldObjects){(0,o.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),en||(kt.onclick=()=>!1);return}kt.onclick=()=>{var Nn;en==null||en();const{fields:tn,refs:dn,include:pn}=Ut,Tn=[];if(tn.length!==0||dn.length!==0){const kn=new Set(dn);for(const En of tn){const Mn=this._fieldObjects[En]||[];for(const{id:jn}of Mn)kn.add(jn)}for(const En of Object.values(this._fieldObjects))for(const Mn of En)kn.has(Mn.id)===pn&&Tn.push(Mn)}else for(const kn of Object.values(this._fieldObjects))Tn.push(...kn);const Cn=this.annotationStorage,bn=[];for(const kn of Tn){const{id:En}=kn;switch(bn.push(En),kn.type){case"text":{const jn=kn.defaultValue||"";Cn.setValue(En,{value:jn});break}case"checkbox":case"radiobutton":{const jn=kn.defaultValue===kn.exportValues;Cn.setValue(En,{value:jn});break}case"combobox":case"listbox":{const jn=kn.defaultValue||"";Cn.setValue(En,{value:jn});break}default:continue}const Mn=document.querySelector(`[data-element-id="${En}"]`);if(Mn){if(!$.has(Mn)){(0,o.warn)(`_bindResetFormAction - element not allowed: ${En}`);continue}}else continue;Mn.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Nn=this.linkService.eventBus)==null||Nn.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:bn,name:"ResetForm"}})),!1}}}Lt=new WeakSet,nr=function(){this.container.setAttribute("data-internal-link","")},Is=function(kt,Ut){kt.href=this.linkService.getAnchorUrl(""),kt.onclick=()=>(this.linkService.executeSetOCGState(Ut),!1),Ht(this,Lt,nr).call(this)};class rt extends et{constructor(Mt){super(Mt,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const Mt=document.createElement("img");return Mt.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",Mt.alt="[{{type}} Annotation]",Mt.dataset.l10nId="text_annotation_type",Mt.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(Mt),this.container}}class nt extends et{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(Mt){var kt;this.data.hasOwnCanvas&&(((kt=Mt.previousSibling)==null?void 0:kt.nodeName)==="CANVAS"&&(Mt.previousSibling.hidden=!0),Mt.hidden=!1)}_getKeyModifier(Mt){const{isWin:kt,isMac:Ut}=o.FeatureTest.platform;return kt&&Mt.ctrlKey||Ut&&Mt.metaKey}_setEventListener(Mt,kt,Ut,en,tn){Ut.includes("mouse")?Mt.addEventListener(Ut,dn=>{var pn;(pn=this.linkService.eventBus)==null||pn.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:en,value:tn(dn),shift:dn.shiftKey,modifier:this._getKeyModifier(dn)}})}):Mt.addEventListener(Ut,dn=>{var pn;if(Ut==="blur"){if(!kt.focused||!dn.relatedTarget)return;kt.focused=!1}else if(Ut==="focus"){if(kt.focused)return;kt.focused=!0}tn&&((pn=this.linkService.eventBus)==null||pn.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:en,value:tn(dn)}}))})}_setEventListeners(Mt,kt,Ut,en){var tn,dn,pn;for(const[Tn,Cn]of Ut)(Cn==="Action"||(tn=this.data.actions)!=null&&tn[Cn])&&((Cn==="Focus"||Cn==="Blur")&&(kt||(kt={focused:!1})),this._setEventListener(Mt,kt,Tn,Cn,en),Cn==="Focus"&&!((dn=this.data.actions)!=null&&dn.Blur)?this._setEventListener(Mt,kt,"blur","Blur",null):Cn==="Blur"&&!((pn=this.data.actions)!=null&&pn.Focus)&&this._setEventListener(Mt,kt,"focus","Focus",null))}_setBackgroundColor(Mt){const kt=this.data.backgroundColor||null;Mt.style.backgroundColor=kt===null?"transparent":o.Util.makeHexColor(kt[0],kt[1],kt[2])}_setTextStyle(Mt){const kt=["left","center","right"],{fontColor:Ut}=this.data.defaultAppearanceData,en=this.data.defaultAppearanceData.fontSize||j,tn=Mt.style;let dn;const pn=2,Tn=Cn=>Math.round(10*Cn)/10;if(this.data.multiLine){const Cn=Math.abs(this.data.rect[3]-this.data.rect[1]-pn),bn=Math.round(Cn/(o.LINE_FACTOR*en))||1,Nn=Cn/bn;dn=Math.min(en,Tn(Nn/o.LINE_FACTOR))}else{const Cn=Math.abs(this.data.rect[3]-this.data.rect[1]-pn);dn=Math.min(en,Tn(Cn/o.LINE_FACTOR))}tn.fontSize=`calc(${dn}px * var(--scale-factor))`,tn.color=o.Util.makeHexColor(Ut[0],Ut[1],Ut[2]),this.data.textAlignment!==null&&(tn.textAlign=kt[this.data.textAlignment])}_setRequired(Mt,kt){kt?Mt.setAttribute("required",!0):Mt.removeAttribute("required"),Mt.setAttribute("aria-required",kt)}}class it extends nt{constructor(Mt){const kt=Mt.renderForms||!Mt.data.hasAppearance&&!!Mt.data.fieldValue;super(Mt,{isRenderable:kt})}setPropertyOnSiblings(Mt,kt,Ut,en){const tn=this.annotationStorage;for(const dn of this._getElementsByName(Mt.name,Mt.id))dn.domElement&&(dn.domElement[kt]=Ut),tn.setValue(dn.id,{[en]:Ut})}render(){var en,tn;const Mt=this.annotationStorage,kt=this.data.id;this.container.classList.add("textWidgetAnnotation");let Ut=null;if(this.renderForms){const dn=Mt.getValue(kt,{value:this.data.fieldValue});let pn=dn.value||"";const Tn=Mt.getValue(kt,{charLimit:this.data.maxLen}).charLimit;Tn&&pn.length>Tn&&(pn=pn.slice(0,Tn));let Cn=dn.formattedValue||((en=this.data.textContent)==null?void 0:en.join(`
`))||null;Cn&&this.data.comb&&(Cn=Cn.replaceAll(/\s+/g,""));const bn={userValue:pn,formattedValue:Cn,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(Ut=document.createElement("textarea"),Ut.textContent=Cn??pn,this.data.doNotScroll&&(Ut.style.overflowY="hidden")):(Ut=document.createElement("input"),Ut.type="text",Ut.setAttribute("value",Cn??pn),this.data.doNotScroll&&(Ut.style.overflowX="hidden")),this.data.hasOwnCanvas&&(Ut.hidden=!0),$.add(Ut),Ut.setAttribute("data-element-id",kt),Ut.disabled=this.data.readOnly,Ut.name=this.data.fieldName,Ut.tabIndex=b,this._setRequired(Ut,this.data.required),Tn&&(Ut.maxLength=Tn),Ut.addEventListener("input",kn=>{Mt.setValue(kt,{value:kn.target.value}),this.setPropertyOnSiblings(Ut,"value",kn.target.value,"value"),bn.formattedValue=null}),Ut.addEventListener("resetform",kn=>{const En=this.data.defaultFieldValue??"";Ut.value=bn.userValue=En,bn.formattedValue=null});let Nn=kn=>{const{formattedValue:En}=bn;En!=null&&(kn.target.value=En),kn.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Ut.addEventListener("focus",En=>{if(bn.focused)return;const{target:Mn}=En;bn.userValue&&(Mn.value=bn.userValue),bn.lastCommittedValue=Mn.value,bn.commitKey=1,bn.focused=!0}),Ut.addEventListener("updatefromsandbox",En=>{this.showElementAndHideCanvas(En.target);const Mn={value(jn){bn.userValue=jn.detail.value??"",Mt.setValue(kt,{value:bn.userValue.toString()}),jn.target.value=bn.userValue},formattedValue(jn){const{formattedValue:zn}=jn.detail;bn.formattedValue=zn,zn!=null&&jn.target!==document.activeElement&&(jn.target.value=zn),Mt.setValue(kt,{formattedValue:zn})},selRange(jn){jn.target.setSelectionRange(...jn.detail.selRange)},charLimit:jn=>{var Rn;const{charLimit:zn}=jn.detail,{target:Vn}=jn;if(zn===0){Vn.removeAttribute("maxLength");return}Vn.setAttribute("maxLength",zn);let Zn=bn.userValue;!Zn||Zn.length<=zn||(Zn=Zn.slice(0,zn),Vn.value=bn.userValue=Zn,Mt.setValue(kt,{value:Zn}),(Rn=this.linkService.eventBus)==null||Rn.dispatch("dispatcheventinsandbox",{source:this,detail:{id:kt,name:"Keystroke",value:Zn,willCommit:!0,commitKey:1,selStart:Vn.selectionStart,selEnd:Vn.selectionEnd}}))}};this._dispatchEventFromSandbox(Mn,En)}),Ut.addEventListener("keydown",En=>{var zn;bn.commitKey=1;let Mn=-1;if(En.key==="Escape"?Mn=0:En.key==="Enter"&&!this.data.multiLine?Mn=2:En.key==="Tab"&&(bn.commitKey=3),Mn===-1)return;const{value:jn}=En.target;bn.lastCommittedValue!==jn&&(bn.lastCommittedValue=jn,bn.userValue=jn,(zn=this.linkService.eventBus)==null||zn.dispatch("dispatcheventinsandbox",{source:this,detail:{id:kt,name:"Keystroke",value:jn,willCommit:!0,commitKey:Mn,selStart:En.target.selectionStart,selEnd:En.target.selectionEnd}}))});const kn=Nn;Nn=null,Ut.addEventListener("blur",En=>{var jn;if(!bn.focused||!En.relatedTarget)return;bn.focused=!1;const{value:Mn}=En.target;bn.userValue=Mn,bn.lastCommittedValue!==Mn&&((jn=this.linkService.eventBus)==null||jn.dispatch("dispatcheventinsandbox",{source:this,detail:{id:kt,name:"Keystroke",value:Mn,willCommit:!0,commitKey:bn.commitKey,selStart:En.target.selectionStart,selEnd:En.target.selectionEnd}})),kn(En)}),(tn=this.data.actions)!=null&&tn.Keystroke&&Ut.addEventListener("beforeinput",En=>{var _n;bn.lastCommittedValue=null;const{data:Mn,target:jn}=En,{value:zn,selectionStart:Vn,selectionEnd:Zn}=jn;let Rn=Vn,Wt=Zn;switch(En.inputType){case"deleteWordBackward":{const On=zn.substring(0,Vn).match(/\w*[^\w]*$/);On&&(Rn-=On[0].length);break}case"deleteWordForward":{const On=zn.substring(Vn).match(/^[^\w]*\w*/);On&&(Wt+=On[0].length);break}case"deleteContentBackward":Vn===Zn&&(Rn-=1);break;case"deleteContentForward":Vn===Zn&&(Wt+=1);break}En.preventDefault(),(_n=this.linkService.eventBus)==null||_n.dispatch("dispatcheventinsandbox",{source:this,detail:{id:kt,name:"Keystroke",value:zn,change:Mn||"",willCommit:!1,selStart:Rn,selEnd:Wt}})}),this._setEventListeners(Ut,bn,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],En=>En.target.value)}if(Nn&&Ut.addEventListener("blur",Nn),this.data.comb){const En=(this.data.rect[2]-this.data.rect[0])/Tn;Ut.classList.add("comb"),Ut.style.letterSpacing=`calc(${En}px * var(--scale-factor) - 1ch)`}}else Ut=document.createElement("div"),Ut.textContent=this.data.fieldValue,Ut.style.verticalAlign="middle",Ut.style.display="table-cell";return this._setTextStyle(Ut),this._setBackgroundColor(Ut),this._setDefaultPropertiesFromJS(Ut),this.container.append(Ut),this.container}}class at extends nt{constructor(Mt){super(Mt,{isRenderable:!!Mt.data.hasOwnCanvas})}}class dt extends nt{constructor(Mt){super(Mt,{isRenderable:Mt.renderForms})}render(){const Mt=this.annotationStorage,kt=this.data,Ut=kt.id;let en=Mt.getValue(Ut,{value:kt.exportValue===kt.fieldValue}).value;typeof en=="string"&&(en=en!=="Off",Mt.setValue(Ut,{value:en})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const tn=document.createElement("input");return $.add(tn),tn.setAttribute("data-element-id",Ut),tn.disabled=kt.readOnly,this._setRequired(tn,this.data.required),tn.type="checkbox",tn.name=kt.fieldName,en&&tn.setAttribute("checked",!0),tn.setAttribute("exportValue",kt.exportValue),tn.tabIndex=b,tn.addEventListener("change",dn=>{const{name:pn,checked:Tn}=dn.target;for(const Cn of this._getElementsByName(pn,Ut)){const bn=Tn&&Cn.exportValue===kt.exportValue;Cn.domElement&&(Cn.domElement.checked=bn),Mt.setValue(Cn.id,{value:bn})}Mt.setValue(Ut,{value:Tn})}),tn.addEventListener("resetform",dn=>{const pn=kt.defaultFieldValue||"Off";dn.target.checked=pn===kt.exportValue}),this.enableScripting&&this.hasJSActions&&(tn.addEventListener("updatefromsandbox",dn=>{const pn={value(Tn){Tn.target.checked=Tn.detail.value!=="Off",Mt.setValue(Ut,{value:Tn.target.checked})}};this._dispatchEventFromSandbox(pn,dn)}),this._setEventListeners(tn,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],dn=>dn.target.checked)),this._setBackgroundColor(tn),this._setDefaultPropertiesFromJS(tn),this.container.append(tn),this.container}}class ot extends nt{constructor(Mt){super(Mt,{isRenderable:Mt.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const Mt=this.annotationStorage,kt=this.data,Ut=kt.id;let en=Mt.getValue(Ut,{value:kt.fieldValue===kt.buttonValue}).value;typeof en=="string"&&(en=en!==kt.buttonValue,Mt.setValue(Ut,{value:en}));const tn=document.createElement("input");if($.add(tn),tn.setAttribute("data-element-id",Ut),tn.disabled=kt.readOnly,this._setRequired(tn,this.data.required),tn.type="radio",tn.name=kt.fieldName,en&&tn.setAttribute("checked",!0),tn.tabIndex=b,tn.addEventListener("change",dn=>{const{name:pn,checked:Tn}=dn.target;for(const Cn of this._getElementsByName(pn,Ut))Mt.setValue(Cn.id,{value:!1});Mt.setValue(Ut,{value:Tn})}),tn.addEventListener("resetform",dn=>{const pn=kt.defaultFieldValue;dn.target.checked=pn!=null&&pn===kt.buttonValue}),this.enableScripting&&this.hasJSActions){const dn=kt.buttonValue;tn.addEventListener("updatefromsandbox",pn=>{const Tn={value:Cn=>{const bn=dn===Cn.detail.value;for(const Nn of this._getElementsByName(Cn.target.name)){const kn=bn&&Nn.id===Ut;Nn.domElement&&(Nn.domElement.checked=kn),Mt.setValue(Nn.id,{value:kn})}}};this._dispatchEventFromSandbox(Tn,pn)}),this._setEventListeners(tn,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],pn=>pn.target.checked)}return this._setBackgroundColor(tn),this._setDefaultPropertiesFromJS(tn),this.container.append(tn),this.container}}class ht extends st{constructor(Mt){super(Mt,{ignoreBorder:Mt.data.hasAppearance})}render(){const Mt=super.render();Mt.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(Mt.title=this.data.alternativeText);const kt=Mt.lastChild;return this.enableScripting&&this.hasJSActions&&kt&&(this._setDefaultPropertiesFromJS(kt),kt.addEventListener("updatefromsandbox",Ut=>{this._dispatchEventFromSandbox({},Ut)})),Mt}}class ut extends nt{constructor(Mt){super(Mt,{isRenderable:Mt.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const Mt=this.annotationStorage,kt=this.data.id,Ut=Mt.getValue(kt,{value:this.data.fieldValue}),en=document.createElement("select");$.add(en),en.setAttribute("data-element-id",kt),en.disabled=this.data.readOnly,this._setRequired(en,this.data.required),en.name=this.data.fieldName,en.tabIndex=b;let tn=this.data.combo&&this.data.options.length>0;this.data.combo||(en.size=this.data.options.length,this.data.multiSelect&&(en.multiple=!0)),en.addEventListener("resetform",bn=>{const Nn=this.data.defaultFieldValue;for(const kn of en.options)kn.selected=kn.value===Nn});for(const bn of this.data.options){const Nn=document.createElement("option");Nn.textContent=bn.displayValue,Nn.value=bn.exportValue,Ut.value.includes(bn.exportValue)&&(Nn.setAttribute("selected",!0),tn=!1),en.append(Nn)}let dn=null;if(tn){const bn=document.createElement("option");bn.value=" ",bn.setAttribute("hidden",!0),bn.setAttribute("selected",!0),en.prepend(bn),dn=()=>{bn.remove(),en.removeEventListener("input",dn),dn=null},en.addEventListener("input",dn)}const pn=bn=>{const Nn=bn?"value":"textContent",{options:kn,multiple:En}=en;return En?Array.prototype.filter.call(kn,Mn=>Mn.selected).map(Mn=>Mn[Nn]):kn.selectedIndex===-1?null:kn[kn.selectedIndex][Nn]};let Tn=pn(!1);const Cn=bn=>{const Nn=bn.target.options;return Array.prototype.map.call(Nn,kn=>({displayValue:kn.textContent,exportValue:kn.value}))};return this.enableScripting&&this.hasJSActions?(en.addEventListener("updatefromsandbox",bn=>{const Nn={value(kn){dn==null||dn();const En=kn.detail.value,Mn=new Set(Array.isArray(En)?En:[En]);for(const jn of en.options)jn.selected=Mn.has(jn.value);Mt.setValue(kt,{value:pn(!0)}),Tn=pn(!1)},multipleSelection(kn){en.multiple=!0},remove(kn){const En=en.options,Mn=kn.detail.remove;En[Mn].selected=!1,en.remove(Mn),En.length>0&&Array.prototype.findIndex.call(En,zn=>zn.selected)===-1&&(En[0].selected=!0),Mt.setValue(kt,{value:pn(!0),items:Cn(kn)}),Tn=pn(!1)},clear(kn){for(;en.length!==0;)en.remove(0);Mt.setValue(kt,{value:null,items:[]}),Tn=pn(!1)},insert(kn){const{index:En,displayValue:Mn,exportValue:jn}=kn.detail.insert,zn=en.children[En],Vn=document.createElement("option");Vn.textContent=Mn,Vn.value=jn,zn?zn.before(Vn):en.append(Vn),Mt.setValue(kt,{value:pn(!0),items:Cn(kn)}),Tn=pn(!1)},items(kn){const{items:En}=kn.detail;for(;en.length!==0;)en.remove(0);for(const Mn of En){const{displayValue:jn,exportValue:zn}=Mn,Vn=document.createElement("option");Vn.textContent=jn,Vn.value=zn,en.append(Vn)}en.options.length>0&&(en.options[0].selected=!0),Mt.setValue(kt,{value:pn(!0),items:Cn(kn)}),Tn=pn(!1)},indices(kn){const En=new Set(kn.detail.indices);for(const Mn of kn.target.options)Mn.selected=En.has(Mn.index);Mt.setValue(kt,{value:pn(!0)}),Tn=pn(!1)},editable(kn){kn.target.disabled=!kn.detail.editable}};this._dispatchEventFromSandbox(Nn,bn)}),en.addEventListener("input",bn=>{var kn;const Nn=pn(!0);Mt.setValue(kt,{value:Nn}),bn.preventDefault(),(kn=this.linkService.eventBus)==null||kn.dispatch("dispatcheventinsandbox",{source:this,detail:{id:kt,name:"Keystroke",value:Tn,changeEx:Nn,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(en,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],bn=>bn.target.value)):en.addEventListener("input",function(bn){Mt.setValue(kt,{value:pn(!0)})}),this.data.combo&&this._setTextStyle(en),this._setBackgroundColor(en),this._setDefaultPropertiesFromJS(en),this.container.append(en),this.container}}class pt extends et{constructor(Mt){const{data:kt,elements:Ut}=Mt;super(Mt,{isRenderable:et._hasPopupData(kt)}),this.elements=Ut}render(){this.container.classList.add("popupAnnotation");const Mt=new _t({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),kt=[];for(const Ut of this.elements)Ut.popup=Mt,kt.push(Ut.data.id),Ut.addHighlightArea();return this.container.setAttribute("aria-controls",kt.map(Ut=>`${o.AnnotationPrefix}${Ut}`).join(",")),this.container}}class _t{constructor({container:Mt,color:kt,elements:Ut,titleObj:en,modificationDate:tn,contentsObj:dn,richText:pn,parent:Tn,rect:Cn,parentRect:bn,open:Nn}){Yt(this,mn);Yt(this,Kt,null);Yt(this,rn,Ht(this,mn,Os).bind(this));Yt(this,nn,Ht(this,mn,ts).bind(this));Yt(this,on,Ht(this,mn,es).bind(this));Yt(this,cn,Ht(this,mn,Sr).bind(this));Yt(this,hn,null);Yt(this,Zt,null);Yt(this,Gt,null);Yt(this,At,null);Yt(this,Ft,null);Yt(this,Vt,null);Yt(this,qt,!1);Yt(this,an,null);Yt(this,fn,null);Yt(this,un,null);Yt(this,zt,null);Yt(this,gn,!1);var En;Qt(this,Zt,Mt),Qt(this,zt,en),Qt(this,Gt,dn),Qt(this,un,pn),Qt(this,Ft,Tn),Qt(this,hn,kt),Qt(this,fn,Cn),Qt(this,Vt,bn),Qt(this,At,Ut);const kn=c.PDFDateString.toDateObject(tn);kn&&Qt(this,Kt,Tn.l10n.get("annotation_date_string",{date:kn.toLocaleDateString(),time:kn.toLocaleTimeString()})),this.trigger=Ut.flatMap(Mn=>Mn.getElementsToTriggerPopup());for(const Mn of this.trigger)Mn.addEventListener("click",ct(this,cn)),Mn.addEventListener("mouseenter",ct(this,on)),Mn.addEventListener("mouseleave",ct(this,nn)),Mn.classList.add("popupTriggerArea");for(const Mn of Ut)(En=Mn.container)==null||En.addEventListener("keydown",ct(this,rn));ct(this,Zt).hidden=!0,Nn&&Ht(this,mn,Sr).call(this)}render(){if(ct(this,an))return;const{page:{view:Mt},viewport:{rawDims:{pageWidth:kt,pageHeight:Ut,pageX:en,pageY:tn}}}=ct(this,Ft),dn=Qt(this,an,document.createElement("div"));if(dn.className="popup",ct(this,hn)){const Rn=dn.style.outlineColor=o.Util.makeHexColor(...ct(this,hn));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?dn.style.backgroundColor=`color-mix(in srgb, ${Rn} 30%, white)`:dn.style.backgroundColor=o.Util.makeHexColor(...ct(this,hn).map(_n=>Math.floor(.7*(255-_n)+_n)))}const pn=document.createElement("span");pn.className="header";const Tn=document.createElement("h1");if(pn.append(Tn),{dir:Tn.dir,str:Tn.textContent}=ct(this,zt),dn.append(pn),ct(this,Kt)){const Rn=document.createElement("span");Rn.classList.add("popupDate"),ct(this,Kt).then(Wt=>{Rn.textContent=Wt}),pn.append(Rn)}const Cn=ct(this,Gt),bn=ct(this,un);if(bn!=null&&bn.str&&(!(Cn!=null&&Cn.str)||Cn.str===bn.str))_.XfaLayer.render({xfaHtml:bn.html,intent:"richText",div:dn}),dn.lastChild.classList.add("richText","popupContent");else{const Rn=this._formatContents(Cn);dn.append(Rn)}let Nn=!!ct(this,Vt),kn=Nn?ct(this,Vt):ct(this,fn);for(const Rn of ct(this,At))if(!kn||o.Util.intersect(Rn.data.rect,kn)!==null){kn=Rn.data.rect,Nn=!0;break}const En=o.Util.normalizeRect([kn[0],Mt[3]-kn[1]+Mt[1],kn[2],Mt[3]-kn[3]+Mt[1]]),jn=Nn?kn[2]-kn[0]+5:0,zn=En[0]+jn,Vn=En[1],{style:Zn}=ct(this,Zt);Zn.left=`${100*(zn-en)/kt}%`,Zn.top=`${100*(Vn-tn)/Ut}%`,ct(this,Zt).append(dn)}_formatContents({str:Mt,dir:kt}){const Ut=document.createElement("p");Ut.classList.add("popupContent"),Ut.dir=kt;const en=Mt.split(/(?:\r\n?|\n)/);for(let tn=0,dn=en.length;tn<dn;++tn){const pn=en[tn];Ut.append(document.createTextNode(pn)),tn<dn-1&&Ut.append(document.createElement("br"))}return Ut}forceHide(){Qt(this,gn,this.isVisible),ct(this,gn)&&(ct(this,Zt).hidden=!0)}maybeShow(){ct(this,gn)&&(Qt(this,gn,!1),ct(this,Zt).hidden=!1)}get isVisible(){return ct(this,Zt).hidden===!1}}Kt=new WeakMap,rn=new WeakMap,nn=new WeakMap,on=new WeakMap,cn=new WeakMap,hn=new WeakMap,Zt=new WeakMap,Gt=new WeakMap,At=new WeakMap,Ft=new WeakMap,Vt=new WeakMap,qt=new WeakMap,an=new WeakMap,fn=new WeakMap,un=new WeakMap,zt=new WeakMap,gn=new WeakMap,mn=new WeakSet,Os=function(Mt){Mt.altKey||Mt.shiftKey||Mt.ctrlKey||Mt.metaKey||(Mt.key==="Enter"||Mt.key==="Escape"&&ct(this,qt))&&Ht(this,mn,Sr).call(this)},Sr=function(){Qt(this,qt,!ct(this,qt)),ct(this,qt)?(Ht(this,mn,es).call(this),ct(this,Zt).addEventListener("click",ct(this,cn)),ct(this,Zt).addEventListener("keydown",ct(this,rn))):(Ht(this,mn,ts).call(this),ct(this,Zt).removeEventListener("click",ct(this,cn)),ct(this,Zt).removeEventListener("keydown",ct(this,rn)))},es=function(){ct(this,an)||this.render(),this.isVisible?ct(this,qt)&&ct(this,Zt).classList.add("focused"):(ct(this,Zt).hidden=!1,ct(this,Zt).style.zIndex=parseInt(ct(this,Zt).style.zIndex)+1e3)},ts=function(){ct(this,Zt).classList.remove("focused"),!(ct(this,qt)||!this.isVisible)&&(ct(this,Zt).hidden=!0,ct(this,Zt).style.zIndex=parseInt(ct(this,Zt).style.zIndex)-1e3)};class wt extends et{constructor(Mt){super(Mt,{isRenderable:!0,ignoreBorder:!0}),this.textContent=Mt.data.textContent,this.textPosition=Mt.data.textPosition,this.annotationEditorType=o.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const Mt=document.createElement("div");Mt.classList.add("annotationTextContent"),Mt.setAttribute("role","comment");for(const kt of this.textContent){const Ut=document.createElement("span");Ut.textContent=kt,Mt.append(Ut)}this.container.append(Mt)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=wt;class mt extends et{constructor(kt){super(kt,{isRenderable:!0,ignoreBorder:!0});Yt(this,In,null)}render(){this.container.classList.add("lineAnnotation");const kt=this.data,{width:Ut,height:en}=_e(kt.rect),tn=this.svgFactory.create(Ut,en,!0),dn=Qt(this,In,this.svgFactory.createElement("svg:line"));return dn.setAttribute("x1",kt.rect[2]-kt.lineCoordinates[0]),dn.setAttribute("y1",kt.rect[3]-kt.lineCoordinates[1]),dn.setAttribute("x2",kt.rect[2]-kt.lineCoordinates[2]),dn.setAttribute("y2",kt.rect[3]-kt.lineCoordinates[3]),dn.setAttribute("stroke-width",kt.borderStyle.width||1),dn.setAttribute("stroke","transparent"),dn.setAttribute("fill","transparent"),tn.append(dn),this.container.append(tn),!kt.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ct(this,In)}addHighlightArea(){this.container.classList.add("highlightArea")}}In=new WeakMap;class Et extends et{constructor(kt){super(kt,{isRenderable:!0,ignoreBorder:!0});Yt(this,Un,null)}render(){this.container.classList.add("squareAnnotation");const kt=this.data,{width:Ut,height:en}=_e(kt.rect),tn=this.svgFactory.create(Ut,en,!0),dn=kt.borderStyle.width,pn=Qt(this,Un,this.svgFactory.createElement("svg:rect"));return pn.setAttribute("x",dn/2),pn.setAttribute("y",dn/2),pn.setAttribute("width",Ut-dn),pn.setAttribute("height",en-dn),pn.setAttribute("stroke-width",dn||1),pn.setAttribute("stroke","transparent"),pn.setAttribute("fill","transparent"),tn.append(pn),this.container.append(tn),!kt.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ct(this,Un)}addHighlightArea(){this.container.classList.add("highlightArea")}}Un=new WeakMap;class Pt extends et{constructor(kt){super(kt,{isRenderable:!0,ignoreBorder:!0});Yt(this,Hn,null)}render(){this.container.classList.add("circleAnnotation");const kt=this.data,{width:Ut,height:en}=_e(kt.rect),tn=this.svgFactory.create(Ut,en,!0),dn=kt.borderStyle.width,pn=Qt(this,Hn,this.svgFactory.createElement("svg:ellipse"));return pn.setAttribute("cx",Ut/2),pn.setAttribute("cy",en/2),pn.setAttribute("rx",Ut/2-dn/2),pn.setAttribute("ry",en/2-dn/2),pn.setAttribute("stroke-width",dn||1),pn.setAttribute("stroke","transparent"),pn.setAttribute("fill","transparent"),tn.append(pn),this.container.append(tn),!kt.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ct(this,Hn)}addHighlightArea(){this.container.classList.add("highlightArea")}}Hn=new WeakMap;class jt extends et{constructor(kt){super(kt,{isRenderable:!0,ignoreBorder:!0});Yt(this,ln,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const kt=this.data,{width:Ut,height:en}=_e(kt.rect),tn=this.svgFactory.create(Ut,en,!0);let dn=[];for(const Tn of kt.vertices){const Cn=Tn.x-kt.rect[0],bn=kt.rect[3]-Tn.y;dn.push(Cn+","+bn)}dn=dn.join(" ");const pn=Qt(this,ln,this.svgFactory.createElement(this.svgElementName));return pn.setAttribute("points",dn),pn.setAttribute("stroke-width",kt.borderStyle.width||1),pn.setAttribute("stroke","transparent"),pn.setAttribute("fill","transparent"),tn.append(pn),this.container.append(tn),!kt.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return ct(this,ln)}addHighlightArea(){this.container.classList.add("highlightArea")}}ln=new WeakMap;class St extends jt{constructor(Mt){super(Mt),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Ot extends et{constructor(Mt){super(Mt,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Ct extends et{constructor(kt){super(kt,{isRenderable:!0,ignoreBorder:!0});Yt(this,Xt,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=o.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const kt=this.data,{width:Ut,height:en}=_e(kt.rect),tn=this.svgFactory.create(Ut,en,!0);for(const dn of kt.inkLists){let pn=[];for(const Cn of dn){const bn=Cn.x-kt.rect[0],Nn=kt.rect[3]-Cn.y;pn.push(`${bn},${Nn}`)}pn=pn.join(" ");const Tn=this.svgFactory.createElement(this.svgElementName);ct(this,Xt).push(Tn),Tn.setAttribute("points",pn),Tn.setAttribute("stroke-width",kt.borderStyle.width||1),Tn.setAttribute("stroke","transparent"),Tn.setAttribute("fill","transparent"),!kt.popupRef&&this.hasPopupData&&this._createPopup(),tn.append(Tn)}return this.container.append(tn),this.container}getElementsToTriggerPopup(){return ct(this,Xt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Xt=new WeakMap,e.InkAnnotationElement=Ct;class Rt extends et{constructor(Mt){super(Mt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class bt extends et{constructor(Mt){super(Mt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Tt extends et{constructor(Mt){super(Mt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class $t extends et{constructor(Mt){super(Mt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class xt extends et{constructor(Mt){super(Mt,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=xt;class ft extends et{constructor(kt){var tn;super(kt,{isRenderable:!0});Yt(this,xn);Yt(this,Jt,null);const{filename:Ut,content:en}=this.data.file;this.filename=(0,c.getFilenameFromUrl)(Ut,!0),this.content=en,(tn=this.linkService.eventBus)==null||tn.dispatch("fileattachmentannotation",{source:this,filename:Ut,content:en})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:kt,data:Ut}=this;let en;Ut.hasAppearance||Ut.fillAlpha===0?en=document.createElement("div"):(en=document.createElement("img"),en.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(Ut.name)?"paperclip":"pushpin"}.svg`,Ut.fillAlpha&&Ut.fillAlpha<1&&(en.style=`filter: opacity(${Math.round(Ut.fillAlpha*100)}%);`)),en.addEventListener("dblclick",Ht(this,xn,ns).bind(this)),Qt(this,Jt,en);const{isMac:tn}=o.FeatureTest.platform;return kt.addEventListener("keydown",dn=>{dn.key==="Enter"&&(tn?dn.metaKey:dn.ctrlKey)&&Ht(this,xn,ns).call(this)}),!Ut.popupRef&&this.hasPopupData?this._createPopup():en.classList.add("popupTriggerArea"),kt.append(en),kt}getElementsToTriggerPopup(){return ct(this,Jt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Jt=new WeakMap,xn=new WeakSet,ns=function(){var kt;(kt=this.downloadManager)==null||kt.openOrDownloadData(this.container,this.content,this.filename)};class yt{constructor({div:Mt,accessibilityManager:kt,annotationCanvasMap:Ut,l10n:en,page:tn,viewport:dn}){Yt(this,yn);Yt(this,Dn,null);Yt(this,Dt,null);Yt(this,sn,new Map);this.div=Mt,Qt(this,Dn,kt),Qt(this,Dt,Ut),this.l10n=en,this.page=tn,this.viewport=dn,this.zIndex=0,this.l10n||(this.l10n=g.NullL10n)}async render(Mt){const{annotations:kt}=Mt,Ut=this.div;(0,c.setLayerDimensions)(Ut,this.viewport);const en=new Map,tn={data:null,layer:Ut,linkService:Mt.linkService,downloadManager:Mt.downloadManager,imageResourcesPath:Mt.imageResourcesPath||"",renderForms:Mt.renderForms!==!1,svgFactory:new c.DOMSVGFactory,annotationStorage:Mt.annotationStorage||new d.AnnotationStorage,enableScripting:Mt.enableScripting===!0,hasJSActions:Mt.hasJSActions,fieldObjects:Mt.fieldObjects,parent:this,elements:null};for(const dn of kt){if(dn.noHTML)continue;const pn=dn.annotationType===o.AnnotationType.POPUP;if(pn){const bn=en.get(dn.id);if(!bn)continue;tn.elements=bn}else{const{width:bn,height:Nn}=_e(dn.rect);if(bn<=0||Nn<=0)continue}tn.data=dn;const Tn=tt.create(tn);if(!Tn.isRenderable)continue;if(!pn&&dn.popupRef){const bn=en.get(dn.popupRef);bn?bn.push(Tn):en.set(dn.popupRef,[Tn])}Tn.annotationEditorType>0&&ct(this,sn).set(Tn.data.id,Tn);const Cn=Tn.render();dn.hidden&&(Cn.style.visibility="hidden"),Ht(this,yn,Ls).call(this,Cn,dn.id)}Ht(this,yn,rs).call(this),await this.l10n.translate(Ut)}update({viewport:Mt}){const kt=this.div;this.viewport=Mt,(0,c.setLayerDimensions)(kt,{rotation:Mt.rotation}),Ht(this,yn,rs).call(this),kt.hidden=!1}getEditableAnnotations(){return Array.from(ct(this,sn).values())}getEditableAnnotation(Mt){return ct(this,sn).get(Mt)}}Dn=new WeakMap,Dt=new WeakMap,sn=new WeakMap,yn=new WeakSet,Ls=function(Mt,kt){var en;const Ut=Mt.firstChild||Mt;Ut.id=`${o.AnnotationPrefix}${kt}`,this.div.append(Mt),(en=ct(this,Dn))==null||en.moveElementInDOM(this.div,Mt,Ut,!1)},rs=function(){if(!ct(this,Dt))return;const Mt=this.div;for(const[kt,Ut]of ct(this,Dt)){const en=Mt.querySelector(`[data-annotation-id="${kt}"]`);if(!en)continue;const{firstChild:tn}=en;tn?tn.nodeName==="CANVAS"?tn.replaceWith(Ut):tn.before(Ut):en.append(Ut)}ct(this,Dt).clear()},e.AnnotationLayer=yt},(s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function a(d){return Math.floor(Math.max(0,Math.min(1,d))*255).toString(16).padStart(2,"0")}function o(d){return Math.max(0,Math.min(255,255*d))}class c{static CMYK_G([h,g,_,b]){return["G",1-Math.min(1,.3*h+.59*_+.11*g+b)]}static G_CMYK([h]){return["CMYK",0,0,0,1-h]}static G_RGB([h]){return["RGB",h,h,h]}static G_rgb([h]){return h=o(h),[h,h,h]}static G_HTML([h]){const g=a(h);return`#${g}${g}${g}`}static RGB_G([h,g,_]){return["G",.3*h+.59*g+.11*_]}static RGB_rgb(h){return h.map(o)}static RGB_HTML(h){return`#${h.map(a).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([h,g,_,b]){return["RGB",1-Math.min(1,h+b),1-Math.min(1,_+b),1-Math.min(1,g+b)]}static CMYK_rgb([h,g,_,b]){return[o(1-Math.min(1,h+b)),o(1-Math.min(1,_+b)),o(1-Math.min(1,g+b))]}static CMYK_HTML(h){const g=this.CMYK_RGB(h).slice(1);return this.RGB_HTML(g)}static RGB_CMYK([h,g,_]){const b=1-h,j=1-g,$=1-_,_e=Math.min(b,j,$);return["CMYK",b,j,$,_e]}}e.ColorConverters=c},(s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=o;const a={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};a.print_progress_percent="{{progress}}%";function o(h,g){switch(h){case"find_match_count":h=`find_match_count[${g.total===1?"one":"other"}]`;break;case"find_match_count_limit":h=`find_match_count_limit[${g.limit===1?"one":"other"}]`;break}return a[h]||""}function c(h,g){return g?h.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(_,b)=>b in g?g[b]:"{{"+b+"}}"):h}const d={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(h,g=null,_=o(h,g)){return c(_,g)},async translate(h){}};e.NullL10n=d},(s,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var o=a(25);class c{static setupStorage(h,g,_,b,j){const $=b.getValue(g,{value:null});switch(_.name){case"textarea":if($.value!==null&&(h.textContent=$.value),j==="print")break;h.addEventListener("input",_e=>{b.setValue(g,{value:_e.target.value})});break;case"input":if(_.attributes.type==="radio"||_.attributes.type==="checkbox"){if($.value===_.attributes.xfaOn?h.setAttribute("checked",!0):$.value===_.attributes.xfaOff&&h.removeAttribute("checked"),j==="print")break;h.addEventListener("change",_e=>{b.setValue(g,{value:_e.target.checked?_e.target.getAttribute("xfaOn"):_e.target.getAttribute("xfaOff")})})}else{if($.value!==null&&h.setAttribute("value",$.value),j==="print")break;h.addEventListener("input",_e=>{b.setValue(g,{value:_e.target.value})})}break;case"select":if($.value!==null){h.setAttribute("value",$.value);for(const _e of _.children)_e.attributes.value===$.value?_e.attributes.selected=!0:_e.attributes.hasOwnProperty("selected")&&delete _e.attributes.selected}h.addEventListener("input",_e=>{const tt=_e.target.options,et=tt.selectedIndex===-1?"":tt[tt.selectedIndex].value;b.setValue(g,{value:et})});break}}static setAttributes({html:h,element:g,storage:_=null,intent:b,linkService:j}){const{attributes:$}=g,_e=h instanceof HTMLAnchorElement;$.type==="radio"&&($.name=`${$.name}-${b}`);for(const[tt,et]of Object.entries($))if(et!=null)switch(tt){case"class":et.length&&h.setAttribute(tt,et.join(" "));break;case"dataId":break;case"id":h.setAttribute("data-element-id",et);break;case"style":Object.assign(h.style,et);break;case"textContent":h.textContent=et;break;default:(!_e||tt!=="href"&&tt!=="newWindow")&&h.setAttribute(tt,et)}_e&&j.addLinkAttributes(h,$.href,$.newWindow),_&&$.dataId&&this.setupStorage(h,$.dataId,g,_)}static render(h){var st;const g=h.annotationStorage,_=h.linkService,b=h.xfaHtml,j=h.intent||"display",$=document.createElement(b.name);b.attributes&&this.setAttributes({html:$,element:b,intent:j,linkService:_});const _e=[[b,-1,$]],tt=h.div;if(tt.append($),h.viewport){const rt=`matrix(${h.viewport.transform.join(",")})`;tt.style.transform=rt}j!=="richText"&&tt.setAttribute("class","xfaLayer xfaFont");const et=[];for(;_e.length>0;){const[rt,nt,it]=_e.at(-1);if(nt+1===rt.children.length){_e.pop();continue}const at=rt.children[++_e.at(-1)[1]];if(at===null)continue;const{name:dt}=at;if(dt==="#text"){const ht=document.createTextNode(at.value);et.push(ht),it.append(ht);continue}const ot=(st=at==null?void 0:at.attributes)!=null&&st.xmlns?document.createElementNS(at.attributes.xmlns,dt):document.createElement(dt);if(it.append(ot),at.attributes&&this.setAttributes({html:ot,element:at,storage:g,intent:j,linkService:_}),at.children&&at.children.length>0)_e.push([at,-1,ot]);else if(at.value){const ht=document.createTextNode(at.value);o.XfaText.shouldBuildText(dt)&&et.push(ht),ot.append(ht)}}for(const rt of tt.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))rt.setAttribute("readOnly",!0);return{textDivs:et}}static update(h){const g=`matrix(${h.viewport.transform.join(",")})`;h.div.style.transform=g,h.div.hidden=!1}}e.XfaLayer=c},(s,e,a)=>{var b,j,$,_e,tt,et,st,rt,nt,it,at,dt,ot,ht,ut,Ms,Ns,Fs,Ds,ss,js,is,$s,Us,Bs,Hs,zs,er,as,Ar,Tr,ar,os,Cr,Lt,Vs,ls,Ws,Zs,cs,kr,or;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var o=a(1),c=a(4),d=a(29),h=a(6),g=a(5);const hn=class hn extends c.AnnotationEditor{constructor(At){super({...At,name:"inkEditor"});Yt(this,ut);Yt(this,b,0);Yt(this,j,0);Yt(this,$,this.canvasPointermove.bind(this));Yt(this,_e,this.canvasPointerleave.bind(this));Yt(this,tt,this.canvasPointerup.bind(this));Yt(this,et,this.canvasPointerdown.bind(this));Yt(this,st,new Path2D);Yt(this,rt,!1);Yt(this,nt,!1);Yt(this,it,!1);Yt(this,at,null);Yt(this,dt,0);Yt(this,ot,0);Yt(this,ht,null);this.color=At.color||null,this.thickness=At.thickness||null,this.opacity=At.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(At){c.AnnotationEditor.initialize(At,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(At,Ft){switch(At){case o.AnnotationEditorParamsType.INK_THICKNESS:hn._defaultThickness=Ft;break;case o.AnnotationEditorParamsType.INK_COLOR:hn._defaultColor=Ft;break;case o.AnnotationEditorParamsType.INK_OPACITY:hn._defaultOpacity=Ft/100;break}}updateParams(At,Ft){switch(At){case o.AnnotationEditorParamsType.INK_THICKNESS:Ht(this,ut,Ms).call(this,Ft);break;case o.AnnotationEditorParamsType.INK_COLOR:Ht(this,ut,Ns).call(this,Ft);break;case o.AnnotationEditorParamsType.INK_OPACITY:Ht(this,ut,Fs).call(this,Ft);break}}static get defaultPropertiesToUpdate(){return[[o.AnnotationEditorParamsType.INK_THICKNESS,hn._defaultThickness],[o.AnnotationEditorParamsType.INK_COLOR,hn._defaultColor||c.AnnotationEditor._defaultLineColor],[o.AnnotationEditorParamsType.INK_OPACITY,Math.round(hn._defaultOpacity*100)]]}get propertiesToUpdate(){return[[o.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||hn._defaultThickness],[o.AnnotationEditorParamsType.INK_COLOR,this.color||hn._defaultColor||c.AnnotationEditor._defaultLineColor],[o.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??hn._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(Ht(this,ut,Ar).call(this),Ht(this,ut,Tr).call(this)),this.isAttachedToDOM||(this.parent.add(this),Ht(this,ut,ar).call(this)),Ht(this,ut,or).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,ct(this,at).disconnect(),Qt(this,at,null),super.remove())}setParent(At){!this.parent&&At?this._uiManager.removeShouldRescale(this):this.parent&&At===null&&this._uiManager.addShouldRescale(this),super.setParent(At)}onScaleChanging(){const[At,Ft]=this.parentDimensions,Vt=this.width*At,qt=this.height*Ft;this.setDimensions(Vt,qt)}enableEditMode(){ct(this,rt)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",ct(this,et)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",ct(this,et)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){ct(this,rt)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),Qt(this,rt,!0),this.div.classList.add("disabled"),Ht(this,ut,or).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(At){this._focusEventsAllowed&&(super.focusin(At),this.enableEditMode())}canvasPointerdown(At){At.button!==0||!this.isInEditMode()||ct(this,rt)||(this.setInForeground(),At.preventDefault(),At.type!=="mouse"&&this.div.focus(),Ht(this,ut,js).call(this,At.offsetX,At.offsetY))}canvasPointermove(At){At.preventDefault(),Ht(this,ut,is).call(this,At.offsetX,At.offsetY)}canvasPointerup(At){At.preventDefault(),Ht(this,ut,as).call(this,At)}canvasPointerleave(At){Ht(this,ut,as).call(this,At)}get isResizable(){return!this.isEmpty()&&ct(this,rt)}render(){if(this.div)return this.div;let At,Ft;this.width&&(At=this.x,Ft=this.y),super.render(),c.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(un=>{var zt;return(zt=this.div)==null?void 0:zt.setAttribute("aria-label",un)});const[Vt,qt,an,fn]=Ht(this,ut,Ds).call(this);if(this.setAt(Vt,qt,0,0),this.setDims(an,fn),Ht(this,ut,Ar).call(this),this.width){const[un,zt]=this.parentDimensions;this.setAspectRatio(this.width*un,this.height*zt),this.setAt(At*un,Ft*zt,this.width*un,this.height*zt),Qt(this,it,!0),Ht(this,ut,ar).call(this),this.setDims(this.width*un,this.height*zt),Ht(this,ut,er).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Ht(this,ut,Tr).call(this),this.div}setDimensions(At,Ft){const Vt=Math.round(At),qt=Math.round(Ft);if(ct(this,dt)===Vt&&ct(this,ot)===qt)return;Qt(this,dt,Vt),Qt(this,ot,qt),this.canvas.style.visibility="hidden";const[an,fn]=this.parentDimensions;this.width=At/an,this.height=Ft/fn,this.fixAndSetPosition(),ct(this,rt)&&Ht(this,ut,os).call(this,At,Ft),Ht(this,ut,ar).call(this),Ht(this,ut,er).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(At,Ft,Vt){var In,Un,Hn;if(At instanceof d.InkAnnotationElement)return null;const qt=super.deserialize(At,Ft,Vt);qt.thickness=At.thickness,qt.color=o.Util.makeHexColor(...At.color),qt.opacity=At.opacity;const[an,fn]=qt.pageDimensions,un=qt.width*an,zt=qt.height*fn,gn=qt.parentScale,mn=At.thickness/2;Qt(qt,rt,!0),Qt(qt,dt,Math.round(un)),Qt(qt,ot,Math.round(zt));const{paths:Fn,rect:Ln,rotation:Bn}=At;for(let{bezier:ln}of Fn){ln=Ht(In=hn,Lt,Ws).call(In,ln,Ln,Bn);const Xt=[];qt.paths.push(Xt);let Jt=gn*(ln[0]-mn),xn=gn*(ln[1]-mn);for(let Dn=2,Dt=ln.length;Dn<Dt;Dn+=6){const sn=gn*(ln[Dn]-mn),yn=gn*(ln[Dn+1]-mn),Pn=gn*(ln[Dn+2]-mn),vn=gn*(ln[Dn+3]-mn),wn=gn*(ln[Dn+4]-mn),Mt=gn*(ln[Dn+5]-mn);Xt.push([[Jt,xn],[sn,yn],[Pn,vn],[wn,Mt]]),Jt=wn,xn=Mt}const $n=Ht(this,Lt,Vs).call(this,Xt);qt.bezierPath2D.push($n)}const An=Ht(Un=qt,ut,cs).call(Un);return Qt(qt,j,Math.max(c.AnnotationEditor.MIN_SIZE,An[2]-An[0])),Qt(qt,b,Math.max(c.AnnotationEditor.MIN_SIZE,An[3]-An[1])),Ht(Hn=qt,ut,os).call(Hn,un,zt),qt}serialize(){if(this.isEmpty())return null;const At=this.getRect(0,0),Ft=c.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:o.AnnotationEditorType.INK,color:Ft,thickness:this.thickness,opacity:this.opacity,paths:Ht(this,ut,Zs).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,At),pageIndex:this.pageIndex,rect:At,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};b=new WeakMap,j=new WeakMap,$=new WeakMap,_e=new WeakMap,tt=new WeakMap,et=new WeakMap,st=new WeakMap,rt=new WeakMap,nt=new WeakMap,it=new WeakMap,at=new WeakMap,dt=new WeakMap,ot=new WeakMap,ht=new WeakMap,ut=new WeakSet,Ms=function(At){const Ft=this.thickness;this.addCommands({cmd:()=>{this.thickness=At,Ht(this,ut,or).call(this)},undo:()=>{this.thickness=Ft,Ht(this,ut,or).call(this)},mustExec:!0,type:o.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Ns=function(At){const Ft=this.color;this.addCommands({cmd:()=>{this.color=At,Ht(this,ut,er).call(this)},undo:()=>{this.color=Ft,Ht(this,ut,er).call(this)},mustExec:!0,type:o.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Fs=function(At){At/=100;const Ft=this.opacity;this.addCommands({cmd:()=>{this.opacity=At,Ht(this,ut,er).call(this)},undo:()=>{this.opacity=Ft,Ht(this,ut,er).call(this)},mustExec:!0,type:o.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Ds=function(){const{parentRotation:At,parentDimensions:[Ft,Vt]}=this;switch(At){case 90:return[0,Vt,Vt,Ft];case 180:return[Ft,Vt,Ft,Vt];case 270:return[Ft,0,Vt,Ft];default:return[0,0,Ft,Vt]}},ss=function(){const{ctx:At,color:Ft,opacity:Vt,thickness:qt,parentScale:an,scaleFactor:fn}=this;At.lineWidth=qt*an/fn,At.lineCap="round",At.lineJoin="round",At.miterLimit=10,At.strokeStyle=`${Ft}${(0,g.opacityToHex)(Vt)}`},js=function(At,Ft){this.canvas.addEventListener("contextmenu",h.noContextMenu),this.canvas.addEventListener("pointerleave",ct(this,_e)),this.canvas.addEventListener("pointermove",ct(this,$)),this.canvas.addEventListener("pointerup",ct(this,tt)),this.canvas.removeEventListener("pointerdown",ct(this,et)),this.isEditing=!0,ct(this,it)||(Qt(this,it,!0),Ht(this,ut,ar).call(this),this.thickness||(this.thickness=hn._defaultThickness),this.color||(this.color=hn._defaultColor||c.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=hn._defaultOpacity)),this.currentPath.push([At,Ft]),Qt(this,nt,!1),Ht(this,ut,ss).call(this),Qt(this,ht,()=>{Ht(this,ut,Bs).call(this),ct(this,ht)&&window.requestAnimationFrame(ct(this,ht))}),window.requestAnimationFrame(ct(this,ht))},is=function(At,Ft){const[Vt,qt]=this.currentPath.at(-1);if(this.currentPath.length>1&&At===Vt&&Ft===qt)return;const an=this.currentPath;let fn=ct(this,st);if(an.push([At,Ft]),Qt(this,nt,!0),an.length<=2){fn.moveTo(...an[0]),fn.lineTo(At,Ft);return}an.length===3&&(Qt(this,st,fn=new Path2D),fn.moveTo(...an[0])),Ht(this,ut,Hs).call(this,fn,...an.at(-3),...an.at(-2),At,Ft)},$s=function(){if(this.currentPath.length===0)return;const At=this.currentPath.at(-1);ct(this,st).lineTo(...At)},Us=function(At,Ft){Qt(this,ht,null),At=Math.min(Math.max(At,0),this.canvas.width),Ft=Math.min(Math.max(Ft,0),this.canvas.height),Ht(this,ut,is).call(this,At,Ft),Ht(this,ut,$s).call(this);let Vt;if(this.currentPath.length!==1)Vt=Ht(this,ut,zs).call(this);else{const zt=[At,Ft];Vt=[[zt,zt.slice(),zt.slice(),zt]]}const qt=ct(this,st),an=this.currentPath;this.currentPath=[],Qt(this,st,new Path2D);const fn=()=>{this.allRawPaths.push(an),this.paths.push(Vt),this.bezierPath2D.push(qt),this.rebuild()},un=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Ht(this,ut,Ar).call(this),Ht(this,ut,Tr).call(this)),Ht(this,ut,or).call(this))};this.addCommands({cmd:fn,undo:un,mustExec:!0})},Bs=function(){if(!ct(this,nt))return;Qt(this,nt,!1);const At=Math.ceil(this.thickness*this.parentScale),Ft=this.currentPath.slice(-3),Vt=Ft.map(fn=>fn[0]),qt=Ft.map(fn=>fn[1]);Math.min(...Vt)-At,Math.max(...Vt)+At,Math.min(...qt)-At,Math.max(...qt)+At;const{ctx:an}=this;an.save(),an.clearRect(0,0,this.canvas.width,this.canvas.height);for(const fn of this.bezierPath2D)an.stroke(fn);an.stroke(ct(this,st)),an.restore()},Hs=function(At,Ft,Vt,qt,an,fn,un){const zt=(Ft+qt)/2,gn=(Vt+an)/2,mn=(qt+fn)/2,Fn=(an+un)/2;At.bezierCurveTo(zt+2*(qt-zt)/3,gn+2*(an-gn)/3,mn+2*(qt-mn)/3,Fn+2*(an-Fn)/3,mn,Fn)},zs=function(){const At=this.currentPath;if(At.length<=2)return[[At[0],At[0],At.at(-1),At.at(-1)]];const Ft=[];let Vt,[qt,an]=At[0];for(Vt=1;Vt<At.length-2;Vt++){const[Ln,Bn]=At[Vt],[An,In]=At[Vt+1],Un=(Ln+An)/2,Hn=(Bn+In)/2,ln=[qt+2*(Ln-qt)/3,an+2*(Bn-an)/3],Xt=[Un+2*(Ln-Un)/3,Hn+2*(Bn-Hn)/3];Ft.push([[qt,an],ln,Xt,[Un,Hn]]),[qt,an]=[Un,Hn]}const[fn,un]=At[Vt],[zt,gn]=At[Vt+1],mn=[qt+2*(fn-qt)/3,an+2*(un-an)/3],Fn=[zt+2*(fn-zt)/3,gn+2*(un-gn)/3];return Ft.push([[qt,an],mn,Fn,[zt,gn]]),Ft},er=function(){if(this.isEmpty()){Ht(this,ut,Cr).call(this);return}Ht(this,ut,ss).call(this);const{canvas:At,ctx:Ft}=this;Ft.setTransform(1,0,0,1,0,0),Ft.clearRect(0,0,At.width,At.height),Ht(this,ut,Cr).call(this);for(const Vt of this.bezierPath2D)Ft.stroke(Vt)},as=function(At){this.canvas.removeEventListener("pointerleave",ct(this,_e)),this.canvas.removeEventListener("pointermove",ct(this,$)),this.canvas.removeEventListener("pointerup",ct(this,tt)),this.canvas.addEventListener("pointerdown",ct(this,et)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",h.noContextMenu)},10),Ht(this,ut,Us).call(this,At.offsetX,At.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Ar=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",c.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(At=>{var Ft;return(Ft=this.canvas)==null?void 0:Ft.setAttribute("aria-label",At)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Tr=function(){Qt(this,at,new ResizeObserver(At=>{const Ft=At[0].contentRect;Ft.width&&Ft.height&&this.setDimensions(Ft.width,Ft.height)})),ct(this,at).observe(this.div)},ar=function(){if(!ct(this,it))return;const[At,Ft]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*At),this.canvas.height=Math.ceil(this.height*Ft),Ht(this,ut,Cr).call(this)},os=function(At,Ft){const Vt=Ht(this,ut,kr).call(this),qt=(At-Vt)/ct(this,j),an=(Ft-Vt)/ct(this,b);this.scaleFactor=Math.min(qt,an)},Cr=function(){const At=Ht(this,ut,kr).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+At,this.translationY*this.scaleFactor+At)},Lt=new WeakSet,Vs=function(At){const Ft=new Path2D;for(let Vt=0,qt=At.length;Vt<qt;Vt++){const[an,fn,un,zt]=At[Vt];Vt===0&&Ft.moveTo(...an),Ft.bezierCurveTo(fn[0],fn[1],un[0],un[1],zt[0],zt[1])}return Ft},ls=function(At,Ft,Vt){const[qt,an,fn,un]=Ft;switch(Vt){case 0:for(let zt=0,gn=At.length;zt<gn;zt+=2)At[zt]+=qt,At[zt+1]=un-At[zt+1];break;case 90:for(let zt=0,gn=At.length;zt<gn;zt+=2){const mn=At[zt];At[zt]=At[zt+1]+qt,At[zt+1]=mn+an}break;case 180:for(let zt=0,gn=At.length;zt<gn;zt+=2)At[zt]=fn-At[zt],At[zt+1]+=an;break;case 270:for(let zt=0,gn=At.length;zt<gn;zt+=2){const mn=At[zt];At[zt]=fn-At[zt+1],At[zt+1]=un-mn}break;default:throw new Error("Invalid rotation")}return At},Ws=function(At,Ft,Vt){const[qt,an,fn,un]=Ft;switch(Vt){case 0:for(let zt=0,gn=At.length;zt<gn;zt+=2)At[zt]-=qt,At[zt+1]=un-At[zt+1];break;case 90:for(let zt=0,gn=At.length;zt<gn;zt+=2){const mn=At[zt];At[zt]=At[zt+1]-an,At[zt+1]=mn-qt}break;case 180:for(let zt=0,gn=At.length;zt<gn;zt+=2)At[zt]=fn-At[zt],At[zt+1]-=an;break;case 270:for(let zt=0,gn=At.length;zt<gn;zt+=2){const mn=At[zt];At[zt]=un-At[zt+1],At[zt+1]=fn-mn}break;default:throw new Error("Invalid rotation")}return At},Zs=function(At,Ft,Vt,qt){var gn,mn;const an=[],fn=this.thickness/2,un=At*Ft+fn,zt=At*Vt+fn;for(const Fn of this.paths){const Ln=[],Bn=[];for(let An=0,In=Fn.length;An<In;An++){const[Un,Hn,ln,Xt]=Fn[An],Jt=At*Un[0]+un,xn=At*Un[1]+zt,$n=At*Hn[0]+un,Dn=At*Hn[1]+zt,Dt=At*ln[0]+un,sn=At*ln[1]+zt,yn=At*Xt[0]+un,Pn=At*Xt[1]+zt;An===0&&(Ln.push(Jt,xn),Bn.push(Jt,xn)),Ln.push($n,Dn,Dt,sn,yn,Pn),Bn.push($n,Dn),An===In-1&&Bn.push(yn,Pn)}an.push({bezier:Ht(gn=hn,Lt,ls).call(gn,Ln,qt,this.rotation),points:Ht(mn=hn,Lt,ls).call(mn,Bn,qt,this.rotation)})}return an},cs=function(){let At=1/0,Ft=-1/0,Vt=1/0,qt=-1/0;for(const an of this.paths)for(const[fn,un,zt,gn]of an){const mn=o.Util.bezierBoundingBox(...fn,...un,...zt,...gn);At=Math.min(At,mn[0]),Vt=Math.min(Vt,mn[1]),Ft=Math.max(Ft,mn[2]),qt=Math.max(qt,mn[3])}return[At,Vt,Ft,qt]},kr=function(){return ct(this,rt)?Math.ceil(this.thickness*this.parentScale):0},or=function(At=!1){if(this.isEmpty())return;if(!ct(this,rt)){Ht(this,ut,er).call(this);return}const Ft=Ht(this,ut,cs).call(this),Vt=Ht(this,ut,kr).call(this);Qt(this,j,Math.max(c.AnnotationEditor.MIN_SIZE,Ft[2]-Ft[0])),Qt(this,b,Math.max(c.AnnotationEditor.MIN_SIZE,Ft[3]-Ft[1]));const qt=Math.ceil(Vt+ct(this,j)*this.scaleFactor),an=Math.ceil(Vt+ct(this,b)*this.scaleFactor),[fn,un]=this.parentDimensions;this.width=qt/fn,this.height=an/un,this.setAspectRatio(qt,an);const zt=this.translationX,gn=this.translationY;this.translationX=-Ft[0],this.translationY=-Ft[1],Ht(this,ut,ar).call(this),Ht(this,ut,er).call(this),Qt(this,dt,qt),Qt(this,ot,an),this.setDims(qt,an);const mn=At?Vt/this.scaleFactor/2:0;this.translate(zt-this.translationX-mn,gn-this.translationY-mn)},Yt(hn,Lt),Sn(hn,"_defaultColor",null),Sn(hn,"_defaultOpacity",1),Sn(hn,"_defaultThickness",1),Sn(hn,"_type","ink");let _=hn;e.InkEditor=_},(s,e,a)=>{var _,b,j,$,_e,tt,et,st,rt,nt,it,mr,gr,Rr,us,Gs,qs,ds,Pr,Xs;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var o=a(1),c=a(4),d=a(6),h=a(29);const Et=class Et extends c.AnnotationEditor{constructor(St){super({...St,name:"stampEditor"});Yt(this,it);Yt(this,_,null);Yt(this,b,null);Yt(this,j,null);Yt(this,$,null);Yt(this,_e,null);Yt(this,tt,null);Yt(this,et,null);Yt(this,st,null);Yt(this,rt,!1);Yt(this,nt,!1);Qt(this,$,St.bitmapUrl),Qt(this,_e,St.bitmapFile)}static initialize(St){c.AnnotationEditor.initialize(St)}static get supportedTypes(){const St=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,o.shadow)(this,"supportedTypes",St.map(Ot=>`image/${Ot}`))}static get supportedTypesStr(){return(0,o.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(St){return this.supportedTypes.includes(St)}static paste(St,Ot){Ot.pasteEditor(o.AnnotationEditorType.STAMP,{bitmapFile:St.getAsFile()})}remove(){var St,Ot;ct(this,b)&&(Qt(this,_,null),this._uiManager.imageManager.deleteId(ct(this,b)),(St=ct(this,tt))==null||St.remove(),Qt(this,tt,null),(Ot=ct(this,et))==null||Ot.disconnect(),Qt(this,et,null)),super.remove()}rebuild(){if(!this.parent){ct(this,b)&&Ht(this,it,Rr).call(this);return}super.rebuild(),this.div!==null&&(ct(this,b)&&Ht(this,it,Rr).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(ct(this,j)||ct(this,_)||ct(this,$)||ct(this,_e))}get isResizable(){return!0}render(){if(this.div)return this.div;let St,Ot;if(this.width&&(St=this.x,Ot=this.y),super.render(),this.div.hidden=!0,ct(this,_)?Ht(this,it,us).call(this):Ht(this,it,Rr).call(this),this.width){const[Ct,Rt]=this.parentDimensions;this.setAt(St*Ct,Ot*Rt,this.width*Ct,this.height*Rt)}return this.div}static deserialize(St,Ot,Ct){if(St instanceof h.StampAnnotationElement)return null;const Rt=super.deserialize(St,Ot,Ct),{rect:bt,bitmapUrl:Tt,bitmapId:$t,isSvg:xt,accessibilityData:ft}=St;$t&&Ct.imageManager.isValidId($t)?Qt(Rt,b,$t):Qt(Rt,$,Tt),Qt(Rt,rt,xt);const[yt,vt]=Rt.pageDimensions;return Rt.width=(bt[2]-bt[0])/yt,Rt.height=(bt[3]-bt[1])/vt,ft&&(Rt.altTextData=ft),Rt}serialize(St=!1,Ot=null){if(this.isEmpty())return null;const Ct={annotationType:o.AnnotationEditorType.STAMP,bitmapId:ct(this,b),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:ct(this,rt),structTreeParentId:this._structTreeParentId};if(St)return Ct.bitmapUrl=Ht(this,it,Pr).call(this,!0),Ct.accessibilityData=this.altTextData,Ct;const{decorative:Rt,altText:bt}=this.altTextData;if(!Rt&&bt&&(Ct.accessibilityData={type:"Figure",alt:bt}),Ot===null)return Ct;Ot.stamps||(Ot.stamps=new Map);const Tt=ct(this,rt)?(Ct.rect[2]-Ct.rect[0])*(Ct.rect[3]-Ct.rect[1]):null;if(!Ot.stamps.has(ct(this,b)))Ot.stamps.set(ct(this,b),{area:Tt,serialized:Ct}),Ct.bitmap=Ht(this,it,Pr).call(this,!1);else if(ct(this,rt)){const $t=Ot.stamps.get(ct(this,b));Tt>$t.area&&($t.area=Tt,$t.serialized.bitmap.close(),$t.serialized.bitmap=Ht(this,it,Pr).call(this,!1))}return Ct}};_=new WeakMap,b=new WeakMap,j=new WeakMap,$=new WeakMap,_e=new WeakMap,tt=new WeakMap,et=new WeakMap,st=new WeakMap,rt=new WeakMap,nt=new WeakMap,it=new WeakSet,mr=function(St,Ot=!1){if(!St){this.remove();return}Qt(this,_,St.bitmap),Ot||(Qt(this,b,St.id),Qt(this,rt,St.isSvg)),Ht(this,it,us).call(this)},gr=function(){Qt(this,j,null),this._uiManager.enableWaiting(!1),ct(this,tt)&&this.div.focus()},Rr=function(){if(ct(this,b)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(ct(this,b)).then(Ot=>Ht(this,it,mr).call(this,Ot,!0)).finally(()=>Ht(this,it,gr).call(this));return}if(ct(this,$)){const Ot=ct(this,$);Qt(this,$,null),this._uiManager.enableWaiting(!0),Qt(this,j,this._uiManager.imageManager.getFromUrl(Ot).then(Ct=>Ht(this,it,mr).call(this,Ct)).finally(()=>Ht(this,it,gr).call(this)));return}if(ct(this,_e)){const Ot=ct(this,_e);Qt(this,_e,null),this._uiManager.enableWaiting(!0),Qt(this,j,this._uiManager.imageManager.getFromFile(Ot).then(Ct=>Ht(this,it,mr).call(this,Ct)).finally(()=>Ht(this,it,gr).call(this)));return}const St=document.createElement("input");St.type="file",St.accept=Et.supportedTypesStr,Qt(this,j,new Promise(Ot=>{St.addEventListener("change",async()=>{if(!St.files||St.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const Ct=await this._uiManager.imageManager.getFromFile(St.files[0]);Ht(this,it,mr).call(this,Ct)}Ot()}),St.addEventListener("cancel",()=>{this.remove(),Ot()})}).finally(()=>Ht(this,it,gr).call(this))),St.click()},us=function(){const{div:St}=this;let{width:Ot,height:Ct}=ct(this,_);const[Rt,bt]=this.pageDimensions,Tt=.75;if(this.width)Ot=this.width*Rt,Ct=this.height*bt;else if(Ot>Tt*Rt||Ct>Tt*bt){const yt=Math.min(Tt*Rt/Ot,Tt*bt/Ct);Ot*=yt,Ct*=yt}const[$t,xt]=this.parentDimensions;this.setDims(Ot*$t/Rt,Ct*xt/bt),this._uiManager.enableWaiting(!1);const ft=Qt(this,tt,document.createElement("canvas"));St.append(ft),St.hidden=!1,Ht(this,it,ds).call(this,Ot,Ct),Ht(this,it,Xs).call(this),ct(this,nt)||(this.parent.addUndoableEditor(this),Qt(this,nt,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},Gs=function(St,Ot){var Tt;const[Ct,Rt]=this.parentDimensions;this.width=St/Ct,this.height=Ot/Rt,this.setDims(St,Ot),(Tt=this._initialOptions)!=null&&Tt.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,ct(this,st)!==null&&clearTimeout(ct(this,st)),Qt(this,st,setTimeout(()=>{Qt(this,st,null),Ht(this,it,ds).call(this,St,Ot)},200))},qs=function(St,Ot){const{width:Ct,height:Rt}=ct(this,_);let bt=Ct,Tt=Rt,$t=ct(this,_);for(;bt>2*St||Tt>2*Ot;){const xt=bt,ft=Tt;bt>2*St&&(bt=bt>=16384?Math.floor(bt/2)-1:Math.ceil(bt/2)),Tt>2*Ot&&(Tt=Tt>=16384?Math.floor(Tt/2)-1:Math.ceil(Tt/2));const yt=new OffscreenCanvas(bt,Tt);yt.getContext("2d").drawImage($t,0,0,xt,ft,0,0,bt,Tt),$t=yt.transferToImageBitmap()}return $t},ds=function(St,Ot){St=Math.ceil(St),Ot=Math.ceil(Ot);const Ct=ct(this,tt);if(!Ct||Ct.width===St&&Ct.height===Ot)return;Ct.width=St,Ct.height=Ot;const Rt=ct(this,rt)?ct(this,_):Ht(this,it,qs).call(this,St,Ot),bt=Ct.getContext("2d");bt.filter=this._uiManager.hcmFilter,bt.drawImage(Rt,0,0,Rt.width,Rt.height,0,0,St,Ot)},Pr=function(St){if(St){if(ct(this,rt)){const Rt=this._uiManager.imageManager.getSvgUrl(ct(this,b));if(Rt)return Rt}const Ot=document.createElement("canvas");return{width:Ot.width,height:Ot.height}=ct(this,_),Ot.getContext("2d").drawImage(ct(this,_),0,0),Ot.toDataURL()}if(ct(this,rt)){const[Ot,Ct]=this.pageDimensions,Rt=Math.round(this.width*Ot*d.PixelsPerInch.PDF_TO_CSS_UNITS),bt=Math.round(this.height*Ct*d.PixelsPerInch.PDF_TO_CSS_UNITS),Tt=new OffscreenCanvas(Rt,bt);return Tt.getContext("2d").drawImage(ct(this,_),0,0,ct(this,_).width,ct(this,_).height,0,0,Rt,bt),Tt.transferToImageBitmap()}return structuredClone(ct(this,_))},Xs=function(){Qt(this,et,new ResizeObserver(St=>{const Ot=St[0].contentRect;Ot.width&&Ot.height&&Ht(this,it,Gs).call(this,Ot.width,Ot.height)})),ct(this,et).observe(this.div)},Sn(Et,"_type","stamp");let g=Et;e.StampEditor=g}],__webpack_module_cache__={};function __w_pdfjs_require__(s){var e=__webpack_module_cache__[s];if(e!==void 0)return e.exports;var a=__webpack_module_cache__[s]={exports:{}};return __webpack_modules__[s](a,a.exports,__w_pdfjs_require__),a.exports}var __webpack_exports__={};return(()=>{var s=__webpack_exports__;Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(s,"AnnotationEditorLayer",{enumerable:!0,get:function(){return d.AnnotationEditorLayer}}),Object.defineProperty(s,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(s,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(s,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return h.AnnotationEditorUIManager}}),Object.defineProperty(s,"AnnotationLayer",{enumerable:!0,get:function(){return g.AnnotationLayer}}),Object.defineProperty(s,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(s,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(s,"DOMSVGFactory",{enumerable:!0,get:function(){return o.DOMSVGFactory}}),Object.defineProperty(s,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(s,"GlobalWorkerOptions",{enumerable:!0,get:function(){return _.GlobalWorkerOptions}}),Object.defineProperty(s,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(s,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(s,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(s,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(s,"PDFDataRangeTransport",{enumerable:!0,get:function(){return a.PDFDataRangeTransport}}),Object.defineProperty(s,"PDFDateString",{enumerable:!0,get:function(){return o.PDFDateString}}),Object.defineProperty(s,"PDFWorker",{enumerable:!0,get:function(){return a.PDFWorker}}),Object.defineProperty(s,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(s,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(s,"PixelsPerInch",{enumerable:!0,get:function(){return o.PixelsPerInch}}),Object.defineProperty(s,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(s,"RenderingCancelledException",{enumerable:!0,get:function(){return o.RenderingCancelledException}}),Object.defineProperty(s,"SVGGraphics",{enumerable:!0,get:function(){return a.SVGGraphics}}),Object.defineProperty(s,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(s,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(s,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(s,"XfaLayer",{enumerable:!0,get:function(){return b.XfaLayer}}),Object.defineProperty(s,"build",{enumerable:!0,get:function(){return a.build}}),Object.defineProperty(s,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(s,"getDocument",{enumerable:!0,get:function(){return a.getDocument}}),Object.defineProperty(s,"getFilenameFromUrl",{enumerable:!0,get:function(){return o.getFilenameFromUrl}}),Object.defineProperty(s,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return o.getPdfFilenameFromUrl}}),Object.defineProperty(s,"getXfaPageViewport",{enumerable:!0,get:function(){return o.getXfaPageViewport}}),Object.defineProperty(s,"isDataScheme",{enumerable:!0,get:function(){return o.isDataScheme}}),Object.defineProperty(s,"isPdfFile",{enumerable:!0,get:function(){return o.isPdfFile}}),Object.defineProperty(s,"loadScript",{enumerable:!0,get:function(){return o.loadScript}}),Object.defineProperty(s,"noContextMenu",{enumerable:!0,get:function(){return o.noContextMenu}}),Object.defineProperty(s,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(s,"renderTextLayer",{enumerable:!0,get:function(){return c.renderTextLayer}}),Object.defineProperty(s,"setLayerDimensions",{enumerable:!0,get:function(){return o.setLayerDimensions}}),Object.defineProperty(s,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(s,"updateTextLayer",{enumerable:!0,get:function(){return c.updateTextLayer}}),Object.defineProperty(s,"version",{enumerable:!0,get:function(){return a.version}});var e=__w_pdfjs_require__(1),a=__w_pdfjs_require__(2),o=__w_pdfjs_require__(6),c=__w_pdfjs_require__(26),d=__w_pdfjs_require__(27),h=__w_pdfjs_require__(5),g=__w_pdfjs_require__(29),_=__w_pdfjs_require__(14),b=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function round(s){return s+.5|0}const lim=(s,e,a)=>Math.max(Math.min(s,a),e);function p2b(s){return lim(round(s*2.55),0,255)}function n2b(s){return lim(round(s*255),0,255)}function b2n(s){return lim(round(s/2.55)/100,0,1)}function n2p(s){return lim(round(s*100),0,100)}const map$1={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},hex=[..."0123456789ABCDEF"],h1=s=>hex[s&15],h2=s=>hex[(s&240)>>4]+hex[s&15],eq=s=>(s&240)>>4===(s&15),isShort=s=>eq(s.r)&&eq(s.g)&&eq(s.b)&&eq(s.a);function hexParse(s){var e=s.length,a;return s[0]==="#"&&(e===4||e===5?a={r:255&map$1[s[1]]*17,g:255&map$1[s[2]]*17,b:255&map$1[s[3]]*17,a:e===5?map$1[s[4]]*17:255}:(e===7||e===9)&&(a={r:map$1[s[1]]<<4|map$1[s[2]],g:map$1[s[3]]<<4|map$1[s[4]],b:map$1[s[5]]<<4|map$1[s[6]],a:e===9?map$1[s[7]]<<4|map$1[s[8]]:255})),a}const alpha=(s,e)=>s<255?e(s):"";function hexString(s){var e=isShort(s)?h1:h2;return s?"#"+e(s.r)+e(s.g)+e(s.b)+alpha(s.a,e):void 0}const HUE_RE=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function hsl2rgbn(s,e,a){const o=e*Math.min(a,1-a),c=(d,h=(d+s/30)%12)=>a-o*Math.max(Math.min(h-3,9-h,1),-1);return[c(0),c(8),c(4)]}function hsv2rgbn(s,e,a){const o=(c,d=(c+s/60)%6)=>a-a*e*Math.max(Math.min(d,4-d,1),0);return[o(5),o(3),o(1)]}function hwb2rgbn(s,e,a){const o=hsl2rgbn(s,1,.5);let c;for(e+a>1&&(c=1/(e+a),e*=c,a*=c),c=0;c<3;c++)o[c]*=1-e-a,o[c]+=e;return o}function hueValue(s,e,a,o,c){return s===c?(e-a)/o+(e<a?6:0):e===c?(a-s)/o+2:(s-e)/o+4}function rgb2hsl(s){const a=s.r/255,o=s.g/255,c=s.b/255,d=Math.max(a,o,c),h=Math.min(a,o,c),g=(d+h)/2;let _,b,j;return d!==h&&(j=d-h,b=g>.5?j/(2-d-h):j/(d+h),_=hueValue(a,o,c,j,d),_=_*60+.5),[_|0,b||0,g]}function calln(s,e,a,o){return(Array.isArray(e)?s(e[0],e[1],e[2]):s(e,a,o)).map(n2b)}function hsl2rgb(s,e,a){return calln(hsl2rgbn,s,e,a)}function hwb2rgb(s,e,a){return calln(hwb2rgbn,s,e,a)}function hsv2rgb(s,e,a){return calln(hsv2rgbn,s,e,a)}function hue(s){return(s%360+360)%360}function hueParse(s){const e=HUE_RE.exec(s);let a=255,o;if(!e)return;e[5]!==o&&(a=e[6]?p2b(+e[5]):n2b(+e[5]));const c=hue(+e[2]),d=+e[3]/100,h=+e[4]/100;return e[1]==="hwb"?o=hwb2rgb(c,d,h):e[1]==="hsv"?o=hsv2rgb(c,d,h):o=hsl2rgb(c,d,h),{r:o[0],g:o[1],b:o[2],a}}function rotate(s,e){var a=rgb2hsl(s);a[0]=hue(a[0]+e),a=hsl2rgb(a),s.r=a[0],s.g=a[1],s.b=a[2]}function hslString(s){if(!s)return;const e=rgb2hsl(s),a=e[0],o=n2p(e[1]),c=n2p(e[2]);return s.a<255?`hsla(${a}, ${o}%, ${c}%, ${b2n(s.a)})`:`hsl(${a}, ${o}%, ${c}%)`}const map={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},names$1={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function unpack(){const s={},e=Object.keys(names$1),a=Object.keys(map);let o,c,d,h,g;for(o=0;o<e.length;o++){for(h=g=e[o],c=0;c<a.length;c++)d=a[c],g=g.replace(d,map[d]);d=parseInt(names$1[h],16),s[g]=[d>>16&255,d>>8&255,d&255]}return s}let names;function nameParse(s){names||(names=unpack(),names.transparent=[0,0,0,0]);const e=names[s.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const RGB_RE=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function rgbParse(s){const e=RGB_RE.exec(s);let a=255,o,c,d;if(e){if(e[7]!==o){const h=+e[7];a=e[8]?p2b(h):lim(h*255,0,255)}return o=+e[1],c=+e[3],d=+e[5],o=255&(e[2]?p2b(o):lim(o,0,255)),c=255&(e[4]?p2b(c):lim(c,0,255)),d=255&(e[6]?p2b(d):lim(d,0,255)),{r:o,g:c,b:d,a}}}function rgbString(s){return s&&(s.a<255?`rgba(${s.r}, ${s.g}, ${s.b}, ${b2n(s.a)})`:`rgb(${s.r}, ${s.g}, ${s.b})`)}const to=s=>s<=.0031308?s*12.92:Math.pow(s,1/2.4)*1.055-.055,from=s=>s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4);function interpolate$1(s,e,a){const o=from(b2n(s.r)),c=from(b2n(s.g)),d=from(b2n(s.b));return{r:n2b(to(o+a*(from(b2n(e.r))-o))),g:n2b(to(c+a*(from(b2n(e.g))-c))),b:n2b(to(d+a*(from(b2n(e.b))-d))),a:s.a+a*(e.a-s.a)}}function modHSL(s,e,a){if(s){let o=rgb2hsl(s);o[e]=Math.max(0,Math.min(o[e]+o[e]*a,e===0?360:1)),o=hsl2rgb(o),s.r=o[0],s.g=o[1],s.b=o[2]}}function clone$2(s,e){return s&&Object.assign(e||{},s)}function fromObject(s){var e={r:0,g:0,b:0,a:255};return Array.isArray(s)?s.length>=3&&(e={r:s[0],g:s[1],b:s[2],a:255},s.length>3&&(e.a=n2b(s[3]))):(e=clone$2(s,{r:0,g:0,b:0,a:1}),e.a=n2b(e.a)),e}function functionParse(s){return s.charAt(0)==="r"?rgbParse(s):hueParse(s)}class Color{constructor(e){if(e instanceof Color)return e;const a=typeof e;let o;a==="object"?o=fromObject(e):a==="string"&&(o=hexParse(e)||nameParse(e)||functionParse(e)),this._rgb=o,this._valid=!!o}get valid(){return this._valid}get rgb(){var e=clone$2(this._rgb);return e&&(e.a=b2n(e.a)),e}set rgb(e){this._rgb=fromObject(e)}rgbString(){return this._valid?rgbString(this._rgb):void 0}hexString(){return this._valid?hexString(this._rgb):void 0}hslString(){return this._valid?hslString(this._rgb):void 0}mix(e,a){if(e){const o=this.rgb,c=e.rgb;let d;const h=a===d?.5:a,g=2*h-1,_=o.a-c.a,b=((g*_===-1?g:(g+_)/(1+g*_))+1)/2;d=1-b,o.r=255&b*o.r+d*c.r+.5,o.g=255&b*o.g+d*c.g+.5,o.b=255&b*o.b+d*c.b+.5,o.a=h*o.a+(1-h)*c.a,this.rgb=o}return this}interpolate(e,a){return e&&(this._rgb=interpolate$1(this._rgb,e._rgb,a)),this}clone(){return new Color(this.rgb)}alpha(e){return this._rgb.a=n2b(e),this}clearer(e){const a=this._rgb;return a.a*=1-e,this}greyscale(){const e=this._rgb,a=round(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=a,this}opaquer(e){const a=this._rgb;return a.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return modHSL(this._rgb,2,e),this}darken(e){return modHSL(this._rgb,2,-e),this}saturate(e){return modHSL(this._rgb,1,e),this}desaturate(e){return modHSL(this._rgb,1,-e),this}rotate(e){return rotate(this._rgb,e),this}}/*!
 * Chart.js v4.4.7
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */function noop(){}const uid=(()=>{let s=0;return()=>s++})();function isNullOrUndef(s){return s==null}function isArray(s){if(Array.isArray&&Array.isArray(s))return!0;const e=Object.prototype.toString.call(s);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function isObject(s){return s!==null&&Object.prototype.toString.call(s)==="[object Object]"}function isNumberFinite(s){return(typeof s=="number"||s instanceof Number)&&isFinite(+s)}function finiteOrDefault(s,e){return isNumberFinite(s)?s:e}function valueOrDefault(s,e){return typeof s>"u"?e:s}const toPercentage=(s,e)=>typeof s=="string"&&s.endsWith("%")?parseFloat(s)/100:+s/e,toDimension=(s,e)=>typeof s=="string"&&s.endsWith("%")?parseFloat(s)/100*e:+s;function callback(s,e,a){if(s&&typeof s.call=="function")return s.apply(a,e)}function each(s,e,a,o){let c,d,h;if(isArray(s))for(d=s.length,c=0;c<d;c++)e.call(a,s[c],c);else if(isObject(s))for(h=Object.keys(s),d=h.length,c=0;c<d;c++)e.call(a,s[h[c]],h[c])}function _elementsEqual(s,e){let a,o,c,d;if(!s||!e||s.length!==e.length)return!1;for(a=0,o=s.length;a<o;++a)if(c=s[a],d=e[a],c.datasetIndex!==d.datasetIndex||c.index!==d.index)return!1;return!0}function clone$1(s){if(isArray(s))return s.map(clone$1);if(isObject(s)){const e=Object.create(null),a=Object.keys(s),o=a.length;let c=0;for(;c<o;++c)e[a[c]]=clone$1(s[a[c]]);return e}return s}function isValidKey(s){return["__proto__","prototype","constructor"].indexOf(s)===-1}function _merger(s,e,a,o){if(!isValidKey(s))return;const c=e[s],d=a[s];isObject(c)&&isObject(d)?merge(c,d,o):e[s]=clone$1(d)}function merge(s,e,a){const o=isArray(e)?e:[e],c=o.length;if(!isObject(s))return s;a=a||{};const d=a.merger||_merger;let h;for(let g=0;g<c;++g){if(h=o[g],!isObject(h))continue;const _=Object.keys(h);for(let b=0,j=_.length;b<j;++b)d(_[b],s,h,a)}return s}function mergeIf(s,e){return merge(s,e,{merger:_mergerIf})}function _mergerIf(s,e,a){if(!isValidKey(s))return;const o=e[s],c=a[s];isObject(o)&&isObject(c)?mergeIf(o,c):Object.prototype.hasOwnProperty.call(e,s)||(e[s]=clone$1(c))}const keyResolvers={"":s=>s,x:s=>s.x,y:s=>s.y};function _splitKey(s){const e=s.split("."),a=[];let o="";for(const c of e)o+=c,o.endsWith("\\")?o=o.slice(0,-1)+".":(a.push(o),o="");return a}function _getKeyResolver(s){const e=_splitKey(s);return a=>{for(const o of e){if(o==="")break;a=a&&a[o]}return a}}function resolveObjectKey(s,e){return(keyResolvers[e]||(keyResolvers[e]=_getKeyResolver(e)))(s)}function _capitalize(s){return s.charAt(0).toUpperCase()+s.slice(1)}const defined=s=>typeof s<"u",isFunction=s=>typeof s=="function",setsEqual=(s,e)=>{if(s.size!==e.size)return!1;for(const a of s)if(!e.has(a))return!1;return!0};function _isClickEvent(s){return s.type==="mouseup"||s.type==="click"||s.type==="contextmenu"}const PI=Math.PI,TAU=2*PI,INFINITY=Number.POSITIVE_INFINITY,RAD_PER_DEG=PI/180,HALF_PI=PI/2,QUARTER_PI=PI/4,TWO_THIRDS_PI=PI*2/3,log10=Math.log10,sign=Math.sign;function almostEquals(s,e,a){return Math.abs(s-e)<a}function niceNum(s){const e=Math.round(s);s=almostEquals(s,e,s/1e3)?e:s;const a=Math.pow(10,Math.floor(log10(s))),o=s/a;return(o<=1?1:o<=2?2:o<=5?5:10)*a}function _factorize(s){const e=[],a=Math.sqrt(s);let o;for(o=1;o<a;o++)s%o===0&&(e.push(o),e.push(s/o));return a===(a|0)&&e.push(a),e.sort((c,d)=>c-d).pop(),e}function isNumber(s){return!isNaN(parseFloat(s))&&isFinite(s)}function almostWhole(s,e){const a=Math.round(s);return a-e<=s&&a+e>=s}function _setMinAndMaxByKey(s,e,a){let o,c,d;for(o=0,c=s.length;o<c;o++)d=s[o][a],isNaN(d)||(e.min=Math.min(e.min,d),e.max=Math.max(e.max,d))}function toRadians(s){return s*(PI/180)}function toDegrees(s){return s*(180/PI)}function _decimalPlaces(s){if(!isNumberFinite(s))return;let e=1,a=0;for(;Math.round(s*e)/e!==s;)e*=10,a++;return a}function getAngleFromPoint(s,e){const a=e.x-s.x,o=e.y-s.y,c=Math.sqrt(a*a+o*o);let d=Math.atan2(o,a);return d<-.5*PI&&(d+=TAU),{angle:d,distance:c}}function distanceBetweenPoints(s,e){return Math.sqrt(Math.pow(e.x-s.x,2)+Math.pow(e.y-s.y,2))}function _normalizeAngle(s){return(s%TAU+TAU)%TAU}function _angleBetween(s,e,a,o){const c=_normalizeAngle(s),d=_normalizeAngle(e),h=_normalizeAngle(a),g=_normalizeAngle(d-c),_=_normalizeAngle(h-c),b=_normalizeAngle(c-d),j=_normalizeAngle(c-h);return c===d||c===h||o&&d===h||g>_&&b<j}function _limitValue(s,e,a){return Math.max(e,Math.min(a,s))}function _int16Range(s){return _limitValue(s,-32768,32767)}function _isBetween(s,e,a,o=1e-6){return s>=Math.min(e,a)-o&&s<=Math.max(e,a)+o}function _lookup(s,e,a){a=a||(h=>s[h]<e);let o=s.length-1,c=0,d;for(;o-c>1;)d=c+o>>1,a(d)?c=d:o=d;return{lo:c,hi:o}}const _lookupByKey=(s,e,a,o)=>_lookup(s,a,o?c=>{const d=s[c][e];return d<a||d===a&&s[c+1][e]===a}:c=>s[c][e]<a),_rlookupByKey=(s,e,a)=>_lookup(s,a,o=>s[o][e]>=a);function _filterBetween(s,e,a){let o=0,c=s.length;for(;o<c&&s[o]<e;)o++;for(;c>o&&s[c-1]>a;)c--;return o>0||c<s.length?s.slice(o,c):s}const arrayEvents=["push","pop","shift","splice","unshift"];function listenArrayEvents(s,e){if(s._chartjs){s._chartjs.listeners.push(e);return}Object.defineProperty(s,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),arrayEvents.forEach(a=>{const o="_onData"+_capitalize(a),c=s[a];Object.defineProperty(s,a,{configurable:!0,enumerable:!1,value(...d){const h=c.apply(this,d);return s._chartjs.listeners.forEach(g=>{typeof g[o]=="function"&&g[o](...d)}),h}})})}function unlistenArrayEvents(s,e){const a=s._chartjs;if(!a)return;const o=a.listeners,c=o.indexOf(e);c!==-1&&o.splice(c,1),!(o.length>0)&&(arrayEvents.forEach(d=>{delete s[d]}),delete s._chartjs)}function _arrayUnique(s){const e=new Set(s);return e.size===s.length?s:Array.from(e)}const requestAnimFrame=function(){return typeof window>"u"?function(s){return s()}:window.requestAnimationFrame}();function throttled(s,e){let a=[],o=!1;return function(...c){a=c,o||(o=!0,requestAnimFrame.call(window,()=>{o=!1,s.apply(e,a)}))}}function debounce(s,e){let a;return function(...o){return e?(clearTimeout(a),a=setTimeout(s,e,o)):s.apply(this,o),e}}const _toLeftRightCenter=s=>s==="start"?"left":s==="end"?"right":"center",_alignStartEnd=(s,e,a)=>s==="start"?e:s==="end"?a:(e+a)/2,_textX=(s,e,a,o)=>s===(o?"left":"right")?a:s==="center"?(e+a)/2:e,atEdge=s=>s===0||s===1,elasticIn=(s,e,a)=>-(Math.pow(2,10*(s-=1))*Math.sin((s-e)*TAU/a)),elasticOut=(s,e,a)=>Math.pow(2,-10*s)*Math.sin((s-e)*TAU/a)+1,effects={linear:s=>s,easeInQuad:s=>s*s,easeOutQuad:s=>-s*(s-2),easeInOutQuad:s=>(s/=.5)<1?.5*s*s:-.5*(--s*(s-2)-1),easeInCubic:s=>s*s*s,easeOutCubic:s=>(s-=1)*s*s+1,easeInOutCubic:s=>(s/=.5)<1?.5*s*s*s:.5*((s-=2)*s*s+2),easeInQuart:s=>s*s*s*s,easeOutQuart:s=>-((s-=1)*s*s*s-1),easeInOutQuart:s=>(s/=.5)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2),easeInQuint:s=>s*s*s*s*s,easeOutQuint:s=>(s-=1)*s*s*s*s+1,easeInOutQuint:s=>(s/=.5)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2),easeInSine:s=>-Math.cos(s*HALF_PI)+1,easeOutSine:s=>Math.sin(s*HALF_PI),easeInOutSine:s=>-.5*(Math.cos(PI*s)-1),easeInExpo:s=>s===0?0:Math.pow(2,10*(s-1)),easeOutExpo:s=>s===1?1:-Math.pow(2,-10*s)+1,easeInOutExpo:s=>atEdge(s)?s:s<.5?.5*Math.pow(2,10*(s*2-1)):.5*(-Math.pow(2,-10*(s*2-1))+2),easeInCirc:s=>s>=1?s:-(Math.sqrt(1-s*s)-1),easeOutCirc:s=>Math.sqrt(1-(s-=1)*s),easeInOutCirc:s=>(s/=.5)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1),easeInElastic:s=>atEdge(s)?s:elasticIn(s,.075,.3),easeOutElastic:s=>atEdge(s)?s:elasticOut(s,.075,.3),easeInOutElastic(s){return atEdge(s)?s:s<.5?.5*elasticIn(s*2,.1125,.45):.5+.5*elasticOut(s*2-1,.1125,.45)},easeInBack(s){return s*s*((1.70158+1)*s-1.70158)},easeOutBack(s){return(s-=1)*s*((1.70158+1)*s+1.70158)+1},easeInOutBack(s){let e=1.70158;return(s/=.5)<1?.5*(s*s*(((e*=1.525)+1)*s-e)):.5*((s-=2)*s*(((e*=1.525)+1)*s+e)+2)},easeInBounce:s=>1-effects.easeOutBounce(1-s),easeOutBounce(s){return s<1/2.75?7.5625*s*s:s<2/2.75?7.5625*(s-=1.5/2.75)*s+.75:s<2.5/2.75?7.5625*(s-=2.25/2.75)*s+.9375:7.5625*(s-=2.625/2.75)*s+.984375},easeInOutBounce:s=>s<.5?effects.easeInBounce(s*2)*.5:effects.easeOutBounce(s*2-1)*.5+.5};function isPatternOrGradient(s){if(s&&typeof s=="object"){const e=s.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function color(s){return isPatternOrGradient(s)?s:new Color(s)}function getHoverColor(s){return isPatternOrGradient(s)?s:new Color(s).saturate(.5).darken(.1).hexString()}const numbers=["x","y","borderWidth","radius","tension"],colors=["color","borderColor","backgroundColor"];function applyAnimationsDefaults(s){s.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),s.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),s.set("animations",{colors:{type:"color",properties:colors},numbers:{type:"number",properties:numbers}}),s.describe("animations",{_fallback:"animation"}),s.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function applyLayoutsDefaults(s){s.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const intlCache=new Map;function getNumberFormat(s,e){e=e||{};const a=s+JSON.stringify(e);let o=intlCache.get(a);return o||(o=new Intl.NumberFormat(s,e),intlCache.set(a,o)),o}function formatNumber(s,e,a){return getNumberFormat(e,a).format(s)}const formatters={values(s){return isArray(s)?s:""+s},numeric(s,e,a){if(s===0)return"0";const o=this.chart.options.locale;let c,d=s;if(a.length>1){const b=Math.max(Math.abs(a[0].value),Math.abs(a[a.length-1].value));(b<1e-4||b>1e15)&&(c="scientific"),d=calculateDelta(s,a)}const h=log10(Math.abs(d)),g=isNaN(h)?1:Math.max(Math.min(-1*Math.floor(h),20),0),_={notation:c,minimumFractionDigits:g,maximumFractionDigits:g};return Object.assign(_,this.options.ticks.format),formatNumber(s,o,_)}};function calculateDelta(s,e){let a=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(a)>=1&&s!==Math.floor(s)&&(a=s-Math.floor(s)),a}var Ticks={formatters};function applyScaleDefaults(s){s.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,a)=>a.lineWidth,tickColor:(e,a)=>a.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Ticks.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),s.route("scale.ticks","color","","color"),s.route("scale.grid","color","","borderColor"),s.route("scale.border","color","","borderColor"),s.route("scale.title","color","","color"),s.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),s.describe("scales",{_fallback:"scale"}),s.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const overrides=Object.create(null),descriptors=Object.create(null);function getScope$1(s,e){if(!e)return s;const a=e.split(".");for(let o=0,c=a.length;o<c;++o){const d=a[o];s=s[d]||(s[d]=Object.create(null))}return s}function set(s,e,a){return typeof e=="string"?merge(getScope$1(s,e),a):merge(getScope$1(s,""),e)}class Defaults{constructor(e,a){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=o=>o.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(o,c)=>getHoverColor(c.backgroundColor),this.hoverBorderColor=(o,c)=>getHoverColor(c.borderColor),this.hoverColor=(o,c)=>getHoverColor(c.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(a)}set(e,a){return set(this,e,a)}get(e){return getScope$1(this,e)}describe(e,a){return set(descriptors,e,a)}override(e,a){return set(overrides,e,a)}route(e,a,o,c){const d=getScope$1(this,e),h=getScope$1(this,o),g="_"+a;Object.defineProperties(d,{[g]:{value:d[a],writable:!0},[a]:{enumerable:!0,get(){const _=this[g],b=h[c];return isObject(_)?Object.assign({},b,_):valueOrDefault(_,b)},set(_){this[g]=_}}})}apply(e){e.forEach(a=>a(this))}}var defaults=new Defaults({_scriptable:s=>!s.startsWith("on"),_indexable:s=>s!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[applyAnimationsDefaults,applyLayoutsDefaults,applyScaleDefaults]);function toFontString(s){return!s||isNullOrUndef(s.size)||isNullOrUndef(s.family)?null:(s.style?s.style+" ":"")+(s.weight?s.weight+" ":"")+s.size+"px "+s.family}function _measureText(s,e,a,o,c){let d=e[c];return d||(d=e[c]=s.measureText(c).width,a.push(c)),d>o&&(o=d),o}function _alignPixel(s,e,a){const o=s.currentDevicePixelRatio,c=a!==0?Math.max(a/2,.5):0;return Math.round((e-c)*o)/o+c}function clearCanvas(s,e){!e&&!s||(e=e||s.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,s.width,s.height),e.restore())}function drawPoint(s,e,a,o){drawPointLegend(s,e,a,o,null)}function drawPointLegend(s,e,a,o,c){let d,h,g,_,b,j,$,_e;const tt=e.pointStyle,et=e.rotation,st=e.radius;let rt=(et||0)*RAD_PER_DEG;if(tt&&typeof tt=="object"&&(d=tt.toString(),d==="[object HTMLImageElement]"||d==="[object HTMLCanvasElement]")){s.save(),s.translate(a,o),s.rotate(rt),s.drawImage(tt,-tt.width/2,-tt.height/2,tt.width,tt.height),s.restore();return}if(!(isNaN(st)||st<=0)){switch(s.beginPath(),tt){default:c?s.ellipse(a,o,c/2,st,0,0,TAU):s.arc(a,o,st,0,TAU),s.closePath();break;case"triangle":j=c?c/2:st,s.moveTo(a+Math.sin(rt)*j,o-Math.cos(rt)*st),rt+=TWO_THIRDS_PI,s.lineTo(a+Math.sin(rt)*j,o-Math.cos(rt)*st),rt+=TWO_THIRDS_PI,s.lineTo(a+Math.sin(rt)*j,o-Math.cos(rt)*st),s.closePath();break;case"rectRounded":b=st*.516,_=st-b,h=Math.cos(rt+QUARTER_PI)*_,$=Math.cos(rt+QUARTER_PI)*(c?c/2-b:_),g=Math.sin(rt+QUARTER_PI)*_,_e=Math.sin(rt+QUARTER_PI)*(c?c/2-b:_),s.arc(a-$,o-g,b,rt-PI,rt-HALF_PI),s.arc(a+_e,o-h,b,rt-HALF_PI,rt),s.arc(a+$,o+g,b,rt,rt+HALF_PI),s.arc(a-_e,o+h,b,rt+HALF_PI,rt+PI),s.closePath();break;case"rect":if(!et){_=Math.SQRT1_2*st,j=c?c/2:_,s.rect(a-j,o-_,2*j,2*_);break}rt+=QUARTER_PI;case"rectRot":$=Math.cos(rt)*(c?c/2:st),h=Math.cos(rt)*st,g=Math.sin(rt)*st,_e=Math.sin(rt)*(c?c/2:st),s.moveTo(a-$,o-g),s.lineTo(a+_e,o-h),s.lineTo(a+$,o+g),s.lineTo(a-_e,o+h),s.closePath();break;case"crossRot":rt+=QUARTER_PI;case"cross":$=Math.cos(rt)*(c?c/2:st),h=Math.cos(rt)*st,g=Math.sin(rt)*st,_e=Math.sin(rt)*(c?c/2:st),s.moveTo(a-$,o-g),s.lineTo(a+$,o+g),s.moveTo(a+_e,o-h),s.lineTo(a-_e,o+h);break;case"star":$=Math.cos(rt)*(c?c/2:st),h=Math.cos(rt)*st,g=Math.sin(rt)*st,_e=Math.sin(rt)*(c?c/2:st),s.moveTo(a-$,o-g),s.lineTo(a+$,o+g),s.moveTo(a+_e,o-h),s.lineTo(a-_e,o+h),rt+=QUARTER_PI,$=Math.cos(rt)*(c?c/2:st),h=Math.cos(rt)*st,g=Math.sin(rt)*st,_e=Math.sin(rt)*(c?c/2:st),s.moveTo(a-$,o-g),s.lineTo(a+$,o+g),s.moveTo(a+_e,o-h),s.lineTo(a-_e,o+h);break;case"line":h=c?c/2:Math.cos(rt)*st,g=Math.sin(rt)*st,s.moveTo(a-h,o-g),s.lineTo(a+h,o+g);break;case"dash":s.moveTo(a,o),s.lineTo(a+Math.cos(rt)*(c?c/2:st),o+Math.sin(rt)*st);break;case!1:s.closePath();break}s.fill(),e.borderWidth>0&&s.stroke()}}function _isPointInArea(s,e,a){return a=a||.5,!e||s&&s.x>e.left-a&&s.x<e.right+a&&s.y>e.top-a&&s.y<e.bottom+a}function clipArea(s,e){s.save(),s.beginPath(),s.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),s.clip()}function unclipArea(s){s.restore()}function setRenderOpts(s,e){e.translation&&s.translate(e.translation[0],e.translation[1]),isNullOrUndef(e.rotation)||s.rotate(e.rotation),e.color&&(s.fillStyle=e.color),e.textAlign&&(s.textAlign=e.textAlign),e.textBaseline&&(s.textBaseline=e.textBaseline)}function decorateText(s,e,a,o,c){if(c.strikethrough||c.underline){const d=s.measureText(o),h=e-d.actualBoundingBoxLeft,g=e+d.actualBoundingBoxRight,_=a-d.actualBoundingBoxAscent,b=a+d.actualBoundingBoxDescent,j=c.strikethrough?(_+b)/2:b;s.strokeStyle=s.fillStyle,s.beginPath(),s.lineWidth=c.decorationWidth||2,s.moveTo(h,j),s.lineTo(g,j),s.stroke()}}function drawBackdrop(s,e){const a=s.fillStyle;s.fillStyle=e.color,s.fillRect(e.left,e.top,e.width,e.height),s.fillStyle=a}function renderText(s,e,a,o,c,d={}){const h=isArray(e)?e:[e],g=d.strokeWidth>0&&d.strokeColor!=="";let _,b;for(s.save(),s.font=c.string,setRenderOpts(s,d),_=0;_<h.length;++_)b=h[_],d.backdrop&&drawBackdrop(s,d.backdrop),g&&(d.strokeColor&&(s.strokeStyle=d.strokeColor),isNullOrUndef(d.strokeWidth)||(s.lineWidth=d.strokeWidth),s.strokeText(b,a,o,d.maxWidth)),s.fillText(b,a,o,d.maxWidth),decorateText(s,a,o,b,d),o+=Number(c.lineHeight);s.restore()}function addRoundedRectPath(s,e){const{x:a,y:o,w:c,h:d,radius:h}=e;s.arc(a+h.topLeft,o+h.topLeft,h.topLeft,1.5*PI,PI,!0),s.lineTo(a,o+d-h.bottomLeft),s.arc(a+h.bottomLeft,o+d-h.bottomLeft,h.bottomLeft,PI,HALF_PI,!0),s.lineTo(a+c-h.bottomRight,o+d),s.arc(a+c-h.bottomRight,o+d-h.bottomRight,h.bottomRight,HALF_PI,0,!0),s.lineTo(a+c,o+h.topRight),s.arc(a+c-h.topRight,o+h.topRight,h.topRight,0,-HALF_PI,!0),s.lineTo(a+h.topLeft,o)}const LINE_HEIGHT=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,FONT_STYLE=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function toLineHeight(s,e){const a=(""+s).match(LINE_HEIGHT);if(!a||a[1]==="normal")return e*1.2;switch(s=+a[2],a[3]){case"px":return s;case"%":s/=100;break}return e*s}const numberOrZero=s=>+s||0;function _readValueToProps(s,e){const a={},o=isObject(e),c=o?Object.keys(e):e,d=isObject(s)?o?h=>valueOrDefault(s[h],s[e[h]]):h=>s[h]:()=>s;for(const h of c)a[h]=numberOrZero(d(h));return a}function toTRBL(s){return _readValueToProps(s,{top:"y",right:"x",bottom:"y",left:"x"})}function toTRBLCorners(s){return _readValueToProps(s,["topLeft","topRight","bottomLeft","bottomRight"])}function toPadding(s){const e=toTRBL(s);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function toFont(s,e){s=s||{},e=e||defaults.font;let a=valueOrDefault(s.size,e.size);typeof a=="string"&&(a=parseInt(a,10));let o=valueOrDefault(s.style,e.style);o&&!(""+o).match(FONT_STYLE)&&(console.warn('Invalid font style specified: "'+o+'"'),o=void 0);const c={family:valueOrDefault(s.family,e.family),lineHeight:toLineHeight(valueOrDefault(s.lineHeight,e.lineHeight),a),size:a,style:o,weight:valueOrDefault(s.weight,e.weight),string:""};return c.string=toFontString(c),c}function resolve(s,e,a,o){let c,d,h;for(c=0,d=s.length;c<d;++c)if(h=s[c],h!==void 0&&h!==void 0)return h}function _addGrace(s,e,a){const{min:o,max:c}=s,d=toDimension(e,(c-o)/2),h=(g,_)=>a&&g===0?0:g+_;return{min:h(o,-Math.abs(d)),max:h(c,d)}}function createContext(s,e){return Object.assign(Object.create(s),e)}function _createResolver(s,e=[""],a,o,c=()=>s[0]){const d=a||s;typeof o>"u"&&(o=_resolve("_fallback",s));const h={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:s,_rootScopes:d,_fallback:o,_getTarget:c,override:g=>_createResolver([g,...s],e,d,o)};return new Proxy(h,{deleteProperty(g,_){return delete g[_],delete g._keys,delete s[0][_],!0},get(g,_){return _cached(g,_,()=>_resolveWithPrefixes(_,e,s,g))},getOwnPropertyDescriptor(g,_){return Reflect.getOwnPropertyDescriptor(g._scopes[0],_)},getPrototypeOf(){return Reflect.getPrototypeOf(s[0])},has(g,_){return getKeysFromAllScopes(g).includes(_)},ownKeys(g){return getKeysFromAllScopes(g)},set(g,_,b){const j=g._storage||(g._storage=c());return g[_]=j[_]=b,delete g._keys,!0}})}function _attachContext(s,e,a,o){const c={_cacheable:!1,_proxy:s,_context:e,_subProxy:a,_stack:new Set,_descriptors:_descriptors(s,o),setContext:d=>_attachContext(s,d,a,o),override:d=>_attachContext(s.override(d),e,a,o)};return new Proxy(c,{deleteProperty(d,h){return delete d[h],delete s[h],!0},get(d,h,g){return _cached(d,h,()=>_resolveWithContext(d,h,g))},getOwnPropertyDescriptor(d,h){return d._descriptors.allKeys?Reflect.has(s,h)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(s,h)},getPrototypeOf(){return Reflect.getPrototypeOf(s)},has(d,h){return Reflect.has(s,h)},ownKeys(){return Reflect.ownKeys(s)},set(d,h,g){return s[h]=g,delete d[h],!0}})}function _descriptors(s,e={scriptable:!0,indexable:!0}){const{_scriptable:a=e.scriptable,_indexable:o=e.indexable,_allKeys:c=e.allKeys}=s;return{allKeys:c,scriptable:a,indexable:o,isScriptable:isFunction(a)?a:()=>a,isIndexable:isFunction(o)?o:()=>o}}const readKey=(s,e)=>s?s+_capitalize(e):e,needsSubResolver=(s,e)=>isObject(e)&&s!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function _cached(s,e,a){if(Object.prototype.hasOwnProperty.call(s,e)||e==="constructor")return s[e];const o=a();return s[e]=o,o}function _resolveWithContext(s,e,a){const{_proxy:o,_context:c,_subProxy:d,_descriptors:h}=s;let g=o[e];return isFunction(g)&&h.isScriptable(e)&&(g=_resolveScriptable(e,g,s,a)),isArray(g)&&g.length&&(g=_resolveArray(e,g,s,h.isIndexable)),needsSubResolver(e,g)&&(g=_attachContext(g,c,d&&d[e],h)),g}function _resolveScriptable(s,e,a,o){const{_proxy:c,_context:d,_subProxy:h,_stack:g}=a;if(g.has(s))throw new Error("Recursion detected: "+Array.from(g).join("->")+"->"+s);g.add(s);let _=e(d,h||o);return g.delete(s),needsSubResolver(s,_)&&(_=createSubResolver(c._scopes,c,s,_)),_}function _resolveArray(s,e,a,o){const{_proxy:c,_context:d,_subProxy:h,_descriptors:g}=a;if(typeof d.index<"u"&&o(s))return e[d.index%e.length];if(isObject(e[0])){const _=e,b=c._scopes.filter(j=>j!==_);e=[];for(const j of _){const $=createSubResolver(b,c,s,j);e.push(_attachContext($,d,h&&h[s],g))}}return e}function resolveFallback(s,e,a){return isFunction(s)?s(e,a):s}const getScope=(s,e)=>s===!0?e:typeof s=="string"?resolveObjectKey(e,s):void 0;function addScopes(s,e,a,o,c){for(const d of e){const h=getScope(a,d);if(h){s.add(h);const g=resolveFallback(h._fallback,a,c);if(typeof g<"u"&&g!==a&&g!==o)return g}else if(h===!1&&typeof o<"u"&&a!==o)return null}return!1}function createSubResolver(s,e,a,o){const c=e._rootScopes,d=resolveFallback(e._fallback,a,o),h=[...s,...c],g=new Set;g.add(o);let _=addScopesFromKey(g,h,a,d||a,o);return _===null||typeof d<"u"&&d!==a&&(_=addScopesFromKey(g,h,d,_,o),_===null)?!1:_createResolver(Array.from(g),[""],c,d,()=>subGetTarget(e,a,o))}function addScopesFromKey(s,e,a,o,c){for(;a;)a=addScopes(s,e,a,o,c);return a}function subGetTarget(s,e,a){const o=s._getTarget();e in o||(o[e]={});const c=o[e];return isArray(c)&&isObject(a)?a:c||{}}function _resolveWithPrefixes(s,e,a,o){let c;for(const d of e)if(c=_resolve(readKey(d,s),a),typeof c<"u")return needsSubResolver(s,c)?createSubResolver(a,o,s,c):c}function _resolve(s,e){for(const a of e){if(!a)continue;const o=a[s];if(typeof o<"u")return o}}function getKeysFromAllScopes(s){let e=s._keys;return e||(e=s._keys=resolveKeysFromAllScopes(s._scopes)),e}function resolveKeysFromAllScopes(s){const e=new Set;for(const a of s)for(const o of Object.keys(a).filter(c=>!c.startsWith("_")))e.add(o);return Array.from(e)}function _isDomSupported(){return typeof window<"u"&&typeof document<"u"}function _getParentNode(s){let e=s.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function parseMaxStyle(s,e,a){let o;return typeof s=="string"?(o=parseInt(s,10),s.indexOf("%")!==-1&&(o=o/100*e.parentNode[a])):o=s,o}const getComputedStyle$1=s=>s.ownerDocument.defaultView.getComputedStyle(s,null);function getStyle(s,e){return getComputedStyle$1(s).getPropertyValue(e)}const positions=["top","right","bottom","left"];function getPositionedStyle(s,e,a){const o={};a=a?"-"+a:"";for(let c=0;c<4;c++){const d=positions[c];o[d]=parseFloat(s[e+"-"+d+a])||0}return o.width=o.left+o.right,o.height=o.top+o.bottom,o}const useOffsetPos=(s,e,a)=>(s>0||e>0)&&(!a||!a.shadowRoot);function getCanvasPosition(s,e){const a=s.touches,o=a&&a.length?a[0]:s,{offsetX:c,offsetY:d}=o;let h=!1,g,_;if(useOffsetPos(c,d,s.target))g=c,_=d;else{const b=e.getBoundingClientRect();g=o.clientX-b.left,_=o.clientY-b.top,h=!0}return{x:g,y:_,box:h}}function getRelativePosition(s,e){if("native"in s)return s;const{canvas:a,currentDevicePixelRatio:o}=e,c=getComputedStyle$1(a),d=c.boxSizing==="border-box",h=getPositionedStyle(c,"padding"),g=getPositionedStyle(c,"border","width"),{x:_,y:b,box:j}=getCanvasPosition(s,a),$=h.left+(j&&g.left),_e=h.top+(j&&g.top);let{width:tt,height:et}=e;return d&&(tt-=h.width+g.width,et-=h.height+g.height),{x:Math.round((_-$)/tt*a.width/o),y:Math.round((b-_e)/et*a.height/o)}}function getContainerSize(s,e,a){let o,c;if(e===void 0||a===void 0){const d=s&&_getParentNode(s);if(!d)e=s.clientWidth,a=s.clientHeight;else{const h=d.getBoundingClientRect(),g=getComputedStyle$1(d),_=getPositionedStyle(g,"border","width"),b=getPositionedStyle(g,"padding");e=h.width-b.width-_.width,a=h.height-b.height-_.height,o=parseMaxStyle(g.maxWidth,d,"clientWidth"),c=parseMaxStyle(g.maxHeight,d,"clientHeight")}}return{width:e,height:a,maxWidth:o||INFINITY,maxHeight:c||INFINITY}}const round1=s=>Math.round(s*10)/10;function getMaximumSize(s,e,a,o){const c=getComputedStyle$1(s),d=getPositionedStyle(c,"margin"),h=parseMaxStyle(c.maxWidth,s,"clientWidth")||INFINITY,g=parseMaxStyle(c.maxHeight,s,"clientHeight")||INFINITY,_=getContainerSize(s,e,a);let{width:b,height:j}=_;if(c.boxSizing==="content-box"){const _e=getPositionedStyle(c,"border","width"),tt=getPositionedStyle(c,"padding");b-=tt.width+_e.width,j-=tt.height+_e.height}return b=Math.max(0,b-d.width),j=Math.max(0,o?b/o:j-d.height),b=round1(Math.min(b,h,_.maxWidth)),j=round1(Math.min(j,g,_.maxHeight)),b&&!j&&(j=round1(b/2)),(e!==void 0||a!==void 0)&&o&&_.height&&j>_.height&&(j=_.height,b=round1(Math.floor(j*o))),{width:b,height:j}}function retinaScale(s,e,a){const o=e||1,c=Math.floor(s.height*o),d=Math.floor(s.width*o);s.height=Math.floor(s.height),s.width=Math.floor(s.width);const h=s.canvas;return h.style&&(a||!h.style.height&&!h.style.width)&&(h.style.height=`${s.height}px`,h.style.width=`${s.width}px`),s.currentDevicePixelRatio!==o||h.height!==c||h.width!==d?(s.currentDevicePixelRatio=o,h.height=c,h.width=d,s.ctx.setTransform(o,0,0,o,0,0),!0):!1}const supportsEventListenerOptions=function(){let s=!1;try{const e={get passive(){return s=!0,!1}};_isDomSupported()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return s}();function readUsedSize(s,e){const a=getStyle(s,e),o=a&&a.match(/^(\d+)(\.\d+)?px$/);return o?+o[1]:void 0}const getRightToLeftAdapter=function(s,e){return{x(a){return s+s+e-a},setWidth(a){e=a},textAlign(a){return a==="center"?a:a==="right"?"left":"right"},xPlus(a,o){return a-o},leftForLtr(a,o){return a-o}}},getLeftToRightAdapter=function(){return{x(s){return s},setWidth(s){},textAlign(s){return s},xPlus(s,e){return s+e},leftForLtr(s,e){return s}}};function getRtlAdapter(s,e,a){return s?getRightToLeftAdapter(e,a):getLeftToRightAdapter()}function overrideTextDirection(s,e){let a,o;(e==="ltr"||e==="rtl")&&(a=s.canvas.style,o=[a.getPropertyValue("direction"),a.getPropertyPriority("direction")],a.setProperty("direction",e,"important"),s.prevTextDirection=o)}function restoreTextDirection(s,e){e!==void 0&&(delete s.prevTextDirection,s.canvas.style.setProperty("direction",e[0],e[1]))}/*!
 * Chart.js v4.4.7
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */class Animator{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,a,o,c){const d=a.listeners[c],h=a.duration;d.forEach(g=>g({chart:e,initial:a.initial,numSteps:h,currentStep:Math.min(o-a.start,h)}))}_refresh(){this._request||(this._running=!0,this._request=requestAnimFrame.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let a=0;this._charts.forEach((o,c)=>{if(!o.running||!o.items.length)return;const d=o.items;let h=d.length-1,g=!1,_;for(;h>=0;--h)_=d[h],_._active?(_._total>o.duration&&(o.duration=_._total),_.tick(e),g=!0):(d[h]=d[d.length-1],d.pop());g&&(c.draw(),this._notify(c,o,e,"progress")),d.length||(o.running=!1,this._notify(c,o,e,"complete"),o.initial=!1),a+=d.length}),this._lastDate=e,a===0&&(this._running=!1)}_getAnims(e){const a=this._charts;let o=a.get(e);return o||(o={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},a.set(e,o)),o}listen(e,a,o){this._getAnims(e).listeners[a].push(o)}add(e,a){!a||!a.length||this._getAnims(e).items.push(...a)}has(e){return this._getAnims(e).items.length>0}start(e){const a=this._charts.get(e);a&&(a.running=!0,a.start=Date.now(),a.duration=a.items.reduce((o,c)=>Math.max(o,c._duration),0),this._refresh())}running(e){if(!this._running)return!1;const a=this._charts.get(e);return!(!a||!a.running||!a.items.length)}stop(e){const a=this._charts.get(e);if(!a||!a.items.length)return;const o=a.items;let c=o.length-1;for(;c>=0;--c)o[c].cancel();a.items=[],this._notify(e,a,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var animator=new Animator;const transparent="transparent",interpolators={boolean(s,e,a){return a>.5?e:s},color(s,e,a){const o=color(s||transparent),c=o.valid&&color(e||transparent);return c&&c.valid?c.mix(o,a).hexString():e},number(s,e,a){return s+(e-s)*a}};class Animation{constructor(e,a,o,c){const d=a[o];c=resolve([e.to,c,d,e.from]);const h=resolve([e.from,d,c]);this._active=!0,this._fn=e.fn||interpolators[e.type||typeof h],this._easing=effects[e.easing]||effects.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=a,this._prop=o,this._from=h,this._to=c,this._promises=void 0}active(){return this._active}update(e,a,o){if(this._active){this._notify(!1);const c=this._target[this._prop],d=o-this._start,h=this._duration-d;this._start=o,this._duration=Math.floor(Math.max(h,e.duration)),this._total+=d,this._loop=!!e.loop,this._to=resolve([e.to,a,c,e.from]),this._from=resolve([e.from,c,a])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const a=e-this._start,o=this._duration,c=this._prop,d=this._from,h=this._loop,g=this._to;let _;if(this._active=d!==g&&(h||a<o),!this._active){this._target[c]=g,this._notify(!0);return}if(a<0){this._target[c]=d;return}_=a/o%2,_=h&&_>1?2-_:_,_=this._easing(Math.min(1,Math.max(0,_))),this._target[c]=this._fn(d,g,_)}wait(){const e=this._promises||(this._promises=[]);return new Promise((a,o)=>{e.push({res:a,rej:o})})}_notify(e){const a=e?"res":"rej",o=this._promises||[];for(let c=0;c<o.length;c++)o[c][a]()}}class Animations{constructor(e,a){this._chart=e,this._properties=new Map,this.configure(a)}configure(e){if(!isObject(e))return;const a=Object.keys(defaults.animation),o=this._properties;Object.getOwnPropertyNames(e).forEach(c=>{const d=e[c];if(!isObject(d))return;const h={};for(const g of a)h[g]=d[g];(isArray(d.properties)&&d.properties||[c]).forEach(g=>{(g===c||!o.has(g))&&o.set(g,h)})})}_animateOptions(e,a){const o=a.options,c=resolveTargetOptions(e,o);if(!c)return[];const d=this._createAnimations(c,o);return o.$shared&&awaitAll(e.options.$animations,o).then(()=>{e.options=o},()=>{}),d}_createAnimations(e,a){const o=this._properties,c=[],d=e.$animations||(e.$animations={}),h=Object.keys(a),g=Date.now();let _;for(_=h.length-1;_>=0;--_){const b=h[_];if(b.charAt(0)==="$")continue;if(b==="options"){c.push(...this._animateOptions(e,a));continue}const j=a[b];let $=d[b];const _e=o.get(b);if($)if(_e&&$.active()){$.update(_e,j,g);continue}else $.cancel();if(!_e||!_e.duration){e[b]=j;continue}d[b]=$=new Animation(_e,e,b,j),c.push($)}return c}update(e,a){if(this._properties.size===0){Object.assign(e,a);return}const o=this._createAnimations(e,a);if(o.length)return animator.add(this._chart,o),!0}}function awaitAll(s,e){const a=[],o=Object.keys(e);for(let c=0;c<o.length;c++){const d=s[o[c]];d&&d.active()&&a.push(d.wait())}return Promise.all(a)}function resolveTargetOptions(s,e){if(!e)return;let a=s.options;if(!a){s.options=e;return}return a.$shared&&(s.options=a=Object.assign({},a,{$shared:!1,$animations:{}})),a}function scaleClip(s,e){const a=s&&s.options||{},o=a.reverse,c=a.min===void 0?e:0,d=a.max===void 0?e:0;return{start:o?d:c,end:o?c:d}}function defaultClip(s,e,a){if(a===!1)return!1;const o=scaleClip(s,a),c=scaleClip(e,a);return{top:c.end,right:o.end,bottom:c.start,left:o.start}}function toClip(s){let e,a,o,c;return isObject(s)?(e=s.top,a=s.right,o=s.bottom,c=s.left):e=a=o=c=s,{top:e,right:a,bottom:o,left:c,disabled:s===!1}}function getSortedDatasetIndices(s,e){const a=[],o=s._getSortedDatasetMetas(e);let c,d;for(c=0,d=o.length;c<d;++c)a.push(o[c].index);return a}function applyStack(s,e,a,o={}){const c=s.keys,d=o.mode==="single";let h,g,_,b;if(e===null)return;let j=!1;for(h=0,g=c.length;h<g;++h){if(_=+c[h],_===a){if(j=!0,o.all)continue;break}b=s.values[_],isNumberFinite(b)&&(d||e===0||sign(e)===sign(b))&&(e+=b)}return!j&&!o.all?0:e}function convertObjectDataToArray(s,e){const{iScale:a,vScale:o}=e,c=a.axis==="x"?"x":"y",d=o.axis==="x"?"x":"y",h=Object.keys(s),g=new Array(h.length);let _,b,j;for(_=0,b=h.length;_<b;++_)j=h[_],g[_]={[c]:j,[d]:s[j]};return g}function isStacked(s,e){const a=s&&s.options.stacked;return a||a===void 0&&e.stack!==void 0}function getStackKey(s,e,a){return`${s.id}.${e.id}.${a.stack||a.type}`}function getUserBounds(s){const{min:e,max:a,minDefined:o,maxDefined:c}=s.getUserBounds();return{min:o?e:Number.NEGATIVE_INFINITY,max:c?a:Number.POSITIVE_INFINITY}}function getOrCreateStack(s,e,a){const o=s[e]||(s[e]={});return o[a]||(o[a]={})}function getLastIndexInStack(s,e,a,o){for(const c of e.getMatchingVisibleMetas(o).reverse()){const d=s[c.index];if(a&&d>0||!a&&d<0)return c.index}return null}function updateStacks(s,e){const{chart:a,_cachedMeta:o}=s,c=a._stacks||(a._stacks={}),{iScale:d,vScale:h,index:g}=o,_=d.axis,b=h.axis,j=getStackKey(d,h,o),$=e.length;let _e;for(let tt=0;tt<$;++tt){const et=e[tt],{[_]:st,[b]:rt}=et,nt=et._stacks||(et._stacks={});_e=nt[b]=getOrCreateStack(c,j,st),_e[g]=rt,_e._top=getLastIndexInStack(_e,h,!0,o.type),_e._bottom=getLastIndexInStack(_e,h,!1,o.type);const it=_e._visualValues||(_e._visualValues={});it[g]=rt}}function getFirstScaleId(s,e){const a=s.scales;return Object.keys(a).filter(o=>a[o].axis===e).shift()}function createDatasetContext(s,e){return createContext(s,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function createDataContext(s,e,a){return createContext(s,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:a,index:e,mode:"default",type:"data"})}function clearStacks(s,e){const a=s.controller.index,o=s.vScale&&s.vScale.axis;if(o){e=e||s._parsed;for(const c of e){const d=c._stacks;if(!d||d[o]===void 0||d[o][a]===void 0)return;delete d[o][a],d[o]._visualValues!==void 0&&d[o]._visualValues[a]!==void 0&&delete d[o]._visualValues[a]}}}const isDirectUpdateMode=s=>s==="reset"||s==="none",cloneIfNotShared=(s,e)=>e?s:Object.assign({},s),createStack=(s,e,a)=>s&&!e.hidden&&e._stacked&&{keys:getSortedDatasetIndices(a,!0),values:null};class DatasetController{constructor(e,a){this.chart=e,this._ctx=e.ctx,this.index=a,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=isStacked(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&clearStacks(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,a=this._cachedMeta,o=this.getDataset(),c=($,_e,tt,et)=>$==="x"?_e:$==="r"?et:tt,d=a.xAxisID=valueOrDefault(o.xAxisID,getFirstScaleId(e,"x")),h=a.yAxisID=valueOrDefault(o.yAxisID,getFirstScaleId(e,"y")),g=a.rAxisID=valueOrDefault(o.rAxisID,getFirstScaleId(e,"r")),_=a.indexAxis,b=a.iAxisID=c(_,d,h,g),j=a.vAxisID=c(_,h,d,g);a.xScale=this.getScaleForId(d),a.yScale=this.getScaleForId(h),a.rScale=this.getScaleForId(g),a.iScale=this.getScaleForId(b),a.vScale=this.getScaleForId(j)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const a=this._cachedMeta;return e===a.iScale?a.vScale:a.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&unlistenArrayEvents(this._data,this),e._stacked&&clearStacks(e)}_dataCheck(){const e=this.getDataset(),a=e.data||(e.data=[]),o=this._data;if(isObject(a)){const c=this._cachedMeta;this._data=convertObjectDataToArray(a,c)}else if(o!==a){if(o){unlistenArrayEvents(o,this);const c=this._cachedMeta;clearStacks(c),c._parsed=[]}a&&Object.isExtensible(a)&&listenArrayEvents(a,this),this._syncList=[],this._data=a}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const a=this._cachedMeta,o=this.getDataset();let c=!1;this._dataCheck();const d=a._stacked;a._stacked=isStacked(a.vScale,a),a.stack!==o.stack&&(c=!0,clearStacks(a),a.stack=o.stack),this._resyncElements(e),(c||d!==a._stacked)&&(updateStacks(this,a._parsed),a._stacked=isStacked(a.vScale,a))}configure(){const e=this.chart.config,a=e.datasetScopeKeys(this._type),o=e.getOptionScopes(this.getDataset(),a,!0);this.options=e.createResolver(o,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,a){const{_cachedMeta:o,_data:c}=this,{iScale:d,_stacked:h}=o,g=d.axis;let _=e===0&&a===c.length?!0:o._sorted,b=e>0&&o._parsed[e-1],j,$,_e;if(this._parsing===!1)o._parsed=c,o._sorted=!0,_e=c;else{isArray(c[e])?_e=this.parseArrayData(o,c,e,a):isObject(c[e])?_e=this.parseObjectData(o,c,e,a):_e=this.parsePrimitiveData(o,c,e,a);const tt=()=>$[g]===null||b&&$[g]<b[g];for(j=0;j<a;++j)o._parsed[j+e]=$=_e[j],_&&(tt()&&(_=!1),b=$);o._sorted=_}h&&updateStacks(this,_e)}parsePrimitiveData(e,a,o,c){const{iScale:d,vScale:h}=e,g=d.axis,_=h.axis,b=d.getLabels(),j=d===h,$=new Array(c);let _e,tt,et;for(_e=0,tt=c;_e<tt;++_e)et=_e+o,$[_e]={[g]:j||d.parse(b[et],et),[_]:h.parse(a[et],et)};return $}parseArrayData(e,a,o,c){const{xScale:d,yScale:h}=e,g=new Array(c);let _,b,j,$;for(_=0,b=c;_<b;++_)j=_+o,$=a[j],g[_]={x:d.parse($[0],j),y:h.parse($[1],j)};return g}parseObjectData(e,a,o,c){const{xScale:d,yScale:h}=e,{xAxisKey:g="x",yAxisKey:_="y"}=this._parsing,b=new Array(c);let j,$,_e,tt;for(j=0,$=c;j<$;++j)_e=j+o,tt=a[_e],b[j]={x:d.parse(resolveObjectKey(tt,g),_e),y:h.parse(resolveObjectKey(tt,_),_e)};return b}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,a,o){const c=this.chart,d=this._cachedMeta,h=a[e.axis],g={keys:getSortedDatasetIndices(c,!0),values:a._stacks[e.axis]._visualValues};return applyStack(g,h,d.index,{mode:o})}updateRangeFromParsed(e,a,o,c){const d=o[a.axis];let h=d===null?NaN:d;const g=c&&o._stacks[a.axis];c&&g&&(c.values=g,h=applyStack(c,d,this._cachedMeta.index)),e.min=Math.min(e.min,h),e.max=Math.max(e.max,h)}getMinMax(e,a){const o=this._cachedMeta,c=o._parsed,d=o._sorted&&e===o.iScale,h=c.length,g=this._getOtherScale(e),_=createStack(a,o,this.chart),b={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:j,max:$}=getUserBounds(g);let _e,tt;function et(){tt=c[_e];const st=tt[g.axis];return!isNumberFinite(tt[e.axis])||j>st||$<st}for(_e=0;_e<h&&!(!et()&&(this.updateRangeFromParsed(b,e,tt,_),d));++_e);if(d){for(_e=h-1;_e>=0;--_e)if(!et()){this.updateRangeFromParsed(b,e,tt,_);break}}return b}getAllParsedValues(e){const a=this._cachedMeta._parsed,o=[];let c,d,h;for(c=0,d=a.length;c<d;++c)h=a[c][e.axis],isNumberFinite(h)&&o.push(h);return o}getMaxOverflow(){return!1}getLabelAndValue(e){const a=this._cachedMeta,o=a.iScale,c=a.vScale,d=this.getParsed(e);return{label:o?""+o.getLabelForValue(d[o.axis]):"",value:c?""+c.getLabelForValue(d[c.axis]):""}}_update(e){const a=this._cachedMeta;this.update(e||"default"),a._clip=toClip(valueOrDefault(this.options.clip,defaultClip(a.xScale,a.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,a=this.chart,o=this._cachedMeta,c=o.data||[],d=a.chartArea,h=[],g=this._drawStart||0,_=this._drawCount||c.length-g,b=this.options.drawActiveElementsOnTop;let j;for(o.dataset&&o.dataset.draw(e,d,g,_),j=g;j<g+_;++j){const $=c[j];$.hidden||($.active&&b?h.push($):$.draw(e,d))}for(j=0;j<h.length;++j)h[j].draw(e,d)}getStyle(e,a){const o=a?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(o):this.resolveDataElementOptions(e||0,o)}getContext(e,a,o){const c=this.getDataset();let d;if(e>=0&&e<this._cachedMeta.data.length){const h=this._cachedMeta.data[e];d=h.$context||(h.$context=createDataContext(this.getContext(),e,h)),d.parsed=this.getParsed(e),d.raw=c.data[e],d.index=d.dataIndex=e}else d=this.$context||(this.$context=createDatasetContext(this.chart.getContext(),this.index)),d.dataset=c,d.index=d.datasetIndex=this.index;return d.active=!!a,d.mode=o,d}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,a){return this._resolveElementOptions(this.dataElementType.id,a,e)}_resolveElementOptions(e,a="default",o){const c=a==="active",d=this._cachedDataOpts,h=e+"-"+a,g=d[h],_=this.enableOptionSharing&&defined(o);if(g)return cloneIfNotShared(g,_);const b=this.chart.config,j=b.datasetElementScopeKeys(this._type,e),$=c?[`${e}Hover`,"hover",e,""]:[e,""],_e=b.getOptionScopes(this.getDataset(),j),tt=Object.keys(defaults.elements[e]),et=()=>this.getContext(o,c,a),st=b.resolveNamedOptions(_e,tt,et,$);return st.$shared&&(st.$shared=_,d[h]=Object.freeze(cloneIfNotShared(st,_))),st}_resolveAnimations(e,a,o){const c=this.chart,d=this._cachedDataOpts,h=`animation-${a}`,g=d[h];if(g)return g;let _;if(c.options.animation!==!1){const j=this.chart.config,$=j.datasetAnimationScopeKeys(this._type,a),_e=j.getOptionScopes(this.getDataset(),$);_=j.createResolver(_e,this.getContext(e,o,a))}const b=new Animations(c,_&&_.animations);return _&&_._cacheable&&(d[h]=Object.freeze(b)),b}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,a){return!a||isDirectUpdateMode(e)||this.chart._animationsDisabled}_getSharedOptions(e,a){const o=this.resolveDataElementOptions(e,a),c=this._sharedOptions,d=this.getSharedOptions(o),h=this.includeOptions(a,d)||d!==c;return this.updateSharedOptions(d,a,o),{sharedOptions:d,includeOptions:h}}updateElement(e,a,o,c){isDirectUpdateMode(c)?Object.assign(e,o):this._resolveAnimations(a,c).update(e,o)}updateSharedOptions(e,a,o){e&&!isDirectUpdateMode(a)&&this._resolveAnimations(void 0,a).update(e,o)}_setStyle(e,a,o,c){e.active=c;const d=this.getStyle(a,c);this._resolveAnimations(a,o,c).update(e,{options:!c&&this.getSharedOptions(d)||d})}removeHoverStyle(e,a,o){this._setStyle(e,o,"active",!1)}setHoverStyle(e,a,o){this._setStyle(e,o,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const a=this._data,o=this._cachedMeta.data;for(const[g,_,b]of this._syncList)this[g](_,b);this._syncList=[];const c=o.length,d=a.length,h=Math.min(d,c);h&&this.parse(0,h),d>c?this._insertElements(c,d-c,e):d<c&&this._removeElements(d,c-d)}_insertElements(e,a,o=!0){const c=this._cachedMeta,d=c.data,h=e+a;let g;const _=b=>{for(b.length+=a,g=b.length-1;g>=h;g--)b[g]=b[g-a]};for(_(d),g=e;g<h;++g)d[g]=new this.dataElementType;this._parsing&&_(c._parsed),this.parse(e,a),o&&this.updateElements(d,e,a,"reset")}updateElements(e,a,o,c){}_removeElements(e,a){const o=this._cachedMeta;if(this._parsing){const c=o._parsed.splice(e,a);o._stacked&&clearStacks(o,c)}o.data.splice(e,a)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[a,o,c]=e;this[a](o,c)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,a){a&&this._sync(["_removeElements",e,a]);const o=arguments.length-2;o&&this._sync(["_insertElements",e,o])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Sn(DatasetController,"defaults",{}),Sn(DatasetController,"datasetElementType",null),Sn(DatasetController,"dataElementType",null);function getAllScaleValues(s,e){if(!s._cache.$bar){const a=s.getMatchingVisibleMetas(e);let o=[];for(let c=0,d=a.length;c<d;c++)o=o.concat(a[c].controller.getAllParsedValues(s));s._cache.$bar=_arrayUnique(o.sort((c,d)=>c-d))}return s._cache.$bar}function computeMinSampleSize(s){const e=s.iScale,a=getAllScaleValues(e,s.type);let o=e._length,c,d,h,g;const _=()=>{h===32767||h===-32768||(defined(g)&&(o=Math.min(o,Math.abs(h-g)||o)),g=h)};for(c=0,d=a.length;c<d;++c)h=e.getPixelForValue(a[c]),_();for(g=void 0,c=0,d=e.ticks.length;c<d;++c)h=e.getPixelForTick(c),_();return o}function computeFitCategoryTraits(s,e,a,o){const c=a.barThickness;let d,h;return isNullOrUndef(c)?(d=e.min*a.categoryPercentage,h=a.barPercentage):(d=c*o,h=1),{chunk:d/o,ratio:h,start:e.pixels[s]-d/2}}function computeFlexCategoryTraits(s,e,a,o){const c=e.pixels,d=c[s];let h=s>0?c[s-1]:null,g=s<c.length-1?c[s+1]:null;const _=a.categoryPercentage;h===null&&(h=d-(g===null?e.end-e.start:g-d)),g===null&&(g=d+d-h);const b=d-(d-Math.min(h,g))/2*_;return{chunk:Math.abs(g-h)/2*_/o,ratio:a.barPercentage,start:b}}function parseFloatBar(s,e,a,o){const c=a.parse(s[0],o),d=a.parse(s[1],o),h=Math.min(c,d),g=Math.max(c,d);let _=h,b=g;Math.abs(h)>Math.abs(g)&&(_=g,b=h),e[a.axis]=b,e._custom={barStart:_,barEnd:b,start:c,end:d,min:h,max:g}}function parseValue(s,e,a,o){return isArray(s)?parseFloatBar(s,e,a,o):e[a.axis]=a.parse(s,o),e}function parseArrayOrPrimitive(s,e,a,o){const c=s.iScale,d=s.vScale,h=c.getLabels(),g=c===d,_=[];let b,j,$,_e;for(b=a,j=a+o;b<j;++b)_e=e[b],$={},$[c.axis]=g||c.parse(h[b],b),_.push(parseValue(_e,$,d,b));return _}function isFloatBar(s){return s&&s.barStart!==void 0&&s.barEnd!==void 0}function barSign(s,e,a){return s!==0?sign(s):(e.isHorizontal()?1:-1)*(e.min>=a?1:-1)}function borderProps(s){let e,a,o,c,d;return s.horizontal?(e=s.base>s.x,a="left",o="right"):(e=s.base<s.y,a="bottom",o="top"),e?(c="end",d="start"):(c="start",d="end"),{start:a,end:o,reverse:e,top:c,bottom:d}}function setBorderSkipped(s,e,a,o){let c=e.borderSkipped;const d={};if(!c){s.borderSkipped=d;return}if(c===!0){s.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:h,end:g,reverse:_,top:b,bottom:j}=borderProps(s);c==="middle"&&a&&(s.enableBorderRadius=!0,(a._top||0)===o?c=b:(a._bottom||0)===o?c=j:(d[parseEdge(j,h,g,_)]=!0,c=b)),d[parseEdge(c,h,g,_)]=!0,s.borderSkipped=d}function parseEdge(s,e,a,o){return o?(s=swap(s,e,a),s=startEnd(s,a,e)):s=startEnd(s,e,a),s}function swap(s,e,a){return s===e?a:s===a?e:s}function startEnd(s,e,a){return s==="start"?e:s==="end"?a:s}function setInflateAmount(s,{inflateAmount:e},a){s.inflateAmount=e==="auto"?a===1?.33:0:e}class BarController extends DatasetController{parsePrimitiveData(e,a,o,c){return parseArrayOrPrimitive(e,a,o,c)}parseArrayData(e,a,o,c){return parseArrayOrPrimitive(e,a,o,c)}parseObjectData(e,a,o,c){const{iScale:d,vScale:h}=e,{xAxisKey:g="x",yAxisKey:_="y"}=this._parsing,b=d.axis==="x"?g:_,j=h.axis==="x"?g:_,$=[];let _e,tt,et,st;for(_e=o,tt=o+c;_e<tt;++_e)st=a[_e],et={},et[d.axis]=d.parse(resolveObjectKey(st,b),_e),$.push(parseValue(resolveObjectKey(st,j),et,h,_e));return $}updateRangeFromParsed(e,a,o,c){super.updateRangeFromParsed(e,a,o,c);const d=o._custom;d&&a===this._cachedMeta.vScale&&(e.min=Math.min(e.min,d.min),e.max=Math.max(e.max,d.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const a=this._cachedMeta,{iScale:o,vScale:c}=a,d=this.getParsed(e),h=d._custom,g=isFloatBar(h)?"["+h.start+", "+h.end+"]":""+c.getLabelForValue(d[c.axis]);return{label:""+o.getLabelForValue(d[o.axis]),value:g}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const a=this._cachedMeta;this.updateElements(a.data,0,a.data.length,e)}updateElements(e,a,o,c){const d=c==="reset",{index:h,_cachedMeta:{vScale:g}}=this,_=g.getBasePixel(),b=g.isHorizontal(),j=this._getRuler(),{sharedOptions:$,includeOptions:_e}=this._getSharedOptions(a,c);for(let tt=a;tt<a+o;tt++){const et=this.getParsed(tt),st=d||isNullOrUndef(et[g.axis])?{base:_,head:_}:this._calculateBarValuePixels(tt),rt=this._calculateBarIndexPixels(tt,j),nt=(et._stacks||{})[g.axis],it={horizontal:b,base:st.base,enableBorderRadius:!nt||isFloatBar(et._custom)||h===nt._top||h===nt._bottom,x:b?st.head:rt.center,y:b?rt.center:st.head,height:b?rt.size:Math.abs(st.size),width:b?Math.abs(st.size):rt.size};_e&&(it.options=$||this.resolveDataElementOptions(tt,e[tt].active?"active":c));const at=it.options||e[tt].options;setBorderSkipped(it,at,nt,h),setInflateAmount(it,at,j.ratio),this.updateElement(e[tt],tt,it,c)}}_getStacks(e,a){const{iScale:o}=this._cachedMeta,c=o.getMatchingVisibleMetas(this._type).filter(j=>j.controller.options.grouped),d=o.options.stacked,h=[],g=this._cachedMeta.controller.getParsed(a),_=g&&g[o.axis],b=j=>{const $=j._parsed.find(tt=>tt[o.axis]===_),_e=$&&$[j.vScale.axis];if(isNullOrUndef(_e)||isNaN(_e))return!0};for(const j of c)if(!(a!==void 0&&b(j))&&((d===!1||h.indexOf(j.stack)===-1||d===void 0&&j.stack===void 0)&&h.push(j.stack),j.index===e))break;return h.length||h.push(void 0),h}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,a,o){const c=this._getStacks(e,o),d=a!==void 0?c.indexOf(a):-1;return d===-1?c.length-1:d}_getRuler(){const e=this.options,a=this._cachedMeta,o=a.iScale,c=[];let d,h;for(d=0,h=a.data.length;d<h;++d)c.push(o.getPixelForValue(this.getParsed(d)[o.axis],d));const g=e.barThickness;return{min:g||computeMinSampleSize(a),pixels:c,start:o._startPixel,end:o._endPixel,stackCount:this._getStackCount(),scale:o,grouped:e.grouped,ratio:g?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:a,_stacked:o,index:c},options:{base:d,minBarLength:h}}=this,g=d||0,_=this.getParsed(e),b=_._custom,j=isFloatBar(b);let $=_[a.axis],_e=0,tt=o?this.applyStack(a,_,o):$,et,st;tt!==$&&(_e=tt-$,tt=$),j&&($=b.barStart,tt=b.barEnd-b.barStart,$!==0&&sign($)!==sign(b.barEnd)&&(_e=0),_e+=$);const rt=!isNullOrUndef(d)&&!j?d:_e;let nt=a.getPixelForValue(rt);if(this.chart.getDataVisibility(e)?et=a.getPixelForValue(_e+tt):et=nt,st=et-nt,Math.abs(st)<h){st=barSign(st,a,g)*h,$===g&&(nt-=st/2);const it=a.getPixelForDecimal(0),at=a.getPixelForDecimal(1),dt=Math.min(it,at),ot=Math.max(it,at);nt=Math.max(Math.min(nt,ot),dt),et=nt+st,o&&!j&&(_._stacks[a.axis]._visualValues[c]=a.getValueForPixel(et)-a.getValueForPixel(nt))}if(nt===a.getPixelForValue(g)){const it=sign(st)*a.getLineWidthForValue(g)/2;nt+=it,st-=it}return{size:st,base:nt,head:et,center:et+st/2}}_calculateBarIndexPixels(e,a){const o=a.scale,c=this.options,d=c.skipNull,h=valueOrDefault(c.maxBarThickness,1/0);let g,_;if(a.grouped){const b=d?this._getStackCount(e):a.stackCount,j=c.barThickness==="flex"?computeFlexCategoryTraits(e,a,c,b):computeFitCategoryTraits(e,a,c,b),$=this._getStackIndex(this.index,this._cachedMeta.stack,d?e:void 0);g=j.start+j.chunk*$+j.chunk/2,_=Math.min(h,j.chunk*j.ratio)}else g=o.getPixelForValue(this.getParsed(e)[o.axis],e),_=Math.min(h,a.min*a.ratio);return{base:g-_/2,head:g+_/2,center:g,size:_}}draw(){const e=this._cachedMeta,a=e.vScale,o=e.data,c=o.length;let d=0;for(;d<c;++d)this.getParsed(d)[a.axis]!==null&&!o[d].hidden&&o[d].draw(this._ctx)}}Sn(BarController,"id","bar"),Sn(BarController,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Sn(BarController,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function getRatioAndOffset(s,e,a){let o=1,c=1,d=0,h=0;if(e<TAU){const g=s,_=g+e,b=Math.cos(g),j=Math.sin(g),$=Math.cos(_),_e=Math.sin(_),tt=(at,dt,ot)=>_angleBetween(at,g,_,!0)?1:Math.max(dt,dt*a,ot,ot*a),et=(at,dt,ot)=>_angleBetween(at,g,_,!0)?-1:Math.min(dt,dt*a,ot,ot*a),st=tt(0,b,$),rt=tt(HALF_PI,j,_e),nt=et(PI,b,$),it=et(PI+HALF_PI,j,_e);o=(st-nt)/2,c=(rt-it)/2,d=-(st+nt)/2,h=-(rt+it)/2}return{ratioX:o,ratioY:c,offsetX:d,offsetY:h}}class DoughnutController extends DatasetController{constructor(e,a){super(e,a),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,a){const o=this.getDataset().data,c=this._cachedMeta;if(this._parsing===!1)c._parsed=o;else{let d=_=>+o[_];if(isObject(o[e])){const{key:_="value"}=this._parsing;d=b=>+resolveObjectKey(o[b],_)}let h,g;for(h=e,g=e+a;h<g;++h)c._parsed[h]=d(h)}}_getRotation(){return toRadians(this.options.rotation-90)}_getCircumference(){return toRadians(this.options.circumference)}_getRotationExtents(){let e=TAU,a=-TAU;for(let o=0;o<this.chart.data.datasets.length;++o)if(this.chart.isDatasetVisible(o)&&this.chart.getDatasetMeta(o).type===this._type){const c=this.chart.getDatasetMeta(o).controller,d=c._getRotation(),h=c._getCircumference();e=Math.min(e,d),a=Math.max(a,d+h)}return{rotation:e,circumference:a-e}}update(e){const a=this.chart,{chartArea:o}=a,c=this._cachedMeta,d=c.data,h=this.getMaxBorderWidth()+this.getMaxOffset(d)+this.options.spacing,g=Math.max((Math.min(o.width,o.height)-h)/2,0),_=Math.min(toPercentage(this.options.cutout,g),1),b=this._getRingWeight(this.index),{circumference:j,rotation:$}=this._getRotationExtents(),{ratioX:_e,ratioY:tt,offsetX:et,offsetY:st}=getRatioAndOffset($,j,_),rt=(o.width-h)/_e,nt=(o.height-h)/tt,it=Math.max(Math.min(rt,nt)/2,0),at=toDimension(this.options.radius,it),dt=Math.max(at*_,0),ot=(at-dt)/this._getVisibleDatasetWeightTotal();this.offsetX=et*at,this.offsetY=st*at,c.total=this.calculateTotal(),this.outerRadius=at-ot*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-ot*b,0),this.updateElements(d,0,d.length,e)}_circumference(e,a){const o=this.options,c=this._cachedMeta,d=this._getCircumference();return a&&o.animation.animateRotate||!this.chart.getDataVisibility(e)||c._parsed[e]===null||c.data[e].hidden?0:this.calculateCircumference(c._parsed[e]*d/TAU)}updateElements(e,a,o,c){const d=c==="reset",h=this.chart,g=h.chartArea,b=h.options.animation,j=(g.left+g.right)/2,$=(g.top+g.bottom)/2,_e=d&&b.animateScale,tt=_e?0:this.innerRadius,et=_e?0:this.outerRadius,{sharedOptions:st,includeOptions:rt}=this._getSharedOptions(a,c);let nt=this._getRotation(),it;for(it=0;it<a;++it)nt+=this._circumference(it,d);for(it=a;it<a+o;++it){const at=this._circumference(it,d),dt=e[it],ot={x:j+this.offsetX,y:$+this.offsetY,startAngle:nt,endAngle:nt+at,circumference:at,outerRadius:et,innerRadius:tt};rt&&(ot.options=st||this.resolveDataElementOptions(it,dt.active?"active":c)),nt+=at,this.updateElement(dt,it,ot,c)}}calculateTotal(){const e=this._cachedMeta,a=e.data;let o=0,c;for(c=0;c<a.length;c++){const d=e._parsed[c];d!==null&&!isNaN(d)&&this.chart.getDataVisibility(c)&&!a[c].hidden&&(o+=Math.abs(d))}return o}calculateCircumference(e){const a=this._cachedMeta.total;return a>0&&!isNaN(e)?TAU*(Math.abs(e)/a):0}getLabelAndValue(e){const a=this._cachedMeta,o=this.chart,c=o.data.labels||[],d=formatNumber(a._parsed[e],o.options.locale);return{label:c[e]||"",value:d}}getMaxBorderWidth(e){let a=0;const o=this.chart;let c,d,h,g,_;if(!e){for(c=0,d=o.data.datasets.length;c<d;++c)if(o.isDatasetVisible(c)){h=o.getDatasetMeta(c),e=h.data,g=h.controller;break}}if(!e)return 0;for(c=0,d=e.length;c<d;++c)_=g.resolveDataElementOptions(c),_.borderAlign!=="inner"&&(a=Math.max(a,_.borderWidth||0,_.hoverBorderWidth||0));return a}getMaxOffset(e){let a=0;for(let o=0,c=e.length;o<c;++o){const d=this.resolveDataElementOptions(o);a=Math.max(a,d.offset||0,d.hoverOffset||0)}return a}_getRingWeightOffset(e){let a=0;for(let o=0;o<e;++o)this.chart.isDatasetVisible(o)&&(a+=this._getRingWeight(o));return a}_getRingWeight(e){return Math.max(valueOrDefault(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Sn(DoughnutController,"id","doughnut"),Sn(DoughnutController,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Sn(DoughnutController,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),Sn(DoughnutController,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const a=e.data;if(a.labels.length&&a.datasets.length){const{labels:{pointStyle:o,color:c}}=e.legend.options;return a.labels.map((d,h)=>{const _=e.getDatasetMeta(0).controller.getStyle(h);return{text:d,fillStyle:_.backgroundColor,strokeStyle:_.borderColor,fontColor:c,lineWidth:_.borderWidth,pointStyle:o,hidden:!e.getDataVisibility(h),index:h}})}return[]}},onClick(e,a,o){o.chart.toggleDataVisibility(a.index),o.chart.update()}}}});function abstract(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class DateAdapterBase{constructor(e){Sn(this,"options");this.options=e||{}}static override(e){Object.assign(DateAdapterBase.prototype,e)}init(){}formats(){return abstract()}parse(){return abstract()}format(){return abstract()}add(){return abstract()}diff(){return abstract()}startOf(){return abstract()}endOf(){return abstract()}}var adapters={_date:DateAdapterBase};function binarySearch(s,e,a,o){const{controller:c,data:d,_sorted:h}=s,g=c._cachedMeta.iScale;if(g&&e===g.axis&&e!=="r"&&h&&d.length){const _=g._reversePixels?_rlookupByKey:_lookupByKey;if(o){if(c._sharedOptions){const b=d[0],j=typeof b.getRange=="function"&&b.getRange(e);if(j){const $=_(d,e,a-j),_e=_(d,e,a+j);return{lo:$.lo,hi:_e.hi}}}}else return _(d,e,a)}return{lo:0,hi:d.length-1}}function evaluateInteractionItems(s,e,a,o,c){const d=s.getSortedVisibleDatasetMetas(),h=a[e];for(let g=0,_=d.length;g<_;++g){const{index:b,data:j}=d[g],{lo:$,hi:_e}=binarySearch(d[g],e,h,c);for(let tt=$;tt<=_e;++tt){const et=j[tt];et.skip||o(et,b,tt)}}}function getDistanceMetricForAxis(s){const e=s.indexOf("x")!==-1,a=s.indexOf("y")!==-1;return function(o,c){const d=e?Math.abs(o.x-c.x):0,h=a?Math.abs(o.y-c.y):0;return Math.sqrt(Math.pow(d,2)+Math.pow(h,2))}}function getIntersectItems(s,e,a,o,c){const d=[];return!c&&!s.isPointInArea(e)||evaluateInteractionItems(s,a,e,function(g,_,b){!c&&!_isPointInArea(g,s.chartArea,0)||g.inRange(e.x,e.y,o)&&d.push({element:g,datasetIndex:_,index:b})},!0),d}function getNearestRadialItems(s,e,a,o){let c=[];function d(h,g,_){const{startAngle:b,endAngle:j}=h.getProps(["startAngle","endAngle"],o),{angle:$}=getAngleFromPoint(h,{x:e.x,y:e.y});_angleBetween($,b,j)&&c.push({element:h,datasetIndex:g,index:_})}return evaluateInteractionItems(s,a,e,d),c}function getNearestCartesianItems(s,e,a,o,c,d){let h=[];const g=getDistanceMetricForAxis(a);let _=Number.POSITIVE_INFINITY;function b(j,$,_e){const tt=j.inRange(e.x,e.y,c);if(o&&!tt)return;const et=j.getCenterPoint(c);if(!(!!d||s.isPointInArea(et))&&!tt)return;const rt=g(e,et);rt<_?(h=[{element:j,datasetIndex:$,index:_e}],_=rt):rt===_&&h.push({element:j,datasetIndex:$,index:_e})}return evaluateInteractionItems(s,a,e,b),h}function getNearestItems(s,e,a,o,c,d){return!d&&!s.isPointInArea(e)?[]:a==="r"&&!o?getNearestRadialItems(s,e,a,c):getNearestCartesianItems(s,e,a,o,c,d)}function getAxisItems(s,e,a,o,c){const d=[],h=a==="x"?"inXRange":"inYRange";let g=!1;return evaluateInteractionItems(s,a,e,(_,b,j)=>{_[h]&&_[h](e[a],c)&&(d.push({element:_,datasetIndex:b,index:j}),g=g||_.inRange(e.x,e.y,c))}),o&&!g?[]:d}var Interaction={modes:{index(s,e,a,o){const c=getRelativePosition(e,s),d=a.axis||"x",h=a.includeInvisible||!1,g=a.intersect?getIntersectItems(s,c,d,o,h):getNearestItems(s,c,d,!1,o,h),_=[];return g.length?(s.getSortedVisibleDatasetMetas().forEach(b=>{const j=g[0].index,$=b.data[j];$&&!$.skip&&_.push({element:$,datasetIndex:b.index,index:j})}),_):[]},dataset(s,e,a,o){const c=getRelativePosition(e,s),d=a.axis||"xy",h=a.includeInvisible||!1;let g=a.intersect?getIntersectItems(s,c,d,o,h):getNearestItems(s,c,d,!1,o,h);if(g.length>0){const _=g[0].datasetIndex,b=s.getDatasetMeta(_).data;g=[];for(let j=0;j<b.length;++j)g.push({element:b[j],datasetIndex:_,index:j})}return g},point(s,e,a,o){const c=getRelativePosition(e,s),d=a.axis||"xy",h=a.includeInvisible||!1;return getIntersectItems(s,c,d,o,h)},nearest(s,e,a,o){const c=getRelativePosition(e,s),d=a.axis||"xy",h=a.includeInvisible||!1;return getNearestItems(s,c,d,a.intersect,o,h)},x(s,e,a,o){const c=getRelativePosition(e,s);return getAxisItems(s,c,"x",a.intersect,o)},y(s,e,a,o){const c=getRelativePosition(e,s);return getAxisItems(s,c,"y",a.intersect,o)}}};const STATIC_POSITIONS=["left","top","right","bottom"];function filterByPosition(s,e){return s.filter(a=>a.pos===e)}function filterDynamicPositionByAxis(s,e){return s.filter(a=>STATIC_POSITIONS.indexOf(a.pos)===-1&&a.box.axis===e)}function sortByWeight(s,e){return s.sort((a,o)=>{const c=e?o:a,d=e?a:o;return c.weight===d.weight?c.index-d.index:c.weight-d.weight})}function wrapBoxes(s){const e=[];let a,o,c,d,h,g;for(a=0,o=(s||[]).length;a<o;++a)c=s[a],{position:d,options:{stack:h,stackWeight:g=1}}=c,e.push({index:a,box:c,pos:d,horizontal:c.isHorizontal(),weight:c.weight,stack:h&&d+h,stackWeight:g});return e}function buildStacks(s){const e={};for(const a of s){const{stack:o,pos:c,stackWeight:d}=a;if(!o||!STATIC_POSITIONS.includes(c))continue;const h=e[o]||(e[o]={count:0,placed:0,weight:0,size:0});h.count++,h.weight+=d}return e}function setLayoutDims(s,e){const a=buildStacks(s),{vBoxMaxWidth:o,hBoxMaxHeight:c}=e;let d,h,g;for(d=0,h=s.length;d<h;++d){g=s[d];const{fullSize:_}=g.box,b=a[g.stack],j=b&&g.stackWeight/b.weight;g.horizontal?(g.width=j?j*o:_&&e.availableWidth,g.height=c):(g.width=o,g.height=j?j*c:_&&e.availableHeight)}return a}function buildLayoutBoxes(s){const e=wrapBoxes(s),a=sortByWeight(e.filter(b=>b.box.fullSize),!0),o=sortByWeight(filterByPosition(e,"left"),!0),c=sortByWeight(filterByPosition(e,"right")),d=sortByWeight(filterByPosition(e,"top"),!0),h=sortByWeight(filterByPosition(e,"bottom")),g=filterDynamicPositionByAxis(e,"x"),_=filterDynamicPositionByAxis(e,"y");return{fullSize:a,leftAndTop:o.concat(d),rightAndBottom:c.concat(_).concat(h).concat(g),chartArea:filterByPosition(e,"chartArea"),vertical:o.concat(c).concat(_),horizontal:d.concat(h).concat(g)}}function getCombinedMax(s,e,a,o){return Math.max(s[a],e[a])+Math.max(s[o],e[o])}function updateMaxPadding(s,e){s.top=Math.max(s.top,e.top),s.left=Math.max(s.left,e.left),s.bottom=Math.max(s.bottom,e.bottom),s.right=Math.max(s.right,e.right)}function updateDims(s,e,a,o){const{pos:c,box:d}=a,h=s.maxPadding;if(!isObject(c)){a.size&&(s[c]-=a.size);const $=o[a.stack]||{size:0,count:1};$.size=Math.max($.size,a.horizontal?d.height:d.width),a.size=$.size/$.count,s[c]+=a.size}d.getPadding&&updateMaxPadding(h,d.getPadding());const g=Math.max(0,e.outerWidth-getCombinedMax(h,s,"left","right")),_=Math.max(0,e.outerHeight-getCombinedMax(h,s,"top","bottom")),b=g!==s.w,j=_!==s.h;return s.w=g,s.h=_,a.horizontal?{same:b,other:j}:{same:j,other:b}}function handleMaxPadding(s){const e=s.maxPadding;function a(o){const c=Math.max(e[o]-s[o],0);return s[o]+=c,c}s.y+=a("top"),s.x+=a("left"),a("right"),a("bottom")}function getMargins(s,e){const a=e.maxPadding;function o(c){const d={left:0,top:0,right:0,bottom:0};return c.forEach(h=>{d[h]=Math.max(e[h],a[h])}),d}return o(s?["left","right"]:["top","bottom"])}function fitBoxes(s,e,a,o){const c=[];let d,h,g,_,b,j;for(d=0,h=s.length,b=0;d<h;++d){g=s[d],_=g.box,_.update(g.width||e.w,g.height||e.h,getMargins(g.horizontal,e));const{same:$,other:_e}=updateDims(e,a,g,o);b|=$&&c.length,j=j||_e,_.fullSize||c.push(g)}return b&&fitBoxes(c,e,a,o)||j}function setBoxDims(s,e,a,o,c){s.top=a,s.left=e,s.right=e+o,s.bottom=a+c,s.width=o,s.height=c}function placeBoxes(s,e,a,o){const c=a.padding;let{x:d,y:h}=e;for(const g of s){const _=g.box,b=o[g.stack]||{placed:0,weight:1},j=g.stackWeight/b.weight||1;if(g.horizontal){const $=e.w*j,_e=b.size||_.height;defined(b.start)&&(h=b.start),_.fullSize?setBoxDims(_,c.left,h,a.outerWidth-c.right-c.left,_e):setBoxDims(_,e.left+b.placed,h,$,_e),b.start=h,b.placed+=$,h=_.bottom}else{const $=e.h*j,_e=b.size||_.width;defined(b.start)&&(d=b.start),_.fullSize?setBoxDims(_,d,c.top,_e,a.outerHeight-c.bottom-c.top):setBoxDims(_,d,e.top+b.placed,_e,$),b.start=d,b.placed+=$,d=_.right}}e.x=d,e.y=h}var layouts={addBox(s,e){s.boxes||(s.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(a){e.draw(a)}}]},s.boxes.push(e)},removeBox(s,e){const a=s.boxes?s.boxes.indexOf(e):-1;a!==-1&&s.boxes.splice(a,1)},configure(s,e,a){e.fullSize=a.fullSize,e.position=a.position,e.weight=a.weight},update(s,e,a,o){if(!s)return;const c=toPadding(s.options.layout.padding),d=Math.max(e-c.width,0),h=Math.max(a-c.height,0),g=buildLayoutBoxes(s.boxes),_=g.vertical,b=g.horizontal;each(s.boxes,st=>{typeof st.beforeLayout=="function"&&st.beforeLayout()});const j=_.reduce((st,rt)=>rt.box.options&&rt.box.options.display===!1?st:st+1,0)||1,$=Object.freeze({outerWidth:e,outerHeight:a,padding:c,availableWidth:d,availableHeight:h,vBoxMaxWidth:d/2/j,hBoxMaxHeight:h/2}),_e=Object.assign({},c);updateMaxPadding(_e,toPadding(o));const tt=Object.assign({maxPadding:_e,w:d,h,x:c.left,y:c.top},c),et=setLayoutDims(_.concat(b),$);fitBoxes(g.fullSize,tt,$,et),fitBoxes(_,tt,$,et),fitBoxes(b,tt,$,et)&&fitBoxes(_,tt,$,et),handleMaxPadding(tt),placeBoxes(g.leftAndTop,tt,$,et),tt.x+=tt.w,tt.y+=tt.h,placeBoxes(g.rightAndBottom,tt,$,et),s.chartArea={left:tt.left,top:tt.top,right:tt.left+tt.w,bottom:tt.top+tt.h,height:tt.h,width:tt.w},each(g.chartArea,st=>{const rt=st.box;Object.assign(rt,s.chartArea),rt.update(tt.w,tt.h,{left:0,top:0,right:0,bottom:0})})}};class BasePlatform{acquireContext(e,a){}releaseContext(e){return!1}addEventListener(e,a,o){}removeEventListener(e,a,o){}getDevicePixelRatio(){return 1}getMaximumSize(e,a,o,c){return a=Math.max(0,a||e.width),o=o||e.height,{width:a,height:Math.max(0,c?Math.floor(a/c):o)}}isAttached(e){return!0}updateConfig(e){}}class BasicPlatform extends BasePlatform{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const EXPANDO_KEY="$chartjs",EVENT_TYPES={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},isNullOrEmpty=s=>s===null||s==="";function initCanvas(s,e){const a=s.style,o=s.getAttribute("height"),c=s.getAttribute("width");if(s[EXPANDO_KEY]={initial:{height:o,width:c,style:{display:a.display,height:a.height,width:a.width}}},a.display=a.display||"block",a.boxSizing=a.boxSizing||"border-box",isNullOrEmpty(c)){const d=readUsedSize(s,"width");d!==void 0&&(s.width=d)}if(isNullOrEmpty(o))if(s.style.height==="")s.height=s.width/(e||2);else{const d=readUsedSize(s,"height");d!==void 0&&(s.height=d)}return s}const eventListenerOptions=supportsEventListenerOptions?{passive:!0}:!1;function addListener(s,e,a){s&&s.addEventListener(e,a,eventListenerOptions)}function removeListener(s,e,a){s&&s.canvas&&s.canvas.removeEventListener(e,a,eventListenerOptions)}function fromNativeEvent(s,e){const a=EVENT_TYPES[s.type]||s.type,{x:o,y:c}=getRelativePosition(s,e);return{type:a,chart:e,native:s,x:o!==void 0?o:null,y:c!==void 0?c:null}}function nodeListContains(s,e){for(const a of s)if(a===e||a.contains(e))return!0}function createAttachObserver(s,e,a){const o=s.canvas,c=new MutationObserver(d=>{let h=!1;for(const g of d)h=h||nodeListContains(g.addedNodes,o),h=h&&!nodeListContains(g.removedNodes,o);h&&a()});return c.observe(document,{childList:!0,subtree:!0}),c}function createDetachObserver(s,e,a){const o=s.canvas,c=new MutationObserver(d=>{let h=!1;for(const g of d)h=h||nodeListContains(g.removedNodes,o),h=h&&!nodeListContains(g.addedNodes,o);h&&a()});return c.observe(document,{childList:!0,subtree:!0}),c}const drpListeningCharts=new Map;let oldDevicePixelRatio=0;function onWindowResize(){const s=window.devicePixelRatio;s!==oldDevicePixelRatio&&(oldDevicePixelRatio=s,drpListeningCharts.forEach((e,a)=>{a.currentDevicePixelRatio!==s&&e()}))}function listenDevicePixelRatioChanges(s,e){drpListeningCharts.size||window.addEventListener("resize",onWindowResize),drpListeningCharts.set(s,e)}function unlistenDevicePixelRatioChanges(s){drpListeningCharts.delete(s),drpListeningCharts.size||window.removeEventListener("resize",onWindowResize)}function createResizeObserver(s,e,a){const o=s.canvas,c=o&&_getParentNode(o);if(!c)return;const d=throttled((g,_)=>{const b=c.clientWidth;a(g,_),b<c.clientWidth&&a()},window),h=new ResizeObserver(g=>{const _=g[0],b=_.contentRect.width,j=_.contentRect.height;b===0&&j===0||d(b,j)});return h.observe(c),listenDevicePixelRatioChanges(s,d),h}function releaseObserver(s,e,a){a&&a.disconnect(),e==="resize"&&unlistenDevicePixelRatioChanges(s)}function createProxyAndListen(s,e,a){const o=s.canvas,c=throttled(d=>{s.ctx!==null&&a(fromNativeEvent(d,s))},s);return addListener(o,e,c),c}class DomPlatform extends BasePlatform{acquireContext(e,a){const o=e&&e.getContext&&e.getContext("2d");return o&&o.canvas===e?(initCanvas(e,a),o):null}releaseContext(e){const a=e.canvas;if(!a[EXPANDO_KEY])return!1;const o=a[EXPANDO_KEY].initial;["height","width"].forEach(d=>{const h=o[d];isNullOrUndef(h)?a.removeAttribute(d):a.setAttribute(d,h)});const c=o.style||{};return Object.keys(c).forEach(d=>{a.style[d]=c[d]}),a.width=a.width,delete a[EXPANDO_KEY],!0}addEventListener(e,a,o){this.removeEventListener(e,a);const c=e.$proxies||(e.$proxies={}),h={attach:createAttachObserver,detach:createDetachObserver,resize:createResizeObserver}[a]||createProxyAndListen;c[a]=h(e,a,o)}removeEventListener(e,a){const o=e.$proxies||(e.$proxies={}),c=o[a];if(!c)return;({attach:releaseObserver,detach:releaseObserver,resize:releaseObserver}[a]||removeListener)(e,a,c),o[a]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,a,o,c){return getMaximumSize(e,a,o,c)}isAttached(e){const a=e&&_getParentNode(e);return!!(a&&a.isConnected)}}function _detectPlatform(s){return!_isDomSupported()||typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas?BasicPlatform:DomPlatform}class Element{constructor(){Sn(this,"x");Sn(this,"y");Sn(this,"active",!1);Sn(this,"options");Sn(this,"$animations")}tooltipPosition(e){const{x:a,y:o}=this.getProps(["x","y"],e);return{x:a,y:o}}hasValue(){return isNumber(this.x)&&isNumber(this.y)}getProps(e,a){const o=this.$animations;if(!a||!o)return this;const c={};return e.forEach(d=>{c[d]=o[d]&&o[d].active()?o[d]._to:this[d]}),c}}Sn(Element,"defaults",{}),Sn(Element,"defaultRoutes");function autoSkip(s,e){const a=s.options.ticks,o=determineMaxTicks(s),c=Math.min(a.maxTicksLimit||o,o),d=a.major.enabled?getMajorIndices(e):[],h=d.length,g=d[0],_=d[h-1],b=[];if(h>c)return skipMajors(e,b,d,h/c),b;const j=calculateSpacing(d,e,c);if(h>0){let $,_e;const tt=h>1?Math.round((_-g)/(h-1)):null;for(skip(e,b,j,isNullOrUndef(tt)?0:g-tt,g),$=0,_e=h-1;$<_e;$++)skip(e,b,j,d[$],d[$+1]);return skip(e,b,j,_,isNullOrUndef(tt)?e.length:_+tt),b}return skip(e,b,j),b}function determineMaxTicks(s){const e=s.options.offset,a=s._tickSize(),o=s._length/a+(e?0:1),c=s._maxLength/a;return Math.floor(Math.min(o,c))}function calculateSpacing(s,e,a){const o=getEvenSpacing(s),c=e.length/a;if(!o)return Math.max(c,1);const d=_factorize(o);for(let h=0,g=d.length-1;h<g;h++){const _=d[h];if(_>c)return _}return Math.max(c,1)}function getMajorIndices(s){const e=[];let a,o;for(a=0,o=s.length;a<o;a++)s[a].major&&e.push(a);return e}function skipMajors(s,e,a,o){let c=0,d=a[0],h;for(o=Math.ceil(o),h=0;h<s.length;h++)h===d&&(e.push(s[h]),c++,d=a[c*o])}function skip(s,e,a,o,c){const d=valueOrDefault(o,0),h=Math.min(valueOrDefault(c,s.length),s.length);let g=0,_,b,j;for(a=Math.ceil(a),c&&(_=c-o,a=_/Math.floor(_/a)),j=d;j<0;)g++,j=Math.round(d+g*a);for(b=Math.max(d,0);b<h;b++)b===j&&(e.push(s[b]),g++,j=Math.round(d+g*a))}function getEvenSpacing(s){const e=s.length;let a,o;if(e<2)return!1;for(o=s[0],a=1;a<e;++a)if(s[a]-s[a-1]!==o)return!1;return o}const reverseAlign=s=>s==="left"?"right":s==="right"?"left":s,offsetFromEdge=(s,e,a)=>e==="top"||e==="left"?s[e]+a:s[e]-a,getTicksLimit=(s,e)=>Math.min(e||s,s);function sample(s,e){const a=[],o=s.length/e,c=s.length;let d=0;for(;d<c;d+=o)a.push(s[Math.floor(d)]);return a}function getPixelForGridLine(s,e,a){const o=s.ticks.length,c=Math.min(e,o-1),d=s._startPixel,h=s._endPixel,g=1e-6;let _=s.getPixelForTick(c),b;if(!(a&&(o===1?b=Math.max(_-d,h-_):e===0?b=(s.getPixelForTick(1)-_)/2:b=(_-s.getPixelForTick(c-1))/2,_+=c<e?b:-b,_<d-g||_>h+g)))return _}function garbageCollect(s,e){each(s,a=>{const o=a.gc,c=o.length/2;let d;if(c>e){for(d=0;d<c;++d)delete a.data[o[d]];o.splice(0,c)}})}function getTickMarkLength(s){return s.drawTicks?s.tickLength:0}function getTitleHeight(s,e){if(!s.display)return 0;const a=toFont(s.font,e),o=toPadding(s.padding);return(isArray(s.text)?s.text.length:1)*a.lineHeight+o.height}function createScaleContext(s,e){return createContext(s,{scale:e,type:"scale"})}function createTickContext(s,e,a){return createContext(s,{tick:a,index:e,type:"tick"})}function titleAlign(s,e,a){let o=_toLeftRightCenter(s);return(a&&e!=="right"||!a&&e==="right")&&(o=reverseAlign(o)),o}function titleArgs(s,e,a,o){const{top:c,left:d,bottom:h,right:g,chart:_}=s,{chartArea:b,scales:j}=_;let $=0,_e,tt,et;const st=h-c,rt=g-d;if(s.isHorizontal()){if(tt=_alignStartEnd(o,d,g),isObject(a)){const nt=Object.keys(a)[0],it=a[nt];et=j[nt].getPixelForValue(it)+st-e}else a==="center"?et=(b.bottom+b.top)/2+st-e:et=offsetFromEdge(s,a,e);_e=g-d}else{if(isObject(a)){const nt=Object.keys(a)[0],it=a[nt];tt=j[nt].getPixelForValue(it)-rt+e}else a==="center"?tt=(b.left+b.right)/2-rt+e:tt=offsetFromEdge(s,a,e);et=_alignStartEnd(o,h,c),$=a==="left"?-HALF_PI:HALF_PI}return{titleX:tt,titleY:et,maxWidth:_e,rotation:$}}class Scale extends Element{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,a){return e}getUserBounds(){let{_userMin:e,_userMax:a,_suggestedMin:o,_suggestedMax:c}=this;return e=finiteOrDefault(e,Number.POSITIVE_INFINITY),a=finiteOrDefault(a,Number.NEGATIVE_INFINITY),o=finiteOrDefault(o,Number.POSITIVE_INFINITY),c=finiteOrDefault(c,Number.NEGATIVE_INFINITY),{min:finiteOrDefault(e,o),max:finiteOrDefault(a,c),minDefined:isNumberFinite(e),maxDefined:isNumberFinite(a)}}getMinMax(e){let{min:a,max:o,minDefined:c,maxDefined:d}=this.getUserBounds(),h;if(c&&d)return{min:a,max:o};const g=this.getMatchingVisibleMetas();for(let _=0,b=g.length;_<b;++_)h=g[_].controller.getMinMax(this,e),c||(a=Math.min(a,h.min)),d||(o=Math.max(o,h.max));return a=d&&a>o?o:a,o=c&&a>o?a:o,{min:finiteOrDefault(a,finiteOrDefault(o,a)),max:finiteOrDefault(o,finiteOrDefault(a,o))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){callback(this.options.beforeUpdate,[this])}update(e,a,o){const{beginAtZero:c,grace:d,ticks:h}=this.options,g=h.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=a,this._margins=o=Object.assign({left:0,right:0,top:0,bottom:0},o),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+o.left+o.right:this.height+o.top+o.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=_addGrace(this,d,c),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const _=g<this.ticks.length;this._convertTicksToLabels(_?sample(this.ticks,g):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),h.display&&(h.autoSkip||h.source==="auto")&&(this.ticks=autoSkip(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),_&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,a,o;this.isHorizontal()?(a=this.left,o=this.right):(a=this.top,o=this.bottom,e=!e),this._startPixel=a,this._endPixel=o,this._reversePixels=e,this._length=o-a,this._alignToPixels=this.options.alignToPixels}afterUpdate(){callback(this.options.afterUpdate,[this])}beforeSetDimensions(){callback(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){callback(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),callback(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){callback(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const a=this.options.ticks;let o,c,d;for(o=0,c=e.length;o<c;o++)d=e[o],d.label=callback(a.callback,[d.value,o,e],this)}afterTickToLabelConversion(){callback(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){callback(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,a=e.ticks,o=getTicksLimit(this.ticks.length,e.ticks.maxTicksLimit),c=a.minRotation||0,d=a.maxRotation;let h=c,g,_,b;if(!this._isVisible()||!a.display||c>=d||o<=1||!this.isHorizontal()){this.labelRotation=c;return}const j=this._getLabelSizes(),$=j.widest.width,_e=j.highest.height,tt=_limitValue(this.chart.width-$,0,this.maxWidth);g=e.offset?this.maxWidth/o:tt/(o-1),$+6>g&&(g=tt/(o-(e.offset?.5:1)),_=this.maxHeight-getTickMarkLength(e.grid)-a.padding-getTitleHeight(e.title,this.chart.options.font),b=Math.sqrt($*$+_e*_e),h=toDegrees(Math.min(Math.asin(_limitValue((j.highest.height+6)/g,-1,1)),Math.asin(_limitValue(_/b,-1,1))-Math.asin(_limitValue(_e/b,-1,1)))),h=Math.max(c,Math.min(d,h))),this.labelRotation=h}afterCalculateLabelRotation(){callback(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){callback(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:a,options:{ticks:o,title:c,grid:d}}=this,h=this._isVisible(),g=this.isHorizontal();if(h){const _=getTitleHeight(c,a.options.font);if(g?(e.width=this.maxWidth,e.height=getTickMarkLength(d)+_):(e.height=this.maxHeight,e.width=getTickMarkLength(d)+_),o.display&&this.ticks.length){const{first:b,last:j,widest:$,highest:_e}=this._getLabelSizes(),tt=o.padding*2,et=toRadians(this.labelRotation),st=Math.cos(et),rt=Math.sin(et);if(g){const nt=o.mirror?0:rt*$.width+st*_e.height;e.height=Math.min(this.maxHeight,e.height+nt+tt)}else{const nt=o.mirror?0:st*$.width+rt*_e.height;e.width=Math.min(this.maxWidth,e.width+nt+tt)}this._calculatePadding(b,j,rt,st)}}this._handleMargins(),g?(this.width=this._length=a.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=a.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,a,o,c){const{ticks:{align:d,padding:h},position:g}=this.options,_=this.labelRotation!==0,b=g!=="top"&&this.axis==="x";if(this.isHorizontal()){const j=this.getPixelForTick(0)-this.left,$=this.right-this.getPixelForTick(this.ticks.length-1);let _e=0,tt=0;_?b?(_e=c*e.width,tt=o*a.height):(_e=o*e.height,tt=c*a.width):d==="start"?tt=a.width:d==="end"?_e=e.width:d!=="inner"&&(_e=e.width/2,tt=a.width/2),this.paddingLeft=Math.max((_e-j+h)*this.width/(this.width-j),0),this.paddingRight=Math.max((tt-$+h)*this.width/(this.width-$),0)}else{let j=a.height/2,$=e.height/2;d==="start"?(j=0,$=e.height):d==="end"&&(j=a.height,$=0),this.paddingTop=j+h,this.paddingBottom=$+h}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){callback(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:a}=this.options;return a==="top"||a==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let a,o;for(a=0,o=e.length;a<o;a++)isNullOrUndef(e[a].label)&&(e.splice(a,1),o--,a--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const a=this.options.ticks.sampleSize;let o=this.ticks;a<o.length&&(o=sample(o,a)),this._labelSizes=e=this._computeLabelSizes(o,o.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,a,o){const{ctx:c,_longestTextCache:d}=this,h=[],g=[],_=Math.floor(a/getTicksLimit(a,o));let b=0,j=0,$,_e,tt,et,st,rt,nt,it,at,dt,ot;for($=0;$<a;$+=_){if(et=e[$].label,st=this._resolveTickFontOptions($),c.font=rt=st.string,nt=d[rt]=d[rt]||{data:{},gc:[]},it=st.lineHeight,at=dt=0,!isNullOrUndef(et)&&!isArray(et))at=_measureText(c,nt.data,nt.gc,at,et),dt=it;else if(isArray(et))for(_e=0,tt=et.length;_e<tt;++_e)ot=et[_e],!isNullOrUndef(ot)&&!isArray(ot)&&(at=_measureText(c,nt.data,nt.gc,at,ot),dt+=it);h.push(at),g.push(dt),b=Math.max(at,b),j=Math.max(dt,j)}garbageCollect(d,a);const ht=h.indexOf(b),ut=g.indexOf(j),pt=_t=>({width:h[_t]||0,height:g[_t]||0});return{first:pt(0),last:pt(a-1),widest:pt(ht),highest:pt(ut),widths:h,heights:g}}getLabelForValue(e){return e}getPixelForValue(e,a){return NaN}getValueForPixel(e){}getPixelForTick(e){const a=this.ticks;return e<0||e>a.length-1?null:this.getPixelForValue(a[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const a=this._startPixel+e*this._length;return _int16Range(this._alignToPixels?_alignPixel(this.chart,a,0):a)}getDecimalForPixel(e){const a=(e-this._startPixel)/this._length;return this._reversePixels?1-a:a}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:a}=this;return e<0&&a<0?a:e>0&&a>0?e:0}getContext(e){const a=this.ticks||[];if(e>=0&&e<a.length){const o=a[e];return o.$context||(o.$context=createTickContext(this.getContext(),e,o))}return this.$context||(this.$context=createScaleContext(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,a=toRadians(this.labelRotation),o=Math.abs(Math.cos(a)),c=Math.abs(Math.sin(a)),d=this._getLabelSizes(),h=e.autoSkipPadding||0,g=d?d.widest.width+h:0,_=d?d.highest.height+h:0;return this.isHorizontal()?_*o>g*c?g/o:_/c:_*c<g*o?_/o:g/c}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const a=this.axis,o=this.chart,c=this.options,{grid:d,position:h,border:g}=c,_=d.offset,b=this.isHorizontal(),$=this.ticks.length+(_?1:0),_e=getTickMarkLength(d),tt=[],et=g.setContext(this.getContext()),st=et.display?et.width:0,rt=st/2,nt=function(Ot){return _alignPixel(o,Ot,st)};let it,at,dt,ot,ht,ut,pt,_t,wt,mt,Et,Pt;if(h==="top")it=nt(this.bottom),ut=this.bottom-_e,_t=it-rt,mt=nt(e.top)+rt,Pt=e.bottom;else if(h==="bottom")it=nt(this.top),mt=e.top,Pt=nt(e.bottom)-rt,ut=it+rt,_t=this.top+_e;else if(h==="left")it=nt(this.right),ht=this.right-_e,pt=it-rt,wt=nt(e.left)+rt,Et=e.right;else if(h==="right")it=nt(this.left),wt=e.left,Et=nt(e.right)-rt,ht=it+rt,pt=this.left+_e;else if(a==="x"){if(h==="center")it=nt((e.top+e.bottom)/2+.5);else if(isObject(h)){const Ot=Object.keys(h)[0],Ct=h[Ot];it=nt(this.chart.scales[Ot].getPixelForValue(Ct))}mt=e.top,Pt=e.bottom,ut=it+rt,_t=ut+_e}else if(a==="y"){if(h==="center")it=nt((e.left+e.right)/2);else if(isObject(h)){const Ot=Object.keys(h)[0],Ct=h[Ot];it=nt(this.chart.scales[Ot].getPixelForValue(Ct))}ht=it-rt,pt=ht-_e,wt=e.left,Et=e.right}const jt=valueOrDefault(c.ticks.maxTicksLimit,$),St=Math.max(1,Math.ceil($/jt));for(at=0;at<$;at+=St){const Ot=this.getContext(at),Ct=d.setContext(Ot),Rt=g.setContext(Ot),bt=Ct.lineWidth,Tt=Ct.color,$t=Rt.dash||[],xt=Rt.dashOffset,ft=Ct.tickWidth,yt=Ct.tickColor,vt=Ct.tickBorderDash||[],It=Ct.tickBorderDashOffset;dt=getPixelForGridLine(this,at,_),dt!==void 0&&(ot=_alignPixel(o,dt,bt),b?ht=pt=wt=Et=ot:ut=_t=mt=Pt=ot,tt.push({tx1:ht,ty1:ut,tx2:pt,ty2:_t,x1:wt,y1:mt,x2:Et,y2:Pt,width:bt,color:Tt,borderDash:$t,borderDashOffset:xt,tickWidth:ft,tickColor:yt,tickBorderDash:vt,tickBorderDashOffset:It}))}return this._ticksLength=$,this._borderValue=it,tt}_computeLabelItems(e){const a=this.axis,o=this.options,{position:c,ticks:d}=o,h=this.isHorizontal(),g=this.ticks,{align:_,crossAlign:b,padding:j,mirror:$}=d,_e=getTickMarkLength(o.grid),tt=_e+j,et=$?-j:tt,st=-toRadians(this.labelRotation),rt=[];let nt,it,at,dt,ot,ht,ut,pt,_t,wt,mt,Et,Pt="middle";if(c==="top")ht=this.bottom-et,ut=this._getXAxisLabelAlignment();else if(c==="bottom")ht=this.top+et,ut=this._getXAxisLabelAlignment();else if(c==="left"){const St=this._getYAxisLabelAlignment(_e);ut=St.textAlign,ot=St.x}else if(c==="right"){const St=this._getYAxisLabelAlignment(_e);ut=St.textAlign,ot=St.x}else if(a==="x"){if(c==="center")ht=(e.top+e.bottom)/2+tt;else if(isObject(c)){const St=Object.keys(c)[0],Ot=c[St];ht=this.chart.scales[St].getPixelForValue(Ot)+tt}ut=this._getXAxisLabelAlignment()}else if(a==="y"){if(c==="center")ot=(e.left+e.right)/2-tt;else if(isObject(c)){const St=Object.keys(c)[0],Ot=c[St];ot=this.chart.scales[St].getPixelForValue(Ot)}ut=this._getYAxisLabelAlignment(_e).textAlign}a==="y"&&(_==="start"?Pt="top":_==="end"&&(Pt="bottom"));const jt=this._getLabelSizes();for(nt=0,it=g.length;nt<it;++nt){at=g[nt],dt=at.label;const St=d.setContext(this.getContext(nt));pt=this.getPixelForTick(nt)+d.labelOffset,_t=this._resolveTickFontOptions(nt),wt=_t.lineHeight,mt=isArray(dt)?dt.length:1;const Ot=mt/2,Ct=St.color,Rt=St.textStrokeColor,bt=St.textStrokeWidth;let Tt=ut;h?(ot=pt,ut==="inner"&&(nt===it-1?Tt=this.options.reverse?"left":"right":nt===0?Tt=this.options.reverse?"right":"left":Tt="center"),c==="top"?b==="near"||st!==0?Et=-mt*wt+wt/2:b==="center"?Et=-jt.highest.height/2-Ot*wt+wt:Et=-jt.highest.height+wt/2:b==="near"||st!==0?Et=wt/2:b==="center"?Et=jt.highest.height/2-Ot*wt:Et=jt.highest.height-mt*wt,$&&(Et*=-1),st!==0&&!St.showLabelBackdrop&&(ot+=wt/2*Math.sin(st))):(ht=pt,Et=(1-mt)*wt/2);let $t;if(St.showLabelBackdrop){const xt=toPadding(St.backdropPadding),ft=jt.heights[nt],yt=jt.widths[nt];let vt=Et-xt.top,It=0-xt.left;switch(Pt){case"middle":vt-=ft/2;break;case"bottom":vt-=ft;break}switch(ut){case"center":It-=yt/2;break;case"right":It-=yt;break;case"inner":nt===it-1?It-=yt:nt>0&&(It-=yt/2);break}$t={left:It,top:vt,width:yt+xt.width,height:ft+xt.height,color:St.backdropColor}}rt.push({label:dt,font:_t,textOffset:Et,options:{rotation:st,color:Ct,strokeColor:Rt,strokeWidth:bt,textAlign:Tt,textBaseline:Pt,translation:[ot,ht],backdrop:$t}})}return rt}_getXAxisLabelAlignment(){const{position:e,ticks:a}=this.options;if(-toRadians(this.labelRotation))return e==="top"?"left":"right";let c="center";return a.align==="start"?c="left":a.align==="end"?c="right":a.align==="inner"&&(c="inner"),c}_getYAxisLabelAlignment(e){const{position:a,ticks:{crossAlign:o,mirror:c,padding:d}}=this.options,h=this._getLabelSizes(),g=e+d,_=h.widest.width;let b,j;return a==="left"?c?(j=this.right+d,o==="near"?b="left":o==="center"?(b="center",j+=_/2):(b="right",j+=_)):(j=this.right-g,o==="near"?b="right":o==="center"?(b="center",j-=_/2):(b="left",j=this.left)):a==="right"?c?(j=this.left+d,o==="near"?b="right":o==="center"?(b="center",j-=_/2):(b="left",j-=_)):(j=this.left+g,o==="near"?b="left":o==="center"?(b="center",j+=_/2):(b="right",j=this.right)):b="right",{textAlign:b,x:j}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,a=this.options.position;if(a==="left"||a==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(a==="top"||a==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:a},left:o,top:c,width:d,height:h}=this;a&&(e.save(),e.fillStyle=a,e.fillRect(o,c,d,h),e.restore())}getLineWidthForValue(e){const a=this.options.grid;if(!this._isVisible()||!a.display)return 0;const c=this.ticks.findIndex(d=>d.value===e);return c>=0?a.setContext(this.getContext(c)).lineWidth:0}drawGrid(e){const a=this.options.grid,o=this.ctx,c=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let d,h;const g=(_,b,j)=>{!j.width||!j.color||(o.save(),o.lineWidth=j.width,o.strokeStyle=j.color,o.setLineDash(j.borderDash||[]),o.lineDashOffset=j.borderDashOffset,o.beginPath(),o.moveTo(_.x,_.y),o.lineTo(b.x,b.y),o.stroke(),o.restore())};if(a.display)for(d=0,h=c.length;d<h;++d){const _=c[d];a.drawOnChartArea&&g({x:_.x1,y:_.y1},{x:_.x2,y:_.y2},_),a.drawTicks&&g({x:_.tx1,y:_.ty1},{x:_.tx2,y:_.ty2},{color:_.tickColor,width:_.tickWidth,borderDash:_.tickBorderDash,borderDashOffset:_.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:a,options:{border:o,grid:c}}=this,d=o.setContext(this.getContext()),h=o.display?d.width:0;if(!h)return;const g=c.setContext(this.getContext(0)).lineWidth,_=this._borderValue;let b,j,$,_e;this.isHorizontal()?(b=_alignPixel(e,this.left,h)-h/2,j=_alignPixel(e,this.right,g)+g/2,$=_e=_):($=_alignPixel(e,this.top,h)-h/2,_e=_alignPixel(e,this.bottom,g)+g/2,b=j=_),a.save(),a.lineWidth=d.width,a.strokeStyle=d.color,a.beginPath(),a.moveTo(b,$),a.lineTo(j,_e),a.stroke(),a.restore()}drawLabels(e){if(!this.options.ticks.display)return;const o=this.ctx,c=this._computeLabelArea();c&&clipArea(o,c);const d=this.getLabelItems(e);for(const h of d){const g=h.options,_=h.font,b=h.label,j=h.textOffset;renderText(o,b,0,j,_,g)}c&&unclipArea(o)}drawTitle(){const{ctx:e,options:{position:a,title:o,reverse:c}}=this;if(!o.display)return;const d=toFont(o.font),h=toPadding(o.padding),g=o.align;let _=d.lineHeight/2;a==="bottom"||a==="center"||isObject(a)?(_+=h.bottom,isArray(o.text)&&(_+=d.lineHeight*(o.text.length-1))):_+=h.top;const{titleX:b,titleY:j,maxWidth:$,rotation:_e}=titleArgs(this,_,a,g);renderText(e,o.text,0,0,d,{color:o.color,maxWidth:$,rotation:_e,textAlign:titleAlign(g,a,c),textBaseline:"middle",translation:[b,j]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,a=e.ticks&&e.ticks.z||0,o=valueOrDefault(e.grid&&e.grid.z,-1),c=valueOrDefault(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Scale.prototype.draw?[{z:a,draw:d=>{this.draw(d)}}]:[{z:o,draw:d=>{this.drawBackground(),this.drawGrid(d),this.drawTitle()}},{z:c,draw:()=>{this.drawBorder()}},{z:a,draw:d=>{this.drawLabels(d)}}]}getMatchingVisibleMetas(e){const a=this.chart.getSortedVisibleDatasetMetas(),o=this.axis+"AxisID",c=[];let d,h;for(d=0,h=a.length;d<h;++d){const g=a[d];g[o]===this.id&&(!e||g.type===e)&&c.push(g)}return c}_resolveTickFontOptions(e){const a=this.options.ticks.setContext(this.getContext(e));return toFont(a.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class TypedRegistry{constructor(e,a,o){this.type=e,this.scope=a,this.override=o,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const a=Object.getPrototypeOf(e);let o;isIChartComponent(a)&&(o=this.register(a));const c=this.items,d=e.id,h=this.scope+"."+d;if(!d)throw new Error("class does not have id: "+e);return d in c||(c[d]=e,registerDefaults(e,h,o),this.override&&defaults.override(e.id,e.overrides)),h}get(e){return this.items[e]}unregister(e){const a=this.items,o=e.id,c=this.scope;o in a&&delete a[o],c&&o in defaults[c]&&(delete defaults[c][o],this.override&&delete overrides[o])}}function registerDefaults(s,e,a){const o=merge(Object.create(null),[a?defaults.get(a):{},defaults.get(e),s.defaults]);defaults.set(e,o),s.defaultRoutes&&routeDefaults(e,s.defaultRoutes),s.descriptors&&defaults.describe(e,s.descriptors)}function routeDefaults(s,e){Object.keys(e).forEach(a=>{const o=a.split("."),c=o.pop(),d=[s].concat(o).join("."),h=e[a].split("."),g=h.pop(),_=h.join(".");defaults.route(d,c,_,g)})}function isIChartComponent(s){return"id"in s&&"defaults"in s}class Registry{constructor(){this.controllers=new TypedRegistry(DatasetController,"datasets",!0),this.elements=new TypedRegistry(Element,"elements"),this.plugins=new TypedRegistry(Object,"plugins"),this.scales=new TypedRegistry(Scale,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,a,o){[...a].forEach(c=>{const d=o||this._getRegistryForType(c);o||d.isForType(c)||d===this.plugins&&c.id?this._exec(e,d,c):each(c,h=>{const g=o||this._getRegistryForType(h);this._exec(e,g,h)})})}_exec(e,a,o){const c=_capitalize(e);callback(o["before"+c],[],o),a[e](o),callback(o["after"+c],[],o)}_getRegistryForType(e){for(let a=0;a<this._typedRegistries.length;a++){const o=this._typedRegistries[a];if(o.isForType(e))return o}return this.plugins}_get(e,a,o){const c=a.get(e);if(c===void 0)throw new Error('"'+e+'" is not a registered '+o+".");return c}}var registry=new Registry;class PluginService{constructor(){this._init=[]}notify(e,a,o,c){a==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const d=c?this._descriptors(e).filter(c):this._descriptors(e),h=this._notify(d,e,a,o);return a==="afterDestroy"&&(this._notify(d,e,"stop"),this._notify(this._init,e,"uninstall")),h}_notify(e,a,o,c){c=c||{};for(const d of e){const h=d.plugin,g=h[o],_=[a,c,d.options];if(callback(g,_,h)===!1&&c.cancelable)return!1}return!0}invalidate(){isNullOrUndef(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const a=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),a}_createDescriptors(e,a){const o=e&&e.config,c=valueOrDefault(o.options&&o.options.plugins,{}),d=allPlugins(o);return c===!1&&!a?[]:createDescriptors(e,d,c,a)}_notifyStateChanges(e){const a=this._oldCache||[],o=this._cache,c=(d,h)=>d.filter(g=>!h.some(_=>g.plugin.id===_.plugin.id));this._notify(c(a,o),e,"stop"),this._notify(c(o,a),e,"start")}}function allPlugins(s){const e={},a=[],o=Object.keys(registry.plugins.items);for(let d=0;d<o.length;d++)a.push(registry.getPlugin(o[d]));const c=s.plugins||[];for(let d=0;d<c.length;d++){const h=c[d];a.indexOf(h)===-1&&(a.push(h),e[h.id]=!0)}return{plugins:a,localIds:e}}function getOpts(s,e){return!e&&s===!1?null:s===!0?{}:s}function createDescriptors(s,{plugins:e,localIds:a},o,c){const d=[],h=s.getContext();for(const g of e){const _=g.id,b=getOpts(o[_],c);b!==null&&d.push({plugin:g,options:pluginOpts(s.config,{plugin:g,local:a[_]},b,h)})}return d}function pluginOpts(s,{plugin:e,local:a},o,c){const d=s.pluginScopeKeys(e),h=s.getOptionScopes(o,d);return a&&e.defaults&&h.push(e.defaults),s.createResolver(h,c,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function getIndexAxis(s,e){const a=defaults.datasets[s]||{};return((e.datasets||{})[s]||{}).indexAxis||e.indexAxis||a.indexAxis||"x"}function getAxisFromDefaultScaleID(s,e){let a=s;return s==="_index_"?a=e:s==="_value_"&&(a=e==="x"?"y":"x"),a}function getDefaultScaleIDFromAxis(s,e){return s===e?"_index_":"_value_"}function idMatchesAxis(s){if(s==="x"||s==="y"||s==="r")return s}function axisFromPosition(s){if(s==="top"||s==="bottom")return"x";if(s==="left"||s==="right")return"y"}function determineAxis(s,...e){if(idMatchesAxis(s))return s;for(const a of e){const o=a.axis||axisFromPosition(a.position)||s.length>1&&idMatchesAxis(s[0].toLowerCase());if(o)return o}throw new Error(`Cannot determine type of '${s}' axis. Please provide 'axis' or 'position' option.`)}function getAxisFromDataset(s,e,a){if(a[e+"AxisID"]===s)return{axis:e}}function retrieveAxisFromDatasets(s,e){if(e.data&&e.data.datasets){const a=e.data.datasets.filter(o=>o.xAxisID===s||o.yAxisID===s);if(a.length)return getAxisFromDataset(s,"x",a[0])||getAxisFromDataset(s,"y",a[0])}return{}}function mergeScaleConfig(s,e){const a=overrides[s.type]||{scales:{}},o=e.scales||{},c=getIndexAxis(s.type,e),d=Object.create(null);return Object.keys(o).forEach(h=>{const g=o[h];if(!isObject(g))return console.error(`Invalid scale configuration for scale: ${h}`);if(g._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${h}`);const _=determineAxis(h,g,retrieveAxisFromDatasets(h,s),defaults.scales[g.type]),b=getDefaultScaleIDFromAxis(_,c),j=a.scales||{};d[h]=mergeIf(Object.create(null),[{axis:_},g,j[_],j[b]])}),s.data.datasets.forEach(h=>{const g=h.type||s.type,_=h.indexAxis||getIndexAxis(g,e),j=(overrides[g]||{}).scales||{};Object.keys(j).forEach($=>{const _e=getAxisFromDefaultScaleID($,_),tt=h[_e+"AxisID"]||_e;d[tt]=d[tt]||Object.create(null),mergeIf(d[tt],[{axis:_e},o[tt],j[$]])})}),Object.keys(d).forEach(h=>{const g=d[h];mergeIf(g,[defaults.scales[g.type],defaults.scale])}),d}function initOptions(s){const e=s.options||(s.options={});e.plugins=valueOrDefault(e.plugins,{}),e.scales=mergeScaleConfig(s,e)}function initData(s){return s=s||{},s.datasets=s.datasets||[],s.labels=s.labels||[],s}function initConfig(s){return s=s||{},s.data=initData(s.data),initOptions(s),s}const keyCache=new Map,keysCached=new Set;function cachedKeys(s,e){let a=keyCache.get(s);return a||(a=e(),keyCache.set(s,a),keysCached.add(a)),a}const addIfFound=(s,e,a)=>{const o=resolveObjectKey(e,a);o!==void 0&&s.add(o)};class Config{constructor(e){this._config=initConfig(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=initData(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),initOptions(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return cachedKeys(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,a){return cachedKeys(`${e}.transition.${a}`,()=>[[`datasets.${e}.transitions.${a}`,`transitions.${a}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,a){return cachedKeys(`${e}-${a}`,()=>[[`datasets.${e}.elements.${a}`,`datasets.${e}`,`elements.${a}`,""]])}pluginScopeKeys(e){const a=e.id,o=this.type;return cachedKeys(`${o}-plugin-${a}`,()=>[[`plugins.${a}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,a){const o=this._scopeCache;let c=o.get(e);return(!c||a)&&(c=new Map,o.set(e,c)),c}getOptionScopes(e,a,o){const{options:c,type:d}=this,h=this._cachedScopes(e,o),g=h.get(a);if(g)return g;const _=new Set;a.forEach(j=>{e&&(_.add(e),j.forEach($=>addIfFound(_,e,$))),j.forEach($=>addIfFound(_,c,$)),j.forEach($=>addIfFound(_,overrides[d]||{},$)),j.forEach($=>addIfFound(_,defaults,$)),j.forEach($=>addIfFound(_,descriptors,$))});const b=Array.from(_);return b.length===0&&b.push(Object.create(null)),keysCached.has(a)&&h.set(a,b),b}chartOptionScopes(){const{options:e,type:a}=this;return[e,overrides[a]||{},defaults.datasets[a]||{},{type:a},defaults,descriptors]}resolveNamedOptions(e,a,o,c=[""]){const d={$shared:!0},{resolver:h,subPrefixes:g}=getResolver(this._resolverCache,e,c);let _=h;if(needContext(h,a)){d.$shared=!1,o=isFunction(o)?o():o;const b=this.createResolver(e,o,g);_=_attachContext(h,o,b)}for(const b of a)d[b]=_[b];return d}createResolver(e,a,o=[""],c){const{resolver:d}=getResolver(this._resolverCache,e,o);return isObject(a)?_attachContext(d,a,void 0,c):d}}function getResolver(s,e,a){let o=s.get(e);o||(o=new Map,s.set(e,o));const c=a.join();let d=o.get(c);return d||(d={resolver:_createResolver(e,a),subPrefixes:a.filter(g=>!g.toLowerCase().includes("hover"))},o.set(c,d)),d}const hasFunction=s=>isObject(s)&&Object.getOwnPropertyNames(s).some(e=>isFunction(s[e]));function needContext(s,e){const{isScriptable:a,isIndexable:o}=_descriptors(s);for(const c of e){const d=a(c),h=o(c),g=(h||d)&&s[c];if(d&&(isFunction(g)||hasFunction(g))||h&&isArray(g))return!0}return!1}var version="4.4.7";const KNOWN_POSITIONS=["top","bottom","left","right","chartArea"];function positionIsHorizontal(s,e){return s==="top"||s==="bottom"||KNOWN_POSITIONS.indexOf(s)===-1&&e==="x"}function compare2Level(s,e){return function(a,o){return a[s]===o[s]?a[e]-o[e]:a[s]-o[s]}}function onAnimationsComplete(s){const e=s.chart,a=e.options.animation;e.notifyPlugins("afterRender"),callback(a&&a.onComplete,[s],e)}function onAnimationProgress(s){const e=s.chart,a=e.options.animation;callback(a&&a.onProgress,[s],e)}function getCanvas(s){return _isDomSupported()&&typeof s=="string"?s=document.getElementById(s):s&&s.length&&(s=s[0]),s&&s.canvas&&(s=s.canvas),s}const instances={},getChart=s=>{const e=getCanvas(s);return Object.values(instances).filter(a=>a.canvas===e).pop()};function moveNumericKeys(s,e,a){const o=Object.keys(s);for(const c of o){const d=+c;if(d>=e){const h=s[c];delete s[c],(a>0||d>e)&&(s[d+a]=h)}}}function determineLastEvent(s,e,a,o){return!a||s.type==="mouseout"?null:o?e:s}function getSizeForArea(s,e,a){return s.options.clip?s[a]:e[a]}function getDatasetArea(s,e){const{xScale:a,yScale:o}=s;return a&&o?{left:getSizeForArea(a,e,"left"),right:getSizeForArea(a,e,"right"),top:getSizeForArea(o,e,"top"),bottom:getSizeForArea(o,e,"bottom")}:e}var tr;let Chart$1=(tr=class{static register(...e){registry.add(...e),invalidatePlugins()}static unregister(...e){registry.remove(...e),invalidatePlugins()}constructor(e,a){const o=this.config=new Config(a),c=getCanvas(e),d=getChart(c);if(d)throw new Error("Canvas is already in use. Chart with ID '"+d.id+"' must be destroyed before the canvas with ID '"+d.canvas.id+"' can be reused.");const h=o.createResolver(o.chartOptionScopes(),this.getContext());this.platform=new(o.platform||_detectPlatform(c)),this.platform.updateConfig(o);const g=this.platform.acquireContext(c,h.aspectRatio),_=g&&g.canvas,b=_&&_.height,j=_&&_.width;if(this.id=uid(),this.ctx=g,this.canvas=_,this.width=j,this.height=b,this._options=h,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new PluginService,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=debounce($=>this.update($),h.resizeDelay||0),this._dataChanges=[],instances[this.id]=this,!g||!_){console.error("Failed to create chart: can't acquire context from the given item");return}animator.listen(this,"complete",onAnimationsComplete),animator.listen(this,"progress",onAnimationProgress),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:a},width:o,height:c,_aspectRatio:d}=this;return isNullOrUndef(e)?a&&d?d:c?o/c:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return registry}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():retinaScale(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return clearCanvas(this.canvas,this.ctx),this}stop(){return animator.stop(this),this}resize(e,a){animator.running(this)?this._resizeBeforeDraw={width:e,height:a}:this._resize(e,a)}_resize(e,a){const o=this.options,c=this.canvas,d=o.maintainAspectRatio&&this.aspectRatio,h=this.platform.getMaximumSize(c,e,a,d),g=o.devicePixelRatio||this.platform.getDevicePixelRatio(),_=this.width?"resize":"attach";this.width=h.width,this.height=h.height,this._aspectRatio=this.aspectRatio,retinaScale(this,g,!0)&&(this.notifyPlugins("resize",{size:h}),callback(o.onResize,[this,h],this),this.attached&&this._doResize(_)&&this.render())}ensureScalesHaveIDs(){const a=this.options.scales||{};each(a,(o,c)=>{o.id=c})}buildOrUpdateScales(){const e=this.options,a=e.scales,o=this.scales,c=Object.keys(o).reduce((h,g)=>(h[g]=!1,h),{});let d=[];a&&(d=d.concat(Object.keys(a).map(h=>{const g=a[h],_=determineAxis(h,g),b=_==="r",j=_==="x";return{options:g,dposition:b?"chartArea":j?"bottom":"left",dtype:b?"radialLinear":j?"category":"linear"}}))),each(d,h=>{const g=h.options,_=g.id,b=determineAxis(_,g),j=valueOrDefault(g.type,h.dtype);(g.position===void 0||positionIsHorizontal(g.position,b)!==positionIsHorizontal(h.dposition))&&(g.position=h.dposition),c[_]=!0;let $=null;if(_ in o&&o[_].type===j)$=o[_];else{const _e=registry.getScale(j);$=new _e({id:_,type:j,ctx:this.ctx,chart:this}),o[$.id]=$}$.init(g,e)}),each(c,(h,g)=>{h||delete o[g]}),each(o,h=>{layouts.configure(this,h,h.options),layouts.addBox(this,h)})}_updateMetasets(){const e=this._metasets,a=this.data.datasets.length,o=e.length;if(e.sort((c,d)=>c.index-d.index),o>a){for(let c=a;c<o;++c)this._destroyDatasetMeta(c);e.splice(a,o-a)}this._sortedMetasets=e.slice(0).sort(compare2Level("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:a}}=this;e.length>a.length&&delete this._stacks,e.forEach((o,c)=>{a.filter(d=>d===o._dataset).length===0&&this._destroyDatasetMeta(c)})}buildOrUpdateControllers(){const e=[],a=this.data.datasets;let o,c;for(this._removeUnreferencedMetasets(),o=0,c=a.length;o<c;o++){const d=a[o];let h=this.getDatasetMeta(o);const g=d.type||this.config.type;if(h.type&&h.type!==g&&(this._destroyDatasetMeta(o),h=this.getDatasetMeta(o)),h.type=g,h.indexAxis=d.indexAxis||getIndexAxis(g,this.options),h.order=d.order||0,h.index=o,h.label=""+d.label,h.visible=this.isDatasetVisible(o),h.controller)h.controller.updateIndex(o),h.controller.linkScales();else{const _=registry.getController(g),{datasetElementType:b,dataElementType:j}=defaults.datasets[g];Object.assign(_,{dataElementType:registry.getElement(j),datasetElementType:b&&registry.getElement(b)}),h.controller=new _(this,o),e.push(h.controller)}}return this._updateMetasets(),e}_resetElements(){each(this.data.datasets,(e,a)=>{this.getDatasetMeta(a).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const a=this.config;a.update();const o=this._options=a.createResolver(a.chartOptionScopes(),this.getContext()),c=this._animationsDisabled=!o.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const d=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let h=0;for(let b=0,j=this.data.datasets.length;b<j;b++){const{controller:$}=this.getDatasetMeta(b),_e=!c&&d.indexOf($)===-1;$.buildOrUpdateElements(_e),h=Math.max(+$.getMaxOverflow(),h)}h=this._minPadding=o.layout.autoPadding?h:0,this._updateLayout(h),c||each(d,b=>{b.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(compare2Level("z","_idx"));const{_active:g,_lastEvent:_}=this;_?this._eventHandler(_,!0):g.length&&this._updateHoverStyles(g,g,!0),this.render()}_updateScales(){each(this.scales,e=>{layouts.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,a=new Set(Object.keys(this._listeners)),o=new Set(e.events);(!setsEqual(a,o)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,a=this._getUniformDataChanges()||[];for(const{method:o,start:c,count:d}of a){const h=o==="_removeElements"?-d:d;moveNumericKeys(e,c,h)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const a=this.data.datasets.length,o=d=>new Set(e.filter(h=>h[0]===d).map((h,g)=>g+","+h.splice(1).join(","))),c=o(0);for(let d=1;d<a;d++)if(!setsEqual(c,o(d)))return;return Array.from(c).map(d=>d.split(",")).map(d=>({method:d[1],start:+d[2],count:+d[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;layouts.update(this,this.width,this.height,e);const a=this.chartArea,o=a.width<=0||a.height<=0;this._layers=[],each(this.boxes,c=>{o&&c.position==="chartArea"||(c.configure&&c.configure(),this._layers.push(...c._layers()))},this),this._layers.forEach((c,d)=>{c._idx=d}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let a=0,o=this.data.datasets.length;a<o;++a)this.getDatasetMeta(a).controller.configure();for(let a=0,o=this.data.datasets.length;a<o;++a)this._updateDataset(a,isFunction(e)?e({datasetIndex:a}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,a){const o=this.getDatasetMeta(e),c={meta:o,index:e,mode:a,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",c)!==!1&&(o.controller._update(a),c.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",c))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(animator.has(this)?this.attached&&!animator.running(this)&&animator.start(this):(this.draw(),onAnimationsComplete({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:o,height:c}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(o,c)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const a=this._layers;for(e=0;e<a.length&&a[e].z<=0;++e)a[e].draw(this.chartArea);for(this._drawDatasets();e<a.length;++e)a[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const a=this._sortedMetasets,o=[];let c,d;for(c=0,d=a.length;c<d;++c){const h=a[c];(!e||h.visible)&&o.push(h)}return o}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let a=e.length-1;a>=0;--a)this._drawDataset(e[a]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const a=this.ctx,o=e._clip,c=!o.disabled,d=getDatasetArea(e,this.chartArea),h={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",h)!==!1&&(c&&clipArea(a,{left:o.left===!1?0:d.left-o.left,right:o.right===!1?this.width:d.right+o.right,top:o.top===!1?0:d.top-o.top,bottom:o.bottom===!1?this.height:d.bottom+o.bottom}),e.controller.draw(),c&&unclipArea(a),h.cancelable=!1,this.notifyPlugins("afterDatasetDraw",h))}isPointInArea(e){return _isPointInArea(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,a,o,c){const d=Interaction.modes[a];return typeof d=="function"?d(this,e,o,c):[]}getDatasetMeta(e){const a=this.data.datasets[e],o=this._metasets;let c=o.filter(d=>d&&d._dataset===a).pop();return c||(c={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:a&&a.order||0,index:e,_dataset:a,_parsed:[],_sorted:!1},o.push(c)),c}getContext(){return this.$context||(this.$context=createContext(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const a=this.data.datasets[e];if(!a)return!1;const o=this.getDatasetMeta(e);return typeof o.hidden=="boolean"?!o.hidden:!a.hidden}setDatasetVisibility(e,a){const o=this.getDatasetMeta(e);o.hidden=!a}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,a,o){const c=o?"show":"hide",d=this.getDatasetMeta(e),h=d.controller._resolveAnimations(void 0,c);defined(a)?(d.data[a].hidden=!o,this.update()):(this.setDatasetVisibility(e,o),h.update(d,{visible:o}),this.update(g=>g.datasetIndex===e?c:void 0))}hide(e,a){this._updateVisibility(e,a,!1)}show(e,a){this._updateVisibility(e,a,!0)}_destroyDatasetMeta(e){const a=this._metasets[e];a&&a.controller&&a.controller._destroy(),delete this._metasets[e]}_stop(){let e,a;for(this.stop(),animator.remove(this),e=0,a=this.data.datasets.length;e<a;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:a}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),clearCanvas(e,a),this.platform.releaseContext(a),this.canvas=null,this.ctx=null),delete instances[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,a=this.platform,o=(d,h)=>{a.addEventListener(this,d,h),e[d]=h},c=(d,h,g)=>{d.offsetX=h,d.offsetY=g,this._eventHandler(d)};each(this.options.events,d=>o(d,c))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,a=this.platform,o=(_,b)=>{a.addEventListener(this,_,b),e[_]=b},c=(_,b)=>{e[_]&&(a.removeEventListener(this,_,b),delete e[_])},d=(_,b)=>{this.canvas&&this.resize(_,b)};let h;const g=()=>{c("attach",g),this.attached=!0,this.resize(),o("resize",d),o("detach",h)};h=()=>{this.attached=!1,c("resize",d),this._stop(),this._resize(0,0),o("attach",g)},a.isAttached(this.canvas)?g():h()}unbindEvents(){each(this._listeners,(e,a)=>{this.platform.removeEventListener(this,a,e)}),this._listeners={},each(this._responsiveListeners,(e,a)=>{this.platform.removeEventListener(this,a,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,a,o){const c=o?"set":"remove";let d,h,g,_;for(a==="dataset"&&(d=this.getDatasetMeta(e[0].datasetIndex),d.controller["_"+c+"DatasetHoverStyle"]()),g=0,_=e.length;g<_;++g){h=e[g];const b=h&&this.getDatasetMeta(h.datasetIndex).controller;b&&b[c+"HoverStyle"](h.element,h.datasetIndex,h.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const a=this._active||[],o=e.map(({datasetIndex:d,index:h})=>{const g=this.getDatasetMeta(d);if(!g)throw new Error("No dataset found at index "+d);return{datasetIndex:d,element:g.data[h],index:h}});!_elementsEqual(o,a)&&(this._active=o,this._lastEvent=null,this._updateHoverStyles(o,a))}notifyPlugins(e,a,o){return this._plugins.notify(this,e,a,o)}isPluginEnabled(e){return this._plugins._cache.filter(a=>a.plugin.id===e).length===1}_updateHoverStyles(e,a,o){const c=this.options.hover,d=(_,b)=>_.filter(j=>!b.some($=>j.datasetIndex===$.datasetIndex&&j.index===$.index)),h=d(a,e),g=o?e:d(e,a);h.length&&this.updateHoverStyle(h,c.mode,!1),g.length&&c.mode&&this.updateHoverStyle(g,c.mode,!0)}_eventHandler(e,a){const o={event:e,replay:a,cancelable:!0,inChartArea:this.isPointInArea(e)},c=h=>(h.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",o,c)===!1)return;const d=this._handleEvent(e,a,o.inChartArea);return o.cancelable=!1,this.notifyPlugins("afterEvent",o,c),(d||o.changed)&&this.render(),this}_handleEvent(e,a,o){const{_active:c=[],options:d}=this,h=a,g=this._getActiveElements(e,c,o,h),_=_isClickEvent(e),b=determineLastEvent(e,this._lastEvent,o,_);o&&(this._lastEvent=null,callback(d.onHover,[e,g,this],this),_&&callback(d.onClick,[e,g,this],this));const j=!_elementsEqual(g,c);return(j||a)&&(this._active=g,this._updateHoverStyles(g,c,a)),this._lastEvent=b,j}_getActiveElements(e,a,o,c){if(e.type==="mouseout")return[];if(!o)return a;const d=this.options.hover;return this.getElementsAtEventForMode(e,d.mode,d,c)}},Sn(tr,"defaults",defaults),Sn(tr,"instances",instances),Sn(tr,"overrides",overrides),Sn(tr,"registry",registry),Sn(tr,"version",version),Sn(tr,"getChart",getChart),tr);function invalidatePlugins(){return each(Chart$1.instances,s=>s._plugins.invalidate())}function clipArc(s,e,a){const{startAngle:o,pixelMargin:c,x:d,y:h,outerRadius:g,innerRadius:_}=e;let b=c/g;s.beginPath(),s.arc(d,h,g,o-b,a+b),_>c?(b=c/_,s.arc(d,h,_,a+b,o-b,!0)):s.arc(d,h,c,a+HALF_PI,o-HALF_PI),s.closePath(),s.clip()}function toRadiusCorners(s){return _readValueToProps(s,["outerStart","outerEnd","innerStart","innerEnd"])}function parseBorderRadius$1(s,e,a,o){const c=toRadiusCorners(s.options.borderRadius),d=(a-e)/2,h=Math.min(d,o*e/2),g=_=>{const b=(a-Math.min(d,_))*o/2;return _limitValue(_,0,Math.min(d,b))};return{outerStart:g(c.outerStart),outerEnd:g(c.outerEnd),innerStart:_limitValue(c.innerStart,0,h),innerEnd:_limitValue(c.innerEnd,0,h)}}function rThetaToXY(s,e,a,o){return{x:a+s*Math.cos(e),y:o+s*Math.sin(e)}}function pathArc(s,e,a,o,c,d){const{x:h,y:g,startAngle:_,pixelMargin:b,innerRadius:j}=e,$=Math.max(e.outerRadius+o+a-b,0),_e=j>0?j+o+a+b:0;let tt=0;const et=c-_;if(o){const St=j>0?j-o:0,Ot=$>0?$-o:0,Ct=(St+Ot)/2,Rt=Ct!==0?et*Ct/(Ct+o):et;tt=(et-Rt)/2}const st=Math.max(.001,et*$-a/PI)/$,rt=(et-st)/2,nt=_+rt+tt,it=c-rt-tt,{outerStart:at,outerEnd:dt,innerStart:ot,innerEnd:ht}=parseBorderRadius$1(e,_e,$,it-nt),ut=$-at,pt=$-dt,_t=nt+at/ut,wt=it-dt/pt,mt=_e+ot,Et=_e+ht,Pt=nt+ot/mt,jt=it-ht/Et;if(s.beginPath(),d){const St=(_t+wt)/2;if(s.arc(h,g,$,_t,St),s.arc(h,g,$,St,wt),dt>0){const bt=rThetaToXY(pt,wt,h,g);s.arc(bt.x,bt.y,dt,wt,it+HALF_PI)}const Ot=rThetaToXY(Et,it,h,g);if(s.lineTo(Ot.x,Ot.y),ht>0){const bt=rThetaToXY(Et,jt,h,g);s.arc(bt.x,bt.y,ht,it+HALF_PI,jt+Math.PI)}const Ct=(it-ht/_e+(nt+ot/_e))/2;if(s.arc(h,g,_e,it-ht/_e,Ct,!0),s.arc(h,g,_e,Ct,nt+ot/_e,!0),ot>0){const bt=rThetaToXY(mt,Pt,h,g);s.arc(bt.x,bt.y,ot,Pt+Math.PI,nt-HALF_PI)}const Rt=rThetaToXY(ut,nt,h,g);if(s.lineTo(Rt.x,Rt.y),at>0){const bt=rThetaToXY(ut,_t,h,g);s.arc(bt.x,bt.y,at,nt-HALF_PI,_t)}}else{s.moveTo(h,g);const St=Math.cos(_t)*$+h,Ot=Math.sin(_t)*$+g;s.lineTo(St,Ot);const Ct=Math.cos(wt)*$+h,Rt=Math.sin(wt)*$+g;s.lineTo(Ct,Rt)}s.closePath()}function drawArc(s,e,a,o,c){const{fullCircles:d,startAngle:h,circumference:g}=e;let _=e.endAngle;if(d){pathArc(s,e,a,o,_,c);for(let b=0;b<d;++b)s.fill();isNaN(g)||(_=h+(g%TAU||TAU))}return pathArc(s,e,a,o,_,c),s.fill(),_}function drawBorder(s,e,a,o,c){const{fullCircles:d,startAngle:h,circumference:g,options:_}=e,{borderWidth:b,borderJoinStyle:j,borderDash:$,borderDashOffset:_e}=_,tt=_.borderAlign==="inner";if(!b)return;s.setLineDash($||[]),s.lineDashOffset=_e,tt?(s.lineWidth=b*2,s.lineJoin=j||"round"):(s.lineWidth=b,s.lineJoin=j||"bevel");let et=e.endAngle;if(d){pathArc(s,e,a,o,et,c);for(let st=0;st<d;++st)s.stroke();isNaN(g)||(et=h+(g%TAU||TAU))}tt&&clipArc(s,e,et),d||(pathArc(s,e,a,o,et,c),s.stroke())}class ArcElement extends Element{constructor(a){super();Sn(this,"circumference");Sn(this,"endAngle");Sn(this,"fullCircles");Sn(this,"innerRadius");Sn(this,"outerRadius");Sn(this,"pixelMargin");Sn(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,a&&Object.assign(this,a)}inRange(a,o,c){const d=this.getProps(["x","y"],c),{angle:h,distance:g}=getAngleFromPoint(d,{x:a,y:o}),{startAngle:_,endAngle:b,innerRadius:j,outerRadius:$,circumference:_e}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],c),tt=(this.options.spacing+this.options.borderWidth)/2,et=valueOrDefault(_e,b-_),st=_angleBetween(h,_,b)&&_!==b,rt=et>=TAU||st,nt=_isBetween(g,j+tt,$+tt);return rt&&nt}getCenterPoint(a){const{x:o,y:c,startAngle:d,endAngle:h,innerRadius:g,outerRadius:_}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],a),{offset:b,spacing:j}=this.options,$=(d+h)/2,_e=(g+_+j+b)/2;return{x:o+Math.cos($)*_e,y:c+Math.sin($)*_e}}tooltipPosition(a){return this.getCenterPoint(a)}draw(a){const{options:o,circumference:c}=this,d=(o.offset||0)/4,h=(o.spacing||0)/2,g=o.circular;if(this.pixelMargin=o.borderAlign==="inner"?.33:0,this.fullCircles=c>TAU?Math.floor(c/TAU):0,c===0||this.innerRadius<0||this.outerRadius<0)return;a.save();const _=(this.startAngle+this.endAngle)/2;a.translate(Math.cos(_)*d,Math.sin(_)*d);const b=1-Math.sin(Math.min(PI,c||0)),j=d*b;a.fillStyle=o.backgroundColor,a.strokeStyle=o.borderColor,drawArc(a,this,j,h,g),drawBorder(a,this,j,h,g),a.restore()}}Sn(ArcElement,"id","arc"),Sn(ArcElement,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),Sn(ArcElement,"defaultRoutes",{backgroundColor:"backgroundColor"}),Sn(ArcElement,"descriptors",{_scriptable:!0,_indexable:a=>a!=="borderDash"});function getBarBounds(s,e){const{x:a,y:o,base:c,width:d,height:h}=s.getProps(["x","y","base","width","height"],e);let g,_,b,j,$;return s.horizontal?($=h/2,g=Math.min(a,c),_=Math.max(a,c),b=o-$,j=o+$):($=d/2,g=a-$,_=a+$,b=Math.min(o,c),j=Math.max(o,c)),{left:g,top:b,right:_,bottom:j}}function skipOrLimit(s,e,a,o){return s?0:_limitValue(e,a,o)}function parseBorderWidth(s,e,a){const o=s.options.borderWidth,c=s.borderSkipped,d=toTRBL(o);return{t:skipOrLimit(c.top,d.top,0,a),r:skipOrLimit(c.right,d.right,0,e),b:skipOrLimit(c.bottom,d.bottom,0,a),l:skipOrLimit(c.left,d.left,0,e)}}function parseBorderRadius(s,e,a){const{enableBorderRadius:o}=s.getProps(["enableBorderRadius"]),c=s.options.borderRadius,d=toTRBLCorners(c),h=Math.min(e,a),g=s.borderSkipped,_=o||isObject(c);return{topLeft:skipOrLimit(!_||g.top||g.left,d.topLeft,0,h),topRight:skipOrLimit(!_||g.top||g.right,d.topRight,0,h),bottomLeft:skipOrLimit(!_||g.bottom||g.left,d.bottomLeft,0,h),bottomRight:skipOrLimit(!_||g.bottom||g.right,d.bottomRight,0,h)}}function boundingRects(s){const e=getBarBounds(s),a=e.right-e.left,o=e.bottom-e.top,c=parseBorderWidth(s,a/2,o/2),d=parseBorderRadius(s,a/2,o/2);return{outer:{x:e.left,y:e.top,w:a,h:o,radius:d},inner:{x:e.left+c.l,y:e.top+c.t,w:a-c.l-c.r,h:o-c.t-c.b,radius:{topLeft:Math.max(0,d.topLeft-Math.max(c.t,c.l)),topRight:Math.max(0,d.topRight-Math.max(c.t,c.r)),bottomLeft:Math.max(0,d.bottomLeft-Math.max(c.b,c.l)),bottomRight:Math.max(0,d.bottomRight-Math.max(c.b,c.r))}}}}function inRange(s,e,a,o){const c=e===null,d=a===null,g=s&&!(c&&d)&&getBarBounds(s,o);return g&&(c||_isBetween(e,g.left,g.right))&&(d||_isBetween(a,g.top,g.bottom))}function hasRadius(s){return s.topLeft||s.topRight||s.bottomLeft||s.bottomRight}function addNormalRectPath(s,e){s.rect(e.x,e.y,e.w,e.h)}function inflateRect(s,e,a={}){const o=s.x!==a.x?-e:0,c=s.y!==a.y?-e:0,d=(s.x+s.w!==a.x+a.w?e:0)-o,h=(s.y+s.h!==a.y+a.h?e:0)-c;return{x:s.x+o,y:s.y+c,w:s.w+d,h:s.h+h,radius:s.radius}}class BarElement extends Element{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:a,options:{borderColor:o,backgroundColor:c}}=this,{inner:d,outer:h}=boundingRects(this),g=hasRadius(h.radius)?addRoundedRectPath:addNormalRectPath;e.save(),(h.w!==d.w||h.h!==d.h)&&(e.beginPath(),g(e,inflateRect(h,a,d)),e.clip(),g(e,inflateRect(d,-a,h)),e.fillStyle=o,e.fill("evenodd")),e.beginPath(),g(e,inflateRect(d,a)),e.fillStyle=c,e.fill(),e.restore()}inRange(e,a,o){return inRange(this,e,a,o)}inXRange(e,a){return inRange(this,e,null,a)}inYRange(e,a){return inRange(this,null,e,a)}getCenterPoint(e){const{x:a,y:o,base:c,horizontal:d}=this.getProps(["x","y","base","horizontal"],e);return{x:d?(a+c)/2:a,y:d?o:(o+c)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}Sn(BarElement,"id","bar"),Sn(BarElement,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Sn(BarElement,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const getBoxSize=(s,e)=>{let{boxHeight:a=e,boxWidth:o=e}=s;return s.usePointStyle&&(a=Math.min(a,e),o=s.pointStyleWidth||Math.min(o,e)),{boxWidth:o,boxHeight:a,itemHeight:Math.max(e,a)}},itemsEqual=(s,e)=>s!==null&&e!==null&&s.datasetIndex===e.datasetIndex&&s.index===e.index;class Legend extends Element{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,a,o){this.maxWidth=e,this.maxHeight=a,this._margins=o,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let a=callback(e.generateLabels,[this.chart],this)||[];e.filter&&(a=a.filter(o=>e.filter(o,this.chart.data))),e.sort&&(a=a.sort((o,c)=>e.sort(o,c,this.chart.data))),this.options.reverse&&a.reverse(),this.legendItems=a}fit(){const{options:e,ctx:a}=this;if(!e.display){this.width=this.height=0;return}const o=e.labels,c=toFont(o.font),d=c.size,h=this._computeTitleHeight(),{boxWidth:g,itemHeight:_}=getBoxSize(o,d);let b,j;a.font=c.string,this.isHorizontal()?(b=this.maxWidth,j=this._fitRows(h,d,g,_)+10):(j=this.maxHeight,b=this._fitCols(h,c,g,_)+10),this.width=Math.min(b,e.maxWidth||this.maxWidth),this.height=Math.min(j,e.maxHeight||this.maxHeight)}_fitRows(e,a,o,c){const{ctx:d,maxWidth:h,options:{labels:{padding:g}}}=this,_=this.legendHitBoxes=[],b=this.lineWidths=[0],j=c+g;let $=e;d.textAlign="left",d.textBaseline="middle";let _e=-1,tt=-j;return this.legendItems.forEach((et,st)=>{const rt=o+a/2+d.measureText(et.text).width;(st===0||b[b.length-1]+rt+2*g>h)&&($+=j,b[b.length-(st>0?0:1)]=0,tt+=j,_e++),_[st]={left:0,top:tt,row:_e,width:rt,height:c},b[b.length-1]+=rt+g}),$}_fitCols(e,a,o,c){const{ctx:d,maxHeight:h,options:{labels:{padding:g}}}=this,_=this.legendHitBoxes=[],b=this.columnSizes=[],j=h-e;let $=g,_e=0,tt=0,et=0,st=0;return this.legendItems.forEach((rt,nt)=>{const{itemWidth:it,itemHeight:at}=calculateItemSize(o,a,d,rt,c);nt>0&&tt+at+2*g>j&&($+=_e+g,b.push({width:_e,height:tt}),et+=_e+g,st++,_e=tt=0),_[nt]={left:et,top:tt,col:st,width:it,height:at},_e=Math.max(_e,it),tt+=at+g}),$+=_e,b.push({width:_e,height:tt}),$}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:a,options:{align:o,labels:{padding:c},rtl:d}}=this,h=getRtlAdapter(d,this.left,this.width);if(this.isHorizontal()){let g=0,_=_alignStartEnd(o,this.left+c,this.right-this.lineWidths[g]);for(const b of a)g!==b.row&&(g=b.row,_=_alignStartEnd(o,this.left+c,this.right-this.lineWidths[g])),b.top+=this.top+e+c,b.left=h.leftForLtr(h.x(_),b.width),_+=b.width+c}else{let g=0,_=_alignStartEnd(o,this.top+e+c,this.bottom-this.columnSizes[g].height);for(const b of a)b.col!==g&&(g=b.col,_=_alignStartEnd(o,this.top+e+c,this.bottom-this.columnSizes[g].height)),b.top=_,b.left+=this.left+c,b.left=h.leftForLtr(h.x(b.left),b.width),_+=b.height+c}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;clipArea(e,this),this._draw(),unclipArea(e)}}_draw(){const{options:e,columnSizes:a,lineWidths:o,ctx:c}=this,{align:d,labels:h}=e,g=defaults.color,_=getRtlAdapter(e.rtl,this.left,this.width),b=toFont(h.font),{padding:j}=h,$=b.size,_e=$/2;let tt;this.drawTitle(),c.textAlign=_.textAlign("left"),c.textBaseline="middle",c.lineWidth=.5,c.font=b.string;const{boxWidth:et,boxHeight:st,itemHeight:rt}=getBoxSize(h,$),nt=function(ht,ut,pt){if(isNaN(et)||et<=0||isNaN(st)||st<0)return;c.save();const _t=valueOrDefault(pt.lineWidth,1);if(c.fillStyle=valueOrDefault(pt.fillStyle,g),c.lineCap=valueOrDefault(pt.lineCap,"butt"),c.lineDashOffset=valueOrDefault(pt.lineDashOffset,0),c.lineJoin=valueOrDefault(pt.lineJoin,"miter"),c.lineWidth=_t,c.strokeStyle=valueOrDefault(pt.strokeStyle,g),c.setLineDash(valueOrDefault(pt.lineDash,[])),h.usePointStyle){const wt={radius:st*Math.SQRT2/2,pointStyle:pt.pointStyle,rotation:pt.rotation,borderWidth:_t},mt=_.xPlus(ht,et/2),Et=ut+_e;drawPointLegend(c,wt,mt,Et,h.pointStyleWidth&&et)}else{const wt=ut+Math.max(($-st)/2,0),mt=_.leftForLtr(ht,et),Et=toTRBLCorners(pt.borderRadius);c.beginPath(),Object.values(Et).some(Pt=>Pt!==0)?addRoundedRectPath(c,{x:mt,y:wt,w:et,h:st,radius:Et}):c.rect(mt,wt,et,st),c.fill(),_t!==0&&c.stroke()}c.restore()},it=function(ht,ut,pt){renderText(c,pt.text,ht,ut+rt/2,b,{strikethrough:pt.hidden,textAlign:_.textAlign(pt.textAlign)})},at=this.isHorizontal(),dt=this._computeTitleHeight();at?tt={x:_alignStartEnd(d,this.left+j,this.right-o[0]),y:this.top+j+dt,line:0}:tt={x:this.left+j,y:_alignStartEnd(d,this.top+dt+j,this.bottom-a[0].height),line:0},overrideTextDirection(this.ctx,e.textDirection);const ot=rt+j;this.legendItems.forEach((ht,ut)=>{c.strokeStyle=ht.fontColor,c.fillStyle=ht.fontColor;const pt=c.measureText(ht.text).width,_t=_.textAlign(ht.textAlign||(ht.textAlign=h.textAlign)),wt=et+_e+pt;let mt=tt.x,Et=tt.y;_.setWidth(this.width),at?ut>0&&mt+wt+j>this.right&&(Et=tt.y+=ot,tt.line++,mt=tt.x=_alignStartEnd(d,this.left+j,this.right-o[tt.line])):ut>0&&Et+ot>this.bottom&&(mt=tt.x=mt+a[tt.line].width+j,tt.line++,Et=tt.y=_alignStartEnd(d,this.top+dt+j,this.bottom-a[tt.line].height));const Pt=_.x(mt);if(nt(Pt,Et,ht),mt=_textX(_t,mt+et+_e,at?mt+wt:this.right,e.rtl),it(_.x(mt),Et,ht),at)tt.x+=wt+j;else if(typeof ht.text!="string"){const jt=b.lineHeight;tt.y+=calculateLegendItemHeight(ht,jt)+j}else tt.y+=ot}),restoreTextDirection(this.ctx,e.textDirection)}drawTitle(){const e=this.options,a=e.title,o=toFont(a.font),c=toPadding(a.padding);if(!a.display)return;const d=getRtlAdapter(e.rtl,this.left,this.width),h=this.ctx,g=a.position,_=o.size/2,b=c.top+_;let j,$=this.left,_e=this.width;if(this.isHorizontal())_e=Math.max(...this.lineWidths),j=this.top+b,$=_alignStartEnd(e.align,$,this.right-_e);else{const et=this.columnSizes.reduce((st,rt)=>Math.max(st,rt.height),0);j=b+_alignStartEnd(e.align,this.top,this.bottom-et-e.labels.padding-this._computeTitleHeight())}const tt=_alignStartEnd(g,$,$+_e);h.textAlign=d.textAlign(_toLeftRightCenter(g)),h.textBaseline="middle",h.strokeStyle=a.color,h.fillStyle=a.color,h.font=o.string,renderText(h,a.text,tt,j,o)}_computeTitleHeight(){const e=this.options.title,a=toFont(e.font),o=toPadding(e.padding);return e.display?a.lineHeight+o.height:0}_getLegendItemAt(e,a){let o,c,d;if(_isBetween(e,this.left,this.right)&&_isBetween(a,this.top,this.bottom)){for(d=this.legendHitBoxes,o=0;o<d.length;++o)if(c=d[o],_isBetween(e,c.left,c.left+c.width)&&_isBetween(a,c.top,c.top+c.height))return this.legendItems[o]}return null}handleEvent(e){const a=this.options;if(!isListened(e.type,a))return;const o=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const c=this._hoveredItem,d=itemsEqual(c,o);c&&!d&&callback(a.onLeave,[e,c,this],this),this._hoveredItem=o,o&&!d&&callback(a.onHover,[e,o,this],this)}else o&&callback(a.onClick,[e,o,this],this)}}function calculateItemSize(s,e,a,o,c){const d=calculateItemWidth(o,s,e,a),h=calculateItemHeight(c,o,e.lineHeight);return{itemWidth:d,itemHeight:h}}function calculateItemWidth(s,e,a,o){let c=s.text;return c&&typeof c!="string"&&(c=c.reduce((d,h)=>d.length>h.length?d:h)),e+a.size/2+o.measureText(c).width}function calculateItemHeight(s,e,a){let o=s;return typeof e.text!="string"&&(o=calculateLegendItemHeight(e,a)),o}function calculateLegendItemHeight(s,e){const a=s.text?s.text.length:0;return e*a}function isListened(s,e){return!!((s==="mousemove"||s==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(s==="click"||s==="mouseup"))}var plugin_legend={id:"legend",_element:Legend,start(s,e,a){const o=s.legend=new Legend({ctx:s.ctx,options:a,chart:s});layouts.configure(s,o,a),layouts.addBox(s,o)},stop(s){layouts.removeBox(s,s.legend),delete s.legend},beforeUpdate(s,e,a){const o=s.legend;layouts.configure(s,o,a),o.options=a},afterUpdate(s){const e=s.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(s,e){e.replay||s.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(s,e,a){const o=e.datasetIndex,c=a.chart;c.isDatasetVisible(o)?(c.hide(o),e.hidden=!0):(c.show(o),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:s=>s.chart.options.color,boxWidth:40,padding:10,generateLabels(s){const e=s.data.datasets,{labels:{usePointStyle:a,pointStyle:o,textAlign:c,color:d,useBorderRadius:h,borderRadius:g}}=s.legend.options;return s._getSortedDatasetMetas().map(_=>{const b=_.controller.getStyle(a?0:void 0),j=toPadding(b.borderWidth);return{text:e[_.index].label,fillStyle:b.backgroundColor,fontColor:d,hidden:!_.visible,lineCap:b.borderCapStyle,lineDash:b.borderDash,lineDashOffset:b.borderDashOffset,lineJoin:b.borderJoinStyle,lineWidth:(j.width+j.height)/4,strokeStyle:b.borderColor,pointStyle:o||b.pointStyle,rotation:b.rotation,textAlign:c||b.textAlign,borderRadius:h&&(g||b.borderRadius),datasetIndex:_.index}},this)}},title:{color:s=>s.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:s=>!s.startsWith("on"),labels:{_scriptable:s=>!["generateLabels","filter","sort"].includes(s)}}};class Title extends Element{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,a){const o=this.options;if(this.left=0,this.top=0,!o.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=a;const c=isArray(o.text)?o.text.length:1;this._padding=toPadding(o.padding);const d=c*toFont(o.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=d:this.width=d}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:a,left:o,bottom:c,right:d,options:h}=this,g=h.align;let _=0,b,j,$;return this.isHorizontal()?(j=_alignStartEnd(g,o,d),$=a+e,b=d-o):(h.position==="left"?(j=o+e,$=_alignStartEnd(g,c,a),_=PI*-.5):(j=d-e,$=_alignStartEnd(g,a,c),_=PI*.5),b=c-a),{titleX:j,titleY:$,maxWidth:b,rotation:_}}draw(){const e=this.ctx,a=this.options;if(!a.display)return;const o=toFont(a.font),d=o.lineHeight/2+this._padding.top,{titleX:h,titleY:g,maxWidth:_,rotation:b}=this._drawArgs(d);renderText(e,a.text,0,0,o,{color:a.color,maxWidth:_,rotation:b,textAlign:_toLeftRightCenter(a.align),textBaseline:"middle",translation:[h,g]})}}function createTitle(s,e){const a=new Title({ctx:s.ctx,options:e,chart:s});layouts.configure(s,a,e),layouts.addBox(s,a),s.titleBlock=a}var plugin_title={id:"title",_element:Title,start(s,e,a){createTitle(s,a)},stop(s){const e=s.titleBlock;layouts.removeBox(s,e),delete s.titleBlock},beforeUpdate(s,e,a){const o=s.titleBlock;layouts.configure(s,o,a),o.options=a},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const positioners={average(s){if(!s.length)return!1;let e,a,o=new Set,c=0,d=0;for(e=0,a=s.length;e<a;++e){const g=s[e].element;if(g&&g.hasValue()){const _=g.tooltipPosition();o.add(_.x),c+=_.y,++d}}return d===0||o.size===0?!1:{x:[...o].reduce((g,_)=>g+_)/o.size,y:c/d}},nearest(s,e){if(!s.length)return!1;let a=e.x,o=e.y,c=Number.POSITIVE_INFINITY,d,h,g;for(d=0,h=s.length;d<h;++d){const _=s[d].element;if(_&&_.hasValue()){const b=_.getCenterPoint(),j=distanceBetweenPoints(e,b);j<c&&(c=j,g=_)}}if(g){const _=g.tooltipPosition();a=_.x,o=_.y}return{x:a,y:o}}};function pushOrConcat(s,e){return e&&(isArray(e)?Array.prototype.push.apply(s,e):s.push(e)),s}function splitNewlines(s){return(typeof s=="string"||s instanceof String)&&s.indexOf(`
`)>-1?s.split(`
`):s}function createTooltipItem(s,e){const{element:a,datasetIndex:o,index:c}=e,d=s.getDatasetMeta(o).controller,{label:h,value:g}=d.getLabelAndValue(c);return{chart:s,label:h,parsed:d.getParsed(c),raw:s.data.datasets[o].data[c],formattedValue:g,dataset:d.getDataset(),dataIndex:c,datasetIndex:o,element:a}}function getTooltipSize(s,e){const a=s.chart.ctx,{body:o,footer:c,title:d}=s,{boxWidth:h,boxHeight:g}=e,_=toFont(e.bodyFont),b=toFont(e.titleFont),j=toFont(e.footerFont),$=d.length,_e=c.length,tt=o.length,et=toPadding(e.padding);let st=et.height,rt=0,nt=o.reduce((dt,ot)=>dt+ot.before.length+ot.lines.length+ot.after.length,0);if(nt+=s.beforeBody.length+s.afterBody.length,$&&(st+=$*b.lineHeight+($-1)*e.titleSpacing+e.titleMarginBottom),nt){const dt=e.displayColors?Math.max(g,_.lineHeight):_.lineHeight;st+=tt*dt+(nt-tt)*_.lineHeight+(nt-1)*e.bodySpacing}_e&&(st+=e.footerMarginTop+_e*j.lineHeight+(_e-1)*e.footerSpacing);let it=0;const at=function(dt){rt=Math.max(rt,a.measureText(dt).width+it)};return a.save(),a.font=b.string,each(s.title,at),a.font=_.string,each(s.beforeBody.concat(s.afterBody),at),it=e.displayColors?h+2+e.boxPadding:0,each(o,dt=>{each(dt.before,at),each(dt.lines,at),each(dt.after,at)}),it=0,a.font=j.string,each(s.footer,at),a.restore(),rt+=et.width,{width:rt,height:st}}function determineYAlign(s,e){const{y:a,height:o}=e;return a<o/2?"top":a>s.height-o/2?"bottom":"center"}function doesNotFitWithAlign(s,e,a,o){const{x:c,width:d}=o,h=a.caretSize+a.caretPadding;if(s==="left"&&c+d+h>e.width||s==="right"&&c-d-h<0)return!0}function determineXAlign(s,e,a,o){const{x:c,width:d}=a,{width:h,chartArea:{left:g,right:_}}=s;let b="center";return o==="center"?b=c<=(g+_)/2?"left":"right":c<=d/2?b="left":c>=h-d/2&&(b="right"),doesNotFitWithAlign(b,s,e,a)&&(b="center"),b}function determineAlignment(s,e,a){const o=a.yAlign||e.yAlign||determineYAlign(s,a);return{xAlign:a.xAlign||e.xAlign||determineXAlign(s,e,a,o),yAlign:o}}function alignX(s,e){let{x:a,width:o}=s;return e==="right"?a-=o:e==="center"&&(a-=o/2),a}function alignY(s,e,a){let{y:o,height:c}=s;return e==="top"?o+=a:e==="bottom"?o-=c+a:o-=c/2,o}function getBackgroundPoint(s,e,a,o){const{caretSize:c,caretPadding:d,cornerRadius:h}=s,{xAlign:g,yAlign:_}=a,b=c+d,{topLeft:j,topRight:$,bottomLeft:_e,bottomRight:tt}=toTRBLCorners(h);let et=alignX(e,g);const st=alignY(e,_,b);return _==="center"?g==="left"?et+=b:g==="right"&&(et-=b):g==="left"?et-=Math.max(j,_e)+c:g==="right"&&(et+=Math.max($,tt)+c),{x:_limitValue(et,0,o.width-e.width),y:_limitValue(st,0,o.height-e.height)}}function getAlignedX(s,e,a){const o=toPadding(a.padding);return e==="center"?s.x+s.width/2:e==="right"?s.x+s.width-o.right:s.x+o.left}function getBeforeAfterBodyLines(s){return pushOrConcat([],splitNewlines(s))}function createTooltipContext(s,e,a){return createContext(s,{tooltip:e,tooltipItems:a,type:"tooltip"})}function overrideCallbacks(s,e){const a=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return a?s.override(a):s}const defaultCallbacks={beforeTitle:noop,title(s){if(s.length>0){const e=s[0],a=e.chart.data.labels,o=a?a.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(o>0&&e.dataIndex<o)return a[e.dataIndex]}return""},afterTitle:noop,beforeBody:noop,beforeLabel:noop,label(s){if(this&&this.options&&this.options.mode==="dataset")return s.label+": "+s.formattedValue||s.formattedValue;let e=s.dataset.label||"";e&&(e+=": ");const a=s.formattedValue;return isNullOrUndef(a)||(e+=a),e},labelColor(s){const a=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{borderColor:a.borderColor,backgroundColor:a.backgroundColor,borderWidth:a.borderWidth,borderDash:a.borderDash,borderDashOffset:a.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(s){const a=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{pointStyle:a.pointStyle,rotation:a.rotation}},afterLabel:noop,afterBody:noop,beforeFooter:noop,footer:noop,afterFooter:noop};function invokeCallbackWithFallback(s,e,a,o){const c=s[e].call(a,o);return typeof c>"u"?defaultCallbacks[e].call(a,o):c}class Tooltip extends Element{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const a=this.chart,o=this.options.setContext(this.getContext()),c=o.enabled&&a.options.animation&&o.animations,d=new Animations(this.chart,c);return c._cacheable&&(this._cachedAnimations=Object.freeze(d)),d}getContext(){return this.$context||(this.$context=createTooltipContext(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,a){const{callbacks:o}=a,c=invokeCallbackWithFallback(o,"beforeTitle",this,e),d=invokeCallbackWithFallback(o,"title",this,e),h=invokeCallbackWithFallback(o,"afterTitle",this,e);let g=[];return g=pushOrConcat(g,splitNewlines(c)),g=pushOrConcat(g,splitNewlines(d)),g=pushOrConcat(g,splitNewlines(h)),g}getBeforeBody(e,a){return getBeforeAfterBodyLines(invokeCallbackWithFallback(a.callbacks,"beforeBody",this,e))}getBody(e,a){const{callbacks:o}=a,c=[];return each(e,d=>{const h={before:[],lines:[],after:[]},g=overrideCallbacks(o,d);pushOrConcat(h.before,splitNewlines(invokeCallbackWithFallback(g,"beforeLabel",this,d))),pushOrConcat(h.lines,invokeCallbackWithFallback(g,"label",this,d)),pushOrConcat(h.after,splitNewlines(invokeCallbackWithFallback(g,"afterLabel",this,d))),c.push(h)}),c}getAfterBody(e,a){return getBeforeAfterBodyLines(invokeCallbackWithFallback(a.callbacks,"afterBody",this,e))}getFooter(e,a){const{callbacks:o}=a,c=invokeCallbackWithFallback(o,"beforeFooter",this,e),d=invokeCallbackWithFallback(o,"footer",this,e),h=invokeCallbackWithFallback(o,"afterFooter",this,e);let g=[];return g=pushOrConcat(g,splitNewlines(c)),g=pushOrConcat(g,splitNewlines(d)),g=pushOrConcat(g,splitNewlines(h)),g}_createItems(e){const a=this._active,o=this.chart.data,c=[],d=[],h=[];let g=[],_,b;for(_=0,b=a.length;_<b;++_)g.push(createTooltipItem(this.chart,a[_]));return e.filter&&(g=g.filter((j,$,_e)=>e.filter(j,$,_e,o))),e.itemSort&&(g=g.sort((j,$)=>e.itemSort(j,$,o))),each(g,j=>{const $=overrideCallbacks(e.callbacks,j);c.push(invokeCallbackWithFallback($,"labelColor",this,j)),d.push(invokeCallbackWithFallback($,"labelPointStyle",this,j)),h.push(invokeCallbackWithFallback($,"labelTextColor",this,j))}),this.labelColors=c,this.labelPointStyles=d,this.labelTextColors=h,this.dataPoints=g,g}update(e,a){const o=this.options.setContext(this.getContext()),c=this._active;let d,h=[];if(!c.length)this.opacity!==0&&(d={opacity:0});else{const g=positioners[o.position].call(this,c,this._eventPosition);h=this._createItems(o),this.title=this.getTitle(h,o),this.beforeBody=this.getBeforeBody(h,o),this.body=this.getBody(h,o),this.afterBody=this.getAfterBody(h,o),this.footer=this.getFooter(h,o);const _=this._size=getTooltipSize(this,o),b=Object.assign({},g,_),j=determineAlignment(this.chart,o,b),$=getBackgroundPoint(o,b,j,this.chart);this.xAlign=j.xAlign,this.yAlign=j.yAlign,d={opacity:1,x:$.x,y:$.y,width:_.width,height:_.height,caretX:g.x,caretY:g.y}}this._tooltipItems=h,this.$context=void 0,d&&this._resolveAnimations().update(this,d),e&&o.external&&o.external.call(this,{chart:this.chart,tooltip:this,replay:a})}drawCaret(e,a,o,c){const d=this.getCaretPosition(e,o,c);a.lineTo(d.x1,d.y1),a.lineTo(d.x2,d.y2),a.lineTo(d.x3,d.y3)}getCaretPosition(e,a,o){const{xAlign:c,yAlign:d}=this,{caretSize:h,cornerRadius:g}=o,{topLeft:_,topRight:b,bottomLeft:j,bottomRight:$}=toTRBLCorners(g),{x:_e,y:tt}=e,{width:et,height:st}=a;let rt,nt,it,at,dt,ot;return d==="center"?(dt=tt+st/2,c==="left"?(rt=_e,nt=rt-h,at=dt+h,ot=dt-h):(rt=_e+et,nt=rt+h,at=dt-h,ot=dt+h),it=rt):(c==="left"?nt=_e+Math.max(_,j)+h:c==="right"?nt=_e+et-Math.max(b,$)-h:nt=this.caretX,d==="top"?(at=tt,dt=at-h,rt=nt-h,it=nt+h):(at=tt+st,dt=at+h,rt=nt+h,it=nt-h),ot=at),{x1:rt,x2:nt,x3:it,y1:at,y2:dt,y3:ot}}drawTitle(e,a,o){const c=this.title,d=c.length;let h,g,_;if(d){const b=getRtlAdapter(o.rtl,this.x,this.width);for(e.x=getAlignedX(this,o.titleAlign,o),a.textAlign=b.textAlign(o.titleAlign),a.textBaseline="middle",h=toFont(o.titleFont),g=o.titleSpacing,a.fillStyle=o.titleColor,a.font=h.string,_=0;_<d;++_)a.fillText(c[_],b.x(e.x),e.y+h.lineHeight/2),e.y+=h.lineHeight+g,_+1===d&&(e.y+=o.titleMarginBottom-g)}}_drawColorBox(e,a,o,c,d){const h=this.labelColors[o],g=this.labelPointStyles[o],{boxHeight:_,boxWidth:b}=d,j=toFont(d.bodyFont),$=getAlignedX(this,"left",d),_e=c.x($),tt=_<j.lineHeight?(j.lineHeight-_)/2:0,et=a.y+tt;if(d.usePointStyle){const st={radius:Math.min(b,_)/2,pointStyle:g.pointStyle,rotation:g.rotation,borderWidth:1},rt=c.leftForLtr(_e,b)+b/2,nt=et+_/2;e.strokeStyle=d.multiKeyBackground,e.fillStyle=d.multiKeyBackground,drawPoint(e,st,rt,nt),e.strokeStyle=h.borderColor,e.fillStyle=h.backgroundColor,drawPoint(e,st,rt,nt)}else{e.lineWidth=isObject(h.borderWidth)?Math.max(...Object.values(h.borderWidth)):h.borderWidth||1,e.strokeStyle=h.borderColor,e.setLineDash(h.borderDash||[]),e.lineDashOffset=h.borderDashOffset||0;const st=c.leftForLtr(_e,b),rt=c.leftForLtr(c.xPlus(_e,1),b-2),nt=toTRBLCorners(h.borderRadius);Object.values(nt).some(it=>it!==0)?(e.beginPath(),e.fillStyle=d.multiKeyBackground,addRoundedRectPath(e,{x:st,y:et,w:b,h:_,radius:nt}),e.fill(),e.stroke(),e.fillStyle=h.backgroundColor,e.beginPath(),addRoundedRectPath(e,{x:rt,y:et+1,w:b-2,h:_-2,radius:nt}),e.fill()):(e.fillStyle=d.multiKeyBackground,e.fillRect(st,et,b,_),e.strokeRect(st,et,b,_),e.fillStyle=h.backgroundColor,e.fillRect(rt,et+1,b-2,_-2))}e.fillStyle=this.labelTextColors[o]}drawBody(e,a,o){const{body:c}=this,{bodySpacing:d,bodyAlign:h,displayColors:g,boxHeight:_,boxWidth:b,boxPadding:j}=o,$=toFont(o.bodyFont);let _e=$.lineHeight,tt=0;const et=getRtlAdapter(o.rtl,this.x,this.width),st=function(pt){a.fillText(pt,et.x(e.x+tt),e.y+_e/2),e.y+=_e+d},rt=et.textAlign(h);let nt,it,at,dt,ot,ht,ut;for(a.textAlign=h,a.textBaseline="middle",a.font=$.string,e.x=getAlignedX(this,rt,o),a.fillStyle=o.bodyColor,each(this.beforeBody,st),tt=g&&rt!=="right"?h==="center"?b/2+j:b+2+j:0,dt=0,ht=c.length;dt<ht;++dt){for(nt=c[dt],it=this.labelTextColors[dt],a.fillStyle=it,each(nt.before,st),at=nt.lines,g&&at.length&&(this._drawColorBox(a,e,dt,et,o),_e=Math.max($.lineHeight,_)),ot=0,ut=at.length;ot<ut;++ot)st(at[ot]),_e=$.lineHeight;each(nt.after,st)}tt=0,_e=$.lineHeight,each(this.afterBody,st),e.y-=d}drawFooter(e,a,o){const c=this.footer,d=c.length;let h,g;if(d){const _=getRtlAdapter(o.rtl,this.x,this.width);for(e.x=getAlignedX(this,o.footerAlign,o),e.y+=o.footerMarginTop,a.textAlign=_.textAlign(o.footerAlign),a.textBaseline="middle",h=toFont(o.footerFont),a.fillStyle=o.footerColor,a.font=h.string,g=0;g<d;++g)a.fillText(c[g],_.x(e.x),e.y+h.lineHeight/2),e.y+=h.lineHeight+o.footerSpacing}}drawBackground(e,a,o,c){const{xAlign:d,yAlign:h}=this,{x:g,y:_}=e,{width:b,height:j}=o,{topLeft:$,topRight:_e,bottomLeft:tt,bottomRight:et}=toTRBLCorners(c.cornerRadius);a.fillStyle=c.backgroundColor,a.strokeStyle=c.borderColor,a.lineWidth=c.borderWidth,a.beginPath(),a.moveTo(g+$,_),h==="top"&&this.drawCaret(e,a,o,c),a.lineTo(g+b-_e,_),a.quadraticCurveTo(g+b,_,g+b,_+_e),h==="center"&&d==="right"&&this.drawCaret(e,a,o,c),a.lineTo(g+b,_+j-et),a.quadraticCurveTo(g+b,_+j,g+b-et,_+j),h==="bottom"&&this.drawCaret(e,a,o,c),a.lineTo(g+tt,_+j),a.quadraticCurveTo(g,_+j,g,_+j-tt),h==="center"&&d==="left"&&this.drawCaret(e,a,o,c),a.lineTo(g,_+$),a.quadraticCurveTo(g,_,g+$,_),a.closePath(),a.fill(),c.borderWidth>0&&a.stroke()}_updateAnimationTarget(e){const a=this.chart,o=this.$animations,c=o&&o.x,d=o&&o.y;if(c||d){const h=positioners[e.position].call(this,this._active,this._eventPosition);if(!h)return;const g=this._size=getTooltipSize(this,e),_=Object.assign({},h,this._size),b=determineAlignment(a,e,_),j=getBackgroundPoint(e,_,b,a);(c._to!==j.x||d._to!==j.y)&&(this.xAlign=b.xAlign,this.yAlign=b.yAlign,this.width=g.width,this.height=g.height,this.caretX=h.x,this.caretY=h.y,this._resolveAnimations().update(this,j))}}_willRender(){return!!this.opacity}draw(e){const a=this.options.setContext(this.getContext());let o=this.opacity;if(!o)return;this._updateAnimationTarget(a);const c={width:this.width,height:this.height},d={x:this.x,y:this.y};o=Math.abs(o)<.001?0:o;const h=toPadding(a.padding),g=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;a.enabled&&g&&(e.save(),e.globalAlpha=o,this.drawBackground(d,e,c,a),overrideTextDirection(e,a.textDirection),d.y+=h.top,this.drawTitle(d,e,a),this.drawBody(d,e,a),this.drawFooter(d,e,a),restoreTextDirection(e,a.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,a){const o=this._active,c=e.map(({datasetIndex:g,index:_})=>{const b=this.chart.getDatasetMeta(g);if(!b)throw new Error("Cannot find a dataset at index "+g);return{datasetIndex:g,element:b.data[_],index:_}}),d=!_elementsEqual(o,c),h=this._positionChanged(c,a);(d||h)&&(this._active=c,this._eventPosition=a,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,a,o=!0){if(a&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const c=this.options,d=this._active||[],h=this._getActiveElements(e,d,a,o),g=this._positionChanged(h,e),_=a||!_elementsEqual(h,d)||g;return _&&(this._active=h,(c.enabled||c.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,a))),_}_getActiveElements(e,a,o,c){const d=this.options;if(e.type==="mouseout")return[];if(!c)return a.filter(g=>this.chart.data.datasets[g.datasetIndex]&&this.chart.getDatasetMeta(g.datasetIndex).controller.getParsed(g.index)!==void 0);const h=this.chart.getElementsAtEventForMode(e,d.mode,d,o);return d.reverse&&h.reverse(),h}_positionChanged(e,a){const{caretX:o,caretY:c,options:d}=this,h=positioners[d.position].call(this,e,a);return h!==!1&&(o!==h.x||c!==h.y)}}Sn(Tooltip,"positioners",positioners);var plugin_tooltip={id:"tooltip",_element:Tooltip,positioners,afterInit(s,e,a){a&&(s.tooltip=new Tooltip({chart:s,options:a}))},beforeUpdate(s,e,a){s.tooltip&&s.tooltip.initialize(a)},reset(s,e,a){s.tooltip&&s.tooltip.initialize(a)},afterDraw(s){const e=s.tooltip;if(e&&e._willRender()){const a={tooltip:e};if(s.notifyPlugins("beforeTooltipDraw",{...a,cancelable:!0})===!1)return;e.draw(s.ctx),s.notifyPlugins("afterTooltipDraw",a)}},afterEvent(s,e){if(s.tooltip){const a=e.replay;s.tooltip.handleEvent(e.event,a,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(s,e)=>e.bodyFont.size,boxWidth:(s,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:defaultCallbacks},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:s=>s!=="filter"&&s!=="itemSort"&&s!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const addIfString=(s,e,a,o)=>(typeof e=="string"?(a=s.push(e)-1,o.unshift({index:a,label:e})):isNaN(e)&&(a=null),a);function findOrAddLabel(s,e,a,o){const c=s.indexOf(e);if(c===-1)return addIfString(s,e,a,o);const d=s.lastIndexOf(e);return c!==d?a:c}const validIndex=(s,e)=>s===null?null:_limitValue(Math.round(s),0,e);function _getLabelForValue(s){const e=this.getLabels();return s>=0&&s<e.length?e[s]:s}class CategoryScale extends Scale{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const a=this._addedLabels;if(a.length){const o=this.getLabels();for(const{index:c,label:d}of a)o[c]===d&&o.splice(c,1);this._addedLabels=[]}super.init(e)}parse(e,a){if(isNullOrUndef(e))return null;const o=this.getLabels();return a=isFinite(a)&&o[a]===e?a:findOrAddLabel(o,e,valueOrDefault(a,e),this._addedLabels),validIndex(a,o.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:a}=this.getUserBounds();let{min:o,max:c}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(o=0),a||(c=this.getLabels().length-1)),this.min=o,this.max=c}buildTicks(){const e=this.min,a=this.max,o=this.options.offset,c=[];let d=this.getLabels();d=e===0&&a===d.length-1?d:d.slice(e,a+1),this._valueRange=Math.max(d.length-(o?0:1),1),this._startValue=this.min-(o?.5:0);for(let h=e;h<=a;h++)c.push({value:h});return c}getLabelForValue(e){return _getLabelForValue.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const a=this.ticks;return e<0||e>a.length-1?null:this.getPixelForValue(a[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}Sn(CategoryScale,"id","category"),Sn(CategoryScale,"defaults",{ticks:{callback:_getLabelForValue}});function generateTicks$1(s,e){const a=[],{bounds:c,step:d,min:h,max:g,precision:_,count:b,maxTicks:j,maxDigits:$,includeBounds:_e}=s,tt=d||1,et=j-1,{min:st,max:rt}=e,nt=!isNullOrUndef(h),it=!isNullOrUndef(g),at=!isNullOrUndef(b),dt=(rt-st)/($+1);let ot=niceNum((rt-st)/et/tt)*tt,ht,ut,pt,_t;if(ot<1e-14&&!nt&&!it)return[{value:st},{value:rt}];_t=Math.ceil(rt/ot)-Math.floor(st/ot),_t>et&&(ot=niceNum(_t*ot/et/tt)*tt),isNullOrUndef(_)||(ht=Math.pow(10,_),ot=Math.ceil(ot*ht)/ht),c==="ticks"?(ut=Math.floor(st/ot)*ot,pt=Math.ceil(rt/ot)*ot):(ut=st,pt=rt),nt&&it&&d&&almostWhole((g-h)/d,ot/1e3)?(_t=Math.round(Math.min((g-h)/ot,j)),ot=(g-h)/_t,ut=h,pt=g):at?(ut=nt?h:ut,pt=it?g:pt,_t=b-1,ot=(pt-ut)/_t):(_t=(pt-ut)/ot,almostEquals(_t,Math.round(_t),ot/1e3)?_t=Math.round(_t):_t=Math.ceil(_t));const wt=Math.max(_decimalPlaces(ot),_decimalPlaces(ut));ht=Math.pow(10,isNullOrUndef(_)?wt:_),ut=Math.round(ut*ht)/ht,pt=Math.round(pt*ht)/ht;let mt=0;for(nt&&(_e&&ut!==h?(a.push({value:h}),ut<h&&mt++,almostEquals(Math.round((ut+mt*ot)*ht)/ht,h,relativeLabelSize(h,dt,s))&&mt++):ut<h&&mt++);mt<_t;++mt){const Et=Math.round((ut+mt*ot)*ht)/ht;if(it&&Et>g)break;a.push({value:Et})}return it&&_e&&pt!==g?a.length&&almostEquals(a[a.length-1].value,g,relativeLabelSize(g,dt,s))?a[a.length-1].value=g:a.push({value:g}):(!it||pt===g)&&a.push({value:pt}),a}function relativeLabelSize(s,e,{horizontal:a,minRotation:o}){const c=toRadians(o),d=(a?Math.sin(c):Math.cos(c))||.001,h=.75*e*(""+s).length;return Math.min(e/d,h)}class LinearScaleBase extends Scale{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,a){return isNullOrUndef(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:a,maxDefined:o}=this.getUserBounds();let{min:c,max:d}=this;const h=_=>c=a?c:_,g=_=>d=o?d:_;if(e){const _=sign(c),b=sign(d);_<0&&b<0?g(0):_>0&&b>0&&h(0)}if(c===d){let _=d===0?1:Math.abs(d*.05);g(d+_),e||h(c-_)}this.min=c,this.max=d}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:a,stepSize:o}=e,c;return o?(c=Math.ceil(this.max/o)-Math.floor(this.min/o)+1,c>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${o} would result generating up to ${c} ticks. Limiting to 1000.`),c=1e3)):(c=this.computeTickLimit(),a=a||11),a&&(c=Math.min(a,c)),c}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,a=e.ticks;let o=this.getTickLimit();o=Math.max(2,o);const c={maxTicks:o,bounds:e.bounds,min:e.min,max:e.max,precision:a.precision,step:a.stepSize,count:a.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:a.minRotation||0,includeBounds:a.includeBounds!==!1},d=this._range||this,h=generateTicks$1(c,d);return e.bounds==="ticks"&&_setMinAndMaxByKey(h,this,"value"),e.reverse?(h.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),h}configure(){const e=this.ticks;let a=this.min,o=this.max;if(super.configure(),this.options.offset&&e.length){const c=(o-a)/Math.max(e.length-1,1)/2;a-=c,o+=c}this._startValue=a,this._endValue=o,this._valueRange=o-a}getLabelForValue(e){return formatNumber(e,this.chart.options.locale,this.options.ticks.format)}}class LinearScale extends LinearScaleBase{determineDataLimits(){const{min:e,max:a}=this.getMinMax(!0);this.min=isNumberFinite(e)?e:0,this.max=isNumberFinite(a)?a:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),a=e?this.width:this.height,o=toRadians(this.options.ticks.minRotation),c=(e?Math.sin(o):Math.cos(o))||.001,d=this._resolveTickFontOptions(0);return Math.ceil(a/Math.min(40,d.lineHeight/c))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Sn(LinearScale,"id","linear"),Sn(LinearScale,"defaults",{ticks:{callback:Ticks.formatters.numeric}});const INTERVALS={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},UNITS=Object.keys(INTERVALS);function sorter(s,e){return s-e}function parse(s,e){if(isNullOrUndef(e))return null;const a=s._adapter,{parser:o,round:c,isoWeekday:d}=s._parseOpts;let h=e;return typeof o=="function"&&(h=o(h)),isNumberFinite(h)||(h=typeof o=="string"?a.parse(h,o):a.parse(h)),h===null?null:(c&&(h=c==="week"&&(isNumber(d)||d===!0)?a.startOf(h,"isoWeek",d):a.startOf(h,c)),+h)}function determineUnitForAutoTicks(s,e,a,o){const c=UNITS.length;for(let d=UNITS.indexOf(s);d<c-1;++d){const h=INTERVALS[UNITS[d]],g=h.steps?h.steps:Number.MAX_SAFE_INTEGER;if(h.common&&Math.ceil((a-e)/(g*h.size))<=o)return UNITS[d]}return UNITS[c-1]}function determineUnitForFormatting(s,e,a,o,c){for(let d=UNITS.length-1;d>=UNITS.indexOf(a);d--){const h=UNITS[d];if(INTERVALS[h].common&&s._adapter.diff(c,o,h)>=e-1)return h}return UNITS[a?UNITS.indexOf(a):0]}function determineMajorUnit(s){for(let e=UNITS.indexOf(s)+1,a=UNITS.length;e<a;++e)if(INTERVALS[UNITS[e]].common)return UNITS[e]}function addTick(s,e,a){if(!a)s[e]=!0;else if(a.length){const{lo:o,hi:c}=_lookup(a,e),d=a[o]>=e?a[o]:a[c];s[d]=!0}}function setMajorTicks(s,e,a,o){const c=s._adapter,d=+c.startOf(e[0].value,o),h=e[e.length-1].value;let g,_;for(g=d;g<=h;g=+c.add(g,1,o))_=a[g],_>=0&&(e[_].major=!0);return e}function ticksFromTimestamps(s,e,a){const o=[],c={},d=e.length;let h,g;for(h=0;h<d;++h)g=e[h],c[g]=h,o.push({value:g,major:!1});return d===0||!a?o:setMajorTicks(s,o,c,a)}class TimeScale extends Scale{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,a={}){const o=e.time||(e.time={}),c=this._adapter=new adapters._date(e.adapters.date);c.init(a),mergeIf(o.displayFormats,c.formats()),this._parseOpts={parser:o.parser,round:o.round,isoWeekday:o.isoWeekday},super.init(e),this._normalized=a.normalized}parse(e,a){return e===void 0?null:parse(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,a=this._adapter,o=e.time.unit||"day";let{min:c,max:d,minDefined:h,maxDefined:g}=this.getUserBounds();function _(b){!h&&!isNaN(b.min)&&(c=Math.min(c,b.min)),!g&&!isNaN(b.max)&&(d=Math.max(d,b.max))}(!h||!g)&&(_(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&_(this.getMinMax(!1))),c=isNumberFinite(c)&&!isNaN(c)?c:+a.startOf(Date.now(),o),d=isNumberFinite(d)&&!isNaN(d)?d:+a.endOf(Date.now(),o)+1,this.min=Math.min(c,d-1),this.max=Math.max(c+1,d)}_getLabelBounds(){const e=this.getLabelTimestamps();let a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;return e.length&&(a=e[0],o=e[e.length-1]),{min:a,max:o}}buildTicks(){const e=this.options,a=e.time,o=e.ticks,c=o.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&c.length&&(this.min=this._userMin||c[0],this.max=this._userMax||c[c.length-1]);const d=this.min,h=this.max,g=_filterBetween(c,d,h);return this._unit=a.unit||(o.autoSkip?determineUnitForAutoTicks(a.minUnit,this.min,this.max,this._getLabelCapacity(d)):determineUnitForFormatting(this,g.length,a.minUnit,this.min,this.max)),this._majorUnit=!o.major.enabled||this._unit==="year"?void 0:determineMajorUnit(this._unit),this.initOffsets(c),e.reverse&&g.reverse(),ticksFromTimestamps(this,g,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let a=0,o=0,c,d;this.options.offset&&e.length&&(c=this.getDecimalForValue(e[0]),e.length===1?a=1-c:a=(this.getDecimalForValue(e[1])-c)/2,d=this.getDecimalForValue(e[e.length-1]),e.length===1?o=d:o=(d-this.getDecimalForValue(e[e.length-2]))/2);const h=e.length<3?.5:.25;a=_limitValue(a,0,h),o=_limitValue(o,0,h),this._offsets={start:a,end:o,factor:1/(a+1+o)}}_generate(){const e=this._adapter,a=this.min,o=this.max,c=this.options,d=c.time,h=d.unit||determineUnitForAutoTicks(d.minUnit,a,o,this._getLabelCapacity(a)),g=valueOrDefault(c.ticks.stepSize,1),_=h==="week"?d.isoWeekday:!1,b=isNumber(_)||_===!0,j={};let $=a,_e,tt;if(b&&($=+e.startOf($,"isoWeek",_)),$=+e.startOf($,b?"day":h),e.diff(o,a,h)>1e5*g)throw new Error(a+" and "+o+" are too far apart with stepSize of "+g+" "+h);const et=c.ticks.source==="data"&&this.getDataTimestamps();for(_e=$,tt=0;_e<o;_e=+e.add(_e,g,h),tt++)addTick(j,_e,et);return(_e===o||c.bounds==="ticks"||tt===1)&&addTick(j,_e,et),Object.keys(j).sort(sorter).map(st=>+st)}getLabelForValue(e){const a=this._adapter,o=this.options.time;return o.tooltipFormat?a.format(e,o.tooltipFormat):a.format(e,o.displayFormats.datetime)}format(e,a){const c=this.options.time.displayFormats,d=this._unit,h=a||c[d];return this._adapter.format(e,h)}_tickFormatFunction(e,a,o,c){const d=this.options,h=d.ticks.callback;if(h)return callback(h,[e,a,o],this);const g=d.time.displayFormats,_=this._unit,b=this._majorUnit,j=_&&g[_],$=b&&g[b],_e=o[a],tt=b&&$&&_e&&_e.major;return this._adapter.format(e,c||(tt?$:j))}generateTickLabels(e){let a,o,c;for(a=0,o=e.length;a<o;++a)c=e[a],c.label=this._tickFormatFunction(c.value,a,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const a=this._offsets,o=this.getDecimalForValue(e);return this.getPixelForDecimal((a.start+o)*a.factor)}getValueForPixel(e){const a=this._offsets,o=this.getDecimalForPixel(e)/a.factor-a.end;return this.min+o*(this.max-this.min)}_getLabelSize(e){const a=this.options.ticks,o=this.ctx.measureText(e).width,c=toRadians(this.isHorizontal()?a.maxRotation:a.minRotation),d=Math.cos(c),h=Math.sin(c),g=this._resolveTickFontOptions(0).size;return{w:o*d+g*h,h:o*h+g*d}}_getLabelCapacity(e){const a=this.options.time,o=a.displayFormats,c=o[a.unit]||o.millisecond,d=this._tickFormatFunction(e,0,ticksFromTimestamps(this,[e],this._majorUnit),c),h=this._getLabelSize(d),g=Math.floor(this.isHorizontal()?this.width/h.w:this.height/h.h)-1;return g>0?g:1}getDataTimestamps(){let e=this._cache.data||[],a,o;if(e.length)return e;const c=this.getMatchingVisibleMetas();if(this._normalized&&c.length)return this._cache.data=c[0].controller.getAllParsedValues(this);for(a=0,o=c.length;a<o;++a)e=e.concat(c[a].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let a,o;if(e.length)return e;const c=this.getLabels();for(a=0,o=c.length;a<o;++a)e.push(parse(this,c[a]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return _arrayUnique(e.sort(sorter))}}Sn(TimeScale,"id","time"),Sn(TimeScale,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function interpolate(s,e,a){let o=0,c=s.length-1,d,h,g,_;a?(e>=s[o].pos&&e<=s[c].pos&&({lo:o,hi:c}=_lookupByKey(s,"pos",e)),{pos:d,time:g}=s[o],{pos:h,time:_}=s[c]):(e>=s[o].time&&e<=s[c].time&&({lo:o,hi:c}=_lookupByKey(s,"time",e)),{time:d,pos:g}=s[o],{time:h,pos:_}=s[c]);const b=h-d;return b?g+(_-g)*(e-d)/b:g}class TimeSeriesScale extends TimeScale{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),a=this._table=this.buildLookupTable(e);this._minPos=interpolate(a,this.min),this._tableRange=interpolate(a,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:a,max:o}=this,c=[],d=[];let h,g,_,b,j;for(h=0,g=e.length;h<g;++h)b=e[h],b>=a&&b<=o&&c.push(b);if(c.length<2)return[{time:a,pos:0},{time:o,pos:1}];for(h=0,g=c.length;h<g;++h)j=c[h+1],_=c[h-1],b=c[h],Math.round((j+_)/2)!==b&&d.push({time:b,pos:h/(g-1)});return d}_generate(){const e=this.min,a=this.max;let o=super.getDataTimestamps();return(!o.includes(e)||!o.length)&&o.splice(0,0,e),(!o.includes(a)||o.length===1)&&o.push(a),o.sort((c,d)=>c-d)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const a=this.getDataTimestamps(),o=this.getLabelTimestamps();return a.length&&o.length?e=this.normalize(a.concat(o)):e=a.length?a:o,e=this._cache.all=e,e}getDecimalForValue(e){return(interpolate(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const a=this._offsets,o=this.getDecimalForPixel(e)/a.factor-a.end;return interpolate(this._table,o*this._tableRange+this._minPos,!0)}}Sn(TimeSeriesScale,"id","timeseries"),Sn(TimeSeriesScale,"defaults",TimeScale.defaults);const defaultDatasetIdKey="label";function reforwardRef(s,e){typeof s=="function"?s(e):s&&(s.current=e)}function setOptions(s,e){const a=s.options;a&&e&&Object.assign(a,e)}function setLabels(s,e){s.labels=e}function setDatasets(s,e){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:defaultDatasetIdKey;const o=[];s.datasets=e.map(c=>{const d=s.datasets.find(h=>h[a]===c[a]);return!d||!c.data||o.includes(d)?{...c}:(o.push(d),Object.assign(d,c),d)})}function cloneData(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:defaultDatasetIdKey;const a={labels:[],datasets:[]};return setLabels(a,s.labels),setDatasets(a,s.datasets,e),a}function ChartComponent(s,e){const{height:a=150,width:o=300,redraw:c=!1,datasetIdKey:d,type:h,data:g,options:_,plugins:b=[],fallbackContent:j,updateMode:$,..._e}=s,tt=reactExports.useRef(null),et=reactExports.useRef(null),st=()=>{tt.current&&(et.current=new Chart$1(tt.current,{type:h,data:cloneData(g,d),options:_&&{..._},plugins:b}),reforwardRef(e,et.current))},rt=()=>{reforwardRef(e,null),et.current&&(et.current.destroy(),et.current=null)};return reactExports.useEffect(()=>{!c&&et.current&&_&&setOptions(et.current,_)},[c,_]),reactExports.useEffect(()=>{!c&&et.current&&setLabels(et.current.config.data,g.labels)},[c,g.labels]),reactExports.useEffect(()=>{!c&&et.current&&g.datasets&&setDatasets(et.current.config.data,g.datasets,d)},[c,g.datasets]),reactExports.useEffect(()=>{et.current&&(c?(rt(),setTimeout(st)):et.current.update($))},[c,_,g.labels,g.datasets,$]),reactExports.useEffect(()=>{et.current&&(rt(),setTimeout(st))},[h]),reactExports.useEffect(()=>(st(),()=>rt()),[]),React.createElement("canvas",{ref:tt,role:"img",height:a,width:o,..._e},j)}const Chart=reactExports.forwardRef(ChartComponent);function createTypedChart(s,e){return Chart$1.register(e),reactExports.forwardRef((a,o)=>React.createElement(Chart,{...a,ref:o,type:s}))}const Bar=createTypedChart("bar",BarController),Doughnut=createTypedChart("doughnut",DoughnutController);Chart$1.register(CategoryScale,LinearScale,BarElement,ArcElement,plugin_title,plugin_tooltip,plugin_legend);const AssessmentCharts=({evaluation:s})=>{const e=parseInt(s.mcq_evaluation.score.split("/")[0]),a=parseInt(s.mcq_evaluation.score.split("/")[1]),o=e/a*100,c=parseInt(s.rubric_evaluation[0].score.split("/")[0]),d=parseInt(s.rubric_evaluation[0].score.split("/")[1]),h=c/d*100,g={labels:["MCQs","Deliverables"],datasets:[{data:[o,h],backgroundColor:["rgba(52, 152, 219, 0.8)","rgba(46, 204, 113, 0.8)"],borderColor:["rgba(52, 152, 219, 1)","rgba(46, 204, 113, 1)"],borderWidth:2}]},_={labels:s.rubric_evaluation.map($=>$.criteria),datasets:[{label:"Score",data:s.rubric_evaluation.map($=>parseInt($.score.split("/")[0])),backgroundColor:"rgba(155, 89, 182, 0.8)",borderColor:"rgba(155, 89, 182, 1)",borderWidth:1,borderRadius:5}]},b={responsive:!0,plugins:{legend:{position:"top",labels:{font:{size:14,family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif"},padding:20}},title:{display:!0,text:"Score Distribution (%)",font:{size:18,weight:"bold"},padding:20},tooltip:{callbacks:{label:function($){return`${$.label}: ${Math.round($.raw)}%`}}}},cutout:"60%"},j={responsive:!0,plugins:{legend:{display:!1},title:{display:!0,text:"Performance by Criteria",font:{size:18,weight:"bold"},padding:20}},scales:{y:{beginAtZero:!0,max:10,ticks:{stepSize:2,font:{size:12}},grid:{display:!0,color:"rgba(0, 0, 0, 0.1)"}},x:{ticks:{font:{size:12},maxRotation:45,minRotation:45},grid:{display:!1}}}};return jsxRuntimeExports.jsx("div",{className:"charts-container",children:jsxRuntimeExports.jsxs("div",{className:"chart-row",children:[jsxRuntimeExports.jsx("div",{className:"chart-card",children:jsxRuntimeExports.jsx(Doughnut,{data:g,options:b})}),jsxRuntimeExports.jsx("div",{className:"chart-card",children:jsxRuntimeExports.jsx(Bar,{data:_,options:j})})]})})};pdfExports.GlobalWorkerOptions.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.min.js`;const model=new ChatGroq({model:"mixtral-8x7b-32768",temperature:.5,apiKey:"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"}),Assessment=()=>{const s=useLocation(),e=useNavigate(),{project:a,criteria:o}=s.state||{},[c,d]=reactExports.useState([]),[h,g]=reactExports.useState({}),[_,b]=reactExports.useState(!0),[j,$]=reactExports.useState(null),[_e,tt]=reactExports.useState({}),[et,st]=reactExports.useState(null),[rt,nt]=reactExports.useState(!1),[it,at]=reactExports.useState(!1),[dt,ot]=reactExports.useState(""),[ht,ut]=reactExports.useState(!1);reactExports.useEffect(()=>{if(!a||!o){e("/terms");return}pt()},[a,o]);const pt=async()=>{try{const St=`Generate 10 multiple choice questions (MCQs) for assessing knowledge of ${a.title}. 
        The assessment criteria is: ${o.name}.

        Return the MCQs in the following JSON format:
        {
          "mcqs": [
            {
              "question": "Question text here",
              "options": ["Option 1", "Option 2", "Option 3", "Option 4"],
              "correctAnswer": 0,
              "explanation": "Explanation for the correct answer"
            }
          ]
        }

        Requirements:
        1. Generate EXACTLY 10 questions
        2. Each question MUST have EXACTLY 4 options
        3. correctAnswer MUST be a number from 0-3 indicating the index of the correct option
        4. Focus on testing understanding of core concepts
        5. Return ONLY valid JSON with NO special characters or line breaks in strings
        6. Escape all quotes within strings
        7. Keep questions and options concise
        8. Do not include any text outside the JSON structure`;try{const Ct=(await model.call([{role:"system",content:St},{role:"user",content:"Generate MCQs in the specified JSON format."}])).content.trim().replace(/^[^{]*/,"").replace(/[^}]*$/,""),Rt=JSON.parse(Ct);if(!Rt.mcqs||!Array.isArray(Rt.mcqs))throw new Error("Invalid MCQ format: mcqs array not found");const bt=Rt.mcqs.map((Tt,$t)=>{const xt=ft=>String(ft).replace(/[\x00-\x1F\x7F-\x9F]/g,"");return{id:$t+1,question:xt(Tt.question)||`Question ${$t+1}`,options:Array.isArray(Tt.options)?Tt.options.map(xt).slice(0,4):["Option A","Option B","Option C","Option D"],correctAnswer:typeof Tt.correctAnswer=="number"&&Tt.correctAnswer>=0&&Tt.correctAnswer<=3?Tt.correctAnswer:0,explanation:xt(Tt.explanation)||"No explanation provided"}});if(bt.length!==10)throw new Error(`Expected 10 MCQs, but got ${bt.length}`);d(bt),$(null)}catch(Ot){console.error("Error in MCQ generation:",Ot),$(`Failed to generate MCQs: ${Ot.message}. Please try again.`);const Ct=Array(5).fill(null).map((Rt,bt)=>({id:bt+1,question:`Sample Question ${bt+1} about ${a.title}?`,options:["Option A","Option B","Option C","Option D"],correctAnswer:0,explanation:"This is a sample question."}));d(Ct)}b(!1)}catch(St){console.error("Error generating MCQs:",St),$("Failed to generate questions. Please try again."),b(!1)}},_t=(St,Ot)=>{g(Ct=>({...Ct,[St]:Ot}))},wt=async St=>{try{const Ot=await St.arrayBuffer(),Ct=await pdfExports.getDocument({data:Ot}).promise;let Rt="";for(let bt=1;bt<=Ct.numPages;bt++){const xt=(await(await Ct.getPage(bt)).getTextContent()).items.map(ft=>ft.str).join(" ");Rt+=xt+" "}return Rt.trim()}catch(Ot){throw console.error("Error extracting text from PDF:",Ot),new Error("Failed to read PDF content")}},mt=async(St,Ot)=>{try{const Ct=await wt(Ot);tt(Rt=>({...Rt,[St]:{file:Ot,text:Ct}}))}catch{$("Error reading PDF file. Please try again.")}},Et=async()=>{at(!0);try{const St=Object.values(_e).map(bt=>bt.text).join(`

`),Ot=`
        You are an expert assessment evaluator. Evaluate this submission based on:

        Project: ${a.title}
        Assessment Criteria: ${o.name}
        Objective: ${o.objective}
        Tasks: ${o.tasks}
        Rubrics: ${JSON.stringify(o.rubrics)}

        MCQ Answers: ${JSON.stringify(h)}
        Deliverable Content: ${St}

        Provide evaluation in this JSON format:
        {
          "mcq_evaluation": {
            "score": "X/10",
            "feedback": "Detailed feedback"
          },
          "rubric_evaluation": [
            {
              "criteria": "Criteria Name",
              "level": "Achieved Level",
              "score": "X/10",
              "feedback": "Detailed feedback"
            }
          ],
          "total_score": "X/30",
          "improvement_suggestions": [
            "Detailed suggestions"
          ],
          "ai_opinion": "Comprehensive analysis and recommendations"
        }
      `,Ct=await model.call([{role:"system",content:Ot},{role:"user",content:"Evaluate the submission now."}]),Rt=JSON.parse(Ct.content);st(Rt),ot(Rt.ai_opinion),nt(!0)}catch{$("Error evaluating submission. Please try again.")}finally{at(!1)}},Pt=()=>{if("speechSynthesis"in window){const St=new SpeechSynthesisUtterance(dt);St.onend=()=>ut(!1),ut(!0),window.speechSynthesis.speak(St)}},jt=()=>{"speechSynthesis"in window&&(window.speechSynthesis.cancel(),ut(!1))};return _?jsxRuntimeExports.jsx("div",{className:"loading",children:"Generating assessment questions..."}):j?jsxRuntimeExports.jsx("div",{className:"error",children:j}):rt?jsxRuntimeExports.jsxs("div",{className:"assessment-container",children:[jsxRuntimeExports.jsxs("div",{className:"results-header",children:[jsxRuntimeExports.jsx("h2",{children:"Assessment Results"}),jsxRuntimeExports.jsx("h3",{children:a.title}),jsxRuntimeExports.jsx("p",{className:"criteria-name",children:o.name})]}),jsxRuntimeExports.jsx("div",{className:"results-content",children:rt&&et&&jsxRuntimeExports.jsxs("div",{className:"results-container",children:[jsxRuntimeExports.jsx(AssessmentCharts,{evaluation:et}),jsxRuntimeExports.jsx("div",{className:"score-overview",children:jsxRuntimeExports.jsxs("h3",{children:["Total Score: ",et.total_score]})}),jsxRuntimeExports.jsxs("div",{className:"evaluation-section",children:[jsxRuntimeExports.jsx("h3",{children:"MCQ Evaluation"}),jsxRuntimeExports.jsxs("div",{className:"evaluation-card",children:[jsxRuntimeExports.jsxs("p",{className:"score",children:["Score: ",et.mcq_evaluation.score]}),jsxRuntimeExports.jsx("p",{className:"feedback",children:et.mcq_evaluation.feedback})]})]}),jsxRuntimeExports.jsxs("div",{className:"evaluation-section",children:[jsxRuntimeExports.jsx("h3",{children:"Rubric Evaluation"}),jsxRuntimeExports.jsx("div",{className:"rubric-table",children:jsxRuntimeExports.jsxs("table",{children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Criteria"}),jsxRuntimeExports.jsx("th",{children:"Level"}),jsxRuntimeExports.jsx("th",{children:"Score"})]})}),jsxRuntimeExports.jsx("tbody",{children:et.rubric_evaluation.map((St,Ot)=>jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{children:St.criteria}),jsxRuntimeExports.jsx("td",{children:St.level}),jsxRuntimeExports.jsx("td",{children:St.score})]},Ot))})]})})]}),jsxRuntimeExports.jsxs("div",{className:"improvement-section",children:[jsxRuntimeExports.jsx("h3",{children:"Areas for Improvement"}),jsxRuntimeExports.jsx("ul",{children:et.improvement_suggestions.map((St,Ot)=>jsxRuntimeExports.jsx("li",{children:St},Ot))})]}),jsxRuntimeExports.jsxs("div",{className:"ai-opinion-section",children:[jsxRuntimeExports.jsx("h3",{children:"AI Opinion"}),jsxRuntimeExports.jsxs("div",{className:"ai-opinion-content",children:[jsxRuntimeExports.jsx("p",{children:dt}),jsxRuntimeExports.jsx("button",{className:"voice-button",onClick:ht?jt:Pt,children:ht?"Stop AI Voice":"Play AI Voice"})]})]}),jsxRuntimeExports.jsx("button",{className:"new-assessment-button",onClick:()=>e("/terms"),children:"Start New Assessment"})]})})]}):jsxRuntimeExports.jsxs("div",{className:"assessment-container",children:[jsxRuntimeExports.jsxs("div",{className:"assessment-header",children:[jsxRuntimeExports.jsx("h2",{children:a.title}),jsxRuntimeExports.jsx("p",{className:"criteria-name",children:o.name})]}),jsxRuntimeExports.jsxs("div",{className:"assessment-content",children:[jsxRuntimeExports.jsxs("div",{className:"mcq-section",children:[jsxRuntimeExports.jsx("h3",{children:"Multiple Choice Questions"}),c.map((St,Ot)=>jsxRuntimeExports.jsxs("div",{className:"question-card",children:[jsxRuntimeExports.jsxs("h4",{children:["Question ",Ot+1]}),jsxRuntimeExports.jsx("p",{children:St.question}),jsxRuntimeExports.jsx("div",{className:"options",children:St.options.map((Ct,Rt)=>jsxRuntimeExports.jsxs("label",{className:"option-label",children:[jsxRuntimeExports.jsx("input",{type:"radio",name:`question-${St.id}`,value:Rt,checked:h[St.id]===Rt,onChange:()=>_t(St.id,Rt)}),Ct]},Rt))})]},St.id))]}),jsxRuntimeExports.jsxs("div",{className:"deliverables-section",children:[jsxRuntimeExports.jsx("h3",{children:"Upload Deliverables"}),o.deliverables.map((St,Ot)=>jsxRuntimeExports.jsxs("div",{className:"deliverable-item",children:[jsxRuntimeExports.jsx("p",{children:St}),jsxRuntimeExports.jsx("input",{type:"file",onChange:Ct=>mt(Ot,Ct.target.files[0]),accept:".pdf"})]},Ot))]}),jsxRuntimeExports.jsx("button",{className:"submit-button",onClick:Et,disabled:it||Object.keys(h).length!==c.length||Object.keys(_e).length!==o.deliverables.length,children:it?"Evaluating...":"Submit for Evaluation"})]})]})};/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */const{entries,setPrototypeOf,isFrozen,getPrototypeOf,getOwnPropertyDescriptor}=Object;let{freeze,seal,create}=Object,{apply,construct}=typeof Reflect<"u"&&Reflect;freeze||(freeze=function(e){return e});seal||(seal=function(e){return e});apply||(apply=function(e,a,o){return e.apply(a,o)});construct||(construct=function(e,a){return new e(...a)});const arrayForEach=unapply(Array.prototype.forEach),arrayLastIndexOf=unapply(Array.prototype.lastIndexOf),arrayPop=unapply(Array.prototype.pop),arrayPush=unapply(Array.prototype.push),arraySplice=unapply(Array.prototype.splice),stringToLowerCase=unapply(String.prototype.toLowerCase),stringToString=unapply(String.prototype.toString),stringMatch=unapply(String.prototype.match),stringReplace=unapply(String.prototype.replace),stringIndexOf=unapply(String.prototype.indexOf),stringTrim=unapply(String.prototype.trim),objectHasOwnProperty=unapply(Object.prototype.hasOwnProperty),regExpTest=unapply(RegExp.prototype.test),typeErrorCreate=unconstruct(TypeError);function unapply(s){return function(e){for(var a=arguments.length,o=new Array(a>1?a-1:0),c=1;c<a;c++)o[c-1]=arguments[c];return apply(s,e,o)}}function unconstruct(s){return function(){for(var e=arguments.length,a=new Array(e),o=0;o<e;o++)a[o]=arguments[o];return construct(s,a)}}function addToSet(s,e){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:stringToLowerCase;setPrototypeOf&&setPrototypeOf(s,null);let o=e.length;for(;o--;){let c=e[o];if(typeof c=="string"){const d=a(c);d!==c&&(isFrozen(e)||(e[o]=d),c=d)}s[c]=!0}return s}function cleanArray(s){for(let e=0;e<s.length;e++)objectHasOwnProperty(s,e)||(s[e]=null);return s}function clone(s){const e=create(null);for(const[a,o]of entries(s))objectHasOwnProperty(s,a)&&(Array.isArray(o)?e[a]=cleanArray(o):o&&typeof o=="object"&&o.constructor===Object?e[a]=clone(o):e[a]=o);return e}function lookupGetter(s,e){for(;s!==null;){const o=getOwnPropertyDescriptor(s,e);if(o){if(o.get)return unapply(o.get);if(typeof o.value=="function")return unapply(o.value)}s=getPrototypeOf(s)}function a(){return null}return a}const html$1=freeze(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),svg$1=freeze(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),svgFilters=freeze(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),svgDisallowed=freeze(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mathMl$1=freeze(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),mathMlDisallowed=freeze(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=freeze(["#text"]),html=freeze(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),svg=freeze(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mathMl=freeze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),xml=freeze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),MUSTACHE_EXPR=seal(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ERB_EXPR=seal(/<%[\w\W]*|[\w\W]*%>/gm),TMPLIT_EXPR=seal(/\$\{[\w\W]*/gm),DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]+$/),ARIA_ATTR=seal(/^aria-[\-\w]+$/),IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i),ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),DOCTYPE_NAME=seal(/^html$/i),CUSTOM_ELEMENT=seal(/^[a-z][.\w]*(-[.\w]+)+$/i);var EXPRESSIONS=Object.freeze({__proto__:null,ARIA_ATTR,ATTR_WHITESPACE,CUSTOM_ELEMENT,DATA_ATTR,DOCTYPE_NAME,ERB_EXPR,IS_ALLOWED_URI,IS_SCRIPT_OR_DATA,MUSTACHE_EXPR,TMPLIT_EXPR});const NODE_TYPE={element:1,text:3,progressingInstruction:7,comment:8,document:9},getGlobal=function s(){return typeof window>"u"?null:window},_createTrustedTypesPolicy=function s(e,a){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let o=null;const c="data-tt-policy-suffix";a&&a.hasAttribute(c)&&(o=a.getAttribute(c));const d="dompurify"+(o?"#"+o:"");try{return e.createPolicy(d,{createHTML(h){return h},createScriptURL(h){return h}})}catch{return console.warn("TrustedTypes policy "+d+" could not be created."),null}},_createHooksMap=function s(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function createDOMPurify(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:getGlobal();const e=Rn=>createDOMPurify(Rn);if(e.version="3.2.4",e.removed=[],!s||!s.document||s.document.nodeType!==NODE_TYPE.document||!s.Element)return e.isSupported=!1,e;let{document:a}=s;const o=a,c=o.currentScript,{DocumentFragment:d,HTMLTemplateElement:h,Node:g,Element:_,NodeFilter:b,NamedNodeMap:j=s.NamedNodeMap||s.MozNamedAttrMap,HTMLFormElement:$,DOMParser:_e,trustedTypes:tt}=s,et=_.prototype,st=lookupGetter(et,"cloneNode"),rt=lookupGetter(et,"remove"),nt=lookupGetter(et,"nextSibling"),it=lookupGetter(et,"childNodes"),at=lookupGetter(et,"parentNode");if(typeof h=="function"){const Rn=a.createElement("template");Rn.content&&Rn.content.ownerDocument&&(a=Rn.content.ownerDocument)}let dt,ot="";const{implementation:ht,createNodeIterator:ut,createDocumentFragment:pt,getElementsByTagName:_t}=a,{importNode:wt}=o;let mt=_createHooksMap();e.isSupported=typeof entries=="function"&&typeof at=="function"&&ht&&ht.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Et,ERB_EXPR:Pt,TMPLIT_EXPR:jt,DATA_ATTR:St,ARIA_ATTR:Ot,IS_SCRIPT_OR_DATA:Ct,ATTR_WHITESPACE:Rt,CUSTOM_ELEMENT:bt}=EXPRESSIONS;let{IS_ALLOWED_URI:Tt}=EXPRESSIONS,$t=null;const xt=addToSet({},[...html$1,...svg$1,...svgFilters,...mathMl$1,...text]);let ft=null;const yt=addToSet({},[...html,...svg,...mathMl,...xml]);let vt=Object.seal(create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),It=null,Lt=null,Nt=!0,Bt=!0,Kt=!1,rn=!0,nn=!1,on=!0,cn=!1,hn=!1,Zt=!1,Gt=!1,At=!1,Ft=!1,Vt=!0,qt=!1;const an="user-content-";let fn=!0,un=!1,zt={},gn=null;const mn=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Fn=null;const Ln=addToSet({},["audio","video","img","source","image","track"]);let Bn=null;const An=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),In="http://www.w3.org/1998/Math/MathML",Un="http://www.w3.org/2000/svg",Hn="http://www.w3.org/1999/xhtml";let ln=Hn,Xt=!1,Jt=null;const xn=addToSet({},[In,Un,Hn],stringToString);let $n=addToSet({},["mi","mo","mn","ms","mtext"]),Dn=addToSet({},["annotation-xml"]);const Dt=addToSet({},["title","style","font","a","script"]);let sn=null;const yn=["application/xhtml+xml","text/html"],Pn="text/html";let vn=null,wn=null;const Mt=a.createElement("form"),kt=function(Wt){return Wt instanceof RegExp||Wt instanceof Function},Ut=function(){let Wt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(wn&&wn===Wt)){if((!Wt||typeof Wt!="object")&&(Wt={}),Wt=clone(Wt),sn=yn.indexOf(Wt.PARSER_MEDIA_TYPE)===-1?Pn:Wt.PARSER_MEDIA_TYPE,vn=sn==="application/xhtml+xml"?stringToString:stringToLowerCase,$t=objectHasOwnProperty(Wt,"ALLOWED_TAGS")?addToSet({},Wt.ALLOWED_TAGS,vn):xt,ft=objectHasOwnProperty(Wt,"ALLOWED_ATTR")?addToSet({},Wt.ALLOWED_ATTR,vn):yt,Jt=objectHasOwnProperty(Wt,"ALLOWED_NAMESPACES")?addToSet({},Wt.ALLOWED_NAMESPACES,stringToString):xn,Bn=objectHasOwnProperty(Wt,"ADD_URI_SAFE_ATTR")?addToSet(clone(An),Wt.ADD_URI_SAFE_ATTR,vn):An,Fn=objectHasOwnProperty(Wt,"ADD_DATA_URI_TAGS")?addToSet(clone(Ln),Wt.ADD_DATA_URI_TAGS,vn):Ln,gn=objectHasOwnProperty(Wt,"FORBID_CONTENTS")?addToSet({},Wt.FORBID_CONTENTS,vn):mn,It=objectHasOwnProperty(Wt,"FORBID_TAGS")?addToSet({},Wt.FORBID_TAGS,vn):{},Lt=objectHasOwnProperty(Wt,"FORBID_ATTR")?addToSet({},Wt.FORBID_ATTR,vn):{},zt=objectHasOwnProperty(Wt,"USE_PROFILES")?Wt.USE_PROFILES:!1,Nt=Wt.ALLOW_ARIA_ATTR!==!1,Bt=Wt.ALLOW_DATA_ATTR!==!1,Kt=Wt.ALLOW_UNKNOWN_PROTOCOLS||!1,rn=Wt.ALLOW_SELF_CLOSE_IN_ATTR!==!1,nn=Wt.SAFE_FOR_TEMPLATES||!1,on=Wt.SAFE_FOR_XML!==!1,cn=Wt.WHOLE_DOCUMENT||!1,Gt=Wt.RETURN_DOM||!1,At=Wt.RETURN_DOM_FRAGMENT||!1,Ft=Wt.RETURN_TRUSTED_TYPE||!1,Zt=Wt.FORCE_BODY||!1,Vt=Wt.SANITIZE_DOM!==!1,qt=Wt.SANITIZE_NAMED_PROPS||!1,fn=Wt.KEEP_CONTENT!==!1,un=Wt.IN_PLACE||!1,Tt=Wt.ALLOWED_URI_REGEXP||IS_ALLOWED_URI,ln=Wt.NAMESPACE||Hn,$n=Wt.MATHML_TEXT_INTEGRATION_POINTS||$n,Dn=Wt.HTML_INTEGRATION_POINTS||Dn,vt=Wt.CUSTOM_ELEMENT_HANDLING||{},Wt.CUSTOM_ELEMENT_HANDLING&&kt(Wt.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(vt.tagNameCheck=Wt.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Wt.CUSTOM_ELEMENT_HANDLING&&kt(Wt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(vt.attributeNameCheck=Wt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Wt.CUSTOM_ELEMENT_HANDLING&&typeof Wt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(vt.allowCustomizedBuiltInElements=Wt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),nn&&(Bt=!1),At&&(Gt=!0),zt&&($t=addToSet({},text),ft=[],zt.html===!0&&(addToSet($t,html$1),addToSet(ft,html)),zt.svg===!0&&(addToSet($t,svg$1),addToSet(ft,svg),addToSet(ft,xml)),zt.svgFilters===!0&&(addToSet($t,svgFilters),addToSet(ft,svg),addToSet(ft,xml)),zt.mathMl===!0&&(addToSet($t,mathMl$1),addToSet(ft,mathMl),addToSet(ft,xml))),Wt.ADD_TAGS&&($t===xt&&($t=clone($t)),addToSet($t,Wt.ADD_TAGS,vn)),Wt.ADD_ATTR&&(ft===yt&&(ft=clone(ft)),addToSet(ft,Wt.ADD_ATTR,vn)),Wt.ADD_URI_SAFE_ATTR&&addToSet(Bn,Wt.ADD_URI_SAFE_ATTR,vn),Wt.FORBID_CONTENTS&&(gn===mn&&(gn=clone(gn)),addToSet(gn,Wt.FORBID_CONTENTS,vn)),fn&&($t["#text"]=!0),cn&&addToSet($t,["html","head","body"]),$t.table&&(addToSet($t,["tbody"]),delete It.tbody),Wt.TRUSTED_TYPES_POLICY){if(typeof Wt.TRUSTED_TYPES_POLICY.createHTML!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Wt.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');dt=Wt.TRUSTED_TYPES_POLICY,ot=dt.createHTML("")}else dt===void 0&&(dt=_createTrustedTypesPolicy(tt,c)),dt!==null&&typeof ot=="string"&&(ot=dt.createHTML(""));freeze&&freeze(Wt),wn=Wt}},en=addToSet({},[...svg$1,...svgFilters,...svgDisallowed]),tn=addToSet({},[...mathMl$1,...mathMlDisallowed]),dn=function(Wt){let _n=at(Wt);(!_n||!_n.tagName)&&(_n={namespaceURI:ln,tagName:"template"});const On=stringToLowerCase(Wt.tagName),Wn=stringToLowerCase(_n.tagName);return Jt[Wt.namespaceURI]?Wt.namespaceURI===Un?_n.namespaceURI===Hn?On==="svg":_n.namespaceURI===In?On==="svg"&&(Wn==="annotation-xml"||$n[Wn]):!!en[On]:Wt.namespaceURI===In?_n.namespaceURI===Hn?On==="math":_n.namespaceURI===Un?On==="math"&&Dn[Wn]:!!tn[On]:Wt.namespaceURI===Hn?_n.namespaceURI===Un&&!Dn[Wn]||_n.namespaceURI===In&&!$n[Wn]?!1:!tn[On]&&(Dt[On]||!en[On]):!!(sn==="application/xhtml+xml"&&Jt[Wt.namespaceURI]):!1},pn=function(Wt){arrayPush(e.removed,{element:Wt});try{at(Wt).removeChild(Wt)}catch{rt(Wt)}},Tn=function(Wt,_n){try{arrayPush(e.removed,{attribute:_n.getAttributeNode(Wt),from:_n})}catch{arrayPush(e.removed,{attribute:null,from:_n})}if(_n.removeAttribute(Wt),Wt==="is")if(Gt||At)try{pn(_n)}catch{}else try{_n.setAttribute(Wt,"")}catch{}},Cn=function(Wt){let _n=null,On=null;if(Zt)Wt="<remove></remove>"+Wt;else{const Gn=stringMatch(Wt,/^[\r\n\t ]+/);On=Gn&&Gn[0]}sn==="application/xhtml+xml"&&ln===Hn&&(Wt='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Wt+"</body></html>");const Wn=dt?dt.createHTML(Wt):Wt;if(ln===Hn)try{_n=new _e().parseFromString(Wn,sn)}catch{}if(!_n||!_n.documentElement){_n=ht.createDocument(ln,"template",null);try{_n.documentElement.innerHTML=Xt?ot:Wn}catch{}}const qn=_n.body||_n.documentElement;return Wt&&On&&qn.insertBefore(a.createTextNode(On),qn.childNodes[0]||null),ln===Hn?_t.call(_n,cn?"html":"body")[0]:cn?_n.documentElement:qn},bn=function(Wt){return ut.call(Wt.ownerDocument||Wt,Wt,b.SHOW_ELEMENT|b.SHOW_COMMENT|b.SHOW_TEXT|b.SHOW_PROCESSING_INSTRUCTION|b.SHOW_CDATA_SECTION,null)},Nn=function(Wt){return Wt instanceof $&&(typeof Wt.nodeName!="string"||typeof Wt.textContent!="string"||typeof Wt.removeChild!="function"||!(Wt.attributes instanceof j)||typeof Wt.removeAttribute!="function"||typeof Wt.setAttribute!="function"||typeof Wt.namespaceURI!="string"||typeof Wt.insertBefore!="function"||typeof Wt.hasChildNodes!="function")},kn=function(Wt){return typeof g=="function"&&Wt instanceof g};function En(Rn,Wt,_n){arrayForEach(Rn,On=>{On.call(e,Wt,_n,wn)})}const Mn=function(Wt){let _n=null;if(En(mt.beforeSanitizeElements,Wt,null),Nn(Wt))return pn(Wt),!0;const On=vn(Wt.nodeName);if(En(mt.uponSanitizeElement,Wt,{tagName:On,allowedTags:$t}),Wt.hasChildNodes()&&!kn(Wt.firstElementChild)&&regExpTest(/<[/\w]/g,Wt.innerHTML)&&regExpTest(/<[/\w]/g,Wt.textContent)||Wt.nodeType===NODE_TYPE.progressingInstruction||on&&Wt.nodeType===NODE_TYPE.comment&&regExpTest(/<[/\w]/g,Wt.data))return pn(Wt),!0;if(!$t[On]||It[On]){if(!It[On]&&zn(On)&&(vt.tagNameCheck instanceof RegExp&&regExpTest(vt.tagNameCheck,On)||vt.tagNameCheck instanceof Function&&vt.tagNameCheck(On)))return!1;if(fn&&!gn[On]){const Wn=at(Wt)||Wt.parentNode,qn=it(Wt)||Wt.childNodes;if(qn&&Wn){const Gn=qn.length;for(let Kn=Gn-1;Kn>=0;--Kn){const Jn=st(qn[Kn],!0);Jn.__removalCount=(Wt.__removalCount||0)+1,Wn.insertBefore(Jn,nt(Wt))}}}return pn(Wt),!0}return Wt instanceof _&&!dn(Wt)||(On==="noscript"||On==="noembed"||On==="noframes")&&regExpTest(/<\/no(script|embed|frames)/i,Wt.innerHTML)?(pn(Wt),!0):(nn&&Wt.nodeType===NODE_TYPE.text&&(_n=Wt.textContent,arrayForEach([Et,Pt,jt],Wn=>{_n=stringReplace(_n,Wn," ")}),Wt.textContent!==_n&&(arrayPush(e.removed,{element:Wt.cloneNode()}),Wt.textContent=_n)),En(mt.afterSanitizeElements,Wt,null),!1)},jn=function(Wt,_n,On){if(Vt&&(_n==="id"||_n==="name")&&(On in a||On in Mt))return!1;if(!(Bt&&!Lt[_n]&&regExpTest(St,_n))){if(!(Nt&&regExpTest(Ot,_n))){if(!ft[_n]||Lt[_n]){if(!(zn(Wt)&&(vt.tagNameCheck instanceof RegExp&&regExpTest(vt.tagNameCheck,Wt)||vt.tagNameCheck instanceof Function&&vt.tagNameCheck(Wt))&&(vt.attributeNameCheck instanceof RegExp&&regExpTest(vt.attributeNameCheck,_n)||vt.attributeNameCheck instanceof Function&&vt.attributeNameCheck(_n))||_n==="is"&&vt.allowCustomizedBuiltInElements&&(vt.tagNameCheck instanceof RegExp&&regExpTest(vt.tagNameCheck,On)||vt.tagNameCheck instanceof Function&&vt.tagNameCheck(On))))return!1}else if(!Bn[_n]){if(!regExpTest(Tt,stringReplace(On,Rt,""))){if(!((_n==="src"||_n==="xlink:href"||_n==="href")&&Wt!=="script"&&stringIndexOf(On,"data:")===0&&Fn[Wt])){if(!(Kt&&!regExpTest(Ct,stringReplace(On,Rt,"")))){if(On)return!1}}}}}}return!0},zn=function(Wt){return Wt!=="annotation-xml"&&stringMatch(Wt,bt)},Vn=function(Wt){En(mt.beforeSanitizeAttributes,Wt,null);const{attributes:_n}=Wt;if(!_n||Nn(Wt))return;const On={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ft,forceKeepAttr:void 0};let Wn=_n.length;for(;Wn--;){const qn=_n[Wn],{name:Gn,namespaceURI:Kn,value:Jn}=qn,lr=vn(Gn);let Xn=Gn==="value"?Jn:stringTrim(Jn);if(On.attrName=lr,On.attrValue=Xn,On.keepAttr=!0,On.forceKeepAttr=void 0,En(mt.uponSanitizeAttribute,Wt,On),Xn=On.attrValue,qt&&(lr==="id"||lr==="name")&&(Tn(Gn,Wt),Xn=an+Xn),on&&regExpTest(/((--!?|])>)|<\/(style|title)/i,Xn)){Tn(Gn,Wt);continue}if(On.forceKeepAttr||(Tn(Gn,Wt),!On.keepAttr))continue;if(!rn&&regExpTest(/\/>/i,Xn)){Tn(Gn,Wt);continue}nn&&arrayForEach([Et,Pt,jt],fs=>{Xn=stringReplace(Xn,fs," ")});const hs=vn(Wt.nodeName);if(jn(hs,lr,Xn)){if(dt&&typeof tt=="object"&&typeof tt.getAttributeType=="function"&&!Kn)switch(tt.getAttributeType(hs,lr)){case"TrustedHTML":{Xn=dt.createHTML(Xn);break}case"TrustedScriptURL":{Xn=dt.createScriptURL(Xn);break}}try{Kn?Wt.setAttributeNS(Kn,Gn,Xn):Wt.setAttribute(Gn,Xn),Nn(Wt)?pn(Wt):arrayPop(e.removed)}catch{}}}En(mt.afterSanitizeAttributes,Wt,null)},Zn=function Rn(Wt){let _n=null;const On=bn(Wt);for(En(mt.beforeSanitizeShadowDOM,Wt,null);_n=On.nextNode();)En(mt.uponSanitizeShadowNode,_n,null),Mn(_n),Vn(_n),_n.content instanceof d&&Rn(_n.content);En(mt.afterSanitizeShadowDOM,Wt,null)};return e.sanitize=function(Rn){let Wt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_n=null,On=null,Wn=null,qn=null;if(Xt=!Rn,Xt&&(Rn="<!-->"),typeof Rn!="string"&&!kn(Rn))if(typeof Rn.toString=="function"){if(Rn=Rn.toString(),typeof Rn!="string")throw typeErrorCreate("dirty is not a string, aborting")}else throw typeErrorCreate("toString is not a function");if(!e.isSupported)return Rn;if(hn||Ut(Wt),e.removed=[],typeof Rn=="string"&&(un=!1),un){if(Rn.nodeName){const Jn=vn(Rn.nodeName);if(!$t[Jn]||It[Jn])throw typeErrorCreate("root node is forbidden and cannot be sanitized in-place")}}else if(Rn instanceof g)_n=Cn("<!---->"),On=_n.ownerDocument.importNode(Rn,!0),On.nodeType===NODE_TYPE.element&&On.nodeName==="BODY"||On.nodeName==="HTML"?_n=On:_n.appendChild(On);else{if(!Gt&&!nn&&!cn&&Rn.indexOf("<")===-1)return dt&&Ft?dt.createHTML(Rn):Rn;if(_n=Cn(Rn),!_n)return Gt?null:Ft?ot:""}_n&&Zt&&pn(_n.firstChild);const Gn=bn(un?Rn:_n);for(;Wn=Gn.nextNode();)Mn(Wn),Vn(Wn),Wn.content instanceof d&&Zn(Wn.content);if(un)return Rn;if(Gt){if(At)for(qn=pt.call(_n.ownerDocument);_n.firstChild;)qn.appendChild(_n.firstChild);else qn=_n;return(ft.shadowroot||ft.shadowrootmode)&&(qn=wt.call(o,qn,!0)),qn}let Kn=cn?_n.outerHTML:_n.innerHTML;return cn&&$t["!doctype"]&&_n.ownerDocument&&_n.ownerDocument.doctype&&_n.ownerDocument.doctype.name&&regExpTest(DOCTYPE_NAME,_n.ownerDocument.doctype.name)&&(Kn="<!DOCTYPE "+_n.ownerDocument.doctype.name+`>
`+Kn),nn&&arrayForEach([Et,Pt,jt],Jn=>{Kn=stringReplace(Kn,Jn," ")}),dt&&Ft?dt.createHTML(Kn):Kn},e.setConfig=function(){let Rn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ut(Rn),hn=!0},e.clearConfig=function(){wn=null,hn=!1},e.isValidAttribute=function(Rn,Wt,_n){wn||Ut({});const On=vn(Rn),Wn=vn(Wt);return jn(On,Wn,_n)},e.addHook=function(Rn,Wt){typeof Wt=="function"&&arrayPush(mt[Rn],Wt)},e.removeHook=function(Rn,Wt){if(Wt!==void 0){const _n=arrayLastIndexOf(mt[Rn],Wt);return _n===-1?void 0:arraySplice(mt[Rn],_n,1)[0]}return arrayPop(mt[Rn])},e.removeHooks=function(Rn){mt[Rn]=[]},e.removeAllHooks=function(){mt=_createHooksMap()},e}var purify=createDOMPurify();const GROQ_API_KEY$1="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",GROQ_API_URL$1="https://api.groq.com/openai/v1/chat/completions",TeacherAssistant=()=>{const[s,e]=reactExports.useState(""),[a,o]=reactExports.useState(""),[c,d]=reactExports.useState(""),[h,g]=reactExports.useState(""),[_,b]=reactExports.useState(""),[j,$]=reactExports.useState(!1),[_e,tt]=reactExports.useState(""),[et,st]=reactExports.useState(!1),[rt,nt]=reactExports.useState(!1),it=window.speechSynthesis,[at,dt]=reactExports.useState(null),ot=reactExports.useCallback(()=>{if(et){it.cancel(),st(!1);return}if(_){const wt=_.replace(/<[^>]+>/g,""),mt=new SpeechSynthesisUtterance(wt);mt.lang="en-US",mt.rate=1,mt.pitch=1,mt.onend=()=>{st(!1)},mt.onerror=()=>{st(!1),tt("Speech synthesis failed. Please try again.")},dt(mt),st(!0),it.speak(mt)}},[_,et]),ht=()=>{nt(!0);const wt=new(window.SpeechRecognition||window.webkitSpeechRecognition);wt.lang="en-US",wt.onresult=mt=>{const Et=mt.results[0][0].transcript;g(Et),_t(),nt(!1)},wt.start()};React.useEffect(()=>()=>{it&&it.cancel()},[]);const ut=async wt=>{var mt;try{const Et=`As a teacher assistant for ${a} Grade ${c} in the ${s} curriculum, please help with this question: ${wt}`,Pt=await fetch(GROQ_API_URL$1,{method:"POST",headers:{Authorization:`Bearer ${GROQ_API_KEY$1}`,"Content-Type":"application/json"},body:JSON.stringify({model:"llama-3.3-70b-specdec",messages:[{role:"system",content:`You are an AI teacher assistant. Help teachers create effective lesson plans, provide teaching strategies, and suggest educational resources.

Format your responses using HTML tags for better readability:
- Use <h1> for main topics
- Use <h2> for subtopics
- Use <h3> for section headings
- Use <p> for paragraphs
- Use <strong> for emphasis
- Use <em> for secondary emphasis
- Use <ul> and <li> for unordered lists
- Use <ol> and <li> for ordered lists
- Use <blockquote> for important quotes or key points
- Use <code> for any code or specific terms
- Create tables using <table>, <tr>, <th>, and <td> when presenting structured data
- Wrap tips in <div class="tip">...</div>
- Wrap notes in <div class="note">...</div>

Make your responses visually appealing and easy to read. Use appropriate headings and structure to organize the information clearly.`},{role:"user",content:Et}],temperature:.5})}),jt=await Pt.json();if(!Pt.ok)throw new Error(((mt=jt.error)==null?void 0:mt.message)||"Failed to get response");return jt.choices[0].message.content}catch(Et){return tt(Et.message||"Failed to get response"),null}},pt=wt=>`<div style="background-color: white; color: black;">${purify.sanitize(wt)}</div>`,_t=async wt=>{if(wt&&wt.preventDefault(),!s||!a||!c){alert("Please select curriculum, subject, and grade before asking a question.");return}$(!0),tt(""),b("");const mt=await ut(h);if(!mt){$(!1);return}b(pt(mt)),$(!1)};return jsxRuntimeExports.jsx("div",{className:"lesson-plan-container",children:jsxRuntimeExports.jsxs("div",{className:"content",children:[jsxRuntimeExports.jsx("h1",{children:"Teacher Assistant"}),jsxRuntimeExports.jsx("p",{className:"description",children:"Get help with lesson planning, teaching strategies, and educational resources"}),jsxRuntimeExports.jsxs("form",{onSubmit:_t,className:"form-content",children:[jsxRuntimeExports.jsxs("div",{className:"dropdown-section",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Select Curriculum"}),jsxRuntimeExports.jsxs("select",{value:s,onChange:wt=>e(wt.target.value),required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Choose Curriculum"}),jsxRuntimeExports.jsx("option",{value:"ontario",children:"Ontario"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Select Subject"}),jsxRuntimeExports.jsxs("select",{value:a,onChange:wt=>o(wt.target.value),required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Choose Subject"}),jsxRuntimeExports.jsx("option",{value:"math",children:"Mathematics"}),jsxRuntimeExports.jsx("option",{value:"english",children:"English"}),jsxRuntimeExports.jsx("option",{value:"science",children:"Science"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Select Grade"}),jsxRuntimeExports.jsxs("select",{value:c,onChange:wt=>d(wt.target.value),required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Choose Grade"}),[1,2,3,4,5,6,7,8].map(wt=>jsxRuntimeExports.jsxs("option",{value:wt,children:["Grade ",wt]},wt))]})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Your Question"}),jsxRuntimeExports.jsx("textarea",{value:h,onChange:wt=>g(wt.target.value),placeholder:"Ask about lesson planning, teaching strategies, or any other teaching-related questions...",required:!0,rows:"4",className:"question-input",disabled:rt})]}),jsxRuntimeExports.jsx("button",{type:"submit",className:"submit-button",disabled:j,children:j?"Getting Answer...":"Ask Question"}),jsxRuntimeExports.jsx("button",{onClick:ht,className:"voice-button",title:"Ask Question by Voice",children:"Ask by Voice"})]}),_e&&jsxRuntimeExports.jsx("div",{className:"error-message",children:_e}),_&&jsxRuntimeExports.jsxs("div",{className:"generated-content",children:[jsxRuntimeExports.jsx("h2",{children:"Here's Your Answer"}),jsxRuntimeExports.jsx("div",{className:"answer-box",dangerouslySetInnerHTML:{__html:_}}),jsxRuntimeExports.jsx("button",{onClick:ot,className:"voice-button",title:et?"Stop Speaking":"Listen to Answer",children:et?"Stop":"Listen"})]})]})})},GROQ_API_KEY="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",GROQ_API_URL="https://api.groq.com/openai/v1/chat/completions",StudentAssistant=()=>{const[s,e]=reactExports.useState(""),[a,o]=reactExports.useState(""),[c,d]=reactExports.useState(""),[h,g]=reactExports.useState(""),[_,b]=reactExports.useState(""),[j,$]=reactExports.useState(!1),[_e,tt]=reactExports.useState(""),[et,st]=reactExports.useState(!1),[rt,nt]=reactExports.useState(!1),it=window.speechSynthesis,[at,dt]=reactExports.useState(null),ot=reactExports.useCallback(()=>{if(et){it.cancel(),st(!1);return}if(_){const wt=_.replace(/<[^>]+>/g,""),mt=new SpeechSynthesisUtterance(wt);mt.lang="en-US",mt.rate=1,mt.pitch=1,mt.onend=()=>{st(!1)},mt.onerror=()=>{st(!1),tt("Speech synthesis failed. Please try again.")},dt(mt),st(!0),it.speak(mt)}},[_,et]),ht=()=>{nt(!0);const wt=new(window.SpeechRecognition||window.webkitSpeechRecognition);wt.lang="en-US",wt.onresult=mt=>{const Et=mt.results[0][0].transcript;g(Et),_t(),nt(!1)},wt.start()};React.useEffect(()=>()=>{it&&it.cancel()},[]);const ut=async wt=>{var mt;try{const Et=`As a student learning assistant for ${a} Grade ${c} in the ${s} curriculum, please help with this question: ${wt}`,Pt=await fetch(GROQ_API_URL,{method:"POST",headers:{Authorization:`Bearer ${GROQ_API_KEY}`,"Content-Type":"application/json"},body:JSON.stringify({model:"llama-3.3-70b-versatile",messages:[{role:"system",content:`You are an AI student assistant. Explain concepts clearly and simply, suitable for the student's grade level. Provide step-by-step explanations when needed.

Format your responses using HTML tags for better readability:
- Use <h1> for main topics
- Use <h2> for subtopics
- Use <h3> for section headings
- Use <p> for paragraphs
- Use <strong> for emphasis
- Use <em> for secondary emphasis
- Use <ul> and <li> for unordered lists
- Use <ol> and <li> for ordered lists
- Use <blockquote> for important quotes or key points
- Use <code> for any code or specific terms
- Create tables using <table>, <tr>, <th>, and <td> when presenting structured data
- Wrap tips in <div class="tip">...</div>
- Wrap notes in <div class="note">...</div>

Make your responses visually appealing and easy to read. Break down complex concepts into clear, well-organized sections with appropriate headings and structure.

Please ensure your response is formatted with a white background, black text, headings, and tables.
`},{role:"user",content:Et}],temperature:.5})}),jt=await Pt.json();if(!Pt.ok)throw new Error(((mt=jt.error)==null?void 0:mt.message)||"Failed to get response");return jt.choices[0].message.content}catch(Et){return tt(Et.message||"Failed to get response"),null}},pt=wt=>purify.sanitize(wt),_t=async wt=>{if(wt.preventDefault(),!s||!a||!c){alert("Please select curriculum, subject, and grade before asking a question.");return}$(!0),tt(""),b("");const mt=await ut(h);if(!mt){$(!1);return}b(pt(mt)),$(!1)};return jsxRuntimeExports.jsx("div",{className:"lesson-plan-container",children:jsxRuntimeExports.jsxs("div",{className:"content",children:[jsxRuntimeExports.jsx("h1",{children:"Student Learning Assistant"}),jsxRuntimeExports.jsx("p",{className:"description",children:"Get help understanding concepts, solving problems, and improving your study skills"}),jsxRuntimeExports.jsxs("form",{onSubmit:_t,className:"form-content",children:[jsxRuntimeExports.jsxs("div",{className:"dropdown-section",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Select Your Curriculum"}),jsxRuntimeExports.jsxs("select",{value:s,onChange:wt=>e(wt.target.value),required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Choose Curriculum"}),jsxRuntimeExports.jsx("option",{value:"ontario",children:"Ontario"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Select Your Subject"}),jsxRuntimeExports.jsxs("select",{value:a,onChange:wt=>o(wt.target.value),required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Choose Subject"}),jsxRuntimeExports.jsx("option",{value:"math",children:"Mathematics"}),jsxRuntimeExports.jsx("option",{value:"english",children:"English"}),jsxRuntimeExports.jsx("option",{value:"science",children:"Science"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Select Your Grade"}),jsxRuntimeExports.jsxs("select",{value:c,onChange:wt=>d(wt.target.value),required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Choose Grade"}),[1,2,3,4,5,6,7,8].map(wt=>jsxRuntimeExports.jsxs("option",{value:wt,children:["Grade ",wt]},wt))]})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Your Question"}),jsxRuntimeExports.jsx("textarea",{value:h,onChange:wt=>g(wt.target.value),placeholder:"Ask about anything you need help with in your studies...",required:!0,rows:"4",className:"question-input"})]}),jsxRuntimeExports.jsx("button",{type:"submit",className:"submit-button",disabled:j,children:j?"Getting Answer...":"Ask Question"}),jsxRuntimeExports.jsx("button",{onClick:ht,className:"voice-button",children:rt?"Listening...":"Ask Question by Voice"})]}),_e&&jsxRuntimeExports.jsx("div",{className:"error-message",children:_e}),_&&jsxRuntimeExports.jsxs("div",{className:"generated-content",children:[jsxRuntimeExports.jsx("h2",{children:"Here's Your Answer"}),jsxRuntimeExports.jsx("div",{className:"answer-box",dangerouslySetInnerHTML:{__html:_}}),jsxRuntimeExports.jsx("button",{onClick:ot,className:"voice-button",title:et?"Stop Speaking":"Listen to Answer",children:et?"Stop":"Listen"})]})]})})},App=()=>jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsxs("div",{className:"app",children:[jsxRuntimeExports.jsx(Header,{}),jsxRuntimeExports.jsx("main",{className:"main-content",children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/introduction",element:jsxRuntimeExports.jsx(Introduction,{})}),jsxRuntimeExports.jsx(Route,{path:"/terms",element:jsxRuntimeExports.jsx(Terms,{})}),jsxRuntimeExports.jsx(Route,{path:"/lessonplan",element:jsxRuntimeExports.jsx(LessonPlan,{})}),jsxRuntimeExports.jsx(Route,{path:"/assessment",element:jsxRuntimeExports.jsx(Assessment,{})}),jsxRuntimeExports.jsx(Route,{path:"/teacher-assistant",element:jsxRuntimeExports.jsx(TeacherAssistant,{})}),jsxRuntimeExports.jsx(Route,{path:"/student-assistant",element:jsxRuntimeExports.jsx(StudentAssistant,{})}),jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(Navigate,{to:"/terms",replace:!0})})]})}),jsxRuntimeExports.jsx(Footer,{})]})});createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
