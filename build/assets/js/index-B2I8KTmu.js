var Km=Object.defineProperty;var cf=s=>{throw TypeError(s)};var Jm=(s,e,t)=>e in s?Km(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var ot=(s,e,t)=>Jm(s,typeof e!="symbol"?e+"":e,t),ic=(s,e,t)=>e.has(s)||cf("Cannot "+t);var R=(s,e,t)=>(ic(s,e,"read from private field"),t?t.call(s):e.get(s)),Se=(s,e,t)=>e.has(s)?cf("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),we=(s,e,t,n)=>(ic(s,e,"write to private field"),n?n.call(s,t):e.set(s,t),t),de=(s,e,t)=>(ic(s,e,"access private method"),t);var Er=(s,e,t,n)=>({set _(r){we(s,e,r,t)},get _(){return R(s,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();function getDefaultExportFromCjs(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function getAugmentedNamespace(s){if(s.__esModule)return s;var e=s.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(n){var r=Object.getOwnPropertyDescriptor(s,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return s[n]}})}),t}var jsxRuntime={exports:{}},reactJsxRuntime_production={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production;function requireReactJsxRuntime_production(){if(hasRequiredReactJsxRuntime_production)return reactJsxRuntime_production;hasRequiredReactJsxRuntime_production=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,r,o){var c=null;if(o!==void 0&&(c=""+o),r.key!==void 0&&(c=""+r.key),"key"in r){o={};for(var u in r)u!=="key"&&(o[u]=r[u])}else o=r;return r=o.ref,{$$typeof:s,type:n,key:c,ref:r!==void 0?r:null,props:o}}return reactJsxRuntime_production.Fragment=e,reactJsxRuntime_production.jsx=t,reactJsxRuntime_production.jsxs=t,reactJsxRuntime_production}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),react={exports:{}},react_production={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production;function requireReact_production(){if(hasRequiredReact_production)return react_production;hasRequiredReact_production=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.iterator;function y(F){return F===null||typeof F!="object"?null:(F=g&&F[g]||F["@@iterator"],typeof F=="function"?F:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,E={};function x(F,Y,U){this.props=F,this.context=Y,this.refs=E,this.updater=U||v}x.prototype.isReactComponent={},x.prototype.setState=function(F,Y){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,Y,"setState")},x.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function w(){}w.prototype=x.prototype;function T(F,Y,U){this.props=F,this.context=Y,this.refs=E,this.updater=U||v}var O=T.prototype=new w;O.constructor=T,_(O,x.prototype),O.isPureReactComponent=!0;var N=Array.isArray,A={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function k(F,Y,U,C,P,$){return U=$.ref,{$$typeof:s,type:F,key:Y,ref:U!==void 0?U:null,props:$}}function M(F,Y){return k(F.type,Y,void 0,void 0,void 0,F.props)}function L(F){return typeof F=="object"&&F!==null&&F.$$typeof===s}function H(F){var Y={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(U){return Y[U]})}var D=/\/+/g;function q(F,Y){return typeof F=="object"&&F!==null&&F.key!=null?H(""+F.key):Y.toString(36)}function J(){}function ae(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(J,J):(F.status="pending",F.then(function(Y){F.status==="pending"&&(F.status="fulfilled",F.value=Y)},function(Y){F.status==="pending"&&(F.status="rejected",F.reason=Y)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function V(F,Y,U,C,P){var $=typeof F;($==="undefined"||$==="boolean")&&(F=null);var W=!1;if(F===null)W=!0;else switch($){case"bigint":case"string":case"number":W=!0;break;case"object":switch(F.$$typeof){case s:case e:W=!0;break;case p:return W=F._init,V(W(F._payload),Y,U,C,P)}}if(W)return P=P(F),W=C===""?"."+q(F,0):C,N(P)?(U="",W!=null&&(U=W.replace(D,"$&/")+"/"),V(P,Y,U,"",function(ce){return ce})):P!=null&&(L(P)&&(P=M(P,U+(P.key==null||F&&F.key===P.key?"":(""+P.key).replace(D,"$&/")+"/")+W)),Y.push(P)),1;W=0;var te=C===""?".":C+":";if(N(F))for(var ee=0;ee<F.length;ee++)C=F[ee],$=te+q(C,ee),W+=V(C,Y,U,$,P);else if(ee=y(F),typeof ee=="function")for(F=ee.call(F),ee=0;!(C=F.next()).done;)C=C.value,$=te+q(C,ee++),W+=V(C,Y,U,$,P);else if($==="object"){if(typeof F.then=="function")return V(ae(F),Y,U,C,P);throw Y=String(F),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.")}return W}function Z(F,Y,U){if(F==null)return F;var C=[],P=0;return V(F,C,"","",function($){return Y.call(U,$,P++)}),C}function G(F){if(F._status===-1){var Y=F._result;Y=Y(),Y.then(function(U){(F._status===0||F._status===-1)&&(F._status=1,F._result=U)},function(U){(F._status===0||F._status===-1)&&(F._status=2,F._result=U)}),F._status===-1&&(F._status=0,F._result=Y)}if(F._status===1)return F._result.default;throw F._result}var ne=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(Y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)};function B(){}return react_production.Children={map:Z,forEach:function(F,Y,U){Z(F,function(){Y.apply(this,arguments)},U)},count:function(F){var Y=0;return Z(F,function(){Y++}),Y},toArray:function(F){return Z(F,function(Y){return Y})||[]},only:function(F){if(!L(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},react_production.Component=x,react_production.Fragment=t,react_production.Profiler=r,react_production.PureComponent=T,react_production.StrictMode=n,react_production.Suspense=h,react_production.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,react_production.act=function(){throw Error("act(...) is not supported in production builds of React.")},react_production.cache=function(F){return function(){return F.apply(null,arguments)}},react_production.cloneElement=function(F,Y,U){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var C=_({},F.props),P=F.key,$=void 0;if(Y!=null)for(W in Y.ref!==void 0&&($=void 0),Y.key!==void 0&&(P=""+Y.key),Y)!I.call(Y,W)||W==="key"||W==="__self"||W==="__source"||W==="ref"&&Y.ref===void 0||(C[W]=Y[W]);var W=arguments.length-2;if(W===1)C.children=U;else if(1<W){for(var te=Array(W),ee=0;ee<W;ee++)te[ee]=arguments[ee+2];C.children=te}return k(F.type,P,void 0,void 0,$,C)},react_production.createContext=function(F){return F={$$typeof:c,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:o,_context:F},F},react_production.createElement=function(F,Y,U){var C,P={},$=null;if(Y!=null)for(C in Y.key!==void 0&&($=""+Y.key),Y)I.call(Y,C)&&C!=="key"&&C!=="__self"&&C!=="__source"&&(P[C]=Y[C]);var W=arguments.length-2;if(W===1)P.children=U;else if(1<W){for(var te=Array(W),ee=0;ee<W;ee++)te[ee]=arguments[ee+2];P.children=te}if(F&&F.defaultProps)for(C in W=F.defaultProps,W)P[C]===void 0&&(P[C]=W[C]);return k(F,$,void 0,void 0,null,P)},react_production.createRef=function(){return{current:null}},react_production.forwardRef=function(F){return{$$typeof:u,render:F}},react_production.isValidElement=L,react_production.lazy=function(F){return{$$typeof:p,_payload:{_status:-1,_result:F},_init:G}},react_production.memo=function(F,Y){return{$$typeof:f,type:F,compare:Y===void 0?null:Y}},react_production.startTransition=function(F){var Y=A.T,U={};A.T=U;try{var C=F(),P=A.S;P!==null&&P(U,C),typeof C=="object"&&C!==null&&typeof C.then=="function"&&C.then(B,ne)}catch($){ne($)}finally{A.T=Y}},react_production.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},react_production.use=function(F){return A.H.use(F)},react_production.useActionState=function(F,Y,U){return A.H.useActionState(F,Y,U)},react_production.useCallback=function(F,Y){return A.H.useCallback(F,Y)},react_production.useContext=function(F){return A.H.useContext(F)},react_production.useDebugValue=function(){},react_production.useDeferredValue=function(F,Y){return A.H.useDeferredValue(F,Y)},react_production.useEffect=function(F,Y){return A.H.useEffect(F,Y)},react_production.useId=function(){return A.H.useId()},react_production.useImperativeHandle=function(F,Y,U){return A.H.useImperativeHandle(F,Y,U)},react_production.useInsertionEffect=function(F,Y){return A.H.useInsertionEffect(F,Y)},react_production.useLayoutEffect=function(F,Y){return A.H.useLayoutEffect(F,Y)},react_production.useMemo=function(F,Y){return A.H.useMemo(F,Y)},react_production.useOptimistic=function(F,Y){return A.H.useOptimistic(F,Y)},react_production.useReducer=function(F,Y,U){return A.H.useReducer(F,Y,U)},react_production.useRef=function(F){return A.H.useRef(F)},react_production.useState=function(F){return A.H.useState(F)},react_production.useSyncExternalStore=function(F,Y,U){return A.H.useSyncExternalStore(F,Y,U)},react_production.useTransition=function(){return A.H.useTransition()},react_production.version="19.0.0",react_production}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production()),react.exports}var reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client$1={exports:{}},reactDomClient_production={},scheduler={exports:{}},scheduler_production={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production;function requireScheduler_production(){return hasRequiredScheduler_production||(hasRequiredScheduler_production=1,function(s){function e(Z,G){var ne=Z.length;Z.push(G);e:for(;0<ne;){var B=ne-1>>>1,F=Z[B];if(0<r(F,G))Z[B]=G,Z[ne]=F,ne=B;else break e}}function t(Z){return Z.length===0?null:Z[0]}function n(Z){if(Z.length===0)return null;var G=Z[0],ne=Z.pop();if(ne!==G){Z[0]=ne;e:for(var B=0,F=Z.length,Y=F>>>1;B<Y;){var U=2*(B+1)-1,C=Z[U],P=U+1,$=Z[P];if(0>r(C,ne))P<F&&0>r($,C)?(Z[B]=$,Z[P]=ne,B=P):(Z[B]=C,Z[U]=ne,B=U);else if(P<F&&0>r($,ne))Z[B]=$,Z[P]=ne,B=P;else break e}}return G}function r(Z,G){var ne=Z.sortIndex-G.sortIndex;return ne!==0?ne:Z.id-G.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;s.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();s.unstable_now=function(){return c.now()-u}}var h=[],f=[],p=1,g=null,y=3,v=!1,_=!1,E=!1,x=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function O(Z){for(var G=t(f);G!==null;){if(G.callback===null)n(f);else if(G.startTime<=Z)n(f),G.sortIndex=G.expirationTime,e(h,G);else break;G=t(f)}}function N(Z){if(E=!1,O(Z),!_)if(t(h)!==null)_=!0,ae();else{var G=t(f);G!==null&&V(N,G.startTime-Z)}}var A=!1,I=-1,k=5,M=-1;function L(){return!(s.unstable_now()-M<k)}function H(){if(A){var Z=s.unstable_now();M=Z;var G=!0;try{e:{_=!1,E&&(E=!1,w(I),I=-1),v=!0;var ne=y;try{t:{for(O(Z),g=t(h);g!==null&&!(g.expirationTime>Z&&L());){var B=g.callback;if(typeof B=="function"){g.callback=null,y=g.priorityLevel;var F=B(g.expirationTime<=Z);if(Z=s.unstable_now(),typeof F=="function"){g.callback=F,O(Z),G=!0;break t}g===t(h)&&n(h),O(Z)}else n(h);g=t(h)}if(g!==null)G=!0;else{var Y=t(f);Y!==null&&V(N,Y.startTime-Z),G=!1}}break e}finally{g=null,y=ne,v=!1}G=void 0}}finally{G?D():A=!1}}}var D;if(typeof T=="function")D=function(){T(H)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,J=q.port2;q.port1.onmessage=H,D=function(){J.postMessage(null)}}else D=function(){x(H,0)};function ae(){A||(A=!0,D())}function V(Z,G){I=x(function(){Z(s.unstable_now())},G)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Z){Z.callback=null},s.unstable_continueExecution=function(){_||v||(_=!0,ae())},s.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<Z?Math.floor(1e3/Z):5},s.unstable_getCurrentPriorityLevel=function(){return y},s.unstable_getFirstCallbackNode=function(){return t(h)},s.unstable_next=function(Z){switch(y){case 1:case 2:case 3:var G=3;break;default:G=y}var ne=y;y=G;try{return Z()}finally{y=ne}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(Z,G){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ne=y;y=Z;try{return G()}finally{y=ne}},s.unstable_scheduleCallback=function(Z,G,ne){var B=s.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?B+ne:B):ne=B,Z){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=ne+F,Z={id:p++,callback:G,priorityLevel:Z,startTime:ne,expirationTime:F,sortIndex:-1},ne>B?(Z.sortIndex=ne,e(f,Z),t(h)===null&&Z===t(f)&&(E?(w(I),I=-1):E=!0,V(N,ne-B))):(Z.sortIndex=F,e(h,Z),_||v||(_=!0,ae())),Z},s.unstable_shouldYield=L,s.unstable_wrapCallback=function(Z){var G=y;return function(){var ne=y;y=G;try{return Z.apply(this,arguments)}finally{y=ne}}}}(scheduler_production)),scheduler_production}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production()),scheduler.exports}var reactDom={exports:{}},reactDom_production={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production;function requireReactDom_production(){if(hasRequiredReactDom_production)return reactDom_production;hasRequiredReactDom_production=1;var s=requireReact();function e(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(h,f,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:g==null?null:""+g,children:h,containerInfo:f,implementation:p}}var c=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return reactDom_production.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,reactDom_production.createPortal=function(h,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return o(h,f,null,p)},reactDom_production.flushSync=function(h){var f=c.T,p=n.p;try{if(c.T=null,n.p=2,h)return h()}finally{c.T=f,n.p=p,n.d.f()}},reactDom_production.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(h,f))},reactDom_production.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},reactDom_production.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var p=f.as,g=u(p,f.crossOrigin),y=typeof f.integrity=="string"?f.integrity:void 0,v=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?n.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:g,integrity:y,fetchPriority:v}):p==="script"&&n.d.X(h,{crossOrigin:g,integrity:y,fetchPriority:v,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},reactDom_production.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=u(f.as,f.crossOrigin);n.d.M(h,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(h)},reactDom_production.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,g=u(p,f.crossOrigin);n.d.L(h,p,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},reactDom_production.preloadModule=function(h,f){if(typeof h=="string")if(f){var p=u(f.as,f.crossOrigin);n.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(h)},reactDom_production.requestFormReset=function(h){n.d.r(h)},reactDom_production.unstable_batchedUpdates=function(h,f){return h(f)},reactDom_production.useFormState=function(h,f,p){return c.H.useFormState(h,f,p)},reactDom_production.useFormStatus=function(){return c.H.useHostTransitionStatus()},reactDom_production.version="19.0.0",reactDom_production}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),reactDom.exports=requireReactDom_production(),reactDom.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDomClient_production;function requireReactDomClient_production(){if(hasRequiredReactDomClient_production)return reactDomClient_production;hasRequiredReactDomClient_production=1;var s=requireScheduler(),e=requireReact(),t=requireReactDom();function n(a){var l="https://react.dev/errors/"+a;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)l+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}var o=Symbol.for("react.element"),c=Symbol.for("react.transitional.element"),u=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),y=Symbol.for("react.consumer"),v=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),O=Symbol.for("react.offscreen"),N=Symbol.for("react.memo_cache_sentinel"),A=Symbol.iterator;function I(a){return a===null||typeof a!="object"?null:(a=A&&a[A]||a["@@iterator"],typeof a=="function"?a:null)}var k=Symbol.for("react.client.reference");function M(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===k?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case h:return"Fragment";case u:return"Portal";case p:return"Profiler";case f:return"StrictMode";case E:return"Suspense";case x:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case v:return(a.displayName||"Context")+".Provider";case y:return(a._context.displayName||"Context")+".Consumer";case _:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case w:return l=a.displayName||null,l!==null?l:M(a.type)||"Memo";case T:l=a._payload,a=a._init;try{return M(a(l))}catch{}}return null}var L=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=Object.assign,D,q;function J(a){if(D===void 0)try{throw Error()}catch(d){var l=d.stack.trim().match(/\n( *(at )?)/);D=l&&l[1]||"",q=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+D+a+q}var ae=!1;function V(a,l){if(!a||ae)return"";ae=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(l){var Xe=function(){throw Error()};if(Object.defineProperty(Xe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Xe,[])}catch(He){var De=He}Reflect.construct(a,[],Xe)}else{try{Xe.call()}catch(He){De=He}a.call(Xe.prototype)}}else{try{throw Error()}catch(He){De=He}(Xe=a())&&typeof Xe.catch=="function"&&Xe.catch(function(){})}}catch(He){if(He&&De&&typeof He.stack=="string")return[He.stack,De.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=m.DetermineComponentFrameRoot(),j=S[0],K=S[1];if(j&&K){var le=j.split(`
`),Ee=K.split(`
`);for(b=m=0;m<le.length&&!le[m].includes("DetermineComponentFrameRoot");)m++;for(;b<Ee.length&&!Ee[b].includes("DetermineComponentFrameRoot");)b++;if(m===le.length||b===Ee.length)for(m=le.length-1,b=Ee.length-1;1<=m&&0<=b&&le[m]!==Ee[b];)b--;for(;1<=m&&0<=b;m--,b--)if(le[m]!==Ee[b]){if(m!==1||b!==1)do if(m--,b--,0>b||le[m]!==Ee[b]){var ze=`
`+le[m].replace(" at new "," at ");return a.displayName&&ze.includes("<anonymous>")&&(ze=ze.replace("<anonymous>",a.displayName)),ze}while(1<=m&&0<=b);break}}}finally{ae=!1,Error.prepareStackTrace=d}return(d=a?a.displayName||a.name:"")?J(d):""}function Z(a){switch(a.tag){case 26:case 27:case 5:return J(a.type);case 16:return J("Lazy");case 13:return J("Suspense");case 19:return J("SuspenseList");case 0:case 15:return a=V(a.type,!1),a;case 11:return a=V(a.type.render,!1),a;case 1:return a=V(a.type,!0),a;default:return""}}function G(a){try{var l="";do l+=Z(a),a=a.return;while(a);return l}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}function ne(a){var l=a,d=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,l.flags&4098&&(d=l.return),a=l.return;while(a)}return l.tag===3?d:null}function B(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function F(a){if(ne(a)!==a)throw Error(n(188))}function Y(a){var l=a.alternate;if(!l){if(l=ne(a),l===null)throw Error(n(188));return l!==a?null:a}for(var d=a,m=l;;){var b=d.return;if(b===null)break;var S=b.alternate;if(S===null){if(m=b.return,m!==null){d=m;continue}break}if(b.child===S.child){for(S=b.child;S;){if(S===d)return F(b),a;if(S===m)return F(b),l;S=S.sibling}throw Error(n(188))}if(d.return!==m.return)d=b,m=S;else{for(var j=!1,K=b.child;K;){if(K===d){j=!0,d=b,m=S;break}if(K===m){j=!0,m=b,d=S;break}K=K.sibling}if(!j){for(K=S.child;K;){if(K===d){j=!0,d=S,m=b;break}if(K===m){j=!0,m=S,d=b;break}K=K.sibling}if(!j)throw Error(n(189))}}if(d.alternate!==m)throw Error(n(190))}if(d.tag!==3)throw Error(n(188));return d.stateNode.current===d?a:l}function U(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a;for(a=a.child;a!==null;){if(l=U(a),l!==null)return l;a=a.sibling}return null}var C=Array.isArray,P=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$={pending:!1,data:null,method:null,action:null},W=[],te=-1;function ee(a){return{current:a}}function ce(a){0>te||(a.current=W[te],W[te]=null,te--)}function he(a,l){te++,W[te]=a.current,a.current=l}var Re=ee(null),Ce=ee(null),Ie=ee(null),Ne=ee(null);function $e(a,l){switch(he(Ie,l),he(Ce,a),he(Re,null),a=l.nodeType,a){case 9:case 11:l=(l=l.documentElement)&&(l=l.namespaceURI)?Fh(l):0;break;default:if(a=a===8?l.parentNode:l,l=a.tagName,a=a.namespaceURI)a=Fh(a),l=jh(a,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}ce(Re),he(Re,l)}function ge(){ce(Re),ce(Ce),ce(Ie)}function _e(a){a.memoizedState!==null&&he(Ne,a);var l=Re.current,d=jh(l,a.type);l!==d&&(he(Ce,a),he(Re,d))}function X(a){Ce.current===a&&(ce(Re),ce(Ce)),Ne.current===a&&(ce(Ne),yr._currentValue=$)}var se=Object.prototype.hasOwnProperty,fe=s.unstable_scheduleCallback,ve=s.unstable_cancelCallback,Me=s.unstable_shouldYield,Be=s.unstable_requestPaint,Le=s.unstable_now,pe=s.unstable_getCurrentPriorityLevel,Ge=s.unstable_ImmediatePriority,qe=s.unstable_UserBlockingPriority,pt=s.unstable_NormalPriority,dt=s.unstable_LowPriority,Et=s.unstable_IdlePriority,rt=s.log,ct=s.unstable_setDisableYieldValue,yt=null,mt=null;function Fe(a){if(mt&&typeof mt.onCommitFiberRoot=="function")try{mt.onCommitFiberRoot(yt,a,void 0,(a.current.flags&128)===128)}catch{}}function be(a){if(typeof rt=="function"&&ct(a),mt&&typeof mt.setStrictMode=="function")try{mt.setStrictMode(yt,a)}catch{}}var ye=Math.clz32?Math.clz32:vt,tt=Math.log,xt=Math.LN2;function vt(a){return a>>>=0,a===0?32:31-(tt(a)/xt|0)|0}var oe=128,ke=4194304;function Ve(a){var l=a&42;if(l!==0)return l;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function at(a,l){var d=a.pendingLanes;if(d===0)return 0;var m=0,b=a.suspendedLanes,S=a.pingedLanes,j=a.warmLanes;a=a.finishedLanes!==0;var K=d&134217727;return K!==0?(d=K&~b,d!==0?m=Ve(d):(S&=K,S!==0?m=Ve(S):a||(j=K&~j,j!==0&&(m=Ve(j))))):(K=d&~b,K!==0?m=Ve(K):S!==0?m=Ve(S):a||(j=d&~j,j!==0&&(m=Ve(j)))),m===0?0:l!==0&&l!==m&&!(l&b)&&(b=m&-m,j=l&-l,b>=j||b===32&&(j&4194176)!==0)?l:m}function Je(a,l){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&l)===0}function et(a,l){switch(a){case 1:case 2:case 4:case 8:return l+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ie(){var a=oe;return oe<<=1,!(oe&4194176)&&(oe=128),a}function Q(){var a=ke;return ke<<=1,!(ke&62914560)&&(ke=4194304),a}function ue(a){for(var l=[],d=0;31>d;d++)l.push(a);return l}function Ae(a,l){a.pendingLanes|=l,l!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Oe(a,l,d,m,b,S){var j=a.pendingLanes;a.pendingLanes=d,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=d,a.entangledLanes&=d,a.errorRecoveryDisabledLanes&=d,a.shellSuspendCounter=0;var K=a.entanglements,le=a.expirationTimes,Ee=a.hiddenUpdates;for(d=j&~d;0<d;){var ze=31-ye(d),Xe=1<<ze;K[ze]=0,le[ze]=-1;var De=Ee[ze];if(De!==null)for(Ee[ze]=null,ze=0;ze<De.length;ze++){var He=De[ze];He!==null&&(He.lane&=-536870913)}d&=~Xe}m!==0&&je(a,m,0),S!==0&&b===0&&a.tag!==0&&(a.suspendedLanes|=S&~(j&~l))}function je(a,l,d){a.pendingLanes|=l,a.suspendedLanes&=~l;var m=31-ye(l);a.entangledLanes|=l,a.entanglements[m]=a.entanglements[m]|1073741824|d&4194218}function Ue(a,l){var d=a.entangledLanes|=l;for(a=a.entanglements;d;){var m=31-ye(d),b=1<<m;b&l|a[m]&l&&(a[m]|=l),d&=~b}}function it(a){return a&=-a,2<a?8<a?a&134217727?32:268435456:8:2}function st(){var a=P.p;return a!==0?a:(a=window.event,a===void 0?32:nf(a.type))}function Ye(a,l){var d=P.p;try{return P.p=a,l()}finally{P.p=d}}var ht=Math.random().toString(36).slice(2),Qe="__reactFiber$"+ht,Ke="__reactProps$"+ht,ut="__reactContainer$"+ht,bt="__reactEvents$"+ht,At="__reactListeners$"+ht,Ot="__reactHandles$"+ht,Bt="__reactResources$"+ht,nt="__reactMarker$"+ht;function me(a){delete a[Qe],delete a[Ke],delete a[bt],delete a[At],delete a[Ot]}function We(a){var l=a[Qe];if(l)return l;for(var d=a.parentNode;d;){if(l=d[ut]||d[Qe]){if(d=l.alternate,l.child!==null||d!==null&&d.child!==null)for(a=Bh(a);a!==null;){if(d=a[Qe])return d;a=Bh(a)}return l}a=d,d=a.parentNode}return null}function lt(a){if(a=a[Qe]||a[ut]){var l=a.tag;if(l===5||l===6||l===13||l===26||l===27||l===3)return a}return null}function It(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a.stateNode;throw Error(n(33))}function Ht(a){var l=a[Bt];return l||(l=a[Bt]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Pt(a){a[nt]=!0}var rn=new Set,pn={};function mn(a,l){Vt(a,l),Vt(a+"Capture",l)}function Vt(a,l){for(pn[a]=l,a=0;a<l.length;a++)rn.add(l[a])}var xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),jc={},$c={};function Vf(a){return se.call($c,a)?!0:se.call(jc,a)?!1:Pr.test(a)?$c[a]=!0:(jc[a]=!0,!1)}function kr(a,l,d){if(Vf(l))if(d===null)a.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":a.removeAttribute(l);return;case"boolean":var m=l.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){a.removeAttribute(l);return}}a.setAttribute(l,""+d)}}function Mr(a,l,d){if(d===null)a.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttribute(l,""+d)}}function qn(a,l,d,m){if(m===null)a.removeAttribute(d);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(d);return}a.setAttributeNS(l,d,""+m)}}function En(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Uc(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Zf(a){var l=Uc(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,l),m=""+a[l];if(!a.hasOwnProperty(l)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var b=d.get,S=d.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return b.call(this)},set:function(j){m=""+j,S.call(this,j)}}),Object.defineProperty(a,l,{enumerable:d.enumerable}),{getValue:function(){return m},setValue:function(j){m=""+j},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function Ir(a){a._valueTracker||(a._valueTracker=Zf(a))}function Bc(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var d=l.getValue(),m="";return a&&(m=Uc(a)?a.checked?"true":"false":a.value),a=m,a!==d?(l.setValue(a),!0):!1}function Dr(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Gf=/[\n"\\]/g;function Sn(a){return a.replace(Gf,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Qa(a,l,d,m,b,S,j,K){a.name="",j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?a.type=j:a.removeAttribute("type"),l!=null?j==="number"?(l===0&&a.value===""||a.value!=l)&&(a.value=""+En(l)):a.value!==""+En(l)&&(a.value=""+En(l)):j!=="submit"&&j!=="reset"||a.removeAttribute("value"),l!=null?eo(a,j,En(l)):d!=null?eo(a,j,En(d)):m!=null&&a.removeAttribute("value"),b==null&&S!=null&&(a.defaultChecked=!!S),b!=null&&(a.checked=b&&typeof b!="function"&&typeof b!="symbol"),K!=null&&typeof K!="function"&&typeof K!="symbol"&&typeof K!="boolean"?a.name=""+En(K):a.removeAttribute("name")}function Hc(a,l,d,m,b,S,j,K){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(a.type=S),l!=null||d!=null){if(!(S!=="submit"&&S!=="reset"||l!=null))return;d=d!=null?""+En(d):"",l=l!=null?""+En(l):d,K||l===a.value||(a.value=l),a.defaultValue=l}m=m??b,m=typeof m!="function"&&typeof m!="symbol"&&!!m,a.checked=K?a.checked:!!m,a.defaultChecked=!!m,j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(a.name=j)}function eo(a,l,d){l==="number"&&Dr(a.ownerDocument)===a||a.defaultValue===""+d||(a.defaultValue=""+d)}function Xi(a,l,d,m){if(a=a.options,l){l={};for(var b=0;b<d.length;b++)l["$"+d[b]]=!0;for(d=0;d<a.length;d++)b=l.hasOwnProperty("$"+a[d].value),a[d].selected!==b&&(a[d].selected=b),b&&m&&(a[d].defaultSelected=!0)}else{for(d=""+En(d),l=null,b=0;b<a.length;b++){if(a[b].value===d){a[b].selected=!0,m&&(a[b].defaultSelected=!0);return}l!==null||a[b].disabled||(l=a[b])}l!==null&&(l.selected=!0)}}function zc(a,l,d){if(l!=null&&(l=""+En(l),l!==a.value&&(a.value=l),d==null)){a.defaultValue!==l&&(a.defaultValue=l);return}a.defaultValue=d!=null?""+En(d):""}function qc(a,l,d,m){if(l==null){if(m!=null){if(d!=null)throw Error(n(92));if(C(m)){if(1<m.length)throw Error(n(93));m=m[0]}d=m}d==null&&(d=""),l=d}d=En(l),a.defaultValue=d,m=a.textContent,m===d&&m!==""&&m!==null&&(a.value=m)}function Yi(a,l){if(l){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=l;return}}a.textContent=l}var Wf=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Vc(a,l,d){var m=l.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?m?a.setProperty(l,""):l==="float"?a.cssFloat="":a[l]="":m?a.setProperty(l,d):typeof d!="number"||d===0||Wf.has(l)?l==="float"?a.cssFloat=d:a[l]=(""+d).trim():a[l]=d+"px"}function Zc(a,l,d){if(l!=null&&typeof l!="object")throw Error(n(62));if(a=a.style,d!=null){for(var m in d)!d.hasOwnProperty(m)||l!=null&&l.hasOwnProperty(m)||(m.indexOf("--")===0?a.setProperty(m,""):m==="float"?a.cssFloat="":a[m]="");for(var b in l)m=l[b],l.hasOwnProperty(b)&&d[b]!==m&&Vc(a,b,m)}else for(var S in l)l.hasOwnProperty(S)&&Vc(a,S,l[S])}function no(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Yf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Lr(a){return Yf.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var io=null;function so(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Ki=null,Ji=null;function Gc(a){var l=lt(a);if(l&&(a=l.stateNode)){var d=a[Ke]||null;e:switch(a=l.stateNode,l.type){case"input":if(Qa(a,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),l=d.name,d.type==="radio"&&l!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+Sn(""+l)+'"][type="radio"]'),l=0;l<d.length;l++){var m=d[l];if(m!==a&&m.form===a.form){var b=m[Ke]||null;if(!b)throw Error(n(90));Qa(m,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(l=0;l<d.length;l++)m=d[l],m.form===a.form&&Bc(m)}break e;case"textarea":zc(a,d.value,d.defaultValue);break e;case"select":l=d.value,l!=null&&Xi(a,!!d.multiple,l,!1)}}}var ro=!1;function Wc(a,l,d){if(ro)return a(l,d);ro=!0;try{var m=a(l);return m}finally{if(ro=!1,(Ki!==null||Ji!==null)&&(ba(),Ki&&(l=Ki,a=Ji,Ji=Ki=null,Gc(l),a)))for(l=0;l<a.length;l++)Gc(a[l])}}function ks(a,l){var d=a.stateNode;if(d===null)return null;var m=d[Ke]||null;if(m===null)return null;d=m[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(n(231,l,typeof d));return d}var ao=!1;if(xn)try{var Ms={};Object.defineProperty(Ms,"passive",{get:function(){ao=!0}}),window.addEventListener("test",Ms,Ms),window.removeEventListener("test",Ms,Ms)}catch{ao=!1}var oi=null,oo=null,Nr=null;function Xc(){if(Nr)return Nr;var a,l=oo,d=l.length,m,b="value"in oi?oi.value:oi.textContent,S=b.length;for(a=0;a<d&&l[a]===b[a];a++);var j=d-a;for(m=1;m<=j&&l[d-m]===b[S-m];m++);return Nr=b.slice(a,1<m?1-m:void 0)}function Fr(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function jr(){return!0}function Yc(){return!1}function hn(a){function l(d,m,b,S,j){this._reactName=d,this._targetInst=b,this.type=m,this.nativeEvent=S,this.target=j,this.currentTarget=null;for(var K in a)a.hasOwnProperty(K)&&(d=a[K],this[K]=d?d(S):S[K]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?jr:Yc,this.isPropagationStopped=Yc,this}return H(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=jr)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=jr)},persist:function(){},isPersistent:jr}),l}var Oi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$r=hn(Oi),Is=H({},Oi,{view:0,detail:0}),Kf=hn(Is),lo,co,Ds,Ur=H({},Is,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ho,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Ds&&(Ds&&a.type==="mousemove"?(lo=a.screenX-Ds.screenX,co=a.screenY-Ds.screenY):co=lo=0,Ds=a),lo)},movementY:function(a){return"movementY"in a?a.movementY:co}}),Kc=hn(Ur),Jf=H({},Ur,{dataTransfer:0}),Qf=hn(Jf),ep=H({},Is,{relatedTarget:0}),uo=hn(ep),tp=H({},Oi,{animationName:0,elapsedTime:0,pseudoElement:0}),np=hn(tp),ip=H({},Oi,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),sp=hn(ip),rp=H({},Oi,{data:0}),Jc=hn(rp),ap={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},op={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cp(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=lp[a])?!!l[a]:!1}function ho(){return cp}var up=H({},Is,{key:function(a){if(a.key){var l=ap[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=Fr(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?op[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ho,charCode:function(a){return a.type==="keypress"?Fr(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Fr(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),dp=hn(up),hp=H({},Ur,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qc=hn(hp),fp=H({},Is,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ho}),pp=hn(fp),mp=H({},Oi,{propertyName:0,elapsedTime:0,pseudoElement:0}),gp=hn(mp),yp=H({},Ur,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),bp=hn(yp),_p=H({},Oi,{newState:0,oldState:0}),vp=hn(_p),xp=[9,13,27,32],fo=xn&&"CompositionEvent"in window,Ls=null;xn&&"documentMode"in document&&(Ls=document.documentMode);var Ep=xn&&"TextEvent"in window&&!Ls,eu=xn&&(!fo||Ls&&8<Ls&&11>=Ls),tu=" ",nu=!1;function iu(a,l){switch(a){case"keyup":return xp.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function su(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Qi=!1;function Sp(a,l){switch(a){case"compositionend":return su(l);case"keypress":return l.which!==32?null:(nu=!0,tu);case"textInput":return a=l.data,a===tu&&nu?null:a;default:return null}}function wp(a,l){if(Qi)return a==="compositionend"||!fo&&iu(a,l)?(a=Xc(),Nr=oo=oi=null,Qi=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return eu&&l.locale!=="ko"?null:l.data;default:return null}}var Ap={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ru(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!Ap[a.type]:l==="textarea"}function au(a,l,d,m){Ki?Ji?Ji.push(m):Ji=[m]:Ki=m,l=wa(l,"onChange"),0<l.length&&(d=new $r("onChange","change",null,d,m),a.push({event:d,listeners:l}))}var Ns=null,Fs=null;function Tp(a){Mh(a,0)}function Br(a){var l=It(a);if(Bc(l))return a}function ou(a,l){if(a==="change")return l}var lu=!1;if(xn){var po;if(xn){var mo="oninput"in document;if(!mo){var cu=document.createElement("div");cu.setAttribute("oninput","return;"),mo=typeof cu.oninput=="function"}po=mo}else po=!1;lu=po&&(!document.documentMode||9<document.documentMode)}function uu(){Ns&&(Ns.detachEvent("onpropertychange",du),Fs=Ns=null)}function du(a){if(a.propertyName==="value"&&Br(Fs)){var l=[];au(l,Fs,a,so(a)),Wc(Tp,l)}}function Rp(a,l,d){a==="focusin"?(uu(),Ns=l,Fs=d,Ns.attachEvent("onpropertychange",du)):a==="focusout"&&uu()}function Cp(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Br(Fs)}function Op(a,l){if(a==="click")return Br(l)}function Pp(a,l){if(a==="input"||a==="change")return Br(l)}function kp(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var gn=typeof Object.is=="function"?Object.is:kp;function js(a,l){if(gn(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var d=Object.keys(a),m=Object.keys(l);if(d.length!==m.length)return!1;for(m=0;m<d.length;m++){var b=d[m];if(!se.call(l,b)||!gn(a[b],l[b]))return!1}return!0}function hu(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function fu(a,l){var d=hu(a);a=0;for(var m;d;){if(d.nodeType===3){if(m=a+d.textContent.length,a<=l&&m>=l)return{node:d,offset:l-a};a=m}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=hu(d)}}function pu(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?pu(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function mu(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var l=Dr(a.document);l instanceof a.HTMLIFrameElement;){try{var d=typeof l.contentWindow.location.href=="string"}catch{d=!1}if(d)a=l.contentWindow;else break;l=Dr(a.document)}return l}function go(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}function Mp(a,l){var d=mu(l);l=a.focusedElem;var m=a.selectionRange;if(d!==l&&l&&l.ownerDocument&&pu(l.ownerDocument.documentElement,l)){if(m!==null&&go(l)){if(a=m.start,d=m.end,d===void 0&&(d=a),"selectionStart"in l)l.selectionStart=a,l.selectionEnd=Math.min(d,l.value.length);else if(d=(a=l.ownerDocument||document)&&a.defaultView||window,d.getSelection){d=d.getSelection();var b=l.textContent.length,S=Math.min(m.start,b);m=m.end===void 0?S:Math.min(m.end,b),!d.extend&&S>m&&(b=m,m=S,S=b),b=fu(l,S);var j=fu(l,m);b&&j&&(d.rangeCount!==1||d.anchorNode!==b.node||d.anchorOffset!==b.offset||d.focusNode!==j.node||d.focusOffset!==j.offset)&&(a=a.createRange(),a.setStart(b.node,b.offset),d.removeAllRanges(),S>m?(d.addRange(a),d.extend(j.node,j.offset)):(a.setEnd(j.node,j.offset),d.addRange(a)))}}for(a=[],d=l;d=d.parentNode;)d.nodeType===1&&a.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<a.length;l++)d=a[l],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var Ip=xn&&"documentMode"in document&&11>=document.documentMode,es=null,yo=null,$s=null,bo=!1;function gu(a,l,d){var m=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;bo||es==null||es!==Dr(m)||(m=es,"selectionStart"in m&&go(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),$s&&js($s,m)||($s=m,m=wa(yo,"onSelect"),0<m.length&&(l=new $r("onSelect","select",null,l,d),a.push({event:l,listeners:m}),l.target=es)))}function Pi(a,l){var d={};return d[a.toLowerCase()]=l.toLowerCase(),d["Webkit"+a]="webkit"+l,d["Moz"+a]="moz"+l,d}var ts={animationend:Pi("Animation","AnimationEnd"),animationiteration:Pi("Animation","AnimationIteration"),animationstart:Pi("Animation","AnimationStart"),transitionrun:Pi("Transition","TransitionRun"),transitionstart:Pi("Transition","TransitionStart"),transitioncancel:Pi("Transition","TransitionCancel"),transitionend:Pi("Transition","TransitionEnd")},_o={},yu={};xn&&(yu=document.createElement("div").style,"AnimationEvent"in window||(delete ts.animationend.animation,delete ts.animationiteration.animation,delete ts.animationstart.animation),"TransitionEvent"in window||delete ts.transitionend.transition);function ki(a){if(_o[a])return _o[a];if(!ts[a])return a;var l=ts[a],d;for(d in l)if(l.hasOwnProperty(d)&&d in yu)return _o[a]=l[d];return a}var bu=ki("animationend"),_u=ki("animationiteration"),vu=ki("animationstart"),Dp=ki("transitionrun"),Lp=ki("transitionstart"),Np=ki("transitioncancel"),xu=ki("transitionend"),Eu=new Map,Su="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Ln(a,l){Eu.set(a,l),mn(l,[a])}var wn=[],ns=0,vo=0;function Hr(){for(var a=ns,l=vo=ns=0;l<a;){var d=wn[l];wn[l++]=null;var m=wn[l];wn[l++]=null;var b=wn[l];wn[l++]=null;var S=wn[l];if(wn[l++]=null,m!==null&&b!==null){var j=m.pending;j===null?b.next=b:(b.next=j.next,j.next=b),m.pending=b}S!==0&&wu(d,b,S)}}function zr(a,l,d,m){wn[ns++]=a,wn[ns++]=l,wn[ns++]=d,wn[ns++]=m,vo|=m,a.lanes|=m,a=a.alternate,a!==null&&(a.lanes|=m)}function xo(a,l,d,m){return zr(a,l,d,m),qr(a)}function li(a,l){return zr(a,null,null,l),qr(a)}function wu(a,l,d){a.lanes|=d;var m=a.alternate;m!==null&&(m.lanes|=d);for(var b=!1,S=a.return;S!==null;)S.childLanes|=d,m=S.alternate,m!==null&&(m.childLanes|=d),S.tag===22&&(a=S.stateNode,a===null||a._visibility&1||(b=!0)),a=S,S=S.return;b&&l!==null&&a.tag===3&&(S=a.stateNode,b=31-ye(d),S=S.hiddenUpdates,a=S[b],a===null?S[b]=[l]:a.push(l),l.lane=d|536870912)}function qr(a){if(50<ur)throw ur=0,Rl=null,Error(n(185));for(var l=a.return;l!==null;)a=l,l=a.return;return a.tag===3?a.stateNode:null}var is={},Au=new WeakMap;function An(a,l){if(typeof a=="object"&&a!==null){var d=Au.get(a);return d!==void 0?d:(l={value:a,source:l,stack:G(l)},Au.set(a,l),l)}return{value:a,source:l,stack:G(l)}}var ss=[],rs=0,Vr=null,Zr=0,Tn=[],Rn=0,Mi=null,Vn=1,Zn="";function Ii(a,l){ss[rs++]=Zr,ss[rs++]=Vr,Vr=a,Zr=l}function Tu(a,l,d){Tn[Rn++]=Vn,Tn[Rn++]=Zn,Tn[Rn++]=Mi,Mi=a;var m=Vn;a=Zn;var b=32-ye(m)-1;m&=~(1<<b),d+=1;var S=32-ye(l)+b;if(30<S){var j=b-b%5;S=(m&(1<<j)-1).toString(32),m>>=j,b-=j,Vn=1<<32-ye(l)+b|d<<b|m,Zn=S+a}else Vn=1<<S|d<<b|m,Zn=a}function Eo(a){a.return!==null&&(Ii(a,1),Tu(a,1,0))}function So(a){for(;a===Vr;)Vr=ss[--rs],ss[rs]=null,Zr=ss[--rs],ss[rs]=null;for(;a===Mi;)Mi=Tn[--Rn],Tn[Rn]=null,Zn=Tn[--Rn],Tn[Rn]=null,Vn=Tn[--Rn],Tn[Rn]=null}var un=null,an=null,Dt=!1,Nn=null,$n=!1,wo=Error(n(519));function Di(a){var l=Error(n(418,""));throw Hs(An(l,a)),wo}function Ru(a){var l=a.stateNode,d=a.type,m=a.memoizedProps;switch(l[Qe]=a,l[Ke]=m,d){case"dialog":kt("cancel",l),kt("close",l);break;case"iframe":case"object":case"embed":kt("load",l);break;case"video":case"audio":for(d=0;d<hr.length;d++)kt(hr[d],l);break;case"source":kt("error",l);break;case"img":case"image":case"link":kt("error",l),kt("load",l);break;case"details":kt("toggle",l);break;case"input":kt("invalid",l),Hc(l,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0),Ir(l);break;case"select":kt("invalid",l);break;case"textarea":kt("invalid",l),qc(l,m.value,m.defaultValue,m.children),Ir(l)}d=m.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||l.textContent===""+d||m.suppressHydrationWarning===!0||Nh(l.textContent,d)?(m.popover!=null&&(kt("beforetoggle",l),kt("toggle",l)),m.onScroll!=null&&kt("scroll",l),m.onScrollEnd!=null&&kt("scrollend",l),m.onClick!=null&&(l.onclick=Aa),l=!0):l=!1,l||Di(a)}function Cu(a){for(un=a.return;un;)switch(un.tag){case 3:case 27:$n=!0;return;case 5:case 13:$n=!1;return;default:un=un.return}}function Us(a){if(a!==un)return!1;if(!Dt)return Cu(a),Dt=!0,!1;var l=!1,d;if((d=a.tag!==3&&a.tag!==27)&&((d=a.tag===5)&&(d=a.type,d=!(d!=="form"&&d!=="button")||ql(a.type,a.memoizedProps)),d=!d),d&&(l=!0),l&&an&&Di(a),Cu(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));e:{for(a=a.nextSibling,l=0;a;){if(a.nodeType===8)if(d=a.data,d==="/$"){if(l===0){an=jn(a.nextSibling);break e}l--}else d!=="$"&&d!=="$!"&&d!=="$?"||l++;a=a.nextSibling}an=null}}else an=un?jn(a.stateNode.nextSibling):null;return!0}function Bs(){an=un=null,Dt=!1}function Hs(a){Nn===null?Nn=[a]:Nn.push(a)}var zs=Error(n(460)),Ou=Error(n(474)),Ao={then:function(){}};function Pu(a){return a=a.status,a==="fulfilled"||a==="rejected"}function Gr(){}function ku(a,l,d){switch(d=a[d],d===void 0?a.push(l):d!==l&&(l.then(Gr,Gr),l=d),l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,a===zs?Error(n(483)):a;default:if(typeof l.status=="string")l.then(Gr,Gr);else{if(a=$t,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=l,a.status="pending",a.then(function(m){if(l.status==="pending"){var b=l;b.status="fulfilled",b.value=m}},function(m){if(l.status==="pending"){var b=l;b.status="rejected",b.reason=m}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,a===zs?Error(n(483)):a}throw qs=l,zs}}var qs=null;function Mu(){if(qs===null)throw Error(n(459));var a=qs;return qs=null,a}var as=null,Vs=0;function Wr(a){var l=Vs;return Vs+=1,as===null&&(as=[]),ku(as,a,l)}function Zs(a,l){l=l.props.ref,a.ref=l!==void 0?l:null}function Xr(a,l){throw l.$$typeof===o?Error(n(525)):(a=Object.prototype.toString.call(l),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a)))}function Iu(a){var l=a._init;return l(a._payload)}function Du(a){function l(Te,xe){if(a){var Pe=Te.deletions;Pe===null?(Te.deletions=[xe],Te.flags|=16):Pe.push(xe)}}function d(Te,xe){if(!a)return null;for(;xe!==null;)l(Te,xe),xe=xe.sibling;return null}function m(Te){for(var xe=new Map;Te!==null;)Te.key!==null?xe.set(Te.key,Te):xe.set(Te.index,Te),Te=Te.sibling;return xe}function b(Te,xe){return Te=vi(Te,xe),Te.index=0,Te.sibling=null,Te}function S(Te,xe,Pe){return Te.index=Pe,a?(Pe=Te.alternate,Pe!==null?(Pe=Pe.index,Pe<xe?(Te.flags|=33554434,xe):Pe):(Te.flags|=33554434,xe)):(Te.flags|=1048576,xe)}function j(Te){return a&&Te.alternate===null&&(Te.flags|=33554434),Te}function K(Te,xe,Pe,Ze){return xe===null||xe.tag!==6?(xe=_l(Pe,Te.mode,Ze),xe.return=Te,xe):(xe=b(xe,Pe),xe.return=Te,xe)}function le(Te,xe,Pe,Ze){var ft=Pe.type;return ft===h?ze(Te,xe,Pe.props.children,Ze,Pe.key):xe!==null&&(xe.elementType===ft||typeof ft=="object"&&ft!==null&&ft.$$typeof===T&&Iu(ft)===xe.type)?(xe=b(xe,Pe.props),Zs(xe,Pe),xe.return=Te,xe):(xe=fa(Pe.type,Pe.key,Pe.props,null,Te.mode,Ze),Zs(xe,Pe),xe.return=Te,xe)}function Ee(Te,xe,Pe,Ze){return xe===null||xe.tag!==4||xe.stateNode.containerInfo!==Pe.containerInfo||xe.stateNode.implementation!==Pe.implementation?(xe=vl(Pe,Te.mode,Ze),xe.return=Te,xe):(xe=b(xe,Pe.children||[]),xe.return=Te,xe)}function ze(Te,xe,Pe,Ze,ft){return xe===null||xe.tag!==7?(xe=qi(Pe,Te.mode,Ze,ft),xe.return=Te,xe):(xe=b(xe,Pe),xe.return=Te,xe)}function Xe(Te,xe,Pe){if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return xe=_l(""+xe,Te.mode,Pe),xe.return=Te,xe;if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case c:return Pe=fa(xe.type,xe.key,xe.props,null,Te.mode,Pe),Zs(Pe,xe),Pe.return=Te,Pe;case u:return xe=vl(xe,Te.mode,Pe),xe.return=Te,xe;case T:var Ze=xe._init;return xe=Ze(xe._payload),Xe(Te,xe,Pe)}if(C(xe)||I(xe))return xe=qi(xe,Te.mode,Pe,null),xe.return=Te,xe;if(typeof xe.then=="function")return Xe(Te,Wr(xe),Pe);if(xe.$$typeof===v)return Xe(Te,ua(Te,xe),Pe);Xr(Te,xe)}return null}function De(Te,xe,Pe,Ze){var ft=xe!==null?xe.key:null;if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number"||typeof Pe=="bigint")return ft!==null?null:K(Te,xe,""+Pe,Ze);if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case c:return Pe.key===ft?le(Te,xe,Pe,Ze):null;case u:return Pe.key===ft?Ee(Te,xe,Pe,Ze):null;case T:return ft=Pe._init,Pe=ft(Pe._payload),De(Te,xe,Pe,Ze)}if(C(Pe)||I(Pe))return ft!==null?null:ze(Te,xe,Pe,Ze,null);if(typeof Pe.then=="function")return De(Te,xe,Wr(Pe),Ze);if(Pe.$$typeof===v)return De(Te,xe,ua(Te,Pe),Ze);Xr(Te,Pe)}return null}function He(Te,xe,Pe,Ze,ft){if(typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint")return Te=Te.get(Pe)||null,K(xe,Te,""+Ze,ft);if(typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case c:return Te=Te.get(Ze.key===null?Pe:Ze.key)||null,le(xe,Te,Ze,ft);case u:return Te=Te.get(Ze.key===null?Pe:Ze.key)||null,Ee(xe,Te,Ze,ft);case T:var Rt=Ze._init;return Ze=Rt(Ze._payload),He(Te,xe,Pe,Ze,ft)}if(C(Ze)||I(Ze))return Te=Te.get(Pe)||null,ze(xe,Te,Ze,ft,null);if(typeof Ze.then=="function")return He(Te,xe,Pe,Wr(Ze),ft);if(Ze.$$typeof===v)return He(Te,xe,Pe,ua(xe,Ze),ft);Xr(xe,Ze)}return null}function gt(Te,xe,Pe,Ze){for(var ft=null,Rt=null,_t=xe,St=xe=0,sn=null;_t!==null&&St<Pe.length;St++){_t.index>St?(sn=_t,_t=null):sn=_t.sibling;var Lt=De(Te,_t,Pe[St],Ze);if(Lt===null){_t===null&&(_t=sn);break}a&&_t&&Lt.alternate===null&&l(Te,_t),xe=S(Lt,xe,St),Rt===null?ft=Lt:Rt.sibling=Lt,Rt=Lt,_t=sn}if(St===Pe.length)return d(Te,_t),Dt&&Ii(Te,St),ft;if(_t===null){for(;St<Pe.length;St++)_t=Xe(Te,Pe[St],Ze),_t!==null&&(xe=S(_t,xe,St),Rt===null?ft=_t:Rt.sibling=_t,Rt=_t);return Dt&&Ii(Te,St),ft}for(_t=m(_t);St<Pe.length;St++)sn=He(_t,Te,St,Pe[St],Ze),sn!==null&&(a&&sn.alternate!==null&&_t.delete(sn.key===null?St:sn.key),xe=S(sn,xe,St),Rt===null?ft=sn:Rt.sibling=sn,Rt=sn);return a&&_t.forEach(function(Ri){return l(Te,Ri)}),Dt&&Ii(Te,St),ft}function wt(Te,xe,Pe,Ze){if(Pe==null)throw Error(n(151));for(var ft=null,Rt=null,_t=xe,St=xe=0,sn=null,Lt=Pe.next();_t!==null&&!Lt.done;St++,Lt=Pe.next()){_t.index>St?(sn=_t,_t=null):sn=_t.sibling;var Ri=De(Te,_t,Lt.value,Ze);if(Ri===null){_t===null&&(_t=sn);break}a&&_t&&Ri.alternate===null&&l(Te,_t),xe=S(Ri,xe,St),Rt===null?ft=Ri:Rt.sibling=Ri,Rt=Ri,_t=sn}if(Lt.done)return d(Te,_t),Dt&&Ii(Te,St),ft;if(_t===null){for(;!Lt.done;St++,Lt=Pe.next())Lt=Xe(Te,Lt.value,Ze),Lt!==null&&(xe=S(Lt,xe,St),Rt===null?ft=Lt:Rt.sibling=Lt,Rt=Lt);return Dt&&Ii(Te,St),ft}for(_t=m(_t);!Lt.done;St++,Lt=Pe.next())Lt=He(_t,Te,St,Lt.value,Ze),Lt!==null&&(a&&Lt.alternate!==null&&_t.delete(Lt.key===null?St:Lt.key),xe=S(Lt,xe,St),Rt===null?ft=Lt:Rt.sibling=Lt,Rt=Lt);return a&&_t.forEach(function(Ym){return l(Te,Ym)}),Dt&&Ii(Te,St),ft}function Wt(Te,xe,Pe,Ze){if(typeof Pe=="object"&&Pe!==null&&Pe.type===h&&Pe.key===null&&(Pe=Pe.props.children),typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case c:e:{for(var ft=Pe.key;xe!==null;){if(xe.key===ft){if(ft=Pe.type,ft===h){if(xe.tag===7){d(Te,xe.sibling),Ze=b(xe,Pe.props.children),Ze.return=Te,Te=Ze;break e}}else if(xe.elementType===ft||typeof ft=="object"&&ft!==null&&ft.$$typeof===T&&Iu(ft)===xe.type){d(Te,xe.sibling),Ze=b(xe,Pe.props),Zs(Ze,Pe),Ze.return=Te,Te=Ze;break e}d(Te,xe);break}else l(Te,xe);xe=xe.sibling}Pe.type===h?(Ze=qi(Pe.props.children,Te.mode,Ze,Pe.key),Ze.return=Te,Te=Ze):(Ze=fa(Pe.type,Pe.key,Pe.props,null,Te.mode,Ze),Zs(Ze,Pe),Ze.return=Te,Te=Ze)}return j(Te);case u:e:{for(ft=Pe.key;xe!==null;){if(xe.key===ft)if(xe.tag===4&&xe.stateNode.containerInfo===Pe.containerInfo&&xe.stateNode.implementation===Pe.implementation){d(Te,xe.sibling),Ze=b(xe,Pe.children||[]),Ze.return=Te,Te=Ze;break e}else{d(Te,xe);break}else l(Te,xe);xe=xe.sibling}Ze=vl(Pe,Te.mode,Ze),Ze.return=Te,Te=Ze}return j(Te);case T:return ft=Pe._init,Pe=ft(Pe._payload),Wt(Te,xe,Pe,Ze)}if(C(Pe))return gt(Te,xe,Pe,Ze);if(I(Pe)){if(ft=I(Pe),typeof ft!="function")throw Error(n(150));return Pe=ft.call(Pe),wt(Te,xe,Pe,Ze)}if(typeof Pe.then=="function")return Wt(Te,xe,Wr(Pe),Ze);if(Pe.$$typeof===v)return Wt(Te,xe,ua(Te,Pe),Ze);Xr(Te,Pe)}return typeof Pe=="string"&&Pe!==""||typeof Pe=="number"||typeof Pe=="bigint"?(Pe=""+Pe,xe!==null&&xe.tag===6?(d(Te,xe.sibling),Ze=b(xe,Pe),Ze.return=Te,Te=Ze):(d(Te,xe),Ze=_l(Pe,Te.mode,Ze),Ze.return=Te,Te=Ze),j(Te)):d(Te,xe)}return function(Te,xe,Pe,Ze){try{Vs=0;var ft=Wt(Te,xe,Pe,Ze);return as=null,ft}catch(_t){if(_t===zs)throw _t;var Rt=kn(29,_t,null,Te.mode);return Rt.lanes=Ze,Rt.return=Te,Rt}finally{}}}var Li=Du(!0),Lu=Du(!1),os=ee(null),Yr=ee(0);function Nu(a,l){a=ii,he(Yr,a),he(os,l),ii=a|l.baseLanes}function To(){he(Yr,ii),he(os,os.current)}function Ro(){ii=Yr.current,ce(os),ce(Yr)}var Cn=ee(null),Un=null;function ci(a){var l=a.alternate;he(Qt,Qt.current&1),he(Cn,a),Un===null&&(l===null||os.current!==null||l.memoizedState!==null)&&(Un=a)}function Fu(a){if(a.tag===22){if(he(Qt,Qt.current),he(Cn,a),Un===null){var l=a.alternate;l!==null&&l.memoizedState!==null&&(Un=a)}}else ui()}function ui(){he(Qt,Qt.current),he(Cn,Cn.current)}function Gn(a){ce(Cn),Un===a&&(Un=null),ce(Qt)}var Qt=ee(0);function Kr(a){for(var l=a;l!==null;){if(l.tag===13){var d=l.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if(l.flags&128)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Fp=typeof AbortController<"u"?AbortController:function(){var a=[],l=this.signal={aborted:!1,addEventListener:function(d,m){a.push(m)}};this.abort=function(){l.aborted=!0,a.forEach(function(d){return d()})}},jp=s.unstable_scheduleCallback,$p=s.unstable_NormalPriority,en={$$typeof:v,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Co(){return{controller:new Fp,data:new Map,refCount:0}}function Gs(a){a.refCount--,a.refCount===0&&jp($p,function(){a.controller.abort()})}var Ws=null,Oo=0,ls=0,cs=null;function Up(a,l){if(Ws===null){var d=Ws=[];Oo=0,ls=Ll(),cs={status:"pending",value:void 0,then:function(m){d.push(m)}}}return Oo++,l.then(ju,ju),l}function ju(){if(--Oo===0&&Ws!==null){cs!==null&&(cs.status="fulfilled");var a=Ws;Ws=null,ls=0,cs=null;for(var l=0;l<a.length;l++)(0,a[l])()}}function Bp(a,l){var d=[],m={status:"pending",value:null,reason:null,then:function(b){d.push(b)}};return a.then(function(){m.status="fulfilled",m.value=l;for(var b=0;b<d.length;b++)(0,d[b])(l)},function(b){for(m.status="rejected",m.reason=b,b=0;b<d.length;b++)(0,d[b])(void 0)}),m}var $u=L.S;L.S=function(a,l){typeof l=="object"&&l!==null&&typeof l.then=="function"&&Up(a,l),$u!==null&&$u(a,l)};var Ni=ee(null);function Po(){var a=Ni.current;return a!==null?a:$t.pooledCache}function Jr(a,l){l===null?he(Ni,Ni.current):he(Ni,l.pool)}function Uu(){var a=Po();return a===null?null:{parent:en._currentValue,pool:a}}var di=0,Tt=null,Nt=null,Yt=null,Qr=!1,us=!1,Fi=!1,ea=0,Xs=0,ds=null,Hp=0;function Xt(){throw Error(n(321))}function ko(a,l){if(l===null)return!1;for(var d=0;d<l.length&&d<a.length;d++)if(!gn(a[d],l[d]))return!1;return!0}function Mo(a,l,d,m,b,S){return di=S,Tt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,L.H=a===null||a.memoizedState===null?ji:hi,Fi=!1,S=d(m,b),Fi=!1,us&&(S=Hu(l,d,m,b)),Bu(a),S}function Bu(a){L.H=Bn;var l=Nt!==null&&Nt.next!==null;if(di=0,Yt=Nt=Tt=null,Qr=!1,Xs=0,ds=null,l)throw Error(n(300));a===null||tn||(a=a.dependencies,a!==null&&ca(a)&&(tn=!0))}function Hu(a,l,d,m){Tt=a;var b=0;do{if(us&&(ds=null),Xs=0,us=!1,25<=b)throw Error(n(301));if(b+=1,Yt=Nt=null,a.updateQueue!=null){var S=a.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}L.H=$i,S=l(d,m)}while(us);return S}function zp(){var a=L.H,l=a.useState()[0];return l=typeof l.then=="function"?Ys(l):l,a=a.useState()[0],(Nt!==null?Nt.memoizedState:null)!==a&&(Tt.flags|=1024),l}function Io(){var a=ea!==0;return ea=0,a}function Do(a,l,d){l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~d}function Lo(a){if(Qr){for(a=a.memoizedState;a!==null;){var l=a.queue;l!==null&&(l.pending=null),a=a.next}Qr=!1}di=0,Yt=Nt=Tt=null,us=!1,Xs=ea=0,ds=null}function fn(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?Tt.memoizedState=Yt=a:Yt=Yt.next=a,Yt}function Kt(){if(Nt===null){var a=Tt.alternate;a=a!==null?a.memoizedState:null}else a=Nt.next;var l=Yt===null?Tt.memoizedState:Yt.next;if(l!==null)Yt=l,Nt=a;else{if(a===null)throw Tt.alternate===null?Error(n(467)):Error(n(310));Nt=a,a={memoizedState:Nt.memoizedState,baseState:Nt.baseState,baseQueue:Nt.baseQueue,queue:Nt.queue,next:null},Yt===null?Tt.memoizedState=Yt=a:Yt=Yt.next=a}return Yt}var ta;ta=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Ys(a){var l=Xs;return Xs+=1,ds===null&&(ds=[]),a=ku(ds,a,l),l=Tt,(Yt===null?l.memoizedState:Yt.next)===null&&(l=l.alternate,L.H=l===null||l.memoizedState===null?ji:hi),a}function na(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Ys(a);if(a.$$typeof===v)return cn(a)}throw Error(n(438,String(a)))}function No(a){var l=null,d=Tt.updateQueue;if(d!==null&&(l=d.memoCache),l==null){var m=Tt.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(l={data:m.data.map(function(b){return b.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),d===null&&(d=ta(),Tt.updateQueue=d),d.memoCache=l,d=l.data[l.index],d===void 0)for(d=l.data[l.index]=Array(a),m=0;m<a;m++)d[m]=N;return l.index++,d}function Wn(a,l){return typeof l=="function"?l(a):l}function ia(a){var l=Kt();return Fo(l,Nt,a)}function Fo(a,l,d){var m=a.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=d;var b=a.baseQueue,S=m.pending;if(S!==null){if(b!==null){var j=b.next;b.next=S.next,S.next=j}l.baseQueue=b=S,m.pending=null}if(S=a.baseState,b===null)a.memoizedState=S;else{l=b.next;var K=j=null,le=null,Ee=l,ze=!1;do{var Xe=Ee.lane&-536870913;if(Xe!==Ee.lane?(Mt&Xe)===Xe:(di&Xe)===Xe){var De=Ee.revertLane;if(De===0)le!==null&&(le=le.next={lane:0,revertLane:0,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null}),Xe===ls&&(ze=!0);else if((di&De)===De){Ee=Ee.next,De===ls&&(ze=!0);continue}else Xe={lane:0,revertLane:Ee.revertLane,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},le===null?(K=le=Xe,j=S):le=le.next=Xe,Tt.lanes|=De,xi|=De;Xe=Ee.action,Fi&&d(S,Xe),S=Ee.hasEagerState?Ee.eagerState:d(S,Xe)}else De={lane:Xe,revertLane:Ee.revertLane,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},le===null?(K=le=De,j=S):le=le.next=De,Tt.lanes|=Xe,xi|=Xe;Ee=Ee.next}while(Ee!==null&&Ee!==l);if(le===null?j=S:le.next=K,!gn(S,a.memoizedState)&&(tn=!0,ze&&(d=cs,d!==null)))throw d;a.memoizedState=S,a.baseState=j,a.baseQueue=le,m.lastRenderedState=S}return b===null&&(m.lanes=0),[a.memoizedState,m.dispatch]}function jo(a){var l=Kt(),d=l.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=a;var m=d.dispatch,b=d.pending,S=l.memoizedState;if(b!==null){d.pending=null;var j=b=b.next;do S=a(S,j.action),j=j.next;while(j!==b);gn(S,l.memoizedState)||(tn=!0),l.memoizedState=S,l.baseQueue===null&&(l.baseState=S),d.lastRenderedState=S}return[S,m]}function zu(a,l,d){var m=Tt,b=Kt(),S=Dt;if(S){if(d===void 0)throw Error(n(407));d=d()}else d=l();var j=!gn((Nt||b).memoizedState,d);if(j&&(b.memoizedState=d,tn=!0),b=b.queue,Bo(Zu.bind(null,m,b,a),[a]),b.getSnapshot!==l||j||Yt!==null&&Yt.memoizedState.tag&1){if(m.flags|=2048,hs(9,Vu.bind(null,m,b,d,l),{destroy:void 0},null),$t===null)throw Error(n(349));S||di&60||qu(m,l,d)}return d}function qu(a,l,d){a.flags|=16384,a={getSnapshot:l,value:d},l=Tt.updateQueue,l===null?(l=ta(),Tt.updateQueue=l,l.stores=[a]):(d=l.stores,d===null?l.stores=[a]:d.push(a))}function Vu(a,l,d,m){l.value=d,l.getSnapshot=m,Gu(l)&&Wu(a)}function Zu(a,l,d){return d(function(){Gu(l)&&Wu(a)})}function Gu(a){var l=a.getSnapshot;a=a.value;try{var d=l();return!gn(a,d)}catch{return!0}}function Wu(a){var l=li(a,2);l!==null&&dn(l,a,2)}function $o(a){var l=fn();if(typeof a=="function"){var d=a;if(a=d(),Fi){be(!0);try{d()}finally{be(!1)}}}return l.memoizedState=l.baseState=a,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wn,lastRenderedState:a},l}function Xu(a,l,d,m){return a.baseState=d,Fo(a,Nt,typeof m=="function"?m:Wn)}function qp(a,l,d,m,b){if(aa(a))throw Error(n(485));if(a=l.action,a!==null){var S={payload:b,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(j){S.listeners.push(j)}};L.T!==null?d(!0):S.isTransition=!1,m(S),d=l.pending,d===null?(S.next=l.pending=S,Yu(l,S)):(S.next=d.next,l.pending=d.next=S)}}function Yu(a,l){var d=l.action,m=l.payload,b=a.state;if(l.isTransition){var S=L.T,j={};L.T=j;try{var K=d(b,m),le=L.S;le!==null&&le(j,K),Ku(a,l,K)}catch(Ee){Uo(a,l,Ee)}finally{L.T=S}}else try{S=d(b,m),Ku(a,l,S)}catch(Ee){Uo(a,l,Ee)}}function Ku(a,l,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(m){Ju(a,l,m)},function(m){return Uo(a,l,m)}):Ju(a,l,d)}function Ju(a,l,d){l.status="fulfilled",l.value=d,Qu(l),a.state=d,l=a.pending,l!==null&&(d=l.next,d===l?a.pending=null:(d=d.next,l.next=d,Yu(a,d)))}function Uo(a,l,d){var m=a.pending;if(a.pending=null,m!==null){m=m.next;do l.status="rejected",l.reason=d,Qu(l),l=l.next;while(l!==m)}a.action=null}function Qu(a){a=a.listeners;for(var l=0;l<a.length;l++)(0,a[l])()}function ed(a,l){return l}function td(a,l){if(Dt){var d=$t.formState;if(d!==null){e:{var m=Tt;if(Dt){if(an){t:{for(var b=an,S=$n;b.nodeType!==8;){if(!S){b=null;break t}if(b=jn(b.nextSibling),b===null){b=null;break t}}S=b.data,b=S==="F!"||S==="F"?b:null}if(b){an=jn(b.nextSibling),m=b.data==="F!";break e}}Di(m)}m=!1}m&&(l=d[0])}}return d=fn(),d.memoizedState=d.baseState=l,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ed,lastRenderedState:l},d.queue=m,d=_d.bind(null,Tt,m),m.dispatch=d,m=$o(!1),S=Zo.bind(null,Tt,!1,m.queue),m=fn(),b={state:l,dispatch:null,action:a,pending:null},m.queue=b,d=qp.bind(null,Tt,b,S,d),b.dispatch=d,m.memoizedState=a,[l,d,!1]}function nd(a){var l=Kt();return id(l,Nt,a)}function id(a,l,d){l=Fo(a,l,ed)[0],a=ia(Wn)[0],l=typeof l=="object"&&l!==null&&typeof l.then=="function"?Ys(l):l;var m=Kt(),b=m.queue,S=b.dispatch;return d!==m.memoizedState&&(Tt.flags|=2048,hs(9,Vp.bind(null,b,d),{destroy:void 0},null)),[l,S,a]}function Vp(a,l){a.action=l}function sd(a){var l=Kt(),d=Nt;if(d!==null)return id(l,d,a);Kt(),l=l.memoizedState,d=Kt();var m=d.queue.dispatch;return d.memoizedState=a,[l,m,!1]}function hs(a,l,d,m){return a={tag:a,create:l,inst:d,deps:m,next:null},l=Tt.updateQueue,l===null&&(l=ta(),Tt.updateQueue=l),d=l.lastEffect,d===null?l.lastEffect=a.next=a:(m=d.next,d.next=a,a.next=m,l.lastEffect=a),a}function rd(){return Kt().memoizedState}function sa(a,l,d,m){var b=fn();Tt.flags|=a,b.memoizedState=hs(1|l,d,{destroy:void 0},m===void 0?null:m)}function ra(a,l,d,m){var b=Kt();m=m===void 0?null:m;var S=b.memoizedState.inst;Nt!==null&&m!==null&&ko(m,Nt.memoizedState.deps)?b.memoizedState=hs(l,d,S,m):(Tt.flags|=a,b.memoizedState=hs(1|l,d,S,m))}function ad(a,l){sa(8390656,8,a,l)}function Bo(a,l){ra(2048,8,a,l)}function od(a,l){return ra(4,2,a,l)}function ld(a,l){return ra(4,4,a,l)}function cd(a,l){if(typeof l=="function"){a=a();var d=l(a);return function(){typeof d=="function"?d():l(null)}}if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function ud(a,l,d){d=d!=null?d.concat([a]):null,ra(4,4,cd.bind(null,l,a),d)}function Ho(){}function dd(a,l){var d=Kt();l=l===void 0?null:l;var m=d.memoizedState;return l!==null&&ko(l,m[1])?m[0]:(d.memoizedState=[a,l],a)}function hd(a,l){var d=Kt();l=l===void 0?null:l;var m=d.memoizedState;if(l!==null&&ko(l,m[1]))return m[0];if(m=a(),Fi){be(!0);try{a()}finally{be(!1)}}return d.memoizedState=[m,l],m}function zo(a,l,d){return d===void 0||di&1073741824?a.memoizedState=l:(a.memoizedState=d,a=ph(),Tt.lanes|=a,xi|=a,d)}function fd(a,l,d,m){return gn(d,l)?d:os.current!==null?(a=zo(a,d,m),gn(a,l)||(tn=!0),a):di&42?(a=ph(),Tt.lanes|=a,xi|=a,l):(tn=!0,a.memoizedState=d)}function pd(a,l,d,m,b){var S=P.p;P.p=S!==0&&8>S?S:8;var j=L.T,K={};L.T=K,Zo(a,!1,l,d);try{var le=b(),Ee=L.S;if(Ee!==null&&Ee(K,le),le!==null&&typeof le=="object"&&typeof le.then=="function"){var ze=Bp(le,m);Ks(a,l,ze,vn(a))}else Ks(a,l,m,vn(a))}catch(Xe){Ks(a,l,{then:function(){},status:"rejected",reason:Xe},vn())}finally{P.p=S,L.T=j}}function Zp(){}function qo(a,l,d,m){if(a.tag!==5)throw Error(n(476));var b=md(a).queue;pd(a,b,l,$,d===null?Zp:function(){return gd(a),d(m)})}function md(a){var l=a.memoizedState;if(l!==null)return l;l={memoizedState:$,baseState:$,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wn,lastRenderedState:$},next:null};var d={};return l.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wn,lastRenderedState:d},next:null},a.memoizedState=l,a=a.alternate,a!==null&&(a.memoizedState=l),l}function gd(a){var l=md(a).next.queue;Ks(a,l,{},vn())}function Vo(){return cn(yr)}function yd(){return Kt().memoizedState}function bd(){return Kt().memoizedState}function Gp(a){for(var l=a.return;l!==null;){switch(l.tag){case 24:case 3:var d=vn();a=mi(d);var m=gi(l,a,d);m!==null&&(dn(m,l,d),er(m,l,d)),l={cache:Co()},a.payload=l;return}l=l.return}}function Wp(a,l,d){var m=vn();d={lane:m,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null},aa(a)?vd(l,d):(d=xo(a,l,d,m),d!==null&&(dn(d,a,m),xd(d,l,m)))}function _d(a,l,d){var m=vn();Ks(a,l,d,m)}function Ks(a,l,d,m){var b={lane:m,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null};if(aa(a))vd(l,b);else{var S=a.alternate;if(a.lanes===0&&(S===null||S.lanes===0)&&(S=l.lastRenderedReducer,S!==null))try{var j=l.lastRenderedState,K=S(j,d);if(b.hasEagerState=!0,b.eagerState=K,gn(K,j))return zr(a,l,b,0),$t===null&&Hr(),!1}catch{}finally{}if(d=xo(a,l,b,m),d!==null)return dn(d,a,m),xd(d,l,m),!0}return!1}function Zo(a,l,d,m){if(m={lane:2,revertLane:Ll(),action:m,hasEagerState:!1,eagerState:null,next:null},aa(a)){if(l)throw Error(n(479))}else l=xo(a,d,m,2),l!==null&&dn(l,a,2)}function aa(a){var l=a.alternate;return a===Tt||l!==null&&l===Tt}function vd(a,l){us=Qr=!0;var d=a.pending;d===null?l.next=l:(l.next=d.next,d.next=l),a.pending=l}function xd(a,l,d){if(d&4194176){var m=l.lanes;m&=a.pendingLanes,d|=m,l.lanes=d,Ue(a,d)}}var Bn={readContext:cn,use:na,useCallback:Xt,useContext:Xt,useEffect:Xt,useImperativeHandle:Xt,useLayoutEffect:Xt,useInsertionEffect:Xt,useMemo:Xt,useReducer:Xt,useRef:Xt,useState:Xt,useDebugValue:Xt,useDeferredValue:Xt,useTransition:Xt,useSyncExternalStore:Xt,useId:Xt};Bn.useCacheRefresh=Xt,Bn.useMemoCache=Xt,Bn.useHostTransitionStatus=Xt,Bn.useFormState=Xt,Bn.useActionState=Xt,Bn.useOptimistic=Xt;var ji={readContext:cn,use:na,useCallback:function(a,l){return fn().memoizedState=[a,l===void 0?null:l],a},useContext:cn,useEffect:ad,useImperativeHandle:function(a,l,d){d=d!=null?d.concat([a]):null,sa(4194308,4,cd.bind(null,l,a),d)},useLayoutEffect:function(a,l){return sa(4194308,4,a,l)},useInsertionEffect:function(a,l){sa(4,2,a,l)},useMemo:function(a,l){var d=fn();l=l===void 0?null:l;var m=a();if(Fi){be(!0);try{a()}finally{be(!1)}}return d.memoizedState=[m,l],m},useReducer:function(a,l,d){var m=fn();if(d!==void 0){var b=d(l);if(Fi){be(!0);try{d(l)}finally{be(!1)}}}else b=l;return m.memoizedState=m.baseState=b,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:b},m.queue=a,a=a.dispatch=Wp.bind(null,Tt,a),[m.memoizedState,a]},useRef:function(a){var l=fn();return a={current:a},l.memoizedState=a},useState:function(a){a=$o(a);var l=a.queue,d=_d.bind(null,Tt,l);return l.dispatch=d,[a.memoizedState,d]},useDebugValue:Ho,useDeferredValue:function(a,l){var d=fn();return zo(d,a,l)},useTransition:function(){var a=$o(!1);return a=pd.bind(null,Tt,a.queue,!0,!1),fn().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,l,d){var m=Tt,b=fn();if(Dt){if(d===void 0)throw Error(n(407));d=d()}else{if(d=l(),$t===null)throw Error(n(349));Mt&60||qu(m,l,d)}b.memoizedState=d;var S={value:d,getSnapshot:l};return b.queue=S,ad(Zu.bind(null,m,S,a),[a]),m.flags|=2048,hs(9,Vu.bind(null,m,S,d,l),{destroy:void 0},null),d},useId:function(){var a=fn(),l=$t.identifierPrefix;if(Dt){var d=Zn,m=Vn;d=(m&~(1<<32-ye(m)-1)).toString(32)+d,l=":"+l+"R"+d,d=ea++,0<d&&(l+="H"+d.toString(32)),l+=":"}else d=Hp++,l=":"+l+"r"+d.toString(32)+":";return a.memoizedState=l},useCacheRefresh:function(){return fn().memoizedState=Gp.bind(null,Tt)}};ji.useMemoCache=No,ji.useHostTransitionStatus=Vo,ji.useFormState=td,ji.useActionState=td,ji.useOptimistic=function(a){var l=fn();l.memoizedState=l.baseState=a;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=d,l=Zo.bind(null,Tt,!0,d),d.dispatch=l,[a,l]};var hi={readContext:cn,use:na,useCallback:dd,useContext:cn,useEffect:Bo,useImperativeHandle:ud,useInsertionEffect:od,useLayoutEffect:ld,useMemo:hd,useReducer:ia,useRef:rd,useState:function(){return ia(Wn)},useDebugValue:Ho,useDeferredValue:function(a,l){var d=Kt();return fd(d,Nt.memoizedState,a,l)},useTransition:function(){var a=ia(Wn)[0],l=Kt().memoizedState;return[typeof a=="boolean"?a:Ys(a),l]},useSyncExternalStore:zu,useId:yd};hi.useCacheRefresh=bd,hi.useMemoCache=No,hi.useHostTransitionStatus=Vo,hi.useFormState=nd,hi.useActionState=nd,hi.useOptimistic=function(a,l){var d=Kt();return Xu(d,Nt,a,l)};var $i={readContext:cn,use:na,useCallback:dd,useContext:cn,useEffect:Bo,useImperativeHandle:ud,useInsertionEffect:od,useLayoutEffect:ld,useMemo:hd,useReducer:jo,useRef:rd,useState:function(){return jo(Wn)},useDebugValue:Ho,useDeferredValue:function(a,l){var d=Kt();return Nt===null?zo(d,a,l):fd(d,Nt.memoizedState,a,l)},useTransition:function(){var a=jo(Wn)[0],l=Kt().memoizedState;return[typeof a=="boolean"?a:Ys(a),l]},useSyncExternalStore:zu,useId:yd};$i.useCacheRefresh=bd,$i.useMemoCache=No,$i.useHostTransitionStatus=Vo,$i.useFormState=sd,$i.useActionState=sd,$i.useOptimistic=function(a,l){var d=Kt();return Nt!==null?Xu(d,Nt,a,l):(d.baseState=a,[a,d.queue.dispatch])};function Go(a,l,d,m){l=a.memoizedState,d=d(m,l),d=d==null?l:H({},l,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var Wo={isMounted:function(a){return(a=a._reactInternals)?ne(a)===a:!1},enqueueSetState:function(a,l,d){a=a._reactInternals;var m=vn(),b=mi(m);b.payload=l,d!=null&&(b.callback=d),l=gi(a,b,m),l!==null&&(dn(l,a,m),er(l,a,m))},enqueueReplaceState:function(a,l,d){a=a._reactInternals;var m=vn(),b=mi(m);b.tag=1,b.payload=l,d!=null&&(b.callback=d),l=gi(a,b,m),l!==null&&(dn(l,a,m),er(l,a,m))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var d=vn(),m=mi(d);m.tag=2,l!=null&&(m.callback=l),l=gi(a,m,d),l!==null&&(dn(l,a,d),er(l,a,d))}};function Ed(a,l,d,m,b,S,j){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,S,j):l.prototype&&l.prototype.isPureReactComponent?!js(d,m)||!js(b,S):!0}function Sd(a,l,d,m){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(d,m),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(d,m),l.state!==a&&Wo.enqueueReplaceState(l,l.state,null)}function Ui(a,l){var d=l;if("ref"in l){d={};for(var m in l)m!=="ref"&&(d[m]=l[m])}if(a=a.defaultProps){d===l&&(d=H({},d));for(var b in a)d[b]===void 0&&(d[b]=a[b])}return d}var oa=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function wd(a){oa(a)}function Ad(a){console.error(a)}function Td(a){oa(a)}function la(a,l){try{var d=a.onUncaughtError;d(l.value,{componentStack:l.stack})}catch(m){setTimeout(function(){throw m})}}function Rd(a,l,d){try{var m=a.onCaughtError;m(d.value,{componentStack:d.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function Xo(a,l,d){return d=mi(d),d.tag=3,d.payload={element:null},d.callback=function(){la(a,l)},d}function Cd(a){return a=mi(a),a.tag=3,a}function Od(a,l,d,m){var b=d.type.getDerivedStateFromError;if(typeof b=="function"){var S=m.value;a.payload=function(){return b(S)},a.callback=function(){Rd(l,d,m)}}var j=d.stateNode;j!==null&&typeof j.componentDidCatch=="function"&&(a.callback=function(){Rd(l,d,m),typeof b!="function"&&(Ei===null?Ei=new Set([this]):Ei.add(this));var K=m.stack;this.componentDidCatch(m.value,{componentStack:K!==null?K:""})})}function Xp(a,l,d,m,b){if(d.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(l=d.alternate,l!==null&&Qs(l,d,b,!0),d=Cn.current,d!==null){switch(d.tag){case 13:return Un===null?Pl():d.alternate===null&&Gt===0&&(Gt=3),d.flags&=-257,d.flags|=65536,d.lanes=b,m===Ao?d.flags|=16384:(l=d.updateQueue,l===null?d.updateQueue=new Set([m]):l.add(m),Ml(a,m,b)),!1;case 22:return d.flags|=65536,m===Ao?d.flags|=16384:(l=d.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([m])},d.updateQueue=l):(d=l.retryQueue,d===null?l.retryQueue=new Set([m]):d.add(m)),Ml(a,m,b)),!1}throw Error(n(435,d.tag))}return Ml(a,m,b),Pl(),!1}if(Dt)return l=Cn.current,l!==null?(!(l.flags&65536)&&(l.flags|=256),l.flags|=65536,l.lanes=b,m!==wo&&(a=Error(n(422),{cause:m}),Hs(An(a,d)))):(m!==wo&&(l=Error(n(423),{cause:m}),Hs(An(l,d))),a=a.current.alternate,a.flags|=65536,b&=-b,a.lanes|=b,m=An(m,d),b=Xo(a.stateNode,m,b),ul(a,b),Gt!==4&&(Gt=2)),!1;var S=Error(n(520),{cause:m});if(S=An(S,d),lr===null?lr=[S]:lr.push(S),Gt!==4&&(Gt=2),l===null)return!0;m=An(m,d),d=l;do{switch(d.tag){case 3:return d.flags|=65536,a=b&-b,d.lanes|=a,a=Xo(d.stateNode,m,a),ul(d,a),!1;case 1:if(l=d.type,S=d.stateNode,(d.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Ei===null||!Ei.has(S))))return d.flags|=65536,b&=-b,d.lanes|=b,b=Cd(b),Od(b,a,d,m),ul(d,b),!1}d=d.return}while(d!==null);return!1}var Pd=Error(n(461)),tn=!1;function on(a,l,d,m){l.child=a===null?Lu(l,null,d,m):Li(l,a.child,d,m)}function kd(a,l,d,m,b){d=d.render;var S=l.ref;if("ref"in m){var j={};for(var K in m)K!=="ref"&&(j[K]=m[K])}else j=m;return Hi(l),m=Mo(a,l,d,j,S,b),K=Io(),a!==null&&!tn?(Do(a,l,b),Xn(a,l,b)):(Dt&&K&&Eo(l),l.flags|=1,on(a,l,m,b),l.child)}function Md(a,l,d,m,b){if(a===null){var S=d.type;return typeof S=="function"&&!bl(S)&&S.defaultProps===void 0&&d.compare===null?(l.tag=15,l.type=S,Id(a,l,S,m,b)):(a=fa(d.type,null,m,l,l.mode,b),a.ref=l.ref,a.return=l,l.child=a)}if(S=a.child,!sl(a,b)){var j=S.memoizedProps;if(d=d.compare,d=d!==null?d:js,d(j,m)&&a.ref===l.ref)return Xn(a,l,b)}return l.flags|=1,a=vi(S,m),a.ref=l.ref,a.return=l,l.child=a}function Id(a,l,d,m,b){if(a!==null){var S=a.memoizedProps;if(js(S,m)&&a.ref===l.ref)if(tn=!1,l.pendingProps=m=S,sl(a,b))a.flags&131072&&(tn=!0);else return l.lanes=a.lanes,Xn(a,l,b)}return Yo(a,l,d,m,b)}function Dd(a,l,d){var m=l.pendingProps,b=m.children,S=(l.stateNode._pendingVisibility&2)!==0,j=a!==null?a.memoizedState:null;if(Js(a,l),m.mode==="hidden"||S){if(l.flags&128){if(m=j!==null?j.baseLanes|d:d,a!==null){for(b=l.child=a.child,S=0;b!==null;)S=S|b.lanes|b.childLanes,b=b.sibling;l.childLanes=S&~m}else l.childLanes=0,l.child=null;return Ld(a,l,m,d)}if(d&536870912)l.memoizedState={baseLanes:0,cachePool:null},a!==null&&Jr(l,j!==null?j.cachePool:null),j!==null?Nu(l,j):To(),Fu(l);else return l.lanes=l.childLanes=536870912,Ld(a,l,j!==null?j.baseLanes|d:d,d)}else j!==null?(Jr(l,j.cachePool),Nu(l,j),ui(),l.memoizedState=null):(a!==null&&Jr(l,null),To(),ui());return on(a,l,b,d),l.child}function Ld(a,l,d,m){var b=Po();return b=b===null?null:{parent:en._currentValue,pool:b},l.memoizedState={baseLanes:d,cachePool:b},a!==null&&Jr(l,null),To(),Fu(l),a!==null&&Qs(a,l,m,!0),null}function Js(a,l){var d=l.ref;if(d===null)a!==null&&a.ref!==null&&(l.flags|=2097664);else{if(typeof d!="function"&&typeof d!="object")throw Error(n(284));(a===null||a.ref!==d)&&(l.flags|=2097664)}}function Yo(a,l,d,m,b){return Hi(l),d=Mo(a,l,d,m,void 0,b),m=Io(),a!==null&&!tn?(Do(a,l,b),Xn(a,l,b)):(Dt&&m&&Eo(l),l.flags|=1,on(a,l,d,b),l.child)}function Nd(a,l,d,m,b,S){return Hi(l),l.updateQueue=null,d=Hu(l,m,d,b),Bu(a),m=Io(),a!==null&&!tn?(Do(a,l,S),Xn(a,l,S)):(Dt&&m&&Eo(l),l.flags|=1,on(a,l,d,S),l.child)}function Fd(a,l,d,m,b){if(Hi(l),l.stateNode===null){var S=is,j=d.contextType;typeof j=="object"&&j!==null&&(S=cn(j)),S=new d(m,S),l.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=Wo,l.stateNode=S,S._reactInternals=l,S=l.stateNode,S.props=m,S.state=l.memoizedState,S.refs={},ll(l),j=d.contextType,S.context=typeof j=="object"&&j!==null?cn(j):is,S.state=l.memoizedState,j=d.getDerivedStateFromProps,typeof j=="function"&&(Go(l,d,j,m),S.state=l.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(j=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),j!==S.state&&Wo.enqueueReplaceState(S,S.state,null),nr(l,m,S,b),tr(),S.state=l.memoizedState),typeof S.componentDidMount=="function"&&(l.flags|=4194308),m=!0}else if(a===null){S=l.stateNode;var K=l.memoizedProps,le=Ui(d,K);S.props=le;var Ee=S.context,ze=d.contextType;j=is,typeof ze=="object"&&ze!==null&&(j=cn(ze));var Xe=d.getDerivedStateFromProps;ze=typeof Xe=="function"||typeof S.getSnapshotBeforeUpdate=="function",K=l.pendingProps!==K,ze||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(K||Ee!==j)&&Sd(l,S,m,j),pi=!1;var De=l.memoizedState;S.state=De,nr(l,m,S,b),tr(),Ee=l.memoizedState,K||De!==Ee||pi?(typeof Xe=="function"&&(Go(l,d,Xe,m),Ee=l.memoizedState),(le=pi||Ed(l,d,le,m,De,Ee,j))?(ze||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(l.flags|=4194308)):(typeof S.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=m,l.memoizedState=Ee),S.props=m,S.state=Ee,S.context=j,m=le):(typeof S.componentDidMount=="function"&&(l.flags|=4194308),m=!1)}else{S=l.stateNode,cl(a,l),j=l.memoizedProps,ze=Ui(d,j),S.props=ze,Xe=l.pendingProps,De=S.context,Ee=d.contextType,le=is,typeof Ee=="object"&&Ee!==null&&(le=cn(Ee)),K=d.getDerivedStateFromProps,(Ee=typeof K=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(j!==Xe||De!==le)&&Sd(l,S,m,le),pi=!1,De=l.memoizedState,S.state=De,nr(l,m,S,b),tr();var He=l.memoizedState;j!==Xe||De!==He||pi||a!==null&&a.dependencies!==null&&ca(a.dependencies)?(typeof K=="function"&&(Go(l,d,K,m),He=l.memoizedState),(ze=pi||Ed(l,d,ze,m,De,He,le)||a!==null&&a.dependencies!==null&&ca(a.dependencies))?(Ee||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(m,He,le),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(m,He,le)),typeof S.componentDidUpdate=="function"&&(l.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof S.componentDidUpdate!="function"||j===a.memoizedProps&&De===a.memoizedState||(l.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||j===a.memoizedProps&&De===a.memoizedState||(l.flags|=1024),l.memoizedProps=m,l.memoizedState=He),S.props=m,S.state=He,S.context=le,m=ze):(typeof S.componentDidUpdate!="function"||j===a.memoizedProps&&De===a.memoizedState||(l.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||j===a.memoizedProps&&De===a.memoizedState||(l.flags|=1024),m=!1)}return S=m,Js(a,l),m=(l.flags&128)!==0,S||m?(S=l.stateNode,d=m&&typeof d.getDerivedStateFromError!="function"?null:S.render(),l.flags|=1,a!==null&&m?(l.child=Li(l,a.child,null,b),l.child=Li(l,null,d,b)):on(a,l,d,b),l.memoizedState=S.state,a=l.child):a=Xn(a,l,b),a}function jd(a,l,d,m){return Bs(),l.flags|=256,on(a,l,d,m),l.child}var Ko={dehydrated:null,treeContext:null,retryLane:0};function Jo(a){return{baseLanes:a,cachePool:Uu()}}function Qo(a,l,d){return a=a!==null?a.childLanes&~d:0,l&&(a|=Mn),a}function $d(a,l,d){var m=l.pendingProps,b=!1,S=(l.flags&128)!==0,j;if((j=S)||(j=a!==null&&a.memoizedState===null?!1:(Qt.current&2)!==0),j&&(b=!0,l.flags&=-129),j=(l.flags&32)!==0,l.flags&=-33,a===null){if(Dt){if(b?ci(l):ui(),Dt){var K=an,le;if(le=K){e:{for(le=K,K=$n;le.nodeType!==8;){if(!K){K=null;break e}if(le=jn(le.nextSibling),le===null){K=null;break e}}K=le}K!==null?(l.memoizedState={dehydrated:K,treeContext:Mi!==null?{id:Vn,overflow:Zn}:null,retryLane:536870912},le=kn(18,null,null,0),le.stateNode=K,le.return=l,l.child=le,un=l,an=null,le=!0):le=!1}le||Di(l)}if(K=l.memoizedState,K!==null&&(K=K.dehydrated,K!==null))return K.data==="$!"?l.lanes=16:l.lanes=536870912,null;Gn(l)}return K=m.children,m=m.fallback,b?(ui(),b=l.mode,K=tl({mode:"hidden",children:K},b),m=qi(m,b,d,null),K.return=l,m.return=l,K.sibling=m,l.child=K,b=l.child,b.memoizedState=Jo(d),b.childLanes=Qo(a,j,d),l.memoizedState=Ko,m):(ci(l),el(l,K))}if(le=a.memoizedState,le!==null&&(K=le.dehydrated,K!==null)){if(S)l.flags&256?(ci(l),l.flags&=-257,l=nl(a,l,d)):l.memoizedState!==null?(ui(),l.child=a.child,l.flags|=128,l=null):(ui(),b=m.fallback,K=l.mode,m=tl({mode:"visible",children:m.children},K),b=qi(b,K,d,null),b.flags|=2,m.return=l,b.return=l,m.sibling=b,l.child=m,Li(l,a.child,null,d),m=l.child,m.memoizedState=Jo(d),m.childLanes=Qo(a,j,d),l.memoizedState=Ko,l=b);else if(ci(l),K.data==="$!"){if(j=K.nextSibling&&K.nextSibling.dataset,j)var Ee=j.dgst;j=Ee,m=Error(n(419)),m.stack="",m.digest=j,Hs({value:m,source:null,stack:null}),l=nl(a,l,d)}else if(tn||Qs(a,l,d,!1),j=(d&a.childLanes)!==0,tn||j){if(j=$t,j!==null){if(m=d&-d,m&42)m=1;else switch(m){case 2:m=1;break;case 8:m=4;break;case 32:m=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:m=64;break;case 268435456:m=134217728;break;default:m=0}if(m=m&(j.suspendedLanes|d)?0:m,m!==0&&m!==le.retryLane)throw le.retryLane=m,li(a,m),dn(j,a,m),Pd}K.data==="$?"||Pl(),l=nl(a,l,d)}else K.data==="$?"?(l.flags|=128,l.child=a.child,l=um.bind(null,a),K._reactRetry=l,l=null):(a=le.treeContext,an=jn(K.nextSibling),un=l,Dt=!0,Nn=null,$n=!1,a!==null&&(Tn[Rn++]=Vn,Tn[Rn++]=Zn,Tn[Rn++]=Mi,Vn=a.id,Zn=a.overflow,Mi=l),l=el(l,m.children),l.flags|=4096);return l}return b?(ui(),b=m.fallback,K=l.mode,le=a.child,Ee=le.sibling,m=vi(le,{mode:"hidden",children:m.children}),m.subtreeFlags=le.subtreeFlags&31457280,Ee!==null?b=vi(Ee,b):(b=qi(b,K,d,null),b.flags|=2),b.return=l,m.return=l,m.sibling=b,l.child=m,m=b,b=l.child,K=a.child.memoizedState,K===null?K=Jo(d):(le=K.cachePool,le!==null?(Ee=en._currentValue,le=le.parent!==Ee?{parent:Ee,pool:Ee}:le):le=Uu(),K={baseLanes:K.baseLanes|d,cachePool:le}),b.memoizedState=K,b.childLanes=Qo(a,j,d),l.memoizedState=Ko,m):(ci(l),d=a.child,a=d.sibling,d=vi(d,{mode:"visible",children:m.children}),d.return=l,d.sibling=null,a!==null&&(j=l.deletions,j===null?(l.deletions=[a],l.flags|=16):j.push(a)),l.child=d,l.memoizedState=null,d)}function el(a,l){return l=tl({mode:"visible",children:l},a.mode),l.return=a,a.child=l}function tl(a,l){return dh(a,l,0,null)}function nl(a,l,d){return Li(l,a.child,null,d),a=el(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function Ud(a,l,d){a.lanes|=l;var m=a.alternate;m!==null&&(m.lanes|=l),al(a.return,l,d)}function il(a,l,d,m,b){var S=a.memoizedState;S===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:m,tail:d,tailMode:b}:(S.isBackwards=l,S.rendering=null,S.renderingStartTime=0,S.last=m,S.tail=d,S.tailMode=b)}function Bd(a,l,d){var m=l.pendingProps,b=m.revealOrder,S=m.tail;if(on(a,l,m.children,d),m=Qt.current,m&2)m=m&1|2,l.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Ud(a,d,l);else if(a.tag===19)Ud(a,d,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}m&=1}switch(he(Qt,m),b){case"forwards":for(d=l.child,b=null;d!==null;)a=d.alternate,a!==null&&Kr(a)===null&&(b=d),d=d.sibling;d=b,d===null?(b=l.child,l.child=null):(b=d.sibling,d.sibling=null),il(l,!1,b,d,S);break;case"backwards":for(d=null,b=l.child,l.child=null;b!==null;){if(a=b.alternate,a!==null&&Kr(a)===null){l.child=b;break}a=b.sibling,b.sibling=d,d=b,b=a}il(l,!0,d,null,S);break;case"together":il(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Xn(a,l,d){if(a!==null&&(l.dependencies=a.dependencies),xi|=l.lanes,!(d&l.childLanes))if(a!==null){if(Qs(a,l,d,!1),(d&l.childLanes)===0)return null}else return null;if(a!==null&&l.child!==a.child)throw Error(n(153));if(l.child!==null){for(a=l.child,d=vi(a,a.pendingProps),l.child=d,d.return=l;a.sibling!==null;)a=a.sibling,d=d.sibling=vi(a,a.pendingProps),d.return=l;d.sibling=null}return l.child}function sl(a,l){return a.lanes&l?!0:(a=a.dependencies,!!(a!==null&&ca(a)))}function Yp(a,l,d){switch(l.tag){case 3:$e(l,l.stateNode.containerInfo),fi(l,en,a.memoizedState.cache),Bs();break;case 27:case 5:_e(l);break;case 4:$e(l,l.stateNode.containerInfo);break;case 10:fi(l,l.type,l.memoizedProps.value);break;case 13:var m=l.memoizedState;if(m!==null)return m.dehydrated!==null?(ci(l),l.flags|=128,null):d&l.child.childLanes?$d(a,l,d):(ci(l),a=Xn(a,l,d),a!==null?a.sibling:null);ci(l);break;case 19:var b=(a.flags&128)!==0;if(m=(d&l.childLanes)!==0,m||(Qs(a,l,d,!1),m=(d&l.childLanes)!==0),b){if(m)return Bd(a,l,d);l.flags|=128}if(b=l.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),he(Qt,Qt.current),m)break;return null;case 22:case 23:return l.lanes=0,Dd(a,l,d);case 24:fi(l,en,a.memoizedState.cache)}return Xn(a,l,d)}function Hd(a,l,d){if(a!==null)if(a.memoizedProps!==l.pendingProps)tn=!0;else{if(!sl(a,d)&&!(l.flags&128))return tn=!1,Yp(a,l,d);tn=!!(a.flags&131072)}else tn=!1,Dt&&l.flags&1048576&&Tu(l,Zr,l.index);switch(l.lanes=0,l.tag){case 16:e:{a=l.pendingProps;var m=l.elementType,b=m._init;if(m=b(m._payload),l.type=m,typeof m=="function")bl(m)?(a=Ui(m,a),l.tag=1,l=Fd(null,l,m,a,d)):(l.tag=0,l=Yo(null,l,m,a,d));else{if(m!=null){if(b=m.$$typeof,b===_){l.tag=11,l=kd(null,l,m,a,d);break e}else if(b===w){l.tag=14,l=Md(null,l,m,a,d);break e}}throw l=M(m)||m,Error(n(306,l,""))}}return l;case 0:return Yo(a,l,l.type,l.pendingProps,d);case 1:return m=l.type,b=Ui(m,l.pendingProps),Fd(a,l,m,b,d);case 3:e:{if($e(l,l.stateNode.containerInfo),a===null)throw Error(n(387));var S=l.pendingProps;b=l.memoizedState,m=b.element,cl(a,l),nr(l,S,null,d);var j=l.memoizedState;if(S=j.cache,fi(l,en,S),S!==b.cache&&ol(l,[en],d,!0),tr(),S=j.element,b.isDehydrated)if(b={element:S,isDehydrated:!1,cache:j.cache},l.updateQueue.baseState=b,l.memoizedState=b,l.flags&256){l=jd(a,l,S,d);break e}else if(S!==m){m=An(Error(n(424)),l),Hs(m),l=jd(a,l,S,d);break e}else for(an=jn(l.stateNode.containerInfo.firstChild),un=l,Dt=!0,Nn=null,$n=!0,d=Lu(l,null,S,d),l.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Bs(),S===m){l=Xn(a,l,d);break e}on(a,l,S,d)}l=l.child}return l;case 26:return Js(a,l),a===null?(d=Vh(l.type,null,l.pendingProps,null))?l.memoizedState=d:Dt||(d=l.type,a=l.pendingProps,m=Ta(Ie.current).createElement(d),m[Qe]=l,m[Ke]=a,ln(m,d,a),Pt(m),l.stateNode=m):l.memoizedState=Vh(l.type,a.memoizedProps,l.pendingProps,a.memoizedState),null;case 27:return _e(l),a===null&&Dt&&(m=l.stateNode=Hh(l.type,l.pendingProps,Ie.current),un=l,$n=!0,an=jn(m.firstChild)),m=l.pendingProps.children,a!==null||Dt?on(a,l,m,d):l.child=Li(l,null,m,d),Js(a,l),l.child;case 5:return a===null&&Dt&&((b=m=an)&&(m=Tm(m,l.type,l.pendingProps,$n),m!==null?(l.stateNode=m,un=l,an=jn(m.firstChild),$n=!1,b=!0):b=!1),b||Di(l)),_e(l),b=l.type,S=l.pendingProps,j=a!==null?a.memoizedProps:null,m=S.children,ql(b,S)?m=null:j!==null&&ql(b,j)&&(l.flags|=32),l.memoizedState!==null&&(b=Mo(a,l,zp,null,null,d),yr._currentValue=b),Js(a,l),on(a,l,m,d),l.child;case 6:return a===null&&Dt&&((a=d=an)&&(d=Rm(d,l.pendingProps,$n),d!==null?(l.stateNode=d,un=l,an=null,a=!0):a=!1),a||Di(l)),null;case 13:return $d(a,l,d);case 4:return $e(l,l.stateNode.containerInfo),m=l.pendingProps,a===null?l.child=Li(l,null,m,d):on(a,l,m,d),l.child;case 11:return kd(a,l,l.type,l.pendingProps,d);case 7:return on(a,l,l.pendingProps,d),l.child;case 8:return on(a,l,l.pendingProps.children,d),l.child;case 12:return on(a,l,l.pendingProps.children,d),l.child;case 10:return m=l.pendingProps,fi(l,l.type,m.value),on(a,l,m.children,d),l.child;case 9:return b=l.type._context,m=l.pendingProps.children,Hi(l),b=cn(b),m=m(b),l.flags|=1,on(a,l,m,d),l.child;case 14:return Md(a,l,l.type,l.pendingProps,d);case 15:return Id(a,l,l.type,l.pendingProps,d);case 19:return Bd(a,l,d);case 22:return Dd(a,l,d);case 24:return Hi(l),m=cn(en),a===null?(b=Po(),b===null&&(b=$t,S=Co(),b.pooledCache=S,S.refCount++,S!==null&&(b.pooledCacheLanes|=d),b=S),l.memoizedState={parent:m,cache:b},ll(l),fi(l,en,b)):(a.lanes&d&&(cl(a,l),nr(l,null,null,d),tr()),b=a.memoizedState,S=l.memoizedState,b.parent!==m?(b={parent:m,cache:m},l.memoizedState=b,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=b),fi(l,en,m)):(m=S.cache,fi(l,en,m),m!==b.cache&&ol(l,[en],d,!0))),on(a,l,l.pendingProps.children,d),l.child;case 29:throw l.pendingProps}throw Error(n(156,l.tag))}var rl=ee(null),Bi=null,Yn=null;function fi(a,l,d){he(rl,l._currentValue),l._currentValue=d}function Kn(a){a._currentValue=rl.current,ce(rl)}function al(a,l,d){for(;a!==null;){var m=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,m!==null&&(m.childLanes|=l)):m!==null&&(m.childLanes&l)!==l&&(m.childLanes|=l),a===d)break;a=a.return}}function ol(a,l,d,m){var b=a.child;for(b!==null&&(b.return=a);b!==null;){var S=b.dependencies;if(S!==null){var j=b.child;S=S.firstContext;e:for(;S!==null;){var K=S;S=b;for(var le=0;le<l.length;le++)if(K.context===l[le]){S.lanes|=d,K=S.alternate,K!==null&&(K.lanes|=d),al(S.return,d,a),m||(j=null);break e}S=K.next}}else if(b.tag===18){if(j=b.return,j===null)throw Error(n(341));j.lanes|=d,S=j.alternate,S!==null&&(S.lanes|=d),al(j,d,a),j=null}else j=b.child;if(j!==null)j.return=b;else for(j=b;j!==null;){if(j===a){j=null;break}if(b=j.sibling,b!==null){b.return=j.return,j=b;break}j=j.return}b=j}}function Qs(a,l,d,m){a=null;for(var b=l,S=!1;b!==null;){if(!S){if(b.flags&524288)S=!0;else if(b.flags&262144)break}if(b.tag===10){var j=b.alternate;if(j===null)throw Error(n(387));if(j=j.memoizedProps,j!==null){var K=b.type;gn(b.pendingProps.value,j.value)||(a!==null?a.push(K):a=[K])}}else if(b===Ne.current){if(j=b.alternate,j===null)throw Error(n(387));j.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(a!==null?a.push(yr):a=[yr])}b=b.return}a!==null&&ol(l,a,d,m),l.flags|=262144}function ca(a){for(a=a.firstContext;a!==null;){if(!gn(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Hi(a){Bi=a,Yn=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function cn(a){return zd(Bi,a)}function ua(a,l){return Bi===null&&Hi(a),zd(a,l)}function zd(a,l){var d=l._currentValue;if(l={context:l,memoizedValue:d,next:null},Yn===null){if(a===null)throw Error(n(308));Yn=l,a.dependencies={lanes:0,firstContext:l},a.flags|=524288}else Yn=Yn.next=l;return d}var pi=!1;function ll(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function cl(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function mi(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function gi(a,l,d){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,qt&2){var b=m.pending;return b===null?l.next=l:(l.next=b.next,b.next=l),m.pending=l,l=qr(a),wu(a,null,d),l}return zr(a,m,l,d),qr(a)}function er(a,l,d){if(l=l.updateQueue,l!==null&&(l=l.shared,(d&4194176)!==0)){var m=l.lanes;m&=a.pendingLanes,d|=m,l.lanes=d,Ue(a,d)}}function ul(a,l){var d=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,d===m)){var b=null,S=null;if(d=d.firstBaseUpdate,d!==null){do{var j={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};S===null?b=S=j:S=S.next=j,d=d.next}while(d!==null);S===null?b=S=l:S=S.next=l}else b=S=l;d={baseState:m.baseState,firstBaseUpdate:b,lastBaseUpdate:S,shared:m.shared,callbacks:m.callbacks},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=l:a.next=l,d.lastBaseUpdate=l}var dl=!1;function tr(){if(dl){var a=cs;if(a!==null)throw a}}function nr(a,l,d,m){dl=!1;var b=a.updateQueue;pi=!1;var S=b.firstBaseUpdate,j=b.lastBaseUpdate,K=b.shared.pending;if(K!==null){b.shared.pending=null;var le=K,Ee=le.next;le.next=null,j===null?S=Ee:j.next=Ee,j=le;var ze=a.alternate;ze!==null&&(ze=ze.updateQueue,K=ze.lastBaseUpdate,K!==j&&(K===null?ze.firstBaseUpdate=Ee:K.next=Ee,ze.lastBaseUpdate=le))}if(S!==null){var Xe=b.baseState;j=0,ze=Ee=le=null,K=S;do{var De=K.lane&-536870913,He=De!==K.lane;if(He?(Mt&De)===De:(m&De)===De){De!==0&&De===ls&&(dl=!0),ze!==null&&(ze=ze.next={lane:0,tag:K.tag,payload:K.payload,callback:null,next:null});e:{var gt=a,wt=K;De=l;var Wt=d;switch(wt.tag){case 1:if(gt=wt.payload,typeof gt=="function"){Xe=gt.call(Wt,Xe,De);break e}Xe=gt;break e;case 3:gt.flags=gt.flags&-65537|128;case 0:if(gt=wt.payload,De=typeof gt=="function"?gt.call(Wt,Xe,De):gt,De==null)break e;Xe=H({},Xe,De);break e;case 2:pi=!0}}De=K.callback,De!==null&&(a.flags|=64,He&&(a.flags|=8192),He=b.callbacks,He===null?b.callbacks=[De]:He.push(De))}else He={lane:De,tag:K.tag,payload:K.payload,callback:K.callback,next:null},ze===null?(Ee=ze=He,le=Xe):ze=ze.next=He,j|=De;if(K=K.next,K===null){if(K=b.shared.pending,K===null)break;He=K,K=He.next,He.next=null,b.lastBaseUpdate=He,b.shared.pending=null}}while(!0);ze===null&&(le=Xe),b.baseState=le,b.firstBaseUpdate=Ee,b.lastBaseUpdate=ze,S===null&&(b.shared.lanes=0),xi|=j,a.lanes=j,a.memoizedState=Xe}}function qd(a,l){if(typeof a!="function")throw Error(n(191,a));a.call(l)}function Vd(a,l){var d=a.callbacks;if(d!==null)for(a.callbacks=null,a=0;a<d.length;a++)qd(d[a],l)}function ir(a,l){try{var d=l.updateQueue,m=d!==null?d.lastEffect:null;if(m!==null){var b=m.next;d=b;do{if((d.tag&a)===a){m=void 0;var S=d.create,j=d.inst;m=S(),j.destroy=m}d=d.next}while(d!==b)}}catch(K){jt(l,l.return,K)}}function yi(a,l,d){try{var m=l.updateQueue,b=m!==null?m.lastEffect:null;if(b!==null){var S=b.next;m=S;do{if((m.tag&a)===a){var j=m.inst,K=j.destroy;if(K!==void 0){j.destroy=void 0,b=l;var le=d;try{K()}catch(Ee){jt(b,le,Ee)}}}m=m.next}while(m!==S)}}catch(Ee){jt(l,l.return,Ee)}}function Zd(a){var l=a.updateQueue;if(l!==null){var d=a.stateNode;try{Vd(l,d)}catch(m){jt(a,a.return,m)}}}function Gd(a,l,d){d.props=Ui(a.type,a.memoizedProps),d.state=a.memoizedState;try{d.componentWillUnmount()}catch(m){jt(a,l,m)}}function zi(a,l){try{var d=a.ref;if(d!==null){var m=a.stateNode;switch(a.tag){case 26:case 27:case 5:var b=m;break;default:b=m}typeof d=="function"?a.refCleanup=d(b):d.current=b}}catch(S){jt(a,l,S)}}function yn(a,l){var d=a.ref,m=a.refCleanup;if(d!==null)if(typeof m=="function")try{m()}catch(b){jt(a,l,b)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(b){jt(a,l,b)}else d.current=null}function Wd(a){var l=a.type,d=a.memoizedProps,m=a.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":d.autoFocus&&m.focus();break e;case"img":d.src?m.src=d.src:d.srcSet&&(m.srcset=d.srcSet)}}catch(b){jt(a,a.return,b)}}function Xd(a,l,d){try{var m=a.stateNode;xm(m,a.type,d,l),m[Ke]=l}catch(b){jt(a,a.return,b)}}function Yd(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27||a.tag===4}function hl(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||Yd(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==27&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function fl(a,l,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,l?d.nodeType===8?d.parentNode.insertBefore(a,l):d.insertBefore(a,l):(d.nodeType===8?(l=d.parentNode,l.insertBefore(a,d)):(l=d,l.appendChild(a)),d=d._reactRootContainer,d!=null||l.onclick!==null||(l.onclick=Aa));else if(m!==4&&m!==27&&(a=a.child,a!==null))for(fl(a,l,d),a=a.sibling;a!==null;)fl(a,l,d),a=a.sibling}function da(a,l,d){var m=a.tag;if(m===5||m===6)a=a.stateNode,l?d.insertBefore(a,l):d.appendChild(a);else if(m!==4&&m!==27&&(a=a.child,a!==null))for(da(a,l,d),a=a.sibling;a!==null;)da(a,l,d),a=a.sibling}var Jn=!1,Zt=!1,pl=!1,Kd=typeof WeakSet=="function"?WeakSet:Set,nn=null,Jd=!1;function Kp(a,l){if(a=a.containerInfo,Hl=Ma,a=mu(a),go(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var m=d.getSelection&&d.getSelection();if(m&&m.rangeCount!==0){d=m.anchorNode;var b=m.anchorOffset,S=m.focusNode;m=m.focusOffset;try{d.nodeType,S.nodeType}catch{d=null;break e}var j=0,K=-1,le=-1,Ee=0,ze=0,Xe=a,De=null;t:for(;;){for(var He;Xe!==d||b!==0&&Xe.nodeType!==3||(K=j+b),Xe!==S||m!==0&&Xe.nodeType!==3||(le=j+m),Xe.nodeType===3&&(j+=Xe.nodeValue.length),(He=Xe.firstChild)!==null;)De=Xe,Xe=He;for(;;){if(Xe===a)break t;if(De===d&&++Ee===b&&(K=j),De===S&&++ze===m&&(le=j),(He=Xe.nextSibling)!==null)break;Xe=De,De=Xe.parentNode}Xe=He}d=K===-1||le===-1?null:{start:K,end:le}}else d=null}d=d||{start:0,end:0}}else d=null;for(zl={focusedElem:a,selectionRange:d},Ma=!1,nn=l;nn!==null;)if(l=nn,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,nn=a;else for(;nn!==null;){switch(l=nn,S=l.alternate,a=l.flags,l.tag){case 0:break;case 11:case 15:break;case 1:if(a&1024&&S!==null){a=void 0,d=l,b=S.memoizedProps,S=S.memoizedState,m=d.stateNode;try{var gt=Ui(d.type,b,d.elementType===d.type);a=m.getSnapshotBeforeUpdate(gt,S),m.__reactInternalSnapshotBeforeUpdate=a}catch(wt){jt(d,d.return,wt)}}break;case 3:if(a&1024){if(a=l.stateNode.containerInfo,d=a.nodeType,d===9)Gl(a);else if(d===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Gl(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(a&1024)throw Error(n(163))}if(a=l.sibling,a!==null){a.return=l.return,nn=a;break}nn=l.return}return gt=Jd,Jd=!1,gt}function Qd(a,l,d){var m=d.flags;switch(d.tag){case 0:case 11:case 15:ei(a,d),m&4&&ir(5,d);break;case 1:if(ei(a,d),m&4)if(a=d.stateNode,l===null)try{a.componentDidMount()}catch(K){jt(d,d.return,K)}else{var b=Ui(d.type,l.memoizedProps);l=l.memoizedState;try{a.componentDidUpdate(b,l,a.__reactInternalSnapshotBeforeUpdate)}catch(K){jt(d,d.return,K)}}m&64&&Zd(d),m&512&&zi(d,d.return);break;case 3:if(ei(a,d),m&64&&(m=d.updateQueue,m!==null)){if(a=null,d.child!==null)switch(d.child.tag){case 27:case 5:a=d.child.stateNode;break;case 1:a=d.child.stateNode}try{Vd(m,a)}catch(K){jt(d,d.return,K)}}break;case 26:ei(a,d),m&512&&zi(d,d.return);break;case 27:case 5:ei(a,d),l===null&&m&4&&Wd(d),m&512&&zi(d,d.return);break;case 12:ei(a,d);break;case 13:ei(a,d),m&4&&nh(a,d);break;case 22:if(b=d.memoizedState!==null||Jn,!b){l=l!==null&&l.memoizedState!==null||Zt;var S=Jn,j=Zt;Jn=b,(Zt=l)&&!j?bi(a,d,(d.subtreeFlags&8772)!==0):ei(a,d),Jn=S,Zt=j}m&512&&(d.memoizedProps.mode==="manual"?zi(d,d.return):yn(d,d.return));break;default:ei(a,d)}}function eh(a){var l=a.alternate;l!==null&&(a.alternate=null,eh(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&me(l)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Jt=null,bn=!1;function Qn(a,l,d){for(d=d.child;d!==null;)th(a,l,d),d=d.sibling}function th(a,l,d){if(mt&&typeof mt.onCommitFiberUnmount=="function")try{mt.onCommitFiberUnmount(yt,d)}catch{}switch(d.tag){case 26:Zt||yn(d,l),Qn(a,l,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:Zt||yn(d,l);var m=Jt,b=bn;for(Jt=d.stateNode,Qn(a,l,d),d=d.stateNode,l=d.attributes;l.length;)d.removeAttributeNode(l[0]);me(d),Jt=m,bn=b;break;case 5:Zt||yn(d,l);case 6:b=Jt;var S=bn;if(Jt=null,Qn(a,l,d),Jt=b,bn=S,Jt!==null)if(bn)try{a=Jt,m=d.stateNode,a.nodeType===8?a.parentNode.removeChild(m):a.removeChild(m)}catch(j){jt(d,l,j)}else try{Jt.removeChild(d.stateNode)}catch(j){jt(d,l,j)}break;case 18:Jt!==null&&(bn?(l=Jt,d=d.stateNode,l.nodeType===8?Zl(l.parentNode,d):l.nodeType===1&&Zl(l,d),xr(l)):Zl(Jt,d.stateNode));break;case 4:m=Jt,b=bn,Jt=d.stateNode.containerInfo,bn=!0,Qn(a,l,d),Jt=m,bn=b;break;case 0:case 11:case 14:case 15:Zt||yi(2,d,l),Zt||yi(4,d,l),Qn(a,l,d);break;case 1:Zt||(yn(d,l),m=d.stateNode,typeof m.componentWillUnmount=="function"&&Gd(d,l,m)),Qn(a,l,d);break;case 21:Qn(a,l,d);break;case 22:Zt||yn(d,l),Zt=(m=Zt)||d.memoizedState!==null,Qn(a,l,d),Zt=m;break;default:Qn(a,l,d)}}function nh(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{xr(a)}catch(d){jt(l,l.return,d)}}function Jp(a){switch(a.tag){case 13:case 19:var l=a.stateNode;return l===null&&(l=a.stateNode=new Kd),l;case 22:return a=a.stateNode,l=a._retryCache,l===null&&(l=a._retryCache=new Kd),l;default:throw Error(n(435,a.tag))}}function ml(a,l){var d=Jp(a);l.forEach(function(m){var b=dm.bind(null,a,m);d.has(m)||(d.add(m),m.then(b,b))})}function On(a,l){var d=l.deletions;if(d!==null)for(var m=0;m<d.length;m++){var b=d[m],S=a,j=l,K=j;e:for(;K!==null;){switch(K.tag){case 27:case 5:Jt=K.stateNode,bn=!1;break e;case 3:Jt=K.stateNode.containerInfo,bn=!0;break e;case 4:Jt=K.stateNode.containerInfo,bn=!0;break e}K=K.return}if(Jt===null)throw Error(n(160));th(S,j,b),Jt=null,bn=!1,S=b.alternate,S!==null&&(S.return=null),b.return=null}if(l.subtreeFlags&13878)for(l=l.child;l!==null;)ih(l,a),l=l.sibling}var Fn=null;function ih(a,l){var d=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:On(l,a),Pn(a),m&4&&(yi(3,a,a.return),ir(3,a),yi(5,a,a.return));break;case 1:On(l,a),Pn(a),m&512&&(Zt||d===null||yn(d,d.return)),m&64&&Jn&&(a=a.updateQueue,a!==null&&(m=a.callbacks,m!==null&&(d=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=d===null?m:d.concat(m))));break;case 26:var b=Fn;if(On(l,a),Pn(a),m&512&&(Zt||d===null||yn(d,d.return)),m&4){var S=d!==null?d.memoizedState:null;if(m=a.memoizedState,d===null)if(m===null)if(a.stateNode===null){e:{m=a.type,d=a.memoizedProps,b=b.ownerDocument||b;t:switch(m){case"title":S=b.getElementsByTagName("title")[0],(!S||S[nt]||S[Qe]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=b.createElement(m),b.head.insertBefore(S,b.querySelector("head > title"))),ln(S,m,d),S[Qe]=a,Pt(S),m=S;break e;case"link":var j=Wh("link","href",b).get(m+(d.href||""));if(j){for(var K=0;K<j.length;K++)if(S=j[K],S.getAttribute("href")===(d.href==null?null:d.href)&&S.getAttribute("rel")===(d.rel==null?null:d.rel)&&S.getAttribute("title")===(d.title==null?null:d.title)&&S.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){j.splice(K,1);break t}}S=b.createElement(m),ln(S,m,d),b.head.appendChild(S);break;case"meta":if(j=Wh("meta","content",b).get(m+(d.content||""))){for(K=0;K<j.length;K++)if(S=j[K],S.getAttribute("content")===(d.content==null?null:""+d.content)&&S.getAttribute("name")===(d.name==null?null:d.name)&&S.getAttribute("property")===(d.property==null?null:d.property)&&S.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&S.getAttribute("charset")===(d.charSet==null?null:d.charSet)){j.splice(K,1);break t}}S=b.createElement(m),ln(S,m,d),b.head.appendChild(S);break;default:throw Error(n(468,m))}S[Qe]=a,Pt(S),m=S}a.stateNode=m}else Xh(b,a.type,a.stateNode);else a.stateNode=Gh(b,m,a.memoizedProps);else S!==m?(S===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):S.count--,m===null?Xh(b,a.type,a.stateNode):Gh(b,m,a.memoizedProps)):m===null&&a.stateNode!==null&&Xd(a,a.memoizedProps,d.memoizedProps)}break;case 27:if(m&4&&a.alternate===null){b=a.stateNode,S=a.memoizedProps;try{for(var le=b.firstChild;le;){var Ee=le.nextSibling,ze=le.nodeName;le[nt]||ze==="HEAD"||ze==="BODY"||ze==="SCRIPT"||ze==="STYLE"||ze==="LINK"&&le.rel.toLowerCase()==="stylesheet"||b.removeChild(le),le=Ee}for(var Xe=a.type,De=b.attributes;De.length;)b.removeAttributeNode(De[0]);ln(b,Xe,S),b[Qe]=a,b[Ke]=S}catch(gt){jt(a,a.return,gt)}}case 5:if(On(l,a),Pn(a),m&512&&(Zt||d===null||yn(d,d.return)),a.flags&32){b=a.stateNode;try{Yi(b,"")}catch(gt){jt(a,a.return,gt)}}m&4&&a.stateNode!=null&&(b=a.memoizedProps,Xd(a,b,d!==null?d.memoizedProps:b)),m&1024&&(pl=!0);break;case 6:if(On(l,a),Pn(a),m&4){if(a.stateNode===null)throw Error(n(162));m=a.memoizedProps,d=a.stateNode;try{d.nodeValue=m}catch(gt){jt(a,a.return,gt)}}break;case 3:if(Oa=null,b=Fn,Fn=Ra(l.containerInfo),On(l,a),Fn=b,Pn(a),m&4&&d!==null&&d.memoizedState.isDehydrated)try{xr(l.containerInfo)}catch(gt){jt(a,a.return,gt)}pl&&(pl=!1,sh(a));break;case 4:m=Fn,Fn=Ra(a.stateNode.containerInfo),On(l,a),Pn(a),Fn=m;break;case 12:On(l,a),Pn(a);break;case 13:On(l,a),Pn(a),a.child.flags&8192&&a.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(wl=Le()),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,ml(a,m)));break;case 22:if(m&512&&(Zt||d===null||yn(d,d.return)),le=a.memoizedState!==null,Ee=d!==null&&d.memoizedState!==null,ze=Jn,Xe=Zt,Jn=ze||le,Zt=Xe||Ee,On(l,a),Zt=Xe,Jn=ze,Pn(a),l=a.stateNode,l._current=a,l._visibility&=-3,l._visibility|=l._pendingVisibility&2,m&8192&&(l._visibility=le?l._visibility&-2:l._visibility|1,le&&(l=Jn||Zt,d===null||Ee||l||fs(a)),a.memoizedProps===null||a.memoizedProps.mode!=="manual"))e:for(d=null,l=a;;){if(l.tag===5||l.tag===26||l.tag===27){if(d===null){Ee=d=l;try{if(b=Ee.stateNode,le)S=b.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{j=Ee.stateNode,K=Ee.memoizedProps.style;var He=K!=null&&K.hasOwnProperty("display")?K.display:null;j.style.display=He==null||typeof He=="boolean"?"":(""+He).trim()}}catch(gt){jt(Ee,Ee.return,gt)}}}else if(l.tag===6){if(d===null){Ee=l;try{Ee.stateNode.nodeValue=le?"":Ee.memoizedProps}catch(gt){jt(Ee,Ee.return,gt)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===a)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break e;for(;l.sibling===null;){if(l.return===null||l.return===a)break e;d===l&&(d=null),l=l.return}d===l&&(d=null),l.sibling.return=l.return,l=l.sibling}m&4&&(m=a.updateQueue,m!==null&&(d=m.retryQueue,d!==null&&(m.retryQueue=null,ml(a,d))));break;case 19:On(l,a),Pn(a),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,ml(a,m)));break;case 21:break;default:On(l,a),Pn(a)}}function Pn(a){var l=a.flags;if(l&2){try{if(a.tag!==27){e:{for(var d=a.return;d!==null;){if(Yd(d)){var m=d;break e}d=d.return}throw Error(n(160))}switch(m.tag){case 27:var b=m.stateNode,S=hl(a);da(a,S,b);break;case 5:var j=m.stateNode;m.flags&32&&(Yi(j,""),m.flags&=-33);var K=hl(a);da(a,K,j);break;case 3:case 4:var le=m.stateNode.containerInfo,Ee=hl(a);fl(a,Ee,le);break;default:throw Error(n(161))}}}catch(ze){jt(a,a.return,ze)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function sh(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var l=a;sh(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),a=a.sibling}}function ei(a,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)Qd(a,l.alternate,l),l=l.sibling}function fs(a){for(a=a.child;a!==null;){var l=a;switch(l.tag){case 0:case 11:case 14:case 15:yi(4,l,l.return),fs(l);break;case 1:yn(l,l.return);var d=l.stateNode;typeof d.componentWillUnmount=="function"&&Gd(l,l.return,d),fs(l);break;case 26:case 27:case 5:yn(l,l.return),fs(l);break;case 22:yn(l,l.return),l.memoizedState===null&&fs(l);break;default:fs(l)}a=a.sibling}}function bi(a,l,d){for(d=d&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var m=l.alternate,b=a,S=l,j=S.flags;switch(S.tag){case 0:case 11:case 15:bi(b,S,d),ir(4,S);break;case 1:if(bi(b,S,d),m=S,b=m.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(Ee){jt(m,m.return,Ee)}if(m=S,b=m.updateQueue,b!==null){var K=m.stateNode;try{var le=b.shared.hiddenCallbacks;if(le!==null)for(b.shared.hiddenCallbacks=null,b=0;b<le.length;b++)qd(le[b],K)}catch(Ee){jt(m,m.return,Ee)}}d&&j&64&&Zd(S),zi(S,S.return);break;case 26:case 27:case 5:bi(b,S,d),d&&m===null&&j&4&&Wd(S),zi(S,S.return);break;case 12:bi(b,S,d);break;case 13:bi(b,S,d),d&&j&4&&nh(b,S);break;case 22:S.memoizedState===null&&bi(b,S,d),zi(S,S.return);break;default:bi(b,S,d)}l=l.sibling}}function gl(a,l){var d=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),a=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(a=l.memoizedState.cachePool.pool),a!==d&&(a!=null&&a.refCount++,d!=null&&Gs(d))}function yl(a,l){a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&Gs(a))}function _i(a,l,d,m){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)rh(a,l,d,m),l=l.sibling}function rh(a,l,d,m){var b=l.flags;switch(l.tag){case 0:case 11:case 15:_i(a,l,d,m),b&2048&&ir(9,l);break;case 3:_i(a,l,d,m),b&2048&&(a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&Gs(a)));break;case 12:if(b&2048){_i(a,l,d,m),a=l.stateNode;try{var S=l.memoizedProps,j=S.id,K=S.onPostCommit;typeof K=="function"&&K(j,l.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(le){jt(l,l.return,le)}}else _i(a,l,d,m);break;case 23:break;case 22:S=l.stateNode,l.memoizedState!==null?S._visibility&4?_i(a,l,d,m):sr(a,l):S._visibility&4?_i(a,l,d,m):(S._visibility|=4,ps(a,l,d,m,(l.subtreeFlags&10256)!==0)),b&2048&&gl(l.alternate,l);break;case 24:_i(a,l,d,m),b&2048&&yl(l.alternate,l);break;default:_i(a,l,d,m)}}function ps(a,l,d,m,b){for(b=b&&(l.subtreeFlags&10256)!==0,l=l.child;l!==null;){var S=a,j=l,K=d,le=m,Ee=j.flags;switch(j.tag){case 0:case 11:case 15:ps(S,j,K,le,b),ir(8,j);break;case 23:break;case 22:var ze=j.stateNode;j.memoizedState!==null?ze._visibility&4?ps(S,j,K,le,b):sr(S,j):(ze._visibility|=4,ps(S,j,K,le,b)),b&&Ee&2048&&gl(j.alternate,j);break;case 24:ps(S,j,K,le,b),b&&Ee&2048&&yl(j.alternate,j);break;default:ps(S,j,K,le,b)}l=l.sibling}}function sr(a,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var d=a,m=l,b=m.flags;switch(m.tag){case 22:sr(d,m),b&2048&&gl(m.alternate,m);break;case 24:sr(d,m),b&2048&&yl(m.alternate,m);break;default:sr(d,m)}l=l.sibling}}var rr=8192;function ms(a){if(a.subtreeFlags&rr)for(a=a.child;a!==null;)ah(a),a=a.sibling}function ah(a){switch(a.tag){case 26:ms(a),a.flags&rr&&a.memoizedState!==null&&Um(Fn,a.memoizedState,a.memoizedProps);break;case 5:ms(a);break;case 3:case 4:var l=Fn;Fn=Ra(a.stateNode.containerInfo),ms(a),Fn=l;break;case 22:a.memoizedState===null&&(l=a.alternate,l!==null&&l.memoizedState!==null?(l=rr,rr=16777216,ms(a),rr=l):ms(a));break;default:ms(a)}}function oh(a){var l=a.alternate;if(l!==null&&(a=l.child,a!==null)){l.child=null;do l=a.sibling,a.sibling=null,a=l;while(a!==null)}}function ar(a){var l=a.deletions;if(a.flags&16){if(l!==null)for(var d=0;d<l.length;d++){var m=l[d];nn=m,ch(m,a)}oh(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)lh(a),a=a.sibling}function lh(a){switch(a.tag){case 0:case 11:case 15:ar(a),a.flags&2048&&yi(9,a,a.return);break;case 3:ar(a);break;case 12:ar(a);break;case 22:var l=a.stateNode;a.memoizedState!==null&&l._visibility&4&&(a.return===null||a.return.tag!==13)?(l._visibility&=-5,ha(a)):ar(a);break;default:ar(a)}}function ha(a){var l=a.deletions;if(a.flags&16){if(l!==null)for(var d=0;d<l.length;d++){var m=l[d];nn=m,ch(m,a)}oh(a)}for(a=a.child;a!==null;){switch(l=a,l.tag){case 0:case 11:case 15:yi(8,l,l.return),ha(l);break;case 22:d=l.stateNode,d._visibility&4&&(d._visibility&=-5,ha(l));break;default:ha(l)}a=a.sibling}}function ch(a,l){for(;nn!==null;){var d=nn;switch(d.tag){case 0:case 11:case 15:yi(8,d,l);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var m=d.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:Gs(d.memoizedState.cache)}if(m=d.child,m!==null)m.return=d,nn=m;else e:for(d=a;nn!==null;){m=nn;var b=m.sibling,S=m.return;if(eh(m),m===d){nn=null;break e}if(b!==null){b.return=S,nn=b;break e}nn=S}}}function Qp(a,l,d,m){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kn(a,l,d,m){return new Qp(a,l,d,m)}function bl(a){return a=a.prototype,!(!a||!a.isReactComponent)}function vi(a,l){var d=a.alternate;return d===null?(d=kn(a.tag,l,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=l,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&31457280,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,l=a.dependencies,d.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d.refCleanup=a.refCleanup,d}function uh(a,l){a.flags&=31457282;var d=a.alternate;return d===null?(a.childLanes=0,a.lanes=l,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=d.childLanes,a.lanes=d.lanes,a.child=d.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=d.memoizedProps,a.memoizedState=d.memoizedState,a.updateQueue=d.updateQueue,a.type=d.type,l=d.dependencies,a.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),a}function fa(a,l,d,m,b,S){var j=0;if(m=a,typeof a=="function")bl(a)&&(j=1);else if(typeof a=="string")j=jm(a,d,Re.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case h:return qi(d.children,b,S,l);case f:j=8,b|=24;break;case p:return a=kn(12,d,l,b|2),a.elementType=p,a.lanes=S,a;case E:return a=kn(13,d,l,b),a.elementType=E,a.lanes=S,a;case x:return a=kn(19,d,l,b),a.elementType=x,a.lanes=S,a;case O:return dh(d,b,S,l);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case g:case v:j=10;break e;case y:j=9;break e;case _:j=11;break e;case w:j=14;break e;case T:j=16,m=null;break e}j=29,d=Error(n(130,a===null?"null":typeof a,"")),m=null}return l=kn(j,d,l,b),l.elementType=a,l.type=m,l.lanes=S,l}function qi(a,l,d,m){return a=kn(7,a,m,l),a.lanes=d,a}function dh(a,l,d,m){a=kn(22,a,m,l),a.elementType=O,a.lanes=d;var b={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var S=b._current;if(S===null)throw Error(n(456));if(!(b._pendingVisibility&2)){var j=li(S,2);j!==null&&(b._pendingVisibility|=2,dn(j,S,2))}},attach:function(){var S=b._current;if(S===null)throw Error(n(456));if(b._pendingVisibility&2){var j=li(S,2);j!==null&&(b._pendingVisibility&=-3,dn(j,S,2))}}};return a.stateNode=b,a}function _l(a,l,d){return a=kn(6,a,null,l),a.lanes=d,a}function vl(a,l,d){return l=kn(4,a.children!==null?a.children:[],a.key,l),l.lanes=d,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}function ti(a){a.flags|=4}function hh(a,l){if(l.type!=="stylesheet"||l.state.loading&4)a.flags&=-16777217;else if(a.flags|=16777216,!Yh(l)){if(l=Cn.current,l!==null&&((Mt&4194176)===Mt?Un!==null:(Mt&62914560)!==Mt&&!(Mt&536870912)||l!==Un))throw qs=Ao,Ou;a.flags|=8192}}function pa(a,l){l!==null&&(a.flags|=4),a.flags&16384&&(l=a.tag!==22?Q():536870912,a.lanes|=l,ys|=l)}function or(a,l){if(!Dt)switch(a.tailMode){case"hidden":l=a.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function zt(a){var l=a.alternate!==null&&a.alternate.child===a.child,d=0,m=0;if(l)for(var b=a.child;b!==null;)d|=b.lanes|b.childLanes,m|=b.subtreeFlags&31457280,m|=b.flags&31457280,b.return=a,b=b.sibling;else for(b=a.child;b!==null;)d|=b.lanes|b.childLanes,m|=b.subtreeFlags,m|=b.flags,b.return=a,b=b.sibling;return a.subtreeFlags|=m,a.childLanes=d,l}function em(a,l,d){var m=l.pendingProps;switch(So(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zt(l),null;case 1:return zt(l),null;case 3:return d=l.stateNode,m=null,a!==null&&(m=a.memoizedState.cache),l.memoizedState.cache!==m&&(l.flags|=2048),Kn(en),ge(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(a===null||a.child===null)&&(Us(l)?ti(l):a===null||a.memoizedState.isDehydrated&&!(l.flags&256)||(l.flags|=1024,Nn!==null&&(Cl(Nn),Nn=null))),zt(l),null;case 26:return d=l.memoizedState,a===null?(ti(l),d!==null?(zt(l),hh(l,d)):(zt(l),l.flags&=-16777217)):d?d!==a.memoizedState?(ti(l),zt(l),hh(l,d)):(zt(l),l.flags&=-16777217):(a.memoizedProps!==m&&ti(l),zt(l),l.flags&=-16777217),null;case 27:X(l),d=Ie.current;var b=l.type;if(a!==null&&l.stateNode!=null)a.memoizedProps!==m&&ti(l);else{if(!m){if(l.stateNode===null)throw Error(n(166));return zt(l),null}a=Re.current,Us(l)?Ru(l):(a=Hh(b,m,d),l.stateNode=a,ti(l))}return zt(l),null;case 5:if(X(l),d=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==m&&ti(l);else{if(!m){if(l.stateNode===null)throw Error(n(166));return zt(l),null}if(a=Re.current,Us(l))Ru(l);else{switch(b=Ta(Ie.current),a){case 1:a=b.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:a=b.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":a=b.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":a=b.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":a=b.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof m.is=="string"?b.createElement("select",{is:m.is}):b.createElement("select"),m.multiple?a.multiple=!0:m.size&&(a.size=m.size);break;default:a=typeof m.is=="string"?b.createElement(d,{is:m.is}):b.createElement(d)}}a[Qe]=l,a[Ke]=m;e:for(b=l.child;b!==null;){if(b.tag===5||b.tag===6)a.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===l)break e;for(;b.sibling===null;){if(b.return===null||b.return===l)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}l.stateNode=a;e:switch(ln(a,d,m),d){case"button":case"input":case"select":case"textarea":a=!!m.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&ti(l)}}return zt(l),l.flags&=-16777217,null;case 6:if(a&&l.stateNode!=null)a.memoizedProps!==m&&ti(l);else{if(typeof m!="string"&&l.stateNode===null)throw Error(n(166));if(a=Ie.current,Us(l)){if(a=l.stateNode,d=l.memoizedProps,m=null,b=un,b!==null)switch(b.tag){case 27:case 5:m=b.memoizedProps}a[Qe]=l,a=!!(a.nodeValue===d||m!==null&&m.suppressHydrationWarning===!0||Nh(a.nodeValue,d)),a||Di(l)}else a=Ta(a).createTextNode(m),a[Qe]=l,l.stateNode=a}return zt(l),null;case 13:if(m=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(b=Us(l),m!==null&&m.dehydrated!==null){if(a===null){if(!b)throw Error(n(318));if(b=l.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(n(317));b[Qe]=l}else Bs(),!(l.flags&128)&&(l.memoizedState=null),l.flags|=4;zt(l),b=!1}else Nn!==null&&(Cl(Nn),Nn=null),b=!0;if(!b)return l.flags&256?(Gn(l),l):(Gn(l),null)}if(Gn(l),l.flags&128)return l.lanes=d,l;if(d=m!==null,a=a!==null&&a.memoizedState!==null,d){m=l.child,b=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(b=m.alternate.memoizedState.cachePool.pool);var S=null;m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(S=m.memoizedState.cachePool.pool),S!==b&&(m.flags|=2048)}return d!==a&&d&&(l.child.flags|=8192),pa(l,l.updateQueue),zt(l),null;case 4:return ge(),a===null&&$l(l.stateNode.containerInfo),zt(l),null;case 10:return Kn(l.type),zt(l),null;case 19:if(ce(Qt),b=l.memoizedState,b===null)return zt(l),null;if(m=(l.flags&128)!==0,S=b.rendering,S===null)if(m)or(b,!1);else{if(Gt!==0||a!==null&&a.flags&128)for(a=l.child;a!==null;){if(S=Kr(a),S!==null){for(l.flags|=128,or(b,!1),a=S.updateQueue,l.updateQueue=a,pa(l,a),l.subtreeFlags=0,a=d,d=l.child;d!==null;)uh(d,a),d=d.sibling;return he(Qt,Qt.current&1|2),l.child}a=a.sibling}b.tail!==null&&Le()>ma&&(l.flags|=128,m=!0,or(b,!1),l.lanes=4194304)}else{if(!m)if(a=Kr(S),a!==null){if(l.flags|=128,m=!0,a=a.updateQueue,l.updateQueue=a,pa(l,a),or(b,!0),b.tail===null&&b.tailMode==="hidden"&&!S.alternate&&!Dt)return zt(l),null}else 2*Le()-b.renderingStartTime>ma&&d!==536870912&&(l.flags|=128,m=!0,or(b,!1),l.lanes=4194304);b.isBackwards?(S.sibling=l.child,l.child=S):(a=b.last,a!==null?a.sibling=S:l.child=S,b.last=S)}return b.tail!==null?(l=b.tail,b.rendering=l,b.tail=l.sibling,b.renderingStartTime=Le(),l.sibling=null,a=Qt.current,he(Qt,m?a&1|2:a&1),l):(zt(l),null);case 22:case 23:return Gn(l),Ro(),m=l.memoizedState!==null,a!==null?a.memoizedState!==null!==m&&(l.flags|=8192):m&&(l.flags|=8192),m?d&536870912&&!(l.flags&128)&&(zt(l),l.subtreeFlags&6&&(l.flags|=8192)):zt(l),d=l.updateQueue,d!==null&&pa(l,d.retryQueue),d=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),m=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),m!==d&&(l.flags|=2048),a!==null&&ce(Ni),null;case 24:return d=null,a!==null&&(d=a.memoizedState.cache),l.memoizedState.cache!==d&&(l.flags|=2048),Kn(en),zt(l),null;case 25:return null}throw Error(n(156,l.tag))}function tm(a,l){switch(So(l),l.tag){case 1:return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return Kn(en),ge(),a=l.flags,a&65536&&!(a&128)?(l.flags=a&-65537|128,l):null;case 26:case 27:case 5:return X(l),null;case 13:if(Gn(l),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(n(340));Bs()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return ce(Qt),null;case 4:return ge(),null;case 10:return Kn(l.type),null;case 22:case 23:return Gn(l),Ro(),a!==null&&ce(Ni),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 24:return Kn(en),null;case 25:return null;default:return null}}function fh(a,l){switch(So(l),l.tag){case 3:Kn(en),ge();break;case 26:case 27:case 5:X(l);break;case 4:ge();break;case 13:Gn(l);break;case 19:ce(Qt);break;case 10:Kn(l.type);break;case 22:case 23:Gn(l),Ro(),a!==null&&ce(Ni);break;case 24:Kn(en)}}var nm={getCacheForType:function(a){var l=cn(en),d=l.data.get(a);return d===void 0&&(d=a(),l.data.set(a,d)),d}},im=typeof WeakMap=="function"?WeakMap:Map,qt=0,$t=null,Ct=null,Mt=0,Ut=0,_n=null,ni=!1,gs=!1,xl=!1,ii=0,Gt=0,xi=0,Vi=0,El=0,Mn=0,ys=0,lr=null,Hn=null,Sl=!1,wl=0,ma=1/0,ga=null,Ei=null,ya=!1,Zi=null,cr=0,Al=0,Tl=null,ur=0,Rl=null;function vn(){if(qt&2&&Mt!==0)return Mt&-Mt;if(L.T!==null){var a=ls;return a!==0?a:Ll()}return st()}function ph(){Mn===0&&(Mn=!(Mt&536870912)||Dt?ie():536870912);var a=Cn.current;return a!==null&&(a.flags|=32),Mn}function dn(a,l,d){(a===$t&&Ut===2||a.cancelPendingCommit!==null)&&(bs(a,0),si(a,Mt,Mn,!1)),Ae(a,d),(!(qt&2)||a!==$t)&&(a===$t&&(!(qt&2)&&(Vi|=d),Gt===4&&si(a,Mt,Mn,!1)),zn(a))}function mh(a,l,d){if(qt&6)throw Error(n(327));var m=!d&&(l&60)===0&&(l&a.expiredLanes)===0||Je(a,l),b=m?am(a,l):kl(a,l,!0),S=m;do{if(b===0){gs&&!m&&si(a,l,0,!1);break}else if(b===6)si(a,l,0,!ni);else{if(d=a.current.alternate,S&&!sm(d)){b=kl(a,l,!1),S=!1;continue}if(b===2){if(S=l,a.errorRecoveryDisabledLanes&S)var j=0;else j=a.pendingLanes&-536870913,j=j!==0?j:j&536870912?536870912:0;if(j!==0){l=j;e:{var K=a;b=lr;var le=K.current.memoizedState.isDehydrated;if(le&&(bs(K,j).flags|=256),j=kl(K,j,!1),j!==2){if(xl&&!le){K.errorRecoveryDisabledLanes|=S,Vi|=S,b=4;break e}S=Hn,Hn=b,S!==null&&Cl(S)}b=j}if(S=!1,b!==2)continue}}if(b===1){bs(a,0),si(a,l,0,!0);break}e:{switch(m=a,b){case 0:case 1:throw Error(n(345));case 4:if((l&4194176)===l){si(m,l,Mn,!ni);break e}break;case 2:Hn=null;break;case 3:case 5:break;default:throw Error(n(329))}if(m.finishedWork=d,m.finishedLanes=l,(l&62914560)===l&&(S=wl+300-Le(),10<S)){if(si(m,l,Mn,!ni),at(m,0)!==0)break e;m.timeoutHandle=$h(gh.bind(null,m,d,Hn,ga,Sl,l,Mn,Vi,ys,ni,2,-0,0),S);break e}gh(m,d,Hn,ga,Sl,l,Mn,Vi,ys,ni,0,-0,0)}}break}while(!0);zn(a)}function Cl(a){Hn===null?Hn=a:Hn.push.apply(Hn,a)}function gh(a,l,d,m,b,S,j,K,le,Ee,ze,Xe,De){var He=l.subtreeFlags;if((He&8192||(He&16785408)===16785408)&&(gr={stylesheets:null,count:0,unsuspend:$m},ah(l),l=Bm(),l!==null)){a.cancelPendingCommit=l(Sh.bind(null,a,d,m,b,j,K,le,1,Xe,De)),si(a,S,j,!Ee);return}Sh(a,d,m,b,j,K,le,ze,Xe,De)}function sm(a){for(var l=a;;){var d=l.tag;if((d===0||d===11||d===15)&&l.flags&16384&&(d=l.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var m=0;m<d.length;m++){var b=d[m],S=b.getSnapshot;b=b.value;try{if(!gn(S(),b))return!1}catch{return!1}}if(d=l.child,l.subtreeFlags&16384&&d!==null)d.return=l,l=d;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function si(a,l,d,m){l&=~El,l&=~Vi,a.suspendedLanes|=l,a.pingedLanes&=~l,m&&(a.warmLanes|=l),m=a.expirationTimes;for(var b=l;0<b;){var S=31-ye(b),j=1<<S;m[S]=-1,b&=~j}d!==0&&je(a,d,l)}function ba(){return qt&6?!0:(dr(0),!1)}function Ol(){if(Ct!==null){if(Ut===0)var a=Ct.return;else a=Ct,Yn=Bi=null,Lo(a),as=null,Vs=0,a=Ct;for(;a!==null;)fh(a.alternate,a),a=a.return;Ct=null}}function bs(a,l){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;d!==-1&&(a.timeoutHandle=-1,Sm(d)),d=a.cancelPendingCommit,d!==null&&(a.cancelPendingCommit=null,d()),Ol(),$t=a,Ct=d=vi(a.current,null),Mt=l,Ut=0,_n=null,ni=!1,gs=Je(a,l),xl=!1,ys=Mn=El=Vi=xi=Gt=0,Hn=lr=null,Sl=!1,l&8&&(l|=l&32);var m=a.entangledLanes;if(m!==0)for(a=a.entanglements,m&=l;0<m;){var b=31-ye(m),S=1<<b;l|=a[b],m&=~S}return ii=l,Hr(),d}function yh(a,l){Tt=null,L.H=Bn,l===zs?(l=Mu(),Ut=3):l===Ou?(l=Mu(),Ut=4):Ut=l===Pd?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,_n=l,Ct===null&&(Gt=1,la(a,An(l,a.current)))}function bh(){var a=L.H;return L.H=Bn,a===null?Bn:a}function _h(){var a=L.A;return L.A=nm,a}function Pl(){Gt=4,ni||(Mt&4194176)!==Mt&&Cn.current!==null||(gs=!0),!(xi&134217727)&&!(Vi&134217727)||$t===null||si($t,Mt,Mn,!1)}function kl(a,l,d){var m=qt;qt|=2;var b=bh(),S=_h();($t!==a||Mt!==l)&&(ga=null,bs(a,l)),l=!1;var j=Gt;e:do try{if(Ut!==0&&Ct!==null){var K=Ct,le=_n;switch(Ut){case 8:Ol(),j=6;break e;case 3:case 2:case 6:Cn.current===null&&(l=!0);var Ee=Ut;if(Ut=0,_n=null,_s(a,K,le,Ee),d&&gs){j=0;break e}break;default:Ee=Ut,Ut=0,_n=null,_s(a,K,le,Ee)}}rm(),j=Gt;break}catch(ze){yh(a,ze)}while(!0);return l&&a.shellSuspendCounter++,Yn=Bi=null,qt=m,L.H=b,L.A=S,Ct===null&&($t=null,Mt=0,Hr()),j}function rm(){for(;Ct!==null;)vh(Ct)}function am(a,l){var d=qt;qt|=2;var m=bh(),b=_h();$t!==a||Mt!==l?(ga=null,ma=Le()+500,bs(a,l)):gs=Je(a,l);e:do try{if(Ut!==0&&Ct!==null){l=Ct;var S=_n;t:switch(Ut){case 1:Ut=0,_n=null,_s(a,l,S,1);break;case 2:if(Pu(S)){Ut=0,_n=null,xh(l);break}l=function(){Ut===2&&$t===a&&(Ut=7),zn(a)},S.then(l,l);break e;case 3:Ut=7;break e;case 4:Ut=5;break e;case 7:Pu(S)?(Ut=0,_n=null,xh(l)):(Ut=0,_n=null,_s(a,l,S,7));break;case 5:var j=null;switch(Ct.tag){case 26:j=Ct.memoizedState;case 5:case 27:var K=Ct;if(!j||Yh(j)){Ut=0,_n=null;var le=K.sibling;if(le!==null)Ct=le;else{var Ee=K.return;Ee!==null?(Ct=Ee,va(Ee)):Ct=null}break t}}Ut=0,_n=null,_s(a,l,S,5);break;case 6:Ut=0,_n=null,_s(a,l,S,6);break;case 8:Ol(),Gt=6;break e;default:throw Error(n(462))}}om();break}catch(ze){yh(a,ze)}while(!0);return Yn=Bi=null,L.H=m,L.A=b,qt=d,Ct!==null?0:($t=null,Mt=0,Hr(),Gt)}function om(){for(;Ct!==null&&!Me();)vh(Ct)}function vh(a){var l=Hd(a.alternate,a,ii);a.memoizedProps=a.pendingProps,l===null?va(a):Ct=l}function xh(a){var l=a,d=l.alternate;switch(l.tag){case 15:case 0:l=Nd(d,l,l.pendingProps,l.type,void 0,Mt);break;case 11:l=Nd(d,l,l.pendingProps,l.type.render,l.ref,Mt);break;case 5:Lo(l);default:fh(d,l),l=Ct=uh(l,ii),l=Hd(d,l,ii)}a.memoizedProps=a.pendingProps,l===null?va(a):Ct=l}function _s(a,l,d,m){Yn=Bi=null,Lo(l),as=null,Vs=0;var b=l.return;try{if(Xp(a,b,l,d,Mt)){Gt=1,la(a,An(d,a.current)),Ct=null;return}}catch(S){if(b!==null)throw Ct=b,S;Gt=1,la(a,An(d,a.current)),Ct=null;return}l.flags&32768?(Dt||m===1?a=!0:gs||Mt&536870912?a=!1:(ni=a=!0,(m===2||m===3||m===6)&&(m=Cn.current,m!==null&&m.tag===13&&(m.flags|=16384))),Eh(l,a)):va(l)}function va(a){var l=a;do{if(l.flags&32768){Eh(l,ni);return}a=l.return;var d=em(l.alternate,l,ii);if(d!==null){Ct=d;return}if(l=l.sibling,l!==null){Ct=l;return}Ct=l=a}while(l!==null);Gt===0&&(Gt=5)}function Eh(a,l){do{var d=tm(a.alternate,a);if(d!==null){d.flags&=32767,Ct=d;return}if(d=a.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!l&&(a=a.sibling,a!==null)){Ct=a;return}Ct=a=d}while(a!==null);Gt=6,Ct=null}function Sh(a,l,d,m,b,S,j,K,le,Ee){var ze=L.T,Xe=P.p;try{P.p=2,L.T=null,lm(a,l,d,m,Xe,b,S,j,K,le,Ee)}finally{L.T=ze,P.p=Xe}}function lm(a,l,d,m,b,S,j,K){do vs();while(Zi!==null);if(qt&6)throw Error(n(327));var le=a.finishedWork;if(m=a.finishedLanes,le===null)return null;if(a.finishedWork=null,a.finishedLanes=0,le===a.current)throw Error(n(177));a.callbackNode=null,a.callbackPriority=0,a.cancelPendingCommit=null;var Ee=le.lanes|le.childLanes;if(Ee|=vo,Oe(a,m,Ee,S,j,K),a===$t&&(Ct=$t=null,Mt=0),!(le.subtreeFlags&10256)&&!(le.flags&10256)||ya||(ya=!0,Al=Ee,Tl=d,hm(pt,function(){return vs(),null})),d=(le.flags&15990)!==0,le.subtreeFlags&15990||d?(d=L.T,L.T=null,S=P.p,P.p=2,j=qt,qt|=4,Kp(a,le),ih(le,a),Mp(zl,a.containerInfo),Ma=!!Hl,zl=Hl=null,a.current=le,Qd(a,le.alternate,le),Be(),qt=j,P.p=S,L.T=d):a.current=le,ya?(ya=!1,Zi=a,cr=m):wh(a,Ee),Ee=a.pendingLanes,Ee===0&&(Ei=null),Fe(le.stateNode),zn(a),l!==null)for(b=a.onRecoverableError,le=0;le<l.length;le++)Ee=l[le],b(Ee.value,{componentStack:Ee.stack});return cr&3&&vs(),Ee=a.pendingLanes,m&4194218&&Ee&42?a===Rl?ur++:(ur=0,Rl=a):ur=0,dr(0),null}function wh(a,l){(a.pooledCacheLanes&=l)===0&&(l=a.pooledCache,l!=null&&(a.pooledCache=null,Gs(l)))}function vs(){if(Zi!==null){var a=Zi,l=Al;Al=0;var d=it(cr),m=L.T,b=P.p;try{if(P.p=32>d?32:d,L.T=null,Zi===null)var S=!1;else{d=Tl,Tl=null;var j=Zi,K=cr;if(Zi=null,cr=0,qt&6)throw Error(n(331));var le=qt;if(qt|=4,lh(j.current),rh(j,j.current,K,d),qt=le,dr(0,!1),mt&&typeof mt.onPostCommitFiberRoot=="function")try{mt.onPostCommitFiberRoot(yt,j)}catch{}S=!0}return S}finally{P.p=b,L.T=m,wh(a,l)}}return!1}function Ah(a,l,d){l=An(d,l),l=Xo(a.stateNode,l,2),a=gi(a,l,2),a!==null&&(Ae(a,2),zn(a))}function jt(a,l,d){if(a.tag===3)Ah(a,a,d);else for(;l!==null;){if(l.tag===3){Ah(l,a,d);break}else if(l.tag===1){var m=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Ei===null||!Ei.has(m))){a=An(d,a),d=Cd(2),m=gi(l,d,2),m!==null&&(Od(d,m,l,a),Ae(m,2),zn(m));break}}l=l.return}}function Ml(a,l,d){var m=a.pingCache;if(m===null){m=a.pingCache=new im;var b=new Set;m.set(l,b)}else b=m.get(l),b===void 0&&(b=new Set,m.set(l,b));b.has(d)||(xl=!0,b.add(d),a=cm.bind(null,a,l,d),l.then(a,a))}function cm(a,l,d){var m=a.pingCache;m!==null&&m.delete(l),a.pingedLanes|=a.suspendedLanes&d,a.warmLanes&=~d,$t===a&&(Mt&d)===d&&(Gt===4||Gt===3&&(Mt&62914560)===Mt&&300>Le()-wl?!(qt&2)&&bs(a,0):El|=d,ys===Mt&&(ys=0)),zn(a)}function Th(a,l){l===0&&(l=Q()),a=li(a,l),a!==null&&(Ae(a,l),zn(a))}function um(a){var l=a.memoizedState,d=0;l!==null&&(d=l.retryLane),Th(a,d)}function dm(a,l){var d=0;switch(a.tag){case 13:var m=a.stateNode,b=a.memoizedState;b!==null&&(d=b.retryLane);break;case 19:m=a.stateNode;break;case 22:m=a.stateNode._retryCache;break;default:throw Error(n(314))}m!==null&&m.delete(l),Th(a,d)}function hm(a,l){return fe(a,l)}var xa=null,xs=null,Il=!1,Ea=!1,Dl=!1,Gi=0;function zn(a){a!==xs&&a.next===null&&(xs===null?xa=xs=a:xs=xs.next=a),Ea=!0,Il||(Il=!0,pm(fm))}function dr(a,l){if(!Dl&&Ea){Dl=!0;do for(var d=!1,m=xa;m!==null;){if(a!==0){var b=m.pendingLanes;if(b===0)var S=0;else{var j=m.suspendedLanes,K=m.pingedLanes;S=(1<<31-ye(42|a)+1)-1,S&=b&~(j&~K),S=S&201326677?S&201326677|1:S?S|2:0}S!==0&&(d=!0,Oh(m,S))}else S=Mt,S=at(m,m===$t?S:0),!(S&3)||Je(m,S)||(d=!0,Oh(m,S));m=m.next}while(d);Dl=!1}}function fm(){Ea=Il=!1;var a=0;Gi!==0&&(Em()&&(a=Gi),Gi=0);for(var l=Le(),d=null,m=xa;m!==null;){var b=m.next,S=Rh(m,l);S===0?(m.next=null,d===null?xa=b:d.next=b,b===null&&(xs=d)):(d=m,(a!==0||S&3)&&(Ea=!0)),m=b}dr(a)}function Rh(a,l){for(var d=a.suspendedLanes,m=a.pingedLanes,b=a.expirationTimes,S=a.pendingLanes&-62914561;0<S;){var j=31-ye(S),K=1<<j,le=b[j];le===-1?(!(K&d)||K&m)&&(b[j]=et(K,l)):le<=l&&(a.expiredLanes|=K),S&=~K}if(l=$t,d=Mt,d=at(a,a===l?d:0),m=a.callbackNode,d===0||a===l&&Ut===2||a.cancelPendingCommit!==null)return m!==null&&m!==null&&ve(m),a.callbackNode=null,a.callbackPriority=0;if(!(d&3)||Je(a,d)){if(l=d&-d,l===a.callbackPriority)return l;switch(m!==null&&ve(m),it(d)){case 2:case 8:d=qe;break;case 32:d=pt;break;case 268435456:d=Et;break;default:d=pt}return m=Ch.bind(null,a),d=fe(d,m),a.callbackPriority=l,a.callbackNode=d,l}return m!==null&&m!==null&&ve(m),a.callbackPriority=2,a.callbackNode=null,2}function Ch(a,l){var d=a.callbackNode;if(vs()&&a.callbackNode!==d)return null;var m=Mt;return m=at(a,a===$t?m:0),m===0?null:(mh(a,m,l),Rh(a,Le()),a.callbackNode!=null&&a.callbackNode===d?Ch.bind(null,a):null)}function Oh(a,l){if(vs())return null;mh(a,l,!0)}function pm(a){wm(function(){qt&6?fe(Ge,a):a()})}function Ll(){return Gi===0&&(Gi=ie()),Gi}function Ph(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Lr(""+a)}function kh(a,l){var d=l.ownerDocument.createElement("input");return d.name=l.name,d.value=l.value,a.id&&d.setAttribute("form",a.id),l.parentNode.insertBefore(d,l),a=new FormData(a),d.parentNode.removeChild(d),a}function mm(a,l,d,m,b){if(l==="submit"&&d&&d.stateNode===b){var S=Ph((b[Ke]||null).action),j=m.submitter;j&&(l=(l=j[Ke]||null)?Ph(l.formAction):j.getAttribute("formAction"),l!==null&&(S=l,j=null));var K=new $r("action","action",null,m,b);a.push({event:K,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(Gi!==0){var le=j?kh(b,j):new FormData(b);qo(d,{pending:!0,data:le,method:b.method,action:S},null,le)}}else typeof S=="function"&&(K.preventDefault(),le=j?kh(b,j):new FormData(b),qo(d,{pending:!0,data:le,method:b.method,action:S},S,le))},currentTarget:b}]})}}for(var Nl=0;Nl<Su.length;Nl++){var Fl=Su[Nl],gm=Fl.toLowerCase(),ym=Fl[0].toUpperCase()+Fl.slice(1);Ln(gm,"on"+ym)}Ln(bu,"onAnimationEnd"),Ln(_u,"onAnimationIteration"),Ln(vu,"onAnimationStart"),Ln("dblclick","onDoubleClick"),Ln("focusin","onFocus"),Ln("focusout","onBlur"),Ln(Dp,"onTransitionRun"),Ln(Lp,"onTransitionStart"),Ln(Np,"onTransitionCancel"),Ln(xu,"onTransitionEnd"),Vt("onMouseEnter",["mouseout","mouseover"]),Vt("onMouseLeave",["mouseout","mouseover"]),Vt("onPointerEnter",["pointerout","pointerover"]),Vt("onPointerLeave",["pointerout","pointerover"]),mn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),mn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),mn("onBeforeInput",["compositionend","keypress","textInput","paste"]),mn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),mn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),mn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bm=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(hr));function Mh(a,l){l=(l&4)!==0;for(var d=0;d<a.length;d++){var m=a[d],b=m.event;m=m.listeners;e:{var S=void 0;if(l)for(var j=m.length-1;0<=j;j--){var K=m[j],le=K.instance,Ee=K.currentTarget;if(K=K.listener,le!==S&&b.isPropagationStopped())break e;S=K,b.currentTarget=Ee;try{S(b)}catch(ze){oa(ze)}b.currentTarget=null,S=le}else for(j=0;j<m.length;j++){if(K=m[j],le=K.instance,Ee=K.currentTarget,K=K.listener,le!==S&&b.isPropagationStopped())break e;S=K,b.currentTarget=Ee;try{S(b)}catch(ze){oa(ze)}b.currentTarget=null,S=le}}}}function kt(a,l){var d=l[bt];d===void 0&&(d=l[bt]=new Set);var m=a+"__bubble";d.has(m)||(Ih(l,a,2,!1),d.add(m))}function jl(a,l,d){var m=0;l&&(m|=4),Ih(d,a,m,l)}var Sa="_reactListening"+Math.random().toString(36).slice(2);function $l(a){if(!a[Sa]){a[Sa]=!0,rn.forEach(function(d){d!=="selectionchange"&&(bm.has(d)||jl(d,!1,a),jl(d,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[Sa]||(l[Sa]=!0,jl("selectionchange",!1,l))}}function Ih(a,l,d,m){switch(nf(l)){case 2:var b=qm;break;case 8:b=Vm;break;default:b=Jl}d=b.bind(null,l,d,a),b=void 0,!ao||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(b=!0),m?b!==void 0?a.addEventListener(l,d,{capture:!0,passive:b}):a.addEventListener(l,d,!0):b!==void 0?a.addEventListener(l,d,{passive:b}):a.addEventListener(l,d,!1)}function Ul(a,l,d,m,b){var S=m;if(!(l&1)&&!(l&2)&&m!==null)e:for(;;){if(m===null)return;var j=m.tag;if(j===3||j===4){var K=m.stateNode.containerInfo;if(K===b||K.nodeType===8&&K.parentNode===b)break;if(j===4)for(j=m.return;j!==null;){var le=j.tag;if((le===3||le===4)&&(le=j.stateNode.containerInfo,le===b||le.nodeType===8&&le.parentNode===b))return;j=j.return}for(;K!==null;){if(j=We(K),j===null)return;if(le=j.tag,le===5||le===6||le===26||le===27){m=S=j;continue e}K=K.parentNode}}m=m.return}Wc(function(){var Ee=S,ze=so(d),Xe=[];e:{var De=Eu.get(a);if(De!==void 0){var He=$r,gt=a;switch(a){case"keypress":if(Fr(d)===0)break e;case"keydown":case"keyup":He=dp;break;case"focusin":gt="focus",He=uo;break;case"focusout":gt="blur",He=uo;break;case"beforeblur":case"afterblur":He=uo;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":He=Kc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":He=Qf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":He=pp;break;case bu:case _u:case vu:He=np;break;case xu:He=gp;break;case"scroll":case"scrollend":He=Kf;break;case"wheel":He=bp;break;case"copy":case"cut":case"paste":He=sp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":He=Qc;break;case"toggle":case"beforetoggle":He=vp}var wt=(l&4)!==0,Wt=!wt&&(a==="scroll"||a==="scrollend"),Te=wt?De!==null?De+"Capture":null:De;wt=[];for(var xe=Ee,Pe;xe!==null;){var Ze=xe;if(Pe=Ze.stateNode,Ze=Ze.tag,Ze!==5&&Ze!==26&&Ze!==27||Pe===null||Te===null||(Ze=ks(xe,Te),Ze!=null&&wt.push(fr(xe,Ze,Pe))),Wt)break;xe=xe.return}0<wt.length&&(De=new He(De,gt,null,d,ze),Xe.push({event:De,listeners:wt}))}}if(!(l&7)){e:{if(De=a==="mouseover"||a==="pointerover",He=a==="mouseout"||a==="pointerout",De&&d!==io&&(gt=d.relatedTarget||d.fromElement)&&(We(gt)||gt[ut]))break e;if((He||De)&&(De=ze.window===ze?ze:(De=ze.ownerDocument)?De.defaultView||De.parentWindow:window,He?(gt=d.relatedTarget||d.toElement,He=Ee,gt=gt?We(gt):null,gt!==null&&(Wt=ne(gt),wt=gt.tag,gt!==Wt||wt!==5&&wt!==27&&wt!==6)&&(gt=null)):(He=null,gt=Ee),He!==gt)){if(wt=Kc,Ze="onMouseLeave",Te="onMouseEnter",xe="mouse",(a==="pointerout"||a==="pointerover")&&(wt=Qc,Ze="onPointerLeave",Te="onPointerEnter",xe="pointer"),Wt=He==null?De:It(He),Pe=gt==null?De:It(gt),De=new wt(Ze,xe+"leave",He,d,ze),De.target=Wt,De.relatedTarget=Pe,Ze=null,We(ze)===Ee&&(wt=new wt(Te,xe+"enter",gt,d,ze),wt.target=Pe,wt.relatedTarget=Wt,Ze=wt),Wt=Ze,He&&gt)t:{for(wt=He,Te=gt,xe=0,Pe=wt;Pe;Pe=Es(Pe))xe++;for(Pe=0,Ze=Te;Ze;Ze=Es(Ze))Pe++;for(;0<xe-Pe;)wt=Es(wt),xe--;for(;0<Pe-xe;)Te=Es(Te),Pe--;for(;xe--;){if(wt===Te||Te!==null&&wt===Te.alternate)break t;wt=Es(wt),Te=Es(Te)}wt=null}else wt=null;He!==null&&Dh(Xe,De,He,wt,!1),gt!==null&&Wt!==null&&Dh(Xe,Wt,gt,wt,!0)}}e:{if(De=Ee?It(Ee):window,He=De.nodeName&&De.nodeName.toLowerCase(),He==="select"||He==="input"&&De.type==="file")var ft=ou;else if(ru(De))if(lu)ft=Pp;else{ft=Cp;var Rt=Rp}else He=De.nodeName,!He||He.toLowerCase()!=="input"||De.type!=="checkbox"&&De.type!=="radio"?Ee&&no(Ee.elementType)&&(ft=ou):ft=Op;if(ft&&(ft=ft(a,Ee))){au(Xe,ft,d,ze);break e}Rt&&Rt(a,De,Ee),a==="focusout"&&Ee&&De.type==="number"&&Ee.memoizedProps.value!=null&&eo(De,"number",De.value)}switch(Rt=Ee?It(Ee):window,a){case"focusin":(ru(Rt)||Rt.contentEditable==="true")&&(es=Rt,yo=Ee,$s=null);break;case"focusout":$s=yo=es=null;break;case"mousedown":bo=!0;break;case"contextmenu":case"mouseup":case"dragend":bo=!1,gu(Xe,d,ze);break;case"selectionchange":if(Ip)break;case"keydown":case"keyup":gu(Xe,d,ze)}var _t;if(fo)e:{switch(a){case"compositionstart":var St="onCompositionStart";break e;case"compositionend":St="onCompositionEnd";break e;case"compositionupdate":St="onCompositionUpdate";break e}St=void 0}else Qi?iu(a,d)&&(St="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(St="onCompositionStart");St&&(eu&&d.locale!=="ko"&&(Qi||St!=="onCompositionStart"?St==="onCompositionEnd"&&Qi&&(_t=Xc()):(oi=ze,oo="value"in oi?oi.value:oi.textContent,Qi=!0)),Rt=wa(Ee,St),0<Rt.length&&(St=new Jc(St,a,null,d,ze),Xe.push({event:St,listeners:Rt}),_t?St.data=_t:(_t=su(d),_t!==null&&(St.data=_t)))),(_t=Ep?Sp(a,d):wp(a,d))&&(St=wa(Ee,"onBeforeInput"),0<St.length&&(Rt=new Jc("onBeforeInput","beforeinput",null,d,ze),Xe.push({event:Rt,listeners:St}),Rt.data=_t)),mm(Xe,a,Ee,d,ze)}Mh(Xe,l)})}function fr(a,l,d){return{instance:a,listener:l,currentTarget:d}}function wa(a,l){for(var d=l+"Capture",m=[];a!==null;){var b=a,S=b.stateNode;b=b.tag,b!==5&&b!==26&&b!==27||S===null||(b=ks(a,d),b!=null&&m.unshift(fr(a,b,S)),b=ks(a,l),b!=null&&m.push(fr(a,b,S))),a=a.return}return m}function Es(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function Dh(a,l,d,m,b){for(var S=l._reactName,j=[];d!==null&&d!==m;){var K=d,le=K.alternate,Ee=K.stateNode;if(K=K.tag,le!==null&&le===m)break;K!==5&&K!==26&&K!==27||Ee===null||(le=Ee,b?(Ee=ks(d,S),Ee!=null&&j.unshift(fr(d,Ee,le))):b||(Ee=ks(d,S),Ee!=null&&j.push(fr(d,Ee,le)))),d=d.return}j.length!==0&&a.push({event:l,listeners:j})}var _m=/\r\n?/g,vm=/\u0000|\uFFFD/g;function Lh(a){return(typeof a=="string"?a:""+a).replace(_m,`
`).replace(vm,"")}function Nh(a,l){return l=Lh(l),Lh(a)===l}function Aa(){}function Ft(a,l,d,m,b,S){switch(d){case"children":typeof m=="string"?l==="body"||l==="textarea"&&m===""||Yi(a,m):(typeof m=="number"||typeof m=="bigint")&&l!=="body"&&Yi(a,""+m);break;case"className":Mr(a,"class",m);break;case"tabIndex":Mr(a,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":Mr(a,d,m);break;case"style":Zc(a,m,S);break;case"data":if(l!=="object"){Mr(a,"data",m);break}case"src":case"href":if(m===""&&(l!=="a"||d!=="href")){a.removeAttribute(d);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){a.removeAttribute(d);break}m=Lr(""+m),a.setAttribute(d,m);break;case"action":case"formAction":if(typeof m=="function"){a.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(d==="formAction"?(l!=="input"&&Ft(a,l,"name",b.name,b,null),Ft(a,l,"formEncType",b.formEncType,b,null),Ft(a,l,"formMethod",b.formMethod,b,null),Ft(a,l,"formTarget",b.formTarget,b,null)):(Ft(a,l,"encType",b.encType,b,null),Ft(a,l,"method",b.method,b,null),Ft(a,l,"target",b.target,b,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){a.removeAttribute(d);break}m=Lr(""+m),a.setAttribute(d,m);break;case"onClick":m!=null&&(a.onclick=Aa);break;case"onScroll":m!=null&&kt("scroll",a);break;case"onScrollEnd":m!=null&&kt("scrollend",a);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(d=m.__html,d!=null){if(b.children!=null)throw Error(n(60));a.innerHTML=d}}break;case"multiple":a.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":a.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){a.removeAttribute("xlink:href");break}d=Lr(""+m),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(d,""+m):a.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(d,""):a.removeAttribute(d);break;case"capture":case"download":m===!0?a.setAttribute(d,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(d,m):a.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?a.setAttribute(d,m):a.removeAttribute(d);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?a.removeAttribute(d):a.setAttribute(d,m);break;case"popover":kt("beforetoggle",a),kt("toggle",a),kr(a,"popover",m);break;case"xlinkActuate":qn(a,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":qn(a,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":qn(a,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":qn(a,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":qn(a,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":qn(a,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":qn(a,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":qn(a,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":qn(a,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":kr(a,"is",m);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=Xf.get(d)||d,kr(a,d,m))}}function Bl(a,l,d,m,b,S){switch(d){case"style":Zc(a,m,S);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(d=m.__html,d!=null){if(b.children!=null)throw Error(n(60));a.innerHTML=d}}break;case"children":typeof m=="string"?Yi(a,m):(typeof m=="number"||typeof m=="bigint")&&Yi(a,""+m);break;case"onScroll":m!=null&&kt("scroll",a);break;case"onScrollEnd":m!=null&&kt("scrollend",a);break;case"onClick":m!=null&&(a.onclick=Aa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!pn.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(b=d.endsWith("Capture"),l=d.slice(2,b?d.length-7:void 0),S=a[Ke]||null,S=S!=null?S[d]:null,typeof S=="function"&&a.removeEventListener(l,S,b),typeof m=="function")){typeof S!="function"&&S!==null&&(d in a?a[d]=null:a.hasAttribute(d)&&a.removeAttribute(d)),a.addEventListener(l,m,b);break e}d in a?a[d]=m:m===!0?a.setAttribute(d,""):kr(a,d,m)}}}function ln(a,l,d){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":kt("error",a),kt("load",a);var m=!1,b=!1,S;for(S in d)if(d.hasOwnProperty(S)){var j=d[S];if(j!=null)switch(S){case"src":m=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:Ft(a,l,S,j,d,null)}}b&&Ft(a,l,"srcSet",d.srcSet,d,null),m&&Ft(a,l,"src",d.src,d,null);return;case"input":kt("invalid",a);var K=S=j=b=null,le=null,Ee=null;for(m in d)if(d.hasOwnProperty(m)){var ze=d[m];if(ze!=null)switch(m){case"name":b=ze;break;case"type":j=ze;break;case"checked":le=ze;break;case"defaultChecked":Ee=ze;break;case"value":S=ze;break;case"defaultValue":K=ze;break;case"children":case"dangerouslySetInnerHTML":if(ze!=null)throw Error(n(137,l));break;default:Ft(a,l,m,ze,d,null)}}Hc(a,S,K,le,Ee,j,b,!1),Ir(a);return;case"select":kt("invalid",a),m=j=S=null;for(b in d)if(d.hasOwnProperty(b)&&(K=d[b],K!=null))switch(b){case"value":S=K;break;case"defaultValue":j=K;break;case"multiple":m=K;default:Ft(a,l,b,K,d,null)}l=S,d=j,a.multiple=!!m,l!=null?Xi(a,!!m,l,!1):d!=null&&Xi(a,!!m,d,!0);return;case"textarea":kt("invalid",a),S=b=m=null;for(j in d)if(d.hasOwnProperty(j)&&(K=d[j],K!=null))switch(j){case"value":m=K;break;case"defaultValue":b=K;break;case"children":S=K;break;case"dangerouslySetInnerHTML":if(K!=null)throw Error(n(91));break;default:Ft(a,l,j,K,d,null)}qc(a,m,b,S),Ir(a);return;case"option":for(le in d)if(d.hasOwnProperty(le)&&(m=d[le],m!=null))switch(le){case"selected":a.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:Ft(a,l,le,m,d,null)}return;case"dialog":kt("cancel",a),kt("close",a);break;case"iframe":case"object":kt("load",a);break;case"video":case"audio":for(m=0;m<hr.length;m++)kt(hr[m],a);break;case"image":kt("error",a),kt("load",a);break;case"details":kt("toggle",a);break;case"embed":case"source":case"link":kt("error",a),kt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ee in d)if(d.hasOwnProperty(Ee)&&(m=d[Ee],m!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:Ft(a,l,Ee,m,d,null)}return;default:if(no(l)){for(ze in d)d.hasOwnProperty(ze)&&(m=d[ze],m!==void 0&&Bl(a,l,ze,m,d,void 0));return}}for(K in d)d.hasOwnProperty(K)&&(m=d[K],m!=null&&Ft(a,l,K,m,d,null))}function xm(a,l,d,m){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,S=null,j=null,K=null,le=null,Ee=null,ze=null;for(He in d){var Xe=d[He];if(d.hasOwnProperty(He)&&Xe!=null)switch(He){case"checked":break;case"value":break;case"defaultValue":le=Xe;default:m.hasOwnProperty(He)||Ft(a,l,He,null,m,Xe)}}for(var De in m){var He=m[De];if(Xe=d[De],m.hasOwnProperty(De)&&(He!=null||Xe!=null))switch(De){case"type":S=He;break;case"name":b=He;break;case"checked":Ee=He;break;case"defaultChecked":ze=He;break;case"value":j=He;break;case"defaultValue":K=He;break;case"children":case"dangerouslySetInnerHTML":if(He!=null)throw Error(n(137,l));break;default:He!==Xe&&Ft(a,l,De,He,m,Xe)}}Qa(a,j,K,le,Ee,ze,S,b);return;case"select":He=j=K=De=null;for(S in d)if(le=d[S],d.hasOwnProperty(S)&&le!=null)switch(S){case"value":break;case"multiple":He=le;default:m.hasOwnProperty(S)||Ft(a,l,S,null,m,le)}for(b in m)if(S=m[b],le=d[b],m.hasOwnProperty(b)&&(S!=null||le!=null))switch(b){case"value":De=S;break;case"defaultValue":K=S;break;case"multiple":j=S;default:S!==le&&Ft(a,l,b,S,m,le)}l=K,d=j,m=He,De!=null?Xi(a,!!d,De,!1):!!m!=!!d&&(l!=null?Xi(a,!!d,l,!0):Xi(a,!!d,d?[]:"",!1));return;case"textarea":He=De=null;for(K in d)if(b=d[K],d.hasOwnProperty(K)&&b!=null&&!m.hasOwnProperty(K))switch(K){case"value":break;case"children":break;default:Ft(a,l,K,null,m,b)}for(j in m)if(b=m[j],S=d[j],m.hasOwnProperty(j)&&(b!=null||S!=null))switch(j){case"value":De=b;break;case"defaultValue":He=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(n(91));break;default:b!==S&&Ft(a,l,j,b,m,S)}zc(a,De,He);return;case"option":for(var gt in d)if(De=d[gt],d.hasOwnProperty(gt)&&De!=null&&!m.hasOwnProperty(gt))switch(gt){case"selected":a.selected=!1;break;default:Ft(a,l,gt,null,m,De)}for(le in m)if(De=m[le],He=d[le],m.hasOwnProperty(le)&&De!==He&&(De!=null||He!=null))switch(le){case"selected":a.selected=De&&typeof De!="function"&&typeof De!="symbol";break;default:Ft(a,l,le,De,m,He)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var wt in d)De=d[wt],d.hasOwnProperty(wt)&&De!=null&&!m.hasOwnProperty(wt)&&Ft(a,l,wt,null,m,De);for(Ee in m)if(De=m[Ee],He=d[Ee],m.hasOwnProperty(Ee)&&De!==He&&(De!=null||He!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":if(De!=null)throw Error(n(137,l));break;default:Ft(a,l,Ee,De,m,He)}return;default:if(no(l)){for(var Wt in d)De=d[Wt],d.hasOwnProperty(Wt)&&De!==void 0&&!m.hasOwnProperty(Wt)&&Bl(a,l,Wt,void 0,m,De);for(ze in m)De=m[ze],He=d[ze],!m.hasOwnProperty(ze)||De===He||De===void 0&&He===void 0||Bl(a,l,ze,De,m,He);return}}for(var Te in d)De=d[Te],d.hasOwnProperty(Te)&&De!=null&&!m.hasOwnProperty(Te)&&Ft(a,l,Te,null,m,De);for(Xe in m)De=m[Xe],He=d[Xe],!m.hasOwnProperty(Xe)||De===He||De==null&&He==null||Ft(a,l,Xe,De,m,He)}var Hl=null,zl=null;function Ta(a){return a.nodeType===9?a:a.ownerDocument}function Fh(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function jh(a,l){if(a===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&l==="foreignObject"?0:a}function ql(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Vl=null;function Em(){var a=window.event;return a&&a.type==="popstate"?a===Vl?!1:(Vl=a,!0):(Vl=null,!1)}var $h=typeof setTimeout=="function"?setTimeout:void 0,Sm=typeof clearTimeout=="function"?clearTimeout:void 0,Uh=typeof Promise=="function"?Promise:void 0,wm=typeof queueMicrotask=="function"?queueMicrotask:typeof Uh<"u"?function(a){return Uh.resolve(null).then(a).catch(Am)}:$h;function Am(a){setTimeout(function(){throw a})}function Zl(a,l){var d=l,m=0;do{var b=d.nextSibling;if(a.removeChild(d),b&&b.nodeType===8)if(d=b.data,d==="/$"){if(m===0){a.removeChild(b),xr(l);return}m--}else d!=="$"&&d!=="$?"&&d!=="$!"||m++;d=b}while(d);xr(l)}function Gl(a){var l=a.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var d=l;switch(l=l.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":Gl(d),me(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}a.removeChild(d)}}function Tm(a,l,d,m){for(;a.nodeType===1;){var b=d;if(a.nodeName.toLowerCase()!==l.toLowerCase()){if(!m&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(m){if(!a[nt])switch(l){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(S=a.getAttribute("rel"),S==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(S!==b.rel||a.getAttribute("href")!==(b.href==null?null:b.href)||a.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||a.getAttribute("title")!==(b.title==null?null:b.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(S=a.getAttribute("src"),(S!==(b.src==null?null:b.src)||a.getAttribute("type")!==(b.type==null?null:b.type)||a.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&S&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(l==="input"&&a.type==="hidden"){var S=b.name==null?null:""+b.name;if(b.type==="hidden"&&a.getAttribute("name")===S)return a}else return a;if(a=jn(a.nextSibling),a===null)break}return null}function Rm(a,l,d){if(l==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!d||(a=jn(a.nextSibling),a===null))return null;return a}function jn(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?"||l==="F!"||l==="F")break;if(l==="/$")return null}}return a}function Bh(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(l===0)return a;l--}else d==="/$"&&l++}a=a.previousSibling}return null}function Hh(a,l,d){switch(l=Ta(d),a){case"html":if(a=l.documentElement,!a)throw Error(n(452));return a;case"head":if(a=l.head,!a)throw Error(n(453));return a;case"body":if(a=l.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}var In=new Map,zh=new Set;function Ra(a){return typeof a.getRootNode=="function"?a.getRootNode():a.ownerDocument}var ri=P.d;P.d={f:Cm,r:Om,D:Pm,C:km,L:Mm,m:Im,X:Lm,S:Dm,M:Nm};function Cm(){var a=ri.f(),l=ba();return a||l}function Om(a){var l=lt(a);l!==null&&l.tag===5&&l.type==="form"?gd(l):ri.r(a)}var Ss=typeof document>"u"?null:document;function qh(a,l,d){var m=Ss;if(m&&typeof l=="string"&&l){var b=Sn(l);b='link[rel="'+a+'"][href="'+b+'"]',typeof d=="string"&&(b+='[crossorigin="'+d+'"]'),zh.has(b)||(zh.add(b),a={rel:a,crossOrigin:d,href:l},m.querySelector(b)===null&&(l=m.createElement("link"),ln(l,"link",a),Pt(l),m.head.appendChild(l)))}}function Pm(a){ri.D(a),qh("dns-prefetch",a,null)}function km(a,l){ri.C(a,l),qh("preconnect",a,l)}function Mm(a,l,d){ri.L(a,l,d);var m=Ss;if(m&&a&&l){var b='link[rel="preload"][as="'+Sn(l)+'"]';l==="image"&&d&&d.imageSrcSet?(b+='[imagesrcset="'+Sn(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(b+='[imagesizes="'+Sn(d.imageSizes)+'"]')):b+='[href="'+Sn(a)+'"]';var S=b;switch(l){case"style":S=ws(a);break;case"script":S=As(a)}In.has(S)||(a=H({rel:"preload",href:l==="image"&&d&&d.imageSrcSet?void 0:a,as:l},d),In.set(S,a),m.querySelector(b)!==null||l==="style"&&m.querySelector(pr(S))||l==="script"&&m.querySelector(mr(S))||(l=m.createElement("link"),ln(l,"link",a),Pt(l),m.head.appendChild(l)))}}function Im(a,l){ri.m(a,l);var d=Ss;if(d&&a){var m=l&&typeof l.as=="string"?l.as:"script",b='link[rel="modulepreload"][as="'+Sn(m)+'"][href="'+Sn(a)+'"]',S=b;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=As(a)}if(!In.has(S)&&(a=H({rel:"modulepreload",href:a},l),In.set(S,a),d.querySelector(b)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(mr(S)))return}m=d.createElement("link"),ln(m,"link",a),Pt(m),d.head.appendChild(m)}}}function Dm(a,l,d){ri.S(a,l,d);var m=Ss;if(m&&a){var b=Ht(m).hoistableStyles,S=ws(a);l=l||"default";var j=b.get(S);if(!j){var K={loading:0,preload:null};if(j=m.querySelector(pr(S)))K.loading=5;else{a=H({rel:"stylesheet",href:a,"data-precedence":l},d),(d=In.get(S))&&Wl(a,d);var le=j=m.createElement("link");Pt(le),ln(le,"link",a),le._p=new Promise(function(Ee,ze){le.onload=Ee,le.onerror=ze}),le.addEventListener("load",function(){K.loading|=1}),le.addEventListener("error",function(){K.loading|=2}),K.loading|=4,Ca(j,l,m)}j={type:"stylesheet",instance:j,count:1,state:K},b.set(S,j)}}}function Lm(a,l){ri.X(a,l);var d=Ss;if(d&&a){var m=Ht(d).hoistableScripts,b=As(a),S=m.get(b);S||(S=d.querySelector(mr(b)),S||(a=H({src:a,async:!0},l),(l=In.get(b))&&Xl(a,l),S=d.createElement("script"),Pt(S),ln(S,"link",a),d.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},m.set(b,S))}}function Nm(a,l){ri.M(a,l);var d=Ss;if(d&&a){var m=Ht(d).hoistableScripts,b=As(a),S=m.get(b);S||(S=d.querySelector(mr(b)),S||(a=H({src:a,async:!0,type:"module"},l),(l=In.get(b))&&Xl(a,l),S=d.createElement("script"),Pt(S),ln(S,"link",a),d.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},m.set(b,S))}}function Vh(a,l,d,m){var b=(b=Ie.current)?Ra(b):null;if(!b)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(l=ws(d.href),d=Ht(b).hoistableStyles,m=d.get(l),m||(m={type:"style",instance:null,count:0,state:null},d.set(l,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){a=ws(d.href);var S=Ht(b).hoistableStyles,j=S.get(a);if(j||(b=b.ownerDocument||b,j={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(a,j),(S=b.querySelector(pr(a)))&&!S._p&&(j.instance=S,j.state.loading=5),In.has(a)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},In.set(a,d),S||Fm(b,a,d,j.state))),l&&m===null)throw Error(n(528,""));return j}if(l&&m!==null)throw Error(n(529,""));return null;case"script":return l=d.async,d=d.src,typeof d=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=As(d),d=Ht(b).hoistableScripts,m=d.get(l),m||(m={type:"script",instance:null,count:0,state:null},d.set(l,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function ws(a){return'href="'+Sn(a)+'"'}function pr(a){return'link[rel="stylesheet"]['+a+"]"}function Zh(a){return H({},a,{"data-precedence":a.precedence,precedence:null})}function Fm(a,l,d,m){a.querySelector('link[rel="preload"][as="style"]['+l+"]")?m.loading=1:(l=a.createElement("link"),m.preload=l,l.addEventListener("load",function(){return m.loading|=1}),l.addEventListener("error",function(){return m.loading|=2}),ln(l,"link",d),Pt(l),a.head.appendChild(l))}function As(a){return'[src="'+Sn(a)+'"]'}function mr(a){return"script[async]"+a}function Gh(a,l,d){if(l.count++,l.instance===null)switch(l.type){case"style":var m=a.querySelector('style[data-href~="'+Sn(d.href)+'"]');if(m)return l.instance=m,Pt(m),m;var b=H({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return m=(a.ownerDocument||a).createElement("style"),Pt(m),ln(m,"style",b),Ca(m,d.precedence,a),l.instance=m;case"stylesheet":b=ws(d.href);var S=a.querySelector(pr(b));if(S)return l.state.loading|=4,l.instance=S,Pt(S),S;m=Zh(d),(b=In.get(b))&&Wl(m,b),S=(a.ownerDocument||a).createElement("link"),Pt(S);var j=S;return j._p=new Promise(function(K,le){j.onload=K,j.onerror=le}),ln(S,"link",m),l.state.loading|=4,Ca(S,d.precedence,a),l.instance=S;case"script":return S=As(d.src),(b=a.querySelector(mr(S)))?(l.instance=b,Pt(b),b):(m=d,(b=In.get(S))&&(m=H({},d),Xl(m,b)),a=a.ownerDocument||a,b=a.createElement("script"),Pt(b),ln(b,"link",m),a.head.appendChild(b),l.instance=b);case"void":return null;default:throw Error(n(443,l.type))}else l.type==="stylesheet"&&!(l.state.loading&4)&&(m=l.instance,l.state.loading|=4,Ca(m,d.precedence,a));return l.instance}function Ca(a,l,d){for(var m=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=m.length?m[m.length-1]:null,S=b,j=0;j<m.length;j++){var K=m[j];if(K.dataset.precedence===l)S=K;else if(S!==b)break}S?S.parentNode.insertBefore(a,S.nextSibling):(l=d.nodeType===9?d.head:d,l.insertBefore(a,l.firstChild))}function Wl(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.title==null&&(a.title=l.title)}function Xl(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.integrity==null&&(a.integrity=l.integrity)}var Oa=null;function Wh(a,l,d){if(Oa===null){var m=new Map,b=Oa=new Map;b.set(d,m)}else b=Oa,m=b.get(d),m||(m=new Map,b.set(d,m));if(m.has(a))return m;for(m.set(a,null),d=d.getElementsByTagName(a),b=0;b<d.length;b++){var S=d[b];if(!(S[nt]||S[Qe]||a==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var j=S.getAttribute(l)||"";j=a+j;var K=m.get(j);K?K.push(S):m.set(j,[S])}}return m}function Xh(a,l,d){a=a.ownerDocument||a,a.head.insertBefore(d,l==="title"?a.querySelector("head > title"):null)}function jm(a,l,d){if(d===1||l.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return a=l.disabled,typeof l.precedence=="string"&&a==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function Yh(a){return!(a.type==="stylesheet"&&!(a.state.loading&3))}var gr=null;function $m(){}function Um(a,l,d){if(gr===null)throw Error(n(475));var m=gr;if(l.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&!(l.state.loading&4)){if(l.instance===null){var b=ws(d.href),S=a.querySelector(pr(b));if(S){a=S._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(m.count++,m=Pa.bind(m),a.then(m,m)),l.state.loading|=4,l.instance=S,Pt(S);return}S=a.ownerDocument||a,d=Zh(d),(b=In.get(b))&&Wl(d,b),S=S.createElement("link"),Pt(S);var j=S;j._p=new Promise(function(K,le){j.onload=K,j.onerror=le}),ln(S,"link",d),l.instance=S}m.stylesheets===null&&(m.stylesheets=new Map),m.stylesheets.set(l,a),(a=l.state.preload)&&!(l.state.loading&3)&&(m.count++,l=Pa.bind(m),a.addEventListener("load",l),a.addEventListener("error",l))}}function Bm(){if(gr===null)throw Error(n(475));var a=gr;return a.stylesheets&&a.count===0&&Yl(a,a.stylesheets),0<a.count?function(l){var d=setTimeout(function(){if(a.stylesheets&&Yl(a,a.stylesheets),a.unsuspend){var m=a.unsuspend;a.unsuspend=null,m()}},6e4);return a.unsuspend=l,function(){a.unsuspend=null,clearTimeout(d)}}:null}function Pa(){if(this.count--,this.count===0){if(this.stylesheets)Yl(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var ka=null;function Yl(a,l){a.stylesheets=null,a.unsuspend!==null&&(a.count++,ka=new Map,l.forEach(Hm,a),ka=null,Pa.call(a))}function Hm(a,l){if(!(l.state.loading&4)){var d=ka.get(a);if(d)var m=d.get(null);else{d=new Map,ka.set(a,d);for(var b=a.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<b.length;S++){var j=b[S];(j.nodeName==="LINK"||j.getAttribute("media")!=="not all")&&(d.set(j.dataset.precedence,j),m=j)}m&&d.set(null,m)}b=l.instance,j=b.getAttribute("data-precedence"),S=d.get(j)||m,S===m&&d.set(null,b),d.set(j,b),this.count++,m=Pa.bind(this),b.addEventListener("load",m),b.addEventListener("error",m),S?S.parentNode.insertBefore(b,S.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(b,a.firstChild)),l.state.loading|=4}}var yr={$$typeof:v,Provider:null,Consumer:null,_currentValue:$,_currentValue2:$,_threadCount:0};function zm(a,l,d,m,b,S,j,K){this.tag=1,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ue(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ue(0),this.hiddenUpdates=ue(null),this.identifierPrefix=m,this.onUncaughtError=b,this.onCaughtError=S,this.onRecoverableError=j,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=K,this.incompleteTransitions=new Map}function Kh(a,l,d,m,b,S,j,K,le,Ee,ze,Xe){return a=new zm(a,l,d,j,K,le,Ee,Xe),l=1,S===!0&&(l|=24),S=kn(3,null,null,l),a.current=S,S.stateNode=a,l=Co(),l.refCount++,a.pooledCache=l,l.refCount++,S.memoizedState={element:m,isDehydrated:d,cache:l},ll(S),a}function Jh(a){return a?(a=is,a):is}function Qh(a,l,d,m,b,S){b=Jh(b),m.context===null?m.context=b:m.pendingContext=b,m=mi(l),m.payload={element:d},S=S===void 0?null:S,S!==null&&(m.callback=S),d=gi(a,m,l),d!==null&&(dn(d,a,l),er(d,a,l))}function ef(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<l?d:l}}function Kl(a,l){ef(a,l),(a=a.alternate)&&ef(a,l)}function tf(a){if(a.tag===13){var l=li(a,67108864);l!==null&&dn(l,a,67108864),Kl(a,67108864)}}var Ma=!0;function qm(a,l,d,m){var b=L.T;L.T=null;var S=P.p;try{P.p=2,Jl(a,l,d,m)}finally{P.p=S,L.T=b}}function Vm(a,l,d,m){var b=L.T;L.T=null;var S=P.p;try{P.p=8,Jl(a,l,d,m)}finally{P.p=S,L.T=b}}function Jl(a,l,d,m){if(Ma){var b=Ql(m);if(b===null)Ul(a,l,m,Ia,d),sf(a,m);else if(Gm(b,a,l,d,m))m.stopPropagation();else if(sf(a,m),l&4&&-1<Zm.indexOf(a)){for(;b!==null;){var S=lt(b);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var j=Ve(S.pendingLanes);if(j!==0){var K=S;for(K.pendingLanes|=2,K.entangledLanes|=2;j;){var le=1<<31-ye(j);K.entanglements[1]|=le,j&=~le}zn(S),!(qt&6)&&(ma=Le()+500,dr(0))}}break;case 13:K=li(S,2),K!==null&&dn(K,S,2),ba(),Kl(S,2)}if(S=Ql(m),S===null&&Ul(a,l,m,Ia,d),S===b)break;b=S}b!==null&&m.stopPropagation()}else Ul(a,l,m,null,d)}}function Ql(a){return a=so(a),ec(a)}var Ia=null;function ec(a){if(Ia=null,a=We(a),a!==null){var l=ne(a);if(l===null)a=null;else{var d=l.tag;if(d===13){if(a=B(l),a!==null)return a;a=null}else if(d===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null)}}return Ia=a,null}function nf(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(pe()){case Ge:return 2;case qe:return 8;case pt:case dt:return 32;case Et:return 268435456;default:return 32}default:return 32}}var tc=!1,Si=null,wi=null,Ai=null,br=new Map,_r=new Map,Ti=[],Zm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function sf(a,l){switch(a){case"focusin":case"focusout":Si=null;break;case"dragenter":case"dragleave":wi=null;break;case"mouseover":case"mouseout":Ai=null;break;case"pointerover":case"pointerout":br.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":_r.delete(l.pointerId)}}function vr(a,l,d,m,b,S){return a===null||a.nativeEvent!==S?(a={blockedOn:l,domEventName:d,eventSystemFlags:m,nativeEvent:S,targetContainers:[b]},l!==null&&(l=lt(l),l!==null&&tf(l)),a):(a.eventSystemFlags|=m,l=a.targetContainers,b!==null&&l.indexOf(b)===-1&&l.push(b),a)}function Gm(a,l,d,m,b){switch(l){case"focusin":return Si=vr(Si,a,l,d,m,b),!0;case"dragenter":return wi=vr(wi,a,l,d,m,b),!0;case"mouseover":return Ai=vr(Ai,a,l,d,m,b),!0;case"pointerover":var S=b.pointerId;return br.set(S,vr(br.get(S)||null,a,l,d,m,b)),!0;case"gotpointercapture":return S=b.pointerId,_r.set(S,vr(_r.get(S)||null,a,l,d,m,b)),!0}return!1}function rf(a){var l=We(a.target);if(l!==null){var d=ne(l);if(d!==null){if(l=d.tag,l===13){if(l=B(d),l!==null){a.blockedOn=l,Ye(a.priority,function(){if(d.tag===13){var m=vn(),b=li(d,m);b!==null&&dn(b,d,m),Kl(d,m)}});return}}else if(l===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Da(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var d=Ql(a.nativeEvent);if(d===null){d=a.nativeEvent;var m=new d.constructor(d.type,d);io=m,d.target.dispatchEvent(m),io=null}else return l=lt(d),l!==null&&tf(l),a.blockedOn=d,!1;l.shift()}return!0}function af(a,l,d){Da(a)&&d.delete(l)}function Wm(){tc=!1,Si!==null&&Da(Si)&&(Si=null),wi!==null&&Da(wi)&&(wi=null),Ai!==null&&Da(Ai)&&(Ai=null),br.forEach(af),_r.forEach(af)}function La(a,l){a.blockedOn===l&&(a.blockedOn=null,tc||(tc=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,Wm)))}var Na=null;function of(a){Na!==a&&(Na=a,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Na===a&&(Na=null);for(var l=0;l<a.length;l+=3){var d=a[l],m=a[l+1],b=a[l+2];if(typeof m!="function"){if(ec(m||d)===null)continue;break}var S=lt(d);S!==null&&(a.splice(l,3),l-=3,qo(S,{pending:!0,data:b,method:d.method,action:m},m,b))}}))}function xr(a){function l(le){return La(le,a)}Si!==null&&La(Si,a),wi!==null&&La(wi,a),Ai!==null&&La(Ai,a),br.forEach(l),_r.forEach(l);for(var d=0;d<Ti.length;d++){var m=Ti[d];m.blockedOn===a&&(m.blockedOn=null)}for(;0<Ti.length&&(d=Ti[0],d.blockedOn===null);)rf(d),d.blockedOn===null&&Ti.shift();if(d=(a.ownerDocument||a).$$reactFormReplay,d!=null)for(m=0;m<d.length;m+=3){var b=d[m],S=d[m+1],j=b[Ke]||null;if(typeof S=="function")j||of(d);else if(j){var K=null;if(S&&S.hasAttribute("formAction")){if(b=S,j=S[Ke]||null)K=j.formAction;else if(ec(b)!==null)continue}else K=j.action;typeof K=="function"?d[m+1]=K:(d.splice(m,3),m-=3),of(d)}}}function nc(a){this._internalRoot=a}Fa.prototype.render=nc.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(n(409));var d=l.current,m=vn();Qh(d,m,a,l,null,null)},Fa.prototype.unmount=nc.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;a.tag===0&&vs(),Qh(a.current,2,null,a,null,null),ba(),l[ut]=null}};function Fa(a){this._internalRoot=a}Fa.prototype.unstable_scheduleHydration=function(a){if(a){var l=st();a={blockedOn:null,target:a,priority:l};for(var d=0;d<Ti.length&&l!==0&&l<Ti[d].priority;d++);Ti.splice(d,0,a),d===0&&rf(a)}};var lf=e.version;if(lf!=="19.0.0")throw Error(n(527,lf,"19.0.0"));P.findDOMNode=function(a){var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=Y(l),a=a!==null?U(a):null,a=a===null?null:a.stateNode,a};var Xm={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:L,findFiberByHostInstance:We,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ja=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ja.isDisabled&&ja.supportsFiber)try{yt=ja.inject(Xm),mt=ja}catch{}}return reactDomClient_production.createRoot=function(a,l){if(!r(a))throw Error(n(299));var d=!1,m="",b=wd,S=Ad,j=Td,K=null;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(b=l.onUncaughtError),l.onCaughtError!==void 0&&(S=l.onCaughtError),l.onRecoverableError!==void 0&&(j=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(K=l.unstable_transitionCallbacks)),l=Kh(a,1,!1,null,null,d,m,b,S,j,K,null),a[ut]=l.current,$l(a.nodeType===8?a.parentNode:a),new nc(l)},reactDomClient_production.hydrateRoot=function(a,l,d){if(!r(a))throw Error(n(299));var m=!1,b="",S=wd,j=Ad,K=Td,le=null,Ee=null;return d!=null&&(d.unstable_strictMode===!0&&(m=!0),d.identifierPrefix!==void 0&&(b=d.identifierPrefix),d.onUncaughtError!==void 0&&(S=d.onUncaughtError),d.onCaughtError!==void 0&&(j=d.onCaughtError),d.onRecoverableError!==void 0&&(K=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(le=d.unstable_transitionCallbacks),d.formState!==void 0&&(Ee=d.formState)),l=Kh(a,1,!0,l,d??null,m,b,S,j,K,le,Ee),l.context=Jh(null),d=l.current,m=vn(),b=mi(m),b.callback=null,gi(d,b,m),l.current.lanes=m,Ae(l,m),zn(l),a[ut]=l.current,$l(a),new Fa(l)},reactDomClient_production.version="19.0.0",reactDomClient_production}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client$1.exports;hasRequiredClient=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),client$1.exports=requireReactDomClient_production(),client$1.exports}var clientExports=requireClient(),dist$1={},hasRequiredDist$1;function requireDist$1(){if(hasRequiredDist$1)return dist$1;hasRequiredDist$1=1,Object.defineProperty(dist$1,"__esModule",{value:!0}),dist$1.parse=c,dist$1.serialize=f;const s=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,r=Object.prototype.toString,o=(()=>{const y=function(){};return y.prototype=Object.create(null),y})();function c(y,v){const _=new o,E=y.length;if(E<2)return _;const x=(v==null?void 0:v.decode)||p;let w=0;do{const T=y.indexOf("=",w);if(T===-1)break;const O=y.indexOf(";",w),N=O===-1?E:O;if(T>N){w=y.lastIndexOf(";",T-1)+1;continue}const A=u(y,w,T),I=h(y,T,A),k=y.slice(A,I);if(_[k]===void 0){let M=u(y,T+1,N),L=h(y,N,M);const H=x(y.slice(M,L));_[k]=H}w=N+1}while(w<E);return _}function u(y,v,_){do{const E=y.charCodeAt(v);if(E!==32&&E!==9)return v}while(++v<_);return _}function h(y,v,_){for(;v>_;){const E=y.charCodeAt(--v);if(E!==32&&E!==9)return v+1}return _}function f(y,v,_){const E=(_==null?void 0:_.encode)||encodeURIComponent;if(!s.test(y))throw new TypeError(`argument name is invalid: ${y}`);const x=E(v);if(!e.test(x))throw new TypeError(`argument val is invalid: ${v}`);let w=y+"="+x;if(!_)return w;if(_.maxAge!==void 0){if(!Number.isInteger(_.maxAge))throw new TypeError(`option maxAge is invalid: ${_.maxAge}`);w+="; Max-Age="+_.maxAge}if(_.domain){if(!t.test(_.domain))throw new TypeError(`option domain is invalid: ${_.domain}`);w+="; Domain="+_.domain}if(_.path){if(!n.test(_.path))throw new TypeError(`option path is invalid: ${_.path}`);w+="; Path="+_.path}if(_.expires){if(!g(_.expires)||!Number.isFinite(_.expires.valueOf()))throw new TypeError(`option expires is invalid: ${_.expires}`);w+="; Expires="+_.expires.toUTCString()}if(_.httpOnly&&(w+="; HttpOnly"),_.secure&&(w+="; Secure"),_.partitioned&&(w+="; Partitioned"),_.priority)switch(typeof _.priority=="string"?_.priority.toLowerCase():void 0){case"low":w+="; Priority=Low";break;case"medium":w+="; Priority=Medium";break;case"high":w+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${_.priority}`)}if(_.sameSite)switch(typeof _.sameSite=="string"?_.sameSite.toLowerCase():_.sameSite){case!0:case"strict":w+="; SameSite=Strict";break;case"lax":w+="; SameSite=Lax";break;case"none":w+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${_.sameSite}`)}return w}function p(y){if(y.indexOf("%")===-1)return y;try{return decodeURIComponent(y)}catch{return y}}function g(y){return r.call(y)==="[object Date]"}return dist$1}requireDist$1();/**
 * react-router v7.1.5
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var PopStateEventType="popstate";function createBrowserHistory(s={}){function e(n,r){let{pathname:o,search:c,hash:u}=n.location;return createLocation("",{pathname:o,search:c,hash:u},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(n,r){return typeof r=="string"?r:createPath(r)}return getUrlBasedHistory(e,t,null,s)}function invariant(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function warning(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function createKey(){return Math.random().toString(36).substring(2,10)}function getHistoryState(s,e){return{usr:s.state,key:s.key,idx:e}}function createLocation(s,e,t=null,n){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?parsePath(e):e,state:t,key:e&&e.key||n||createKey()}}function createPath({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function parsePath(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let n=s.indexOf("?");n>=0&&(e.search=s.substring(n),s=s.substring(0,n)),s&&(e.pathname=s)}return e}function getUrlBasedHistory(s,e,t,n={}){let{window:r=document.defaultView,v5Compat:o=!1}=n,c=r.history,u="POP",h=null,f=p();f==null&&(f=0,c.replaceState({...c.state,idx:f},""));function p(){return(c.state||{idx:null}).idx}function g(){u="POP";let x=p(),w=x==null?null:x-f;f=x,h&&h({action:u,location:E.location,delta:w})}function y(x,w){u="PUSH";let T=createLocation(E.location,x,w);f=p()+1;let O=getHistoryState(T,f),N=E.createHref(T);try{c.pushState(O,"",N)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;r.location.assign(N)}o&&h&&h({action:u,location:E.location,delta:1})}function v(x,w){u="REPLACE";let T=createLocation(E.location,x,w);f=p();let O=getHistoryState(T,f),N=E.createHref(T);c.replaceState(O,"",N),o&&h&&h({action:u,location:E.location,delta:0})}function _(x){let w=r.location.origin!=="null"?r.location.origin:r.location.href,T=typeof x=="string"?x:createPath(x);return T=T.replace(/ $/,"%20"),invariant(w,`No window.location.(origin|href) available to create URL for href: ${T}`),new URL(T,w)}let E={get action(){return u},get location(){return s(r,c)},listen(x){if(h)throw new Error("A history only accepts one active listener");return r.addEventListener(PopStateEventType,g),h=x,()=>{r.removeEventListener(PopStateEventType,g),h=null}},createHref(x){return e(r,x)},createURL:_,encodeLocation(x){let w=_(x);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:y,replace:v,go(x){return c.go(x)}};return E}function matchRoutes(s,e,t="/"){return matchRoutesImpl(s,e,t,!1)}function matchRoutesImpl(s,e,t,n){let r=typeof e=="string"?parsePath(e):e,o=stripBasename(r.pathname||"/",t);if(o==null)return null;let c=flattenRoutes(s);rankRouteBranches(c);let u=null;for(let h=0;u==null&&h<c.length;++h){let f=decodePath(o);u=matchRouteBranch(c[h],f,n)}return u}function flattenRoutes(s,e=[],t=[],n=""){let r=(o,c,u)=>{let h={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};h.relativePath.startsWith("/")&&(invariant(h.relativePath.startsWith(n),`Absolute route path "${h.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(n.length));let f=joinPaths([n,h.relativePath]),p=t.concat(h);o.children&&o.children.length>0&&(invariant(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),flattenRoutes(o.children,e,p,f)),!(o.path==null&&!o.index)&&e.push({path:f,score:computeScore(f,o.index),routesMeta:p})};return s.forEach((o,c)=>{var u;if(o.path===""||!((u=o.path)!=null&&u.includes("?")))r(o,c);else for(let h of explodeOptionalSegments(o.path))r(o,c,h)}),e}function explodeOptionalSegments(s){let e=s.split("/");if(e.length===0)return[];let[t,...n]=e,r=t.endsWith("?"),o=t.replace(/\?$/,"");if(n.length===0)return r?[o,""]:[o];let c=explodeOptionalSegments(n.join("/")),u=[];return u.push(...c.map(h=>h===""?o:[o,h].join("/"))),r&&u.push(...c),u.map(h=>s.startsWith("/")&&h===""?"/":h)}function rankRouteBranches(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:compareIndexes(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=s=>s==="*";function computeScore(s,e){let t=s.split("/"),n=t.length;return t.some(isSplat)&&(n+=splatPenalty),e&&(n+=indexRouteValue),t.filter(r=>!isSplat(r)).reduce((r,o)=>r+(paramRe.test(o)?dynamicSegmentValue:o===""?emptySegmentValue:staticSegmentValue),n)}function compareIndexes(s,e){return s.length===e.length&&s.slice(0,-1).every((n,r)=>n===e[r])?s[s.length-1]-e[e.length-1]:0}function matchRouteBranch(s,e,t=!1){let{routesMeta:n}=s,r={},o="/",c=[];for(let u=0;u<n.length;++u){let h=n[u],f=u===n.length-1,p=o==="/"?e:e.slice(o.length)||"/",g=matchPath({path:h.relativePath,caseSensitive:h.caseSensitive,end:f},p),y=h.route;if(!g&&f&&t&&!n[n.length-1].route.index&&(g=matchPath({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},p)),!g)return null;Object.assign(r,g.params),c.push({params:r,pathname:joinPaths([o,g.pathname]),pathnameBase:normalizePathname(joinPaths([o,g.pathnameBase])),route:y}),g.pathnameBase!=="/"&&(o=joinPaths([o,g.pathnameBase]))}return c}function matchPath(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,n]=compilePath(s.path,s.caseSensitive,s.end),r=e.match(t);if(!r)return null;let o=r[0],c=o.replace(/(.)\/+$/,"$1"),u=r.slice(1);return{params:n.reduce((f,{paramName:p,isOptional:g},y)=>{if(p==="*"){let _=u[y]||"";c=o.slice(0,o.length-_.length).replace(/(.)\/+$/,"$1")}const v=u[y];return g&&!v?f[p]=void 0:f[p]=(v||"").replace(/%2F/g,"/"),f},{}),pathname:o,pathnameBase:c,pattern:s}}function compilePath(s,e=!1,t=!0){warning(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let n=[],r="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,h)=>(n.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(n.push({paramName:"*"}),r+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":s!==""&&s!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),n]}function decodePath(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return warning(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function stripBasename(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=s.charAt(t);return n&&n!=="/"?null:s.slice(t)||"/"}function resolvePath(s,e="/"){let{pathname:t,search:n="",hash:r=""}=typeof s=="string"?parsePath(s):s;return{pathname:t?t.startsWith("/")?t:resolvePathname(t,e):e,search:normalizeSearch(n),hash:normalizeHash(r)}}function resolvePathname(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function getInvalidPathError(s,e,t,n){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function getResolveToMatches(s){let e=getPathContributingMatches(s);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function resolveTo(s,e,t,n=!1){let r;typeof s=="string"?r=parsePath(s):(r={...s},invariant(!r.pathname||!r.pathname.includes("?"),getInvalidPathError("?","pathname","search",r)),invariant(!r.pathname||!r.pathname.includes("#"),getInvalidPathError("#","pathname","hash",r)),invariant(!r.search||!r.search.includes("#"),getInvalidPathError("#","search","hash",r)));let o=s===""||r.pathname==="",c=o?"/":r.pathname,u;if(c==null)u=t;else{let g=e.length-1;if(!n&&c.startsWith("..")){let y=c.split("/");for(;y[0]==="..";)y.shift(),g-=1;r.pathname=y.join("/")}u=g>=0?e[g]:"/"}let h=resolvePath(r,u),f=c&&c!=="/"&&c.endsWith("/"),p=(o||c===".")&&t.endsWith("/");return!h.pathname.endsWith("/")&&(f||p)&&(h.pathname+="/"),h}var joinPaths=s=>s.join("/").replace(/\/\/+/g,"/"),normalizePathname=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,normalizeHash=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function isRouteErrorResponse(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=reactExports.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=reactExports.createContext(null);DataRouterStateContext.displayName="DataRouterState";var ViewTransitionContext=reactExports.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=reactExports.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=reactExports.createContext(null);AwaitContext.displayName="Await";var NavigationContext=reactExports.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=reactExports.createContext(null);LocationContext.displayName="Location";var RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=reactExports.createContext(null);RouteErrorContext.displayName="RouteError";function useHref(s,{relative:e}={}){invariant(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=reactExports.useContext(NavigationContext),{hash:r,pathname:o,search:c}=useResolvedPath(s,{relative:e}),u=o;return t!=="/"&&(u=o==="/"?t:joinPaths([t,o])),n.createHref({pathname:u,search:c,hash:r})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return invariant(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),reactExports.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect(s){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(s)}function useNavigate(){let{isDataRoute:s}=reactExports.useContext(RouteContext);return s?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let s=reactExports.useContext(DataRouterContext),{basename:e,navigator:t}=reactExports.useContext(NavigationContext),{matches:n}=reactExports.useContext(RouteContext),{pathname:r}=useLocation(),o=JSON.stringify(getResolveToMatches(n)),c=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{c.current=!0}),reactExports.useCallback((h,f={})=>{if(warning(c.current,navigateEffectWarning),!c.current)return;if(typeof h=="number"){t.go(h);return}let p=resolveTo(h,JSON.parse(o),r,f.relative==="path");s==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:joinPaths([e,p.pathname])),(f.replace?t.replace:t.push)(p,f.state,f)},[e,t,o,r,s])}reactExports.createContext(null);function useResolvedPath(s,{relative:e}={}){let{matches:t}=reactExports.useContext(RouteContext),{pathname:n}=useLocation(),r=JSON.stringify(getResolveToMatches(t));return reactExports.useMemo(()=>resolveTo(s,JSON.parse(r),n,e==="path"),[s,r,n,e])}function useRoutes(s,e){return useRoutesImpl(s,e)}function useRoutesImpl(s,e,t,n){var T;invariant(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r,static:o}=reactExports.useContext(NavigationContext),{matches:c}=reactExports.useContext(RouteContext),u=c[c.length-1],h=u?u.params:{},f=u?u.pathname:"/",p=u?u.pathnameBase:"/",g=u&&u.route;{let O=g&&g.path||"";warningOnce(f,!g||O.endsWith("*")||O.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${O}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${O}"> to <Route path="${O==="/"?"*":`${O}/*`}">.`)}let y=useLocation(),v;if(e){let O=typeof e=="string"?parsePath(e):e;invariant(p==="/"||((T=O.pathname)==null?void 0:T.startsWith(p)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${O.pathname}" was given in the \`location\` prop.`),v=O}else v=y;let _=v.pathname||"/",E=_;if(p!=="/"){let O=p.replace(/^\//,"").split("/");E="/"+_.replace(/^\//,"").split("/").slice(O.length).join("/")}let x=!o&&t&&t.matches&&t.matches.length>0?t.matches:matchRoutes(s,{pathname:E});warning(g||x!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),warning(x==null||x[x.length-1].route.element!==void 0||x[x.length-1].route.Component!==void 0||x[x.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=_renderMatches(x&&x.map(O=>Object.assign({},O,{params:Object.assign({},h,O.params),pathname:joinPaths([p,r.encodeLocation?r.encodeLocation(O.pathname).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?p:joinPaths([p,r.encodeLocation?r.encodeLocation(O.pathnameBase).pathname:O.pathnameBase])})),c,t,n);return e&&w?reactExports.createElement(LocationContext.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},w):w}function DefaultErrorComponent(){let s=useRouteError(),e=isRouteErrorResponse(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,n="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:n},o={padding:"2px 4px",backgroundColor:n},c=null;return console.error("Error handled by React Router default ErrorBoundary:",s),c=reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("p",null," Hey developer "),reactExports.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",reactExports.createElement("code",{style:o},"ErrorBoundary")," or"," ",reactExports.createElement("code",{style:o},"errorElement")," prop on your route.")),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},e),t?reactExports.createElement("pre",{style:r},t):null,c)}var defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends reactExports.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){console.error("React Router caught the following error during render",s,e)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:s,match:e,children:t}){let n=reactExports.useContext(DataRouterContext);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),reactExports.createElement(RouteContext.Provider,{value:s},t)}function _renderMatches(s,e=[],t=null,n=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let r=s,o=t==null?void 0:t.errors;if(o!=null){let h=r.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);invariant(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),r=r.slice(0,Math.min(r.length,h+1))}let c=!1,u=-1;if(t)for(let h=0;h<r.length;h++){let f=r[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=h),f.route.id){let{loaderData:p,errors:g}=t,y=f.route.loader&&!p.hasOwnProperty(f.route.id)&&(!g||g[f.route.id]===void 0);if(f.route.lazy||y){c=!0,u>=0?r=r.slice(0,u+1):r=[r[0]];break}}}return r.reduceRight((h,f,p)=>{let g,y=!1,v=null,_=null;t&&(g=o&&f.route.id?o[f.route.id]:void 0,v=f.route.errorElement||defaultErrorElement,c&&(u<0&&p===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,_=null):u===p&&(y=!0,_=f.route.hydrateFallbackElement||null)));let E=e.concat(r.slice(0,p+1)),x=()=>{let w;return g?w=v:y?w=_:f.route.Component?w=reactExports.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=h,reactExports.createElement(RenderedRoute,{match:f,routeContext:{outlet:h,matches:E,isDataRoute:t!=null},children:w})};return t&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?reactExports.createElement(RenderErrorBoundary,{location:t.location,revalidation:t.revalidation,component:v,error:g,children:x(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):x()},null)}function getDataRouterConsoleError(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(s){let e=reactExports.useContext(DataRouterContext);return invariant(e,getDataRouterConsoleError(s)),e}function useDataRouterState(s){let e=reactExports.useContext(DataRouterStateContext);return invariant(e,getDataRouterConsoleError(s)),e}function useRouteContext(s){let e=reactExports.useContext(RouteContext);return invariant(e,getDataRouterConsoleError(s)),e}function useCurrentRouteId(s){let e=useRouteContext(s),t=e.matches[e.matches.length-1];return invariant(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){var n;let s=reactExports.useContext(RouteErrorContext),e=useDataRouterState("useRouteError"),t=useCurrentRouteId("useRouteError");return s!==void 0?s:(n=e.errors)==null?void 0:n[t]}function useNavigateStable(){let{router:s}=useDataRouterContext("useNavigate"),e=useCurrentRouteId("useNavigate"),t=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{t.current=!0}),reactExports.useCallback(async(r,o={})=>{warning(t.current,navigateEffectWarning),t.current&&(typeof r=="number"?s.navigate(r):await s.navigate(r,{fromRouteId:e,...o}))},[s,e])}var alreadyWarned={};function warningOnce(s,e,t){!e&&!alreadyWarned[s]&&(alreadyWarned[s]=!0,warning(!1,t))}reactExports.memo(DataRoutes);function DataRoutes({routes:s,future:e,state:t}){return useRoutesImpl(s,void 0,t,e)}function Navigate({to:s,replace:e,state:t,relative:n}){invariant(useInRouterContext(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=reactExports.useContext(NavigationContext);warning(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=reactExports.useContext(RouteContext),{pathname:c}=useLocation(),u=useNavigate(),h=resolveTo(s,getResolveToMatches(o),c,n==="path"),f=JSON.stringify(h);return reactExports.useEffect(()=>{u(JSON.parse(f),{replace:e,state:t,relative:n})},[u,f,n,e,t]),null}function Route(s){invariant(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Router({basename:s="/",children:e=null,location:t,navigationType:n="POP",navigator:r,static:o=!1}){invariant(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=s.replace(/^\/*/,"/"),u=reactExports.useMemo(()=>({basename:c,navigator:r,static:o,future:{}}),[c,r,o]);typeof t=="string"&&(t=parsePath(t));let{pathname:h="/",search:f="",hash:p="",state:g=null,key:y="default"}=t,v=reactExports.useMemo(()=>{let _=stripBasename(h,c);return _==null?null:{location:{pathname:_,search:f,hash:p,state:g,key:y},navigationType:n}},[c,h,f,p,g,y,n]);return warning(v!=null,`<Router basename="${c}"> is not able to match the URL "${h}${f}${p}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:reactExports.createElement(NavigationContext.Provider,{value:u},reactExports.createElement(LocationContext.Provider,{children:e,value:v}))}function Routes({children:s,location:e}){return useRoutes(createRoutesFromChildren(s),e)}function createRoutesFromChildren(s,e=[]){let t=[];return reactExports.Children.forEach(s,(n,r)=>{if(!reactExports.isValidElement(n))return;let o=[...e,r];if(n.type===reactExports.Fragment){t.push.apply(t,createRoutesFromChildren(n.props.children,o));return}invariant(n.type===Route,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),invariant(!n.props.index||!n.props.children,"An index route cannot have child routes.");let c={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(c.children=createRoutesFromChildren(n.props.children,o)),t.push(c)}),t}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement(s){return s!=null&&typeof s.tagName=="string"}function isButtonElement(s){return isHtmlElement(s)&&s.tagName.toLowerCase()==="button"}function isFormElement(s){return isHtmlElement(s)&&s.tagName.toLowerCase()==="form"}function isInputElement(s){return isHtmlElement(s)&&s.tagName.toLowerCase()==="input"}function isModifiedEvent(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function shouldProcessLinkClick(s,e){return s.button===0&&(!e||e==="_self")&&!isModifiedEvent(s)}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch{_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(s){return s!=null&&!supportedFormEncTypes.has(s)?(warning(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):s}function getFormSubmissionInfo(s,e){let t,n,r,o,c;if(isFormElement(s)){let u=s.getAttribute("action");n=u?stripBasename(u,e):null,t=s.getAttribute("method")||defaultMethod,r=getFormEncType(s.getAttribute("enctype"))||defaultEncType,o=new FormData(s)}else if(isButtonElement(s)||isInputElement(s)&&(s.type==="submit"||s.type==="image")){let u=s.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=s.getAttribute("formaction")||u.getAttribute("action");if(n=h?stripBasename(h,e):null,t=s.getAttribute("formmethod")||u.getAttribute("method")||defaultMethod,r=getFormEncType(s.getAttribute("formenctype"))||getFormEncType(u.getAttribute("enctype"))||defaultEncType,o=new FormData(u,s),!isFormDataSubmitterSupported()){let{name:f,type:p,value:g}=s;if(p==="image"){let y=f?`${f}.`:"";o.append(`${y}x`,"0"),o.append(`${y}y`,"0")}else f&&o.append(f,g)}}else{if(isHtmlElement(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=defaultMethod,n=null,r=defaultEncType,c=s}return o&&r==="text/plain"&&(c=o,o=void 0),{action:n,method:t.toLowerCase(),encType:r,formData:o,body:c}}function invariant2(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}async function loadRouteModule(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function isHtmlLinkDescriptor(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function getKeyedPrefetchLinks(s,e,t){let n=await Promise.all(s.map(async r=>{let o=e.routes[r.route.id];if(o){let c=await loadRouteModule(o,t);return c.links?c.links():[]}return[]}));return dedupeLinkDescriptors(n.flat(1).filter(isHtmlLinkDescriptor).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function getNewMatchesForLinks(s,e,t,n,r,o){let c=(h,f)=>t[f]?h.route.id!==t[f].route.id:!0,u=(h,f)=>{var p;return t[f].pathname!==h.pathname||((p=t[f].route.path)==null?void 0:p.endsWith("*"))&&t[f].params["*"]!==h.params["*"]};return o==="assets"?e.filter((h,f)=>c(h,f)||u(h,f)):o==="data"?e.filter((h,f)=>{var g;let p=n.routes[h.route.id];if(!p||!p.hasLoader)return!1;if(c(h,f)||u(h,f))return!0;if(h.route.shouldRevalidate){let y=h.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((g=t[0])==null?void 0:g.params)||{},nextUrl:new URL(s,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function getModuleLinkHrefs(s,e){return dedupeHrefs(s.map(t=>{let n=e.routes[t.route.id];if(!n)return[];let r=[n.module];return n.imports&&(r=r.concat(n.imports)),r}).flat(1))}function dedupeHrefs(s){return[...new Set(s)]}function sortKeys(s){let e={},t=Object.keys(s).sort();for(let n of t)e[n]=s[n];return e}function dedupeLinkDescriptors(s,e){let t=new Set;return new Set(e),s.reduce((n,r)=>{let o=JSON.stringify(sortKeys(r));return t.has(o)||(t.add(o),n.push({key:o,link:r})),n},[])}function singleFetchUrl(s){let e=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function useDataRouterContext2(){let s=reactExports.useContext(DataRouterContext);return invariant2(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function useDataRouterStateContext(){let s=reactExports.useContext(DataRouterStateContext);return invariant2(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var FrameworkContext=reactExports.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let s=reactExports.useContext(FrameworkContext);return invariant2(s,"You must render this element inside a <HydratedRouter> element"),s}function usePrefetchBehavior(s,e){let t=reactExports.useContext(FrameworkContext),[n,r]=reactExports.useState(!1),[o,c]=reactExports.useState(!1),{onFocus:u,onBlur:h,onMouseEnter:f,onMouseLeave:p,onTouchStart:g}=e,y=reactExports.useRef(null);reactExports.useEffect(()=>{if(s==="render"&&c(!0),s==="viewport"){let E=w=>{w.forEach(T=>{c(T.isIntersecting)})},x=new IntersectionObserver(E,{threshold:.5});return y.current&&x.observe(y.current),()=>{x.disconnect()}}},[s]),reactExports.useEffect(()=>{if(n){let E=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(E)}}},[n]);let v=()=>{r(!0)},_=()=>{r(!1),c(!1)};return t?s!=="intent"?[o,y,{}]:[o,y,{onFocus:composeEventHandlers(u,v),onBlur:composeEventHandlers(h,_),onMouseEnter:composeEventHandlers(f,v),onMouseLeave:composeEventHandlers(p,_),onTouchStart:composeEventHandlers(g,v)}]:[!1,y,{}]}function composeEventHandlers(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function PrefetchPageLinks({page:s,...e}){let{router:t}=useDataRouterContext2(),n=reactExports.useMemo(()=>matchRoutes(t.routes,s,t.basename),[t.routes,s,t.basename]);return n?reactExports.createElement(PrefetchPageLinksImpl,{page:s,matches:n,...e}):null}function useKeyedPrefetchLinks(s){let{manifest:e,routeModules:t}=useFrameworkContext(),[n,r]=reactExports.useState([]);return reactExports.useEffect(()=>{let o=!1;return getKeyedPrefetchLinks(s,e,t).then(c=>{o||r(c)}),()=>{o=!0}},[s,e,t]),n}function PrefetchPageLinksImpl({page:s,matches:e,...t}){let n=useLocation(),{manifest:r,routeModules:o}=useFrameworkContext(),{loaderData:c,matches:u}=useDataRouterStateContext(),h=reactExports.useMemo(()=>getNewMatchesForLinks(s,e,u,r,n,"data"),[s,e,u,r,n]),f=reactExports.useMemo(()=>getNewMatchesForLinks(s,e,u,r,n,"assets"),[s,e,u,r,n]),p=reactExports.useMemo(()=>{if(s===n.pathname+n.search+n.hash)return[];let v=new Set,_=!1;if(e.forEach(x=>{var T;let w=r.routes[x.route.id];!w||!w.hasLoader||(!h.some(O=>O.route.id===x.route.id)&&x.route.id in c&&((T=o[x.route.id])!=null&&T.shouldRevalidate)||w.hasClientLoader?_=!0:v.add(x.route.id))}),v.size===0)return[];let E=singleFetchUrl(s);return _&&v.size>0&&E.searchParams.set("_routes",e.filter(x=>v.has(x.route.id)).map(x=>x.route.id).join(",")),[E.pathname+E.search]},[c,n,r,h,e,s,o]),g=reactExports.useMemo(()=>getModuleLinkHrefs(f,r),[f,r]),y=useKeyedPrefetchLinks(f);return reactExports.createElement(reactExports.Fragment,null,p.map(v=>reactExports.createElement("link",{key:v,rel:"prefetch",as:"fetch",href:v,...t})),g.map(v=>reactExports.createElement("link",{key:v,rel:"modulepreload",href:v,...t})),y.map(({key:v,link:_})=>reactExports.createElement("link",{key:v,..._})))}function mergeRefs(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var isBrowser$2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{isBrowser$2&&(window.__reactRouterVersion="7.1.5")}catch{}function BrowserRouter({basename:s,children:e,window:t}){let n=reactExports.useRef();n.current==null&&(n.current=createBrowserHistory({window:t,v5Compat:!0}));let r=n.current,[o,c]=reactExports.useState({action:r.action,location:r.location}),u=reactExports.useCallback(h=>{reactExports.startTransition(()=>c(h))},[c]);return reactExports.useLayoutEffect(()=>r.listen(u),[r,u]),reactExports.createElement(Router,{basename:s,children:e,location:o.location,navigationType:o.action,navigator:r})}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:r,reloadDocument:o,replace:c,state:u,target:h,to:f,preventScrollReset:p,viewTransition:g,...y},v){let{basename:_}=reactExports.useContext(NavigationContext),E=typeof f=="string"&&ABSOLUTE_URL_REGEX2.test(f),x,w=!1;if(typeof f=="string"&&E&&(x=f,isBrowser$2))try{let L=new URL(window.location.href),H=f.startsWith("//")?new URL(L.protocol+f):new URL(f),D=stripBasename(H.pathname,_);H.origin===L.origin&&D!=null?f=D+H.search+H.hash:w=!0}catch{warning(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let T=useHref(f,{relative:r}),[O,N,A]=usePrefetchBehavior(n,y),I=useLinkClickHandler(f,{replace:c,state:u,target:h,preventScrollReset:p,relative:r,viewTransition:g});function k(L){e&&e(L),L.defaultPrevented||I(L)}let M=reactExports.createElement("a",{...y,...A,href:x||T,onClick:w||o?e:k,ref:mergeRefs(v,N),target:h,"data-discover":!E&&t==="render"?"true":void 0});return O&&!E?reactExports.createElement(reactExports.Fragment,null,M,reactExports.createElement(PrefetchPageLinks,{page:T})):M});Link.displayName="Link";var NavLink=reactExports.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:r=!1,style:o,to:c,viewTransition:u,children:h,...f},p){let g=useResolvedPath(c,{relative:f.relative}),y=useLocation(),v=reactExports.useContext(DataRouterStateContext),{navigator:_,basename:E}=reactExports.useContext(NavigationContext),x=v!=null&&useViewTransitionState(g)&&u===!0,w=_.encodeLocation?_.encodeLocation(g).pathname:g.pathname,T=y.pathname,O=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(T=T.toLowerCase(),O=O?O.toLowerCase():null,w=w.toLowerCase()),O&&E&&(O=stripBasename(O,E)||O);const N=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let A=T===w||!r&&T.startsWith(w)&&T.charAt(N)==="/",I=O!=null&&(O===w||!r&&O.startsWith(w)&&O.charAt(w.length)==="/"),k={isActive:A,isPending:I,isTransitioning:x},M=A?e:void 0,L;typeof n=="function"?L=n(k):L=[n,A?"active":null,I?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let H=typeof o=="function"?o(k):o;return reactExports.createElement(Link,{...f,"aria-current":M,className:L,ref:p,style:H,to:c,viewTransition:u},typeof h=="function"?h(k):h)});NavLink.displayName="NavLink";var Form=reactExports.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:r,state:o,method:c=defaultMethod,action:u,onSubmit:h,relative:f,preventScrollReset:p,viewTransition:g,...y},v)=>{let _=useSubmit(),E=useFormAction(u,{relative:f}),x=c.toLowerCase()==="get"?"get":"post",w=typeof u=="string"&&ABSOLUTE_URL_REGEX2.test(u),T=O=>{if(h&&h(O),O.defaultPrevented)return;O.preventDefault();let N=O.nativeEvent.submitter,A=(N==null?void 0:N.getAttribute("formmethod"))||c;_(N||O.currentTarget,{fetcherKey:e,method:A,navigate:t,replace:r,state:o,relative:f,preventScrollReset:p,viewTransition:g})};return reactExports.createElement("form",{ref:v,method:x,action:E,onSubmit:n?h:T,...y,"data-discover":!w&&s==="render"?"true":void 0})});Form.displayName="Form";function getDataRouterConsoleError2(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(s){let e=reactExports.useContext(DataRouterContext);return invariant(e,getDataRouterConsoleError2(s)),e}function useLinkClickHandler(s,{target:e,replace:t,state:n,preventScrollReset:r,relative:o,viewTransition:c}={}){let u=useNavigate(),h=useLocation(),f=useResolvedPath(s,{relative:o});return reactExports.useCallback(p=>{if(shouldProcessLinkClick(p,e)){p.preventDefault();let g=t!==void 0?t:createPath(h)===createPath(f);u(s,{replace:g,state:n,preventScrollReset:r,relative:o,viewTransition:c})}},[h,u,f,t,n,e,s,r,o,c])}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:s}=useDataRouterContext3("useSubmit"),{basename:e}=reactExports.useContext(NavigationContext),t=useRouteId();return reactExports.useCallback(async(n,r={})=>{let{action:o,method:c,encType:u,formData:h,body:f}=getFormSubmissionInfo(n,e);if(r.navigate===!1){let p=r.fetcherKey||getUniqueFetcherId();await s.fetch(p,t,r.action||o,{preventScrollReset:r.preventScrollReset,formData:h,body:f,formMethod:r.method||c,formEncType:r.encType||u,flushSync:r.flushSync})}else await s.navigate(r.action||o,{preventScrollReset:r.preventScrollReset,formData:h,body:f,formMethod:r.method||c,formEncType:r.encType||u,replace:r.replace,state:r.state,fromRouteId:t,flushSync:r.flushSync,viewTransition:r.viewTransition})},[s,e,t])}function useFormAction(s,{relative:e}={}){let{basename:t}=reactExports.useContext(NavigationContext),n=reactExports.useContext(RouteContext);invariant(n,"useFormAction must be used inside a RouteContext");let[r]=n.matches.slice(-1),o={...useResolvedPath(s||".",{relative:e})},c=useLocation();if(s==null){o.search=c.search;let u=new URLSearchParams(o.search),h=u.getAll("index");if(h.some(p=>p==="")){u.delete("index"),h.filter(g=>g).forEach(g=>u.append("index",g));let p=u.toString();o.search=p?`?${p}`:""}}return(!s||s===".")&&r.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:joinPaths([t,o.pathname])),createPath(o)}function useViewTransitionState(s,e={}){let t=reactExports.useContext(ViewTransitionContext);invariant(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=useDataRouterContext3("useViewTransitionState"),r=useResolvedPath(s,{relative:e.relative});if(!t.isTransitioning)return!1;let o=stripBasename(t.currentLocation.pathname,n)||t.currentLocation.pathname,c=stripBasename(t.nextLocation.pathname,n)||t.nextLocation.pathname;return matchPath(r.pathname,c)!=null||matchPath(r.pathname,o)!=null}new TextEncoder;const Header=()=>{const s=useLocation(),e=[{name:"Assessment",path:"/terms"},{name:"Teacher Assistant",path:"/teacher-assistant"},{name:"Student Assistant",path:"/student-assistant"}];return jsxRuntimeExports.jsx("header",{children:jsxRuntimeExports.jsx("div",{className:"top-header",children:jsxRuntimeExports.jsxs("div",{className:"header-container",children:[jsxRuntimeExports.jsx(Link,{to:"/",className:"logo-link",children:jsxRuntimeExports.jsx("span",{className:"ontario-text",children:"Ontario"})}),jsxRuntimeExports.jsx("nav",{className:"assistant-nav",children:jsxRuntimeExports.jsx("ul",{className:"nav-list",children:e.map((t,n)=>jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx(Link,{to:t.path,className:s.pathname===t.path?"active":"",children:t.name})},n))})}),jsxRuntimeExports.jsxs("div",{className:"header-right",children:[jsxRuntimeExports.jsx("a",{href:"#francais",className:"language-toggle",children:"Franais"}),jsxRuntimeExports.jsx("button",{className:"sign-in",children:jsxRuntimeExports.jsx("i",{className:"fas fa-user-circle"})}),jsxRuntimeExports.jsx("button",{className:"help-button",children:jsxRuntimeExports.jsx("i",{className:"fas fa-question-circle"})})]})]})})})},Introduction=()=>{const s=useNavigate(),[e,t]=reactExports.useState(!1),[n,r]=reactExports.useState(""),[o,c]=reactExports.useState(""),[u,h]=reactExports.useState(""),[f,p]=reactExports.useState(""),g=[{id:"ontario",name:"Ontario Curriculum"},{id:"common-core",name:"US Common Core Curriculum"},{id:"canadian",name:"Canadian Curriculum"}],y=[{id:"english",name:"English"},{id:"computer",name:"Computer"},{id:"science",name:"Science"}],v=[2,3,4,5],_=[2,3,4],E=async()=>{try{t(!0);const x={curriculum:n,subject:o,grade:u.toString(),numberOfTerms:parseInt(f)};console.log("Sending data:",x);const w=await fetch("https://apis.earlyagedevelopment.com/api/lesson-terms/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)});if(!w.ok)throw new Error("Failed to generate lesson plan");const T=await w.json();console.log("Received data:",T),localStorage.setItem("lessonPlanData",JSON.stringify({formData:x,termPlan:T}));const O={curriculum:n,subject:o,grade:u,numberOfTerms:f};localStorage.setItem("selectedProject",JSON.stringify(O)),s("/terms")}catch(x){console.error("Error:",x),alert("Failed to generate lesson plan. Please try again.")}finally{t(!1)}};return jsxRuntimeExports.jsx("section",{className:"introduction",children:jsxRuntimeExports.jsx("div",{className:"intro-container",children:jsxRuntimeExports.jsxs("div",{className:"intro-content",children:[jsxRuntimeExports.jsx("h1",{className:"intro-title",children:"Lesson Planning"}),jsxRuntimeExports.jsxs("div",{className:"notification-banner",children:[jsxRuntimeExports.jsx("i",{className:"fas fa-info-circle"}),jsxRuntimeExports.jsx("p",{children:"Through this platform you can make lesson plans by your curriculum"}),jsxRuntimeExports.jsx("button",{className:"close-notification",children:jsxRuntimeExports.jsx("i",{className:"fas fa-times"})})]}),jsxRuntimeExports.jsxs("div",{className:"main-grid",children:[jsxRuntimeExports.jsxs("div",{className:"selection-panel",children:[jsxRuntimeExports.jsxs("div",{className:"section-title",children:[jsxRuntimeExports.jsx("h2",{children:"Create Your Lesson Plan"}),jsxRuntimeExports.jsx("div",{className:"title-underline"}),jsxRuntimeExports.jsx("p",{className:"section-subtitle",children:"Select your preferences to get started"})]}),jsxRuntimeExports.jsxs("div",{className:"selection-steps",children:[jsxRuntimeExports.jsxs("div",{className:"selection-step",children:[jsxRuntimeExports.jsxs("h3",{children:[jsxRuntimeExports.jsx("span",{children:"1"}),"Select Curriculum"]}),jsxRuntimeExports.jsx("div",{className:"options-grid",children:g.map(x=>jsxRuntimeExports.jsxs("button",{className:`option-card ${n===x.id?"selected":""}`,onClick:()=>r(x.id),children:[jsxRuntimeExports.jsx("div",{className:"option-icon",children:jsxRuntimeExports.jsx("i",{className:"fas fa-book"})}),jsxRuntimeExports.jsx("span",{children:x.name})]},x.id))})]}),jsxRuntimeExports.jsxs("div",{className:"selection-step",children:[jsxRuntimeExports.jsxs("h3",{children:[jsxRuntimeExports.jsx("span",{children:"2"}),"Select Subject"]}),jsxRuntimeExports.jsx("div",{className:"options-grid",children:y.map(x=>jsxRuntimeExports.jsxs("button",{className:`option-card ${o===x.id?"selected":""}`,onClick:()=>c(x.id),children:[jsxRuntimeExports.jsx("div",{className:"option-icon",children:jsxRuntimeExports.jsx("i",{className:`fas fa-${x.id==="english"?"book-open":x.id==="computer"?"laptop-code":"flask"}`})}),jsxRuntimeExports.jsx("span",{children:x.name})]},x.id))})]}),jsxRuntimeExports.jsxs("div",{className:"selection-step",children:[jsxRuntimeExports.jsxs("h3",{children:[jsxRuntimeExports.jsx("span",{children:"3"}),"Select Grade Level"]}),jsxRuntimeExports.jsx("div",{className:"options-grid",children:v.map(x=>jsxRuntimeExports.jsxs("button",{className:`option-card ${u===x?"selected":""}`,onClick:()=>h(x),children:[jsxRuntimeExports.jsx("div",{className:"option-icon",children:jsxRuntimeExports.jsx("i",{className:"fas fa-graduation-cap"})}),jsxRuntimeExports.jsxs("span",{children:["Grade ",x]})]},x))})]}),jsxRuntimeExports.jsxs("div",{className:"selection-step",children:[jsxRuntimeExports.jsxs("h3",{children:[jsxRuntimeExports.jsx("span",{children:"4"}),"Number of Terms"]}),jsxRuntimeExports.jsx("div",{className:"options-grid",children:_.map(x=>jsxRuntimeExports.jsxs("button",{className:`option-card ${f===x?"selected":""}`,onClick:()=>p(x),children:[jsxRuntimeExports.jsx("div",{className:"option-icon",children:jsxRuntimeExports.jsx("i",{className:"fas fa-calendar-alt"})}),jsxRuntimeExports.jsxs("span",{children:[x," Terms"]})]},x))})]})]}),jsxRuntimeExports.jsx("div",{className:"selection-actions",children:jsxRuntimeExports.jsx("button",{className:`generate-button ${n&&o&&u&&f?"active":"disabled"}`,disabled:!n||!o||!u||!f||e,onClick:E,children:e?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("i",{className:"fas fa-spinner fa-spin"}),"Generating..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["Generate Curriculum Plan",jsxRuntimeExports.jsx("i",{className:"fas fa-arrow-right"})]})})})]}),jsxRuntimeExports.jsxs("div",{className:"features-panel",children:[jsxRuntimeExports.jsx("div",{className:"illustration-container",children:jsxRuntimeExports.jsx("img",{src:new URL("/assets/img/mango-C64nJZP_.PNG",import.meta.url).href,alt:"Curriculum illustration showing teachers and students",className:"curriculum-illustration"})}),jsxRuntimeExports.jsxs("div",{className:"features",children:[jsxRuntimeExports.jsxs("div",{className:"feature-card",children:[jsxRuntimeExports.jsx("div",{className:"feature-icon-wrapper",children:jsxRuntimeExports.jsx("i",{className:"fas fa-file-pdf"})}),jsxRuntimeExports.jsx("h3",{children:"Smart PDF Processing"}),jsxRuntimeExports.jsx("p",{children:"Upload curriculum PDFs and let our AI-powered system organize content intelligently"})]}),jsxRuntimeExports.jsxs("div",{className:"feature-card",children:[jsxRuntimeExports.jsx("div",{className:"feature-icon-wrapper",children:jsxRuntimeExports.jsx("i",{className:"fas fa-calendar-alt"})}),jsxRuntimeExports.jsx("h3",{children:"Term Planning"}),jsxRuntimeExports.jsx("p",{children:"Automatically divide curriculum into balanced terms with smart scheduling"})]})]})]})]})]})})})},LessonPlan=()=>{var o;const s=useLocation(),e=useNavigate(),t=(o=s.state)==null?void 0:o.mcqData;if(console.log("Received MCQ Data:",t),!t||!t.mcqs)return jsxRuntimeExports.jsxs("div",{className:"lesson-plan",children:[jsxRuntimeExports.jsx("div",{className:"error-message",children:"No assessment data available. Please go back and start a new assessment."}),jsxRuntimeExports.jsx("button",{onClick:()=>e("/terms"),className:"back-button",children:"Go Back"})]});const r=(c=>{try{return c.split(/Q\d+\./).filter(h=>h.trim()).map(h=>{const f=h.split(`
`).filter(p=>p.trim());return{question:f[0],options:f.slice(1,-1),correctAnswer:f[f.length-1]}})}catch(u){return console.error("Error parsing MCQs:",u),[]}})(t.mcqs);return jsxRuntimeExports.jsxs("div",{className:"lesson-plan",children:[jsxRuntimeExports.jsxs("div",{className:"assessment-header",children:[jsxRuntimeExports.jsx("h2",{children:t.projectName}),jsxRuntimeExports.jsxs("p",{className:"criteria",children:["Assessment Criteria: ",t.assessmentCriteria]})]}),jsxRuntimeExports.jsx("div",{className:"mcq-container",children:r.map((c,u)=>jsxRuntimeExports.jsxs("div",{className:"mcq-question",children:[jsxRuntimeExports.jsxs("h3",{children:["Question ",u+1]}),jsxRuntimeExports.jsxs("div",{className:"question-content",children:[jsxRuntimeExports.jsx("p",{className:"question-text",children:c.question}),c.options.map((h,f)=>jsxRuntimeExports.jsx("p",{className:"option",children:h},f)),jsxRuntimeExports.jsx("div",{className:"correct-answer",children:c.correctAnswer})]})]},u))}),jsxRuntimeExports.jsx("button",{onClick:()=>e("/terms"),className:"back-button",children:"Start New Assessment"})]})},Footer=()=>jsxRuntimeExports.jsx("footer",{className:"footer",children:jsxRuntimeExports.jsxs("div",{className:"footer-container",children:[jsxRuntimeExports.jsxs("div",{className:"footer-grid",children:[jsxRuntimeExports.jsxs("div",{className:"footer-section",children:[jsxRuntimeExports.jsx("h3",{children:"About Ontario Curriculum"}),jsxRuntimeExports.jsx("p",{children:"Empowering educators with modern tools to create, manage, and deliver exceptional learning experiences across Ontario."})]}),jsxRuntimeExports.jsxs("div",{className:"footer-section",children:[jsxRuntimeExports.jsx("h3",{children:"Quick Links"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"#curriculum",children:"Curriculum"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"#assessment",children:"Assessment"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"#resources",children:"Resources"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"#contact",children:"Contact Us"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"footer-section",children:[jsxRuntimeExports.jsx("h3",{children:"Resources"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"#help",children:"Help Center"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"#guides",children:"Teacher Guides"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"#updates",children:"Latest Updates"})}),jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("a",{href:"#community",children:"Community"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"footer-section",children:[jsxRuntimeExports.jsx("h3",{children:"Connect With Us"}),jsxRuntimeExports.jsxs("div",{className:"social-links",children:[jsxRuntimeExports.jsx("a",{href:"#twitter","aria-label":"Twitter",children:jsxRuntimeExports.jsx("i",{className:"fab fa-twitter"})}),jsxRuntimeExports.jsx("a",{href:"#linkedin","aria-label":"LinkedIn",children:jsxRuntimeExports.jsx("i",{className:"fab fa-linkedin"})}),jsxRuntimeExports.jsx("a",{href:"#youtube","aria-label":"YouTube",children:jsxRuntimeExports.jsx("i",{className:"fab fa-youtube"})})]}),jsxRuntimeExports.jsxs("div",{className:"newsletter",children:[jsxRuntimeExports.jsx("h4",{children:"Stay Updated"}),jsxRuntimeExports.jsxs("div",{className:"newsletter-input",children:[jsxRuntimeExports.jsx("input",{type:"email",placeholder:"Enter your email"}),jsxRuntimeExports.jsx("button",{type:"button",children:jsxRuntimeExports.jsx("i",{className:"fas fa-paper-plane"})})]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"footer-bottom",children:[jsxRuntimeExports.jsxs("div",{className:"footer-info",children:[jsxRuntimeExports.jsx("p",{children:" 2024 Early Age Development. All rights reserved."}),jsxRuntimeExports.jsxs("div",{className:"footer-links",children:[jsxRuntimeExports.jsx("a",{href:"#privacy",children:"Privacy Policy"}),jsxRuntimeExports.jsx("a",{href:"#terms",children:"Terms of Use"}),jsxRuntimeExports.jsx("a",{href:"#accessibility",children:"Accessibility"})]})]}),jsxRuntimeExports.jsx("div",{className:"ontario-brand",children:jsxRuntimeExports.jsx("span",{className:"ontario-text",children:"Ontario.ca"})})]})]})});function bind(s,e){return function(){return s.apply(e,arguments)}}const{toString}=Object.prototype,{getPrototypeOf:getPrototypeOf$1}=Object,kindOf=(s=>e=>{const t=toString.call(e);return s[t]||(s[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=s=>(s=s.toLowerCase(),e=>kindOf(e)===s),typeOfTest=s=>e=>typeof e===s,{isArray:isArray$1}=Array,isUndefined=typeOfTest("undefined");function isBuffer(s){return s!==null&&!isUndefined(s)&&s.constructor!==null&&!isUndefined(s.constructor)&&isFunction$1(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(s){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(s):e=s&&s.buffer&&isArrayBuffer(s.buffer),e}const isString=typeOfTest("string"),isFunction$1=typeOfTest("function"),isNumber$1=typeOfTest("number"),isObject$1=s=>s!==null&&typeof s=="object",isBoolean=s=>s===!0||s===!1,isPlainObject=s=>{if(kindOf(s)!=="object")return!1;const e=getPrototypeOf$1(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=s=>isObject$1(s)&&isFunction$1(s.pipe),isFormData=s=>{let e;return s&&(typeof FormData=="function"&&s instanceof FormData||isFunction$1(s.append)&&((e=kindOf(s))==="formdata"||e==="object"&&isFunction$1(s.toString)&&s.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),[isReadableStream,isRequest,isResponse,isHeaders]=["ReadableStream","Request","Response","Headers"].map(kindOfTest),trim=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(s,e,{allOwnKeys:t=!1}={}){if(s===null||typeof s>"u")return;let n,r;if(typeof s!="object"&&(s=[s]),isArray$1(s))for(n=0,r=s.length;n<r;n++)e.call(null,s[n],n,s);else{const o=t?Object.getOwnPropertyNames(s):Object.keys(s),c=o.length;let u;for(n=0;n<c;n++)u=o[n],e.call(null,s[u],u,s)}}function findKey(s,e){e=e.toLowerCase();const t=Object.keys(s);let n=t.length,r;for(;n-- >0;)if(r=t[n],e===r.toLowerCase())return r;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=s=>!isUndefined(s)&&s!==_global;function merge$1(){const{caseless:s}=isContextDefined(this)&&this||{},e={},t=(n,r)=>{const o=s&&findKey(e,r)||r;isPlainObject(e[o])&&isPlainObject(n)?e[o]=merge$1(e[o],n):isPlainObject(n)?e[o]=merge$1({},n):isArray$1(n)?e[o]=n.slice():e[o]=n};for(let n=0,r=arguments.length;n<r;n++)arguments[n]&&forEach(arguments[n],t);return e}const extend=(s,e,t,{allOwnKeys:n}={})=>(forEach(e,(r,o)=>{t&&isFunction$1(r)?s[o]=bind(r,t):s[o]=r},{allOwnKeys:n}),s),stripBOM=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),inherits=(s,e,t,n)=>{s.prototype=Object.create(e.prototype,n),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:e.prototype}),t&&Object.assign(s.prototype,t)},toFlatObject=(s,e,t,n)=>{let r,o,c;const u={};if(e=e||{},s==null)return e;do{for(r=Object.getOwnPropertyNames(s),o=r.length;o-- >0;)c=r[o],(!n||n(c,s,e))&&!u[c]&&(e[c]=s[c],u[c]=!0);s=t!==!1&&getPrototypeOf$1(s)}while(s&&(!t||t(s,e))&&s!==Object.prototype);return e},endsWith=(s,e,t)=>{s=String(s),(t===void 0||t>s.length)&&(t=s.length),t-=e.length;const n=s.indexOf(e,t);return n!==-1&&n===t},toArray$1=s=>{if(!s)return null;if(isArray$1(s))return s;let e=s.length;if(!isNumber$1(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=s[e];return t},isTypedArray=(s=>e=>s&&e instanceof s)(typeof Uint8Array<"u"&&getPrototypeOf$1(Uint8Array)),forEachEntry=(s,e)=>{const n=(s&&s[Symbol.iterator]).call(s);let r;for(;(r=n.next())&&!r.done;){const o=r.value;e.call(s,o[0],o[1])}},matchAll=(s,e)=>{let t;const n=[];for(;(t=s.exec(e))!==null;)n.push(t);return n},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,r){return n.toUpperCase()+r}),hasOwnProperty$1=(({hasOwnProperty:s})=>(e,t)=>s.call(e,t))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(s,e)=>{const t=Object.getOwnPropertyDescriptors(s),n={};forEach(t,(r,o)=>{let c;(c=e(r,o,s))!==!1&&(n[o]=c||r)}),Object.defineProperties(s,n)},freezeMethods=s=>{reduceDescriptors(s,(e,t)=>{if(isFunction$1(s)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const n=s[t];if(isFunction$1(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},toObjectSet=(s,e)=>{const t={},n=r=>{r.forEach(o=>{t[o]=!0})};return isArray$1(s)?n(s):n(String(s).split(e)),t},noop$1=()=>{},toFiniteNumber=(s,e)=>s!=null&&Number.isFinite(s=+s)?s:e,ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(s=16,e=ALPHABET.ALPHA_DIGIT)=>{let t="";const{length:n}=e;for(;s--;)t+=e[Math.random()*n|0];return t};function isSpecCompliantForm(s){return!!(s&&isFunction$1(s.append)&&s[Symbol.toStringTag]==="FormData"&&s[Symbol.iterator])}const toJSONObject=s=>{const e=new Array(10),t=(n,r)=>{if(isObject$1(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[r]=n;const o=isArray$1(n)?[]:{};return forEach(n,(c,u)=>{const h=t(c,r+1);!isUndefined(h)&&(o[u]=h)}),e[r]=void 0,o}}return n};return t(s,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=s=>s&&(isObject$1(s)||isFunction$1(s))&&isFunction$1(s.then)&&isFunction$1(s.catch),_setImmediate=((s,e)=>s?setImmediate:e?((t,n)=>(_global.addEventListener("message",({source:r,data:o})=>{r===_global&&o===t&&n.length&&n.shift()()},!1),r=>{n.push(r),_global.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",isFunction$1(_global.postMessage)),asap=typeof queueMicrotask<"u"?queueMicrotask.bind(_global):typeof process<"u"&&process.nextTick||_setImmediate,utils$1={isArray:isArray$1,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber:isNumber$1,isBoolean,isObject:isObject$1,isPlainObject,isReadableStream,isRequest,isResponse,isHeaders,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction:isFunction$1,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge:merge$1,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray:toArray$1,forEachEntry,matchAll,isHTMLForm,hasOwnProperty:hasOwnProperty$1,hasOwnProp:hasOwnProperty$1,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop:noop$1,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable,setImmediate:_setImmediate,asap};function AxiosError$1(s,e,t,n,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),n&&(this.request=n),r&&(this.response=r,this.status=r.status?r.status:null)}utils$1.inherits(AxiosError$1,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.status}}});const prototype$1=AxiosError$1.prototype,descriptors$1={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{descriptors$1[s]={value:s}});Object.defineProperties(AxiosError$1,descriptors$1);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError$1.from=(s,e,t,n,r,o)=>{const c=Object.create(prototype$1);return utils$1.toFlatObject(s,c,function(h){return h!==Error.prototype},u=>u!=="isAxiosError"),AxiosError$1.call(c,s.message,e,t,n,r),c.cause=s,c.name=s.name,o&&Object.assign(c,o),c};const httpAdapter=null;function isVisitable(s){return utils$1.isPlainObject(s)||utils$1.isArray(s)}function removeBrackets(s){return utils$1.endsWith(s,"[]")?s.slice(0,-2):s}function renderKey(s,e,t){return s?s.concat(e).map(function(r,o){return r=removeBrackets(r),!t&&o?"["+r+"]":r}).join(t?".":""):e}function isFlatArray(s){return utils$1.isArray(s)&&!s.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(e){return/^is[A-Z]/.test(e)});function toFormData$1(s,e,t){if(!utils$1.isObject(s))throw new TypeError("target must be an object");e=e||new FormData,t=utils$1.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(E,x){return!utils$1.isUndefined(x[E])});const n=t.metaTokens,r=t.visitor||p,o=t.dots,c=t.indexes,h=(t.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(e);if(!utils$1.isFunction(r))throw new TypeError("visitor must be a function");function f(_){if(_===null)return"";if(utils$1.isDate(_))return _.toISOString();if(!h&&utils$1.isBlob(_))throw new AxiosError$1("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(_)||utils$1.isTypedArray(_)?h&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function p(_,E,x){let w=_;if(_&&!x&&typeof _=="object"){if(utils$1.endsWith(E,"{}"))E=n?E:E.slice(0,-2),_=JSON.stringify(_);else if(utils$1.isArray(_)&&isFlatArray(_)||(utils$1.isFileList(_)||utils$1.endsWith(E,"[]"))&&(w=utils$1.toArray(_)))return E=removeBrackets(E),w.forEach(function(O,N){!(utils$1.isUndefined(O)||O===null)&&e.append(c===!0?renderKey([E],N,o):c===null?E:E+"[]",f(O))}),!1}return isVisitable(_)?!0:(e.append(renderKey(x,E,o),f(_)),!1)}const g=[],y=Object.assign(predicates,{defaultVisitor:p,convertValue:f,isVisitable});function v(_,E){if(!utils$1.isUndefined(_)){if(g.indexOf(_)!==-1)throw Error("Circular reference detected in "+E.join("."));g.push(_),utils$1.forEach(_,function(w,T){(!(utils$1.isUndefined(w)||w===null)&&r.call(e,w,utils$1.isString(T)?T.trim():T,E,y))===!0&&v(w,E?E.concat(T):[T])}),g.pop()}}if(!utils$1.isObject(s))throw new TypeError("data must be an object");return v(s),e}function encode$1(s){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function AxiosURLSearchParams(s,e){this._pairs=[],s&&toFormData$1(s,this,e)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(e,t){this._pairs.push([e,t])};prototype.toString=function(e){const t=e?function(n){return e.call(this,n,encode$1)}:encode$1;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};function encode(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(s,e,t){if(!e)return s;const n=t&&t.encode||encode;utils$1.isFunction(t)&&(t={serialize:t});const r=t&&t.serialize;let o;if(r?o=r(e,t):o=utils$1.isURLSearchParams(e)?e.toString():new AxiosURLSearchParams(e,t).toString(n),o){const c=s.indexOf("#");c!==-1&&(s=s.slice(0,c)),s+=(s.indexOf("?")===-1?"?":"&")+o}return s}class InterceptorManager{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){utils$1.forEach(this.handlers,function(n){n!==null&&e(n)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$2=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$2,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",_navigator=typeof navigator=="object"&&navigator||void 0,hasStandardBrowserEnv=hasBrowserEnv&&(!_navigator||["ReactNative","NativeScript","NS"].indexOf(_navigator.product)<0),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",origin=hasBrowserEnv&&window.location.href||"http://localhost",utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv,navigator:_navigator,origin},Symbol.toStringTag,{value:"Module"})),platform={...utils,...platform$1};function toURLEncodedForm(s,e){return toFormData$1(s,new platform.classes.URLSearchParams,Object.assign({visitor:function(t,n,r,o){return platform.isNode&&utils$1.isBuffer(t)?(this.append(n,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},e))}function parsePropPath(s){return utils$1.matchAll(/\w+|\[(\w*)]/g,s).map(e=>e[0]==="[]"?"":e[1]||e[0])}function arrayToObject(s){const e={},t=Object.keys(s);let n;const r=t.length;let o;for(n=0;n<r;n++)o=t[n],e[o]=s[o];return e}function formDataToJSON(s){function e(t,n,r,o){let c=t[o++];if(c==="__proto__")return!0;const u=Number.isFinite(+c),h=o>=t.length;return c=!c&&utils$1.isArray(r)?r.length:c,h?(utils$1.hasOwnProp(r,c)?r[c]=[r[c],n]:r[c]=n,!u):((!r[c]||!utils$1.isObject(r[c]))&&(r[c]=[]),e(t,n,r[c],o)&&utils$1.isArray(r[c])&&(r[c]=arrayToObject(r[c])),!u)}if(utils$1.isFormData(s)&&utils$1.isFunction(s.entries)){const t={};return utils$1.forEachEntry(s,(n,r)=>{e(parsePropPath(n),r,t,0)}),t}return null}function stringifySafely(s,e,t){if(utils$1.isString(s))try{return(e||JSON.parse)(s),utils$1.trim(s)}catch(n){if(n.name!=="SyntaxError")throw n}return(t||JSON.stringify)(s)}const defaults$1={transitional:transitionalDefaults,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,o=utils$1.isObject(e);if(o&&utils$1.isHTMLForm(e)&&(e=new FormData(e)),utils$1.isFormData(e))return r?JSON.stringify(formDataToJSON(e)):e;if(utils$1.isArrayBuffer(e)||utils$1.isBuffer(e)||utils$1.isStream(e)||utils$1.isFile(e)||utils$1.isBlob(e)||utils$1.isReadableStream(e))return e;if(utils$1.isArrayBufferView(e))return e.buffer;if(utils$1.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let u;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(e,this.formSerializer).toString();if((u=utils$1.isFileList(e))||n.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return toFormData$1(u?{"files[]":e}:e,h&&new h,this.formSerializer)}}return o||r?(t.setContentType("application/json",!1),stringifySafely(e)):e}],transformResponse:[function(e){const t=this.transitional||defaults$1.transitional,n=t&&t.forcedJSONParsing,r=this.responseType==="json";if(utils$1.isResponse(e)||utils$1.isReadableStream(e))return e;if(e&&utils$1.isString(e)&&(n&&!this.responseType||r)){const c=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(u){if(c)throw u.name==="SyntaxError"?AxiosError$1.from(u,AxiosError$1.ERR_BAD_RESPONSE,this,null,this.response):u}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],s=>{defaults$1.headers[s]={}});const ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=s=>{const e={};let t,n,r;return s&&s.split(`
`).forEach(function(c){r=c.indexOf(":"),t=c.substring(0,r).trim().toLowerCase(),n=c.substring(r+1).trim(),!(!t||e[t]&&ignoreDuplicateOf[t])&&(t==="set-cookie"?e[t]?e[t].push(n):e[t]=[n]:e[t]=e[t]?e[t]+", "+n:n)}),e},$internals=Symbol("internals");function normalizeHeader(s){return s&&String(s).trim().toLowerCase()}function normalizeValue(s){return s===!1||s==null?s:utils$1.isArray(s)?s.map(normalizeValue):String(s)}function parseTokens(s){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=t.exec(s);)e[n[1]]=n[2];return e}const isValidHeaderName=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function matchHeaderValue(s,e,t,n,r){if(utils$1.isFunction(n))return n.call(this,e,t);if(r&&(e=t),!!utils$1.isString(e)){if(utils$1.isString(n))return e.indexOf(n)!==-1;if(utils$1.isRegExp(n))return n.test(e)}}function formatHeader(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}function buildAccessors(s,e){const t=utils$1.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(s,n+t,{value:function(r,o,c){return this[n].call(this,e,r,o,c)},configurable:!0})})}let AxiosHeaders$1=class{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function o(u,h,f){const p=normalizeHeader(h);if(!p)throw new Error("header name must be a non-empty string");const g=utils$1.findKey(r,p);(!g||r[g]===void 0||f===!0||f===void 0&&r[g]!==!1)&&(r[g||h]=normalizeValue(u))}const c=(u,h)=>utils$1.forEach(u,(f,p)=>o(f,p,h));if(utils$1.isPlainObject(e)||e instanceof this.constructor)c(e,t);else if(utils$1.isString(e)&&(e=e.trim())&&!isValidHeaderName(e))c(parseHeaders(e),t);else if(utils$1.isHeaders(e))for(const[u,h]of e.entries())o(h,u,n);else e!=null&&o(t,e,n);return this}get(e,t){if(e=normalizeHeader(e),e){const n=utils$1.findKey(this,e);if(n){const r=this[n];if(!t)return r;if(t===!0)return parseTokens(r);if(utils$1.isFunction(t))return t.call(this,r,n);if(utils$1.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=normalizeHeader(e),e){const n=utils$1.findKey(this,e);return!!(n&&this[n]!==void 0&&(!t||matchHeaderValue(this,this[n],n,t)))}return!1}delete(e,t){const n=this;let r=!1;function o(c){if(c=normalizeHeader(c),c){const u=utils$1.findKey(n,c);u&&(!t||matchHeaderValue(n,n[u],u,t))&&(delete n[u],r=!0)}}return utils$1.isArray(e)?e.forEach(o):o(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const o=t[n];(!e||matchHeaderValue(this,this[o],o,e,!0))&&(delete this[o],r=!0)}return r}normalize(e){const t=this,n={};return utils$1.forEach(this,(r,o)=>{const c=utils$1.findKey(n,o);if(c){t[c]=normalizeValue(r),delete t[o];return}const u=e?formatHeader(o):String(o).trim();u!==o&&delete t[o],t[u]=normalizeValue(r),n[u]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return utils$1.forEach(this,(n,r)=>{n!=null&&n!==!1&&(t[r]=e&&utils$1.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(r=>n.set(r)),n}static accessor(e){const n=(this[$internals]=this[$internals]={accessors:{}}).accessors,r=this.prototype;function o(c){const u=normalizeHeader(c);n[u]||(buildAccessors(r,c),n[u]=!0)}return utils$1.isArray(e)?e.forEach(o):o(e),this}};AxiosHeaders$1.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders$1.prototype,({value:s},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>s,set(n){this[t]=n}}});utils$1.freezeMethods(AxiosHeaders$1);function transformData(s,e){const t=this||defaults$1,n=e||t,r=AxiosHeaders$1.from(n.headers);let o=n.data;return utils$1.forEach(s,function(u){o=u.call(t,o,r.normalize(),e?e.status:void 0)}),r.normalize(),o}function isCancel$1(s){return!!(s&&s.__CANCEL__)}function CanceledError$1(s,e,t){AxiosError$1.call(this,s??"canceled",AxiosError$1.ERR_CANCELED,e,t),this.name="CanceledError"}utils$1.inherits(CanceledError$1,AxiosError$1,{__CANCEL__:!0});function settle(s,e,t){const n=t.config.validateStatus;!t.status||!n||n(t.status)?s(t):e(new AxiosError$1("Request failed with status code "+t.status,[AxiosError$1.ERR_BAD_REQUEST,AxiosError$1.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function parseProtocol(s){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return e&&e[1]||""}function speedometer(s,e){s=s||10;const t=new Array(s),n=new Array(s);let r=0,o=0,c;return e=e!==void 0?e:1e3,function(h){const f=Date.now(),p=n[o];c||(c=f),t[r]=h,n[r]=f;let g=o,y=0;for(;g!==r;)y+=t[g++],g=g%s;if(r=(r+1)%s,r===o&&(o=(o+1)%s),f-c<e)return;const v=p&&f-p;return v?Math.round(y*1e3/v):void 0}}function throttle(s,e){let t=0,n=1e3/e,r,o;const c=(f,p=Date.now())=>{t=p,r=null,o&&(clearTimeout(o),o=null),s.apply(null,f)};return[(...f)=>{const p=Date.now(),g=p-t;g>=n?c(f,p):(r=f,o||(o=setTimeout(()=>{o=null,c(r)},n-g)))},()=>r&&c(r)]}const progressEventReducer=(s,e,t=3)=>{let n=0;const r=speedometer(50,250);return throttle(o=>{const c=o.loaded,u=o.lengthComputable?o.total:void 0,h=c-n,f=r(h),p=c<=u;n=c;const g={loaded:c,total:u,progress:u?c/u:void 0,bytes:h,rate:f||void 0,estimated:f&&u&&p?(u-c)/f:void 0,event:o,lengthComputable:u!=null,[e?"download":"upload"]:!0};s(g)},t)},progressEventDecorator=(s,e)=>{const t=s!=null;return[n=>e[0]({lengthComputable:t,total:s,loaded:n}),e[1]]},asyncDecorator=s=>(...e)=>utils$1.asap(()=>s(...e)),isURLSameOrigin=platform.hasStandardBrowserEnv?((s,e)=>t=>(t=new URL(t,platform.origin),s.protocol===t.protocol&&s.host===t.host&&(e||s.port===t.port)))(new URL(platform.origin),platform.navigator&&/(msie|trident)/i.test(platform.navigator.userAgent)):()=>!0,cookies=platform.hasStandardBrowserEnv?{write(s,e,t,n,r,o){const c=[s+"="+encodeURIComponent(e)];utils$1.isNumber(t)&&c.push("expires="+new Date(t).toGMTString()),utils$1.isString(n)&&c.push("path="+n),utils$1.isString(r)&&c.push("domain="+r),o===!0&&c.push("secure"),document.cookie=c.join("; ")},read(s){const e=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(s){this.write(s,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL$1(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function combineURLs(s,e){return e?s.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):s}function buildFullPath(s,e){return s&&!isAbsoluteURL$1(e)?combineURLs(s,e):e}const headersToObject=s=>s instanceof AxiosHeaders$1?{...s}:s;function mergeConfig$1(s,e){e=e||{};const t={};function n(f,p,g,y){return utils$1.isPlainObject(f)&&utils$1.isPlainObject(p)?utils$1.merge.call({caseless:y},f,p):utils$1.isPlainObject(p)?utils$1.merge({},p):utils$1.isArray(p)?p.slice():p}function r(f,p,g,y){if(utils$1.isUndefined(p)){if(!utils$1.isUndefined(f))return n(void 0,f,g,y)}else return n(f,p,g,y)}function o(f,p){if(!utils$1.isUndefined(p))return n(void 0,p)}function c(f,p){if(utils$1.isUndefined(p)){if(!utils$1.isUndefined(f))return n(void 0,f)}else return n(void 0,p)}function u(f,p,g){if(g in e)return n(f,p);if(g in s)return n(void 0,f)}const h={url:o,method:o,data:o,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u,headers:(f,p,g)=>r(headersToObject(f),headersToObject(p),g,!0)};return utils$1.forEach(Object.keys(Object.assign({},s,e)),function(p){const g=h[p]||r,y=g(s[p],e[p],p);utils$1.isUndefined(y)&&g!==u||(t[p]=y)}),t}const resolveConfig=s=>{const e=mergeConfig$1({},s);let{data:t,withXSRFToken:n,xsrfHeaderName:r,xsrfCookieName:o,headers:c,auth:u}=e;e.headers=c=AxiosHeaders$1.from(c),e.url=buildURL(buildFullPath(e.baseURL,e.url),s.params,s.paramsSerializer),u&&c.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let h;if(utils$1.isFormData(t)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if((h=c.getContentType())!==!1){const[f,...p]=h?h.split(";").map(g=>g.trim()).filter(Boolean):[];c.setContentType([f||"multipart/form-data",...p].join("; "))}}if(platform.hasStandardBrowserEnv&&(n&&utils$1.isFunction(n)&&(n=n(e)),n||n!==!1&&isURLSameOrigin(e.url))){const f=r&&o&&cookies.read(o);f&&c.set(r,f)}return e},isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(s){return new Promise(function(t,n){const r=resolveConfig(s);let o=r.data;const c=AxiosHeaders$1.from(r.headers).normalize();let{responseType:u,onUploadProgress:h,onDownloadProgress:f}=r,p,g,y,v,_;function E(){v&&v(),_&&_(),r.cancelToken&&r.cancelToken.unsubscribe(p),r.signal&&r.signal.removeEventListener("abort",p)}let x=new XMLHttpRequest;x.open(r.method.toUpperCase(),r.url,!0),x.timeout=r.timeout;function w(){if(!x)return;const O=AxiosHeaders$1.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),A={data:!u||u==="text"||u==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:O,config:s,request:x};settle(function(k){t(k),E()},function(k){n(k),E()},A),x=null}"onloadend"in x?x.onloadend=w:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(w)},x.onabort=function(){x&&(n(new AxiosError$1("Request aborted",AxiosError$1.ECONNABORTED,s,x)),x=null)},x.onerror=function(){n(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,s,x)),x=null},x.ontimeout=function(){let N=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const A=r.transitional||transitionalDefaults;r.timeoutErrorMessage&&(N=r.timeoutErrorMessage),n(new AxiosError$1(N,A.clarifyTimeoutError?AxiosError$1.ETIMEDOUT:AxiosError$1.ECONNABORTED,s,x)),x=null},o===void 0&&c.setContentType(null),"setRequestHeader"in x&&utils$1.forEach(c.toJSON(),function(N,A){x.setRequestHeader(A,N)}),utils$1.isUndefined(r.withCredentials)||(x.withCredentials=!!r.withCredentials),u&&u!=="json"&&(x.responseType=r.responseType),f&&([y,_]=progressEventReducer(f,!0),x.addEventListener("progress",y)),h&&x.upload&&([g,v]=progressEventReducer(h),x.upload.addEventListener("progress",g),x.upload.addEventListener("loadend",v)),(r.cancelToken||r.signal)&&(p=O=>{x&&(n(!O||O.type?new CanceledError$1(null,s,x):O),x.abort(),x=null)},r.cancelToken&&r.cancelToken.subscribe(p),r.signal&&(r.signal.aborted?p():r.signal.addEventListener("abort",p)));const T=parseProtocol(r.url);if(T&&platform.protocols.indexOf(T)===-1){n(new AxiosError$1("Unsupported protocol "+T+":",AxiosError$1.ERR_BAD_REQUEST,s));return}x.send(o||null)})},composeSignals=(s,e)=>{const{length:t}=s=s?s.filter(Boolean):[];if(e||t){let n=new AbortController,r;const o=function(f){if(!r){r=!0,u();const p=f instanceof Error?f:this.reason;n.abort(p instanceof AxiosError$1?p:new CanceledError$1(p instanceof Error?p.message:p))}};let c=e&&setTimeout(()=>{c=null,o(new AxiosError$1(`timeout ${e} of ms exceeded`,AxiosError$1.ETIMEDOUT))},e);const u=()=>{s&&(c&&clearTimeout(c),c=null,s.forEach(f=>{f.unsubscribe?f.unsubscribe(o):f.removeEventListener("abort",o)}),s=null)};s.forEach(f=>f.addEventListener("abort",o));const{signal:h}=n;return h.unsubscribe=()=>utils$1.asap(u),h}},streamChunk=function*(s,e){let t=s.byteLength;if(t<e){yield s;return}let n=0,r;for(;n<t;)r=n+e,yield s.slice(n,r),n=r},readBytes=async function*(s,e){for await(const t of readStream(s))yield*streamChunk(t,e)},readStream=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const e=s.getReader();try{for(;;){const{done:t,value:n}=await e.read();if(t)break;yield n}}finally{await e.cancel()}},trackStream=(s,e,t,n)=>{const r=readBytes(s,e);let o=0,c,u=h=>{c||(c=!0,n&&n(h))};return new ReadableStream({async pull(h){try{const{done:f,value:p}=await r.next();if(f){u(),h.close();return}let g=p.byteLength;if(t){let y=o+=g;t(y)}h.enqueue(new Uint8Array(p))}catch(f){throw u(f),f}},cancel(h){return u(h),r.return()}},{highWaterMark:2})},isFetchSupported=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",isReadableStreamSupported=isFetchSupported&&typeof ReadableStream=="function",encodeText=isFetchSupported&&(typeof TextEncoder=="function"?(s=>e=>s.encode(e))(new TextEncoder):async s=>new Uint8Array(await new Response(s).arrayBuffer())),test=(s,...e)=>{try{return!!s(...e)}catch{return!1}},supportsRequestStream=isReadableStreamSupported&&test(()=>{let s=!1;const e=new Request(platform.origin,{body:new ReadableStream,method:"POST",get duplex(){return s=!0,"half"}}).headers.has("Content-Type");return s&&!e}),DEFAULT_CHUNK_SIZE=64*1024,supportsResponseStream=isReadableStreamSupported&&test(()=>utils$1.isReadableStream(new Response("").body)),resolvers={stream:supportsResponseStream&&(s=>s.body)};isFetchSupported&&(s=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!resolvers[e]&&(resolvers[e]=utils$1.isFunction(s[e])?t=>t[e]():(t,n)=>{throw new AxiosError$1(`Response type '${e}' is not supported`,AxiosError$1.ERR_NOT_SUPPORT,n)})})})(new Response);const getBodyLength=async s=>{if(s==null)return 0;if(utils$1.isBlob(s))return s.size;if(utils$1.isSpecCompliantForm(s))return(await new Request(platform.origin,{method:"POST",body:s}).arrayBuffer()).byteLength;if(utils$1.isArrayBufferView(s)||utils$1.isArrayBuffer(s))return s.byteLength;if(utils$1.isURLSearchParams(s)&&(s=s+""),utils$1.isString(s))return(await encodeText(s)).byteLength},resolveBodyLength=async(s,e)=>{const t=utils$1.toFiniteNumber(s.getContentLength());return t??getBodyLength(e)},fetchAdapter=isFetchSupported&&(async s=>{let{url:e,method:t,data:n,signal:r,cancelToken:o,timeout:c,onDownloadProgress:u,onUploadProgress:h,responseType:f,headers:p,withCredentials:g="same-origin",fetchOptions:y}=resolveConfig(s);f=f?(f+"").toLowerCase():"text";let v=composeSignals([r,o&&o.toAbortSignal()],c),_;const E=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let x;try{if(h&&supportsRequestStream&&t!=="get"&&t!=="head"&&(x=await resolveBodyLength(p,n))!==0){let A=new Request(e,{method:"POST",body:n,duplex:"half"}),I;if(utils$1.isFormData(n)&&(I=A.headers.get("content-type"))&&p.setContentType(I),A.body){const[k,M]=progressEventDecorator(x,progressEventReducer(asyncDecorator(h)));n=trackStream(A.body,DEFAULT_CHUNK_SIZE,k,M)}}utils$1.isString(g)||(g=g?"include":"omit");const w="credentials"in Request.prototype;_=new Request(e,{...y,signal:v,method:t.toUpperCase(),headers:p.normalize().toJSON(),body:n,duplex:"half",credentials:w?g:void 0});let T=await fetch(_);const O=supportsResponseStream&&(f==="stream"||f==="response");if(supportsResponseStream&&(u||O&&E)){const A={};["status","statusText","headers"].forEach(L=>{A[L]=T[L]});const I=utils$1.toFiniteNumber(T.headers.get("content-length")),[k,M]=u&&progressEventDecorator(I,progressEventReducer(asyncDecorator(u),!0))||[];T=new Response(trackStream(T.body,DEFAULT_CHUNK_SIZE,k,()=>{M&&M(),E&&E()}),A)}f=f||"text";let N=await resolvers[utils$1.findKey(resolvers,f)||"text"](T,s);return!O&&E&&E(),await new Promise((A,I)=>{settle(A,I,{data:N,headers:AxiosHeaders$1.from(T.headers),status:T.status,statusText:T.statusText,config:s,request:_})})}catch(w){throw E&&E(),w&&w.name==="TypeError"&&/fetch/i.test(w.message)?Object.assign(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,s,_),{cause:w.cause||w}):AxiosError$1.from(w,w&&w.code,s,_)}}),knownAdapters={http:httpAdapter,xhr:xhrAdapter,fetch:fetchAdapter};utils$1.forEach(knownAdapters,(s,e)=>{if(s){try{Object.defineProperty(s,"name",{value:e})}catch{}Object.defineProperty(s,"adapterName",{value:e})}});const renderReason=s=>`- ${s}`,isResolvedHandle=s=>utils$1.isFunction(s)||s===null||s===!1,adapters$1={getAdapter:s=>{s=utils$1.isArray(s)?s:[s];const{length:e}=s;let t,n;const r={};for(let o=0;o<e;o++){t=s[o];let c;if(n=t,!isResolvedHandle(t)&&(n=knownAdapters[(c=String(t)).toLowerCase()],n===void 0))throw new AxiosError$1(`Unknown adapter '${c}'`);if(n)break;r[c||"#"+o]=n}if(!n){const o=Object.entries(r).map(([u,h])=>`adapter ${u} `+(h===!1?"is not supported by the environment":"is not available in the build"));let c=e?o.length>1?`since :
`+o.map(renderReason).join(`
`):" "+renderReason(o[0]):"as no adapter specified";throw new AxiosError$1("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return n},adapters:knownAdapters};function throwIfCancellationRequested(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new CanceledError$1(null,s)}function dispatchRequest(s){return throwIfCancellationRequested(s),s.headers=AxiosHeaders$1.from(s.headers),s.data=transformData.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),adapters$1.getAdapter(s.adapter||defaults$1.adapter)(s).then(function(n){return throwIfCancellationRequested(s),n.data=transformData.call(s,s.transformResponse,n),n.headers=AxiosHeaders$1.from(n.headers),n},function(n){return isCancel$1(n)||(throwIfCancellationRequested(s),n&&n.response&&(n.response.data=transformData.call(s,s.transformResponse,n.response),n.response.headers=AxiosHeaders$1.from(n.response.headers))),Promise.reject(n)})}const VERSION$2="1.7.9",validators$1={};["object","boolean","number","function","string","symbol"].forEach((s,e)=>{validators$1[s]=function(n){return typeof n===s||"a"+(e<1?"n ":" ")+s}});const deprecatedWarnings={};validators$1.transitional=function(e,t,n){function r(o,c){return"[Axios v"+VERSION$2+"] Transitional option '"+o+"'"+c+(n?". "+n:"")}return(o,c,u)=>{if(e===!1)throw new AxiosError$1(r(c," has been removed"+(t?" in "+t:"")),AxiosError$1.ERR_DEPRECATED);return t&&!deprecatedWarnings[c]&&(deprecatedWarnings[c]=!0,console.warn(r(c," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(o,c,u):!0}};validators$1.spelling=function(e){return(t,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function assertOptions(s,e,t){if(typeof s!="object")throw new AxiosError$1("options must be an object",AxiosError$1.ERR_BAD_OPTION_VALUE);const n=Object.keys(s);let r=n.length;for(;r-- >0;){const o=n[r],c=e[o];if(c){const u=s[o],h=u===void 0||c(u,o,s);if(h!==!0)throw new AxiosError$1("option "+o+" must be "+h,AxiosError$1.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new AxiosError$1("Unknown option "+o,AxiosError$1.ERR_BAD_OPTION)}}const validator$1={assertOptions,validators:validators$1},validators=validator$1.validators;let Axios$1=class{constructor(e){this.defaults=e,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const o=r.stack?r.stack.replace(/^.+\n/,""):"";try{n.stack?o&&!String(n.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+o):n.stack=o}catch{}}throw n}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=mergeConfig$1(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:o}=t;n!==void 0&&validator$1.assertOptions(n,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),r!=null&&(utils$1.isFunction(r)?t.paramsSerializer={serialize:r}:validator$1.assertOptions(r,{encode:validators.function,serialize:validators.function},!0)),validator$1.assertOptions(t,{baseUrl:validators.spelling("baseURL"),withXsrfToken:validators.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let c=o&&utils$1.merge(o.common,o[t.method]);o&&utils$1.forEach(["delete","get","head","post","put","patch","common"],_=>{delete o[_]}),t.headers=AxiosHeaders$1.concat(c,o);const u=[];let h=!0;this.interceptors.request.forEach(function(E){typeof E.runWhen=="function"&&E.runWhen(t)===!1||(h=h&&E.synchronous,u.unshift(E.fulfilled,E.rejected))});const f=[];this.interceptors.response.forEach(function(E){f.push(E.fulfilled,E.rejected)});let p,g=0,y;if(!h){const _=[dispatchRequest.bind(this),void 0];for(_.unshift.apply(_,u),_.push.apply(_,f),y=_.length,p=Promise.resolve(t);g<y;)p=p.then(_[g++],_[g++]);return p}y=u.length;let v=t;for(g=0;g<y;){const _=u[g++],E=u[g++];try{v=_(v)}catch(x){E.call(this,x);break}}try{p=dispatchRequest.call(this,v)}catch(_){return Promise.reject(_)}for(g=0,y=f.length;g<y;)p=p.then(f[g++],f[g++]);return p}getUri(e){e=mergeConfig$1(this.defaults,e);const t=buildFullPath(e.baseURL,e.url);return buildURL(t,e.params,e.paramsSerializer)}};utils$1.forEach(["delete","get","head","options"],function(e){Axios$1.prototype[e]=function(t,n){return this.request(mergeConfig$1(n||{},{method:e,url:t,data:(n||{}).data}))}});utils$1.forEach(["post","put","patch"],function(e){function t(n){return function(o,c,u){return this.request(mergeConfig$1(u||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:c}))}}Axios$1.prototype[e]=t(),Axios$1.prototype[e+"Form"]=t(!0)});let CancelToken$1=class uf{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const n=this;this.promise.then(r=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](r);n._listeners=null}),this.promise.then=r=>{let o;const c=new Promise(u=>{n.subscribe(u),o=u}).then(r);return c.cancel=function(){n.unsubscribe(o)},c},e(function(o,c,u){n.reason||(n.reason=new CanceledError$1(o,c,u),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=n=>{e.abort(n)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new uf(function(r){e=r}),cancel:e}}};function spread$1(s){return function(t){return s.apply(null,t)}}function isAxiosError$1(s){return utils$1.isObject(s)&&s.isAxiosError===!0}const HttpStatusCode$1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode$1).forEach(([s,e])=>{HttpStatusCode$1[e]=s});function createInstance(s){const e=new Axios$1(s),t=bind(Axios$1.prototype.request,e);return utils$1.extend(t,Axios$1.prototype,e,{allOwnKeys:!0}),utils$1.extend(t,e,null,{allOwnKeys:!0}),t.create=function(r){return createInstance(mergeConfig$1(s,r))},t}const axios=createInstance(defaults$1);axios.Axios=Axios$1;axios.CanceledError=CanceledError$1;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel$1;axios.VERSION=VERSION$2;axios.toFormData=toFormData$1;axios.AxiosError=AxiosError$1;axios.Cancel=axios.CanceledError;axios.all=function(e){return Promise.all(e)};axios.spread=spread$1;axios.isAxiosError=isAxiosError$1;axios.mergeConfig=mergeConfig$1;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=s=>formDataToJSON(utils$1.isHTMLForm(s)?new FormData(s):s);axios.getAdapter=adapters$1.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const{Axios,AxiosError,CanceledError,isCancel,CancelToken,VERSION:VERSION$1,all,Cancel,isAxiosError,spread,toFormData,AxiosHeaders,HttpStatusCode,formToJSON,getAdapter,mergeConfig}=axios,Terms=()=>{const s=useNavigate(),[e,t]=reactExports.useState([]),[n,r]=reactExports.useState([]),[o,c]=reactExports.useState(""),[u,h]=reactExports.useState(""),[f,p]=reactExports.useState(!1),[g,y]=reactExports.useState(null);reactExports.useEffect(()=>{(async()=>{var E;p(!0);try{const x=await axios.get("https://apis.earlyagedevelopment.com/api/projects");t(x.data||[]);const w=await axios.get("https://apis.earlyagedevelopment.com/api/assessment-criteria");r(((E=w.data)==null?void 0:E.data)||[])}catch(x){y("Failed to fetch data"),console.error("Error fetching data:",x)}finally{p(!1)}})()},[]);const v=async _=>{_.preventDefault();const E=e.find(w=>w.id===parseInt(o)),x=n.find(w=>w.id===parseInt(u));if(!E||!x){y("Please select both project and assessment criteria");return}s("/assessment",{state:{project:{id:E.id,title:E.project_title},criteria:x}})};return f?jsxRuntimeExports.jsx("div",{children:"Loading..."}):g?jsxRuntimeExports.jsxs("div",{children:["Error: ",g]}):jsxRuntimeExports.jsx("div",{className:"terms-page",children:jsxRuntimeExports.jsx("div",{className:"content",children:jsxRuntimeExports.jsxs("form",{onSubmit:v,children:[jsxRuntimeExports.jsxs("div",{className:"dropdown-section",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"project",children:"Select Project"}),jsxRuntimeExports.jsxs("div",{className:"custom-select",children:[jsxRuntimeExports.jsxs("select",{id:"project",value:o,onChange:_=>c(_.target.value),className:"form-control",required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select a project"}),e.map(_=>jsxRuntimeExports.jsx("option",{value:_.id,children:_.project_title},_.id))]}),o&&jsxRuntimeExports.jsx("div",{className:"selected-project",children:e.map(_=>_.id===parseInt(o)&&jsxRuntimeExports.jsx("img",{src:_.project_picture,alt:_.project_title,className:"project-thumbnail"},_.id))})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{htmlFor:"criteria",children:"Select Assessment Criteria"}),jsxRuntimeExports.jsxs("select",{id:"criteria",value:u,onChange:_=>h(_.target.value),className:"form-control",required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Select criteria"}),n.map(_=>jsxRuntimeExports.jsx("option",{value:_.id,children:_.name},_.id))]})]})]}),jsxRuntimeExports.jsx("button",{type:"submit",className:"submit-button",disabled:f,children:f?"Loading...":"Start Assessment"})]})})})},ignoreOverride=Symbol("Let zodToJsonSchema decide on which parser to use"),defaultOptions$1={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},getDefaultOptions=s=>({...defaultOptions$1,...s}),getRefs=s=>{const e=getDefaultOptions(s),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:t,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([n,r])=>[r._def,{def:r._def,path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function addErrorMessage(s,e,t,n){n!=null&&n.errorMessages&&t&&(s.errorMessage={...s.errorMessage,[e]:t})}function setResponseValueAndErrors(s,e,t,n,r){s[e]=t,addErrorMessage(s,e,n,r)}var util;(function(s){s.assertEqual=r=>r;function e(r){}s.assertIs=e;function t(r){throw new Error}s.assertNever=t,s.arrayToEnum=r=>{const o={};for(const c of r)o[c]=c;return o},s.getValidEnumValues=r=>{const o=s.objectKeys(r).filter(u=>typeof r[r[u]]!="number"),c={};for(const u of o)c[u]=r[u];return s.objectValues(c)},s.objectValues=r=>s.objectKeys(r).map(function(o){return r[o]}),s.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{const o=[];for(const c in r)Object.prototype.hasOwnProperty.call(r,c)&&o.push(c);return o},s.find=(r,o)=>{for(const c of r)if(o(c))return c},s.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&isFinite(r)&&Math.floor(r)===r;function n(r,o=" | "){return r.map(c=>typeof c=="string"?`'${c}'`:c).join(o)}s.joinValues=n,s.jsonStringifyReplacer=(r,o)=>typeof o=="bigint"?o.toString():o})(util||(util={}));var objectUtil;(function(s){s.mergeShapes=(e,t)=>({...e,...t})})(objectUtil||(objectUtil={}));const ZodParsedType=util.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),getParsedType=s=>{switch(typeof s){case"undefined":return ZodParsedType.undefined;case"string":return ZodParsedType.string;case"number":return isNaN(s)?ZodParsedType.nan:ZodParsedType.number;case"boolean":return ZodParsedType.boolean;case"function":return ZodParsedType.function;case"bigint":return ZodParsedType.bigint;case"symbol":return ZodParsedType.symbol;case"object":return Array.isArray(s)?ZodParsedType.array:s===null?ZodParsedType.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?ZodParsedType.promise:typeof Map<"u"&&s instanceof Map?ZodParsedType.map:typeof Set<"u"&&s instanceof Set?ZodParsedType.set:typeof Date<"u"&&s instanceof Date?ZodParsedType.date:ZodParsedType.object;default:return ZodParsedType.unknown}},ZodIssueCode=util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),quotelessJson=s=>JSON.stringify(s,null,2).replace(/"([^"]+)":/g,"$1:");class ZodError extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(o){return o.message},n={_errors:[]},r=o=>{for(const c of o.issues)if(c.code==="invalid_union")c.unionErrors.map(r);else if(c.code==="invalid_return_type")r(c.returnTypeError);else if(c.code==="invalid_arguments")r(c.argumentsError);else if(c.path.length===0)n._errors.push(t(c));else{let u=n,h=0;for(;h<c.path.length;){const f=c.path[h];h===c.path.length-1?(u[f]=u[f]||{_errors:[]},u[f]._errors.push(t(c))):u[f]=u[f]||{_errors:[]},u=u[f],h++}}};return r(this),n}static assert(e){if(!(e instanceof ZodError))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,util.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const r of this.issues)r.path.length>0?(t[r.path[0]]=t[r.path[0]]||[],t[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}ZodError.create=s=>new ZodError(s);const errorMap=(s,e)=>{let t;switch(s.code){case ZodIssueCode.invalid_type:s.received===ZodParsedType.undefined?t="Required":t=`Expected ${s.expected}, received ${s.received}`;break;case ZodIssueCode.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(s.expected,util.jsonStringifyReplacer)}`;break;case ZodIssueCode.unrecognized_keys:t=`Unrecognized key(s) in object: ${util.joinValues(s.keys,", ")}`;break;case ZodIssueCode.invalid_union:t="Invalid input";break;case ZodIssueCode.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${util.joinValues(s.options)}`;break;case ZodIssueCode.invalid_enum_value:t=`Invalid enum value. Expected ${util.joinValues(s.options)}, received '${s.received}'`;break;case ZodIssueCode.invalid_arguments:t="Invalid function arguments";break;case ZodIssueCode.invalid_return_type:t="Invalid function return type";break;case ZodIssueCode.invalid_date:t="Invalid date";break;case ZodIssueCode.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(t=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?t=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?t=`Invalid input: must end with "${s.validation.endsWith}"`:util.assertNever(s.validation):s.validation!=="regex"?t=`Invalid ${s.validation}`:t="Invalid";break;case ZodIssueCode.too_small:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:t="Invalid input";break;case ZodIssueCode.too_big:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?t=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:t="Invalid input";break;case ZodIssueCode.custom:t="Invalid input";break;case ZodIssueCode.invalid_intersection_types:t="Intersection results could not be merged";break;case ZodIssueCode.not_multiple_of:t=`Number must be a multiple of ${s.multipleOf}`;break;case ZodIssueCode.not_finite:t="Number must be finite";break;default:t=e.defaultError,util.assertNever(s)}return{message:t}};let overrideErrorMap=errorMap;function setErrorMap(s){overrideErrorMap=s}function getErrorMap(){return overrideErrorMap}const makeIssue=s=>{const{data:e,path:t,errorMaps:n,issueData:r}=s,o=[...t,...r.path||[]],c={...r,path:o};if(r.message!==void 0)return{...r,path:o,message:r.message};let u="";const h=n.filter(f=>!!f).slice().reverse();for(const f of h)u=f(c,{data:e,defaultError:u}).message;return{...r,path:o,message:u}},EMPTY_PATH=[];function addIssueToContext(s,e){const t=getErrorMap(),n=makeIssue({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,t,t===errorMap?void 0:errorMap].filter(r=>!!r)});s.common.issues.push(n)}class ParseStatus{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const r of t){if(r.status==="aborted")return INVALID;r.status==="dirty"&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const r of t){const o=await r.key,c=await r.value;n.push({key:o,value:c})}return ParseStatus.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const r of t){const{key:o,value:c}=r;if(o.status==="aborted"||c.status==="aborted")return INVALID;o.status==="dirty"&&e.dirty(),c.status==="dirty"&&e.dirty(),o.value!=="__proto__"&&(typeof c.value<"u"||r.alwaysSet)&&(n[o.value]=c.value)}return{status:e.value,value:n}}}const INVALID=Object.freeze({status:"aborted"}),DIRTY=s=>({status:"dirty",value:s}),OK=s=>({status:"valid",value:s}),isAborted=s=>s.status==="aborted",isDirty=s=>s.status==="dirty",isValid=s=>s.status==="valid",isAsync=s=>typeof Promise<"u"&&s instanceof Promise;function __classPrivateFieldGet(s,e,t,n){if(typeof e=="function"?s!==e||!0:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(s)}function __classPrivateFieldSet(s,e,t,n,r){if(typeof e=="function"?s!==e||!0:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(s,t),t}typeof SuppressedError=="function"&&SuppressedError;var errorUtil;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(errorUtil||(errorUtil={}));var _ZodEnum_cache,_ZodNativeEnum_cache;class ParseInputLazyPath{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const handleResult=(s,e)=>{if(isValid(e))return{success:!0,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new ZodError(s.common.issues);return this._error=t,this._error}}};function processCreateParams(s){if(!s)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:r}=s;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(c,u)=>{var h,f;const{message:p}=s;return c.code==="invalid_enum_value"?{message:p??u.defaultError}:typeof u.data>"u"?{message:(h=p??n)!==null&&h!==void 0?h:u.defaultError}:c.code!=="invalid_type"?{message:u.defaultError}:{message:(f=p??t)!==null&&f!==void 0?f:u.defaultError}},description:r}}class ZodType{get description(){return this._def.description}_getType(e){return getParsedType(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:getParsedType(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:getParsedType(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(isAsync(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const r={common:{issues:[],async:(n=t==null?void 0:t.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)},o=this._parseSync({data:e,path:r.path,parent:r});return handleResult(r,o)}"~validate"(e){var t,n;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)};if(!this["~standard"].async)try{const o=this._parseSync({data:e,path:[],parent:r});return isValid(o)?{value:o.value}:{issues:r.common.issues}}catch(o){!((n=(t=o==null?void 0:o.message)===null||t===void 0?void 0:t.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(o=>isValid(o)?{value:o.value}:{issues:r.common.issues})}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)},r=this._parse({data:e,path:n.path,parent:n}),o=await(isAsync(r)?r:Promise.resolve(r));return handleResult(n,o)}refine(e,t){const n=r=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(r):t;return this._refinement((r,o)=>{const c=e(r),u=()=>o.addIssue({code:ZodIssueCode.custom,...n(r)});return typeof Promise<"u"&&c instanceof Promise?c.then(h=>h?!0:(u(),!1)):c?!0:(u(),!1)})}refinement(e,t){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof t=="function"?t(n,r):t),!1))}_refinement(e){return new ZodEffects({schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this)}promise(){return ZodPromise.create(this,this._def)}or(e){return ZodUnion.create([this,e],this._def)}and(e){return ZodIntersection.create(this,e,this._def)}transform(e){return new ZodEffects({...processCreateParams(this._def),schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new ZodDefault({...processCreateParams(this._def),innerType:this,defaultValue:t,typeName:ZodFirstPartyTypeKind.ZodDefault})}brand(){return new ZodBranded({typeName:ZodFirstPartyTypeKind.ZodBranded,type:this,...processCreateParams(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new ZodCatch({...processCreateParams(this._def),innerType:this,catchValue:t,typeName:ZodFirstPartyTypeKind.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return ZodPipeline.create(this,e)}readonly(){return ZodReadonly.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const cuidRegex=/^c[^\s-]{8,}$/i,cuid2Regex=/^[0-9a-z]+$/,ulidRegex=/^[0-9A-HJKMNP-TV-Z]{26}$/i,uuidRegex=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,nanoidRegex=/^[a-z0-9_-]{21}$/i,jwtRegex=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,durationRegex=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,emailRegex=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,_emojiRegex="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let emojiRegex$1;const ipv4Regex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4CidrRegex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6Regex=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,ipv6CidrRegex=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64Regex=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64urlRegex=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,dateRegexSource="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dateRegex=new RegExp(`^${dateRegexSource}$`);function timeRegexSource(s){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return s.precision?e=`${e}\\.\\d{${s.precision}}`:s.precision==null&&(e=`${e}(\\.\\d+)?`),e}function timeRegex(s){return new RegExp(`^${timeRegexSource(s)}$`)}function datetimeRegex(s){let e=`${dateRegexSource}T${timeRegexSource(s)}`;const t=[];return t.push(s.local?"Z?":"Z"),s.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function isValidIP(s,e){return!!((e==="v4"||!e)&&ipv4Regex.test(s)||(e==="v6"||!e)&&ipv6Regex.test(s))}function isValidJWT(s,e){if(!jwtRegex.test(s))return!1;try{const[t]=s.split("."),n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),r=JSON.parse(atob(n));return!(typeof r!="object"||r===null||!r.typ||!r.alg||e&&r.alg!==e)}catch{return!1}}function isValidCidr(s,e){return!!((e==="v4"||!e)&&ipv4CidrRegex.test(s)||(e==="v6"||!e)&&ipv6CidrRegex.test(s))}class ZodString extends ZodType{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ZodParsedType.string){const o=this._getOrReturnCtx(e);return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.string,received:o.parsedType}),INVALID}const n=new ParseStatus;let r;for(const o of this._def.checks)if(o.kind==="min")e.data.length<o.value&&(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:ZodIssueCode.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="max")e.data.length>o.value&&(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:ZodIssueCode.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="length"){const c=e.data.length>o.value,u=e.data.length<o.value;(c||u)&&(r=this._getOrReturnCtx(e,r),c?addIssueToContext(r,{code:ZodIssueCode.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):u&&addIssueToContext(r,{code:ZodIssueCode.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),n.dirty())}else if(o.kind==="email")emailRegex.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"email",code:ZodIssueCode.invalid_string,message:o.message}),n.dirty());else if(o.kind==="emoji")emojiRegex$1||(emojiRegex$1=new RegExp(_emojiRegex,"u")),emojiRegex$1.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"emoji",code:ZodIssueCode.invalid_string,message:o.message}),n.dirty());else if(o.kind==="uuid")uuidRegex.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"uuid",code:ZodIssueCode.invalid_string,message:o.message}),n.dirty());else if(o.kind==="nanoid")nanoidRegex.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"nanoid",code:ZodIssueCode.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid")cuidRegex.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"cuid",code:ZodIssueCode.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid2")cuid2Regex.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"cuid2",code:ZodIssueCode.invalid_string,message:o.message}),n.dirty());else if(o.kind==="ulid")ulidRegex.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"ulid",code:ZodIssueCode.invalid_string,message:o.message}),n.dirty());else if(o.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"url",code:ZodIssueCode.invalid_string,message:o.message}),n.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"regex",code:ZodIssueCode.invalid_string,message:o.message}),n.dirty())):o.kind==="trim"?e.data=e.data.trim():o.kind==="includes"?e.data.includes(o.value,o.position)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:ZodIssueCode.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),n.dirty()):o.kind==="toLowerCase"?e.data=e.data.toLowerCase():o.kind==="toUpperCase"?e.data=e.data.toUpperCase():o.kind==="startsWith"?e.data.startsWith(o.value)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:ZodIssueCode.invalid_string,validation:{startsWith:o.value},message:o.message}),n.dirty()):o.kind==="endsWith"?e.data.endsWith(o.value)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:ZodIssueCode.invalid_string,validation:{endsWith:o.value},message:o.message}),n.dirty()):o.kind==="datetime"?datetimeRegex(o).test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:ZodIssueCode.invalid_string,validation:"datetime",message:o.message}),n.dirty()):o.kind==="date"?dateRegex.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:ZodIssueCode.invalid_string,validation:"date",message:o.message}),n.dirty()):o.kind==="time"?timeRegex(o).test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:ZodIssueCode.invalid_string,validation:"time",message:o.message}),n.dirty()):o.kind==="duration"?durationRegex.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"duration",code:ZodIssueCode.invalid_string,message:o.message}),n.dirty()):o.kind==="ip"?isValidIP(e.data,o.version)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"ip",code:ZodIssueCode.invalid_string,message:o.message}),n.dirty()):o.kind==="jwt"?isValidJWT(e.data,o.alg)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"jwt",code:ZodIssueCode.invalid_string,message:o.message}),n.dirty()):o.kind==="cidr"?isValidCidr(e.data,o.version)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"cidr",code:ZodIssueCode.invalid_string,message:o.message}),n.dirty()):o.kind==="base64"?base64Regex.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"base64",code:ZodIssueCode.invalid_string,message:o.message}),n.dirty()):o.kind==="base64url"?base64urlRegex.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"base64url",code:ZodIssueCode.invalid_string,message:o.message}),n.dirty()):util.assertNever(o);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(r=>e.test(r),{validation:t,code:ZodIssueCode.invalid_string,...errorUtil.errToObj(n)})}_addCheck(e){return new ZodString({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...errorUtil.errToObj(e)})}url(e){return this._addCheck({kind:"url",...errorUtil.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...errorUtil.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...errorUtil.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...errorUtil.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...errorUtil.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...errorUtil.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...errorUtil.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...errorUtil.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...errorUtil.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...errorUtil.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...errorUtil.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...errorUtil.errToObj(e)})}datetime(e){var t,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,local:(n=e==null?void 0:e.local)!==null&&n!==void 0?n:!1,...errorUtil.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...errorUtil.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...errorUtil.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...errorUtil.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...errorUtil.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...errorUtil.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...errorUtil.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...errorUtil.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...errorUtil.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...errorUtil.errToObj(t)})}nonempty(e){return this.min(1,errorUtil.errToObj(e))}trim(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}ZodString.create=s=>{var e;return new ZodString({checks:[],typeName:ZodFirstPartyTypeKind.ZodString,coerce:(e=s==null?void 0:s.coerce)!==null&&e!==void 0?e:!1,...processCreateParams(s)})};function floatSafeRemainder(s,e){const t=(s.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,r=t>n?t:n,o=parseInt(s.toFixed(r).replace(".","")),c=parseInt(e.toFixed(r).replace(".",""));return o%c/Math.pow(10,r)}class ZodNumber extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ZodParsedType.number){const o=this._getOrReturnCtx(e);return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.number,received:o.parsedType}),INVALID}let n;const r=new ParseStatus;for(const o of this._def.checks)o.kind==="int"?util.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:"integer",received:"float",message:o.message}),r.dirty()):o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:ZodIssueCode.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),r.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:ZodIssueCode.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),r.dirty()):o.kind==="multipleOf"?floatSafeRemainder(e.data,o.value)!==0&&(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:ZodIssueCode.not_multiple_of,multipleOf:o.value,message:o.message}),r.dirty()):o.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:ZodIssueCode.not_finite,message:o.message}),r.dirty()):util.assertNever(o);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,errorUtil.toString(t))}setLimit(e,t,n,r){return new ZodNumber({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:errorUtil.toString(r)}]})}_addCheck(e){return new ZodNumber({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:errorUtil.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:errorUtil.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:errorUtil.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:errorUtil.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:errorUtil.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&util.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}ZodNumber.create=s=>new ZodNumber({checks:[],typeName:ZodFirstPartyTypeKind.ZodNumber,coerce:(s==null?void 0:s.coerce)||!1,...processCreateParams(s)});class ZodBigInt extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ZodParsedType.bigint)return this._getInvalidInput(e);let n;const r=new ParseStatus;for(const o of this._def.checks)o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:ZodIssueCode.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),r.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:ZodIssueCode.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),r.dirty()):o.kind==="multipleOf"?e.data%o.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:ZodIssueCode.not_multiple_of,multipleOf:o.value,message:o.message}),r.dirty()):util.assertNever(o);return{status:r.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.bigint,received:t.parsedType}),INVALID}gte(e,t){return this.setLimit("min",e,!0,errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,errorUtil.toString(t))}setLimit(e,t,n,r){return new ZodBigInt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:errorUtil.toString(r)}]})}_addCheck(e){return new ZodBigInt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:errorUtil.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}ZodBigInt.create=s=>{var e;return new ZodBigInt({checks:[],typeName:ZodFirstPartyTypeKind.ZodBigInt,coerce:(e=s==null?void 0:s.coerce)!==null&&e!==void 0?e:!1,...processCreateParams(s)})};class ZodBoolean extends ZodType{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ZodParsedType.boolean){const n=this._getOrReturnCtx(e);return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.boolean,received:n.parsedType}),INVALID}return OK(e.data)}}ZodBoolean.create=s=>new ZodBoolean({typeName:ZodFirstPartyTypeKind.ZodBoolean,coerce:(s==null?void 0:s.coerce)||!1,...processCreateParams(s)});class ZodDate extends ZodType{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ZodParsedType.date){const o=this._getOrReturnCtx(e);return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.date,received:o.parsedType}),INVALID}if(isNaN(e.data.getTime())){const o=this._getOrReturnCtx(e);return addIssueToContext(o,{code:ZodIssueCode.invalid_date}),INVALID}const n=new ParseStatus;let r;for(const o of this._def.checks)o.kind==="min"?e.data.getTime()<o.value&&(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:ZodIssueCode.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),n.dirty()):o.kind==="max"?e.data.getTime()>o.value&&(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:ZodIssueCode.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),n.dirty()):util.assertNever(o);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ZodDate({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:errorUtil.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:errorUtil.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}ZodDate.create=s=>new ZodDate({checks:[],coerce:(s==null?void 0:s.coerce)||!1,typeName:ZodFirstPartyTypeKind.ZodDate,...processCreateParams(s)});class ZodSymbol extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.symbol){const n=this._getOrReturnCtx(e);return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.symbol,received:n.parsedType}),INVALID}return OK(e.data)}}ZodSymbol.create=s=>new ZodSymbol({typeName:ZodFirstPartyTypeKind.ZodSymbol,...processCreateParams(s)});class ZodUndefined extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.undefined){const n=this._getOrReturnCtx(e);return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.undefined,received:n.parsedType}),INVALID}return OK(e.data)}}ZodUndefined.create=s=>new ZodUndefined({typeName:ZodFirstPartyTypeKind.ZodUndefined,...processCreateParams(s)});class ZodNull extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.null){const n=this._getOrReturnCtx(e);return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.null,received:n.parsedType}),INVALID}return OK(e.data)}}ZodNull.create=s=>new ZodNull({typeName:ZodFirstPartyTypeKind.ZodNull,...processCreateParams(s)});class ZodAny extends ZodType{constructor(){super(...arguments),this._any=!0}_parse(e){return OK(e.data)}}ZodAny.create=s=>new ZodAny({typeName:ZodFirstPartyTypeKind.ZodAny,...processCreateParams(s)});class ZodUnknown extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse(e){return OK(e.data)}}ZodUnknown.create=s=>new ZodUnknown({typeName:ZodFirstPartyTypeKind.ZodUnknown,...processCreateParams(s)});class ZodNever extends ZodType{_parse(e){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.never,received:t.parsedType}),INVALID}}ZodNever.create=s=>new ZodNever({typeName:ZodFirstPartyTypeKind.ZodNever,...processCreateParams(s)});class ZodVoid extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.undefined){const n=this._getOrReturnCtx(e);return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.void,received:n.parsedType}),INVALID}return OK(e.data)}}ZodVoid.create=s=>new ZodVoid({typeName:ZodFirstPartyTypeKind.ZodVoid,...processCreateParams(s)});class ZodArray extends ZodType{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),r=this._def;if(t.parsedType!==ZodParsedType.array)return addIssueToContext(t,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:t.parsedType}),INVALID;if(r.exactLength!==null){const c=t.data.length>r.exactLength.value,u=t.data.length<r.exactLength.value;(c||u)&&(addIssueToContext(t,{code:c?ZodIssueCode.too_big:ZodIssueCode.too_small,minimum:u?r.exactLength.value:void 0,maximum:c?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(r.minLength!==null&&t.data.length<r.minLength.value&&(addIssueToContext(t,{code:ZodIssueCode.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),r.maxLength!==null&&t.data.length>r.maxLength.value&&(addIssueToContext(t,{code:ZodIssueCode.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((c,u)=>r.type._parseAsync(new ParseInputLazyPath(t,c,t.path,u)))).then(c=>ParseStatus.mergeArray(n,c));const o=[...t.data].map((c,u)=>r.type._parseSync(new ParseInputLazyPath(t,c,t.path,u)));return ParseStatus.mergeArray(n,o)}get element(){return this._def.type}min(e,t){return new ZodArray({...this._def,minLength:{value:e,message:errorUtil.toString(t)}})}max(e,t){return new ZodArray({...this._def,maxLength:{value:e,message:errorUtil.toString(t)}})}length(e,t){return new ZodArray({...this._def,exactLength:{value:e,message:errorUtil.toString(t)}})}nonempty(e){return this.min(1,e)}}ZodArray.create=(s,e)=>new ZodArray({type:s,minLength:null,maxLength:null,exactLength:null,typeName:ZodFirstPartyTypeKind.ZodArray,...processCreateParams(e)});function deepPartialify(s){if(s instanceof ZodObject){const e={};for(const t in s.shape){const n=s.shape[t];e[t]=ZodOptional.create(deepPartialify(n))}return new ZodObject({...s._def,shape:()=>e})}else return s instanceof ZodArray?new ZodArray({...s._def,type:deepPartialify(s.element)}):s instanceof ZodOptional?ZodOptional.create(deepPartialify(s.unwrap())):s instanceof ZodNullable?ZodNullable.create(deepPartialify(s.unwrap())):s instanceof ZodTuple?ZodTuple.create(s.items.map(e=>deepPartialify(e))):s}class ZodObject extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=util.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==ZodParsedType.object){const f=this._getOrReturnCtx(e);return addIssueToContext(f,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:f.parsedType}),INVALID}const{status:n,ctx:r}=this._processInputParams(e),{shape:o,keys:c}=this._getCached(),u=[];if(!(this._def.catchall instanceof ZodNever&&this._def.unknownKeys==="strip"))for(const f in r.data)c.includes(f)||u.push(f);const h=[];for(const f of c){const p=o[f],g=r.data[f];h.push({key:{status:"valid",value:f},value:p._parse(new ParseInputLazyPath(r,g,r.path,f)),alwaysSet:f in r.data})}if(this._def.catchall instanceof ZodNever){const f=this._def.unknownKeys;if(f==="passthrough")for(const p of u)h.push({key:{status:"valid",value:p},value:{status:"valid",value:r.data[p]}});else if(f==="strict")u.length>0&&(addIssueToContext(r,{code:ZodIssueCode.unrecognized_keys,keys:u}),n.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const p of u){const g=r.data[p];h.push({key:{status:"valid",value:p},value:f._parse(new ParseInputLazyPath(r,g,r.path,p)),alwaysSet:p in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const f=[];for(const p of h){const g=await p.key,y=await p.value;f.push({key:g,value:y,alwaysSet:p.alwaysSet})}return f}).then(f=>ParseStatus.mergeObjectSync(n,f)):ParseStatus.mergeObjectSync(n,h)}get shape(){return this._def.shape()}strict(e){return errorUtil.errToObj,new ZodObject({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var r,o,c,u;const h=(c=(o=(r=this._def).errorMap)===null||o===void 0?void 0:o.call(r,t,n).message)!==null&&c!==void 0?c:n.defaultError;return t.code==="unrecognized_keys"?{message:(u=errorUtil.errToObj(e).message)!==null&&u!==void 0?u:h}:{message:h}}}:{}})}strip(){return new ZodObject({...this._def,unknownKeys:"strip"})}passthrough(){return new ZodObject({...this._def,unknownKeys:"passthrough"})}extend(e){return new ZodObject({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ZodObject({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ZodFirstPartyTypeKind.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new ZodObject({...this._def,catchall:e})}pick(e){const t={};return util.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new ZodObject({...this._def,shape:()=>t})}omit(e){const t={};return util.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new ZodObject({...this._def,shape:()=>t})}deepPartial(){return deepPartialify(this)}partial(e){const t={};return util.objectKeys(this.shape).forEach(n=>{const r=this.shape[n];e&&!e[n]?t[n]=r:t[n]=r.optional()}),new ZodObject({...this._def,shape:()=>t})}required(e){const t={};return util.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let o=this.shape[n];for(;o instanceof ZodOptional;)o=o._def.innerType;t[n]=o}}),new ZodObject({...this._def,shape:()=>t})}keyof(){return createZodEnum(util.objectKeys(this.shape))}}ZodObject.create=(s,e)=>new ZodObject({shape:()=>s,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(e)});ZodObject.strictCreate=(s,e)=>new ZodObject({shape:()=>s,unknownKeys:"strict",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(e)});ZodObject.lazycreate=(s,e)=>new ZodObject({shape:s,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(e)});class ZodUnion extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function r(o){for(const u of o)if(u.result.status==="valid")return u.result;for(const u of o)if(u.result.status==="dirty")return t.common.issues.push(...u.ctx.common.issues),u.result;const c=o.map(u=>new ZodError(u.ctx.common.issues));return addIssueToContext(t,{code:ZodIssueCode.invalid_union,unionErrors:c}),INVALID}if(t.common.async)return Promise.all(n.map(async o=>{const c={...t,common:{...t.common,issues:[]},parent:null};return{result:await o._parseAsync({data:t.data,path:t.path,parent:c}),ctx:c}})).then(r);{let o;const c=[];for(const h of n){const f={...t,common:{...t.common,issues:[]},parent:null},p=h._parseSync({data:t.data,path:t.path,parent:f});if(p.status==="valid")return p;p.status==="dirty"&&!o&&(o={result:p,ctx:f}),f.common.issues.length&&c.push(f.common.issues)}if(o)return t.common.issues.push(...o.ctx.common.issues),o.result;const u=c.map(h=>new ZodError(h));return addIssueToContext(t,{code:ZodIssueCode.invalid_union,unionErrors:u}),INVALID}}get options(){return this._def.options}}ZodUnion.create=(s,e)=>new ZodUnion({options:s,typeName:ZodFirstPartyTypeKind.ZodUnion,...processCreateParams(e)});const getDiscriminator=s=>s instanceof ZodLazy?getDiscriminator(s.schema):s instanceof ZodEffects?getDiscriminator(s.innerType()):s instanceof ZodLiteral?[s.value]:s instanceof ZodEnum?s.options:s instanceof ZodNativeEnum?util.objectValues(s.enum):s instanceof ZodDefault?getDiscriminator(s._def.innerType):s instanceof ZodUndefined?[void 0]:s instanceof ZodNull?[null]:s instanceof ZodOptional?[void 0,...getDiscriminator(s.unwrap())]:s instanceof ZodNullable?[null,...getDiscriminator(s.unwrap())]:s instanceof ZodBranded||s instanceof ZodReadonly?getDiscriminator(s.unwrap()):s instanceof ZodCatch?getDiscriminator(s._def.innerType):[];class ZodDiscriminatedUnion extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ZodParsedType.object)return addIssueToContext(t,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:t.parsedType}),INVALID;const n=this.discriminator,r=t.data[n],o=this.optionsMap.get(r);return o?t.common.async?o._parseAsync({data:t.data,path:t.path,parent:t}):o._parseSync({data:t.data,path:t.path,parent:t}):(addIssueToContext(t,{code:ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const r=new Map;for(const o of t){const c=getDiscriminator(o.shape[e]);if(!c.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const u of c){if(r.has(u))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(u)}`);r.set(u,o)}}return new ZodDiscriminatedUnion({typeName:ZodFirstPartyTypeKind.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r,...processCreateParams(n)})}}function mergeValues(s,e){const t=getParsedType(s),n=getParsedType(e);if(s===e)return{valid:!0,data:s};if(t===ZodParsedType.object&&n===ZodParsedType.object){const r=util.objectKeys(e),o=util.objectKeys(s).filter(u=>r.indexOf(u)!==-1),c={...s,...e};for(const u of o){const h=mergeValues(s[u],e[u]);if(!h.valid)return{valid:!1};c[u]=h.data}return{valid:!0,data:c}}else if(t===ZodParsedType.array&&n===ZodParsedType.array){if(s.length!==e.length)return{valid:!1};const r=[];for(let o=0;o<s.length;o++){const c=s[o],u=e[o],h=mergeValues(c,u);if(!h.valid)return{valid:!1};r.push(h.data)}return{valid:!0,data:r}}else return t===ZodParsedType.date&&n===ZodParsedType.date&&+s==+e?{valid:!0,data:s}:{valid:!1}}class ZodIntersection extends ZodType{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=(o,c)=>{if(isAborted(o)||isAborted(c))return INVALID;const u=mergeValues(o.value,c.value);return u.valid?((isDirty(o)||isDirty(c))&&t.dirty(),{status:t.value,value:u.data}):(addIssueToContext(n,{code:ZodIssueCode.invalid_intersection_types}),INVALID)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([o,c])=>r(o,c)):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}ZodIntersection.create=(s,e,t)=>new ZodIntersection({left:s,right:e,typeName:ZodFirstPartyTypeKind.ZodIntersection,...processCreateParams(t)});class ZodTuple extends ZodType{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ZodParsedType.array)return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:n.parsedType}),INVALID;if(n.data.length<this._def.items.length)return addIssueToContext(n,{code:ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),INVALID;!this._def.rest&&n.data.length>this._def.items.length&&(addIssueToContext(n,{code:ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const o=[...n.data].map((c,u)=>{const h=this._def.items[u]||this._def.rest;return h?h._parse(new ParseInputLazyPath(n,c,n.path,u)):null}).filter(c=>!!c);return n.common.async?Promise.all(o).then(c=>ParseStatus.mergeArray(t,c)):ParseStatus.mergeArray(t,o)}get items(){return this._def.items}rest(e){return new ZodTuple({...this._def,rest:e})}}ZodTuple.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:s,typeName:ZodFirstPartyTypeKind.ZodTuple,rest:null,...processCreateParams(e)})};class ZodRecord extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ZodParsedType.object)return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:n.parsedType}),INVALID;const r=[],o=this._def.keyType,c=this._def.valueType;for(const u in n.data)r.push({key:o._parse(new ParseInputLazyPath(n,u,n.path,u)),value:c._parse(new ParseInputLazyPath(n,n.data[u],n.path,u)),alwaysSet:u in n.data});return n.common.async?ParseStatus.mergeObjectAsync(t,r):ParseStatus.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof ZodType?new ZodRecord({keyType:e,valueType:t,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(n)}):new ZodRecord({keyType:ZodString.create(),valueType:e,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(t)})}}class ZodMap extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ZodParsedType.map)return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.map,received:n.parsedType}),INVALID;const r=this._def.keyType,o=this._def.valueType,c=[...n.data.entries()].map(([u,h],f)=>({key:r._parse(new ParseInputLazyPath(n,u,n.path,[f,"key"])),value:o._parse(new ParseInputLazyPath(n,h,n.path,[f,"value"]))}));if(n.common.async){const u=new Map;return Promise.resolve().then(async()=>{for(const h of c){const f=await h.key,p=await h.value;if(f.status==="aborted"||p.status==="aborted")return INVALID;(f.status==="dirty"||p.status==="dirty")&&t.dirty(),u.set(f.value,p.value)}return{status:t.value,value:u}})}else{const u=new Map;for(const h of c){const f=h.key,p=h.value;if(f.status==="aborted"||p.status==="aborted")return INVALID;(f.status==="dirty"||p.status==="dirty")&&t.dirty(),u.set(f.value,p.value)}return{status:t.value,value:u}}}}ZodMap.create=(s,e,t)=>new ZodMap({valueType:e,keyType:s,typeName:ZodFirstPartyTypeKind.ZodMap,...processCreateParams(t)});class ZodSet extends ZodType{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ZodParsedType.set)return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.set,received:n.parsedType}),INVALID;const r=this._def;r.minSize!==null&&n.data.size<r.minSize.value&&(addIssueToContext(n,{code:ZodIssueCode.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),r.maxSize!==null&&n.data.size>r.maxSize.value&&(addIssueToContext(n,{code:ZodIssueCode.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());const o=this._def.valueType;function c(h){const f=new Set;for(const p of h){if(p.status==="aborted")return INVALID;p.status==="dirty"&&t.dirty(),f.add(p.value)}return{status:t.value,value:f}}const u=[...n.data.values()].map((h,f)=>o._parse(new ParseInputLazyPath(n,h,n.path,f)));return n.common.async?Promise.all(u).then(h=>c(h)):c(u)}min(e,t){return new ZodSet({...this._def,minSize:{value:e,message:errorUtil.toString(t)}})}max(e,t){return new ZodSet({...this._def,maxSize:{value:e,message:errorUtil.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ZodSet.create=(s,e)=>new ZodSet({valueType:s,minSize:null,maxSize:null,typeName:ZodFirstPartyTypeKind.ZodSet,...processCreateParams(e)});class ZodFunction extends ZodType{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ZodParsedType.function)return addIssueToContext(t,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.function,received:t.parsedType}),INVALID;function n(u,h){return makeIssue({data:u,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,getErrorMap(),errorMap].filter(f=>!!f),issueData:{code:ZodIssueCode.invalid_arguments,argumentsError:h}})}function r(u,h){return makeIssue({data:u,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,getErrorMap(),errorMap].filter(f=>!!f),issueData:{code:ZodIssueCode.invalid_return_type,returnTypeError:h}})}const o={errorMap:t.common.contextualErrorMap},c=t.data;if(this._def.returns instanceof ZodPromise){const u=this;return OK(async function(...h){const f=new ZodError([]),p=await u._def.args.parseAsync(h,o).catch(v=>{throw f.addIssue(n(h,v)),f}),g=await Reflect.apply(c,this,p);return await u._def.returns._def.type.parseAsync(g,o).catch(v=>{throw f.addIssue(r(g,v)),f})})}else{const u=this;return OK(function(...h){const f=u._def.args.safeParse(h,o);if(!f.success)throw new ZodError([n(h,f.error)]);const p=Reflect.apply(c,this,f.data),g=u._def.returns.safeParse(p,o);if(!g.success)throw new ZodError([r(p,g.error)]);return g.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ZodFunction({...this._def,args:ZodTuple.create(e).rest(ZodUnknown.create())})}returns(e){return new ZodFunction({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new ZodFunction({args:e||ZodTuple.create([]).rest(ZodUnknown.create()),returns:t||ZodUnknown.create(),typeName:ZodFirstPartyTypeKind.ZodFunction,...processCreateParams(n)})}}class ZodLazy extends ZodType{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}ZodLazy.create=(s,e)=>new ZodLazy({getter:s,typeName:ZodFirstPartyTypeKind.ZodLazy,...processCreateParams(e)});class ZodLiteral extends ZodType{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{received:t.data,code:ZodIssueCode.invalid_literal,expected:this._def.value}),INVALID}return{status:"valid",value:e.data}}get value(){return this._def.value}}ZodLiteral.create=(s,e)=>new ZodLiteral({value:s,typeName:ZodFirstPartyTypeKind.ZodLiteral,...processCreateParams(e)});function createZodEnum(s,e){return new ZodEnum({values:s,typeName:ZodFirstPartyTypeKind.ZodEnum,...processCreateParams(e)})}class ZodEnum extends ZodType{constructor(){super(...arguments),_ZodEnum_cache.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return addIssueToContext(t,{expected:util.joinValues(n),received:t.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodEnum_cache)||__classPrivateFieldSet(this,_ZodEnum_cache,new Set(this._def.values)),!__classPrivateFieldGet(this,_ZodEnum_cache).has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return addIssueToContext(t,{received:t.data,code:ZodIssueCode.invalid_enum_value,options:n}),INVALID}return OK(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return ZodEnum.create(e,{...this._def,...t})}exclude(e,t=this._def){return ZodEnum.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}}_ZodEnum_cache=new WeakMap;ZodEnum.create=createZodEnum;class ZodNativeEnum extends ZodType{constructor(){super(...arguments),_ZodNativeEnum_cache.set(this,void 0)}_parse(e){const t=util.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==ZodParsedType.string&&n.parsedType!==ZodParsedType.number){const r=util.objectValues(t);return addIssueToContext(n,{expected:util.joinValues(r),received:n.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodNativeEnum_cache)||__classPrivateFieldSet(this,_ZodNativeEnum_cache,new Set(util.getValidEnumValues(this._def.values))),!__classPrivateFieldGet(this,_ZodNativeEnum_cache).has(e.data)){const r=util.objectValues(t);return addIssueToContext(n,{received:n.data,code:ZodIssueCode.invalid_enum_value,options:r}),INVALID}return OK(e.data)}get enum(){return this._def.values}}_ZodNativeEnum_cache=new WeakMap;ZodNativeEnum.create=(s,e)=>new ZodNativeEnum({values:s,typeName:ZodFirstPartyTypeKind.ZodNativeEnum,...processCreateParams(e)});class ZodPromise extends ZodType{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ZodParsedType.promise&&t.common.async===!1)return addIssueToContext(t,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.promise,received:t.parsedType}),INVALID;const n=t.parsedType===ZodParsedType.promise?t.data:Promise.resolve(t.data);return OK(n.then(r=>this._def.type.parseAsync(r,{path:t.path,errorMap:t.common.contextualErrorMap})))}}ZodPromise.create=(s,e)=>new ZodPromise({type:s,typeName:ZodFirstPartyTypeKind.ZodPromise,...processCreateParams(e)});class ZodEffects extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ZodFirstPartyTypeKind.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null,o={addIssue:c=>{addIssueToContext(n,c),c.fatal?t.abort():t.dirty()},get path(){return n.path}};if(o.addIssue=o.addIssue.bind(o),r.type==="preprocess"){const c=r.transform(n.data,o);if(n.common.async)return Promise.resolve(c).then(async u=>{if(t.value==="aborted")return INVALID;const h=await this._def.schema._parseAsync({data:u,path:n.path,parent:n});return h.status==="aborted"?INVALID:h.status==="dirty"||t.value==="dirty"?DIRTY(h.value):h});{if(t.value==="aborted")return INVALID;const u=this._def.schema._parseSync({data:c,path:n.path,parent:n});return u.status==="aborted"?INVALID:u.status==="dirty"||t.value==="dirty"?DIRTY(u.value):u}}if(r.type==="refinement"){const c=u=>{const h=r.refinement(u,o);if(n.common.async)return Promise.resolve(h);if(h instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(n.common.async===!1){const u=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return u.status==="aborted"?INVALID:(u.status==="dirty"&&t.dirty(),c(u.value),{status:t.value,value:u.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(u=>u.status==="aborted"?INVALID:(u.status==="dirty"&&t.dirty(),c(u.value).then(()=>({status:t.value,value:u.value}))))}if(r.type==="transform")if(n.common.async===!1){const c=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!isValid(c))return c;const u=r.transform(c.value,o);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:u}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(c=>isValid(c)?Promise.resolve(r.transform(c.value,o)).then(u=>({status:t.value,value:u})):c);util.assertNever(r)}}ZodEffects.create=(s,e,t)=>new ZodEffects({schema:s,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:e,...processCreateParams(t)});ZodEffects.createWithPreprocess=(s,e,t)=>new ZodEffects({schema:e,effect:{type:"preprocess",transform:s},typeName:ZodFirstPartyTypeKind.ZodEffects,...processCreateParams(t)});class ZodOptional extends ZodType{_parse(e){return this._getType(e)===ZodParsedType.undefined?OK(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ZodOptional.create=(s,e)=>new ZodOptional({innerType:s,typeName:ZodFirstPartyTypeKind.ZodOptional,...processCreateParams(e)});class ZodNullable extends ZodType{_parse(e){return this._getType(e)===ZodParsedType.null?OK(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ZodNullable.create=(s,e)=>new ZodNullable({innerType:s,typeName:ZodFirstPartyTypeKind.ZodNullable,...processCreateParams(e)});class ZodDefault extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===ZodParsedType.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}ZodDefault.create=(s,e)=>new ZodDefault({innerType:s,typeName:ZodFirstPartyTypeKind.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...processCreateParams(e)});class ZodCatch extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return isAsync(r)?r.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new ZodError(n.common.issues)},input:n.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new ZodError(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}ZodCatch.create=(s,e)=>new ZodCatch({innerType:s,typeName:ZodFirstPartyTypeKind.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...processCreateParams(e)});class ZodNaN extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.nan){const n=this._getOrReturnCtx(e);return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.nan,received:n.parsedType}),INVALID}return{status:"valid",value:e.data}}}ZodNaN.create=s=>new ZodNaN({typeName:ZodFirstPartyTypeKind.ZodNaN,...processCreateParams(s)});const BRAND=Symbol("zod_brand");class ZodBranded extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class ZodPipeline extends ZodType{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const o=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?INVALID:o.status==="dirty"?(t.dirty(),DIRTY(o.value)):this._def.out._parseAsync({data:o.value,path:n.path,parent:n})})();{const r=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return r.status==="aborted"?INVALID:r.status==="dirty"?(t.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:n.path,parent:n})}}static create(e,t){return new ZodPipeline({in:e,out:t,typeName:ZodFirstPartyTypeKind.ZodPipeline})}}class ZodReadonly extends ZodType{_parse(e){const t=this._def.innerType._parse(e),n=r=>(isValid(r)&&(r.value=Object.freeze(r.value)),r);return isAsync(t)?t.then(r=>n(r)):n(t)}unwrap(){return this._def.innerType}}ZodReadonly.create=(s,e)=>new ZodReadonly({innerType:s,typeName:ZodFirstPartyTypeKind.ZodReadonly,...processCreateParams(e)});function cleanParams(s,e){const t=typeof s=="function"?s(e):typeof s=="string"?{message:s}:s;return typeof t=="string"?{message:t}:t}function custom(s,e={},t){return s?ZodAny.create().superRefine((n,r)=>{var o,c;const u=s(n);if(u instanceof Promise)return u.then(h=>{var f,p;if(!h){const g=cleanParams(e,n),y=(p=(f=g.fatal)!==null&&f!==void 0?f:t)!==null&&p!==void 0?p:!0;r.addIssue({code:"custom",...g,fatal:y})}});if(!u){const h=cleanParams(e,n),f=(c=(o=h.fatal)!==null&&o!==void 0?o:t)!==null&&c!==void 0?c:!0;r.addIssue({code:"custom",...h,fatal:f})}}):ZodAny.create()}const late={object:ZodObject.lazycreate};var ZodFirstPartyTypeKind;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(ZodFirstPartyTypeKind||(ZodFirstPartyTypeKind={}));const instanceOfType=(s,e={message:`Input not instance of ${s.name}`})=>custom(t=>t instanceof s,e),stringType=ZodString.create,numberType=ZodNumber.create,nanType=ZodNaN.create,bigIntType=ZodBigInt.create,booleanType=ZodBoolean.create,dateType=ZodDate.create,symbolType=ZodSymbol.create,undefinedType=ZodUndefined.create,nullType=ZodNull.create,anyType=ZodAny.create,unknownType=ZodUnknown.create,neverType=ZodNever.create,voidType=ZodVoid.create,arrayType=ZodArray.create,objectType=ZodObject.create,strictObjectType=ZodObject.strictCreate,unionType=ZodUnion.create,discriminatedUnionType=ZodDiscriminatedUnion.create,intersectionType=ZodIntersection.create,tupleType=ZodTuple.create,recordType=ZodRecord.create,mapType=ZodMap.create,setType=ZodSet.create,functionType=ZodFunction.create,lazyType=ZodLazy.create,literalType=ZodLiteral.create,enumType=ZodEnum.create,nativeEnumType=ZodNativeEnum.create,promiseType=ZodPromise.create,effectsType=ZodEffects.create,optionalType=ZodOptional.create,nullableType=ZodNullable.create,preprocessType=ZodEffects.createWithPreprocess,pipelineType=ZodPipeline.create,ostring=()=>stringType().optional(),onumber=()=>numberType().optional(),oboolean=()=>booleanType().optional(),coerce={string:s=>ZodString.create({...s,coerce:!0}),number:s=>ZodNumber.create({...s,coerce:!0}),boolean:s=>ZodBoolean.create({...s,coerce:!0}),bigint:s=>ZodBigInt.create({...s,coerce:!0}),date:s=>ZodDate.create({...s,coerce:!0})},NEVER=INVALID;var z=Object.freeze({__proto__:null,defaultErrorMap:errorMap,setErrorMap,getErrorMap,makeIssue,EMPTY_PATH,addIssueToContext,ParseStatus,INVALID,DIRTY,OK,isAborted,isDirty,isValid,isAsync,get util(){return util},get objectUtil(){return objectUtil},ZodParsedType,getParsedType,ZodType,datetimeRegex,ZodString,ZodNumber,ZodBigInt,ZodBoolean,ZodDate,ZodSymbol,ZodUndefined,ZodNull,ZodAny,ZodUnknown,ZodNever,ZodVoid,ZodArray,ZodObject,ZodUnion,ZodDiscriminatedUnion,ZodIntersection,ZodTuple,ZodRecord,ZodMap,ZodSet,ZodFunction,ZodLazy,ZodLiteral,ZodEnum,ZodNativeEnum,ZodPromise,ZodEffects,ZodTransformer:ZodEffects,ZodOptional,ZodNullable,ZodDefault,ZodCatch,ZodNaN,BRAND,ZodBranded,ZodPipeline,ZodReadonly,custom,Schema:ZodType,ZodSchema:ZodType,late,get ZodFirstPartyTypeKind(){return ZodFirstPartyTypeKind},coerce,any:anyType,array:arrayType,bigint:bigIntType,boolean:booleanType,date:dateType,discriminatedUnion:discriminatedUnionType,effect:effectsType,enum:enumType,function:functionType,instanceof:instanceOfType,intersection:intersectionType,lazy:lazyType,literal:literalType,map:mapType,nan:nanType,nativeEnum:nativeEnumType,never:neverType,null:nullType,nullable:nullableType,number:numberType,object:objectType,oboolean,onumber,optional:optionalType,ostring,pipeline:pipelineType,preprocess:preprocessType,promise:promiseType,record:recordType,set:setType,strictObject:strictObjectType,string:stringType,symbol:symbolType,transformer:effectsType,tuple:tupleType,undefined:undefinedType,union:unionType,unknown:unknownType,void:voidType,NEVER,ZodIssueCode,quotelessJson,ZodError});function parseAnyDef(){return{}}function parseArrayDef(s,e){var n,r,o;const t={type:"array"};return(n=s.type)!=null&&n._def&&((o=(r=s.type)==null?void 0:r._def)==null?void 0:o.typeName)!==ZodFirstPartyTypeKind.ZodAny&&(t.items=parseDef(s.type._def,{...e,currentPath:[...e.currentPath,"items"]})),s.minLength&&setResponseValueAndErrors(t,"minItems",s.minLength.value,s.minLength.message,e),s.maxLength&&setResponseValueAndErrors(t,"maxItems",s.maxLength.value,s.maxLength.message,e),s.exactLength&&(setResponseValueAndErrors(t,"minItems",s.exactLength.value,s.exactLength.message,e),setResponseValueAndErrors(t,"maxItems",s.exactLength.value,s.exactLength.message,e)),t}function parseBigintDef(s,e){const t={type:"integer",format:"int64"};if(!s.checks)return t;for(const n of s.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?setResponseValueAndErrors(t,"minimum",n.value,n.message,e):setResponseValueAndErrors(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),setResponseValueAndErrors(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?setResponseValueAndErrors(t,"maximum",n.value,n.message,e):setResponseValueAndErrors(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),setResponseValueAndErrors(t,"maximum",n.value,n.message,e));break;case"multipleOf":setResponseValueAndErrors(t,"multipleOf",n.value,n.message,e);break}return t}function parseBooleanDef(){return{type:"boolean"}}function parseBrandedDef(s,e){return parseDef(s.type._def,e)}const parseCatchDef=(s,e)=>parseDef(s.innerType._def,e);function parseDateDef(s,e,t){const n=t??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((r,o)=>parseDateDef(s,e,r))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return integerDateParser(s,e)}}const integerDateParser=(s,e)=>{const t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(const n of s.checks)switch(n.kind){case"min":setResponseValueAndErrors(t,"minimum",n.value,n.message,e);break;case"max":setResponseValueAndErrors(t,"maximum",n.value,n.message,e);break}return t};function parseDefaultDef(s,e){return{...parseDef(s.innerType._def,e),default:s.defaultValue()}}function parseEffectsDef(s,e){return e.effectStrategy==="input"?parseDef(s.schema._def,e):{}}function parseEnumDef(s){return{type:"string",enum:Array.from(s.values)}}const isJsonSchema7AllOfType=s=>"type"in s&&s.type==="string"?!1:"allOf"in s;function parseIntersectionDef(s,e){const t=[parseDef(s.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),parseDef(s.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(o=>!!o);let n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const r=[];return t.forEach(o=>{if(isJsonSchema7AllOfType(o))r.push(...o.allOf),o.unevaluatedProperties===void 0&&(n=void 0);else{let c=o;if("additionalProperties"in o&&o.additionalProperties===!1){const{additionalProperties:u,...h}=o;c=h}else n=void 0;r.push(c)}}),r.length?{allOf:r,...n}:void 0}function parseLiteralDef(s,e){const t=typeof s.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(s.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[s.value]}:{type:t==="bigint"?"integer":t,const:s.value}}let emojiRegex;const zodPatterns={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(emojiRegex===void 0&&(emojiRegex=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),emojiRegex),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function parseStringDef(s,e){const t={type:"string"};if(s.checks)for(const n of s.checks)switch(n.kind){case"min":setResponseValueAndErrors(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,n.value):n.value,n.message,e);break;case"max":setResponseValueAndErrors(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,n.value):n.value,n.message,e);break;case"email":switch(e.emailStrategy){case"format:email":addFormat(t,"email",n.message,e);break;case"format:idn-email":addFormat(t,"idn-email",n.message,e);break;case"pattern:zod":addPattern(t,zodPatterns.email,n.message,e);break}break;case"url":addFormat(t,"uri",n.message,e);break;case"uuid":addFormat(t,"uuid",n.message,e);break;case"regex":addPattern(t,n.regex,n.message,e);break;case"cuid":addPattern(t,zodPatterns.cuid,n.message,e);break;case"cuid2":addPattern(t,zodPatterns.cuid2,n.message,e);break;case"startsWith":addPattern(t,RegExp(`^${escapeLiteralCheckValue(n.value,e)}`),n.message,e);break;case"endsWith":addPattern(t,RegExp(`${escapeLiteralCheckValue(n.value,e)}$`),n.message,e);break;case"datetime":addFormat(t,"date-time",n.message,e);break;case"date":addFormat(t,"date",n.message,e);break;case"time":addFormat(t,"time",n.message,e);break;case"duration":addFormat(t,"duration",n.message,e);break;case"length":setResponseValueAndErrors(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,n.value):n.value,n.message,e),setResponseValueAndErrors(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,n.value):n.value,n.message,e);break;case"includes":{addPattern(t,RegExp(escapeLiteralCheckValue(n.value,e)),n.message,e);break}case"ip":{n.version!=="v6"&&addFormat(t,"ipv4",n.message,e),n.version!=="v4"&&addFormat(t,"ipv6",n.message,e);break}case"base64url":addPattern(t,zodPatterns.base64url,n.message,e);break;case"jwt":addPattern(t,zodPatterns.jwt,n.message,e);break;case"cidr":{n.version!=="v6"&&addPattern(t,zodPatterns.ipv4Cidr,n.message,e),n.version!=="v4"&&addPattern(t,zodPatterns.ipv6Cidr,n.message,e);break}case"emoji":addPattern(t,zodPatterns.emoji(),n.message,e);break;case"ulid":{addPattern(t,zodPatterns.ulid,n.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{addFormat(t,"binary",n.message,e);break}case"contentEncoding:base64":{setResponseValueAndErrors(t,"contentEncoding","base64",n.message,e);break}case"pattern:zod":{addPattern(t,zodPatterns.base64,n.message,e);break}}break}case"nanoid":addPattern(t,zodPatterns.nanoid,n.message,e)}return t}function escapeLiteralCheckValue(s,e){return e.patternStrategy==="escape"?escapeNonAlphaNumeric(s):s}const ALPHA_NUMERIC=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function escapeNonAlphaNumeric(s){let e="";for(let t=0;t<s.length;t++)ALPHA_NUMERIC.has(s[t])||(e+="\\"),e+=s[t];return e}function addFormat(s,e,t,n){var r;s.format||(r=s.anyOf)!=null&&r.some(o=>o.format)?(s.anyOf||(s.anyOf=[]),s.format&&(s.anyOf.push({format:s.format,...s.errorMessage&&n.errorMessages&&{errorMessage:{format:s.errorMessage.format}}}),delete s.format,s.errorMessage&&(delete s.errorMessage.format,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.anyOf.push({format:e,...t&&n.errorMessages&&{errorMessage:{format:t}}})):setResponseValueAndErrors(s,"format",e,t,n)}function addPattern(s,e,t,n){var r;s.pattern||(r=s.allOf)!=null&&r.some(o=>o.pattern)?(s.allOf||(s.allOf=[]),s.pattern&&(s.allOf.push({pattern:s.pattern,...s.errorMessage&&n.errorMessages&&{errorMessage:{pattern:s.errorMessage.pattern}}}),delete s.pattern,s.errorMessage&&(delete s.errorMessage.pattern,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.allOf.push({pattern:stringifyRegExpWithFlags(e,n),...t&&n.errorMessages&&{errorMessage:{pattern:t}}})):setResponseValueAndErrors(s,"pattern",stringifyRegExpWithFlags(e,n),t,n)}function stringifyRegExpWithFlags(s,e){var h;if(!e.applyRegexFlags||!s.flags)return s.source;const t={i:s.flags.includes("i"),m:s.flags.includes("m"),s:s.flags.includes("s")},n=t.i?s.source.toLowerCase():s.source;let r="",o=!1,c=!1,u=!1;for(let f=0;f<n.length;f++){if(o){r+=n[f],o=!1;continue}if(t.i){if(c){if(n[f].match(/[a-z]/)){u?(r+=n[f],r+=`${n[f-2]}-${n[f]}`.toUpperCase(),u=!1):n[f+1]==="-"&&((h=n[f+2])!=null&&h.match(/[a-z]/))?(r+=n[f],u=!0):r+=`${n[f]}${n[f].toUpperCase()}`;continue}}else if(n[f].match(/[a-z]/)){r+=`[${n[f]}${n[f].toUpperCase()}]`;continue}}if(t.m){if(n[f]==="^"){r+=`(^|(?<=[\r
]))`;continue}else if(n[f]==="$"){r+=`($|(?=[\r
]))`;continue}}if(t.s&&n[f]==="."){r+=c?`${n[f]}\r
`:`[${n[f]}\r
]`;continue}r+=n[f],n[f]==="\\"?o=!0:c&&n[f]==="]"?c=!1:!c&&n[f]==="["&&(c=!0)}try{new RegExp(r)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),s.source}return r}function parseRecordDef(s,e){var n,r,o,c,u,h;if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&((n=s.keyType)==null?void 0:n._def.typeName)===ZodFirstPartyTypeKind.ZodEnum)return{type:"object",required:s.keyType._def.values,properties:s.keyType._def.values.reduce((f,p)=>({...f,[p]:parseDef(s.valueType._def,{...e,currentPath:[...e.currentPath,"properties",p]})??{}}),{}),additionalProperties:!1};const t={type:"object",additionalProperties:parseDef(s.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return t;if(((r=s.keyType)==null?void 0:r._def.typeName)===ZodFirstPartyTypeKind.ZodString&&((o=s.keyType._def.checks)!=null&&o.length)){const{type:f,...p}=parseStringDef(s.keyType._def,e);return{...t,propertyNames:p}}else{if(((c=s.keyType)==null?void 0:c._def.typeName)===ZodFirstPartyTypeKind.ZodEnum)return{...t,propertyNames:{enum:s.keyType._def.values}};if(((u=s.keyType)==null?void 0:u._def.typeName)===ZodFirstPartyTypeKind.ZodBranded&&s.keyType._def.type._def.typeName===ZodFirstPartyTypeKind.ZodString&&((h=s.keyType._def.type._def.checks)!=null&&h.length)){const{type:f,...p}=parseBrandedDef(s.keyType._def,e);return{...t,propertyNames:p}}}return t}function parseMapDef(s,e){if(e.mapStrategy==="record")return parseRecordDef(s,e);const t=parseDef(s.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},n=parseDef(s.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[t,n],minItems:2,maxItems:2}}}function parseNativeEnumDef(s){const e=s.values,n=Object.keys(s.values).filter(o=>typeof e[e[o]]!="number").map(o=>e[o]),r=Array.from(new Set(n.map(o=>typeof o)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function parseNeverDef(){return{not:{}}}function parseNullDef(s){return s.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const primitiveMappings={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function parseUnionDef(s,e){if(e.target==="openApi3")return asAnyOf(s,e);const t=s.options instanceof Map?Array.from(s.options.values()):s.options;if(t.every(n=>n._def.typeName in primitiveMappings&&(!n._def.checks||!n._def.checks.length))){const n=t.reduce((r,o)=>{const c=primitiveMappings[o._def.typeName];return c&&!r.includes(c)?[...r,c]:r},[]);return{type:n.length>1?n:n[0]}}else if(t.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){const n=t.reduce((r,o)=>{const c=typeof o._def.value;switch(c){case"string":case"number":case"boolean":return[...r,c];case"bigint":return[...r,"integer"];case"object":if(o._def.value===null)return[...r,"null"];case"symbol":case"undefined":case"function":default:return r}},[]);if(n.length===t.length){const r=n.filter((o,c,u)=>u.indexOf(o)===c);return{type:r.length>1?r:r[0],enum:t.reduce((o,c)=>o.includes(c._def.value)?o:[...o,c._def.value],[])}}}else if(t.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((n,r)=>[...n,...r._def.values.filter(o=>!n.includes(o))],[])};return asAnyOf(s,e)}const asAnyOf=(s,e)=>{const t=(s.options instanceof Map?Array.from(s.options.values()):s.options).map((n,r)=>parseDef(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${r}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return t.length?{anyOf:t}:void 0};function parseNullableDef(s,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(s.innerType._def.typeName)&&(!s.innerType._def.checks||!s.innerType._def.checks.length))return e.target==="openApi3"?{type:primitiveMappings[s.innerType._def.typeName],nullable:!0}:{type:[primitiveMappings[s.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const n=parseDef(s.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}const t=parseDef(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function parseNumberDef(s,e){const t={type:"number"};if(!s.checks)return t;for(const n of s.checks)switch(n.kind){case"int":t.type="integer",addErrorMessage(t,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?setResponseValueAndErrors(t,"minimum",n.value,n.message,e):setResponseValueAndErrors(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),setResponseValueAndErrors(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?setResponseValueAndErrors(t,"maximum",n.value,n.message,e):setResponseValueAndErrors(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),setResponseValueAndErrors(t,"maximum",n.value,n.message,e));break;case"multipleOf":setResponseValueAndErrors(t,"multipleOf",n.value,n.message,e);break}return t}function decideAdditionalProperties(s,e){return e.removeAdditionalStrategy==="strict"?s.catchall._def.typeName==="ZodNever"?s.unknownKeys!=="strict":parseDef(s.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:s.catchall._def.typeName==="ZodNever"?s.unknownKeys==="passthrough":parseDef(s.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function parseObjectDef(s,e){const t=e.target==="openAi",n={type:"object",...Object.entries(s.shape()).reduce((r,[o,c])=>{if(c===void 0||c._def===void 0)return r;let u=c.isOptional();u&&t&&(c instanceof ZodOptional&&(c=c._def.innerType),c.isNullable()||(c=c.nullable()),u=!1);const h=parseDef(c._def,{...e,currentPath:[...e.currentPath,"properties",o],propertyPath:[...e.currentPath,"properties",o]});return h===void 0?r:{properties:{...r.properties,[o]:h},required:u?r.required:[...r.required,o]}},{properties:{},required:[]}),additionalProperties:decideAdditionalProperties(s,e)};return n.required.length||delete n.required,n}const parseOptionalDef=(s,e)=>{var n;if(e.currentPath.toString()===((n=e.propertyPath)==null?void 0:n.toString()))return parseDef(s.innerType._def,e);const t=parseDef(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:{}},t]}:{}},parsePipelineDef=(s,e)=>{if(e.pipeStrategy==="input")return parseDef(s.in._def,e);if(e.pipeStrategy==="output")return parseDef(s.out._def,e);const t=parseDef(s.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=parseDef(s.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,n].filter(r=>r!==void 0)}};function parsePromiseDef(s,e){return parseDef(s.type._def,e)}function parseSetDef(s,e){const n={type:"array",uniqueItems:!0,items:parseDef(s.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return s.minSize&&setResponseValueAndErrors(n,"minItems",s.minSize.value,s.minSize.message,e),s.maxSize&&setResponseValueAndErrors(n,"maxItems",s.maxSize.value,s.maxSize.message,e),n}function parseTupleDef(s,e){return s.rest?{type:"array",minItems:s.items.length,items:s.items.map((t,n)=>parseDef(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[]),additionalItems:parseDef(s.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:s.items.length,maxItems:s.items.length,items:s.items.map((t,n)=>parseDef(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[])}}function parseUndefinedDef(){return{not:{}}}function parseUnknownDef(){return{}}const parseReadonlyDef=(s,e)=>parseDef(s.innerType._def,e);function parseDef(s,e,t=!1){var c;const n=e.seen.get(s);if(e.override){const u=(c=e.override)==null?void 0:c.call(e,s,e,n,t);if(u!==ignoreOverride)return u}if(n&&!t){const u=get$ref(n,e);if(u!==void 0)return u}const r={def:s,path:e.currentPath,jsonSchema:void 0};e.seen.set(s,r);const o=selectParser(s,s.typeName,e);return o&&addMeta(s,e,o),r.jsonSchema=o,o}const get$ref=(s,e)=>{switch(e.$refStrategy){case"root":return{$ref:s.path.join("/")};case"relative":return{$ref:getRelativePath(e.currentPath,s.path)};case"none":case"seen":return s.path.length<e.currentPath.length&&s.path.every((t,n)=>e.currentPath[n]===t)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},getRelativePath=(s,e)=>{let t=0;for(;t<s.length&&t<e.length&&s[t]===e[t];t++);return[(s.length-t).toString(),...e.slice(t)].join("/")},selectParser=(s,e,t)=>{switch(e){case ZodFirstPartyTypeKind.ZodString:return parseStringDef(s,t);case ZodFirstPartyTypeKind.ZodNumber:return parseNumberDef(s,t);case ZodFirstPartyTypeKind.ZodObject:return parseObjectDef(s,t);case ZodFirstPartyTypeKind.ZodBigInt:return parseBigintDef(s,t);case ZodFirstPartyTypeKind.ZodBoolean:return parseBooleanDef();case ZodFirstPartyTypeKind.ZodDate:return parseDateDef(s,t);case ZodFirstPartyTypeKind.ZodUndefined:return parseUndefinedDef();case ZodFirstPartyTypeKind.ZodNull:return parseNullDef(t);case ZodFirstPartyTypeKind.ZodArray:return parseArrayDef(s,t);case ZodFirstPartyTypeKind.ZodUnion:case ZodFirstPartyTypeKind.ZodDiscriminatedUnion:return parseUnionDef(s,t);case ZodFirstPartyTypeKind.ZodIntersection:return parseIntersectionDef(s,t);case ZodFirstPartyTypeKind.ZodTuple:return parseTupleDef(s,t);case ZodFirstPartyTypeKind.ZodRecord:return parseRecordDef(s,t);case ZodFirstPartyTypeKind.ZodLiteral:return parseLiteralDef(s,t);case ZodFirstPartyTypeKind.ZodEnum:return parseEnumDef(s);case ZodFirstPartyTypeKind.ZodNativeEnum:return parseNativeEnumDef(s);case ZodFirstPartyTypeKind.ZodNullable:return parseNullableDef(s,t);case ZodFirstPartyTypeKind.ZodOptional:return parseOptionalDef(s,t);case ZodFirstPartyTypeKind.ZodMap:return parseMapDef(s,t);case ZodFirstPartyTypeKind.ZodSet:return parseSetDef(s,t);case ZodFirstPartyTypeKind.ZodLazy:return parseDef(s.getter()._def,t);case ZodFirstPartyTypeKind.ZodPromise:return parsePromiseDef(s,t);case ZodFirstPartyTypeKind.ZodNaN:case ZodFirstPartyTypeKind.ZodNever:return parseNeverDef();case ZodFirstPartyTypeKind.ZodEffects:return parseEffectsDef(s,t);case ZodFirstPartyTypeKind.ZodAny:return parseAnyDef();case ZodFirstPartyTypeKind.ZodUnknown:return parseUnknownDef();case ZodFirstPartyTypeKind.ZodDefault:return parseDefaultDef(s,t);case ZodFirstPartyTypeKind.ZodBranded:return parseBrandedDef(s,t);case ZodFirstPartyTypeKind.ZodReadonly:return parseReadonlyDef(s,t);case ZodFirstPartyTypeKind.ZodCatch:return parseCatchDef(s,t);case ZodFirstPartyTypeKind.ZodPipeline:return parsePipelineDef(s,t);case ZodFirstPartyTypeKind.ZodFunction:case ZodFirstPartyTypeKind.ZodVoid:case ZodFirstPartyTypeKind.ZodSymbol:return;default:return(n=>{})()}},addMeta=(s,e,t)=>(s.description&&(t.description=s.description,e.markdownDescription&&(t.markdownDescription=s.description)),t),zodToJsonSchema=(s,e)=>{const t=getRefs(e),n=void 0,r=e==null?void 0:e.name,o=parseDef(s._def,t,!1)??{},c=r===void 0?n?{...o,[t.definitionPath]:n}:o:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,r].join("/"),[t.definitionPath]:{...n,[r]:o}};return t.target==="jsonSchema7"?c.$schema="http://json-schema.org/draft-07/schema#":(t.target==="jsonSchema2019-09"||t.target==="openAi")&&(c.$schema="https://json-schema.org/draft/2019-09/schema#"),t.target==="openAi"&&("anyOf"in c||"oneOf"in c||"allOf"in c||"type"in c&&Array.isArray(c.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),c};function parseJsonMarkdown(s,e=parsePartialJson){s=s.trim();const t=/```(json)?(.*)```/s.exec(s);return e(t?t[2]:s)}function parsePartialJson(s){if(typeof s>"u")return null;try{return JSON.parse(s)}catch{}let e="";const t=[];let n=!1,r=!1;for(let o of s){if(n)o==='"'&&!r?n=!1:o===`
`&&!r?o="\\n":o==="\\"?r=!r:r=!1;else if(o==='"')n=!0,r=!1;else if(o==="{")t.push("}");else if(o==="[")t.push("]");else if(o==="}"||o==="]")if(t&&t[t.length-1]===o)t.pop();else return null;e+=o}n&&(e+='"');for(let o=t.length-1;o>=0;o-=1)e+=t[o];try{return JSON.parse(e)}catch{return null}}var decamelize,hasRequiredDecamelize;function requireDecamelize(){return hasRequiredDecamelize||(hasRequiredDecamelize=1,decamelize=function(s,e){if(typeof s!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,s.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()}),decamelize}var decamelizeExports=requireDecamelize();const snakeCase=getDefaultExportFromCjs(decamelizeExports);var camelcase={exports:{}},hasRequiredCamelcase;function requireCamelcase(){if(hasRequiredCamelcase)return camelcase.exports;hasRequiredCamelcase=1;const s=/[\p{Lu}]/u,e=/[\p{Ll}]/u,t=/^[\p{Lu}](?![\p{Lu}])/gu,n=/([\p{Alpha}\p{N}_]|$)/u,r=/[_.\- ]+/,o=new RegExp("^"+r.source),c=new RegExp(r.source+n.source,"gu"),u=new RegExp("\\d+"+n.source,"gu"),h=(y,v,_)=>{let E=!1,x=!1,w=!1;for(let T=0;T<y.length;T++){const O=y[T];E&&s.test(O)?(y=y.slice(0,T)+"-"+y.slice(T),E=!1,w=x,x=!0,T++):x&&w&&e.test(O)?(y=y.slice(0,T-1)+"-"+y.slice(T-1),w=x,x=!1,E=!0):(E=v(O)===O&&_(O)!==O,w=x,x=_(O)===O&&v(O)!==O)}return y},f=(y,v)=>(t.lastIndex=0,y.replace(t,_=>v(_))),p=(y,v)=>(c.lastIndex=0,u.lastIndex=0,y.replace(c,(_,E)=>v(E)).replace(u,_=>v(_))),g=(y,v)=>{if(!(typeof y=="string"||Array.isArray(y)))throw new TypeError("Expected the input to be `string | string[]`");if(v={pascalCase:!1,preserveConsecutiveUppercase:!1,...v},Array.isArray(y)?y=y.map(w=>w.trim()).filter(w=>w.length).join("-"):y=y.trim(),y.length===0)return"";const _=v.locale===!1?w=>w.toLowerCase():w=>w.toLocaleLowerCase(v.locale),E=v.locale===!1?w=>w.toUpperCase():w=>w.toLocaleUpperCase(v.locale);return y.length===1?v.pascalCase?E(y):_(y):(y!==_(y)&&(y=h(y,_,E)),y=y.replace(o,""),v.preserveConsecutiveUppercase?y=f(y,_):y=_(y),v.pascalCase&&(y=E(y.charAt(0))+y.slice(1)),p(y,E))};return camelcase.exports=g,camelcase.exports.default=g,camelcase.exports}requireCamelcase();function keyToJson(s,e){return(e==null?void 0:e[s])||snakeCase(s)}function mapKeys(s,e,t){const n={};for(const r in s)Object.hasOwn(s,r)&&(n[e(r,t)]=s[r]);return n}function shallowCopy(s){return Array.isArray(s)?[...s]:{...s}}function replaceSecrets(s,e){const t=shallowCopy(s);for(const[n,r]of Object.entries(e)){const[o,...c]=n.split(".").reverse();let u=t;for(const h of c.reverse()){if(u[h]===void 0)break;u[h]=shallowCopy(u[h]),u=u[h]}u[o]!==void 0&&(u[o]={lc:1,type:"secret",id:[r]})}return t}function get_lc_unique_name(s){const e=Object.getPrototypeOf(s);return typeof s.lc_name=="function"&&(typeof e.lc_name!="function"||s.lc_name()!==e.lc_name())?s.lc_name():s.name}class Serializable{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,get_lc_unique_name(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}constructor(e,...t){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_serializable_keys!==void 0?this.lc_kwargs=Object.fromEntries(Object.entries(e||{}).filter(([n])=>{var r;return(r=this.lc_serializable_keys)==null?void 0:r.includes(n)})):this.lc_kwargs=e??{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof Serializable||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},t={},n=Object.keys(this.lc_kwargs).reduce((r,o)=>(r[o]=o in this?this[o]:this.lc_kwargs[o],r),{});for(let r=Object.getPrototypeOf(this);r;r=Object.getPrototypeOf(r))Object.assign(e,Reflect.get(r,"lc_aliases",this)),Object.assign(t,Reflect.get(r,"lc_secrets",this)),Object.assign(n,Reflect.get(r,"lc_attributes",this));return Object.keys(t).forEach(r=>{let o=this,c=n;const[u,...h]=r.split(".").reverse();for(const f of h.reverse()){if(!(f in o)||o[f]===void 0)return;(!(f in c)||c[f]===void 0)&&(typeof o[f]=="object"&&o[f]!=null?c[f]={}:Array.isArray(o[f])&&(c[f]=[])),o=o[f],c=c[f]}u in o&&o[u]!==void 0&&(c[u]=c[u]||o[u])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:mapKeys(Object.keys(t).length?replaceSecrets(n,t):n,keyToJson,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}function mergeContent(s,e){return typeof s=="string"?typeof e=="string"?s+e:[{type:"text",text:s},...e]:Array.isArray(e)?_mergeLists(s,e)??[...s,...e]:[...s,{type:"text",text:e}]}function stringifyWithDepthLimit(s,e){function t(n,r){if(typeof n!="object"||n===null||n===void 0)return n;if(r>=e)return Array.isArray(n)?"[Array]":"[Object]";if(Array.isArray(n))return n.map(c=>t(c,r+1));const o={};for(const c of Object.keys(n))o[c]=t(n[c],r+1);return o}return JSON.stringify(t(s,0),null,2)}class BaseMessage extends Serializable{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:""}getType(){return this._getType()}constructor(e,t){typeof e=="string"&&(e={content:e,additional_kwargs:t,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;const t=stringifyWithDepthLimit(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${t}`}}function _mergeDicts(s,e){const t={...s};for(const[n,r]of Object.entries(e))if(t[n]==null)t[n]=r;else{if(r==null)continue;if(typeof t[n]!=typeof r||Array.isArray(t[n])!==Array.isArray(r))throw new Error(`field[${n}] already exists in the message chunk, but with a different type.`);if(typeof t[n]=="string"){if(n==="type")continue;t[n]+=r}else if(typeof t[n]=="object"&&!Array.isArray(t[n]))t[n]=_mergeDicts(t[n],r);else if(Array.isArray(t[n]))t[n]=_mergeLists(t[n],r);else{if(t[n]===r)continue;console.warn(`field[${n}] already exists in this message chunk and value has unsupported type.`)}}return t}function _mergeLists(s,e){if(!(s===void 0&&e===void 0)){if(s===void 0||e===void 0)return s||e;{const t=[...s];for(const n of e)if(typeof n=="object"&&"index"in n&&typeof n.index=="number"){const r=t.findIndex(o=>o.index===n.index);r!==-1?t[r]=_mergeDicts(t[r],n):t.push(n)}else{if(typeof n=="object"&&"text"in n&&n.text==="")continue;t.push(n)}return t}}}class BaseMessageChunk extends BaseMessage{}function _isMessageFieldWithRole(s){return typeof s.role=="string"}function isBaseMessage(s){return typeof(s==null?void 0:s._getType)=="function"}function isBaseMessageChunk(s){return isBaseMessage(s)&&typeof s.concat=="function"}class ToolMessage extends BaseMessage{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(e,t,n){typeof e=="string"&&(e={content:e,name:n,tool_call_id:t}),super(e),Object.defineProperty(this,"lc_direct_tool_output",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}_getType(){return"tool"}static isInstance(e){return e._getType()==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}function defaultToolCallParser(s){const e=[],t=[];for(const n of s)if(n.function){const r=n.function.name;try{const o=JSON.parse(n.function.arguments),c={name:r||"",args:o||{},id:n.id};e.push(c)}catch{t.push({name:r,args:n.function.arguments,id:n.id,error:"Malformed args."})}}else continue;return[e,t]}class AIMessage extends BaseMessage{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,t){var r;let n;if(typeof e=="string")n={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:t??{}};else{n=e;const o=(r=n.additional_kwargs)==null?void 0:r.tool_calls,c=n.tool_calls;o!=null&&o.length>0&&(c===void 0||c.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(o!=null&&c===void 0){const[u,h]=defaultToolCallParser(o);n.tool_calls=u??[],n.invalid_tool_calls=h??[]}else n.tool_calls=n.tool_calls??[],n.invalid_tool_calls=n.invalid_tool_calls??[]}catch{n.tool_calls=[],n.invalid_tool_calls=[]}}super(n),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof n!="string"&&(this.tool_calls=n.tool_calls??this.tool_calls,this.invalid_tool_calls=n.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=n.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}}function isAIMessage(s){return s._getType()==="ai"}function isAIMessageChunk(s){return s._getType()==="ai"}class AIMessageChunk extends BaseMessageChunk{constructor(e){let t;if(typeof e=="string")t={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0)t={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0};else{const n=[],r=[];for(const o of e.tool_call_chunks){let c={};try{if(c=parsePartialJson(o.args||"{}"),c===null||typeof c!="object"||Array.isArray(c))throw new Error("Malformed tool call chunk args.");n.push({name:o.name??"",args:c,id:o.id,type:"tool_call"})}catch{r.push({name:o.name,args:o.args,id:o.id,error:"Malformed args.",type:"invalid_tool_call"})}}t={...e,tool_calls:n,invalid_tool_calls:r,usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0}}super(t),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=t.tool_call_chunks??this.tool_call_chunks,this.tool_calls=t.tool_calls??this.tool_calls,this.invalid_tool_calls=t.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=t.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){var n,r,o,c,u,h,f,p,g,y,v,_,E,x,w,T,O,N,A,I,k,M,L,H,D,q,J,ae,V,Z,G,ne,B,F,Y,U,C,P,$,W;const t={content:mergeContent(this.content,e.content),additional_kwargs:_mergeDicts(this.additional_kwargs,e.additional_kwargs),response_metadata:_mergeDicts(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){const te=_mergeLists(this.tool_call_chunks,e.tool_call_chunks);te!==void 0&&te.length>0&&(t.tool_call_chunks=te)}if(this.usage_metadata!==void 0||e.usage_metadata!==void 0){const te={...(((r=(n=this.usage_metadata)==null?void 0:n.input_token_details)==null?void 0:r.audio)!==void 0||((c=(o=e.usage_metadata)==null?void 0:o.input_token_details)==null?void 0:c.audio)!==void 0)&&{audio:(((h=(u=this.usage_metadata)==null?void 0:u.input_token_details)==null?void 0:h.audio)??0)+(((p=(f=e.usage_metadata)==null?void 0:f.input_token_details)==null?void 0:p.audio)??0)},...(((y=(g=this.usage_metadata)==null?void 0:g.input_token_details)==null?void 0:y.cache_read)!==void 0||((_=(v=e.usage_metadata)==null?void 0:v.input_token_details)==null?void 0:_.cache_read)!==void 0)&&{cache_read:(((x=(E=this.usage_metadata)==null?void 0:E.input_token_details)==null?void 0:x.cache_read)??0)+(((T=(w=e.usage_metadata)==null?void 0:w.input_token_details)==null?void 0:T.cache_read)??0)},...(((N=(O=this.usage_metadata)==null?void 0:O.input_token_details)==null?void 0:N.cache_creation)!==void 0||((I=(A=e.usage_metadata)==null?void 0:A.input_token_details)==null?void 0:I.cache_creation)!==void 0)&&{cache_creation:(((M=(k=this.usage_metadata)==null?void 0:k.input_token_details)==null?void 0:M.cache_creation)??0)+(((H=(L=e.usage_metadata)==null?void 0:L.input_token_details)==null?void 0:H.cache_creation)??0)}},ee={...(((q=(D=this.usage_metadata)==null?void 0:D.output_token_details)==null?void 0:q.audio)!==void 0||((ae=(J=e.usage_metadata)==null?void 0:J.output_token_details)==null?void 0:ae.audio)!==void 0)&&{audio:(((Z=(V=this.usage_metadata)==null?void 0:V.output_token_details)==null?void 0:Z.audio)??0)+(((ne=(G=e.usage_metadata)==null?void 0:G.output_token_details)==null?void 0:ne.audio)??0)},...(((F=(B=this.usage_metadata)==null?void 0:B.output_token_details)==null?void 0:F.reasoning)!==void 0||((U=(Y=e.usage_metadata)==null?void 0:Y.output_token_details)==null?void 0:U.reasoning)!==void 0)&&{reasoning:(((P=(C=this.usage_metadata)==null?void 0:C.output_token_details)==null?void 0:P.reasoning)??0)+(((W=($=e.usage_metadata)==null?void 0:$.output_token_details)==null?void 0:W.reasoning)??0)}},ce=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},he=e.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},Re={input_tokens:ce.input_tokens+he.input_tokens,output_tokens:ce.output_tokens+he.output_tokens,total_tokens:ce.total_tokens+he.total_tokens,...Object.keys(te).length>0&&{input_token_details:te},...Object.keys(ee).length>0&&{output_token_details:ee}};t.usage_metadata=Re}return new AIMessageChunk(t)}}class ChatMessage extends BaseMessage{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return ChatMessage}constructor(e,t){typeof e=="string"&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return e._getType()==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}}class ChatMessageChunk extends BaseMessageChunk{static lc_name(){return"ChatMessageChunk"}constructor(e,t){typeof e=="string"&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new ChatMessageChunk({content:mergeContent(this.content,e.content),additional_kwargs:_mergeDicts(this.additional_kwargs,e.additional_kwargs),response_metadata:_mergeDicts(this.response_metadata,e.response_metadata),role:this.role,id:this.id??e.id})}get _printableFields(){return{...super._printableFields,role:this.role}}}class FunctionMessageChunk extends BaseMessageChunk{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new FunctionMessageChunk({content:mergeContent(this.content,e.content),additional_kwargs:_mergeDicts(this.additional_kwargs,e.additional_kwargs),response_metadata:_mergeDicts(this.response_metadata,e.response_metadata),name:this.name??"",id:this.id??e.id})}}class HumanMessage extends BaseMessage{static lc_name(){return"HumanMessage"}_getType(){return"human"}}class HumanMessageChunk extends BaseMessageChunk{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}concat(e){return new HumanMessageChunk({content:mergeContent(this.content,e.content),additional_kwargs:_mergeDicts(this.additional_kwargs,e.additional_kwargs),response_metadata:_mergeDicts(this.response_metadata,e.response_metadata),id:this.id??e.id})}}class SystemMessage extends BaseMessage{static lc_name(){return"SystemMessage"}_getType(){return"system"}}class SystemMessageChunk extends BaseMessageChunk{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}concat(e){return new SystemMessageChunk({content:mergeContent(this.content,e.content),additional_kwargs:_mergeDicts(this.additional_kwargs,e.additional_kwargs),response_metadata:_mergeDicts(this.response_metadata,e.response_metadata),id:this.id??e.id})}}function addLangChainErrorFields(s,e){return s.lc_error_code=e,s.message=`${s.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,s}function _isToolCall(s){return!!(s&&typeof s=="object"&&"type"in s&&s.type==="tool_call")}class ToolInputParsingException extends Error{constructor(e,t){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=t}}function _coerceToolCall(s){return _isToolCall(s)?s:typeof s.id=="string"&&s.type==="function"&&typeof s.function=="object"&&s.function!==null&&"arguments"in s.function&&typeof s.function.arguments=="string"&&"name"in s.function&&typeof s.function.name=="string"?{id:s.id,args:JSON.parse(s.function.arguments),name:s.function.name,type:"tool_call"}:s}function isSerializedConstructor(s){return typeof s=="object"&&s!=null&&s.lc===1&&Array.isArray(s.id)&&s.kwargs!=null&&typeof s.kwargs=="object"}function _constructMessageFromParams(s){let e,t;if(isSerializedConstructor(s)){const n=s.id.at(-1);n==="HumanMessage"||n==="HumanMessageChunk"?e="user":n==="AIMessage"||n==="AIMessageChunk"?e="assistant":n==="SystemMessage"||n==="SystemMessageChunk"?e="system":n==="FunctionMessage"||n==="FunctionMessageChunk"?e="function":n==="ToolMessage"||n==="ToolMessageChunk"?e="tool":e="unknown",t=s.kwargs}else{const{type:n,...r}=s;e=n,t=r}if(e==="human"||e==="user")return new HumanMessage(t);if(e==="ai"||e==="assistant"){const{tool_calls:n,...r}=t;if(!Array.isArray(n))return new AIMessage(t);const o=n.map(_coerceToolCall);return new AIMessage({...r,tool_calls:o})}else{if(e==="system")return new SystemMessage(t);if(e==="developer")return new SystemMessage({...t,additional_kwargs:{...t.additional_kwargs,__openai_role__:"developer"}});if(e==="tool"&&"tool_call_id"in t)return new ToolMessage({...t,content:t.content,tool_call_id:t.tool_call_id,name:t.name});throw addLangChainErrorFields(new Error(`Unable to coerce message from array: only human, AI, system, developer, or tool message coercion is currently supported.

Received: ${JSON.stringify(s,null,2)}`),"MESSAGE_COERCION_FAILURE")}}function coerceMessageLikeToMessage(s){if(typeof s=="string")return new HumanMessage(s);if(isBaseMessage(s))return s;if(Array.isArray(s)){const[e,t]=s;return _constructMessageFromParams({type:e,content:t})}else if(_isMessageFieldWithRole(s)){const{role:e,...t}=s;return _constructMessageFromParams({...t,type:e})}else return _constructMessageFromParams(s)}function getBufferString(s,e="Human",t="AI"){const n=[];for(const r of s){let o;if(r._getType()==="human")o=e;else if(r._getType()==="ai")o=t;else if(r._getType()==="system")o="System";else if(r._getType()==="function")o="Function";else if(r._getType()==="tool")o="Tool";else if(r._getType()==="generic")o=r.role;else throw new Error(`Got unsupported message type: ${r._getType()}`);const c=r.name?`${r.name}, `:"",u=typeof r.content=="string"?r.content:JSON.stringify(r.content,null,2);n.push(`${o}: ${c}${u}`)}return n.join(`
`)}function convertToChunk(s){var t;const e=s._getType();if(e==="human")return new HumanMessageChunk({...s});if(e==="ai"){let n={...s};return"tool_calls"in n&&(n={...n,tool_call_chunks:(t=n.tool_calls)==null?void 0:t.map(r=>({...r,type:"tool_call_chunk",index:void 0,args:JSON.stringify(r.args)}))}),new AIMessageChunk({...n})}else{if(e==="system")return new SystemMessageChunk({...s});if(e==="function")return new FunctionMessageChunk({...s});if(ChatMessage.isInstance(s))return new ChatMessageChunk({...s});throw new Error("Unknown message type.")}}var pRetry$1={exports:{}},retry$1={},retry_operation,hasRequiredRetry_operation;function requireRetry_operation(){if(hasRequiredRetry_operation)return retry_operation;hasRequiredRetry_operation=1;function s(e,t){typeof t=="boolean"&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}return retry_operation=s,s.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},s.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},s.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=new Date().getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var n=this._timeouts.shift();if(n===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1);else return!1;var r=this;return this._timer=setTimeout(function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout(function(){r._operationTimeoutCb(r._attempts)},r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)},n),this._options.unref&&this._timer.unref(),!0},s.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){n._operationTimeoutCb()},n._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},s.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},s.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},s.prototype.start=s.prototype.try,s.prototype.errors=function(){return this._errors},s.prototype.attempts=function(){return this._attempts},s.prototype.mainError=function(){if(this._errors.length===0)return null;for(var e={},t=null,n=0,r=0;r<this._errors.length;r++){var o=this._errors[r],c=o.message,u=(e[c]||0)+1;e[c]=u,u>=n&&(t=o,n=u)}return t},retry_operation}var hasRequiredRetry$1;function requireRetry$1(){return hasRequiredRetry$1||(hasRequiredRetry$1=1,function(s){var e=requireRetry_operation();s.operation=function(t){var n=s.timeouts(t);return new e(n,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},s.timeouts=function(t){if(t instanceof Array)return[].concat(t);var n={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var r in t)n[r]=t[r];if(n.minTimeout>n.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var o=[],c=0;c<n.retries;c++)o.push(this.createTimeout(c,n));return t&&t.forever&&!o.length&&o.push(this.createTimeout(c,n)),o.sort(function(u,h){return u-h}),o},s.createTimeout=function(t,n){var r=n.randomize?Math.random()+1:1,o=Math.round(r*Math.max(n.minTimeout,1)*Math.pow(n.factor,t));return o=Math.min(o,n.maxTimeout),o},s.wrap=function(t,n,r){if(n instanceof Array&&(r=n,n=null),!r){r=[];for(var o in t)typeof t[o]=="function"&&r.push(o)}for(var c=0;c<r.length;c++){var u=r[c],h=t[u];t[u]=(function(p){var g=s.operation(n),y=Array.prototype.slice.call(arguments,1),v=y.pop();y.push(function(_){g.retry(_)||(_&&(arguments[0]=g.mainError()),v.apply(this,arguments))}),g.attempt(function(){p.apply(t,y)})}).bind(t,h),t[u].options=n}}}(retry$1)),retry$1}var retry,hasRequiredRetry;function requireRetry(){return hasRequiredRetry||(hasRequiredRetry=1,retry=requireRetry$1()),retry}var hasRequiredPRetry;function requirePRetry(){if(hasRequiredPRetry)return pRetry$1.exports;hasRequiredPRetry=1;const s=requireRetry(),e=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class t extends Error{constructor(u){super(),u instanceof Error?(this.originalError=u,{message:u}=u):(this.originalError=new Error(u),this.originalError.stack=this.stack),this.name="AbortError",this.message=u}}const n=(c,u,h)=>{const f=h.retries-(u-1);return c.attemptNumber=u,c.retriesLeft=f,c},r=c=>e.includes(c),o=(c,u)=>new Promise((h,f)=>{u={onFailedAttempt:()=>{},retries:10,...u};const p=s.operation(u);p.attempt(async g=>{try{h(await c(g))}catch(y){if(!(y instanceof Error)){f(new TypeError(`Non-error was thrown: "${y}". You should only throw errors.`));return}if(y instanceof t)p.stop(),f(y.originalError);else if(y instanceof TypeError&&!r(y.message))p.stop(),f(y);else{n(y,g,u);try{await u.onFailedAttempt(y)}catch(v){f(v);return}p.retry(y)||f(p.mainError())}}})});return pRetry$1.exports=o,pRetry$1.exports.default=o,pRetry$1.exports.AbortError=t,pRetry$1.exports}var pRetryExports=requirePRetry();const pRetry=getDefaultExportFromCjs(pRetryExports),REGEX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function validate$1(s){return typeof s=="string"&&REGEX.test(s)}var byteToHex=[];for(var i=0;i<256;++i)byteToHex.push((i+256).toString(16).slice(1));function unsafeStringify(s,e=0){return(byteToHex[s[e+0]]+byteToHex[s[e+1]]+byteToHex[s[e+2]]+byteToHex[s[e+3]]+"-"+byteToHex[s[e+4]]+byteToHex[s[e+5]]+"-"+byteToHex[s[e+6]]+byteToHex[s[e+7]]+"-"+byteToHex[s[e+8]]+byteToHex[s[e+9]]+"-"+byteToHex[s[e+10]]+byteToHex[s[e+11]]+byteToHex[s[e+12]]+byteToHex[s[e+13]]+byteToHex[s[e+14]]+byteToHex[s[e+15]]).toLowerCase()}var getRandomValues,rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}var randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const native={randomUUID};function v4(s,e,t){if(native.randomUUID&&!s)return native.randomUUID();s=s||{};var n=s.random||(s.rng||rng)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,unsafeStringify(n)}var dist={},eventemitter3={exports:{}},hasRequiredEventemitter3;function requireEventemitter3(){return hasRequiredEventemitter3||(hasRequiredEventemitter3=1,function(s){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function r(h,f,p){this.fn=h,this.context=f,this.once=p||!1}function o(h,f,p,g,y){if(typeof p!="function")throw new TypeError("The listener must be a function");var v=new r(p,g||h,y),_=t?t+f:f;return h._events[_]?h._events[_].fn?h._events[_]=[h._events[_],v]:h._events[_].push(v):(h._events[_]=v,h._eventsCount++),h}function c(h,f){--h._eventsCount===0?h._events=new n:delete h._events[f]}function u(){this._events=new n,this._eventsCount=0}u.prototype.eventNames=function(){var f=[],p,g;if(this._eventsCount===0)return f;for(g in p=this._events)e.call(p,g)&&f.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(p)):f},u.prototype.listeners=function(f){var p=t?t+f:f,g=this._events[p];if(!g)return[];if(g.fn)return[g.fn];for(var y=0,v=g.length,_=new Array(v);y<v;y++)_[y]=g[y].fn;return _},u.prototype.listenerCount=function(f){var p=t?t+f:f,g=this._events[p];return g?g.fn?1:g.length:0},u.prototype.emit=function(f,p,g,y,v,_){var E=t?t+f:f;if(!this._events[E])return!1;var x=this._events[E],w=arguments.length,T,O;if(x.fn){switch(x.once&&this.removeListener(f,x.fn,void 0,!0),w){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,p),!0;case 3:return x.fn.call(x.context,p,g),!0;case 4:return x.fn.call(x.context,p,g,y),!0;case 5:return x.fn.call(x.context,p,g,y,v),!0;case 6:return x.fn.call(x.context,p,g,y,v,_),!0}for(O=1,T=new Array(w-1);O<w;O++)T[O-1]=arguments[O];x.fn.apply(x.context,T)}else{var N=x.length,A;for(O=0;O<N;O++)switch(x[O].once&&this.removeListener(f,x[O].fn,void 0,!0),w){case 1:x[O].fn.call(x[O].context);break;case 2:x[O].fn.call(x[O].context,p);break;case 3:x[O].fn.call(x[O].context,p,g);break;case 4:x[O].fn.call(x[O].context,p,g,y);break;default:if(!T)for(A=1,T=new Array(w-1);A<w;A++)T[A-1]=arguments[A];x[O].fn.apply(x[O].context,T)}}return!0},u.prototype.on=function(f,p,g){return o(this,f,p,g,!1)},u.prototype.once=function(f,p,g){return o(this,f,p,g,!0)},u.prototype.removeListener=function(f,p,g,y){var v=t?t+f:f;if(!this._events[v])return this;if(!p)return c(this,v),this;var _=this._events[v];if(_.fn)_.fn===p&&(!y||_.once)&&(!g||_.context===g)&&c(this,v);else{for(var E=0,x=[],w=_.length;E<w;E++)(_[E].fn!==p||y&&!_[E].once||g&&_[E].context!==g)&&x.push(_[E]);x.length?this._events[v]=x.length===1?x[0]:x:c(this,v)}return this},u.prototype.removeAllListeners=function(f){var p;return f?(p=t?t+f:f,this._events[p]&&c(this,p)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=t,u.EventEmitter=u,s.exports=u}(eventemitter3)),eventemitter3.exports}var pTimeout={exports:{}},pFinally,hasRequiredPFinally;function requirePFinally(){return hasRequiredPFinally||(hasRequiredPFinally=1,pFinally=(s,e)=>(e=e||(()=>{}),s.then(t=>new Promise(n=>{n(e())}).then(()=>t),t=>new Promise(n=>{n(e())}).then(()=>{throw t})))),pFinally}var hasRequiredPTimeout;function requirePTimeout(){if(hasRequiredPTimeout)return pTimeout.exports;hasRequiredPTimeout=1;const s=requirePFinally();class e extends Error{constructor(r){super(r),this.name="TimeoutError"}}const t=(n,r,o)=>new Promise((c,u)=>{if(typeof r!="number"||r<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(r===1/0){c(n);return}const h=setTimeout(()=>{if(typeof o=="function"){try{c(o())}catch(g){u(g)}return}const f=typeof o=="string"?o:`Promise timed out after ${r} milliseconds`,p=o instanceof Error?o:new e(f);typeof n.cancel=="function"&&n.cancel(),u(p)},r);s(n.then(c,u),()=>{clearTimeout(h)})});return pTimeout.exports=t,pTimeout.exports.default=t,pTimeout.exports.TimeoutError=e,pTimeout.exports}var priorityQueue={},lowerBound={},hasRequiredLowerBound;function requireLowerBound(){if(hasRequiredLowerBound)return lowerBound;hasRequiredLowerBound=1,Object.defineProperty(lowerBound,"__esModule",{value:!0});function s(e,t,n){let r=0,o=e.length;for(;o>0;){const c=o/2|0;let u=r+c;n(e[u],t)<=0?(r=++u,o-=c+1):o=c}return r}return lowerBound.default=s,lowerBound}var hasRequiredPriorityQueue;function requirePriorityQueue(){if(hasRequiredPriorityQueue)return priorityQueue;hasRequiredPriorityQueue=1,Object.defineProperty(priorityQueue,"__esModule",{value:!0});const s=requireLowerBound();class e{constructor(){this._queue=[]}enqueue(n,r){r=Object.assign({priority:0},r);const o={priority:r.priority,run:n};if(this.size&&this._queue[this.size-1].priority>=r.priority){this._queue.push(o);return}const c=s.default(this._queue,o,(u,h)=>h.priority-u.priority);this._queue.splice(c,0,o)}dequeue(){const n=this._queue.shift();return n==null?void 0:n.run}filter(n){return this._queue.filter(r=>r.priority===n.priority).map(r=>r.run)}get size(){return this._queue.length}}return priorityQueue.default=e,priorityQueue}var hasRequiredDist;function requireDist(){if(hasRequiredDist)return dist;hasRequiredDist=1,Object.defineProperty(dist,"__esModule",{value:!0});const s=requireEventemitter3(),e=requirePTimeout(),t=requirePriorityQueue(),n=()=>{},r=new e.TimeoutError;class o extends s{constructor(u){var h,f,p,g;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=n,this._resolveIdle=n,u=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:t.default},u),!(typeof u.intervalCap=="number"&&u.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(f=(h=u.intervalCap)===null||h===void 0?void 0:h.toString())!==null&&f!==void 0?f:""}\` (${typeof u.intervalCap})`);if(u.interval===void 0||!(Number.isFinite(u.interval)&&u.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(g=(p=u.interval)===null||p===void 0?void 0:p.toString())!==null&&g!==void 0?g:""}\` (${typeof u.interval})`);this._carryoverConcurrencyCount=u.carryoverConcurrencyCount,this._isIntervalIgnored=u.intervalCap===1/0||u.interval===0,this._intervalCap=u.intervalCap,this._interval=u.interval,this._queue=new u.queueClass,this._queueClass=u.queueClass,this.concurrency=u.concurrency,this._timeout=u.timeout,this._throwOnTimeout=u.throwOnTimeout===!0,this._isPaused=u.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=n,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=n,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const u=Date.now();if(this._intervalId===void 0){const h=this._intervalEnd-u;if(h<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},h)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const u=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const h=this._queue.dequeue();return h?(this.emit("active"),h(),u&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(u){if(!(typeof u=="number"&&u>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${u}\` (${typeof u})`);this._concurrency=u,this._processQueue()}async add(u,h={}){return new Promise((f,p)=>{const g=async()=>{this._pendingCount++,this._intervalCount++;try{const y=this._timeout===void 0&&h.timeout===void 0?u():e.default(Promise.resolve(u()),h.timeout===void 0?this._timeout:h.timeout,()=>{(h.throwOnTimeout===void 0?this._throwOnTimeout:h.throwOnTimeout)&&p(r)});f(await y)}catch(y){p(y)}this._next()};this._queue.enqueue(g,h),this._tryToStartAnother(),this.emit("add")})}async addAll(u,h){return Promise.all(u.map(async f=>this.add(f,h)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(u=>{const h=this._resolveEmpty;this._resolveEmpty=()=>{h(),u()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(u=>{const h=this._resolveIdle;this._resolveIdle=()=>{h(),u()}})}get size(){return this._queue.size}sizeBy(u){return this._queue.filter(u).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(u){this._timeout=u}}return dist.default=o,dist}var distExports=requireDist();const PQueueMod=getDefaultExportFromCjs(distExports),DEFAULT_FETCH_IMPLEMENTATION=(...s)=>fetch(...s),LANGSMITH_FETCH_IMPLEMENTATION_KEY=Symbol.for("ls:fetch_implementation"),_getFetchImplementation=()=>globalThis[LANGSMITH_FETCH_IMPLEMENTATION_KEY]??DEFAULT_FETCH_IMPLEMENTATION,STATUS_NO_RETRY$1=[400,401,403,404,405,406,407,408],STATUS_IGNORE=[409];let AsyncCaller$1=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,"default"in PQueueMod?this.queue=new PQueueMod.default({concurrency:this.maxConcurrency}):this.queue=new PQueueMod({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e==null?void 0:e.onFailedResponseHook}call(e,...t){const n=this.onFailedResponseHook;return this.queue.add(()=>pRetry(()=>e(...t).catch(r=>{throw r instanceof Error?r:new Error(r)}),{async onFailedAttempt(r){if(r.message.startsWith("Cancel")||r.message.startsWith("TimeoutError")||r.message.startsWith("AbortError")||(r==null?void 0:r.code)==="ECONNABORTED")throw r;const o=r==null?void 0:r.response,c=o==null?void 0:o.status;if(c){if(STATUS_NO_RETRY$1.includes(+c))throw r;if(STATUS_IGNORE.includes(+c))return;n&&await n(o)}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...n){return e.signal?Promise.race([this.call(t,...n),new Promise((r,o)=>{var c;(c=e.signal)==null||c.addEventListener("abort",()=>{o(new Error("AbortError"))})})]):this.call(t,...n)}fetch(...e){return this.call(()=>_getFetchImplementation()(...e).then(t=>t.ok?t:Promise.reject(t)))}};function isLangChainMessage(s){return typeof(s==null?void 0:s._getType)=="function"}function convertLangChainMessageToExample(s){const e={type:s._getType(),data:{content:s.content}};return s!=null&&s.additional_kwargs&&Object.keys(s.additional_kwargs).length>0&&(e.data.additional_kwargs={...s.additional_kwargs}),e}function assertUuid(s,e){if(!validate$1(s)){const t=e!==void 0?`Invalid UUID for ${e}: ${s}`:`Invalid UUID: ${s}`;throw new Error(t)}return s}const warnedMessages={};function warnOnce(s){warnedMessages[s]||(console.warn(s),warnedMessages[s]=!0)}var re={exports:{}},constants,hasRequiredConstants;function requireConstants(){if(hasRequiredConstants)return constants;hasRequiredConstants=1;const s="2.0.0",e=256,t=Number.MAX_SAFE_INTEGER||9007199254740991,n=16,r=e-6;return constants={MAX_LENGTH:e,MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:s,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},constants}var debug_1,hasRequiredDebug;function requireDebug(){if(hasRequiredDebug)return debug_1;hasRequiredDebug=1;var s={};return debug_1=typeof process=="object"&&s&&s.NODE_DEBUG&&/\bsemver\b/i.test(s.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{},debug_1}var hasRequiredRe;function requireRe(){return hasRequiredRe||(hasRequiredRe=1,function(s,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:r}=requireConstants(),o=requireDebug();e=s.exports={};const c=e.re=[],u=e.safeRe=[],h=e.src=[],f=e.safeSrc=[],p=e.t={};let g=0;const y="[a-zA-Z0-9-]",v=[["\\s",1],["\\d",r],[y,n]],_=x=>{for(const[w,T]of v)x=x.split(`${w}*`).join(`${w}{0,${T}}`).split(`${w}+`).join(`${w}{1,${T}}`);return x},E=(x,w,T)=>{const O=_(w),N=g++;o(x,N,w),p[x]=N,h[N]=w,f[N]=O,c[N]=new RegExp(w,T?"g":void 0),u[N]=new RegExp(O,T?"g":void 0)};E("NUMERICIDENTIFIER","0|[1-9]\\d*"),E("NUMERICIDENTIFIERLOOSE","\\d+"),E("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${y}*`),E("MAINVERSION",`(${h[p.NUMERICIDENTIFIER]})\\.(${h[p.NUMERICIDENTIFIER]})\\.(${h[p.NUMERICIDENTIFIER]})`),E("MAINVERSIONLOOSE",`(${h[p.NUMERICIDENTIFIERLOOSE]})\\.(${h[p.NUMERICIDENTIFIERLOOSE]})\\.(${h[p.NUMERICIDENTIFIERLOOSE]})`),E("PRERELEASEIDENTIFIER",`(?:${h[p.NUMERICIDENTIFIER]}|${h[p.NONNUMERICIDENTIFIER]})`),E("PRERELEASEIDENTIFIERLOOSE",`(?:${h[p.NUMERICIDENTIFIERLOOSE]}|${h[p.NONNUMERICIDENTIFIER]})`),E("PRERELEASE",`(?:-(${h[p.PRERELEASEIDENTIFIER]}(?:\\.${h[p.PRERELEASEIDENTIFIER]})*))`),E("PRERELEASELOOSE",`(?:-?(${h[p.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${h[p.PRERELEASEIDENTIFIERLOOSE]})*))`),E("BUILDIDENTIFIER",`${y}+`),E("BUILD",`(?:\\+(${h[p.BUILDIDENTIFIER]}(?:\\.${h[p.BUILDIDENTIFIER]})*))`),E("FULLPLAIN",`v?${h[p.MAINVERSION]}${h[p.PRERELEASE]}?${h[p.BUILD]}?`),E("FULL",`^${h[p.FULLPLAIN]}$`),E("LOOSEPLAIN",`[v=\\s]*${h[p.MAINVERSIONLOOSE]}${h[p.PRERELEASELOOSE]}?${h[p.BUILD]}?`),E("LOOSE",`^${h[p.LOOSEPLAIN]}$`),E("GTLT","((?:<|>)?=?)"),E("XRANGEIDENTIFIERLOOSE",`${h[p.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),E("XRANGEIDENTIFIER",`${h[p.NUMERICIDENTIFIER]}|x|X|\\*`),E("XRANGEPLAIN",`[v=\\s]*(${h[p.XRANGEIDENTIFIER]})(?:\\.(${h[p.XRANGEIDENTIFIER]})(?:\\.(${h[p.XRANGEIDENTIFIER]})(?:${h[p.PRERELEASE]})?${h[p.BUILD]}?)?)?`),E("XRANGEPLAINLOOSE",`[v=\\s]*(${h[p.XRANGEIDENTIFIERLOOSE]})(?:\\.(${h[p.XRANGEIDENTIFIERLOOSE]})(?:\\.(${h[p.XRANGEIDENTIFIERLOOSE]})(?:${h[p.PRERELEASELOOSE]})?${h[p.BUILD]}?)?)?`),E("XRANGE",`^${h[p.GTLT]}\\s*${h[p.XRANGEPLAIN]}$`),E("XRANGELOOSE",`^${h[p.GTLT]}\\s*${h[p.XRANGEPLAINLOOSE]}$`),E("COERCEPLAIN",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?`),E("COERCE",`${h[p.COERCEPLAIN]}(?:$|[^\\d])`),E("COERCEFULL",h[p.COERCEPLAIN]+`(?:${h[p.PRERELEASE]})?(?:${h[p.BUILD]})?(?:$|[^\\d])`),E("COERCERTL",h[p.COERCE],!0),E("COERCERTLFULL",h[p.COERCEFULL],!0),E("LONETILDE","(?:~>?)"),E("TILDETRIM",`(\\s*)${h[p.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",E("TILDE",`^${h[p.LONETILDE]}${h[p.XRANGEPLAIN]}$`),E("TILDELOOSE",`^${h[p.LONETILDE]}${h[p.XRANGEPLAINLOOSE]}$`),E("LONECARET","(?:\\^)"),E("CARETTRIM",`(\\s*)${h[p.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",E("CARET",`^${h[p.LONECARET]}${h[p.XRANGEPLAIN]}$`),E("CARETLOOSE",`^${h[p.LONECARET]}${h[p.XRANGEPLAINLOOSE]}$`),E("COMPARATORLOOSE",`^${h[p.GTLT]}\\s*(${h[p.LOOSEPLAIN]})$|^$`),E("COMPARATOR",`^${h[p.GTLT]}\\s*(${h[p.FULLPLAIN]})$|^$`),E("COMPARATORTRIM",`(\\s*)${h[p.GTLT]}\\s*(${h[p.LOOSEPLAIN]}|${h[p.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",E("HYPHENRANGE",`^\\s*(${h[p.XRANGEPLAIN]})\\s+-\\s+(${h[p.XRANGEPLAIN]})\\s*$`),E("HYPHENRANGELOOSE",`^\\s*(${h[p.XRANGEPLAINLOOSE]})\\s+-\\s+(${h[p.XRANGEPLAINLOOSE]})\\s*$`),E("STAR","(<|>)?=?\\s*\\*"),E("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),E("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(re,re.exports)),re.exports}var parseOptions_1,hasRequiredParseOptions;function requireParseOptions(){if(hasRequiredParseOptions)return parseOptions_1;hasRequiredParseOptions=1;const s=Object.freeze({loose:!0}),e=Object.freeze({});return parseOptions_1=n=>n?typeof n!="object"?s:n:e,parseOptions_1}var identifiers,hasRequiredIdentifiers;function requireIdentifiers(){if(hasRequiredIdentifiers)return identifiers;hasRequiredIdentifiers=1;const s=/^[0-9]+$/,e=(n,r)=>{const o=s.test(n),c=s.test(r);return o&&c&&(n=+n,r=+r),n===r?0:o&&!c?-1:c&&!o?1:n<r?-1:1};return identifiers={compareIdentifiers:e,rcompareIdentifiers:(n,r)=>e(r,n)},identifiers}var semver$1,hasRequiredSemver$1;function requireSemver$1(){if(hasRequiredSemver$1)return semver$1;hasRequiredSemver$1=1;const s=requireDebug(),{MAX_LENGTH:e,MAX_SAFE_INTEGER:t}=requireConstants(),{safeRe:n,safeSrc:r,t:o}=requireRe(),c=requireParseOptions(),{compareIdentifiers:u}=requireIdentifiers();class h{constructor(p,g){if(g=c(g),p instanceof h){if(p.loose===!!g.loose&&p.includePrerelease===!!g.includePrerelease)return p;p=p.version}else if(typeof p!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof p}".`);if(p.length>e)throw new TypeError(`version is longer than ${e} characters`);s("SemVer",p,g),this.options=g,this.loose=!!g.loose,this.includePrerelease=!!g.includePrerelease;const y=p.trim().match(g.loose?n[o.LOOSE]:n[o.FULL]);if(!y)throw new TypeError(`Invalid Version: ${p}`);if(this.raw=p,this.major=+y[1],this.minor=+y[2],this.patch=+y[3],this.major>t||this.major<0)throw new TypeError("Invalid major version");if(this.minor>t||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>t||this.patch<0)throw new TypeError("Invalid patch version");y[4]?this.prerelease=y[4].split(".").map(v=>{if(/^[0-9]+$/.test(v)){const _=+v;if(_>=0&&_<t)return _}return v}):this.prerelease=[],this.build=y[5]?y[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(p){if(s("SemVer.compare",this.version,this.options,p),!(p instanceof h)){if(typeof p=="string"&&p===this.version)return 0;p=new h(p,this.options)}return p.version===this.version?0:this.compareMain(p)||this.comparePre(p)}compareMain(p){return p instanceof h||(p=new h(p,this.options)),u(this.major,p.major)||u(this.minor,p.minor)||u(this.patch,p.patch)}comparePre(p){if(p instanceof h||(p=new h(p,this.options)),this.prerelease.length&&!p.prerelease.length)return-1;if(!this.prerelease.length&&p.prerelease.length)return 1;if(!this.prerelease.length&&!p.prerelease.length)return 0;let g=0;do{const y=this.prerelease[g],v=p.prerelease[g];if(s("prerelease compare",g,y,v),y===void 0&&v===void 0)return 0;if(v===void 0)return 1;if(y===void 0)return-1;if(y===v)continue;return u(y,v)}while(++g)}compareBuild(p){p instanceof h||(p=new h(p,this.options));let g=0;do{const y=this.build[g],v=p.build[g];if(s("build compare",g,y,v),y===void 0&&v===void 0)return 0;if(v===void 0)return 1;if(y===void 0)return-1;if(y===v)continue;return u(y,v)}while(++g)}inc(p,g,y){if(p.startsWith("pre")){if(!g&&y===!1)throw new Error("invalid increment argument: identifier is empty");if(g){const v=new RegExp(`^${this.options.loose?r[o.PRERELEASELOOSE]:r[o.PRERELEASE]}$`),_=`-${g}`.match(v);if(!_||_[1]!==g)throw new Error(`invalid identifier: ${g}`)}}switch(p){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",g,y);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",g,y);break;case"prepatch":this.prerelease.length=0,this.inc("patch",g,y),this.inc("pre",g,y);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",g,y),this.inc("pre",g,y);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const v=Number(y)?1:0;if(this.prerelease.length===0)this.prerelease=[v];else{let _=this.prerelease.length;for(;--_>=0;)typeof this.prerelease[_]=="number"&&(this.prerelease[_]++,_=-2);if(_===-1){if(g===this.prerelease.join(".")&&y===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(v)}}if(g){let _=[g,v];y===!1&&(_=[g]),u(this.prerelease[0],g)===0?isNaN(this.prerelease[1])&&(this.prerelease=_):this.prerelease=_}break}default:throw new Error(`invalid increment argument: ${p}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return semver$1=h,semver$1}var parse_1,hasRequiredParse;function requireParse(){if(hasRequiredParse)return parse_1;hasRequiredParse=1;const s=requireSemver$1();return parse_1=(t,n,r=!1)=>{if(t instanceof s)return t;try{return new s(t,n)}catch(o){if(!r)return null;throw o}},parse_1}var valid_1,hasRequiredValid$1;function requireValid$1(){if(hasRequiredValid$1)return valid_1;hasRequiredValid$1=1;const s=requireParse();return valid_1=(t,n)=>{const r=s(t,n);return r?r.version:null},valid_1}var clean_1,hasRequiredClean;function requireClean(){if(hasRequiredClean)return clean_1;hasRequiredClean=1;const s=requireParse();return clean_1=(t,n)=>{const r=s(t.trim().replace(/^[=v]+/,""),n);return r?r.version:null},clean_1}var inc_1,hasRequiredInc;function requireInc(){if(hasRequiredInc)return inc_1;hasRequiredInc=1;const s=requireSemver$1();return inc_1=(t,n,r,o,c)=>{typeof r=="string"&&(c=o,o=r,r=void 0);try{return new s(t instanceof s?t.version:t,r).inc(n,o,c).version}catch{return null}},inc_1}var diff_1,hasRequiredDiff;function requireDiff(){if(hasRequiredDiff)return diff_1;hasRequiredDiff=1;const s=requireParse();return diff_1=(t,n)=>{const r=s(t,null,!0),o=s(n,null,!0),c=r.compare(o);if(c===0)return null;const u=c>0,h=u?r:o,f=u?o:r,p=!!h.prerelease.length;if(!!f.prerelease.length&&!p){if(!f.patch&&!f.minor)return"major";if(f.compareMain(h)===0)return f.minor&&!f.patch?"minor":"patch"}const y=p?"pre":"";return r.major!==o.major?y+"major":r.minor!==o.minor?y+"minor":r.patch!==o.patch?y+"patch":"prerelease"},diff_1}var major_1,hasRequiredMajor;function requireMajor(){if(hasRequiredMajor)return major_1;hasRequiredMajor=1;const s=requireSemver$1();return major_1=(t,n)=>new s(t,n).major,major_1}var minor_1,hasRequiredMinor;function requireMinor(){if(hasRequiredMinor)return minor_1;hasRequiredMinor=1;const s=requireSemver$1();return minor_1=(t,n)=>new s(t,n).minor,minor_1}var patch_1,hasRequiredPatch;function requirePatch(){if(hasRequiredPatch)return patch_1;hasRequiredPatch=1;const s=requireSemver$1();return patch_1=(t,n)=>new s(t,n).patch,patch_1}var prerelease_1,hasRequiredPrerelease;function requirePrerelease(){if(hasRequiredPrerelease)return prerelease_1;hasRequiredPrerelease=1;const s=requireParse();return prerelease_1=(t,n)=>{const r=s(t,n);return r&&r.prerelease.length?r.prerelease:null},prerelease_1}var compare_1,hasRequiredCompare;function requireCompare(){if(hasRequiredCompare)return compare_1;hasRequiredCompare=1;const s=requireSemver$1();return compare_1=(t,n,r)=>new s(t,r).compare(new s(n,r)),compare_1}var rcompare_1,hasRequiredRcompare;function requireRcompare(){if(hasRequiredRcompare)return rcompare_1;hasRequiredRcompare=1;const s=requireCompare();return rcompare_1=(t,n,r)=>s(n,t,r),rcompare_1}var compareLoose_1,hasRequiredCompareLoose;function requireCompareLoose(){if(hasRequiredCompareLoose)return compareLoose_1;hasRequiredCompareLoose=1;const s=requireCompare();return compareLoose_1=(t,n)=>s(t,n,!0),compareLoose_1}var compareBuild_1,hasRequiredCompareBuild;function requireCompareBuild(){if(hasRequiredCompareBuild)return compareBuild_1;hasRequiredCompareBuild=1;const s=requireSemver$1();return compareBuild_1=(t,n,r)=>{const o=new s(t,r),c=new s(n,r);return o.compare(c)||o.compareBuild(c)},compareBuild_1}var sort_1,hasRequiredSort;function requireSort(){if(hasRequiredSort)return sort_1;hasRequiredSort=1;const s=requireCompareBuild();return sort_1=(t,n)=>t.sort((r,o)=>s(r,o,n)),sort_1}var rsort_1,hasRequiredRsort;function requireRsort(){if(hasRequiredRsort)return rsort_1;hasRequiredRsort=1;const s=requireCompareBuild();return rsort_1=(t,n)=>t.sort((r,o)=>s(o,r,n)),rsort_1}var gt_1,hasRequiredGt;function requireGt(){if(hasRequiredGt)return gt_1;hasRequiredGt=1;const s=requireCompare();return gt_1=(t,n,r)=>s(t,n,r)>0,gt_1}var lt_1,hasRequiredLt;function requireLt(){if(hasRequiredLt)return lt_1;hasRequiredLt=1;const s=requireCompare();return lt_1=(t,n,r)=>s(t,n,r)<0,lt_1}var eq_1,hasRequiredEq;function requireEq(){if(hasRequiredEq)return eq_1;hasRequiredEq=1;const s=requireCompare();return eq_1=(t,n,r)=>s(t,n,r)===0,eq_1}var neq_1,hasRequiredNeq;function requireNeq(){if(hasRequiredNeq)return neq_1;hasRequiredNeq=1;const s=requireCompare();return neq_1=(t,n,r)=>s(t,n,r)!==0,neq_1}var gte_1,hasRequiredGte;function requireGte(){if(hasRequiredGte)return gte_1;hasRequiredGte=1;const s=requireCompare();return gte_1=(t,n,r)=>s(t,n,r)>=0,gte_1}var lte_1,hasRequiredLte;function requireLte(){if(hasRequiredLte)return lte_1;hasRequiredLte=1;const s=requireCompare();return lte_1=(t,n,r)=>s(t,n,r)<=0,lte_1}var cmp_1,hasRequiredCmp;function requireCmp(){if(hasRequiredCmp)return cmp_1;hasRequiredCmp=1;const s=requireEq(),e=requireNeq(),t=requireGt(),n=requireGte(),r=requireLt(),o=requireLte();return cmp_1=(u,h,f,p)=>{switch(h){case"===":return typeof u=="object"&&(u=u.version),typeof f=="object"&&(f=f.version),u===f;case"!==":return typeof u=="object"&&(u=u.version),typeof f=="object"&&(f=f.version),u!==f;case"":case"=":case"==":return s(u,f,p);case"!=":return e(u,f,p);case">":return t(u,f,p);case">=":return n(u,f,p);case"<":return r(u,f,p);case"<=":return o(u,f,p);default:throw new TypeError(`Invalid operator: ${h}`)}},cmp_1}var coerce_1,hasRequiredCoerce;function requireCoerce(){if(hasRequiredCoerce)return coerce_1;hasRequiredCoerce=1;const s=requireSemver$1(),e=requireParse(),{safeRe:t,t:n}=requireRe();return coerce_1=(o,c)=>{if(o instanceof s)return o;if(typeof o=="number"&&(o=String(o)),typeof o!="string")return null;c=c||{};let u=null;if(!c.rtl)u=o.match(c.includePrerelease?t[n.COERCEFULL]:t[n.COERCE]);else{const v=c.includePrerelease?t[n.COERCERTLFULL]:t[n.COERCERTL];let _;for(;(_=v.exec(o))&&(!u||u.index+u[0].length!==o.length);)(!u||_.index+_[0].length!==u.index+u[0].length)&&(u=_),v.lastIndex=_.index+_[1].length+_[2].length;v.lastIndex=-1}if(u===null)return null;const h=u[2],f=u[3]||"0",p=u[4]||"0",g=c.includePrerelease&&u[5]?`-${u[5]}`:"",y=c.includePrerelease&&u[6]?`+${u[6]}`:"";return e(`${h}.${f}.${p}${g}${y}`,c)},coerce_1}var lrucache,hasRequiredLrucache;function requireLrucache(){if(hasRequiredLrucache)return lrucache;hasRequiredLrucache=1;class s{constructor(){this.max=1e3,this.map=new Map}get(t){const n=this.map.get(t);if(n!==void 0)return this.map.delete(t),this.map.set(t,n),n}delete(t){return this.map.delete(t)}set(t,n){if(!this.delete(t)&&n!==void 0){if(this.map.size>=this.max){const o=this.map.keys().next().value;this.delete(o)}this.map.set(t,n)}return this}}return lrucache=s,lrucache}var range,hasRequiredRange;function requireRange(){if(hasRequiredRange)return range;hasRequiredRange=1;const s=/\s+/g;class e{constructor(V,Z){if(Z=r(Z),V instanceof e)return V.loose===!!Z.loose&&V.includePrerelease===!!Z.includePrerelease?V:new e(V.raw,Z);if(V instanceof o)return this.raw=V.value,this.set=[[V]],this.formatted=void 0,this;if(this.options=Z,this.loose=!!Z.loose,this.includePrerelease=!!Z.includePrerelease,this.raw=V.trim().replace(s," "),this.set=this.raw.split("||").map(G=>this.parseRange(G.trim())).filter(G=>G.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const G=this.set[0];if(this.set=this.set.filter(ne=>!E(ne[0])),this.set.length===0)this.set=[G];else if(this.set.length>1){for(const ne of this.set)if(ne.length===1&&x(ne[0])){this.set=[ne];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let V=0;V<this.set.length;V++){V>0&&(this.formatted+="||");const Z=this.set[V];for(let G=0;G<Z.length;G++)G>0&&(this.formatted+=" "),this.formatted+=Z[G].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(V){const G=((this.options.includePrerelease&&v)|(this.options.loose&&_))+":"+V,ne=n.get(G);if(ne)return ne;const B=this.options.loose,F=B?h[f.HYPHENRANGELOOSE]:h[f.HYPHENRANGE];V=V.replace(F,q(this.options.includePrerelease)),c("hyphen replace",V),V=V.replace(h[f.COMPARATORTRIM],p),c("comparator trim",V),V=V.replace(h[f.TILDETRIM],g),c("tilde trim",V),V=V.replace(h[f.CARETTRIM],y),c("caret trim",V);let Y=V.split(" ").map($=>T($,this.options)).join(" ").split(/\s+/).map($=>D($,this.options));B&&(Y=Y.filter($=>(c("loose invalid filter",$,this.options),!!$.match(h[f.COMPARATORLOOSE])))),c("range list",Y);const U=new Map,C=Y.map($=>new o($,this.options));for(const $ of C){if(E($))return[$];U.set($.value,$)}U.size>1&&U.has("")&&U.delete("");const P=[...U.values()];return n.set(G,P),P}intersects(V,Z){if(!(V instanceof e))throw new TypeError("a Range is required");return this.set.some(G=>w(G,Z)&&V.set.some(ne=>w(ne,Z)&&G.every(B=>ne.every(F=>B.intersects(F,Z)))))}test(V){if(!V)return!1;if(typeof V=="string")try{V=new u(V,this.options)}catch{return!1}for(let Z=0;Z<this.set.length;Z++)if(J(this.set[Z],V,this.options))return!0;return!1}}range=e;const t=requireLrucache(),n=new t,r=requireParseOptions(),o=requireComparator(),c=requireDebug(),u=requireSemver$1(),{safeRe:h,t:f,comparatorTrimReplace:p,tildeTrimReplace:g,caretTrimReplace:y}=requireRe(),{FLAG_INCLUDE_PRERELEASE:v,FLAG_LOOSE:_}=requireConstants(),E=ae=>ae.value==="<0.0.0-0",x=ae=>ae.value==="",w=(ae,V)=>{let Z=!0;const G=ae.slice();let ne=G.pop();for(;Z&&G.length;)Z=G.every(B=>ne.intersects(B,V)),ne=G.pop();return Z},T=(ae,V)=>(c("comp",ae,V),ae=I(ae,V),c("caret",ae),ae=N(ae,V),c("tildes",ae),ae=M(ae,V),c("xrange",ae),ae=H(ae,V),c("stars",ae),ae),O=ae=>!ae||ae.toLowerCase()==="x"||ae==="*",N=(ae,V)=>ae.trim().split(/\s+/).map(Z=>A(Z,V)).join(" "),A=(ae,V)=>{const Z=V.loose?h[f.TILDELOOSE]:h[f.TILDE];return ae.replace(Z,(G,ne,B,F,Y)=>{c("tilde",ae,G,ne,B,F,Y);let U;return O(ne)?U="":O(B)?U=`>=${ne}.0.0 <${+ne+1}.0.0-0`:O(F)?U=`>=${ne}.${B}.0 <${ne}.${+B+1}.0-0`:Y?(c("replaceTilde pr",Y),U=`>=${ne}.${B}.${F}-${Y} <${ne}.${+B+1}.0-0`):U=`>=${ne}.${B}.${F} <${ne}.${+B+1}.0-0`,c("tilde return",U),U})},I=(ae,V)=>ae.trim().split(/\s+/).map(Z=>k(Z,V)).join(" "),k=(ae,V)=>{c("caret",ae,V);const Z=V.loose?h[f.CARETLOOSE]:h[f.CARET],G=V.includePrerelease?"-0":"";return ae.replace(Z,(ne,B,F,Y,U)=>{c("caret",ae,ne,B,F,Y,U);let C;return O(B)?C="":O(F)?C=`>=${B}.0.0${G} <${+B+1}.0.0-0`:O(Y)?B==="0"?C=`>=${B}.${F}.0${G} <${B}.${+F+1}.0-0`:C=`>=${B}.${F}.0${G} <${+B+1}.0.0-0`:U?(c("replaceCaret pr",U),B==="0"?F==="0"?C=`>=${B}.${F}.${Y}-${U} <${B}.${F}.${+Y+1}-0`:C=`>=${B}.${F}.${Y}-${U} <${B}.${+F+1}.0-0`:C=`>=${B}.${F}.${Y}-${U} <${+B+1}.0.0-0`):(c("no pr"),B==="0"?F==="0"?C=`>=${B}.${F}.${Y}${G} <${B}.${F}.${+Y+1}-0`:C=`>=${B}.${F}.${Y}${G} <${B}.${+F+1}.0-0`:C=`>=${B}.${F}.${Y} <${+B+1}.0.0-0`),c("caret return",C),C})},M=(ae,V)=>(c("replaceXRanges",ae,V),ae.split(/\s+/).map(Z=>L(Z,V)).join(" ")),L=(ae,V)=>{ae=ae.trim();const Z=V.loose?h[f.XRANGELOOSE]:h[f.XRANGE];return ae.replace(Z,(G,ne,B,F,Y,U)=>{c("xRange",ae,G,ne,B,F,Y,U);const C=O(B),P=C||O(F),$=P||O(Y),W=$;return ne==="="&&W&&(ne=""),U=V.includePrerelease?"-0":"",C?ne===">"||ne==="<"?G="<0.0.0-0":G="*":ne&&W?(P&&(F=0),Y=0,ne===">"?(ne=">=",P?(B=+B+1,F=0,Y=0):(F=+F+1,Y=0)):ne==="<="&&(ne="<",P?B=+B+1:F=+F+1),ne==="<"&&(U="-0"),G=`${ne+B}.${F}.${Y}${U}`):P?G=`>=${B}.0.0${U} <${+B+1}.0.0-0`:$&&(G=`>=${B}.${F}.0${U} <${B}.${+F+1}.0-0`),c("xRange return",G),G})},H=(ae,V)=>(c("replaceStars",ae,V),ae.trim().replace(h[f.STAR],"")),D=(ae,V)=>(c("replaceGTE0",ae,V),ae.trim().replace(h[V.includePrerelease?f.GTE0PRE:f.GTE0],"")),q=ae=>(V,Z,G,ne,B,F,Y,U,C,P,$,W)=>(O(G)?Z="":O(ne)?Z=`>=${G}.0.0${ae?"-0":""}`:O(B)?Z=`>=${G}.${ne}.0${ae?"-0":""}`:F?Z=`>=${Z}`:Z=`>=${Z}${ae?"-0":""}`,O(C)?U="":O(P)?U=`<${+C+1}.0.0-0`:O($)?U=`<${C}.${+P+1}.0-0`:W?U=`<=${C}.${P}.${$}-${W}`:ae?U=`<${C}.${P}.${+$+1}-0`:U=`<=${U}`,`${Z} ${U}`.trim()),J=(ae,V,Z)=>{for(let G=0;G<ae.length;G++)if(!ae[G].test(V))return!1;if(V.prerelease.length&&!Z.includePrerelease){for(let G=0;G<ae.length;G++)if(c(ae[G].semver),ae[G].semver!==o.ANY&&ae[G].semver.prerelease.length>0){const ne=ae[G].semver;if(ne.major===V.major&&ne.minor===V.minor&&ne.patch===V.patch)return!0}return!1}return!0};return range}var comparator,hasRequiredComparator;function requireComparator(){if(hasRequiredComparator)return comparator;hasRequiredComparator=1;const s=Symbol("SemVer ANY");class e{static get ANY(){return s}constructor(p,g){if(g=t(g),p instanceof e){if(p.loose===!!g.loose)return p;p=p.value}p=p.trim().split(/\s+/).join(" "),c("comparator",p,g),this.options=g,this.loose=!!g.loose,this.parse(p),this.semver===s?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(p){const g=this.options.loose?n[r.COMPARATORLOOSE]:n[r.COMPARATOR],y=p.match(g);if(!y)throw new TypeError(`Invalid comparator: ${p}`);this.operator=y[1]!==void 0?y[1]:"",this.operator==="="&&(this.operator=""),y[2]?this.semver=new u(y[2],this.options.loose):this.semver=s}toString(){return this.value}test(p){if(c("Comparator.test",p,this.options.loose),this.semver===s||p===s)return!0;if(typeof p=="string")try{p=new u(p,this.options)}catch{return!1}return o(p,this.operator,this.semver,this.options)}intersects(p,g){if(!(p instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new h(p.value,g).test(this.value):p.operator===""?p.value===""?!0:new h(this.value,g).test(p.semver):(g=t(g),g.includePrerelease&&(this.value==="<0.0.0-0"||p.value==="<0.0.0-0")||!g.includePrerelease&&(this.value.startsWith("<0.0.0")||p.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&p.operator.startsWith(">")||this.operator.startsWith("<")&&p.operator.startsWith("<")||this.semver.version===p.semver.version&&this.operator.includes("=")&&p.operator.includes("=")||o(this.semver,"<",p.semver,g)&&this.operator.startsWith(">")&&p.operator.startsWith("<")||o(this.semver,">",p.semver,g)&&this.operator.startsWith("<")&&p.operator.startsWith(">")))}}comparator=e;const t=requireParseOptions(),{safeRe:n,t:r}=requireRe(),o=requireCmp(),c=requireDebug(),u=requireSemver$1(),h=requireRange();return comparator}var satisfies_1,hasRequiredSatisfies;function requireSatisfies(){if(hasRequiredSatisfies)return satisfies_1;hasRequiredSatisfies=1;const s=requireRange();return satisfies_1=(t,n,r)=>{try{n=new s(n,r)}catch{return!1}return n.test(t)},satisfies_1}var toComparators_1,hasRequiredToComparators;function requireToComparators(){if(hasRequiredToComparators)return toComparators_1;hasRequiredToComparators=1;const s=requireRange();return toComparators_1=(t,n)=>new s(t,n).set.map(r=>r.map(o=>o.value).join(" ").trim().split(" ")),toComparators_1}var maxSatisfying_1,hasRequiredMaxSatisfying;function requireMaxSatisfying(){if(hasRequiredMaxSatisfying)return maxSatisfying_1;hasRequiredMaxSatisfying=1;const s=requireSemver$1(),e=requireRange();return maxSatisfying_1=(n,r,o)=>{let c=null,u=null,h=null;try{h=new e(r,o)}catch{return null}return n.forEach(f=>{h.test(f)&&(!c||u.compare(f)===-1)&&(c=f,u=new s(c,o))}),c},maxSatisfying_1}var minSatisfying_1,hasRequiredMinSatisfying;function requireMinSatisfying(){if(hasRequiredMinSatisfying)return minSatisfying_1;hasRequiredMinSatisfying=1;const s=requireSemver$1(),e=requireRange();return minSatisfying_1=(n,r,o)=>{let c=null,u=null,h=null;try{h=new e(r,o)}catch{return null}return n.forEach(f=>{h.test(f)&&(!c||u.compare(f)===1)&&(c=f,u=new s(c,o))}),c},minSatisfying_1}var minVersion_1,hasRequiredMinVersion;function requireMinVersion(){if(hasRequiredMinVersion)return minVersion_1;hasRequiredMinVersion=1;const s=requireSemver$1(),e=requireRange(),t=requireGt();return minVersion_1=(r,o)=>{r=new e(r,o);let c=new s("0.0.0");if(r.test(c)||(c=new s("0.0.0-0"),r.test(c)))return c;c=null;for(let u=0;u<r.set.length;++u){const h=r.set[u];let f=null;h.forEach(p=>{const g=new s(p.semver.version);switch(p.operator){case">":g.prerelease.length===0?g.patch++:g.prerelease.push(0),g.raw=g.format();case"":case">=":(!f||t(g,f))&&(f=g);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${p.operator}`)}}),f&&(!c||t(c,f))&&(c=f)}return c&&r.test(c)?c:null},minVersion_1}var valid,hasRequiredValid;function requireValid(){if(hasRequiredValid)return valid;hasRequiredValid=1;const s=requireRange();return valid=(t,n)=>{try{return new s(t,n).range||"*"}catch{return null}},valid}var outside_1,hasRequiredOutside;function requireOutside(){if(hasRequiredOutside)return outside_1;hasRequiredOutside=1;const s=requireSemver$1(),e=requireComparator(),{ANY:t}=e,n=requireRange(),r=requireSatisfies(),o=requireGt(),c=requireLt(),u=requireLte(),h=requireGte();return outside_1=(p,g,y,v)=>{p=new s(p,v),g=new n(g,v);let _,E,x,w,T;switch(y){case">":_=o,E=u,x=c,w=">",T=">=";break;case"<":_=c,E=h,x=o,w="<",T="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(r(p,g,v))return!1;for(let O=0;O<g.set.length;++O){const N=g.set[O];let A=null,I=null;if(N.forEach(k=>{k.semver===t&&(k=new e(">=0.0.0")),A=A||k,I=I||k,_(k.semver,A.semver,v)?A=k:x(k.semver,I.semver,v)&&(I=k)}),A.operator===w||A.operator===T||(!I.operator||I.operator===w)&&E(p,I.semver))return!1;if(I.operator===T&&x(p,I.semver))return!1}return!0},outside_1}var gtr_1,hasRequiredGtr;function requireGtr(){if(hasRequiredGtr)return gtr_1;hasRequiredGtr=1;const s=requireOutside();return gtr_1=(t,n,r)=>s(t,n,">",r),gtr_1}var ltr_1,hasRequiredLtr;function requireLtr(){if(hasRequiredLtr)return ltr_1;hasRequiredLtr=1;const s=requireOutside();return ltr_1=(t,n,r)=>s(t,n,"<",r),ltr_1}var intersects_1,hasRequiredIntersects;function requireIntersects(){if(hasRequiredIntersects)return intersects_1;hasRequiredIntersects=1;const s=requireRange();return intersects_1=(t,n,r)=>(t=new s(t,r),n=new s(n,r),t.intersects(n,r)),intersects_1}var simplify,hasRequiredSimplify;function requireSimplify(){if(hasRequiredSimplify)return simplify;hasRequiredSimplify=1;const s=requireSatisfies(),e=requireCompare();return simplify=(t,n,r)=>{const o=[];let c=null,u=null;const h=t.sort((y,v)=>e(y,v,r));for(const y of h)s(y,n,r)?(u=y,c||(c=y)):(u&&o.push([c,u]),u=null,c=null);c&&o.push([c,null]);const f=[];for(const[y,v]of o)y===v?f.push(y):!v&&y===h[0]?f.push("*"):v?y===h[0]?f.push(`<=${v}`):f.push(`${y} - ${v}`):f.push(`>=${y}`);const p=f.join(" || "),g=typeof n.raw=="string"?n.raw:String(n);return p.length<g.length?p:n},simplify}var subset_1,hasRequiredSubset;function requireSubset(){if(hasRequiredSubset)return subset_1;hasRequiredSubset=1;const s=requireRange(),e=requireComparator(),{ANY:t}=e,n=requireSatisfies(),r=requireCompare(),o=(g,y,v={})=>{if(g===y)return!0;g=new s(g,v),y=new s(y,v);let _=!1;e:for(const E of g.set){for(const x of y.set){const w=h(E,x,v);if(_=_||w!==null,w)continue e}if(_)return!1}return!0},c=[new e(">=0.0.0-0")],u=[new e(">=0.0.0")],h=(g,y,v)=>{if(g===y)return!0;if(g.length===1&&g[0].semver===t){if(y.length===1&&y[0].semver===t)return!0;v.includePrerelease?g=c:g=u}if(y.length===1&&y[0].semver===t){if(v.includePrerelease)return!0;y=u}const _=new Set;let E,x;for(const M of g)M.operator===">"||M.operator===">="?E=f(E,M,v):M.operator==="<"||M.operator==="<="?x=p(x,M,v):_.add(M.semver);if(_.size>1)return null;let w;if(E&&x){if(w=r(E.semver,x.semver,v),w>0)return null;if(w===0&&(E.operator!==">="||x.operator!=="<="))return null}for(const M of _){if(E&&!n(M,String(E),v)||x&&!n(M,String(x),v))return null;for(const L of y)if(!n(M,String(L),v))return!1;return!0}let T,O,N,A,I=x&&!v.includePrerelease&&x.semver.prerelease.length?x.semver:!1,k=E&&!v.includePrerelease&&E.semver.prerelease.length?E.semver:!1;I&&I.prerelease.length===1&&x.operator==="<"&&I.prerelease[0]===0&&(I=!1);for(const M of y){if(A=A||M.operator===">"||M.operator===">=",N=N||M.operator==="<"||M.operator==="<=",E){if(k&&M.semver.prerelease&&M.semver.prerelease.length&&M.semver.major===k.major&&M.semver.minor===k.minor&&M.semver.patch===k.patch&&(k=!1),M.operator===">"||M.operator===">="){if(T=f(E,M,v),T===M&&T!==E)return!1}else if(E.operator===">="&&!n(E.semver,String(M),v))return!1}if(x){if(I&&M.semver.prerelease&&M.semver.prerelease.length&&M.semver.major===I.major&&M.semver.minor===I.minor&&M.semver.patch===I.patch&&(I=!1),M.operator==="<"||M.operator==="<="){if(O=p(x,M,v),O===M&&O!==x)return!1}else if(x.operator==="<="&&!n(x.semver,String(M),v))return!1}if(!M.operator&&(x||E)&&w!==0)return!1}return!(E&&N&&!x&&w!==0||x&&A&&!E&&w!==0||k||I)},f=(g,y,v)=>{if(!g)return y;const _=r(g.semver,y.semver,v);return _>0?g:_<0||y.operator===">"&&g.operator===">="?y:g},p=(g,y,v)=>{if(!g)return y;const _=r(g.semver,y.semver,v);return _<0?g:_>0||y.operator==="<"&&g.operator==="<="?y:g};return subset_1=o,subset_1}var semver,hasRequiredSemver;function requireSemver(){if(hasRequiredSemver)return semver;hasRequiredSemver=1;const s=requireRe(),e=requireConstants(),t=requireSemver$1(),n=requireIdentifiers(),r=requireParse(),o=requireValid$1(),c=requireClean(),u=requireInc(),h=requireDiff(),f=requireMajor(),p=requireMinor(),g=requirePatch(),y=requirePrerelease(),v=requireCompare(),_=requireRcompare(),E=requireCompareLoose(),x=requireCompareBuild(),w=requireSort(),T=requireRsort(),O=requireGt(),N=requireLt(),A=requireEq(),I=requireNeq(),k=requireGte(),M=requireLte(),L=requireCmp(),H=requireCoerce(),D=requireComparator(),q=requireRange(),J=requireSatisfies(),ae=requireToComparators(),V=requireMaxSatisfying(),Z=requireMinSatisfying(),G=requireMinVersion(),ne=requireValid(),B=requireOutside(),F=requireGtr(),Y=requireLtr(),U=requireIntersects(),C=requireSimplify(),P=requireSubset();return semver={parse:r,valid:o,clean:c,inc:u,diff:h,major:f,minor:p,patch:g,prerelease:y,compare:v,rcompare:_,compareLoose:E,compareBuild:x,sort:w,rsort:T,gt:O,lt:N,eq:A,neq:I,gte:k,lte:M,cmp:L,coerce:H,Comparator:D,Range:q,satisfies:J,toComparators:ae,maxSatisfying:V,minSatisfying:Z,minVersion:G,validRange:ne,outside:B,gtr:F,ltr:Y,intersects:U,simplifyRange:C,subset:P,SemVer:t,re:s.re,src:s.src,tokens:s.t,SEMVER_SPEC_VERSION:e.SEMVER_SPEC_VERSION,RELEASE_TYPES:e.RELEASE_TYPES,compareIdentifiers:n.compareIdentifiers,rcompareIdentifiers:n.rcompareIdentifiers},semver}requireSemver();function parsePromptIdentifier(s){if(!s||s.split("/").length>2||s.startsWith("/")||s.endsWith("/")||s.split(":").length>2)throw new Error(`Invalid identifier format: ${s}`);const[e,t]=s.split(":"),n=t||"latest";if(e.includes("/")){const[r,o]=e.split("/",2);if(!r||!o)throw new Error(`Invalid identifier format: ${s}`);return[r,o,n]}else{if(!e)throw new Error(`Invalid identifier format: ${s}`);return["-",e,n]}}class LangSmithConflictError extends Error{constructor(e){super(e),this.name="LangSmithConflictError"}}async function raiseForStatus(s,e,t){let n;if(s.ok){t&&(n=await s.text());return}n=await s.text();const r=`Failed to ${e}. Received status [${s.status}]: ${s.statusText}. Server response: ${n}`;throw s.status===409?new LangSmithConflictError(r):new Error(r)}var LIMIT_REPLACE_NODE="[...]",CIRCULAR_REPLACE_NODE={result:"[Circular]"},arr=[],replacerStack=[];const encoder=new TextEncoder;function defaultOptions(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function encodeString(s){return encoder.encode(s)}function serialize(s,e,t,n){var r;try{const o=JSON.stringify(s,e,t);return encodeString(o)}catch(o){if(!((r=o.message)!=null&&r.includes("Converting circular structure to JSON")))return console.warn("[WARNING]: LangSmith received unserializable value."),encodeString("[Unserializable]");console.warn("[WARNING]: LangSmith received circular JSON. This will decrease tracer performance."),typeof n>"u"&&(n=defaultOptions()),decirc(s,"",0,[],void 0,0,n);let c;try{replacerStack.length===0?c=JSON.stringify(s,e,t):c=JSON.stringify(s,replaceGetterValues(e),t)}catch{return encodeString("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;arr.length!==0;){const u=arr.pop();u.length===4?Object.defineProperty(u[0],u[1],u[3]):u[0][u[1]]=u[2]}}return encodeString(c)}}function setReplace(s,e,t,n){var r=Object.getOwnPropertyDescriptor(n,t);r.get!==void 0?r.configurable?(Object.defineProperty(n,t,{value:s}),arr.push([n,t,e,r])):replacerStack.push([e,t,s]):(n[t]=s,arr.push([n,t,e]))}function decirc(s,e,t,n,r,o,c){o+=1;var u;if(typeof s=="object"&&s!==null){for(u=0;u<n.length;u++)if(n[u]===s){setReplace(CIRCULAR_REPLACE_NODE,s,e,r);return}if(typeof c.depthLimit<"u"&&o>c.depthLimit){setReplace(LIMIT_REPLACE_NODE,s,e,r);return}if(typeof c.edgesLimit<"u"&&t+1>c.edgesLimit){setReplace(LIMIT_REPLACE_NODE,s,e,r);return}if(n.push(s),Array.isArray(s))for(u=0;u<s.length;u++)decirc(s[u],u,u,n,s,o,c);else{var h=Object.keys(s);for(u=0;u<h.length;u++){var f=h[u];decirc(s[f],f,u,n,s,o,c)}}n.pop()}}function replaceGetterValues(s){return s=typeof s<"u"?s:function(e,t){return t},function(e,t){if(replacerStack.length>0)for(var n=0;n<replacerStack.length;n++){var r=replacerStack[n];if(r[1]===e&&r[0]===t){t=r[2],replacerStack.splice(n,1);break}}return s.call(this,e,t)}}function mergeRuntimeEnvIntoRunCreate(s){const e=getRuntimeEnvironment$1(),t=getLangChainEnvVarsMetadata(),n=s.extra??{},r=n.metadata;return s.extra={...n,runtime:{...e,...n==null?void 0:n.runtime},metadata:{...t,...t.revision_id||s.revision_id?{revision_id:s.revision_id??t.revision_id}:{},...r}},s}const getTracingSamplingRate=()=>{const s=getLangSmithEnvironmentVariable("TRACING_SAMPLING_RATE");if(s===void 0)return;const e=parseFloat(s);if(e<0||e>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${e}`);return e},isLocalhost=s=>{const t=s.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return t==="localhost"||t==="127.0.0.1"||t==="::1"};async function toArray(s){const e=[];for await(const t of s)e.push(t);return e}function trimQuotes(s){if(s!==void 0)return s.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const handle429=async s=>{if((s==null?void 0:s.status)===429){const e=parseInt(s.headers.get("retry-after")??"30",10)*1e3;if(e>0)return await new Promise(t=>setTimeout(t,e)),!0}return!1};class AutoBatchQueue{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}peek(){return this.items[0]}push(e){let t;const n=new Promise(o=>{t=o}),r=serialize(e.item).length;return this.items.push({action:e.action,payload:e.item,itemPromiseResolve:t,itemPromise:n,size:r}),this.sizeBytes+=r,n}pop(e){var r;if(e<1)throw new Error("Number of bytes to pop off may not be less than 1.");const t=[];let n=0;for(;n+(((r=this.peek())==null?void 0:r.size)??0)<e&&this.items.length>0;){const o=this.items.shift();o&&(t.push(o),n+=o.size,this.sizeBytes-=o.size)}if(t.length===0&&this.items.length>0){const o=this.items.shift();t.push(o),n+=o.size,this.sizeBytes-=o.size}return[t.map(o=>({action:o.action,item:o.payload})),()=>t.forEach(o=>o.itemPromiseResolve())]}}const DEFAULT_BATCH_SIZE_LIMIT_BYTES=20971520,SERVER_INFO_REQUEST_TIMEOUT=2500;class Client{constructor(e={}){var n;Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new AutoBatchQueue}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:getEnvironmentVariable$1("LANGSMITH_TRACING_BACKGROUND")==="false"}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"manualFlushMode",{enumerable:!0,configurable:!0,writable:!0,value:!1});const t=Client.getDefaultClientConfig();if(this.tracingSampleRate=getTracingSamplingRate(),this.apiUrl=trimQuotes(e.apiUrl??t.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=trimQuotes(e.apiKey??t.apiKey),this.webUrl=trimQuotes(e.webUrl??t.webUrl),(n=this.webUrl)!=null&&n.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.timeout_ms=e.timeout_ms??9e4,this.caller=new AsyncCaller$1(e.callerOptions??{}),this.traceBatchConcurrency=e.traceBatchConcurrency??this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw new Error("Trace batch concurrency must be positive.");this.batchIngestCaller=new AsyncCaller$1({maxRetries:2,maxConcurrency:this.traceBatchConcurrency,...e.callerOptions??{},onFailedResponseHook:handle429}),this.hideInputs=e.hideInputs??e.anonymizer??t.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??t.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.fetchOptions=e.fetchOptions||{},this.manualFlushMode=e.manualFlushMode??this.manualFlushMode}static getDefaultClientConfig(){const e=getLangSmithEnvironmentVariable("API_KEY"),t=getLangSmithEnvironmentVariable("ENDPOINT")??"https://api.smith.langchain.com",n=getLangSmithEnvironmentVariable("HIDE_INPUTS")==="true",r=getLangSmithEnvironmentVariable("HIDE_OUTPUTS")==="true";return{apiUrl:t,apiKey:e,webUrl:void 0,hideInputs:n,hideOutputs:r}}getHostUrl(){return this.webUrl?this.webUrl:isLocalhost(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.endsWith("/api/v1")?(this.webUrl=this.apiUrl.replace("/api/v1",""),this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("beta")?(this.webUrl="https://beta.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const e={"User-Agent":`langsmith-js/${__version__}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}prepareRunCreateOrUpdateInputs(e){const t={...e};return t.inputs!==void 0&&(t.inputs=this.processInputs(t.inputs)),t.outputs!==void 0&&(t.outputs=this.processOutputs(t.outputs)),t}async _getResponse(e,t){const n=(t==null?void 0:t.toString())??"",r=`${this.apiUrl}${e}?${n}`,o=await this.caller.call(_getFetchImplementation(),r,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(o,`Failed to fetch ${e}`),o}async _get(e,t){return(await this._getResponse(e,t)).json()}async*_getPaginated(e,t=new URLSearchParams,n){let r=Number(t.get("offset"))||0;const o=Number(t.get("limit"))||100;for(;;){t.set("offset",String(r)),t.set("limit",String(o));const c=`${this.apiUrl}${e}?${t}`,u=await this.caller.call(_getFetchImplementation(),c,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(u,`Failed to fetch ${e}`);const h=n?n(await u.json()):await u.json();if(h.length===0||(yield h,h.length<o))break;r+=h.length}}async*_getCursorPaginatedList(e,t=null,n="POST",r="runs"){const o=t?{...t}:{};for(;;){const u=await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}${e}`,{method:n,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(o)})).json();if(!u||!u[r])break;yield u[r];const h=u.cursors;if(!h||!h.next)break;o.cursor=h.next}}_filterForSampling(e,t=!1){if(this.tracingSampleRate===void 0)return e;if(t){const n=[];for(const r of e)this.filteredPostUuids.has(r.id)?this.filteredPostUuids.delete(r.id):n.push(r);return n}else{const n=[];for(const r of e)r.id!==r.trace_id&&!this.filteredPostUuids.has(r.trace_id)||Math.random()<this.tracingSampleRate?n.push(r):this.filteredPostUuids.add(r.id);return n}}async _getBatchSizeLimitBytes(){var t;const e=await this._ensureServerInfo();return this.batchSizeBytesLimit??((t=e.batch_ingest_config)==null?void 0:t.size_limit_bytes)??DEFAULT_BATCH_SIZE_LIMIT_BYTES}async _getMultiPartSupport(){var t;return((t=(await this._ensureServerInfo()).instance_flags)==null?void 0:t.dataset_examples_multipart_enabled)??!1}drainAutoBatchQueue(e){const t=[];for(;this.autoBatchQueue.items.length>0;){const[n,r]=this.autoBatchQueue.pop(e);if(!n.length){r();break}const o=this._processBatch(n,r).catch(console.error);t.push(o)}return Promise.all(t)}async _processBatch(e,t){var n;if(!e.length){t();return}try{const r={runCreates:e.filter(c=>c.action==="create").map(c=>c.item),runUpdates:e.filter(c=>c.action==="update").map(c=>c.item)},o=await this._ensureServerInfo();(n=o==null?void 0:o.batch_ingest_config)!=null&&n.use_multipart_endpoint?await this.multipartIngestRuns(r):await this.batchIngestRuns(r)}finally{t()}}async processRunOperation(e){clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,e.action==="create"&&(e.item=mergeRuntimeEnvIntoRunCreate(e.item));const t=this.autoBatchQueue.push(e);if(this.manualFlushMode)return t;const n=await this._getBatchSizeLimitBytes();return this.autoBatchQueue.sizeBytes>n&&this.drainAutoBatchQueue(n),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue(n)},this.autoBatchAggregationDelayMs)),t}async _getServerInfo(){const e=await _getFetchImplementation()(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(SERVER_INFO_REQUEST_TIMEOUT),...this.fetchOptions});return await raiseForStatus(e,"get server info"),e.json()}async _ensureServerInfo(){return this._getServerInfoPromise===void 0&&(this._getServerInfoPromise=(async()=>{if(this._serverInfo===void 0)try{this._serverInfo=await this._getServerInfo()}catch{console.warn("[WARNING]: LangSmith failed to fetch info on supported operations. Falling back to batch operations and default limits.")}return this._serverInfo??{}})()),this._getServerInfoPromise.then(e=>(this._serverInfo===void 0&&(this._getServerInfoPromise=void 0),e))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async flush(){const e=await this._getBatchSizeLimitBytes();await this.drainAutoBatchQueue(e)}async createRun(e){if(!this._filterForSampling([e]).length)return;const t={...this.headers,"Content-Type":"application/json"},n=e.project_name;delete e.project_name;const r=this.prepareRunCreateOrUpdateInputs({session_name:n,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&r.trace_id!==void 0&&r.dotted_order!==void 0){this.processRunOperation({action:"create",item:r}).catch(console.error);return}const o=mergeRuntimeEnvIntoRunCreate(r),c=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/runs`,{method:"POST",headers:t,body:serialize(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(c,"create run",!0)}async batchIngestRuns({runCreates:e,runUpdates:t}){if(e===void 0&&t===void 0)return;let n=(e==null?void 0:e.map(u=>this.prepareRunCreateOrUpdateInputs(u)))??[],r=(t==null?void 0:t.map(u=>this.prepareRunCreateOrUpdateInputs(u)))??[];if(n.length>0&&r.length>0){const u=n.reduce((f,p)=>(p.id&&(f[p.id]=p),f),{}),h=[];for(const f of r)f.id!==void 0&&u[f.id]?u[f.id]={...u[f.id],...f}:h.push(f);n=Object.values(u),r=h}const o={post:this._filterForSampling(n),patch:this._filterForSampling(r,!0)};if(!o.post.length&&!o.patch.length)return;const c={post:[],patch:[]};for(const u of["post","patch"]){const h=u,f=o[h].reverse();let p=f.pop();for(;p!==void 0;)c[h].push(p),p=f.pop()}(c.post.length>0||c.patch.length>0)&&await this._postBatchIngestRuns(serialize(c))}async _postBatchIngestRuns(e){const t={...this.headers,"Content-Type":"application/json",Accept:"application/json"},n=await this.batchIngestCaller.call(_getFetchImplementation(),`${this.apiUrl}/runs/batch`,{method:"POST",headers:t,body:e,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(n,"batch create run",!0)}async multipartIngestRuns({runCreates:e,runUpdates:t}){if(e===void 0&&t===void 0)return;const n={};let r=[];for(const p of e??[]){const g=this.prepareRunCreateOrUpdateInputs(p);g.id!==void 0&&g.attachments!==void 0&&(n[g.id]=g.attachments),delete g.attachments,r.push(g)}let o=[];for(const p of t??[])o.push(this.prepareRunCreateOrUpdateInputs(p));if(r.find(p=>p.trace_id===void 0||p.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(o.find(p=>p.trace_id===void 0||p.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(r.length>0&&o.length>0){const p=r.reduce((y,v)=>(v.id&&(y[v.id]=v),y),{}),g=[];for(const y of o)y.id!==void 0&&p[y.id]?p[y.id]={...p[y.id],...y}:g.push(y);r=Object.values(p),o=g}if(r.length===0&&o.length===0)return;const h=[],f=[];for(const[p,g]of[["post",r],["patch",o]])for(const y of g){const{inputs:v,outputs:_,events:E,attachments:x,...w}=y,T={inputs:v,outputs:_,events:E},O=serialize(w);f.push({name:`${p}.${w.id}`,payload:new Blob([O],{type:`application/json; length=${O.length}`})});for(const[N,A]of Object.entries(T)){if(A===void 0)continue;const I=serialize(A);f.push({name:`${p}.${w.id}.${N}`,payload:new Blob([I],{type:`application/json; length=${I.length}`})})}if(w.id!==void 0){const N=n[w.id];if(N){delete n[w.id];for(const[A,I]of Object.entries(N)){let k,M;if(Array.isArray(I)?[k,M]=I:(k=I.mimeType,M=I.data),A.includes(".")){console.warn(`Skipping attachment '${A}' for run ${w.id}: Invalid attachment name. Attachment names must not contain periods ('.'). Please rename the attachment and try again.`);continue}f.push({name:`attachment.${w.id}.${A}`,payload:new Blob([M],{type:`${k}; length=${M.byteLength}`})})}}}h.push(`trace=${w.trace_id},id=${w.id}`)}await this._sendMultipartRequest(f,h.join("; "))}async _sendMultipartRequest(e,t){try{const n="----LangSmithFormBoundary"+Math.random().toString(36).slice(2),r=[];for(const h of e)r.push(new Blob([`--${n}\r
`])),r.push(new Blob([`Content-Disposition: form-data; name="${h.name}"\r
`,`Content-Type: ${h.payload.type}\r
\r
`])),r.push(h.payload),r.push(new Blob([`\r
`]));r.push(new Blob([`--${n}--\r
`]));const c=await new Blob(r).arrayBuffer(),u=await this.batchIngestCaller.call(_getFetchImplementation(),`${this.apiUrl}/runs/multipart`,{method:"POST",headers:{...this.headers,"Content-Type":`multipart/form-data; boundary=${n}`},body:c,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(u,"ingest multipart runs",!0)}catch(n){console.warn(`${n.message.trim()}

Context: ${t}`)}}async updateRun(e,t){assertUuid(e),t.inputs&&(t.inputs=this.processInputs(t.inputs)),t.outputs&&(t.outputs=this.processOutputs(t.outputs));const n={...t,id:e};if(!this._filterForSampling([n],!0).length)return;if(this.autoBatchTracing&&n.trace_id!==void 0&&n.dotted_order!==void 0){if(t.end_time!==void 0&&n.parent_run_id===void 0&&this.blockOnRootRunFinalization&&!this.manualFlushMode){await this.processRunOperation({action:"update",item:n}).catch(console.error);return}else this.processRunOperation({action:"update",item:n}).catch(console.error);return}const r={...this.headers,"Content-Type":"application/json"},o=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:r,body:serialize(t),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(o,"update run",!0)}async readRun(e,{loadChildRuns:t}={loadChildRuns:!1}){assertUuid(e);let n=await this._get(`/runs/${e}`);return t&&n.child_run_ids&&(n=await this._loadChildRuns(n)),n}async getRunUrl({runId:e,run:t,projectOpts:n}){if(t!==void 0){let r;t.session_id?r=t.session_id:n!=null&&n.projectName?r=(await this.readProject({projectName:n==null?void 0:n.projectName})).id:n!=null&&n.projectId?r=n==null?void 0:n.projectId:r=(await this.readProject({projectName:getLangSmithEnvironmentVariable("PROJECT")||"default"})).id;const o=await this._getTenantId();return`${this.getHostUrl()}/o/${o}/projects/p/${r}/r/${t.id}?poll=true`}else if(e!==void 0){const r=await this.readRun(e);if(!r.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${r.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){const t=await toArray(this.listRuns({id:e.child_run_ids})),n={},r={};t.sort((o,c)=>((o==null?void 0:o.dotted_order)??"").localeCompare((c==null?void 0:c.dotted_order)??""));for(const o of t){if(o.parent_run_id===null||o.parent_run_id===void 0)throw new Error(`Child run ${o.id} has no parent`);o.parent_run_id in n||(n[o.parent_run_id]=[]),n[o.parent_run_id].push(o),r[o.id]=o}e.child_runs=n[e.id]||[];for(const o in n)o!==e.id&&(r[o].child_runs=n[o]);return e}async*listRuns(e){const{projectId:t,projectName:n,parentRunId:r,traceId:o,referenceExampleId:c,startTime:u,executionOrder:h,isRoot:f,runType:p,error:g,id:y,query:v,filter:_,traceFilter:E,treeFilter:x,limit:w,select:T}=e;let O=[];if(t&&(O=Array.isArray(t)?t:[t]),n){const k=Array.isArray(n)?n:[n],M=await Promise.all(k.map(L=>this.readProject({projectName:L}).then(H=>H.id)));O.push(...M)}const N=["app_path","child_run_ids","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],A={session:O.length?O:null,run_type:p,reference_example:c,query:v,filter:_,trace_filter:E,tree_filter:x,execution_order:h,parent_run:r,start_time:u?u.toISOString():null,error:g,id:y,limit:w,trace:o,select:T||N,is_root:f};let I=0;for await(const k of this._getCursorPaginatedList("/runs/query",A))if(w){if(I>=w)break;if(k.length+I>w){yield*k.slice(0,w-I);break}I+=k.length,yield*k}else yield*k}async getRunStats({id:e,trace:t,parentRun:n,runType:r,projectNames:o,projectIds:c,referenceExampleIds:u,startTime:h,endTime:f,error:p,query:g,filter:y,traceFilter:v,treeFilter:_,isRoot:E,dataSourceType:x}){let w=c||[];o&&(w=[...c||[],...await Promise.all(o.map(I=>this.readProject({projectName:I}).then(k=>k.id)))]);const O=Object.fromEntries(Object.entries({id:e,trace:t,parent_run:n,run_type:r,session:w,reference_example:u,start_time:h,end_time:f,error:p,query:g,filter:y,trace_filter:v,tree_filter:_,is_root:E,data_source_type:x}).filter(([I,k])=>k!==void 0));return await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/runs/stats`,{method:"POST",headers:this.headers,body:JSON.stringify(O),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async shareRun(e,{shareId:t}={}){const n={run_id:e,share_token:t||v4()};assertUuid(e);const o=await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(o===null||!("share_token"in o))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${o.share_token}/r`}async unshareRun(e){assertUuid(e);const t=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(t,"unshare run",!0)}async readRunSharedLink(e){assertUuid(e);const n=await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(!(n===null||!("share_token"in n)))return`${this.getHostUrl()}/public/${n.share_token}/r`}async listSharedRuns(e,{runIds:t}={}){const n=new URLSearchParams({share_token:e});if(t!==void 0)for(const c of t)n.append("id",c);return assertUuid(e),await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/public/${e}/runs${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async readDatasetSharedSchema(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id),assertUuid(e);const r=await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return r.url=`${this.getHostUrl()}/public/${r.share_token}/d`,r}async shareDataset(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id);const n={dataset_id:e};assertUuid(e);const o=await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return o.url=`${this.getHostUrl()}/public/${o.share_token}/d`,o}async unshareDataset(e){assertUuid(e);const t=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(t,"unshare dataset",!0)}async readSharedDataset(e){return assertUuid(e),await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async listSharedExamples(e,t){const n={};t!=null&&t.exampleIds&&(n.id=t.exampleIds);const r=new URLSearchParams;Object.entries(n).forEach(([u,h])=>{Array.isArray(h)?h.forEach(f=>r.append(u,f)):r.append(u,h)});const o=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/public/${e}/examples?${r.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),c=await o.json();if(!o.ok)throw"detail"in c?new Error(`Failed to list shared examples.
Status: ${o.status}
Message: ${c.detail.join(`
`)}`):new Error(`Failed to list shared examples: ${o.status} ${o.statusText}`);return c.map(u=>({...u,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:t=null,metadata:n=null,upsert:r=!1,projectExtra:o=null,referenceDatasetId:c=null}){const u=r?"?upsert=true":"",h=`${this.apiUrl}/sessions${u}`,f=o||{};n&&(f.metadata=n);const p={name:e,extra:f,description:t};c!==null&&(p.reference_dataset_id=c);const g=await this.caller.call(_getFetchImplementation(),h,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(p),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(g,"create project"),await g.json()}async updateProject(e,{name:t=null,description:n=null,metadata:r=null,projectExtra:o=null,endTime:c=null}){const u=`${this.apiUrl}/sessions/${e}`;let h=o;r&&(h={...h||{},metadata:r});const f={name:t,extra:h,description:n,end_time:c?new Date(c).toISOString():null},p=await this.caller.call(_getFetchImplementation(),u,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(f),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(p,"update project"),await p.json()}async hasProject({projectId:e,projectName:t}){let n="/sessions";const r=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)assertUuid(e),n+=`/${e}`;else if(t!==void 0)r.append("name",t);else throw new Error("Must provide projectName or projectId");const o=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}${n}?${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});try{const c=await o.json();return o.ok?Array.isArray(c)?c.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:t,includeStats:n}){let r="/sessions";const o=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)assertUuid(e),r+=`/${e}`;else if(t!==void 0)o.append("name",t);else throw new Error("Must provide projectName or projectId");n!==void 0&&o.append("include_stats",n.toString());const c=await this._get(r,o);let u;if(Array.isArray(c)){if(c.length===0)throw new Error(`Project[id=${e}, name=${t}] not found`);u=c[0]}else u=c;return u}async getProjectUrl({projectId:e,projectName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either projectName or projectId");const n=await this.readProject({projectId:e,projectName:t}),r=await this._getTenantId();return`${this.getHostUrl()}/o/${r}/projects/p/${n.id}`}async getDatasetUrl({datasetId:e,datasetName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");const n=await this.readDataset({datasetId:e,datasetName:t}),r=await this._getTenantId();return`${this.getHostUrl()}/o/${r}/datasets/${n.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const t of this._getPaginated("/sessions",e))return this._tenantId=t[0].tenant_id,t[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:t,nameContains:n,referenceDatasetId:r,referenceDatasetName:o,referenceFree:c,metadata:u}={}){const h=new URLSearchParams;if(e!==void 0)for(const f of e)h.append("id",f);if(t!==void 0&&h.append("name",t),n!==void 0&&h.append("name_contains",n),r!==void 0)h.append("reference_dataset",r);else if(o!==void 0){const f=await this.readDataset({datasetName:o});h.append("reference_dataset",f.id)}c!==void 0&&h.append("reference_free",c.toString()),u!==void 0&&h.append("metadata",JSON.stringify(u));for await(const f of this._getPaginated("/sessions",h))yield*f}async deleteProject({projectId:e,projectName:t}){let n;if(e===void 0&&t===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?n=(await this.readProject({projectName:t})).id:n=e,assertUuid(n);const r=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/sessions/${n}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(r,`delete session ${n} (${t})`,!0)}async uploadCsv({csvFile:e,fileName:t,inputKeys:n,outputKeys:r,description:o,dataType:c,name:u}){const h=`${this.apiUrl}/datasets/upload`,f=new FormData;f.append("file",e,t),n.forEach(y=>{f.append("input_keys",y)}),r.forEach(y=>{f.append("output_keys",y)}),o&&f.append("description",o),c&&f.append("data_type",c),u&&f.append("name",u);const p=await this.caller.call(_getFetchImplementation(),h,{method:"POST",headers:this.headers,body:f,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(p,"upload CSV"),await p.json()}async createDataset(e,{description:t,dataType:n,inputsSchema:r,outputsSchema:o,metadata:c}={}){const u={name:e,description:t,extra:c?{metadata:c}:void 0};n&&(u.data_type=n),r&&(u.inputs_schema_definition=r),o&&(u.outputs_schema_definition=o);const h=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(h,"create dataset"),await h.json()}async readDataset({datasetId:e,datasetName:t}){let n="/datasets";const r=new URLSearchParams({limit:"1"});if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)assertUuid(e),n+=`/${e}`;else if(t!==void 0)r.append("name",t);else throw new Error("Must provide datasetName or datasetId");const o=await this._get(n,r);let c;if(Array.isArray(o)){if(o.length===0)throw new Error(`Dataset[id=${e}, name=${t}] not found`);c=o[0]}else c=o;return c}async hasDataset({datasetId:e,datasetName:t}){try{return await this.readDataset({datasetId:e,datasetName:t}),!0}catch(n){if(n instanceof Error&&n.message.toLocaleLowerCase().includes("not found"))return!1;throw n}}async diffDatasetVersions({datasetId:e,datasetName:t,fromVersion:n,toVersion:r}){let o=e;if(o===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");if(o!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");o===void 0&&(o=(await this.readDataset({datasetName:t})).id);const c=new URLSearchParams({from_version:typeof n=="string"?n:n.toISOString(),to_version:typeof r=="string"?r:r.toISOString()});return await this._get(`/datasets/${o}/versions/diff`,c)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:t}){const n="/datasets";if(e===void 0)if(t!==void 0)e=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide datasetName or datasetId");return(await(await this._getResponse(`${n}/${e}/openai_ft`)).text()).trim().split(`
`).map(u=>JSON.parse(u))}async*listDatasets({limit:e=100,offset:t=0,datasetIds:n,datasetName:r,datasetNameContains:o,metadata:c}={}){const u="/datasets",h=new URLSearchParams({limit:e.toString(),offset:t.toString()});if(n!==void 0)for(const f of n)h.append("id",f);r!==void 0&&h.append("name",r),o!==void 0&&h.append("name_contains",o),c!==void 0&&h.append("metadata",JSON.stringify(c));for await(const f of this._getPaginated(u,h))yield*f}async updateDataset(e){const{datasetId:t,datasetName:n,...r}=e;if(!t&&!n)throw new Error("Must provide either datasetName or datasetId");const o=t??(await this.readDataset({datasetName:n})).id;assertUuid(o);const c=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${o}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(c,"update dataset"),await c.json()}async updateDatasetTag(e){const{datasetId:t,datasetName:n,asOf:r,tag:o}=e;if(!t&&!n)throw new Error("Must provide either datasetName or datasetId");const c=t??(await this.readDataset({datasetName:n})).id;assertUuid(c);const u=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${c}/tags`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({as_of:typeof r=="string"?r:r.toISOString(),tag:o}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(u,"update dataset tags")}async deleteDataset({datasetId:e,datasetName:t}){let n="/datasets",r=e;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(t!==void 0&&(r=(await this.readDataset({datasetName:t})).id),r!==void 0)assertUuid(r),n+=`/${r}`;else throw new Error("Must provide datasetName or datasetId");const o=await this.caller.call(_getFetchImplementation(),this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(o,`delete ${n}`),await o.json()}async indexDataset({datasetId:e,datasetName:t,tag:n}){let r=e;if(!r&&!t)throw new Error("Must provide either datasetName or datasetId");if(r&&t)throw new Error("Must provide either datasetName or datasetId, not both");r||(r=(await this.readDataset({datasetName:t})).id),assertUuid(r);const o={tag:n},c=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${r}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(c,"index dataset"),await c.json()}async similarExamples(e,t,n,{filter:r}={}){const o={limit:n,inputs:e};r!==void 0&&(o.filter=r),assertUuid(t);const c=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${t}/search`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(c,"fetch similar examples"),(await c.json()).examples}async createExample(e,t,{datasetId:n,datasetName:r,createdAt:o,exampleId:c,metadata:u,split:h,sourceRunId:f}){let p=n;if(p===void 0&&r===void 0)throw new Error("Must provide either datasetName or datasetId");if(p!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");p===void 0&&(p=(await this.readDataset({datasetName:r})).id);const g=o||new Date,y={dataset_id:p,inputs:e,outputs:t,created_at:g==null?void 0:g.toISOString(),id:c,metadata:u,split:h,source_run_id:f},v=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/examples`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(y),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(v,"create example"),await v.json()}async createExamples(e){const{inputs:t,outputs:n,metadata:r,sourceRunIds:o,exampleIds:c,datasetId:u,datasetName:h}=e;let f=u;if(f===void 0&&h===void 0)throw new Error("Must provide either datasetName or datasetId");if(f!==void 0&&h!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");f===void 0&&(f=(await this.readDataset({datasetName:h})).id);const p=t.map((v,_)=>({dataset_id:f,inputs:v,outputs:n?n[_]:void 0,metadata:r?r[_]:void 0,split:e.splits?e.splits[_]:void 0,id:c?c[_]:void 0,source_run_id:o?o[_]:void 0})),g=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/examples/bulk`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(p),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(g,"create examples"),await g.json()}async createLLMExample(e,t,n){return this.createExample({input:e},{output:t},n)}async createChatExample(e,t,n){const r=e.map(c=>isLangChainMessage(c)?convertLangChainMessageToExample(c):c),o=isLangChainMessage(t)?convertLangChainMessageToExample(t):t;return this.createExample({input:r},{output:o},n)}async readExample(e){assertUuid(e);const t=`/examples/${e}`,n=await this._get(t),{attachment_urls:r,...o}=n,c=o;return r&&(c.attachments=Object.entries(r).reduce((u,[h,f])=>(u[h.slice(11)]={presigned_url:f.presigned_url,mime_type:f.mime_type},u),{})),c}async*listExamples({datasetId:e,datasetName:t,exampleIds:n,asOf:r,splits:o,inlineS3Urls:c,metadata:u,limit:h,offset:f,filter:p,includeAttachments:g}={}){let y;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)y=e;else if(t!==void 0)y=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide a datasetName or datasetId");const v=new URLSearchParams({dataset:y}),_=r?typeof r=="string"?r:r==null?void 0:r.toISOString():void 0;_&&v.append("as_of",_);const E=c??!0;if(v.append("inline_s3_urls",E.toString()),n!==void 0)for(const w of n)v.append("id",w);if(o!==void 0)for(const w of o)v.append("splits",w);if(u!==void 0){const w=JSON.stringify(u);v.append("metadata",w)}h!==void 0&&v.append("limit",h.toString()),f!==void 0&&v.append("offset",f.toString()),p!==void 0&&v.append("filter",p),g===!0&&["attachment_urls","outputs","metadata"].forEach(w=>v.append("select",w));let x=0;for await(const w of this._getPaginated("/examples",v)){for(const T of w){const{attachment_urls:O,...N}=T,A=N;O&&(A.attachments=Object.entries(O).reduce((I,[k,M])=>(I[k.slice(11)]={presigned_url:M.presigned_url,mime_type:M.mime_type||void 0},I),{})),yield A,x++}if(h!==void 0&&x>=h)break}}async deleteExample(e){assertUuid(e);const t=`/examples/${e}`,n=await this.caller.call(_getFetchImplementation(),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(n,`delete ${t}`),await n.json()}async updateExample(e,t){assertUuid(e);const n=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/examples/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(n,"update example"),await n.json()}async updateExamples(e){const t=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/examples/bulk`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(e),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(t,"update examples"),await t.json()}async readDatasetVersion({datasetId:e,datasetName:t,asOf:n,tag:r}){let o;if(e?o=e:o=(await this.readDataset({datasetName:t})).id,assertUuid(o),n&&r||!n&&!r)throw new Error("Exactly one of asOf and tag must be specified.");const c=new URLSearchParams;n!==void 0&&c.append("as_of",typeof n=="string"?n:n.toISOString()),r!==void 0&&c.append("tag",r);const u=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${o}/version?${c.toString()}`,{method:"GET",headers:{...this.headers},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(u,"read dataset version"),await u.json()}async listDatasetSplits({datasetId:e,datasetName:t,asOf:n}){let r;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?r=(await this.readDataset({datasetName:t})).id:r=e,assertUuid(r);const o=new URLSearchParams,c=n?typeof n=="string"?n:n==null?void 0:n.toISOString():void 0;return c&&o.append("as_of",c),await this._get(`/datasets/${r}/splits`,o)}async updateDatasetSplits({datasetId:e,datasetName:t,splitName:n,exampleIds:r,remove:o=!1}){let c;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?c=(await this.readDataset({datasetName:t})).id:c=e,assertUuid(c);const u={split_name:n,examples:r.map(f=>(assertUuid(f),f)),remove:o},h=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/${c}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(h,"update dataset splits",!0)}async evaluateRun(e,t,{sourceInfo:n,loadChildRuns:r,referenceExample:o}={loadChildRuns:!1}){warnOnce("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead.");let c;if(typeof e=="string")c=await this.readRun(e,{loadChildRuns:r});else if(typeof e=="object"&&"id"in e)c=e;else throw new Error(`Invalid run type: ${typeof e}`);c.reference_example_id!==null&&c.reference_example_id!==void 0&&(o=await this.readExample(c.reference_example_id));const u=await t.evaluateRun(c,o),[h,f]=await this._logEvaluationFeedback(u,c,n);return f[0]}async createFeedback(e,t,{score:n,value:r,correction:o,comment:c,sourceInfo:u,feedbackSourceType:h="api",sourceRunId:f,feedbackId:p,feedbackConfig:g,projectId:y,comparativeExperimentId:v}){var T;if(!e&&!y)throw new Error("One of runId or projectId must be provided");if(e&&y)throw new Error("Only one of runId or projectId can be provided");const _={type:h??"api",metadata:u??{}};f!==void 0&&(_==null?void 0:_.metadata)!==void 0&&!_.metadata.__run&&(_.metadata.__run={run_id:f}),(_==null?void 0:_.metadata)!==void 0&&((T=_.metadata.__run)==null?void 0:T.run_id)!==void 0&&assertUuid(_.metadata.__run.run_id);const E={id:p??v4(),run_id:e,key:t,score:n,value:r,correction:o,comment:c,feedback_source:_,comparative_experiment_id:v,feedbackConfig:g,session_id:y},x=`${this.apiUrl}/feedback`,w=await this.caller.call(_getFetchImplementation(),x,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(E),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(w,"create feedback",!0),E}async updateFeedback(e,{score:t,value:n,correction:r,comment:o}){const c={};t!=null&&(c.score=t),n!=null&&(c.value=n),r!=null&&(c.correction=r),o!=null&&(c.comment=o),assertUuid(e);const u=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(u,"update feedback",!0)}async readFeedback(e){assertUuid(e);const t=`/feedback/${e}`;return await this._get(t)}async deleteFeedback(e){assertUuid(e);const t=`/feedback/${e}`,n=await this.caller.call(_getFetchImplementation(),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(n,`delete ${t}`),await n.json()}async*listFeedback({runIds:e,feedbackKeys:t,feedbackSourceTypes:n}={}){const r=new URLSearchParams;if(e&&r.append("run",e.join(",")),t)for(const o of t)r.append("key",o);if(n)for(const o of n)r.append("source",o);for await(const o of this._getPaginated("/feedback",r))yield*o}async createPresignedFeedbackToken(e,t,{expiration:n,feedbackConfig:r}={}){const o={run_id:e,feedback_key:t,feedback_config:r};return n?typeof n=="string"?o.expires_at=n:(n!=null&&n.hours||n!=null&&n.minutes||n!=null&&n.days)&&(o.expires_in=n):o.expires_in={hours:3},await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async createComparativeExperiment({name:e,experimentIds:t,referenceDatasetId:n,createdAt:r,description:o,metadata:c,id:u}){var p;if(t.length===0)throw new Error("At least one experiment is required");if(n||(n=(await this.readProject({projectId:t[0]})).reference_dataset_id),!n==null)throw new Error("A reference dataset is required");const h={id:u,name:e,experiment_ids:t,reference_dataset_id:n,description:o,created_at:(p=r??new Date)==null?void 0:p.toISOString(),extra:{}};return c&&(h.extra.metadata=c),await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(h),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async*listPresignedFeedbackTokens(e){assertUuid(e);const t=new URLSearchParams({run_id:e});for await(const n of this._getPaginated("/feedback/tokens",t))yield*n}_selectEvalResults(e){let t;return"results"in e?t=e.results:t=[e],t}async _logEvaluationFeedback(e,t,n){const r=this._selectEvalResults(e),o=[];for(const c of r){let u=n||{};c.evaluatorInfo&&(u={...c.evaluatorInfo,...u});let h=null;c.targetRunId?h=c.targetRunId:t&&(h=t.id),o.push(await this.createFeedback(h,c.key,{score:c.score,value:c.value,comment:c.comment,correction:c.correction,sourceInfo:u,sourceRunId:c.sourceRunId,feedbackConfig:c.feedbackConfig,feedbackSourceType:"model"}))}return[r,o]}async logEvaluationFeedback(e,t,n){const[r]=await this._logEvaluationFeedback(e,t,n);return r}async*listAnnotationQueues(e={}){const{queueIds:t,name:n,nameContains:r,limit:o}=e,c=new URLSearchParams;t&&t.forEach((h,f)=>{assertUuid(h,`queueIds[${f}]`),c.append("ids",h)}),n&&c.append("name",n),r&&c.append("name_contains",r),c.append("limit",(o!==void 0?Math.min(o,100):100).toString());let u=0;for await(const h of this._getPaginated("/annotation-queues",c))if(yield*h,u++,o!==void 0&&u>=o)break}async createAnnotationQueue(e){const{name:t,description:n,queueId:r}=e,o={name:t,description:n,id:r||v4()},c=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(Object.entries(o).filter(([h,f])=>f!==void 0))),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(c,"create annotation queue"),await c.json()}async readAnnotationQueue(e){const t=await this.listAnnotationQueues({queueIds:[e]}).next();if(t.done)throw new Error(`Annotation queue with ID ${e} not found`);return t.value}async updateAnnotationQueue(e,t){const{name:n,description:r}=t,o=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/annotation-queues/${assertUuid(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:n,description:r}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(o,"update annotation queue")}async deleteAnnotationQueue(e){const t=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/annotation-queues/${assertUuid(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(t,"delete annotation queue")}async addRunsToAnnotationQueue(e,t){const n=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/annotation-queues/${assertUuid(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t.map((r,o)=>assertUuid(r,`runIds[${o}]`).toString())),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(n,"add runs to annotation queue")}async getRunFromAnnotationQueue(e,t){const n=`/annotation-queues/${assertUuid(e,"queueId")}/run`,r=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}${n}/${t}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(r,"get run from annotation queue"),await r.json()}async deleteRunFromAnnotationQueue(e,t){const n=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/annotation-queues/${assertUuid(e,"queueId")}/runs/${assertUuid(t,"queueRunId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(n,"delete run from annotation queue")}async getSizeFromAnnotationQueue(e){const t=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/annotation-queues/${assertUuid(e,"queueId")}/size`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(t,"get size from annotation queue"),await t.json()}async _currentTenantIsOwner(e){const t=await this._getSettings();return e=="-"||t.tenant_handle===e}async _ownerConflictError(e,t){const n=await this._getSettings();return new Error(`Cannot ${e} for another tenant.

      Current tenant: ${n.tenant_handle}

      Requested tenant: ${t}`)}async _getLatestCommitHash(e){const t=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),n=await t.json();if(!t.ok){const r=typeof n.detail=="string"?n.detail:JSON.stringify(n.detail),o=new Error(`Error ${t.status}: ${t.statusText}
${r}`);throw o.statusCode=t.status,o}if(n.commits.length!==0)return n.commits[0].commit_hash}async _likeOrUnlikePrompt(e,t){const[n,r,o]=parsePromptIdentifier(e),c=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/likes/${n}/${r}`,{method:"POST",body:JSON.stringify({like:t}),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(c,`${t?"like":"unlike"} prompt`),await c.json()}async _getPromptUrl(e){const[t,n,r]=parsePromptIdentifier(e);if(await this._currentTenantIsOwner(t)){const o=await this._getSettings();return r!=="latest"?`${this.getHostUrl()}/prompts/${n}/${r.substring(0,8)}?organizationId=${o.id}`:`${this.getHostUrl()}/prompts/${n}?organizationId=${o.id}`}else return r!=="latest"?`${this.getHostUrl()}/hub/${t}/${n}/${r.substring(0,8)}`:`${this.getHostUrl()}/hub/${t}/${n}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(const t of this._getPaginated(`/commits/${e}/`,new URLSearchParams,n=>n.commits))yield*t}async*listPrompts(e){const t=new URLSearchParams;t.append("sort_field",(e==null?void 0:e.sortField)??"updated_at"),t.append("sort_direction","desc"),t.append("is_archived",(!!(e!=null&&e.isArchived)).toString()),(e==null?void 0:e.isPublic)!==void 0&&t.append("is_public",e.isPublic.toString()),e!=null&&e.query&&t.append("query",e.query);for await(const n of this._getPaginated("/repos",t,r=>r.repos))yield*n}async getPrompt(e){const[t,n,r]=parsePromptIdentifier(e),o=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/repos/${t}/${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(o.status===404)return null;await raiseForStatus(o,"get prompt");const c=await o.json();return c.repo?c.repo:null}async createPrompt(e,t){const n=await this._getSettings();if(t!=null&&t.isPublic&&!n.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle. 
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);const[r,o,c]=parsePromptIdentifier(e);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("create a prompt",r);const u={repo_handle:o,...(t==null?void 0:t.description)&&{description:t.description},...(t==null?void 0:t.readme)&&{readme:t.readme},...(t==null?void 0:t.tags)&&{tags:t.tags},is_public:!!(t!=null&&t.isPublic)},h=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(h,"create prompt");const{repo:f}=await h.json();return f}async createCommit(e,t,n){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[r,o,c]=parsePromptIdentifier(e),u=(n==null?void 0:n.parentCommitHash)==="latest"||!(n!=null&&n.parentCommitHash)?await this._getLatestCommitHash(`${r}/${o}`):n==null?void 0:n.parentCommitHash,h={manifest:JSON.parse(JSON.stringify(t)),parent_commit:u},f=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/commits/${r}/${o}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(h),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(f,"create commit");const p=await f.json();return this._getPromptUrl(`${r}/${o}${p.commit_hash?`:${p.commit_hash}`:""}`)}async updateExamplesMultipart(e,t=[]){if(!await this._getMultiPartSupport())throw new Error("Your LangSmith version does not allow using the multipart examples endpoint, please update to the latest version.");const n=new FormData;for(const c of t){const u=c.id,h={...c.metadata&&{metadata:c.metadata},...c.split&&{split:c.split}},f=serialize(h),p=new Blob([f],{type:"application/json"});if(n.append(u,p),c.inputs){const g=serialize(c.inputs),y=new Blob([g],{type:"application/json"});n.append(`${u}.inputs`,y)}if(c.outputs){const g=serialize(c.outputs),y=new Blob([g],{type:"application/json"});n.append(`${u}.outputs`,y)}if(c.attachments)for(const[g,y]of Object.entries(c.attachments)){let v,_;Array.isArray(y)?[v,_]=y:(v=y.mimeType,_=y.data);const E=new Blob([_],{type:`${v}; length=${_.byteLength}`});n.append(`${u}.attachment.${g}`,E)}if(c.attachments_operations){const g=serialize(c.attachments_operations),y=new Blob([g],{type:"application/json"});n.append(`${u}.attachments_operations`,y)}}return await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/v1/platform/datasets/${e}/examples`,{method:"PATCH",headers:this.headers,body:n})).json()}async uploadExamplesMultipart(e,t=[]){if(!await this._getMultiPartSupport())throw new Error("Your LangSmith version does not allow using the multipart examples endpoint, please update to the latest version.");const n=new FormData;for(const c of t){const u=(c.id??v4()).toString(),h={created_at:c.created_at,...c.metadata&&{metadata:c.metadata},...c.split&&{split:c.split}},f=serialize(h),p=new Blob([f],{type:"application/json"});n.append(u,p);const g=serialize(c.inputs),y=new Blob([g],{type:"application/json"});if(n.append(`${u}.inputs`,y),c.outputs){const v=serialize(c.outputs),_=new Blob([v],{type:"application/json"});n.append(`${u}.outputs`,_)}if(c.attachments)for(const[v,_]of Object.entries(c.attachments)){let E,x;Array.isArray(_)?[E,x]=_:(E=_.mimeType,x=_.data);const w=new Blob([x],{type:`${E}; length=${x.byteLength}`});n.append(`${u}.attachment.${v}`,w)}}return await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/v1/platform/datasets/${e}/examples`,{method:"POST",headers:this.headers,body:n})).json()}async updatePrompt(e,t){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[n,r]=parsePromptIdentifier(e);if(!await this._currentTenantIsOwner(n))throw await this._ownerConflictError("update a prompt",n);const o={};if((t==null?void 0:t.description)!==void 0&&(o.description=t.description),(t==null?void 0:t.readme)!==void 0&&(o.readme=t.readme),(t==null?void 0:t.tags)!==void 0&&(o.tags=t.tags),(t==null?void 0:t.isPublic)!==void 0&&(o.is_public=t.isPublic),(t==null?void 0:t.isArchived)!==void 0&&(o.is_archived=t.isArchived),Object.keys(o).length===0)throw new Error("No valid update options provided");const c=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/repos/${n}/${r}`,{method:"PATCH",body:JSON.stringify(o),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(c,"update prompt"),c.json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[t,n,r]=parsePromptIdentifier(e);if(!await this._currentTenantIsOwner(t))throw await this._ownerConflictError("delete a prompt",t);return await(await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/repos/${t}/${n}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async pullPromptCommit(e,t){const[n,r,o]=parsePromptIdentifier(e),c=await this.caller.call(_getFetchImplementation(),`${this.apiUrl}/commits/${n}/${r}/${o}${t!=null&&t.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(c,"pull prompt commit");const u=await c.json();return{owner:n,repo:r,commit_hash:u.commit_hash,manifest:u.manifest,examples:u.examples}}async _pullPrompt(e,t){const n=await this.pullPromptCommit(e,{includeModel:t==null?void 0:t.includeModel});return JSON.stringify(n.manifest)}async pushPrompt(e,t){return await this.promptExists(e)?t&&Object.keys(t).some(r=>r!=="object")&&await this.updatePrompt(e,{description:t==null?void 0:t.description,readme:t==null?void 0:t.readme,tags:t==null?void 0:t.tags,isPublic:t==null?void 0:t.isPublic}):await this.createPrompt(e,{description:t==null?void 0:t.description,readme:t==null?void 0:t.readme,tags:t==null?void 0:t.tags,isPublic:t==null?void 0:t.isPublic}),t!=null&&t.object?await this.createCommit(e,t==null?void 0:t.object,{parentCommitHash:t==null?void 0:t.parentCommitHash}):await this._getPromptUrl(e)}async clonePublicDataset(e,t={}){const{sourceApiUrl:n=this.apiUrl,datasetName:r}=t,[o,c]=this.parseTokenOrUrl(e,n),u=new Client({apiUrl:o,apiKey:"placeholder"}),h=await u.readSharedDataset(c),f=r||h.name;try{if(await this.hasDataset({datasetId:f})){console.log(`Dataset ${f} already exists in your tenant. Skipping.`);return}}catch{}const p=await u.listSharedExamples(c),g=await this.createDataset(f,{description:h.description,dataType:h.data_type||"kv",inputsSchema:h.inputs_schema_definition??void 0,outputsSchema:h.outputs_schema_definition??void 0});try{await this.createExamples({inputs:p.map(y=>y.inputs),outputs:p.flatMap(y=>y.outputs?[y.outputs]:[]),datasetId:g.id})}catch(y){throw console.error(`An error occurred while creating dataset ${f}. You should delete it manually.`),y}}parseTokenOrUrl(e,t,n=2,r="dataset"){try{return assertUuid(e),[t,e]}catch{}try{const c=new URL(e).pathname.split("/").filter(u=>u!=="");if(c.length>=n){const u=c[c.length-n];return[t,u]}else throw new Error(`Invalid public ${r} URL: ${e}`)}catch{throw new Error(`Invalid public ${r} URL or token: ${e}`)}}awaitPendingTraceBatches(){return this.manualFlushMode?(console.warn("[WARNING]: When tracing in manual flush mode, you must call `await client.flush()` manually to submit trace batches."),Promise.resolve()):Promise.all([...this.autoBatchQueue.items.map(({itemPromise:e})=>e),this.batchIngestCaller.queue.onIdle()])}}const __version__="0.3.7";var define_process_env_default$2={};let globalEnv;const isBrowser$1=()=>typeof window<"u"&&typeof window.document<"u",isWebWorker$1=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",isJsDom$1=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),isDeno$1=()=>typeof Deno<"u",isNode$1=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!isDeno$1(),getEnv$1=()=>globalEnv||(isBrowser$1()?globalEnv="browser":isNode$1()?globalEnv="node":isWebWorker$1()?globalEnv="webworker":isJsDom$1()?globalEnv="jsdom":isDeno$1()?globalEnv="deno":globalEnv="other",globalEnv);let runtimeEnvironment$1;function getRuntimeEnvironment$1(){if(runtimeEnvironment$1===void 0){const s=getEnv$1(),e=getShas();runtimeEnvironment$1={library:"langsmith",runtime:s,sdk:"langsmith-js",sdk_version:__version__,...e}}return runtimeEnvironment$1}function getLangChainEnvVarsMetadata(){const s=getEnvironmentVariables()||{},e={},t=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION","LANGSMITH_API_KEY","LANGSMITH_ENDPOINT","LANGSMITH_TRACING_V2","LANGSMITH_PROJECT","LANGSMITH_SESSION"];for(const[n,r]of Object.entries(s))(n.startsWith("LANGCHAIN_")||n.startsWith("LANGSMITH_"))&&typeof r=="string"&&!t.includes(n)&&!n.toLowerCase().includes("key")&&!n.toLowerCase().includes("secret")&&!n.toLowerCase().includes("token")&&(n==="LANGCHAIN_REVISION_ID"?e.revision_id=r:e[n]=r);return e}function getEnvironmentVariables(){try{return typeof process<"u"&&define_process_env_default$2?Object.entries(define_process_env_default$2).reduce((s,[e,t])=>(s[e]=String(t),s),{}):void 0}catch{return}}function getEnvironmentVariable$1(s){try{return typeof process<"u"?define_process_env_default$2==null?void 0:define_process_env_default$2[s]:void 0}catch{return}}function getLangSmithEnvironmentVariable(s){return getEnvironmentVariable$1(`LANGSMITH_${s}`)||getEnvironmentVariable$1(`LANGCHAIN_${s}`)}let cachedCommitSHAs;function getShas(){if(cachedCommitSHAs!==void 0)return cachedCommitSHAs;const s=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const t of s){const n=getEnvironmentVariable$1(t);n!==void 0&&(e[t]=n)}return cachedCommitSHAs=e,e}const isTracingEnabled$1=s=>!!["TRACING_V2","TRACING"].find(t=>getLangSmithEnvironmentVariable(t)==="true"),_LC_CONTEXT_VARIABLES_KEY=Symbol.for("lc:context_variables");function stripNonAlphanumeric$1(s){return s.replace(/[-:.]/g,"")}function convertToDottedOrderFormat$1(s,e,t=1){const n=t.toFixed(0).slice(0,3).padStart(3,"0");return stripNonAlphanumeric$1(`${new Date(s).toISOString().slice(0,-1)}${n}Z`)+e}class Baggage{constructor(e,t){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=t}static fromHeader(e){const t=e.split(",");let n={},r=[];for(const o of t){const[c,u]=o.split("="),h=decodeURIComponent(u);c==="langsmith-metadata"?n=JSON.parse(h):c==="langsmith-tags"&&(r=h.split(","))}return new Baggage(n,r)}toHeader(){const e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),e.join(",")}}class RunTree{constructor(e){var u;if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"attachments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),isRunTree(e)){Object.assign(this,{...e});return}const t=RunTree.getDefaultConfig(),{metadata:n,...r}=e,o=r.client??RunTree.getSharedClient(),c={...n,...(u=r==null?void 0:r.extra)==null?void 0:u.metadata};if(r.extra={...r.extra,metadata:c},Object.assign(this,{...t,...r,client:o}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.execution_order??(this.execution_order=1),this.child_execution_order??(this.child_execution_order=1),!this.dotted_order){const h=convertToDottedOrderFormat$1(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+h:this.dotted_order=h}}static getDefaultConfig(){return{id:v4(),run_type:"chain",project_name:getLangSmithEnvironmentVariable("PROJECT")??getEnvironmentVariable$1("LANGCHAIN_SESSION")??"default",child_runs:[],api_url:getEnvironmentVariable$1("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:getEnvironmentVariable$1("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}static getSharedClient(){return RunTree.sharedClient||(RunTree.sharedClient=new Client),RunTree.sharedClient}createChild(e){var h,f,p,g,y,v;const t=this.child_execution_order+1,n=new RunTree({...e,parent_run:this,project_name:this.project_name,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:t,child_execution_order:t});_LC_CONTEXT_VARIABLES_KEY in this&&(n[_LC_CONTEXT_VARIABLES_KEY]=this[_LC_CONTEXT_VARIABLES_KEY]);const r=Symbol.for("lc:child_config"),o=((h=e.extra)==null?void 0:h[r])??this.extra[r];if(isRunnableConfigLike(o)){const _={...o},E=isCallbackManagerLike(_.callbacks)?(p=(f=_.callbacks).copy)==null?void 0:p.call(f):void 0;E&&(Object.assign(E,{_parentRunId:n.id}),(v=(y=(g=E.handlers)==null?void 0:g.find(isLangChainTracerLike))==null?void 0:y.updateFromRunTree)==null||v.call(y,n),_.callbacks=E),n.extra[r]=_}const c=new Set;let u=this;for(;u!=null&&!c.has(u.id);)c.add(u.id),u.child_execution_order=Math.max(u.child_execution_order,t),u=u.parent_run;return this.child_runs.push(n),n}async end(e,t,n=Date.now(),r){this.outputs=this.outputs??e,this.error=this.error??t,this.end_time=this.end_time??n,r&&Object.keys(r).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...r}}:{metadata:r})}_convertToCreate(e,t,n=!0){var h;const r=e.extra??{};if(r.runtime||(r.runtime={}),t)for(const[f,p]of Object.entries(t))r.runtime[f]||(r.runtime[f]=p);let o,c;return n?(c=(h=e.parent_run)==null?void 0:h.id,o=[]):(o=e.child_runs.map(f=>this._convertToCreate(f,t,n)),c=void 0),{id:e.id,name:e.name,start_time:e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:r,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:o,parent_run_id:c,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags,attachments:e.attachments}}async postRun(e=!0){try{const t=getRuntimeEnvironment$1(),n=await this._convertToCreate(this,t,!0);if(await this.client.createRun(n),!e){warnOnce("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const r of this.child_runs)await r.postRun(!1)}}catch(t){console.error(`Error in postRun for run ${this.id}:`,t)}}async patchRun(){var e;try{const t={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:(e=this.parent_run)==null?void 0:e.id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags,attachments:this.attachments};await this.client.updateRun(this.id,t)}catch(t){console.error(`Error in patchRun for run ${this.id}`,t)}}toJSON(){return this._convertToCreate(this,void 0,!1)}static fromRunnableConfig(e,t){var f,p,g,y;const n=e==null?void 0:e.callbacks;let r,o,c,u=isTracingEnabled$1();if(n){const v=((f=n==null?void 0:n.getParentRunId)==null?void 0:f.call(n))??"",_=(p=n==null?void 0:n.handlers)==null?void 0:p.find(E=>(E==null?void 0:E.name)=="langchain_tracer");r=(g=_==null?void 0:_.getRun)==null?void 0:g.call(_,v),o=_==null?void 0:_.projectName,c=_==null?void 0:_.client,u=u||!!_}return r?new RunTree({name:r.name,id:r.id,trace_id:r.trace_id,dotted_order:r.dotted_order,client:c,tracingEnabled:u,project_name:o,tags:[...new Set(((r==null?void 0:r.tags)??[]).concat((e==null?void 0:e.tags)??[]))],extra:{metadata:{...(y=r==null?void 0:r.extra)==null?void 0:y.metadata,...e==null?void 0:e.metadata}}}).createChild(t):new RunTree({...t,client:c,tracingEnabled:u,project_name:o})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,t){var f;const n="get"in e&&typeof e.get=="function"?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,r=n["langsmith-trace"];if(!r||typeof r!="string")return;const o=r.trim(),c=o.split(".").map(p=>{const[g,y]=p.split("Z");return{strTime:g,time:Date.parse(g+"Z"),uuid:y}}),u=c[0].uuid,h={...t,name:(t==null?void 0:t.name)??"parent",run_type:(t==null?void 0:t.run_type)??"chain",start_time:(t==null?void 0:t.start_time)??Date.now(),id:(f=c.at(-1))==null?void 0:f.uuid,trace_id:u,dotted_order:o};if(n.baggage&&typeof n.baggage=="string"){const p=Baggage.fromHeader(n.baggage);h.metadata=p.metadata,h.tags=p.tags}return new RunTree(h)}toHeaders(e){var n;const t={"langsmith-trace":this.dotted_order,baggage:new Baggage((n=this.extra)==null?void 0:n.metadata,this.tags).toHeader()};if(e)for(const[r,o]of Object.entries(t))e.set(r,o);return t}}Object.defineProperty(RunTree,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});function isRunTree(s){return s!==void 0&&typeof s.createChild=="function"&&typeof s.postRun=="function"}function isLangChainTracerLike(s){return typeof s=="object"&&s!=null&&typeof s.name=="string"&&s.name==="langchain_tracer"}function containsLangChainTracerLike(s){return Array.isArray(s)&&s.some(e=>isLangChainTracerLike(e))}function isCallbackManagerLike(s){return typeof s=="object"&&s!=null&&Array.isArray(s.handlers)}function isRunnableConfigLike(s){var e;return s!==void 0&&typeof s.callbacks=="object"&&(containsLangChainTracerLike((e=s.callbacks)==null?void 0:e.handlers)||containsLangChainTracerLike(s.callbacks))}let MockAsyncLocalStorage$1=class{getStore(){}run(e,t){return t()}};const TRACING_ALS_KEY$1=Symbol.for("ls:tracing_async_local_storage"),mockAsyncLocalStorage$1=new MockAsyncLocalStorage$1;let AsyncLocalStorageProvider$1=class{getInstance(){return globalThis[TRACING_ALS_KEY$1]??mockAsyncLocalStorage$1}initializeGlobalInstance(e){globalThis[TRACING_ALS_KEY$1]===void 0&&(globalThis[TRACING_ALS_KEY$1]=e)}};const AsyncLocalStorageProviderSingleton$1=new AsyncLocalStorageProvider$1,getCurrentRunTree=()=>{const s=AsyncLocalStorageProviderSingleton$1.getInstance().getStore();if(!isRunTree(s))throw new Error(["Could not get the current run tree.","","Please make sure you are calling this method within a traceable function and that tracing is enabled."].join(`
`));return s};function isTraceableFunction(s){return typeof s=="function"&&"langsmith:traceable"in s}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */const _hasOwnProperty=Object.prototype.hasOwnProperty;function hasOwnProperty(s,e){return _hasOwnProperty.call(s,e)}function _objectKeys(s){if(Array.isArray(s)){const t=new Array(s.length);for(let n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(s);let e=[];for(let t in s)hasOwnProperty(s,t)&&e.push(t);return e}function _deepClone(s){switch(typeof s){case"object":return JSON.parse(JSON.stringify(s));case"undefined":return null;default:return s}}function isInteger(s){let e=0;const t=s.length;let n;for(;e<t;){if(n=s.charCodeAt(e),n>=48&&n<=57){e++;continue}return!1}return!0}function escapePathComponent(s){return s.indexOf("/")===-1&&s.indexOf("~")===-1?s:s.replace(/~/g,"~0").replace(/\//g,"~1")}function unescapePathComponent(s){return s.replace(/~1/g,"/").replace(/~0/g,"~")}function hasUndefined(s){if(s===void 0)return!0;if(s){if(Array.isArray(s)){for(let t=0,n=s.length;t<n;t++)if(hasUndefined(s[t]))return!0}else if(typeof s=="object"){const t=_objectKeys(s),n=t.length;for(var e=0;e<n;e++)if(hasUndefined(s[t[e]]))return!0}}return!1}function patchErrorMessageFormatter(s,e){const t=[s];for(const n in e){const r=typeof e[n]=="object"?JSON.stringify(e[n],null,2):e[n];typeof r<"u"&&t.push(`${n}: ${r}`)}return t.join(`
`)}class PatchError extends Error{constructor(e,t,n,r,o){super(patchErrorMessageFormatter(e,{name:t,index:n,operation:r,tree:o})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.setPrototypeOf(this,new.target.prototype),this.message=patchErrorMessageFormatter(e,{name:t,index:n,operation:r,tree:o})}}const JsonPatchError=PatchError,objOps={add:function(s,e,t){return s[e]=this.value,{newDocument:t}},remove:function(s,e,t){var n=s[e];return delete s[e],{newDocument:t,removed:n}},replace:function(s,e,t){var n=s[e];return s[e]=this.value,{newDocument:t,removed:n}},move:function(s,e,t){let n=getValueByPointer(t,this.path);n&&(n=_deepClone(n));const r=applyOperation(t,{op:"remove",path:this.from}).removed;return applyOperation(t,{op:"add",path:this.path,value:r}),{newDocument:t,removed:n}},copy:function(s,e,t){const n=getValueByPointer(t,this.from);return applyOperation(t,{op:"add",path:this.path,value:_deepClone(n)}),{newDocument:t}},test:function(s,e,t){return{newDocument:t,test:_areEquals(s[e],this.value)}},_get:function(s,e,t){return this.value=s[e],{newDocument:t}}};var arrOps={add:function(s,e,t){return isInteger(e)?s.splice(e,0,this.value):s[e]=this.value,{newDocument:t,index:e}},remove:function(s,e,t){var n=s.splice(e,1);return{newDocument:t,removed:n[0]}},replace:function(s,e,t){var n=s[e];return s[e]=this.value,{newDocument:t,removed:n}},move:objOps.move,copy:objOps.copy,test:objOps.test,_get:objOps._get};function getValueByPointer(s,e){if(e=="")return s;var t={op:"_get",path:e};return applyOperation(s,t),t.value}function applyOperation(s,e,t=!1,n=!0,r=!0,o=0){if(t&&(typeof t=="function"?t(e,0,s,e.path):validator(e,0)),e.path===""){let c={newDocument:s};if(e.op==="add")return c.newDocument=e.value,c;if(e.op==="replace")return c.newDocument=e.value,c.removed=s,c;if(e.op==="move"||e.op==="copy")return c.newDocument=getValueByPointer(s,e.from),e.op==="move"&&(c.removed=s),c;if(e.op==="test"){if(c.test=_areEquals(s,e.value),c.test===!1)throw new JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",o,e,s);return c.newDocument=s,c}else{if(e.op==="remove")return c.removed=s,c.newDocument=null,c;if(e.op==="_get")return e.value=s,c;if(t)throw new JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,e,s);return c}}else{n||(s=_deepClone(s));const u=(e.path||"").split("/");let h=s,f=1,p=u.length,g,y,v;for(typeof t=="function"?v=t:v=validator;;){if(y=u[f],y&&y.indexOf("~")!=-1&&(y=unescapePathComponent(y)),r&&(y=="__proto__"||y=="prototype"&&f>0&&u[f-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(t&&g===void 0&&(h[y]===void 0?g=u.slice(0,f).join("/"):f==p-1&&(g=e.path),g!==void 0&&v(e,0,s,g)),f++,Array.isArray(h)){if(y==="-")y=h.length;else{if(t&&!isInteger(y))throw new JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,e,s);isInteger(y)&&(y=~~y)}if(f>=p){if(t&&e.op==="add"&&y>h.length)throw new JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,e,s);const _=arrOps[e.op].call(e,h,y,s);if(_.test===!1)throw new JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",o,e,s);return _}}else if(f>=p){const _=objOps[e.op].call(e,h,y,s);if(_.test===!1)throw new JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",o,e,s);return _}if(h=h[y],t&&f<p&&(!h||typeof h!="object"))throw new JsonPatchError("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,e,s)}}}function applyPatch(s,e,t,n=!0,r=!0){if(t&&!Array.isArray(e))throw new JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(s=_deepClone(s));const o=new Array(e.length);for(let c=0,u=e.length;c<u;c++)o[c]=applyOperation(s,e[c],t,!0,r,c),s=o[c].newDocument;return o.newDocument=s,o}function validator(s,e,t,n){if(typeof s!="object"||s===null||Array.isArray(s))throw new JsonPatchError("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,s,t);if(objOps[s.op]){if(typeof s.path!="string")throw new JsonPatchError("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,s,t);if(s.path.indexOf("/")!==0&&s.path.length>0)throw new JsonPatchError('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,s,t);if((s.op==="move"||s.op==="copy")&&typeof s.from!="string")throw new JsonPatchError("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,s,t);if((s.op==="add"||s.op==="replace"||s.op==="test")&&s.value===void 0)throw new JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,s,t);if((s.op==="add"||s.op==="replace"||s.op==="test")&&hasUndefined(s.value))throw new JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,s,t);if(t){if(s.op=="add"){var r=s.path.split("/").length,o=n.split("/").length;if(r!==o+1&&r!==o)throw new JsonPatchError("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,s,t)}else if(s.op==="replace"||s.op==="remove"||s.op==="_get"){if(s.path!==n)throw new JsonPatchError("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,s,t)}else if(s.op==="move"||s.op==="copy"){var c={op:"_get",path:s.from,value:void 0},u=validate([c],t);if(u&&u.name==="OPERATION_PATH_UNRESOLVABLE")throw new JsonPatchError("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,s,t)}}}else throw new JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,s,t)}function validate(s,e,t){try{if(!Array.isArray(s))throw new JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)applyPatch(_deepClone(e),_deepClone(s),t||!0);else{t=t||validator;for(var n=0;n<s.length;n++)t(s[n],n,e,void 0)}}catch(r){if(r instanceof JsonPatchError)return r;throw r}}function _areEquals(s,e){if(s===e)return!0;if(s&&e&&typeof s=="object"&&typeof e=="object"){var t=Array.isArray(s),n=Array.isArray(e),r,o,c;if(t&&n){if(o=s.length,o!=e.length)return!1;for(r=o;r--!==0;)if(!_areEquals(s[r],e[r]))return!1;return!0}if(t!=n)return!1;var u=Object.keys(s);if(o=u.length,o!==Object.keys(e).length)return!1;for(r=o;r--!==0;)if(!e.hasOwnProperty(u[r]))return!1;for(r=o;r--!==0;)if(c=u[r],!_areEquals(s[c],e[c]))return!1;return!0}return s!==s&&e!==e}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2013-2021 Joachim Wester
 * MIT license
 */function _generate(s,e,t,n,r){if(e!==s){typeof e.toJSON=="function"&&(e=e.toJSON());for(var o=_objectKeys(e),c=_objectKeys(s),u=!1,h=c.length-1;h>=0;h--){var f=c[h],p=s[f];if(hasOwnProperty(e,f)&&!(e[f]===void 0&&p!==void 0&&Array.isArray(e)===!1)){var g=e[f];typeof p=="object"&&p!=null&&typeof g=="object"&&g!=null&&Array.isArray(p)===Array.isArray(g)?_generate(p,g,t,n+"/"+escapePathComponent(f),r):p!==g&&(r&&t.push({op:"test",path:n+"/"+escapePathComponent(f),value:_deepClone(p)}),t.push({op:"replace",path:n+"/"+escapePathComponent(f),value:_deepClone(g)}))}else Array.isArray(s)===Array.isArray(e)?(r&&t.push({op:"test",path:n+"/"+escapePathComponent(f),value:_deepClone(p)}),t.push({op:"remove",path:n+"/"+escapePathComponent(f)}),u=!0):(r&&t.push({op:"test",path:n,value:s}),t.push({op:"replace",path:n,value:e}))}if(!(!u&&o.length==c.length))for(var h=0;h<o.length;h++){var f=o[h];!hasOwnProperty(s,f)&&e[f]!==void 0&&t.push({op:"add",path:n+"/"+escapePathComponent(f),value:_deepClone(e[f])})}}}function compare(s,e,t=!1){var n=[];return _generate(s,e,n,"",t),n}var define_process_env_default$1={};const isBrowser=()=>typeof window<"u"&&typeof window.document<"u",isWebWorker=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",isJsDom=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),isDeno=()=>typeof Deno<"u",isNode=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!isDeno(),getEnv=()=>{let s;return isBrowser()?s="browser":isNode()?s="node":isWebWorker()?s="webworker":isJsDom()?s="jsdom":isDeno()?s="deno":s="other",s};let runtimeEnvironment;async function getRuntimeEnvironment(){return runtimeEnvironment===void 0&&(runtimeEnvironment={library:"langchain-js",runtime:getEnv()}),runtimeEnvironment}function getEnvironmentVariable(s){try{return typeof process<"u"?define_process_env_default$1==null?void 0:define_process_env_default$1[s]:isDeno()?Deno==null?void 0:Deno.env.get(s):void 0}catch{return}}class BaseCallbackHandlerMethodsClass{}function callbackHandlerPrefersStreaming(s){return"lc_prefer_streaming"in s&&s.lc_prefer_streaming}class BaseCallbackHandler extends BaseCallbackHandlerMethodsClass{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,get_lc_unique_name(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:getEnvironmentVariable("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return Serializable.prototype.toJSON.call(this)}toJSONNotImplemented(){return Serializable.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class t extends BaseCallbackHandler{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:v4()}),Object.assign(this,e)}}return new t}}const isBaseCallbackHandler=s=>{const e=s;return e!==void 0&&typeof e.copy=="function"&&typeof e.name=="string"&&typeof e.awaitHandlers=="boolean"};function _coerceToDict$1(s,e){return s&&!Array.isArray(s)&&typeof s=="object"?s:{[e]:s}}function stripNonAlphanumeric(s){return s.replace(/[-:.]/g,"")}function convertToDottedOrderFormat(s,e,t){const n=t.toFixed(0).slice(0,3).padStart(3,"0");return stripNonAlphanumeric(`${new Date(s).toISOString().slice(0,-1)}${n}Z`)+e}function isBaseTracer(s){return typeof s._addRunToRunMap=="function"}class BaseTracer extends BaseCallbackHandler{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}stringifyError(e){return e instanceof Error?e.message+(e!=null&&e.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,t){e.child_runs.push(t)}_addRunToRunMap(e){const t=convertToDottedOrderFormat(e.start_time,e.id,e.execution_order),n={...e};if(n.parent_run_id!==void 0){const r=this.runMap.get(n.parent_run_id);r&&(this._addChildRun(r,n),r.child_execution_order=Math.max(r.child_execution_order,n.child_execution_order),n.trace_id=r.trace_id,r.dotted_order!==void 0&&(n.dotted_order=[r.dotted_order,t].join(".")))}else n.trace_id=n.id,n.dotted_order=t;return this.runMap.set(n.id,n),n}async _endTrace(e){var n;const t=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id),await((n=this.onRunUpdate)==null?void 0:n.call(this,e))}_getExecutionOrder(e){const t=e!==void 0&&this.runMap.get(e);return t?t.child_execution_order+1:1}_createRunForLLMStart(e,t,n,r,o,c,u,h){const f=this._getExecutionOrder(r),p=Date.now(),g=u?{...o,metadata:u}:o,y={id:n,name:h??e.id[e.id.length-1],parent_run_id:r,start_time:p,serialized:e,events:[{name:"start",time:new Date(p).toISOString()}],inputs:{prompts:t},execution_order:f,child_runs:[],child_execution_order:f,run_type:"llm",extra:g??{},tags:c||[]};return this._addRunToRunMap(y)}async handleLLMStart(e,t,n,r,o,c,u,h){var p,g;const f=this.runMap.get(n)??this._createRunForLLMStart(e,t,n,r,o,c,u,h);return await((p=this.onRunCreate)==null?void 0:p.call(this,f)),await((g=this.onLLMStart)==null?void 0:g.call(this,f)),f}_createRunForChatModelStart(e,t,n,r,o,c,u,h){const f=this._getExecutionOrder(r),p=Date.now(),g=u?{...o,metadata:u}:o,y={id:n,name:h??e.id[e.id.length-1],parent_run_id:r,start_time:p,serialized:e,events:[{name:"start",time:new Date(p).toISOString()}],inputs:{messages:t},execution_order:f,child_runs:[],child_execution_order:f,run_type:"llm",extra:g??{},tags:c||[]};return this._addRunToRunMap(y)}async handleChatModelStart(e,t,n,r,o,c,u,h){var p,g;const f=this.runMap.get(n)??this._createRunForChatModelStart(e,t,n,r,o,c,u,h);return await((p=this.onRunCreate)==null?void 0:p.call(this,f)),await((g=this.onLLMStart)==null?void 0:g.call(this,f)),f}async handleLLMEnd(e,t,n,r,o){var u;const c=this.runMap.get(t);if(!c||(c==null?void 0:c.run_type)!=="llm")throw new Error("No LLM run to end.");return c.end_time=Date.now(),c.outputs=e,c.events.push({name:"end",time:new Date(c.end_time).toISOString()}),c.extra={...c.extra,...o},await((u=this.onLLMEnd)==null?void 0:u.call(this,c)),await this._endTrace(c),c}async handleLLMError(e,t,n,r,o){var u;const c=this.runMap.get(t);if(!c||(c==null?void 0:c.run_type)!=="llm")throw new Error("No LLM run to end.");return c.end_time=Date.now(),c.error=this.stringifyError(e),c.events.push({name:"error",time:new Date(c.end_time).toISOString()}),c.extra={...c.extra,...o},await((u=this.onLLMError)==null?void 0:u.call(this,c)),await this._endTrace(c),c}_createRunForChainStart(e,t,n,r,o,c,u,h){const f=this._getExecutionOrder(r),p=Date.now(),g={id:n,name:h??e.id[e.id.length-1],parent_run_id:r,start_time:p,serialized:e,events:[{name:"start",time:new Date(p).toISOString()}],inputs:t,execution_order:f,child_execution_order:f,run_type:u??"chain",child_runs:[],extra:c?{metadata:c}:{},tags:o||[]};return this._addRunToRunMap(g)}async handleChainStart(e,t,n,r,o,c,u,h){var p,g;const f=this.runMap.get(n)??this._createRunForChainStart(e,t,n,r,o,c,u,h);return await((p=this.onRunCreate)==null?void 0:p.call(this,f)),await((g=this.onChainStart)==null?void 0:g.call(this,f)),f}async handleChainEnd(e,t,n,r,o){var u;const c=this.runMap.get(t);if(!c)throw new Error("No chain run to end.");return c.end_time=Date.now(),c.outputs=_coerceToDict$1(e,"output"),c.events.push({name:"end",time:new Date(c.end_time).toISOString()}),(o==null?void 0:o.inputs)!==void 0&&(c.inputs=_coerceToDict$1(o.inputs,"input")),await((u=this.onChainEnd)==null?void 0:u.call(this,c)),await this._endTrace(c),c}async handleChainError(e,t,n,r,o){var u;const c=this.runMap.get(t);if(!c)throw new Error("No chain run to end.");return c.end_time=Date.now(),c.error=this.stringifyError(e),c.events.push({name:"error",time:new Date(c.end_time).toISOString()}),(o==null?void 0:o.inputs)!==void 0&&(c.inputs=_coerceToDict$1(o.inputs,"input")),await((u=this.onChainError)==null?void 0:u.call(this,c)),await this._endTrace(c),c}_createRunForToolStart(e,t,n,r,o,c,u){const h=this._getExecutionOrder(r),f=Date.now(),p={id:n,name:u??e.id[e.id.length-1],parent_run_id:r,start_time:f,serialized:e,events:[{name:"start",time:new Date(f).toISOString()}],inputs:{input:t},execution_order:h,child_execution_order:h,run_type:"tool",child_runs:[],extra:c?{metadata:c}:{},tags:o||[]};return this._addRunToRunMap(p)}async handleToolStart(e,t,n,r,o,c,u){var f,p;const h=this.runMap.get(n)??this._createRunForToolStart(e,t,n,r,o,c,u);return await((f=this.onRunCreate)==null?void 0:f.call(this,h)),await((p=this.onToolStart)==null?void 0:p.call(this,h)),h}async handleToolEnd(e,t){var r;const n=this.runMap.get(t);if(!n||(n==null?void 0:n.run_type)!=="tool")throw new Error("No tool run to end");return n.end_time=Date.now(),n.outputs={output:e},n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await((r=this.onToolEnd)==null?void 0:r.call(this,n)),await this._endTrace(n),n}async handleToolError(e,t){var r;const n=this.runMap.get(t);if(!n||(n==null?void 0:n.run_type)!=="tool")throw new Error("No tool run to end");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await((r=this.onToolError)==null?void 0:r.call(this,n)),await this._endTrace(n),n}async handleAgentAction(e,t){var o;const n=this.runMap.get(t);if(!n||(n==null?void 0:n.run_type)!=="chain")return;const r=n;r.actions=r.actions||[],r.actions.push(e),r.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await((o=this.onAgentAction)==null?void 0:o.call(this,n))}async handleAgentEnd(e,t){var r;const n=this.runMap.get(t);!n||(n==null?void 0:n.run_type)!=="chain"||(n.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await((r=this.onAgentEnd)==null?void 0:r.call(this,n)))}_createRunForRetrieverStart(e,t,n,r,o,c,u){const h=this._getExecutionOrder(r),f=Date.now(),p={id:n,name:u??e.id[e.id.length-1],parent_run_id:r,start_time:f,serialized:e,events:[{name:"start",time:new Date(f).toISOString()}],inputs:{query:t},execution_order:h,child_execution_order:h,run_type:"retriever",child_runs:[],extra:c?{metadata:c}:{},tags:o||[]};return this._addRunToRunMap(p)}async handleRetrieverStart(e,t,n,r,o,c,u){var f,p;const h=this.runMap.get(n)??this._createRunForRetrieverStart(e,t,n,r,o,c,u);return await((f=this.onRunCreate)==null?void 0:f.call(this,h)),await((p=this.onRetrieverStart)==null?void 0:p.call(this,h)),h}async handleRetrieverEnd(e,t){var r;const n=this.runMap.get(t);if(!n||(n==null?void 0:n.run_type)!=="retriever")throw new Error("No retriever run to end");return n.end_time=Date.now(),n.outputs={documents:e},n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await((r=this.onRetrieverEnd)==null?void 0:r.call(this,n)),await this._endTrace(n),n}async handleRetrieverError(e,t){var r;const n=this.runMap.get(t);if(!n||(n==null?void 0:n.run_type)!=="retriever")throw new Error("No retriever run to end");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await((r=this.onRetrieverError)==null?void 0:r.call(this,n)),await this._endTrace(n),n}async handleText(e,t){var r;const n=this.runMap.get(t);!n||(n==null?void 0:n.run_type)!=="chain"||(n.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await((r=this.onText)==null?void 0:r.call(this,n)))}async handleLLMNewToken(e,t,n,r,o,c){var h;const u=this.runMap.get(n);if(!u||(u==null?void 0:u.run_type)!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return u.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:t,chunk:c==null?void 0:c.chunk}}),await((h=this.onLLMNewToken)==null?void 0:h.call(this,u,e,{chunk:c==null?void 0:c.chunk})),u}}var ansiStyles={exports:{}};ansiStyles.exports;var hasRequiredAnsiStyles;function requireAnsiStyles(){return hasRequiredAnsiStyles||(hasRequiredAnsiStyles=1,function(s){const t=(o=0)=>c=>`\x1B[${38+o};5;${c}m`,n=(o=0)=>(c,u,h)=>`\x1B[${38+o};2;${c};${u};${h}m`;function r(){const o=new Map,c={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};c.color.gray=c.color.blackBright,c.bgColor.bgGray=c.bgColor.bgBlackBright,c.color.grey=c.color.blackBright,c.bgColor.bgGrey=c.bgColor.bgBlackBright;for(const[u,h]of Object.entries(c)){for(const[f,p]of Object.entries(h))c[f]={open:`\x1B[${p[0]}m`,close:`\x1B[${p[1]}m`},h[f]=c[f],o.set(p[0],p[1]);Object.defineProperty(c,u,{value:h,enumerable:!1})}return Object.defineProperty(c,"codes",{value:o,enumerable:!1}),c.color.close="\x1B[39m",c.bgColor.close="\x1B[49m",c.color.ansi256=t(),c.color.ansi16m=n(),c.bgColor.ansi256=t(10),c.bgColor.ansi16m=n(10),Object.defineProperties(c,{rgbToAnsi256:{value:(u,h,f)=>u===h&&h===f?u<8?16:u>248?231:Math.round((u-8)/247*24)+232:16+36*Math.round(u/255*5)+6*Math.round(h/255*5)+Math.round(f/255*5),enumerable:!1},hexToRgb:{value:u=>{const h=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(u.toString(16));if(!h)return[0,0,0];let{colorString:f}=h.groups;f.length===3&&(f=f.split("").map(g=>g+g).join(""));const p=Number.parseInt(f,16);return[p>>16&255,p>>8&255,p&255]},enumerable:!1},hexToAnsi256:{value:u=>c.rgbToAnsi256(...c.hexToRgb(u)),enumerable:!1}}),c}Object.defineProperty(s,"exports",{enumerable:!0,get:r})}(ansiStyles)),ansiStyles.exports}var ansiStylesExports=requireAnsiStyles();const styles=getDefaultExportFromCjs(ansiStylesExports);function wrap(s,e){return`${s.open}${e}${s.close}`}function tryJsonStringify(s,e){try{return JSON.stringify(s,null,2)}catch{return e}}function formatKVMapItem(s){return typeof s=="string"?s.trim():s==null?s:tryJsonStringify(s,s.toString())}function elapsed(s){if(!s.end_time)return"";const e=s.end_time-s.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:color$1}=styles;class ConsoleCallbackHandler extends BaseTracer{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const t=[];let n=e;for(;n.parent_run_id;){const r=this.runMap.get(n.parent_run_id);if(r)t.push(r),n=r;else break}return t}getBreadcrumbs(e){const n=[...this.getParents(e).reverse(),e].map((r,o,c)=>{const u=`${r.execution_order}:${r.run_type}:${r.name}`;return o===c.length-1?wrap(styles.bold,u):u}).join(" > ");return wrap(color$1.grey,n)}onChainStart(e){const t=this.getBreadcrumbs(e);console.log(`${wrap(color$1.green,"[chain/start]")} [${t}] Entering Chain run with input: ${tryJsonStringify(e.inputs,"[inputs]")}`)}onChainEnd(e){const t=this.getBreadcrumbs(e);console.log(`${wrap(color$1.cyan,"[chain/end]")} [${t}] [${elapsed(e)}] Exiting Chain run with output: ${tryJsonStringify(e.outputs,"[outputs]")}`)}onChainError(e){const t=this.getBreadcrumbs(e);console.log(`${wrap(color$1.red,"[chain/error]")} [${t}] [${elapsed(e)}] Chain run errored with error: ${tryJsonStringify(e.error,"[error]")}`)}onLLMStart(e){const t=this.getBreadcrumbs(e),n="prompts"in e.inputs?{prompts:e.inputs.prompts.map(r=>r.trim())}:e.inputs;console.log(`${wrap(color$1.green,"[llm/start]")} [${t}] Entering LLM run with input: ${tryJsonStringify(n,"[inputs]")}`)}onLLMEnd(e){const t=this.getBreadcrumbs(e);console.log(`${wrap(color$1.cyan,"[llm/end]")} [${t}] [${elapsed(e)}] Exiting LLM run with output: ${tryJsonStringify(e.outputs,"[response]")}`)}onLLMError(e){const t=this.getBreadcrumbs(e);console.log(`${wrap(color$1.red,"[llm/error]")} [${t}] [${elapsed(e)}] LLM run errored with error: ${tryJsonStringify(e.error,"[error]")}`)}onToolStart(e){const t=this.getBreadcrumbs(e);console.log(`${wrap(color$1.green,"[tool/start]")} [${t}] Entering Tool run with input: "${formatKVMapItem(e.inputs.input)}"`)}onToolEnd(e){var n;const t=this.getBreadcrumbs(e);console.log(`${wrap(color$1.cyan,"[tool/end]")} [${t}] [${elapsed(e)}] Exiting Tool run with output: "${formatKVMapItem((n=e.outputs)==null?void 0:n.output)}"`)}onToolError(e){const t=this.getBreadcrumbs(e);console.log(`${wrap(color$1.red,"[tool/error]")} [${t}] [${elapsed(e)}] Tool run errored with error: ${tryJsonStringify(e.error,"[error]")}`)}onRetrieverStart(e){const t=this.getBreadcrumbs(e);console.log(`${wrap(color$1.green,"[retriever/start]")} [${t}] Entering Retriever run with input: ${tryJsonStringify(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const t=this.getBreadcrumbs(e);console.log(`${wrap(color$1.cyan,"[retriever/end]")} [${t}] [${elapsed(e)}] Exiting Retriever run with output: ${tryJsonStringify(e.outputs,"[outputs]")}`)}onRetrieverError(e){const t=this.getBreadcrumbs(e);console.log(`${wrap(color$1.red,"[retriever/error]")} [${t}] [${elapsed(e)}] Retriever run errored with error: ${tryJsonStringify(e.error,"[error]")}`)}onAgentAction(e){const t=e,n=this.getBreadcrumbs(e);console.log(`${wrap(color$1.blue,"[agent/action]")} [${n}] Agent selected action: ${tryJsonStringify(t.actions[t.actions.length-1],"[action]")}`)}}let client;const getDefaultLangChainClientSingleton=()=>{if(client===void 0){const s=getEnvironmentVariable("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"?{blockOnRootRunFinalization:!0}:{};client=new Client(s)}return client};class LangChainTracer extends BaseTracer{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:t,projectName:n,client:r}=e;this.projectName=n??getEnvironmentVariable("LANGCHAIN_PROJECT")??getEnvironmentVariable("LANGCHAIN_SESSION"),this.exampleId=t,this.client=r??getDefaultLangChainClientSingleton();const o=LangChainTracer.getTraceableRunTree();o&&this.updateFromRunTree(o)}async _convertToCreate(e,t=void 0){return{...e,extra:{...e.extra,runtime:await getRuntimeEnvironment()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:t}}async persistRun(e){}async onRunCreate(e){const t=await this._convertToCreate(e,this.exampleId);await this.client.createRun(t)}async onRunUpdate(e){const t={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs,trace_id:e.trace_id,dotted_order:e.dotted_order,parent_run_id:e.parent_run_id,extra:e.extra};await this.client.updateRun(e.id,t)}getRun(e){return this.runMap.get(e)}updateFromRunTree(e){let t=e;const n=new Set;for(;t.parent_run&&!(n.has(t.id)||(n.add(t.id),!t.parent_run));)t=t.parent_run;n.clear();const r=[t];for(;r.length>0;){const o=r.shift();!o||n.has(o.id)||(n.add(o.id),this.runMap.set(o.id,o),o.child_runs&&r.push(...o.child_runs))}this.client=e.client??this.client,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}convertToRunTree(e){const t={},n=[];for(const[r,o]of this.runMap){const c=new RunTree({...o,child_runs:[],parent_run:void 0,client:this.client,project_name:this.projectName,reference_example_id:this.exampleId,tracingEnabled:!0});t[r]=c,n.push([r,o.dotted_order])}n.sort((r,o)=>!r[1]||!o[1]?0:r[1].localeCompare(o[1]));for(const[r]of n){const o=this.runMap.get(r),c=t[r];if(!(!o||!c)&&o.parent_run_id){const u=t[o.parent_run_id];u&&(u.child_runs.push(c),c.parent_run=u)}}return t[e]}static getTraceableRunTree(){try{return getCurrentRunTree()}catch{return}}}const TRACING_ALS_KEY=Symbol.for("ls:tracing_async_local_storage"),_CONTEXT_VARIABLES_KEY=Symbol.for("lc:context_variables"),setGlobalAsyncLocalStorageInstance=s=>{globalThis[TRACING_ALS_KEY]=s},getGlobalAsyncLocalStorageInstance=()=>globalThis[TRACING_ALS_KEY];let queue;function createQueue(){const s="default"in PQueueMod?PQueueMod.default:PQueueMod;return new s({autoStart:!0,concurrency:1})}function getQueue(){return typeof queue>"u"&&(queue=createQueue()),queue}async function consumeCallback(s,e){if(e===!0){const t=getGlobalAsyncLocalStorageInstance();t!==void 0?await t.run(void 0,async()=>s()):await s()}else queue=getQueue(),queue.add(async()=>{const t=getGlobalAsyncLocalStorageInstance();t!==void 0?await t.run(void 0,async()=>s()):await s()})}const isTracingEnabled=s=>!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(t=>getEnvironmentVariable(t)==="true");function getContextVariable(s){var n;const e=getGlobalAsyncLocalStorageInstance();if(e===void 0)return;const t=e.getStore();return(n=t==null?void 0:t[_CONTEXT_VARIABLES_KEY])==null?void 0:n[s]}const LC_CONFIGURE_HOOKS_KEY=Symbol("lc:configure_hooks"),_getConfigureHooks=()=>getContextVariable(LC_CONFIGURE_HOOKS_KEY)||[];class BaseCallbackManager{setHandler(e){return this.setHandlers([e])}}class BaseRunManager{constructor(e,t,n,r,o,c,u,h){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:c}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:u}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:h})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(t=>consumeCallback(async()=>{var n;try{await((n=t.handleText)==null?void 0:n.call(t,e,this.runId,this._parentRunId,this.tags))}catch(r){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleText: ${r}`),t.raiseError)throw r}},t.awaitHandlers)))}async handleCustomEvent(e,t,n,r,o){await Promise.all(this.handlers.map(c=>consumeCallback(async()=>{var u;try{await((u=c.handleCustomEvent)==null?void 0:u.call(c,e,t,this.runId,this.tags,this.metadata))}catch(h){if((c.raiseError?console.error:console.warn)(`Error in handler ${c.constructor.name}, handleCustomEvent: ${h}`),c.raiseError)throw h}},c.awaitHandlers)))}}class CallbackManagerForRetrieverRun extends BaseRunManager{getChild(e){const t=new CallbackManager(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(t=>consumeCallback(async()=>{var n;if(!t.ignoreRetriever)try{await((n=t.handleRetrieverEnd)==null?void 0:n.call(t,e,this.runId,this._parentRunId,this.tags))}catch(r){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetriever`),t.raiseError)throw r}},t.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(t=>consumeCallback(async()=>{var n;if(!t.ignoreRetriever)try{await((n=t.handleRetrieverError)==null?void 0:n.call(t,e,this.runId,this._parentRunId,this.tags))}catch(r){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetrieverError: ${r}`),t.raiseError)throw e}},t.awaitHandlers)))}}class CallbackManagerForLLMRun extends BaseRunManager{async handleLLMNewToken(e,t,n,r,o,c){await Promise.all(this.handlers.map(u=>consumeCallback(async()=>{var h;if(!u.ignoreLLM)try{await((h=u.handleLLMNewToken)==null?void 0:h.call(u,e,t??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,c))}catch(f){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleLLMNewToken: ${f}`),u.raiseError)throw f}},u.awaitHandlers)))}async handleLLMError(e,t,n,r,o){await Promise.all(this.handlers.map(c=>consumeCallback(async()=>{var u;if(!c.ignoreLLM)try{await((u=c.handleLLMError)==null?void 0:u.call(c,e,this.runId,this._parentRunId,this.tags,o))}catch(h){if((c.raiseError?console.error:console.warn)(`Error in handler ${c.constructor.name}, handleLLMError: ${h}`),c.raiseError)throw h}},c.awaitHandlers)))}async handleLLMEnd(e,t,n,r,o){await Promise.all(this.handlers.map(c=>consumeCallback(async()=>{var u;if(!c.ignoreLLM)try{await((u=c.handleLLMEnd)==null?void 0:u.call(c,e,this.runId,this._parentRunId,this.tags,o))}catch(h){if((c.raiseError?console.error:console.warn)(`Error in handler ${c.constructor.name}, handleLLMEnd: ${h}`),c.raiseError)throw h}},c.awaitHandlers)))}}class CallbackManagerForChainRun extends BaseRunManager{getChild(e){const t=new CallbackManager(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e,t,n,r,o){await Promise.all(this.handlers.map(c=>consumeCallback(async()=>{var u;if(!c.ignoreChain)try{await((u=c.handleChainError)==null?void 0:u.call(c,e,this.runId,this._parentRunId,this.tags,o))}catch(h){if((c.raiseError?console.error:console.warn)(`Error in handler ${c.constructor.name}, handleChainError: ${h}`),c.raiseError)throw h}},c.awaitHandlers)))}async handleChainEnd(e,t,n,r,o){await Promise.all(this.handlers.map(c=>consumeCallback(async()=>{var u;if(!c.ignoreChain)try{await((u=c.handleChainEnd)==null?void 0:u.call(c,e,this.runId,this._parentRunId,this.tags,o))}catch(h){if((c.raiseError?console.error:console.warn)(`Error in handler ${c.constructor.name}, handleChainEnd: ${h}`),c.raiseError)throw h}},c.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(t=>consumeCallback(async()=>{var n;if(!t.ignoreAgent)try{await((n=t.handleAgentAction)==null?void 0:n.call(t,e,this.runId,this._parentRunId,this.tags))}catch(r){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentAction: ${r}`),t.raiseError)throw r}},t.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(t=>consumeCallback(async()=>{var n;if(!t.ignoreAgent)try{await((n=t.handleAgentEnd)==null?void 0:n.call(t,e,this.runId,this._parentRunId,this.tags))}catch(r){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentEnd: ${r}`),t.raiseError)throw r}},t.awaitHandlers)))}}class CallbackManagerForToolRun extends BaseRunManager{getChild(e){const t=new CallbackManager(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map(t=>consumeCallback(async()=>{var n;if(!t.ignoreAgent)try{await((n=t.handleToolError)==null?void 0:n.call(t,e,this.runId,this._parentRunId,this.tags))}catch(r){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolError: ${r}`),t.raiseError)throw r}},t.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(t=>consumeCallback(async()=>{var n;if(!t.ignoreAgent)try{await((n=t.handleToolEnd)==null?void 0:n.call(t,e,this.runId,this._parentRunId,this.tags))}catch(r){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolEnd: ${r}`),t.raiseError)throw r}},t.awaitHandlers)))}}class CallbackManager extends BaseCallbackManager{constructor(e,t){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=(t==null?void 0:t.handlers)??this.handlers,this.inheritableHandlers=(t==null?void 0:t.inheritableHandlers)??this.inheritableHandlers,this.tags=(t==null?void 0:t.tags)??this.tags,this.inheritableTags=(t==null?void 0:t.inheritableTags)??this.inheritableTags,this.metadata=(t==null?void 0:t.metadata)??this.metadata,this.inheritableMetadata=(t==null?void 0:t.inheritableMetadata)??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,t,n=void 0,r=void 0,o=void 0,c=void 0,u=void 0,h=void 0){return Promise.all(t.map(async(f,p)=>{const g=p===0&&n?n:v4();return await Promise.all(this.handlers.map(y=>{if(!y.ignoreLLM)return isBaseTracer(y)&&y._createRunForLLMStart(e,[f],g,this._parentRunId,o,this.tags,this.metadata,h),consumeCallback(async()=>{var v;try{await((v=y.handleLLMStart)==null?void 0:v.call(y,e,[f],g,this._parentRunId,o,this.tags,this.metadata,h))}catch(_){if((y.raiseError?console.error:console.warn)(`Error in handler ${y.constructor.name}, handleLLMStart: ${_}`),y.raiseError)throw _}},y.awaitHandlers)})),new CallbackManagerForLLMRun(g,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,t,n=void 0,r=void 0,o=void 0,c=void 0,u=void 0,h=void 0){return Promise.all(t.map(async(f,p)=>{const g=p===0&&n?n:v4();return await Promise.all(this.handlers.map(y=>{if(!y.ignoreLLM)return isBaseTracer(y)&&y._createRunForChatModelStart(e,[f],g,this._parentRunId,o,this.tags,this.metadata,h),consumeCallback(async()=>{var v,_;try{if(y.handleChatModelStart)await((v=y.handleChatModelStart)==null?void 0:v.call(y,e,[f],g,this._parentRunId,o,this.tags,this.metadata,h));else if(y.handleLLMStart){const E=getBufferString(f);await((_=y.handleLLMStart)==null?void 0:_.call(y,e,[E],g,this._parentRunId,o,this.tags,this.metadata,h))}}catch(E){if((y.raiseError?console.error:console.warn)(`Error in handler ${y.constructor.name}, handleLLMStart: ${E}`),y.raiseError)throw E}},y.awaitHandlers)})),new CallbackManagerForLLMRun(g,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,t,n=v4(),r=void 0,o=void 0,c=void 0,u=void 0){return await Promise.all(this.handlers.map(h=>{if(!h.ignoreChain)return isBaseTracer(h)&&h._createRunForChainStart(e,t,n,this._parentRunId,this.tags,this.metadata,r,u),consumeCallback(async()=>{var f;try{await((f=h.handleChainStart)==null?void 0:f.call(h,e,t,n,this._parentRunId,this.tags,this.metadata,r,u))}catch(p){if((h.raiseError?console.error:console.warn)(`Error in handler ${h.constructor.name}, handleChainStart: ${p}`),h.raiseError)throw p}},h.awaitHandlers)})),new CallbackManagerForChainRun(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,t,n=v4(),r=void 0,o=void 0,c=void 0,u=void 0){return await Promise.all(this.handlers.map(h=>{if(!h.ignoreAgent)return isBaseTracer(h)&&h._createRunForToolStart(e,t,n,this._parentRunId,this.tags,this.metadata,u),consumeCallback(async()=>{var f;try{await((f=h.handleToolStart)==null?void 0:f.call(h,e,t,n,this._parentRunId,this.tags,this.metadata,u))}catch(p){if((h.raiseError?console.error:console.warn)(`Error in handler ${h.constructor.name}, handleToolStart: ${p}`),h.raiseError)throw p}},h.awaitHandlers)})),new CallbackManagerForToolRun(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,t,n=v4(),r=void 0,o=void 0,c=void 0,u=void 0){return await Promise.all(this.handlers.map(h=>{if(!h.ignoreRetriever)return isBaseTracer(h)&&h._createRunForRetrieverStart(e,t,n,this._parentRunId,this.tags,this.metadata,u),consumeCallback(async()=>{var f;try{await((f=h.handleRetrieverStart)==null?void 0:f.call(h,e,t,n,this._parentRunId,this.tags,this.metadata,u))}catch(p){if((h.raiseError?console.error:console.warn)(`Error in handler ${h.constructor.name}, handleRetrieverStart: ${p}`),h.raiseError)throw p}},h.awaitHandlers)})),new CallbackManagerForRetrieverRun(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(e,t,n,r,o){await Promise.all(this.handlers.map(c=>consumeCallback(async()=>{var u;if(!c.ignoreCustomEvent)try{await((u=c.handleCustomEvent)==null?void 0:u.call(c,e,t,n,this.tags,this.metadata))}catch(h){if((c.raiseError?console.error:console.warn)(`Error in handler ${c.constructor.name}, handleCustomEvent: ${h}`),c.raiseError)throw h}},c.awaitHandlers)))}addHandler(e,t=!0){this.handlers.push(e),t&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e),this.inheritableHandlers=this.inheritableHandlers.filter(t=>t!==e)}setHandlers(e,t=!0){this.handlers=[],this.inheritableHandlers=[];for(const n of e)this.addHandler(n,t)}addTags(e,t=!0){this.removeTags(e),this.tags.push(...e),t&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(t=>!e.includes(t)),this.inheritableTags=this.inheritableTags.filter(t=>!e.includes(t))}addMetadata(e,t=!0){this.metadata={...this.metadata,...e},t&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const t of Object.keys(e))delete this.metadata[t],delete this.inheritableMetadata[t]}copy(e=[],t=!0){const n=new CallbackManager(this._parentRunId);for(const r of this.handlers){const o=this.inheritableHandlers.includes(r);n.addHandler(r,o)}for(const r of this.tags){const o=this.inheritableTags.includes(r);n.addTags([r],o)}for(const r of Object.keys(this.metadata)){const o=Object.keys(this.inheritableMetadata).includes(r);n.addMetadata({[r]:this.metadata[r]},o)}for(const r of e)n.handlers.filter(o=>o.name==="console_callback_handler").some(o=>o.name===r.name)||n.addHandler(r,t);return n}static fromHandlers(e){class t extends BaseCallbackHandler{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:v4()}),Object.assign(this,e)}}const n=new this;return n.addHandler(new t),n}static configure(e,t,n,r,o,c,u){return this._configureSync(e,t,n,r,o,c,u)}static _configureSync(e,t,n,r,o,c,u){var y,v;let h;(e||t)&&(Array.isArray(e)||!e?(h=new CallbackManager,h.setHandlers((e==null?void 0:e.map(ensureHandler))??[],!0)):h=e,h=h.copy(Array.isArray(t)?t.map(ensureHandler):t==null?void 0:t.handlers,!1));const f=getEnvironmentVariable("LANGCHAIN_VERBOSE")==="true"||(u==null?void 0:u.verbose),p=((y=LangChainTracer.getTraceableRunTree())==null?void 0:y.tracingEnabled)||isTracingEnabled(),g=p||(getEnvironmentVariable("LANGCHAIN_TRACING")??!1);if(f||g){if(h||(h=new CallbackManager),f&&!h.handlers.some(_=>_.name===ConsoleCallbackHandler.prototype.name)){const _=new ConsoleCallbackHandler;h.addHandler(_,!0)}if(g&&!h.handlers.some(_=>_.name==="langchain_tracer")&&p){const _=new LangChainTracer;h.addHandler(_,!0),h._parentRunId=((v=LangChainTracer.getTraceableRunTree())==null?void 0:v.id)??h._parentRunId}}for(const{contextVar:_,inheritable:E=!0,handlerClass:x,envVar:w}of _getConfigureHooks()){const T=w&&getEnvironmentVariable(w)==="true"&&x;let O;const N=_!==void 0?getContextVariable(_):void 0;N&&isBaseCallbackHandler(N)?O=N:T&&(O=new x({})),O!==void 0&&(h||(h=new CallbackManager),h.handlers.some(A=>A.name===O.name)||h.addHandler(O,E))}return(n||r)&&h&&(h.addTags(n??[]),h.addTags(r??[],!1)),(o||c)&&h&&(h.addMetadata(o??{}),h.addMetadata(c??{},!1)),h}}function ensureHandler(s){return"name"in s?s:BaseCallbackHandler.fromMethods(s)}class MockAsyncLocalStorage{getStore(){}run(e,t){return t()}enterWith(e){}}const mockAsyncLocalStorage=new MockAsyncLocalStorage,LC_CHILD_KEY=Symbol.for("lc:child_config");class AsyncLocalStorageProvider{getInstance(){return getGlobalAsyncLocalStorageInstance()??mockAsyncLocalStorage}getRunnableConfig(){var t,n;return(n=(t=this.getInstance().getStore())==null?void 0:t.extra)==null?void 0:n[LC_CHILD_KEY]}runWithConfig(e,t,n){var p;const r=CallbackManager._configureSync(e==null?void 0:e.callbacks,void 0,e==null?void 0:e.tags,void 0,e==null?void 0:e.metadata),o=this.getInstance(),c=o.getStore(),u=r==null?void 0:r.getParentRunId(),h=(p=r==null?void 0:r.handlers)==null?void 0:p.find(g=>(g==null?void 0:g.name)==="langchain_tracer");let f;return h&&u?f=h.convertToRunTree(u):n||(f=new RunTree({name:"<runnable_lambda>",tracingEnabled:!1})),f&&(f.extra={...f.extra,[LC_CHILD_KEY]:e}),c!==void 0&&c[_CONTEXT_VARIABLES_KEY]!==void 0&&(f[_CONTEXT_VARIABLES_KEY]=c[_CONTEXT_VARIABLES_KEY]),o.run(f,t)}initializeGlobalInstance(e){getGlobalAsyncLocalStorageInstance()===void 0&&setGlobalAsyncLocalStorageInstance(e)}}const AsyncLocalStorageProviderSingleton=new AsyncLocalStorageProvider,DEFAULT_RECURSION_LIMIT=25;async function getCallbackManagerForConfig(s){return CallbackManager._configureSync(s==null?void 0:s.callbacks,void 0,s==null?void 0:s.tags,void 0,s==null?void 0:s.metadata)}function mergeConfigs(...s){const e={};for(const t of s.filter(n=>!!n))for(const n of Object.keys(t))if(n==="metadata")e[n]={...e[n],...t[n]};else if(n==="tags"){const r=e[n]??[];e[n]=[...new Set(r.concat(t[n]??[]))]}else if(n==="configurable")e[n]={...e[n],...t[n]};else if(n==="timeout")e.timeout===void 0?e.timeout=t.timeout:t.timeout!==void 0&&(e.timeout=Math.min(e.timeout,t.timeout));else if(n==="signal")e.signal===void 0?e.signal=t.signal:t.signal!==void 0&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,t.signal]):e.signal=t.signal);else if(n==="callbacks"){const r=e.callbacks,o=t.callbacks;if(Array.isArray(o))if(!r)e.callbacks=o;else if(Array.isArray(r))e.callbacks=r.concat(o);else{const c=r.copy();for(const u of o)c.addHandler(ensureHandler(u),!0);e.callbacks=c}else if(o)if(!r)e.callbacks=o;else if(Array.isArray(r)){const c=o.copy();for(const u of r)c.addHandler(ensureHandler(u),!0);e.callbacks=c}else e.callbacks=new CallbackManager(o._parentRunId,{handlers:r.handlers.concat(o.handlers),inheritableHandlers:r.inheritableHandlers.concat(o.inheritableHandlers),tags:Array.from(new Set(r.tags.concat(o.tags))),inheritableTags:Array.from(new Set(r.inheritableTags.concat(o.inheritableTags))),metadata:{...r.metadata,...o.metadata}})}else{const r=n;e[r]=t[r]??e[r]}return e}const PRIMITIVES=new Set(["string","number","boolean"]);function ensureConfig(s){var n;const e=AsyncLocalStorageProviderSingleton.getRunnableConfig();let t={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(e){const{runId:r,runName:o,...c}=e;t=Object.entries(c).reduce((u,[h,f])=>(f!==void 0&&(u[h]=f),u),t)}if(s&&(t=Object.entries(s).reduce((r,[o,c])=>(c!==void 0&&(r[o]=c),r),t)),t!=null&&t.configurable)for(const r of Object.keys(t.configurable))PRIMITIVES.has(typeof t.configurable[r])&&!((n=t.metadata)!=null&&n[r])&&(t.metadata||(t.metadata={}),t.metadata[r]=t.configurable[r]);if(t.timeout!==void 0){if(t.timeout<=0)throw new Error("Timeout must be a positive number");const r=AbortSignal.timeout(t.timeout);t.signal!==void 0?"any"in AbortSignal&&(t.signal=AbortSignal.any([t.signal,r])):t.signal=r,delete t.timeout}return t}function patchConfig(s={},{callbacks:e,maxConcurrency:t,recursionLimit:n,runName:r,configurable:o,runId:c}={}){const u=ensureConfig(s);return e!==void 0&&(delete u.runName,u.callbacks=e),n!==void 0&&(u.recursionLimit=n),t!==void 0&&(u.maxConcurrency=t),r!==void 0&&(u.runName=r),o!==void 0&&(u.configurable={...u.configurable,...o}),c!==void 0&&delete u.runId,u}function pickRunnableConfigKeys(s){return s?{configurable:s.configurable,recursionLimit:s.recursionLimit,callbacks:s.callbacks,tags:s.tags,metadata:s.metadata,maxConcurrency:s.maxConcurrency,timeout:s.timeout,signal:s.signal}:void 0}async function raceWithSignal(s,e){if(e===void 0)return s;let t;return Promise.race([s.catch(n=>{if(!(e!=null&&e.aborted))throw n}),new Promise((n,r)=>{t=()=>{r(new Error("Aborted"))},e.addEventListener("abort",t),e.aborted&&r(new Error("Aborted"))})]).finally(()=>e.removeEventListener("abort",t))}class IterableReadableStream extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){const t=this.reader.cancel();this.reader.releaseLock(),await t}throw e}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(e){const t=e.getReader();return new IterableReadableStream({start(n){return r();function r(){return t.read().then(({done:o,value:c})=>{if(o){n.close();return}return n.enqueue(c),r()})}},cancel(){t.releaseLock()}})}static fromAsyncGenerator(e){return new IterableReadableStream({async pull(t){const{value:n,done:r}=await e.next();r&&t.close(),t.enqueue(n)},async cancel(t){await e.return(t)}})}}function atee(s,e=2){const t=Array.from({length:e},()=>[]);return t.map(async function*(r){for(;;)if(r.length===0){const o=await s.next();for(const c of t)c.push(o)}else{if(r[0].done)return;yield r.shift().value}})}function concat(s,e){if(Array.isArray(s)&&Array.isArray(e))return s.concat(e);if(typeof s=="string"&&typeof e=="string")return s+e;if(typeof s=="number"&&typeof e=="number")return s+e;if("concat"in s&&typeof s.concat=="function")return s.concat(e);if(typeof s=="object"&&typeof e=="object"){const t={...s};for(const[n,r]of Object.entries(e))n in t&&!Array.isArray(t[n])?t[n]=concat(t[n],r):t[n]=r;return t}else throw new Error(`Cannot concat ${typeof s} and ${typeof e}`)}class AsyncGeneratorWithSetup{constructor(e){var t;Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??((t=this.config)==null?void 0:t.signal),this.setup=new Promise((n,r)=>{AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(e.config),async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(n,r):this.firstResult.then(o=>n(void 0),r)},!0)})}async next(...e){var t;return(t=this.signal)==null||t.throwIfAborted(),this.firstResultUsed?AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(this.config),this.signal?async()=>raceWithSignal(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}}async function pipeGeneratorWithSetup(s,e,t,n,...r){const o=new AsyncGeneratorWithSetup({generator:e,startSetup:t,signal:n}),c=await o.setup;return{output:s(o,c,...r),setup:c}}class RunLogPatch{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){const t=this.ops.concat(e.ops),n=applyPatch({},t);return new RunLog({ops:t,state:n[n.length-1].newDocument})}}class RunLog extends RunLogPatch{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){const t=this.ops.concat(e.ops),n=applyPatch(this.state,e.ops);return new RunLog({ops:t,state:n[n.length-1].newDocument})}static fromRunLogPatch(e){const t=applyPatch({},e.ops);return new RunLog({ops:e.ops,state:t[t.length-1].newDocument})}}const isLogStreamHandler=s=>s.name==="log_stream_tracer";async function _getStandardizedInputs(s,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:t}=s;if(["retriever","llm","prompt"].includes(s.run_type))return t;if(!(Object.keys(t).length===1&&(t==null?void 0:t.input)===""))return t.input}async function _getStandardizedOutputs(s,e){const{outputs:t}=s;return e==="original"||["retriever","llm","prompt"].includes(s.run_type)?t:t!==void 0&&Object.keys(t).length===1&&(t==null?void 0:t.output)!==void 0?t.output:t}function isChatGenerationChunk(s){return s!==void 0&&s.message!==void 0}class LogStreamCallbackHandler extends BaseTracer{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this._schemaFormat=(e==null?void 0:e._schemaFormat)??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=IterableReadableStream.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const t=e.tags??[];let n=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(n=n||t.find(r=>{var o;return(o=this.includeTags)==null?void 0:o.includes(r)})!==void 0),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(n=n&&t.every(r=>{var o;return!((o=this.excludeTags)!=null&&o.includes(r))})),n}async*tapOutputIterable(e,t){for await(const n of t){if(e!==this.rootId){const r=this.keyMapByRunId[e];r&&await this.writer.write(new RunLogPatch({ops:[{op:"add",path:`/logs/${r}/streamed_output/-`,value:n}]}))}yield n}}async onRunCreate(e){var r;if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new RunLogPatch({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const t=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=t===1?e.name:`${e.name}:${t}`;const n={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:((r=e.extra)==null?void 0:r.metadata)??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(n.inputs=await _getStandardizedInputs(e,this._schemaFormat)),await this.writer.write(new RunLogPatch({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:n}]}))}async onRunUpdate(e){try{const t=this.keyMapByRunId[e.id];if(t===void 0)return;const n=[];this._schemaFormat==="streaming_events"&&n.push({op:"replace",path:`/logs/${t}/inputs`,value:await _getStandardizedInputs(e,this._schemaFormat)}),n.push({op:"add",path:`/logs/${t}/final_output`,value:await _getStandardizedOutputs(e,this._schemaFormat)}),e.end_time!==void 0&&n.push({op:"add",path:`/logs/${t}/end_time`,value:new Date(e.end_time).toISOString()});const r=new RunLogPatch({ops:n});await this.writer.write(r)}finally{if(e.id===this.rootId){const t=new RunLogPatch({ops:[{op:"replace",path:"/final_output",value:await _getStandardizedOutputs(e,this._schemaFormat)}]});await this.writer.write(t),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,t,n){const r=this.keyMapByRunId[e.id];if(r===void 0)return;const o=e.inputs.messages!==void 0;let c;o?isChatGenerationChunk(n==null?void 0:n.chunk)?c=n==null?void 0:n.chunk:c=new AIMessageChunk({id:`run-${e.id}`,content:t}):c=t;const u=new RunLogPatch({ops:[{op:"add",path:`/logs/${r}/streamed_output_str/-`,value:t},{op:"add",path:`/logs/${r}/streamed_output/-`,value:c}]});await this.writer.write(u)}}const RUN_KEY="__run";class GenerationChunk{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new GenerationChunk({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class ChatGenerationChunk extends GenerationChunk{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new ChatGenerationChunk({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}function assignName({name:s,serialized:e}){return s!==void 0?s:(e==null?void 0:e.name)!==void 0?e.name:(e==null?void 0:e.id)!==void 0&&Array.isArray(e==null?void 0:e.id)?e.id[e.id.length-1]:"Unnamed"}const isStreamEventsHandler=s=>s.name==="event_stream_tracer";class EventStreamCallbackHandler extends BaseTracer{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=IterableReadableStream.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const t=e.tags??[];let n=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(n=n||t.find(r=>{var o;return(o=this.includeTags)==null?void 0:o.includes(r)})!==void 0),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(n=n&&t.every(r=>{var o;return!((o=this.excludeTags)!=null&&o.includes(r))})),n}async*tapOutputIterable(e,t){const n=await t.next();if(n.done)return;const r=this.runInfoMap.get(e);if(r===void 0){yield n.value;return}function o(u,h){return u==="llm"&&typeof h=="string"?new GenerationChunk({text:h}):h}let c=this.tappedPromises.get(e);if(c===void 0){let u;c=new Promise(h=>{u=h}),this.tappedPromises.set(e,c);try{const h={event:`on_${r.runType}_stream`,run_id:e,name:r.name,tags:r.tags,metadata:r.metadata,data:{}};await this.send({...h,data:{chunk:o(r.runType,n.value)}},r),yield n.value;for await(const f of t)r.runType!=="tool"&&r.runType!=="retriever"&&await this.send({...h,data:{chunk:o(r.runType,f)}},r),yield f}finally{u()}}else{yield n.value;for await(const u of t)yield u}}async send(e,t){this._includeRun(t)&&await this.writer.write(e)}async sendEndEvent(e,t){const n=this.tappedPromises.get(e.run_id);n!==void 0?n.then(()=>{this.send(e,t)}):await this.send(e,t)}async onLLMStart(e){var c,u;const t=assignName(e),n=e.inputs.messages!==void 0?"chat_model":"llm",r={tags:e.tags??[],metadata:((c=e.extra)==null?void 0:c.metadata)??{},name:t,runType:n,inputs:e.inputs};this.runInfoMap.set(e.id,r);const o=`on_${n}_start`;await this.send({event:o,data:{input:e.inputs},name:t,tags:e.tags??[],run_id:e.id,metadata:((u=e.extra)==null?void 0:u.metadata)??{}},r)}async onLLMNewToken(e,t,n){const r=this.runInfoMap.get(e.id);let o,c;if(r===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(this.runInfoMap.size!==1){if(r.runType==="chat_model")c="on_chat_model_stream",(n==null?void 0:n.chunk)===void 0?o=new AIMessageChunk({content:t,id:`run-${e.id}`}):o=n.chunk.message;else if(r.runType==="llm")c="on_llm_stream",(n==null?void 0:n.chunk)===void 0?o=new GenerationChunk({text:t}):o=n.chunk;else throw new Error(`Unexpected run type ${r.runType}`);await this.send({event:c,data:{chunk:o},run_id:e.id,name:r.name,tags:r.tags,metadata:r.metadata},r)}}async onLLMEnd(e){var c,u,h;const t=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let n;if(t===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const r=(c=e.outputs)==null?void 0:c.generations;let o;if(t.runType==="chat_model"){for(const f of r??[]){if(o!==void 0)break;o=(u=f[0])==null?void 0:u.message}n="on_chat_model_end"}else if(t.runType==="llm")o={generations:r==null?void 0:r.map(f=>f.map(p=>({text:p.text,generationInfo:p.generationInfo}))),llmOutput:((h=e.outputs)==null?void 0:h.llmOutput)??{}},n="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${t.runType}`);await this.sendEndEvent({event:n,data:{output:o,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onChainStart(e){var c,u;const t=assignName(e),n=e.run_type??"chain",r={tags:e.tags??[],metadata:((c=e.extra)==null?void 0:c.metadata)??{},name:t,runType:e.run_type};let o={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(o={},r.inputs={}):e.inputs.input!==void 0?(o.input=e.inputs.input,r.inputs=e.inputs.input):(o.input=e.inputs,r.inputs=e.inputs),this.runInfoMap.set(e.id,r),await this.send({event:`on_${n}_start`,data:o,name:t,tags:e.tags??[],run_id:e.id,metadata:((u=e.extra)==null?void 0:u.metadata)??{}},r)}async onChainEnd(e){var u;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const n=`on_${e.run_type}_end`,r=e.inputs??t.inputs??{},c={output:((u=e.outputs)==null?void 0:u.output)??e.outputs,input:r};r.input&&Object.keys(r).length===1&&(c.input=r.input,t.inputs=r.input),await this.sendEndEvent({event:n,data:c,run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata??{}},t)}async onToolStart(e){var r,o;const t=assignName(e),n={tags:e.tags??[],metadata:((r=e.extra)==null?void 0:r.metadata)??{},name:t,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,n),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:t,run_id:e.id,tags:e.tags??[],metadata:((o=e.extra)==null?void 0:o.metadata)??{}},n)}async onToolEnd(e){var r;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(t.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const n=((r=e.outputs)==null?void 0:r.output)===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:n,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onRetrieverStart(e){var o,c;const t=assignName(e),r={tags:e.tags??[],metadata:((o=e.extra)==null?void 0:o.metadata)??{},name:t,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,r),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:t,tags:e.tags??[],run_id:e.id,metadata:((c=e.extra)==null?void 0:c.metadata)??{}},r)}async onRetrieverEnd(e){var n;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:((n=e.outputs)==null?void 0:n.documents)??e.outputs,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async handleCustomEvent(e,t,n){const r=this.runInfoMap.get(n);if(r===void 0)throw new Error(`handleCustomEvent: Run ID ${n} not found in run map.`);await this.send({event:"on_custom_event",run_id:n,name:e,tags:r.tags,metadata:r.metadata,data:t},r)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}}const STATUS_NO_RETRY=[400,401,402,403,404,405,406,407,409],defaultFailedAttemptHandler=s=>{var t,n;if(s.message.startsWith("Cancel")||s.message.startsWith("AbortError")||s.name==="AbortError"||(s==null?void 0:s.code)==="ECONNABORTED")throw s;const e=((t=s==null?void 0:s.response)==null?void 0:t.status)??(s==null?void 0:s.status);if(e&&STATUS_NO_RETRY.includes(+e))throw s;if(((n=s==null?void 0:s.error)==null?void 0:n.code)==="insufficient_quota"){const r=new Error(s==null?void 0:s.message);throw r.name="InsufficientQuotaError",r}};class AsyncCaller{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??defaultFailedAttemptHandler;const t="default"in PQueueMod?PQueueMod.default:PQueueMod;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add(()=>pRetry(()=>e(...t).catch(n=>{throw n instanceof Error?n:new Error(n)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...n){return e.signal?Promise.race([this.call(t,...n),new Promise((r,o)=>{var c;(c=e.signal)==null||c.addEventListener("abort",()=>{o(new Error("AbortError"))})})]):this.call(t,...n)}fetch(...e){return this.call(()=>fetch(...e).then(t=>t.ok?t:Promise.reject(t)))}}class RootListenersTracer extends BaseTracer{constructor({config:e,onStart:t,onEnd:n,onError:r}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=t,this.argOnEnd=n,this.argOnError=r}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}}function isRunnableInterface(s){return s?s.lc_runnable:!1}class _RootEventFilter{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,t){let n=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const r=e.tags??[];return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(t)),this.includeTags!==void 0&&(n=n||r.some(o=>{var c;return(c=this.includeTags)==null?void 0:c.includes(o)})),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(t)),this.excludeTags!==void 0&&(n=n&&r.every(o=>{var c;return!((c=this.excludeTags)!=null&&c.includes(o))})),n}}function _escapeNodeLabel(s){return s.replace(/[^a-zA-Z-_0-9]/g,"_")}const MARKDOWN_SPECIAL_CHARS=["*","_","`"];function _generateMermaidGraphStyles(s){let e="";for(const[t,n]of Object.entries(s))e+=`	classDef ${t} ${n};
`;return e}function drawMermaid(s,e,t){const{firstNode:n,lastNode:r,nodeColors:o,withStyles:c=!0,curveStyle:u="linear",wrapLabelNWords:h=9}=t??{};let f=c?`%%{init: {'flowchart': {'curve': '${u}'}}}%%
graph TD;
`:`graph TD;
`;if(c){const v="default",_={[v]:"{0}({1})"};n!==void 0&&(_[n]="{0}([{1}]):::first"),r!==void 0&&(_[r]="{0}([{1}]):::last");for(const[E,x]of Object.entries(s)){const w=x.name.split(":").pop()??"";let O=MARKDOWN_SPECIAL_CHARS.some(A=>w.startsWith(A)&&w.endsWith(A))?`<p>${w}</p>`:w;Object.keys(x.metadata??{}).length&&(O+=`<hr/><small><em>${Object.entries(x.metadata??{}).map(([A,I])=>`${A} = ${I}`).join(`
`)}</em></small>`);const N=(_[E]??_[v]).replace("{0}",_escapeNodeLabel(E)).replace("{1}",O);f+=`	${N}
`}}const p={};for(const v of e){const _=v.source.split(":"),E=v.target.split(":"),x=_.filter((w,T)=>w===E[T]).join(":");p[x]||(p[x]=[]),p[x].push(v)}const g=new Set;function y(v,_){const E=v.length===1&&v[0].source===v[0].target;if(_&&!E){const x=_.split(":").pop();if(g.has(x))throw new Error(`Found duplicate subgraph '${x}' -- this likely means that you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.`);g.add(x),f+=`	subgraph ${x}
`}for(const x of v){const{source:w,target:T,data:O,conditional:N}=x;let A="";if(O!==void 0){let I=O;const k=I.split(" ");k.length>h&&(I=Array.from({length:Math.ceil(k.length/h)},(M,L)=>k.slice(L*h,(L+1)*h).join(" ")).join("&nbsp;<br>&nbsp;")),A=N?` -. &nbsp;${I}&nbsp; .-> `:` -- &nbsp;${I}&nbsp; --> `}else A=N?" -.-> ":" --> ";f+=`	${_escapeNodeLabel(w)}${A}${_escapeNodeLabel(T)};
`}for(const x in p)x.startsWith(`${_}:`)&&x!==_&&y(p[x],x);_&&!E&&(f+=`	end
`)}y(p[""]??[],"");for(const v in p)!v.includes(":")&&v!==""&&y(p[v],v);return c&&(f+=_generateMermaidGraphStyles(o??{})),f}async function drawMermaidPng(s,e){let{backgroundColor:t="white"}=e??{};const n=btoa(s);t!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(t)||(t=`!${t}`));const r=`https://mermaid.ink/img/${n}?bgColor=${t}`,o=await fetch(r);if(!o.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${o.status}`,`Status text: ${o.statusText}`].join(`
`));return await o.blob()}function nodeDataStr(s,e){if(s!==void 0&&!validate$1(s))return s;if(isRunnableInterface(e))try{let t=e.getName();return t=t.startsWith("Runnable")?t.slice(8):t,t}catch{return e.getName()}else return e.name??"UnknownSchema"}function nodeDataJson(s){return isRunnableInterface(s.data)?{type:"runnable",data:{id:s.data.lc_id,name:s.data.getName()}}:{type:"schema",data:{...zodToJsonSchema(s.data.schema),title:s.data.name}}}class Graph{constructor(e){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.nodes=(e==null?void 0:e.nodes)??this.nodes,this.edges=(e==null?void 0:e.edges)??this.edges}toJSON(){const e={};return Object.values(this.nodes).forEach((t,n)=>{e[t.id]=validate$1(t.id)?n:t.id}),{nodes:Object.values(this.nodes).map(t=>({id:e[t.id],...nodeDataJson(t)})),edges:this.edges.map(t=>{const n={source:e[t.source],target:e[t.target]};return typeof t.data<"u"&&(n.data=t.data),typeof t.conditional<"u"&&(n.conditional=t.conditional),n})}}addNode(e,t,n){if(t!==void 0&&this.nodes[t]!==void 0)throw new Error(`Node with id ${t} already exists`);const r=t??v4(),o={id:r,data:e,name:nodeDataStr(t,e),metadata:n};return this.nodes[r]=o,o}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(t=>t.source!==e.id&&t.target!==e.id)}addEdge(e,t,n,r){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[t.id]===void 0)throw new Error(`Target node ${t.id} not in graph`);const o={source:e.id,target:t.id,data:n,conditional:r};return this.edges.push(o),o}firstNode(){return _firstNode(this)}lastNode(){return _lastNode(this)}extend(e,t=""){let n=t;Object.values(e.nodes).map(f=>f.id).every(validate$1)&&(n="");const o=f=>n?`${n}:${f}`:f;Object.entries(e.nodes).forEach(([f,p])=>{this.nodes[o(f)]={...p,id:o(f)}});const c=e.edges.map(f=>({...f,source:o(f.source),target:o(f.target)}));this.edges=[...this.edges,...c];const u=e.firstNode(),h=e.lastNode();return[u?{id:o(u.id),data:u.data}:void 0,h?{id:o(h.id),data:h.data}:void 0]}trimFirstNode(){const e=this.firstNode();e&&_firstNode(this,[e.id])&&this.removeNode(e)}trimLastNode(){const e=this.lastNode();e&&_lastNode(this,[e.id])&&this.removeNode(e)}reid(){const e=Object.fromEntries(Object.values(this.nodes).map(r=>[r.id,r.name])),t=new Map;Object.values(e).forEach(r=>{t.set(r,(t.get(r)||0)+1)});const n=r=>{const o=e[r];return validate$1(r)&&t.get(o)===1?o:r};return new Graph({nodes:Object.fromEntries(Object.entries(this.nodes).map(([r,o])=>[n(r),{...o,id:n(r)}])),edges:this.edges.map(r=>({...r,source:n(r.source),target:n(r.target)}))})}drawMermaid(e){const{withStyles:t,curveStyle:n,nodeColors:r={default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"},wrapLabelNWords:o}=e??{},c=this.reid(),u=c.firstNode(),h=c.lastNode();return drawMermaid(c.nodes,c.edges,{firstNode:u==null?void 0:u.id,lastNode:h==null?void 0:h.id,withStyles:t,curveStyle:n,nodeColors:r,wrapLabelNWords:o})}async drawMermaidPng(e){const t=this.drawMermaid(e);return drawMermaidPng(t,{backgroundColor:e==null?void 0:e.backgroundColor})}}function _firstNode(s,e=[]){const t=new Set(s.edges.filter(r=>!e.includes(r.source)).map(r=>r.target)),n=[];for(const r of Object.values(s.nodes))!e.includes(r.id)&&!t.has(r.id)&&n.push(r);return n.length===1?n[0]:void 0}function _lastNode(s,e=[]){const t=new Set(s.edges.filter(r=>!e.includes(r.target)).map(r=>r.source)),n=[];for(const r of Object.values(s.nodes))!e.includes(r.id)&&!t.has(r.id)&&n.push(r);return n.length===1?n[0]:void 0}function convertToHttpEventStream(s){const e=new TextEncoder,t=new ReadableStream({async start(n){for await(const r of s)n.enqueue(e.encode(`event: data
data: ${JSON.stringify(r)}

`));n.enqueue(e.encode(`event: end

`)),n.close()}});return IterableReadableStream.fromReadableStream(t)}function isIterableIterator(s){return typeof s=="object"&&s!==null&&typeof s[Symbol.iterator]=="function"&&typeof s.next=="function"}const isIterator=s=>s!=null&&typeof s=="object"&&"next"in s&&typeof s.next=="function";function isAsyncIterable(s){return typeof s=="object"&&s!==null&&typeof s[Symbol.asyncIterator]=="function"}function*consumeIteratorInContext(s,e){for(;;){const{value:t,done:n}=AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(s),e.next.bind(e),!0);if(n)break;yield t}}async function*consumeAsyncIterableInContext(s,e){const t=e[Symbol.asyncIterator]();for(;;){const{value:n,done:r}=await AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(s),t.next.bind(e),!0);if(r)break;yield n}}function _coerceToDict(s,e){return s&&!Array.isArray(s)&&!(s instanceof Date)&&typeof s=="object"?s:{[e]:s}}class Runnable extends Serializable{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){const t=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${t}${e}`:t}bind(e){return new RunnableBinding({bound:this,kwargs:e,config:{}})}map(){return new RunnableEach({bound:this})}withRetry(e){return new RunnableRetry({bound:this,kwargs:{},config:{},maxAttemptNumber:e==null?void 0:e.stopAfterAttempt,...e})}withConfig(e){return new RunnableBinding({bound:this,config:e,kwargs:{}})}withFallbacks(e){const t=Array.isArray(e)?e:e.fallbacks;return new RunnableWithFallbacks({runnable:this,fallbacks:t})}_getOptionsList(e,t=0){if(Array.isArray(e)&&e.length!==t)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${t} inputs`);if(Array.isArray(e))return e.map(ensureConfig);if(t>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const n=Object.fromEntries(Object.entries(e).filter(([r])=>r!=="runId"));return Array.from({length:t},(r,o)=>ensureConfig(o===0?e:n))}return Array.from({length:t},()=>ensureConfig(e))}async batch(e,t,n){var h;const r=this._getOptionsList(t??{},e.length),o=((h=r[0])==null?void 0:h.maxConcurrency)??(n==null?void 0:n.maxConcurrency),c=new AsyncCaller({maxConcurrency:o,onFailedAttempt:f=>{throw f}}),u=e.map((f,p)=>c.call(async()=>{try{return await this.invoke(f,r[p])}catch(g){if(n!=null&&n.returnExceptions)return g;throw g}}));return Promise.all(u)}async*_streamIterator(e,t){yield this.invoke(e,t)}async stream(e,t){const n=ensureConfig(t),r=new AsyncGeneratorWithSetup({generator:this._streamIterator(e,n),config:n});return await r.setup,IterableReadableStream.fromAsyncGenerator(r)}_separateRunnableConfigFromCallOptions(e){let t;e===void 0?t=ensureConfig(e):t=ensureConfig({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});const n={...e};return delete n.callbacks,delete n.tags,delete n.metadata,delete n.runName,delete n.configurable,delete n.recursionLimit,delete n.maxConcurrency,delete n.runId,delete n.timeout,delete n.signal,[t,n]}async _callWithConfig(e,t,n){const r=ensureConfig(n),o=await getCallbackManagerForConfig(r),c=await(o==null?void 0:o.handleChainStart(this.toJSON(),_coerceToDict(t,"input"),r.runId,r==null?void 0:r.runType,void 0,void 0,(r==null?void 0:r.runName)??this.getName()));delete r.runId;let u;try{const h=e.call(this,t,r,c);u=await raceWithSignal(h,n==null?void 0:n.signal)}catch(h){throw await(c==null?void 0:c.handleChainError(h)),h}return await(c==null?void 0:c.handleChainEnd(_coerceToDict(u,"output"))),u}async _batchWithConfig(e,t,n,r){var f;const o=this._getOptionsList(n??{},t.length),c=await Promise.all(o.map(getCallbackManagerForConfig)),u=await Promise.all(c.map(async(p,g)=>{const y=await(p==null?void 0:p.handleChainStart(this.toJSON(),_coerceToDict(t[g],"input"),o[g].runId,o[g].runType,void 0,void 0,o[g].runName??this.getName()));return delete o[g].runId,y}));let h;try{const p=e.call(this,t,o,u,r);h=await raceWithSignal(p,(f=o==null?void 0:o[0])==null?void 0:f.signal)}catch(p){throw await Promise.all(u.map(g=>g==null?void 0:g.handleChainError(p))),p}return await Promise.all(u.map(p=>p==null?void 0:p.handleChainEnd(_coerceToDict(h,"output")))),h}async*_transformStreamWithConfig(e,t,n){let r,o=!0,c,u=!0;const h=ensureConfig(n),f=await getCallbackManagerForConfig(h);async function*p(){for await(const y of e){if(o)if(r===void 0)r=y;else try{r=concat(r,y)}catch{r=void 0,o=!1}yield y}}let g;try{const y=await pipeGeneratorWithSetup(t.bind(this),p(),async()=>f==null?void 0:f.handleChainStart(this.toJSON(),{input:""},h.runId,h.runType,void 0,void 0,h.runName??this.getName()),n==null?void 0:n.signal,h);delete h.runId,g=y.setup;const v=g==null?void 0:g.handlers.find(isStreamEventsHandler);let _=y.output;v!==void 0&&g!==void 0&&(_=v.tapOutputIterable(g.runId,_));const E=g==null?void 0:g.handlers.find(isLogStreamHandler);E!==void 0&&g!==void 0&&(_=E.tapOutputIterable(g.runId,_));for await(const x of _)if(yield x,u)if(c===void 0)c=x;else try{c=concat(c,x)}catch{c=void 0,u=!1}}catch(y){throw await(g==null?void 0:g.handleChainError(y,void 0,void 0,void 0,{inputs:_coerceToDict(r,"input")})),y}await(g==null?void 0:g.handleChainEnd(c??{},void 0,void 0,void 0,{inputs:_coerceToDict(r,"input")}))}getGraph(e){const t=new Graph,n=t.addNode({name:`${this.getName()}Input`,schema:z.any()}),r=t.addNode(this),o=t.addNode({name:`${this.getName()}Output`,schema:z.any()});return t.addEdge(n,r),t.addEdge(r,o),t}pipe(e){return new RunnableSequence({first:this,last:_coerceToRunnable(e)})}pick(e){return this.pipe(new RunnablePick(e))}assign(e){return this.pipe(new RunnableAssign(new RunnableMap({steps:e})))}async*transform(e,t){let n;for await(const r of e)n===void 0?n=r:n=concat(n,r);yield*this._streamIterator(n,ensureConfig(t))}async*streamLog(e,t,n){const r=new LogStreamCallbackHandler({...n,autoClose:!1,_schemaFormat:"original"}),o=ensureConfig(t);yield*this._streamLog(e,r,o)}async*_streamLog(e,t,n){const{callbacks:r}=n;if(r===void 0)n.callbacks=[t];else if(Array.isArray(r))n.callbacks=r.concat([t]);else{const h=r.copy();h.addHandler(t,!0),n.callbacks=h}const o=this.stream(e,n);async function c(){try{const h=await o;for await(const f of h){const p=new RunLogPatch({ops:[{op:"add",path:"/streamed_output/-",value:f}]});await t.writer.write(p)}}finally{await t.writer.close()}}const u=c();try{for await(const h of t)yield h}finally{await u}}streamEvents(e,t,n){let r;if(t.version==="v1")r=this._streamEventsV1(e,t,n);else if(t.version==="v2")r=this._streamEventsV2(e,t,n);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return t.encoding==="text/event-stream"?convertToHttpEventStream(r):IterableReadableStream.fromAsyncGenerator(r)}async*_streamEventsV2(e,t,n){var _;const r=new EventStreamCallbackHandler({...n,autoClose:!1}),o=ensureConfig(t),c=o.runId??v4();o.runId=c;const u=o.callbacks;if(u===void 0)o.callbacks=[r];else if(Array.isArray(u))o.callbacks=u.concat(r);else{const E=u.copy();E.addHandler(r,!0),o.callbacks=E}const h=new AbortController,f=this;async function p(){try{let E;t!=null&&t.signal?"any"in AbortSignal?E=AbortSignal.any([h.signal,t.signal]):(E=t.signal,t.signal.addEventListener("abort",()=>{h.abort()},{once:!0})):E=h.signal;const x=await f.stream(e,{...o,signal:E}),w=r.tapOutputIterable(c,x);for await(const T of w)if(h.signal.aborted)break}finally{await r.finish()}}const g=p();let y=!1,v;try{for await(const E of r){if(!y){E.data.input=e,y=!0,v=E.run_id,yield E;continue}E.run_id===v&&E.event.endsWith("_end")&&(_=E.data)!=null&&_.input&&delete E.data.input,yield E}}finally{h.abort(),await g}}async*_streamEventsV1(e,t,n){let r,o=!1;const c=ensureConfig(t),u=c.tags??[],h=c.metadata??{},f=c.runName??this.getName(),p=new LogStreamCallbackHandler({...n,autoClose:!1,_schemaFormat:"streaming_events"}),g=new _RootEventFilter({...n}),y=this._streamLog(e,p,c);for await(const _ of y){if(r?r=r.concat(_):r=RunLog.fromRunLogPatch(_),r.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!o){o=!0;const T={...r.state},O={run_id:T.id,event:`on_${T.type}_start`,name:f,tags:u,metadata:h,data:{input:e}};g.includeEvent(O,T.type)&&(yield O)}const E=_.ops.filter(T=>T.path.startsWith("/logs/")).map(T=>T.path.split("/")[2]),x=[...new Set(E)];for(const T of x){let O,N={};const A=r.state.logs[T];if(A.end_time===void 0?A.streamed_output.length>0?O="stream":O="start":O="end",O==="start")A.inputs!==void 0&&(N.input=A.inputs);else if(O==="end")A.inputs!==void 0&&(N.input=A.inputs),N.output=A.final_output;else if(O==="stream"){const I=A.streamed_output.length;if(I!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${I} instead. Encountered in: "${A.name}"`);N={chunk:A.streamed_output[0]},A.streamed_output=[]}yield{event:`on_${A.type}_${O}`,name:A.name,run_id:A.id,tags:A.tags,metadata:A.metadata,data:N}}const{state:w}=r;if(w.streamed_output.length>0){const T=w.streamed_output.length;if(T!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${T} instead. Encountered in: "${w.name}"`);const O={chunk:w.streamed_output[0]};w.streamed_output=[];const N={event:`on_${w.type}_stream`,run_id:w.id,tags:u,metadata:h,name:f,data:O};g.includeEvent(N,w.type)&&(yield N)}}const v=r==null?void 0:r.state;if(v!==void 0){const _={event:`on_${v.type}_end`,name:f,run_id:v.id,tags:u,metadata:h,data:{output:v.final_output}};g.includeEvent(_,v.type)&&(yield _)}}static isRunnable(e){return isRunnableInterface(e)}withListeners({onStart:e,onEnd:t,onError:n}){return new RunnableBinding({bound:this,config:{},configFactories:[r=>({callbacks:[new RootListenersTracer({config:r,onStart:e,onEnd:t,onError:n})]})]})}asTool(e){return convertRunnableToTool(this,e)}}class RunnableBinding extends Runnable{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){const t=mergeConfigs(this.config,...e);return mergeConfigs(t,...this.configFactories?await Promise.all(this.configFactories.map(async n=>await n(t))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new this.constructor({bound:this.bound.withRetry(e),kwargs:this.kwargs,config:this.config})}async invoke(e,t){return this.bound.invoke(e,await this._mergeConfig(ensureConfig(t),this.kwargs))}async batch(e,t,n){const r=Array.isArray(t)?await Promise.all(t.map(async o=>this._mergeConfig(ensureConfig(o),this.kwargs))):await this._mergeConfig(ensureConfig(t),this.kwargs);return this.bound.batch(e,r,n)}async*_streamIterator(e,t){yield*this.bound._streamIterator(e,await this._mergeConfig(ensureConfig(t),this.kwargs))}async stream(e,t){return this.bound.stream(e,await this._mergeConfig(ensureConfig(t),this.kwargs))}async*transform(e,t){yield*this.bound.transform(e,await this._mergeConfig(ensureConfig(t),this.kwargs))}streamEvents(e,t,n){const r=this,o=async function*(){yield*r.bound.streamEvents(e,{...await r._mergeConfig(ensureConfig(t),r.kwargs),version:t.version},n)};return IterableReadableStream.fromAsyncGenerator(o())}static isRunnableBinding(e){return e.bound&&Runnable.isRunnable(e.bound)}withListeners({onStart:e,onEnd:t,onError:n}){return new RunnableBinding({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[r=>({callbacks:[new RootListenersTracer({config:r,onStart:e,onEnd:t,onError:n})]})]})}}class RunnableEach extends Runnable{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new RunnableEach({bound:this.bound.bind(e)})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _invoke(e,t,n){return this.bound.batch(e,patchConfig(t,{callbacks:n==null?void 0:n.getChild()}))}withListeners({onStart:e,onEnd:t,onError:n}){return new RunnableEach({bound:this.bound.withListeners({onStart:e,onEnd:t,onError:n})})}}class RunnableRetry extends RunnableBinding{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,t,n){const r=e>1?`retry:attempt:${e}`:void 0;return patchConfig(t,{callbacks:n==null?void 0:n.getChild(r)})}async _invoke(e,t,n){return pRetry(r=>super.invoke(e,this._patchConfigForRetry(r,t,n)),{onFailedAttempt:r=>this.onFailedAttempt(r,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _batch(e,t,n,r){const o={};try{await pRetry(async c=>{const u=e.map((y,v)=>v).filter(y=>o[y.toString()]===void 0||o[y.toString()]instanceof Error),h=u.map(y=>e[y]),f=u.map(y=>this._patchConfigForRetry(c,t==null?void 0:t[y],n==null?void 0:n[y])),p=await super.batch(h,f,{...r,returnExceptions:!0});let g;for(let y=0;y<p.length;y+=1){const v=p[y],_=u[y];v instanceof Error&&g===void 0&&(g=v,g.input=h[y]),o[_.toString()]=v}if(g)throw g;return p},{onFailedAttempt:c=>this.onFailedAttempt(c,c.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(c){if((r==null?void 0:r.returnExceptions)!==!0)throw c}return Object.keys(o).sort((c,u)=>parseInt(c,10)-parseInt(u,10)).map(c=>o[parseInt(c,10)])}async batch(e,t,n){return this._batchWithConfig(this._batch.bind(this),e,t,n)}}class RunnableSequence extends Runnable{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"omitSequenceTags",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name,this.omitSequenceTags=e.omitSequenceTags??this.omitSequenceTags}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,t){var h;const n=ensureConfig(t),r=await getCallbackManagerForConfig(n),o=await(r==null?void 0:r.handleChainStart(this.toJSON(),_coerceToDict(e,"input"),n.runId,void 0,void 0,void 0,n==null?void 0:n.runName));delete n.runId;let c=e,u;try{const f=[this.first,...this.middle];for(let p=0;p<f.length;p+=1){const y=f[p].invoke(c,patchConfig(n,{callbacks:o==null?void 0:o.getChild(this.omitSequenceTags?void 0:`seq:step:${p+1}`)}));c=await raceWithSignal(y,t==null?void 0:t.signal)}if((h=t==null?void 0:t.signal)!=null&&h.aborted)throw new Error("Aborted");u=await this.last.invoke(c,patchConfig(n,{callbacks:o==null?void 0:o.getChild(this.omitSequenceTags?void 0:`seq:step:${this.steps.length}`)}))}catch(f){throw await(o==null?void 0:o.handleChainError(f)),f}return await(o==null?void 0:o.handleChainEnd(_coerceToDict(u,"output"))),u}async batch(e,t,n){var h;const r=this._getOptionsList(t??{},e.length),o=await Promise.all(r.map(getCallbackManagerForConfig)),c=await Promise.all(o.map(async(f,p)=>{const g=await(f==null?void 0:f.handleChainStart(this.toJSON(),_coerceToDict(e[p],"input"),r[p].runId,void 0,void 0,void 0,r[p].runName));return delete r[p].runId,g}));let u=e;try{for(let f=0;f<this.steps.length;f+=1){const g=this.steps[f].batch(u,c.map((y,v)=>{const _=y==null?void 0:y.getChild(this.omitSequenceTags?void 0:`seq:step:${f+1}`);return patchConfig(r[v],{callbacks:_})}),n);u=await raceWithSignal(g,(h=r[0])==null?void 0:h.signal)}}catch(f){throw await Promise.all(c.map(p=>p==null?void 0:p.handleChainError(f))),f}return await Promise.all(c.map(f=>f==null?void 0:f.handleChainEnd(_coerceToDict(u,"output")))),u}async*_streamIterator(e,t){var g;const n=await getCallbackManagerForConfig(t),{runId:r,...o}=t??{},c=await(n==null?void 0:n.handleChainStart(this.toJSON(),_coerceToDict(e,"input"),r,void 0,void 0,void 0,o==null?void 0:o.runName)),u=[this.first,...this.middle,this.last];let h=!0,f;async function*p(){yield e}try{let y=u[0].transform(p(),patchConfig(o,{callbacks:c==null?void 0:c.getChild(this.omitSequenceTags?void 0:"seq:step:1")}));for(let v=1;v<u.length;v+=1)y=await u[v].transform(y,patchConfig(o,{callbacks:c==null?void 0:c.getChild(this.omitSequenceTags?void 0:`seq:step:${v+1}`)}));for await(const v of y)if((g=t==null?void 0:t.signal)==null||g.throwIfAborted(),yield v,h)if(f===void 0)f=v;else try{f=concat(f,v)}catch{f=void 0,h=!1}}catch(y){throw await(c==null?void 0:c.handleChainError(y)),y}await(c==null?void 0:c.handleChainEnd(_coerceToDict(f,"output")))}getGraph(e){const t=new Graph;let n=null;return this.steps.forEach((r,o)=>{const c=r.getGraph(e);o!==0&&c.trimFirstNode(),o!==this.steps.length-1&&c.trimLastNode(),t.extend(c);const u=c.firstNode();if(!u)throw new Error(`Runnable ${r} has no first node`);n&&t.addEdge(n,u),n=c.lastNode()}),t}pipe(e){return RunnableSequence.isRunnableSequence(e)?new RunnableSequence({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}):new RunnableSequence({first:this.first,middle:[...this.middle,this.last],last:_coerceToRunnable(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&Runnable.isRunnable(e)}static from([e,...t],n){let r={};return typeof n=="string"?r.name=n:n!==void 0&&(r=n),new RunnableSequence({...r,first:_coerceToRunnable(e),middle:t.slice(0,-1).map(_coerceToRunnable),last:_coerceToRunnable(t[t.length-1])})}}class RunnableMap extends Runnable{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[t,n]of Object.entries(e.steps))this.steps[t]=_coerceToRunnable(n)}static from(e){return new RunnableMap({steps:e})}async invoke(e,t){const n=ensureConfig(t),r=await getCallbackManagerForConfig(n),o=await(r==null?void 0:r.handleChainStart(this.toJSON(),{input:e},n.runId,void 0,void 0,void 0,n==null?void 0:n.runName));delete n.runId;const c={};try{const u=Object.entries(this.steps).map(async([h,f])=>{c[h]=await f.invoke(e,patchConfig(n,{callbacks:o==null?void 0:o.getChild(`map:key:${h}`)}))});await raceWithSignal(Promise.all(u),t==null?void 0:t.signal)}catch(u){throw await(o==null?void 0:o.handleChainError(u)),u}return await(o==null?void 0:o.handleChainEnd(c)),c}async*_transform(e,t,n){const r={...this.steps},o=atee(e,Object.keys(r).length),c=new Map(Object.entries(r).map(([u,h],f)=>{const p=h.transform(o[f],patchConfig(n,{callbacks:t==null?void 0:t.getChild(`map:key:${u}`)}));return[u,p.next().then(g=>({key:u,gen:p,result:g}))]}));for(;c.size;){const u=Promise.race(c.values()),{key:h,result:f,gen:p}=await raceWithSignal(u,n==null?void 0:n.signal);c.delete(h),f.done||(yield{[h]:f.value},c.set(h,p.next().then(g=>({key:h,gen:p,result:g}))))}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*n(){yield e}const r=ensureConfig(t),o=new AsyncGeneratorWithSetup({generator:this.transform(n(),r),config:r});return await o.setup,IterableReadableStream.fromAsyncGenerator(o)}}class RunnableTraceable extends Runnable{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!isTraceableFunction(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,t){const[n]=this._getOptionsList(t??{},1),r=await getCallbackManagerForConfig(n),o=this.func(patchConfig(n,{callbacks:r}),e);return raceWithSignal(o,n==null?void 0:n.signal)}async*_streamIterator(e,t){var o,c;const[n]=this._getOptionsList(t??{},1),r=await this.invoke(e,t);if(isAsyncIterable(r)){for await(const u of r)(o=n==null?void 0:n.signal)==null||o.throwIfAborted(),yield u;return}if(isIterator(r)){for(;;){(c=n==null?void 0:n.signal)==null||c.throwIfAborted();const u=r.next();if(u.done)break;yield u.value}return}yield r}static from(e){return new RunnableTraceable({func:e})}}function assertNonTraceableFunction(s){if(isTraceableFunction(s))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}class RunnableLambda extends Runnable{static lc_name(){return"RunnableLambda"}constructor(e){if(isTraceableFunction(e.func))return RunnableTraceable.from(e.func);super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),assertNonTraceableFunction(e.func),this.func=e.func}static from(e){return new RunnableLambda({func:e})}async _invoke(e,t,n){return new Promise((r,o)=>{const c=patchConfig(t,{callbacks:n==null?void 0:n.getChild(),recursionLimit:((t==null?void 0:t.recursionLimit)??DEFAULT_RECURSION_LIMIT)-1});AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(c),async()=>{var u,h;try{let f=await this.func(e,{...c});if(f&&Runnable.isRunnable(f)){if((t==null?void 0:t.recursionLimit)===0)throw new Error("Recursion limit reached.");f=await f.invoke(e,{...c,recursionLimit:(c.recursionLimit??DEFAULT_RECURSION_LIMIT)-1})}else if(isAsyncIterable(f)){let p;for await(const g of consumeAsyncIterableInContext(c,f))if((u=t==null?void 0:t.signal)==null||u.throwIfAborted(),p===void 0)p=g;else try{p=concat(p,g)}catch{p=g}f=p}else if(isIterableIterator(f)){let p;for(const g of consumeIteratorInContext(c,f))if((h=t==null?void 0:t.signal)==null||h.throwIfAborted(),p===void 0)p=g;else try{p=concat(p,g)}catch{p=g}f=p}r(f)}catch(f){o(f)}})})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async*_transform(e,t,n){var u,h;let r;for await(const f of e)if(r===void 0)r=f;else try{r=concat(r,f)}catch{r=f}const o=patchConfig(n,{callbacks:t==null?void 0:t.getChild(),recursionLimit:((n==null?void 0:n.recursionLimit)??DEFAULT_RECURSION_LIMIT)-1}),c=await new Promise((f,p)=>{AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(o),async()=>{try{const g=await this.func(r,{...o,config:o});f(g)}catch(g){p(g)}})});if(c&&Runnable.isRunnable(c)){if((n==null?void 0:n.recursionLimit)===0)throw new Error("Recursion limit reached.");const f=await c.stream(r,o);for await(const p of f)yield p}else if(isAsyncIterable(c))for await(const f of consumeAsyncIterableInContext(o,c))(u=n==null?void 0:n.signal)==null||u.throwIfAborted(),yield f;else if(isIterableIterator(c))for(const f of consumeIteratorInContext(o,c))(h=n==null?void 0:n.signal)==null||h.throwIfAborted(),yield f;else yield c}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*n(){yield e}const r=ensureConfig(t),o=new AsyncGeneratorWithSetup({generator:this.transform(n(),r),config:r});return await o.setup,IterableReadableStream.fromAsyncGenerator(o)}}class RunnableWithFallbacks extends Runnable{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,t){const n=ensureConfig(t),r=await getCallbackManagerForConfig(n),{runId:o,...c}=n,u=await(r==null?void 0:r.handleChainStart(this.toJSON(),_coerceToDict(e,"input"),o,void 0,void 0,void 0,c==null?void 0:c.runName)),h=patchConfig(c,{callbacks:u==null?void 0:u.getChild()});return await AsyncLocalStorageProviderSingleton.runWithConfig(h,async()=>{var g;let p;for(const y of this.runnables()){(g=n==null?void 0:n.signal)==null||g.throwIfAborted();try{const v=await y.invoke(e,h);return await(u==null?void 0:u.handleChainEnd(_coerceToDict(v,"output"))),v}catch(v){p===void 0&&(p=v)}}throw p===void 0?new Error("No error stored at end of fallback."):(await(u==null?void 0:u.handleChainError(p)),p)})}async*_streamIterator(e,t){var g;const n=ensureConfig(t),r=await getCallbackManagerForConfig(n),{runId:o,...c}=n,u=await(r==null?void 0:r.handleChainStart(this.toJSON(),_coerceToDict(e,"input"),o,void 0,void 0,void 0,c==null?void 0:c.runName));let h,f;for(const y of this.runnables()){(g=n==null?void 0:n.signal)==null||g.throwIfAborted();const v=patchConfig(c,{callbacks:u==null?void 0:u.getChild()});try{const _=await y.stream(e,v);f=consumeAsyncIterableInContext(v,_);break}catch(_){h===void 0&&(h=_)}}if(f===void 0){const y=h??new Error("No error stored at end of fallback.");throw await(u==null?void 0:u.handleChainError(y)),y}let p;try{for await(const y of f){yield y;try{p=p===void 0?p:concat(p,y)}catch{p=void 0}}}catch(y){throw await(u==null?void 0:u.handleChainError(y)),y}await(u==null?void 0:u.handleChainEnd(_coerceToDict(p,"output")))}async batch(e,t,n){var h;if(n!=null&&n.returnExceptions)throw new Error("Not implemented.");const r=this._getOptionsList(t??{},e.length),o=await Promise.all(r.map(f=>getCallbackManagerForConfig(f))),c=await Promise.all(o.map(async(f,p)=>{const g=await(f==null?void 0:f.handleChainStart(this.toJSON(),_coerceToDict(e[p],"input"),r[p].runId,void 0,void 0,void 0,r[p].runName));return delete r[p].runId,g}));let u;for(const f of this.runnables()){(h=r[0].signal)==null||h.throwIfAborted();try{const p=await f.batch(e,c.map((g,y)=>patchConfig(r[y],{callbacks:g==null?void 0:g.getChild()})),n);return await Promise.all(c.map((g,y)=>g==null?void 0:g.handleChainEnd(_coerceToDict(p[y],"output")))),p}catch(p){u===void 0&&(u=p)}}throw u?(await Promise.all(c.map(f=>f==null?void 0:f.handleChainError(u))),u):new Error("No error stored at end of fallbacks.")}}function _coerceToRunnable(s){if(typeof s=="function")return new RunnableLambda({func:s});if(Runnable.isRunnable(s))return s;if(!Array.isArray(s)&&typeof s=="object"){const e={};for(const[t,n]of Object.entries(s))e[t]=_coerceToRunnable(n);return new RunnableMap({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}class RunnableAssign extends Runnable{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof RunnableMap&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,t){const n=await this.mapper.invoke(e,t);return{...e,...n}}async*_transform(e,t,n){const r=this.mapper.getStepsKeys(),[o,c]=atee(e),u=this.mapper.transform(c,patchConfig(n,{callbacks:t==null?void 0:t.getChild()})),h=u.next();for await(const f of o){if(typeof f!="object"||Array.isArray(f))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof f}`);const p=Object.fromEntries(Object.entries(f).filter(([g])=>!r.includes(g)));Object.keys(p).length>0&&(yield p)}yield(await h).value;for await(const f of u)yield f}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*n(){yield e}const r=ensureConfig(t),o=new AsyncGeneratorWithSetup({generator:this.transform(n(),r),config:r});return await o.setup,IterableReadableStream.fromAsyncGenerator(o)}}class RunnablePick extends Runnable{static lc_name(){return"RunnablePick"}constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const t=this.keys.map(n=>[n,e[n]]).filter(n=>n[1]!==void 0);return t.length===0?void 0:Object.fromEntries(t)}}async invoke(e,t){return this._callWithConfig(this._pick.bind(this),e,t)}async*_transform(e){for await(const t of e){const n=await this._pick(t);n!==void 0&&(yield n)}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*n(){yield e}const r=ensureConfig(t),o=new AsyncGeneratorWithSetup({generator:this.transform(n(),r),config:r});return await o.setup,IterableReadableStream.fromAsyncGenerator(o)}}class RunnableToolLike extends RunnableBinding{constructor(e){const t=RunnableSequence.from([RunnableLambda.from(async n=>{let r;if(_isToolCall(n))try{r=await this.schema.parseAsync(n.args)}catch{throw new ToolInputParsingException("Received tool input did not match expected schema",JSON.stringify(n.args))}else r=n;return r}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:t,config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}}function convertRunnableToTool(s,e){var r;const t=e.name??s.getName(),n=e.description??((r=e.schema)==null?void 0:r.description);return e.schema.constructor===z.ZodString?new RunnableToolLike({name:t,description:n,schema:z.object({input:z.string()}).transform(o=>o.input),bound:s}):new RunnableToolLike({name:t,description:n,schema:e.schema,bound:s})}/*
 * [js-sha1]{@link https://github.com/emn178/js-sha1}
 *
 * @version 0.6.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */var root=typeof window=="object"?window:{},HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],blocks=[];function Sha1(s){s?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Sha1.prototype.update=function(s){if(!this.finalized){var e=typeof s!="string";e&&s.constructor===root.ArrayBuffer&&(s=new Uint8Array(s));for(var t,n=0,r,o=s.length||0,c=this.blocks;n<o;){if(this.hashed&&(this.hashed=!1,c[0]=this.block,c[16]=c[1]=c[2]=c[3]=c[4]=c[5]=c[6]=c[7]=c[8]=c[9]=c[10]=c[11]=c[12]=c[13]=c[14]=c[15]=0),e)for(r=this.start;n<o&&r<64;++n)c[r>>2]|=s[n]<<SHIFT[r++&3];else for(r=this.start;n<o&&r<64;++n)t=s.charCodeAt(n),t<128?c[r>>2]|=t<<SHIFT[r++&3]:t<2048?(c[r>>2]|=(192|t>>6)<<SHIFT[r++&3],c[r>>2]|=(128|t&63)<<SHIFT[r++&3]):t<55296||t>=57344?(c[r>>2]|=(224|t>>12)<<SHIFT[r++&3],c[r>>2]|=(128|t>>6&63)<<SHIFT[r++&3],c[r>>2]|=(128|t&63)<<SHIFT[r++&3]):(t=65536+((t&1023)<<10|s.charCodeAt(++n)&1023),c[r>>2]|=(240|t>>18)<<SHIFT[r++&3],c[r>>2]|=(128|t>>12&63)<<SHIFT[r++&3],c[r>>2]|=(128|t>>6&63)<<SHIFT[r++&3],c[r>>2]|=(128|t&63)<<SHIFT[r++&3]);this.lastByteIndex=r,this.bytes+=r-this.start,r>=64?(this.block=c[16],this.start=r-64,this.hash(),this.hashed=!0):this.start=r}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};Sha1.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var s=this.blocks,e=this.lastByteIndex;s[16]=this.block,s[e>>2]|=EXTRA[e&3],this.block=s[16],e>=56&&(this.hashed||this.hash(),s[0]=this.block,s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),s[14]=this.hBytes<<3|this.bytes>>>29,s[15]=this.bytes<<3,this.hash()}};Sha1.prototype.hash=function(){var s=this.h0,e=this.h1,t=this.h2,n=this.h3,r=this.h4,o,c,u,h=this.blocks;for(c=16;c<80;++c)u=h[c-3]^h[c-8]^h[c-14]^h[c-16],h[c]=u<<1|u>>>31;for(c=0;c<20;c+=5)o=e&t|~e&n,u=s<<5|s>>>27,r=u+o+r+1518500249+h[c]<<0,e=e<<30|e>>>2,o=s&e|~s&t,u=r<<5|r>>>27,n=u+o+n+1518500249+h[c+1]<<0,s=s<<30|s>>>2,o=r&s|~r&e,u=n<<5|n>>>27,t=u+o+t+1518500249+h[c+2]<<0,r=r<<30|r>>>2,o=n&r|~n&s,u=t<<5|t>>>27,e=u+o+e+1518500249+h[c+3]<<0,n=n<<30|n>>>2,o=t&n|~t&r,u=e<<5|e>>>27,s=u+o+s+1518500249+h[c+4]<<0,t=t<<30|t>>>2;for(;c<40;c+=5)o=e^t^n,u=s<<5|s>>>27,r=u+o+r+1859775393+h[c]<<0,e=e<<30|e>>>2,o=s^e^t,u=r<<5|r>>>27,n=u+o+n+1859775393+h[c+1]<<0,s=s<<30|s>>>2,o=r^s^e,u=n<<5|n>>>27,t=u+o+t+1859775393+h[c+2]<<0,r=r<<30|r>>>2,o=n^r^s,u=t<<5|t>>>27,e=u+o+e+1859775393+h[c+3]<<0,n=n<<30|n>>>2,o=t^n^r,u=e<<5|e>>>27,s=u+o+s+1859775393+h[c+4]<<0,t=t<<30|t>>>2;for(;c<60;c+=5)o=e&t|e&n|t&n,u=s<<5|s>>>27,r=u+o+r-1894007588+h[c]<<0,e=e<<30|e>>>2,o=s&e|s&t|e&t,u=r<<5|r>>>27,n=u+o+n-1894007588+h[c+1]<<0,s=s<<30|s>>>2,o=r&s|r&e|s&e,u=n<<5|n>>>27,t=u+o+t-1894007588+h[c+2]<<0,r=r<<30|r>>>2,o=n&r|n&s|r&s,u=t<<5|t>>>27,e=u+o+e-1894007588+h[c+3]<<0,n=n<<30|n>>>2,o=t&n|t&r|n&r,u=e<<5|e>>>27,s=u+o+s-1894007588+h[c+4]<<0,t=t<<30|t>>>2;for(;c<80;c+=5)o=e^t^n,u=s<<5|s>>>27,r=u+o+r-899497514+h[c]<<0,e=e<<30|e>>>2,o=s^e^t,u=r<<5|r>>>27,n=u+o+n-899497514+h[c+1]<<0,s=s<<30|s>>>2,o=r^s^e,u=n<<5|n>>>27,t=u+o+t-899497514+h[c+2]<<0,r=r<<30|r>>>2,o=n^r^s,u=t<<5|t>>>27,e=u+o+e-899497514+h[c+3]<<0,n=n<<30|n>>>2,o=t^n^r,u=e<<5|e>>>27,s=u+o+s-899497514+h[c+4]<<0,t=t<<30|t>>>2;this.h0=this.h0+s<<0,this.h1=this.h1+e<<0,this.h2=this.h2+t<<0,this.h3=this.h3+n<<0,this.h4=this.h4+r<<0};Sha1.prototype.hex=function(){this.finalize();var s=this.h0,e=this.h1,t=this.h2,n=this.h3,r=this.h4;return HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[s&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[e&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[t&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[n&15]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[r&15]};Sha1.prototype.toString=Sha1.prototype.hex;Sha1.prototype.digest=function(){this.finalize();var s=this.h0,e=this.h1,t=this.h2,n=this.h3,r=this.h4;return[s>>24&255,s>>16&255,s>>8&255,s&255,e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,n>>24&255,n>>16&255,n>>8&255,n&255,r>>24&255,r>>16&255,r>>8&255,r&255]};Sha1.prototype.array=Sha1.prototype.digest;Sha1.prototype.arrayBuffer=function(){this.finalize();var s=new ArrayBuffer(20),e=new DataView(s);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),s};const insecureHash=s=>new Sha1(!0).update(s).hex(),getCacheKey=(...s)=>insecureHash(s.join("_"));class BaseCache{}const GLOBAL_MAP=new Map;class InMemoryCache extends BaseCache{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,t){return Promise.resolve(this.cache.get(getCacheKey(e,t))??null)}async update(e,t,n){this.cache.set(getCacheKey(e,t),n)}static global(){return new InMemoryCache(GLOBAL_MAP)}}class BasePromptValue extends Serializable{}class StringPromptValue extends BasePromptValue{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new HumanMessage(this.value)]}}class ChatPromptValue extends BasePromptValue{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return getBufferString(this.messages)}toChatMessages(){return this.messages}}var base64Js={},hasRequiredBase64Js;function requireBase64Js(){if(hasRequiredBase64Js)return base64Js;hasRequiredBase64Js=1,base64Js.byteLength=u,base64Js.toByteArray=f,base64Js.fromByteArray=y;for(var s=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,o=n.length;r<o;++r)s[r]=n[r],e[n.charCodeAt(r)]=r;e[45]=62,e[95]=63;function c(v){var _=v.length;if(_%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var E=v.indexOf("=");E===-1&&(E=_);var x=E===_?0:4-E%4;return[E,x]}function u(v){var _=c(v),E=_[0],x=_[1];return(E+x)*3/4-x}function h(v,_,E){return(_+E)*3/4-E}function f(v){var _,E=c(v),x=E[0],w=E[1],T=new t(h(v,x,w)),O=0,N=w>0?x-4:x,A;for(A=0;A<N;A+=4)_=e[v.charCodeAt(A)]<<18|e[v.charCodeAt(A+1)]<<12|e[v.charCodeAt(A+2)]<<6|e[v.charCodeAt(A+3)],T[O++]=_>>16&255,T[O++]=_>>8&255,T[O++]=_&255;return w===2&&(_=e[v.charCodeAt(A)]<<2|e[v.charCodeAt(A+1)]>>4,T[O++]=_&255),w===1&&(_=e[v.charCodeAt(A)]<<10|e[v.charCodeAt(A+1)]<<4|e[v.charCodeAt(A+2)]>>2,T[O++]=_>>8&255,T[O++]=_&255),T}function p(v){return s[v>>18&63]+s[v>>12&63]+s[v>>6&63]+s[v&63]}function g(v,_,E){for(var x,w=[],T=_;T<E;T+=3)x=(v[T]<<16&16711680)+(v[T+1]<<8&65280)+(v[T+2]&255),w.push(p(x));return w.join("")}function y(v){for(var _,E=v.length,x=E%3,w=[],T=16383,O=0,N=E-x;O<N;O+=T)w.push(g(v,O,O+T>N?N:O+T));return x===1?(_=v[E-1],w.push(s[_>>2]+s[_<<4&63]+"==")):x===2&&(_=(v[E-2]<<8)+v[E-1],w.push(s[_>>10]+s[_>>4&63]+s[_<<2&63]+"=")),w.join("")}return base64Js}var base64JsExports=requireBase64Js();const base64=getDefaultExportFromCjs(base64JsExports);var __defProp=Object.defineProperty,__defNormalProp=(s,e,t)=>e in s?__defProp(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,__publicField=(s,e,t)=>(__defNormalProp(s,e+"",t),t);function bytePairMerge(s,e){let t=Array.from({length:s.length},(n,r)=>({start:r,end:r+1}));for(;t.length>1;){let n=null;for(let r=0;r<t.length-1;r++){const o=s.slice(t[r].start,t[r+1].end),c=e.get(o.join(","));c!=null&&(n==null||c<n[0])&&(n=[c,r])}if(n!=null){const r=n[1];t[r]={start:t[r].start,end:t[r+1].end},t.splice(r+1,1)}else break}return t}function bytePairEncode(s,e){return s.length===1?[e.get(s.join(","))]:bytePairMerge(s,e).map(t=>e.get(s.slice(t.start,t.end).join(","))).filter(t=>t!=null)}function escapeRegex(s){return s.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var _Tiktoken=class{constructor(s,e){ot(this,"specialTokens");ot(this,"inverseSpecialTokens");ot(this,"patStr");ot(this,"textEncoder",new TextEncoder);ot(this,"textDecoder",new TextDecoder("utf-8"));ot(this,"rankMap",new Map);ot(this,"textMap",new Map);this.patStr=s.pat_str;const t=s.bpe_ranks.split(`
`).filter(Boolean).reduce((n,r)=>{const[o,c,...u]=r.split(" "),h=Number.parseInt(c,10);return u.forEach((f,p)=>n[f]=h+p),n},{});for(const[n,r]of Object.entries(t)){const o=base64.toByteArray(n);this.rankMap.set(o.join(","),r),this.textMap.set(r,o)}this.specialTokens={...s.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((n,[r,o])=>(n[o]=this.textEncoder.encode(r),n),{})}encode(s,e=[],t="all"){const n=new RegExp(this.patStr,"ug"),r=_Tiktoken.specialTokenRegex(Object.keys(this.specialTokens)),o=[],c=new Set(e==="all"?Object.keys(this.specialTokens):e),u=new Set(t==="all"?Object.keys(this.specialTokens).filter(f=>!c.has(f)):t);if(u.size>0){const f=_Tiktoken.specialTokenRegex([...u]),p=s.match(f);if(p!=null)throw new Error(`The text contains a special token that is not allowed: ${p[0]}`)}let h=0;for(;;){let f=null,p=h;for(;r.lastIndex=p,f=r.exec(s),!(f==null||c.has(f[0]));)p=f.index+1;const g=(f==null?void 0:f.index)??s.length;for(const v of s.substring(h,g).matchAll(n)){const _=this.textEncoder.encode(v[0]),E=this.rankMap.get(_.join(","));if(E!=null){o.push(E);continue}o.push(...bytePairEncode(_,this.rankMap))}if(f==null)break;let y=this.specialTokens[f[0]];o.push(y),h=f.index+f[0].length}return o}decode(s){const e=[];let t=0;for(let o=0;o<s.length;++o){const c=s[o],u=this.textMap.get(c)??this.inverseSpecialTokens[c];u!=null&&(e.push(u),t+=u.length)}const n=new Uint8Array(t);let r=0;for(const o of e)n.set(o,r),r+=o.length;return this.textDecoder.decode(n)}},Tiktoken=_Tiktoken;__publicField(Tiktoken,"specialTokenRegex",s=>new RegExp(s.map(e=>escapeRegex(e)).join("|"),"g"));function getEncodingNameForModel(s){switch(s){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-2024-11-20":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"o1":case"o1-2024-12-17":case"o1-mini":case"o1-preview":case"o1-preview-2024-09-12":case"o1-mini-2024-09-12":case"o3-mini":case"o3-mini-2025-01-31":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":return"o200k_base";default:throw new Error("Unknown model")}}const cache={},caller=new AsyncCaller({});async function getEncoding(s){return s in cache||(cache[s]=caller.fetch(`https://tiktoken.pages.dev/js/${s}.json`).then(e=>e.json()).then(e=>new Tiktoken(e)).catch(e=>{throw delete cache[s],e})),await cache[s]}async function encodingForModel(s){return getEncoding(getEncodingNameForModel(s))}const getModelNameForTiktoken=s=>s.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":s.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":s.startsWith("gpt-4-32k")?"gpt-4-32k":s.startsWith("gpt-4-")?"gpt-4":s.startsWith("gpt-4o")?"gpt-4o":s,getVerbosity=()=>!1;class BaseLangChain extends Runnable{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??getVerbosity(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class BaseLanguageModel extends BaseLangChain{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:t,...n}){const{cache:r,...o}=n;super({callbacks:e??t,...o}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof r=="object"?this.cache=r:r?this.cache=InMemoryCache.global():this.cache=void 0,this.caller=new AsyncCaller(n??{})}async getNumTokens(e){if(typeof e!="string")return 0;let t=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await encodingForModel("modelName"in this?getModelNameForTiktoken(this.modelName):"gpt2")}catch(n){console.warn("Failed to calculate number of tokens, falling back to approximate count",n)}if(this._encoding)try{t=this._encoding.encode(e).length}catch(n){console.warn("Failed to calculate number of tokens, falling back to approximate count",n)}return t}static _convertInputToPromptValue(e){return typeof e=="string"?new StringPromptValue(e):Array.isArray(e)?new ChatPromptValue(e.map(coerceMessageLikeToMessage)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...t}){const n={...this._identifyingParams(),...t,_type:this._llmType(),_model:this._modelType()};return Object.entries(n).filter(([c,u])=>u!==void 0).map(([c,u])=>`${c}:${JSON.stringify(u)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}}class RunnablePassthrough extends Runnable{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}async invoke(e,t){const n=ensureConfig(t);return this.func&&await this.func(e,n),this._callWithConfig(r=>Promise.resolve(r),e,n)}async*transform(e,t){const n=ensureConfig(t);let r,o=!0;for await(const c of this._transformStreamWithConfig(e,u=>u,n))if(yield c,o)if(r===void 0)r=c;else try{r=concat(r,c)}catch{r=void 0,o=!1}this.func&&r!==void 0&&await this.func(r,n)}static assign(e){return new RunnableAssign(new RunnableMap({steps:e}))}}function isZodSchema(s){return typeof(s==null?void 0:s.parse)=="function"}class BaseChatModel extends BaseLanguageModel{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]}),Object.defineProperty(this,"disableStreaming",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_separateRunnableConfigFromCallOptionsCompat(e){const[t,n]=super._separateRunnableConfigFromCallOptions(e);return n.signal=t.signal,[t,n]}async invoke(e,t){const n=BaseChatModel._convertInputToPromptValue(e);return(await this.generatePrompt([n],t,t==null?void 0:t.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,t,n){throw new Error("Not implemented.")}async*_streamIterator(e,t){var n;if(this._streamResponseChunks===BaseChatModel.prototype._streamResponseChunks||this.disableStreaming)yield this.invoke(e,t);else{const o=BaseChatModel._convertInputToPromptValue(e).toChatMessages(),[c,u]=this._separateRunnableConfigFromCallOptionsCompat(t),h={...c.metadata,...this.getLsParams(u)},f=await CallbackManager.configure(c.callbacks,this.callbacks,c.tags,this.tags,h,this.metadata,{verbose:this.verbose}),p={options:u,invocation_params:this==null?void 0:this.invocationParams(u),batch_size:1},g=await(f==null?void 0:f.handleChatModelStart(this.toJSON(),[o],c.runId,void 0,p,void 0,void 0,c.runName));let y,v;try{for await(const _ of this._streamResponseChunks(o,u,g==null?void 0:g[0])){if(_.message.id==null){const E=(n=g==null?void 0:g.at(0))==null?void 0:n.runId;E!=null&&_.message._updateId(`run-${E}`)}_.message.response_metadata={..._.generationInfo,..._.message.response_metadata},yield _.message,y?y=y.concat(_):y=_,isAIMessageChunk(_.message)&&_.message.usage_metadata!==void 0&&(v={tokenUsage:{promptTokens:_.message.usage_metadata.input_tokens,completionTokens:_.message.usage_metadata.output_tokens,totalTokens:_.message.usage_metadata.total_tokens}})}}catch(_){throw await Promise.all((g??[]).map(E=>E==null?void 0:E.handleLLMError(_))),_}await Promise.all((g??[]).map(_=>_==null?void 0:_.handleLLMEnd({generations:[[y]],llmOutput:v})))}}getLsParams(e){const t=this.getName().startsWith("Chat")?this.getName().replace("Chat",""):this.getName();return{ls_model_type:"chat",ls_stop:e.stop,ls_provider:t}}async _generateUncached(e,t,n,r){var g,y;const o=e.map(v=>v.map(coerceMessageLikeToMessage));let c;if(r!==void 0&&r.length===o.length)c=r;else{const v={...n.metadata,...this.getLsParams(t)},_=await CallbackManager.configure(n.callbacks,this.callbacks,n.tags,this.tags,v,this.metadata,{verbose:this.verbose}),E={options:t,invocation_params:this==null?void 0:this.invocationParams(t),batch_size:1};c=await(_==null?void 0:_.handleChatModelStart(this.toJSON(),o,n.runId,void 0,E,void 0,void 0,n.runName))}const u=[],h=[];if(!!(c!=null&&c[0].handlers.find(callbackHandlerPrefersStreaming))&&!this.disableStreaming&&o.length===1&&this._streamResponseChunks!==BaseChatModel.prototype._streamResponseChunks)try{const v=await this._streamResponseChunks(o[0],t,c==null?void 0:c[0]);let _,E;for await(const x of v){if(x.message.id==null){const w=(g=c==null?void 0:c.at(0))==null?void 0:g.runId;w!=null&&x.message._updateId(`run-${w}`)}_===void 0?_=x:_=concat(_,x),isAIMessageChunk(x.message)&&x.message.usage_metadata!==void 0&&(E={tokenUsage:{promptTokens:x.message.usage_metadata.input_tokens,completionTokens:x.message.usage_metadata.output_tokens,totalTokens:x.message.usage_metadata.total_tokens}})}if(_===void 0)throw new Error("Received empty response from chat model call.");u.push([_]),await(c==null?void 0:c[0].handleLLMEnd({generations:u,llmOutput:E}))}catch(v){throw await(c==null?void 0:c[0].handleLLMError(v)),v}else{const v=await Promise.allSettled(o.map((_,E)=>this._generate(_,{...t,promptIndex:E},c==null?void 0:c[E])));await Promise.all(v.map(async(_,E)=>{var x,w,T;if(_.status==="fulfilled"){const O=_.value;for(const N of O.generations){if(N.message.id==null){const A=(x=c==null?void 0:c.at(0))==null?void 0:x.runId;A!=null&&N.message._updateId(`run-${A}`)}N.message.response_metadata={...N.generationInfo,...N.message.response_metadata}}return O.generations.length===1&&(O.generations[0].message.response_metadata={...O.llmOutput,...O.generations[0].message.response_metadata}),u[E]=O.generations,h[E]=O.llmOutput,(w=c==null?void 0:c[E])==null?void 0:w.handleLLMEnd({generations:[O.generations],llmOutput:O.llmOutput})}else return await((T=c==null?void 0:c[E])==null?void 0:T.handleLLMError(_.reason)),Promise.reject(_.reason)}))}const p={generations:u,llmOutput:h.length?(y=this._combineLLMOutput)==null?void 0:y.call(this,...h):void 0};return Object.defineProperty(p,RUN_KEY,{value:c?{runIds:c==null?void 0:c.map(v=>v.runId)}:void 0,configurable:!0}),p}async _generateCached({messages:e,cache:t,llmStringKey:n,parsedOptions:r,handledOptions:o}){const c=e.map(x=>x.map(coerceMessageLikeToMessage)),u={...o.metadata,...this.getLsParams(r)},h=await CallbackManager.configure(o.callbacks,this.callbacks,o.tags,this.tags,u,this.metadata,{verbose:this.verbose}),f={options:r,invocation_params:this==null?void 0:this.invocationParams(r),batch_size:1},p=await(h==null?void 0:h.handleChatModelStart(this.toJSON(),c,o.runId,void 0,f,void 0,void 0,o.runName)),g=[],v=(await Promise.allSettled(c.map(async(x,w)=>{const T=BaseChatModel._convertInputToPromptValue(x).toString(),O=await t.lookup(T,n);return O==null&&g.push(w),O}))).map((x,w)=>({result:x,runManager:p==null?void 0:p[w]})).filter(({result:x})=>x.status==="fulfilled"&&x.value!=null||x.status==="rejected"),_=[];await Promise.all(v.map(async({result:x,runManager:w},T)=>{if(x.status==="fulfilled"){const O=x.value;return _[T]=O.map(N=>("message"in N&&isBaseMessage(N.message)&&isAIMessage(N.message)&&(N.message.usage_metadata={input_tokens:0,output_tokens:0,total_tokens:0}),N.generationInfo={...N.generationInfo,tokenUsage:{}},N)),O.length&&await(w==null?void 0:w.handleLLMNewToken(O[0].text)),w==null?void 0:w.handleLLMEnd({generations:[O]},void 0,void 0,void 0,{cached:!0})}else return await(w==null?void 0:w.handleLLMError(x.reason,void 0,void 0,void 0,{cached:!0})),Promise.reject(x.reason)}));const E={generations:_,missingPromptIndices:g,startedRunManagers:p};return Object.defineProperty(E,RUN_KEY,{value:p?{runIds:p==null?void 0:p.map(x=>x.runId)}:void 0,configurable:!0}),E}async generate(e,t,n){let r;Array.isArray(t)?r={stop:t}:r=t;const o=e.map(_=>_.map(coerceMessageLikeToMessage)),[c,u]=this._separateRunnableConfigFromCallOptionsCompat(r);if(c.callbacks=c.callbacks??n,!this.cache)return this._generateUncached(o,u,c);const{cache:h}=this,f=this._getSerializedCacheKeyParametersForCall(u),{generations:p,missingPromptIndices:g,startedRunManagers:y}=await this._generateCached({messages:o,cache:h,llmStringKey:f,parsedOptions:u,handledOptions:c});let v={};if(g.length>0){const _=await this._generateUncached(g.map(E=>o[E]),u,c,y!==void 0?g.map(E=>y==null?void 0:y[E]):void 0);await Promise.all(_.generations.map(async(E,x)=>{const w=g[x];p[w]=E;const T=BaseChatModel._convertInputToPromptValue(o[w]).toString();return h.update(T,f,E)})),v=_.llmOutput??{}}return{generations:p,llmOutput:v}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,t,n){const r=e.map(o=>o.toChatMessages());return this.generate(r,t,n)}async call(e,t,n){return(await this.generate([e.map(coerceMessageLikeToMessage)],t,n)).generations[0][0].message}async callPrompt(e,t,n){const r=e.toChatMessages();return this.call(r,t,n)}async predictMessages(e,t,n){return this.call(e,t,n)}async predict(e,t,n){const r=new HumanMessage(e),o=await this.call([r],t,n);if(typeof o.content!="string")throw new Error("Cannot use predict when output is not a string.");return o.content}withStructuredOutput(e,t){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');if(t!=null&&t.strict)throw new Error('"strict" mode is not supported for this model by default.');const n=e,r=t==null?void 0:t.name,o=n.description??"A function available to call.",c=t==null?void 0:t.method,u=t==null?void 0:t.includeRaw;if(c==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let h=r??"extract",f;isZodSchema(n)?f=[{type:"function",function:{name:h,description:o,parameters:zodToJsonSchema(n)}}]:("name"in n&&(h=n.name),f=[{type:"function",function:{name:h,description:o,parameters:n}}]);const p=this.bindTools(f),g=RunnableLambda.from(E=>{if(!E.tool_calls||E.tool_calls.length===0)throw new Error("No tool calls found in the response.");const x=E.tool_calls.find(w=>w.name===h);if(!x)throw new Error(`No tool call found with name ${h}.`);return x.args});if(!u)return p.pipe(g).withConfig({runName:"StructuredOutput"});const y=RunnablePassthrough.assign({parsed:(E,x)=>g.invoke(E.raw,x)}),v=RunnablePassthrough.assign({parsed:()=>null}),_=y.withFallbacks({fallbacks:[v]});return RunnableSequence.from([{raw:p},_]).withConfig({runName:"StructuredOutputRunnable"})}}const VERSION="0.5.0";let auto=!1,kind,fetch$1,FormData$1,File$1,ReadableStream$1,getMultipartRequestOptions,getDefaultAgent,fileFromPath,isFsReadStream;function setShims(s,e={auto:!1}){if(auto)throw new Error(`you must \`import 'groq-sdk/shims/${s.kind}'\` before importing anything else from groq-sdk`);if(kind)throw new Error(`can't \`import 'groq-sdk/shims/${s.kind}'\` after \`import 'groq-sdk/shims/${kind}'\``);auto=e.auto,kind=s.kind,fetch$1=s.fetch,FormData$1=s.FormData,File$1=s.File,ReadableStream$1=s.ReadableStream,getMultipartRequestOptions=s.getMultipartRequestOptions,getDefaultAgent=s.getDefaultAgent,fileFromPath=s.fileFromPath,isFsReadStream=s.isFsReadStream}class MultipartBody{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function getRuntime({manuallyImported:s}={}){const e=s?"You may need to use polyfills":"Add one of these imports before your first `import  from 'groq-sdk'`:\n- `import 'groq-sdk/shims/node'` (if you're running on Node)\n- `import 'groq-sdk/shims/web'` (otherwise)\n";let t,n,r,o;try{t=fetch,n=Request,r=Response,o=Headers}catch(c){throw new Error(`this environment is missing the following Web Fetch API type: ${c.message}. ${e}`)}return{kind:"web",fetch:t,Request:n,Response:r,Headers:o,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(c,u)=>({...u,body:new MultipartBody(c)}),getDefaultAgent:c=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/groq/groq-typescript#file-uploads")},isFsReadStream:c=>!1}}kind||setShims(getRuntime(),{auto:!0});class GroqError extends Error{}class APIError extends GroqError{constructor(e,t,n,r){super(`${APIError.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.error=t}static makeMessage(e,t,n){const r=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,r){if(!e)return new APIConnectionError({cause:castToError(t)});const o=t;return e===400?new BadRequestError(e,o,n,r):e===401?new AuthenticationError(e,o,n,r):e===403?new PermissionDeniedError(e,o,n,r):e===404?new NotFoundError(e,o,n,r):e===409?new ConflictError(e,o,n,r):e===422?new UnprocessableEntityError(e,o,n,r):e===429?new RateLimitError(e,o,n,r):e>=500?new InternalServerError(e,o,n,r):new APIError(e,o,n,r)}}class APIUserAbortError extends APIError{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class APIConnectionError extends APIError{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,t&&(this.cause=t)}}class APIConnectionTimeoutError extends APIConnectionError{constructor({message:e}={}){super({message:e??"Request timed out."})}}class BadRequestError extends APIError{constructor(){super(...arguments),this.status=400}}class AuthenticationError extends APIError{constructor(){super(...arguments),this.status=401}}class PermissionDeniedError extends APIError{constructor(){super(...arguments),this.status=403}}class NotFoundError extends APIError{constructor(){super(...arguments),this.status=404}}class ConflictError extends APIError{constructor(){super(...arguments),this.status=409}}class UnprocessableEntityError extends APIError{constructor(){super(...arguments),this.status=422}}class RateLimitError extends APIError{constructor(){super(...arguments),this.status=429}}class InternalServerError extends APIError{}class Stream{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;const r=new SSEDecoder;async function*o(){if(!e.body)throw t.abort(),new GroqError("Attempted to iterate over a response with no body");const u=new LineDecoder,h=readableStreamAsyncIterable(e.body);for await(const f of h)for(const p of u.decode(f)){const g=r.decode(p);g&&(yield g)}for(const f of u.flush()){const p=r.decode(f);p&&(yield p)}}async function*c(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let u=!1;try{for await(const h of o())if(!u){if(h.data.startsWith("[DONE]")){u=!0;continue}if(h.event===null){let f;try{f=JSON.parse(h.data)}catch(p){throw console.error("Could not parse message into JSON:",h.data),console.error("From chunk:",h.raw),p}if(f&&f.error)throw new APIError(void 0,f.error,void 0,void 0);yield f}}u=!0}catch(h){if(h instanceof Error&&h.name==="AbortError")return;throw h}finally{u||t.abort()}}return new Stream(c,t)}static fromReadableStream(e,t){let n=!1;async function*r(){const c=new LineDecoder,u=readableStreamAsyncIterable(e);for await(const h of u)for(const f of c.decode(h))yield f;for(const h of c.flush())yield h}async function*o(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let c=!1;try{for await(const u of r())c||u&&(yield JSON.parse(u));c=!0}catch(u){if(u instanceof Error&&u.name==="AbortError")return;throw u}finally{c||t.abort()}}return new Stream(o,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),r=o=>({next:()=>{if(o.length===0){const c=n.next();e.push(c),t.push(c)}return o.shift()}});return[new Stream(()=>r(e),this.controller),new Stream(()=>r(t),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new ReadableStream$1({async start(){t=e[Symbol.asyncIterator]()},async pull(r){try{const{value:o,done:c}=await t.next();if(c)return r.close();const u=n.encode(JSON.stringify(o)+`
`);r.enqueue(u)}catch(o){r.error(o)}},async cancel(){var r;await((r=t.return)==null?void 0:r.call(t))}})}}class SSEDecoder{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=partition(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}}class LineDecoder{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const n=LineDecoder.NEWLINE_CHARS.has(t[t.length-1]||"");let r=t.split(LineDecoder.NEWLINE_REGEXP);return r.length===1&&!n?(this.buffer.push(r[0]),[]):(this.buffer.length>0&&(r=[this.buffer.join("")+r[0],...r.slice(1)],this.buffer=[]),n||(this.buffer=[r.pop()||""]),r)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new GroqError(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new GroqError(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new GroqError("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}LineDecoder.NEWLINE_CHARS=new Set([`
`,"\r","\v","\f","","","","","\u2028","\u2029"]);LineDecoder.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;function partition(s,e){const t=s.indexOf(e);return t!==-1?[s.substring(0,t),e,s.substring(t+e.length)]:[s,"",""]}function readableStreamAsyncIterable(s){if(s[Symbol.asyncIterator])return s;const e=s.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const isResponseLike=s=>s!=null&&typeof s=="object"&&typeof s.url=="string"&&typeof s.blob=="function",isFileLike=s=>s!=null&&typeof s=="object"&&typeof s.name=="string"&&typeof s.lastModified=="number"&&isBlobLike(s),isBlobLike=s=>s!=null&&typeof s=="object"&&typeof s.size=="number"&&typeof s.type=="string"&&typeof s.text=="function"&&typeof s.slice=="function"&&typeof s.arrayBuffer=="function",isUploadable=s=>isFileLike(s)||isResponseLike(s)||isFsReadStream(s);async function toFile(s,e,t){var r;if(s=await s,t??(t=isFileLike(s)?{lastModified:s.lastModified,type:s.type}:{}),isResponseLike(s)){const o=await s.blob();return e||(e=new URL(s.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new File$1([o],e,t)}const n=await getBytes(s);if(e||(e=getName(s)??"unknown_file"),!t.type){const o=(r=n[0])==null?void 0:r.type;typeof o=="string"&&(t={...t,type:o})}return new File$1(n,e,t)}async function getBytes(s){var t;let e=[];if(typeof s=="string"||ArrayBuffer.isView(s)||s instanceof ArrayBuffer)e.push(s);else if(isBlobLike(s))e.push(await s.arrayBuffer());else if(isAsyncIterableIterator(s))for await(const n of s)e.push(n);else throw new Error(`Unexpected data type: ${typeof s}; constructor: ${(t=s==null?void 0:s.constructor)==null?void 0:t.name}; props: ${propsForError(s)}`);return e}function propsForError(s){return`[${Object.getOwnPropertyNames(s).map(t=>`"${t}"`).join(", ")}]`}function getName(s){var e;return getStringFromMaybeBuffer(s.name)||getStringFromMaybeBuffer(s.filename)||((e=getStringFromMaybeBuffer(s.path))==null?void 0:e.split(/[\\/]/).pop())}const getStringFromMaybeBuffer=s=>{if(typeof s=="string")return s;if(typeof Buffer<"u"&&s instanceof Buffer)return String(s)},isAsyncIterableIterator=s=>s!=null&&typeof s=="object"&&typeof s[Symbol.asyncIterator]=="function",isMultipartBody=s=>s&&typeof s=="object"&&s.body&&s[Symbol.toStringTag]==="MultipartBody",multipartFormRequestOptions=async s=>{const e=await createForm(s.body);return getMultipartRequestOptions(e,s)},createForm=async s=>{const e=new FormData$1;return await Promise.all(Object.entries(s||{}).map(([t,n])=>addFormValue(e,t,n))),e},addFormValue=async(s,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")s.append(e,String(t));else if(isUploadable(t)){const n=await toFile(t);s.append(e,n)}else if(Array.isArray(t))await Promise.all(t.map(n=>addFormValue(s,e+"[]",n)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([n,r])=>addFormValue(s,`${e}[${n}]`,r)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var define_process_env_default={};async function defaultParseResponse(s){const{response:e}=s;if(s.options.stream)return debug("response",e.status,e.url,e.headers,e.body),s.options.__streamClass?s.options.__streamClass.fromSSEResponse(e,s.controller):Stream.fromSSEResponse(e,s.controller);if(e.status===204)return null;if(s.options.__binaryResponse)return e;const t=e.headers.get("content-type");if((t==null?void 0:t.includes("application/json"))||(t==null?void 0:t.includes("application/vnd.api+json"))){const o=await e.json();return debug("response",e.status,e.url,e.headers,o),o}const r=await e.text();return debug("response",e.status,e.url,e.headers,r),r}class APIPromise extends Promise{constructor(e,t=defaultParseResponse){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new APIPromise(this.responsePromise,async t=>e(await this.parseResponse(t)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class APIClient{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e4,httpAgent:r,fetch:o}){this.baseURL=e,this.maxRetries=validatePositiveInteger("maxRetries",t),this.timeout=validatePositiveInteger("timeout",n),this.httpAgent=r,this.fetch=o??fetch$1}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...getPlatformHeaders(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${uuid4()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(async r=>{const o=r&&isBlobLike(r==null?void 0:r.body)?new DataView(await r.body.arrayBuffer()):(r==null?void 0:r.body)instanceof DataView?r.body:(r==null?void 0:r.body)instanceof ArrayBuffer?new DataView(r.body):r&&ArrayBuffer.isView(r==null?void 0:r.body)?new DataView(r.body.buffer):r==null?void 0:r.body;return{method:e,path:t,...r,body:o}}))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e){var _;const{method:t,path:n,query:r,headers:o={}}=e,c=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:isMultipartBody(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,u=this.calculateContentLength(c),h=this.buildURL(n,r);"timeout"in e&&validatePositiveInteger("timeout",e.timeout);const f=e.timeout??this.timeout,p=e.httpAgent??this.httpAgent??getDefaultAgent(h),g=f+1e3;typeof((_=p==null?void 0:p.options)==null?void 0:_.timeout)=="number"&&g>(p.options.timeout??0)&&(p.options.timeout=g),this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const y=this.buildHeaders({options:e,headers:o,contentLength:u});return{req:{method:t,...c&&{body:c},headers:y,...p&&{agent:p},signal:e.signal??null},url:h,timeout:f}}buildHeaders({options:e,headers:t,contentLength:n}){const r={};n&&(r["content-length"]=n);const o=this.defaultHeaders(e);return applyHeadersMut(r,o),applyHeadersMut(r,t),isMultipartBody(e.body)&&kind!=="node"&&delete r["content-type"],this.validateHeaders(r,t),r}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,n,r){return APIError.generate(e,t,n,r)}request(e,t=null){return new APIPromise(this.makeRequest(e,t))}async makeRequest(e,t){var p,g;const n=await e;t==null&&(t=n.maxRetries??this.maxRetries),await this.prepareOptions(n);const{req:r,url:o,timeout:c}=this.buildRequest(n);if(await this.prepareRequest(r,{url:o,options:n}),debug("request",o,n,r.headers),(p=n.signal)!=null&&p.aborted)throw new APIUserAbortError;const u=new AbortController,h=await this.fetchWithTimeout(o,r,c,u).catch(castToError);if(h instanceof Error){if((g=n.signal)!=null&&g.aborted)throw new APIUserAbortError;if(t)return this.retryRequest(n,t);throw h.name==="AbortError"?new APIConnectionTimeoutError:new APIConnectionError({cause:h})}const f=createResponseHeaders(h.headers);if(!h.ok){if(t&&this.shouldRetry(h)){const w=`retrying, ${t} attempts remaining`;return debug(`response (error; ${w})`,h.status,o,f),this.retryRequest(n,t,f)}const y=await h.text().catch(w=>castToError(w).message),v=safeJSON(y),_=v?void 0:y;throw debug(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,h.status,o,f,_),this.makeStatusError(h.status,v,_,f)}return{response:h,options:n,controller:u}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new PagePromise(this,n,e)}buildURL(e,t){const n=isAbsoluteURL(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return isEmptyObj(r)||(t={...r,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new GroqError(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,r){const{signal:o,...c}=t||{};o&&o.addEventListener("abort",()=>r.abort());const u=setTimeout(()=>r.abort(),n);return this.getRequestClient().fetch.call(void 0,e,{signal:r.signal,...c}).finally(()=>{clearTimeout(u)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n){let r;const o=n==null?void 0:n["retry-after-ms"];if(o){const u=parseFloat(o);Number.isNaN(u)||(r=u)}const c=n==null?void 0:n["retry-after"];if(c&&!r){const u=parseFloat(c);Number.isNaN(u)?r=Date.parse(c)-Date.now():r=u*1e3}if(!(r&&0<=r&&r<60*1e3)){const u=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,u)}return await sleep(r),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const o=t-e,c=Math.min(.5*Math.pow(2,o),8),u=1-Math.random()*.25;return c*u*1e3}getUserAgent(){return`${this.constructor.name}/JS ${VERSION}`}}class PagePromise extends APIPromise{constructor(e,t,n){super(t,async r=>new n(e,r.response,await defaultParseResponse(r),r.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const createResponseHeaders=s=>new Proxy(Object.fromEntries(s.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),getPlatformProperties=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":VERSION,"X-Stainless-OS":normalizePlatform(Deno.build.os),"X-Stainless-Arch":normalizeArch(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":VERSION,"X-Stainless-OS":normalizePlatform(process.platform),"X-Stainless-Arch":normalizeArch(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const s=getBrowserInfo();return s?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${s.browser}`,"X-Stainless-Runtime-Version":s.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function getBrowserInfo(){if(typeof navigator>"u"||!navigator)return null;const s=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of s){const n=t.exec(navigator.userAgent);if(n){const r=n[1]||0,o=n[2]||0,c=n[3]||0;return{browser:e,version:`${r}.${o}.${c}`}}}return null}const normalizeArch=s=>s==="x32"?"x32":s==="x86_64"||s==="x64"?"x64":s==="arm"?"arm":s==="aarch64"||s==="arm64"?"arm64":s?`other:${s}`:"unknown",normalizePlatform=s=>(s=s.toLowerCase(),s.includes("ios")?"iOS":s==="android"?"Android":s==="darwin"?"MacOS":s==="win32"?"Windows":s==="freebsd"?"FreeBSD":s==="openbsd"?"OpenBSD":s==="linux"?"Linux":s?`Other:${s}`:"Unknown");let _platformHeaders;const getPlatformHeaders=()=>_platformHeaders??(_platformHeaders=getPlatformProperties()),safeJSON=s=>{try{return JSON.parse(s)}catch{return}},startsWithSchemeRegexp=new RegExp("^(?:[a-z]+:)?//","i"),isAbsoluteURL=s=>startsWithSchemeRegexp.test(s),sleep=s=>new Promise(e=>setTimeout(e,s)),validatePositiveInteger=(s,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new GroqError(`${s} must be an integer`);if(e<0)throw new GroqError(`${s} must be a positive integer`);return e},castToError=s=>s instanceof Error?s:new Error(s),readEnv=s=>{var e,t,n,r;if(typeof process<"u")return((e=define_process_env_default==null?void 0:define_process_env_default[s])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(r=(n=(t=Deno.env)==null?void 0:t.get)==null?void 0:n.call(t,s))==null?void 0:r.trim()};function isEmptyObj(s){if(!s)return!0;for(const e in s)return!1;return!0}function hasOwn(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function applyHeadersMut(s,e){for(const t in e){if(!hasOwn(e,t))continue;const n=t.toLowerCase();if(!n)continue;const r=e[t];r===null?delete s[n]:r!==void 0&&(s[n]=r)}}function debug(s,...e){typeof process<"u"&&(define_process_env_default==null?void 0:define_process_env_default.DEBUG)==="true"&&console.log(`Groq:DEBUG:${s}`,...e)}const uuid4=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const e=Math.random()*16|0;return(s==="x"?e:e&3|8).toString(16)}),isRunningInBrowser=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";class APIResource{constructor(e){this._client=e}}class Transcriptions extends APIResource{create(e,t){return this._client.post("/openai/v1/audio/transcriptions",multipartFormRequestOptions({body:e,...t}))}}Transcriptions||(Transcriptions={});class Translations extends APIResource{create(e,t){return this._client.post("/openai/v1/audio/translations",multipartFormRequestOptions({body:e,...t}))}}Translations||(Translations={});class Audio extends APIResource{constructor(){super(...arguments),this.transcriptions=new Transcriptions(this._client),this.translations=new Translations(this._client)}}(function(s){s.Transcriptions=Transcriptions,s.Translations=Translations})(Audio||(Audio={}));let Completions$1=class extends APIResource{create(e,t){return this._client.post("/openai/v1/chat/completions",{body:e,...t,stream:e.stream??!1})}};Completions$1||(Completions$1={});class Chat extends APIResource{constructor(){super(...arguments),this.completions=new Completions$1(this._client)}}(function(s){s.Completions=Completions$1})(Chat||(Chat={}));class Completions extends APIResource{}Completions||(Completions={});class Embeddings extends APIResource{create(e,t){return this._client.post("/openai/v1/embeddings",{body:e,...t})}}Embeddings||(Embeddings={});class Models extends APIResource{retrieve(e,t){return this._client.get(`/openai/v1/models/${e}`,t)}list(e){return this._client.get("/openai/v1/models",e)}delete(e,t){return this._client.delete(`/openai/v1/models/${e}`,t)}}Models||(Models={});var _a;class Groq extends APIClient{constructor({baseURL:e=readEnv("GROQ_BASE_URL"),apiKey:t=readEnv("GROQ_API_KEY"),...n}={}){if(t===void 0)throw new GroqError("The GROQ_API_KEY environment variable is missing or empty; either provide it, or instantiate the Groq client with an apiKey option, like new Groq({ apiKey: 'My API Key' }).");const r={apiKey:t,...n,baseURL:e||"https://api.groq.com"};if(!r.dangerouslyAllowBrowser&&isRunningInBrowser())throw new GroqError(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Groq({ apiKey, dangerouslyAllowBrowser: true })`);super({baseURL:r.baseURL,timeout:r.timeout??6e4,httpAgent:r.httpAgent,maxRetries:r.maxRetries,fetch:r.fetch}),this.completions=new Completions(this),this.chat=new Chat(this),this.embeddings=new Embeddings(this),this.audio=new Audio(this),this.models=new Models(this),this._options=r,this.apiKey=t}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}}_a=Groq;Groq.Groq=_a;Groq.GroqError=GroqError;Groq.APIError=APIError;Groq.APIConnectionError=APIConnectionError;Groq.APIConnectionTimeoutError=APIConnectionTimeoutError;Groq.APIUserAbortError=APIUserAbortError;Groq.NotFoundError=NotFoundError;Groq.ConflictError=ConflictError;Groq.RateLimitError=RateLimitError;Groq.BadRequestError=BadRequestError;Groq.AuthenticationError=AuthenticationError;Groq.InternalServerError=InternalServerError;Groq.PermissionDeniedError=PermissionDeniedError;Groq.UnprocessableEntityError=UnprocessableEntityError;Groq.toFile=toFile;Groq.fileFromPath=fileFromPath;(function(s){s.Completions=Completions,s.Chat=Chat,s.Embeddings=Embeddings,s.Audio=Audio,s.Models=Models})(Groq||(Groq={}));class BaseLLMOutputParser extends Runnable{parseResultWithPrompt(e,t,n){return this.parseResult(e,n)}_baseMessageToString(e){return typeof e.content=="string"?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,t){return typeof e=="string"?this._callWithConfig(async(n,r)=>this.parseResult([{text:n}],r==null?void 0:r.callbacks),e,{...t,runType:"parser"}):this._callWithConfig(async(n,r)=>this.parseResult([{message:n,text:this._baseMessageToString(n)}],r==null?void 0:r.callbacks),e,{...t,runType:"parser"})}}class BaseOutputParser extends BaseLLMOutputParser{parseResult(e,t){return this.parse(e[0].text,t)}async parseWithPrompt(e,t,n){return this.parse(e,n)}_type(){throw new Error("_type not implemented")}}class OutputParserException extends Error{constructor(e,t,n,r=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=t,this.observation=n,this.sendToLLM=r,r&&(n===void 0||t===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");addLangChainErrorFields(this,"OUTPUT_PARSING_FAILURE")}}function deepCompareStrict(s,e){const t=typeof s;if(t!==typeof e)return!1;if(Array.isArray(s)){if(!Array.isArray(e))return!1;const n=s.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(!deepCompareStrict(s[r],e[r]))return!1;return!0}if(t==="object"){if(!s||!e)return s===e;const n=Object.keys(s),r=Object.keys(e);if(n.length!==r.length)return!1;for(const c of n)if(!deepCompareStrict(s[c],e[c]))return!1;return!0}return s===e}class BaseTransformOutputParser extends BaseOutputParser{async*_transform(e){for await(const t of e)typeof t=="string"?yield this.parseResult([{text:t}]):yield this.parseResult([{message:t,text:this._baseMessageToString(t)}])}async*transform(e,t){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...t,runType:"parser"})}}class BaseCumulativeTransformOutputParser extends BaseTransformOutputParser{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=(e==null?void 0:e.diff)??this.diff}async*_transform(e){let t,n;for await(const r of e){if(typeof r!="string"&&typeof r.content!="string")throw new Error("Cannot handle non-string output.");let o;if(isBaseMessageChunk(r)){if(typeof r.content!="string")throw new Error("Cannot handle non-string message output.");o=new ChatGenerationChunk({message:r,text:r.content})}else if(isBaseMessage(r)){if(typeof r.content!="string")throw new Error("Cannot handle non-string message output.");o=new ChatGenerationChunk({message:convertToChunk(r),text:r.content})}else o=new GenerationChunk({text:r});n===void 0?n=o:n=n.concat(o);const c=await this.parsePartialResult([n]);c!=null&&!deepCompareStrict(c,t)&&(this.diff?yield this._diff(t,c):yield c,t=c)}}getFormatInstructions(){return""}}class StructuredOutputParser extends BaseOutputParser{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){const t=z.object(Object.fromEntries(Object.entries(e).map(([n,r])=>[n,z.string().describe(r)])));return new this(t)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(zodToJsonSchema(this.schema))}
\`\`\`
`}async parse(e){try{const n=(e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(r,o)=>`"${o.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(n))}catch(t){throw new OutputParserException(`Failed to parse. Text: "${e}". Error: ${t}`,e)}}}class JsonOutputParser extends BaseCumulativeTransformOutputParser{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(e,t){if(t)return e?compare(e,t):[{op:"replace",path:"",value:t}]}async parsePartialResult(e){return parseJsonMarkdown(e[0].text)}async parse(e){return parseJsonMarkdown(e,JSON.parse)}getFormatInstructions(){return""}}function parseToolCall(s,e){if(s.function===void 0)return;let t;if(e!=null&&e.partial)try{t=parsePartialJson(s.function.arguments??"{}")}catch{return}else try{t=JSON.parse(s.function.arguments)}catch(r){throw new OutputParserException([`Function "${s.function.name}" arguments:`,"",s.function.arguments,"","are not valid JSON.",`Error: ${r.message}`].join(`
`))}const n={name:s.function.name,args:t,type:"tool_call"};return e!=null&&e.returnId&&(n.id=s.id),n}function convertLangChainToolCallToOpenAI(s){if(s.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:s.id,type:"function",function:{name:s.name,arguments:JSON.stringify(s.args)}}}function makeInvalidToolCall(s,e){var t,n;return{name:(t=s.function)==null?void 0:t.name,args:(n=s.function)==null?void 0:n.arguments,id:s.id,error:e,type:"invalid_tool_call"}}class JsonOutputToolsParser extends BaseCumulativeTransformOutputParser{static lc_name(){return"JsonOutputToolsParser"}constructor(e){super(e),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=(e==null?void 0:e.returnId)??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(e){return await this.parsePartialResult(e,!1)}async parsePartialResult(e,t=!0){var c;const n=e[0].message;let r;if(isAIMessage(n)&&((c=n.tool_calls)!=null&&c.length)?r=n.tool_calls.map(u=>{const{id:h,...f}=u;return this.returnId?{id:h,...f}:f}):n.additional_kwargs.tool_calls!==void 0&&(r=JSON.parse(JSON.stringify(n.additional_kwargs.tool_calls)).map(h=>parseToolCall(h,{returnId:this.returnId,partial:t}))),!r)return[];const o=[];for(const u of r)if(u!==void 0){const h={type:u.name,args:u.args,id:u.id};o.push(h)}return o}}class JsonOutputKeyToolsParser extends JsonOutputToolsParser{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;const t=await this.zodSchema.safeParseAsync(e);if(t.success)return t.data;throw new OutputParserException(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(t.error.errors)}`,JSON.stringify(e,null,2))}async parsePartialResult(e){const n=(await super.parsePartialResult(e)).filter(o=>o.type===this.keyName);let r=n;if(n.length)return this.returnId||(r=n.map(o=>o.args)),this.returnSingle?r[0]:r}async parseResult(e){const n=(await super.parsePartialResult(e,!1)).filter(c=>c.type===this.keyName);let r=n;return n.length?(this.returnId||(r=n.map(c=>c.args)),this.returnSingle?this._validateResult(r[0]):await Promise.all(r.map(c=>this._validateResult(c)))):void 0}}function convertToOpenAIFunction(s,e){return{name:s.name,description:s.description,parameters:zodToJsonSchema(s.schema)}}function convertToOpenAITool(s,e){let t;return isLangChainTool(s)?t={type:"function",function:convertToOpenAIFunction(s)}:t=s,t}function isStructuredTool(s){return s!==void 0&&Array.isArray(s.lc_namespace)}function isRunnableToolLike(s){return s!==void 0&&Runnable.isRunnable(s)&&"lc_name"in s.constructor&&typeof s.constructor.lc_name=="function"&&s.constructor.lc_name()==="RunnableToolLike"}function isStructuredToolParams(s){return!!s&&typeof s=="object"&&"name"in s&&"schema"in s&&isZodSchema(s.schema)}function isLangChainTool(s){return isStructuredToolParams(s)||isRunnableToolLike(s)||isStructuredTool(s)}function messageToGroqRole(s){const e=s._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";default:throw new Error(`Unknown message type: ${e}`)}}function convertMessagesToGroqParams(s){return s.map(e=>{var n;if(typeof e.content!="string")throw new Error("Non string message content not supported");const t={role:messageToGroqRole(e),content:e.content,name:e.name,function_call:e.additional_kwargs.function_call,tool_calls:e.additional_kwargs.tool_calls,tool_call_id:e.tool_call_id};return isAIMessage(e)&&((n=e.tool_calls)!=null&&n.length)?t.tool_calls=e.tool_calls.map(convertLangChainToolCallToOpenAI):(e.additional_kwargs.tool_calls!=null&&(t.tool_calls=e.additional_kwargs.tool_calls),e.tool_call_id!=null&&(t.tool_call_id=e.tool_call_id)),t})}function groqResponseToChatMessage(s,e){const t=s.tool_calls;switch(s.role){case"assistant":{const n=[],r=[];for(const o of t??[])try{n.push(parseToolCall(o,{returnId:!0}))}catch(c){r.push(makeInvalidToolCall(o,c.message))}return new AIMessage({content:s.content||"",additional_kwargs:{tool_calls:t},tool_calls:n,invalid_tool_calls:r,usage_metadata:e})}default:return new ChatMessage(s.content||"",s.role??"unknown")}}function _convertDeltaToolCallToToolCallChunk(s,e){if(s!=null&&s.length)return s.map(t=>{var n,r;return{id:t.id,name:(n=t.function)==null?void 0:n.name,args:(r=t.function)==null?void 0:r.arguments,type:"tool_call_chunk",index:e}})}function _convertDeltaToMessageChunk(s,e,t){const{role:n}=s,r=s.content??"";let o;s.function_call?o={function_call:s.function_call}:s.tool_calls?o={tool_calls:s.tool_calls}:o={};let c,u;if(t!=null&&t.usage&&(c={input_tokens:t.usage.prompt_tokens,output_tokens:t.usage.completion_tokens,total_tokens:t.usage.total_tokens},u=t.id),n==="user")return{message:new HumanMessageChunk({content:r})};if(n==="assistant"){const h=_convertDeltaToolCallToToolCallChunk(s.tool_calls,e);return{message:new AIMessageChunk({content:r,additional_kwargs:o,tool_call_chunks:h?h.map(f=>({type:f.type,args:f.args,index:f.index})):void 0,usage_metadata:c,id:u}),toolCallData:h?h.map(f=>({id:f.id??"",name:f.name??"",index:f.index??e,type:"tool_call_chunk"})):void 0}}else return n==="system"?{message:new SystemMessageChunk({content:r})}:{message:new ChatMessageChunk({content:r,role:n})}}class ChatGroq extends BaseChatModel{static lc_name(){return"ChatGroq"}_llmType(){return"groq"}get lc_secrets(){return{apiKey:"GROQ_API_KEY"}}constructor(e){super(e??{}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models","groq"]}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"mixtral-8x7b-32768"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"mixtral-8x7b-32768"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0});const t=(e==null?void 0:e.apiKey)||getEnvironmentVariable("GROQ_API_KEY");if(!t)throw new Error('Groq API key not found. Please set the GROQ_API_KEY environment variable or provide the key into "apiKey"');const n={"User-Agent":"langchainjs",...(e==null?void 0:e.defaultHeaders)??{}};this.client=new Groq({apiKey:t,dangerouslyAllowBrowser:!0,baseURL:e==null?void 0:e.baseUrl,timeout:e==null?void 0:e.timeout,httpAgent:e==null?void 0:e.httpAgent,fetch:e==null?void 0:e.fetch,maxRetries:0,defaultHeaders:n,defaultQuery:e==null?void 0:e.defaultQuery}),this.apiKey=t,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.modelName=(e==null?void 0:e.model)??(e==null?void 0:e.modelName)??this.model,this.model=this.modelName,this.streaming=(e==null?void 0:e.streaming)??this.streaming,this.stop=(e==null?void 0:e.stopSequences)??(typeof(e==null?void 0:e.stop)=="string"?[e.stop]:e==null?void 0:e.stop)??[],this.stopSequences=this.stop,this.maxTokens=e==null?void 0:e.maxTokens}getLsParams(e){const t=this.invocationParams(e);return{ls_provider:"groq",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:t.temperature??this.temperature,ls_max_tokens:t.max_tokens??this.maxTokens,ls_stop:e.stop}}async completionWithRetry(e,t){return this.caller.call(async()=>this.client.chat.completions.create(e,t))}invocationParams(e){const t=super.invocationParams(e);return e.tool_choice!==void 0&&(t.tool_choice=e.tool_choice),e.tools!==void 0&&(t.tools=e.tools),e.response_format!==void 0&&(t.response_format=e.response_format),{...t,stop:e.stop??this.stopSequences,model:this.model,temperature:this.temperature,max_tokens:this.maxTokens}}bindTools(e,t){return this.bind({tools:e.map(n=>convertToOpenAITool(n)),...t})}async*_streamResponseChunks(e,t,n){var p,g;const r=this.invocationParams(t),o=convertMessagesToGroqParams(e),c=await this.completionWithRetry({...r,messages:o,stream:!0},{signal:t==null?void 0:t.signal,headers:t==null?void 0:t.headers});let u="";const h=[];let f;for await(const y of c){f=y;const v=y==null?void 0:y.choices[0];if(!v)continue;(p=v.delta)!=null&&p.role&&(u=v.delta.role);const{message:_,toolCallData:E}=_convertDeltaToMessageChunk({...v.delta,role:u},v.index,y.x_groq);if(E){const w=E.filter(T=>h.every(O=>O.id!==T.id));h.push(...w),yield new ChatGenerationChunk({message:new AIMessageChunk({content:"",tool_call_chunks:w}),text:""})}const x=new ChatGenerationChunk({message:_,text:v.delta.content??"",generationInfo:{finishReason:v.finish_reason}});yield x,n==null||n.handleLLMNewToken(x.text??"")}if(f&&("choices"in f&&delete f.choices,yield new ChatGenerationChunk({message:new AIMessageChunk({content:"",response_metadata:f}),text:""})),(g=t.signal)!=null&&g.aborted)throw new Error("AbortError")}async _generate(e,t,n){var r;if(this.streaming){const o={},c=this._streamResponseChunks(e,t,n),u={};for await(const f of c){const p=((r=f.generationInfo)==null?void 0:r.completion)??0;u[p]===void 0?u[p]=f:u[p]=u[p].concat(f)}return{generations:Object.entries(u).sort(([f],[p])=>parseInt(f,10)-parseInt(p,10)).map(([f,p])=>p),llmOutput:{estimatedTokenUsage:o}}}else return this._generateNonStreaming(e,t,n)}async _generateNonStreaming(e,t,n){var f;const r={},o=this.invocationParams(t),c=convertMessagesToGroqParams(e),u=await this.completionWithRetry({...o,stream:!1,messages:c},{signal:t==null?void 0:t.signal,headers:t==null?void 0:t.headers});if("usage"in u&&u.usage){const{completion_tokens:p,prompt_tokens:g,total_tokens:y}=u.usage;p&&(r.completionTokens=(r.completionTokens??0)+p),g&&(r.promptTokens=(r.promptTokens??0)+g),y&&(r.totalTokens=(r.totalTokens??0)+y)}const h=[];if("choices"in u&&u.choices)for(const p of u.choices){const g=((f=p.message)==null?void 0:f.content)??"";let y;r.totalTokens!==void 0&&(y={input_tokens:r.promptTokens??0,output_tokens:r.completionTokens??0,total_tokens:r.totalTokens});const v={text:g,message:groqResponseToChatMessage(p.message??{role:"assistant"},y)};v.generationInfo={...p.finish_reason?{finish_reason:p.finish_reason}:{},...p.logprobs?{logprobs:p.logprobs}:{}},h.push(v)}return{generations:h,llmOutput:{tokenUsage:r}}}withStructuredOutput(e,t){const n=e,r=t==null?void 0:t.name,o=t==null?void 0:t.method,c=t==null?void 0:t.includeRaw;let u=r??"extract",h,f;if(o==="jsonMode")f=this.bind({response_format:{type:"json_object"}}),isZodSchema(n)?h=StructuredOutputParser.fromZodSchema(n):h=new JsonOutputParser;else if(isZodSchema(n)){const v=zodToJsonSchema(n);f=this.bind({tools:[{type:"function",function:{name:u,description:v.description,parameters:v}}],tool_choice:{type:"function",function:{name:u}}}),h=new JsonOutputKeyToolsParser({returnSingle:!0,keyName:u,zodSchema:n})}else{let v;typeof n.name=="string"&&typeof n.parameters=="object"&&n.parameters!=null?(v=n,u=n.name):(u=n.title??u,v={name:u,description:n.description??"",parameters:n}),f=this.bind({tools:[{type:"function",function:v}],tool_choice:{type:"function",function:{name:u}}}),h=new JsonOutputKeyToolsParser({returnSingle:!0,keyName:u})}if(!c)return f.pipe(h).withConfig({runName:"ChatGroqStructuredOutput"});const p=RunnablePassthrough.assign({parsed:(v,_)=>h.invoke(v.raw,_)}),g=RunnablePassthrough.assign({parsed:()=>null}),y=p.withFallbacks({fallbacks:[g]});return RunnableSequence.from([{raw:f},y]).withConfig({runName:"ChatGroqStructuredOutput"})}}function commonjsRequire(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,function(module,exports){(function(e,t){module.exports=e.pdfjsLib=t()})(globalThis,()=>(()=>{var __webpack_modules__=[,(s,e)=>{var mt;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=B,e.bytesToString=Re,e.createValidAbsoluteUrl=Y,e.getModificationDate=qe,e.getUuid=ct,e.getVerbosityLevel=V,e.info=Z,e.isArrayBuffer=pe,e.isArrayEqual=Ge,e.isNodeJS=void 0,e.normalizeUnicode=rt,e.objectFromMap=$e,e.objectSize=Ne,e.setVerbosityLevel=ae,e.shadow=U,e.string32=Ie,e.stringToBytes=Ce,e.stringToPDFString=Me,e.stringToUTF8String=Be,e.unreachable=ne,e.utf8StringToString=Le,e.warn=G;const t=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=t;const n=[1,0,0,1,0,0];e.IDENTITY_MATRIX=n;const r=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=r;const o=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=o;const c=1.35;e.LINE_FACTOR=c;const u=.35;e.LINE_DESCENT_FACTOR=u;const h=u/c;e.BASELINE_FACTOR=h;const f={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=f;const p={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=p;const g="pdfjs_internal_editor_";e.AnnotationEditorPrefix=g;const y={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=y;const v={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=v;const _={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=_;const E={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=E;const x={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=x;const w={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=w;const T={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=T;const O={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=O;const N={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=N;const A={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=A;const I={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=I;const k={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=k;const M={O:"PageOpen",C:"PageClose"};e.PageActionEventType=M;const L={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=L;const H={NONE:0,BINARY:1};e.CMapCompressionType=H;const D={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=D;const q={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=q;let J=L.WARNINGS;function ae(Fe){Number.isInteger(Fe)&&(J=Fe)}function V(){return J}function Z(Fe){J>=L.INFOS&&console.log(`Info: ${Fe}`)}function G(Fe){J>=L.WARNINGS&&console.log(`Warning: ${Fe}`)}function ne(Fe){throw new Error(Fe)}function B(Fe,be){Fe||ne(be)}function F(Fe){switch(Fe==null?void 0:Fe.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Y(Fe,be=null,ye=null){if(!Fe)return null;try{if(ye&&typeof Fe=="string"){if(ye.addDefaultProtocol&&Fe.startsWith("www.")){const xt=Fe.match(/\./g);(xt==null?void 0:xt.length)>=2&&(Fe=`http://${Fe}`)}if(ye.tryConvertEncoding)try{Fe=Be(Fe)}catch{}}const tt=be?new URL(Fe,be):new URL(Fe);if(F(tt))return tt}catch{}return null}function U(Fe,be,ye,tt=!1){return Object.defineProperty(Fe,be,{value:ye,enumerable:!tt,configurable:!0,writable:!1}),ye}const C=function(){function be(ye,tt){this.constructor===be&&ne("Cannot initialize BaseException."),this.message=ye,this.name=tt}return be.prototype=new Error,be.constructor=be,be}();e.BaseException=C;class P extends C{constructor(be,ye){super(be,"PasswordException"),this.code=ye}}e.PasswordException=P;class $ extends C{constructor(be,ye){super(be,"UnknownErrorException"),this.details=ye}}e.UnknownErrorException=$;class W extends C{constructor(be){super(be,"InvalidPDFException")}}e.InvalidPDFException=W;class te extends C{constructor(be){super(be,"MissingPDFException")}}e.MissingPDFException=te;class ee extends C{constructor(be,ye){super(be,"UnexpectedResponseException"),this.status=ye}}e.UnexpectedResponseException=ee;class ce extends C{constructor(be){super(be,"FormatError")}}e.FormatError=ce;class he extends C{constructor(be){super(be,"AbortException")}}e.AbortException=he;function Re(Fe){(typeof Fe!="object"||(Fe==null?void 0:Fe.length)===void 0)&&ne("Invalid argument for bytesToString");const be=Fe.length,ye=8192;if(be<ye)return String.fromCharCode.apply(null,Fe);const tt=[];for(let xt=0;xt<be;xt+=ye){const vt=Math.min(xt+ye,be),oe=Fe.subarray(xt,vt);tt.push(String.fromCharCode.apply(null,oe))}return tt.join("")}function Ce(Fe){typeof Fe!="string"&&ne("Invalid argument for stringToBytes");const be=Fe.length,ye=new Uint8Array(be);for(let tt=0;tt<be;++tt)ye[tt]=Fe.charCodeAt(tt)&255;return ye}function Ie(Fe){return String.fromCharCode(Fe>>24&255,Fe>>16&255,Fe>>8&255,Fe&255)}function Ne(Fe){return Object.keys(Fe).length}function $e(Fe){const be=Object.create(null);for(const[ye,tt]of Fe)be[ye]=tt;return be}function ge(){const Fe=new Uint8Array(4);return Fe[0]=1,new Uint32Array(Fe.buffer,0,1)[0]===1}function _e(){try{return new Function(""),!0}catch{return!1}}class X{static get isLittleEndian(){return U(this,"isLittleEndian",ge())}static get isEvalSupported(){return U(this,"isEvalSupported",_e())}static get isOffscreenCanvasSupported(){return U(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?U(this,"platform",{isWin:!1,isMac:!1}):U(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var be,ye;return U(this,"isCSSRoundSupported",(ye=(be=globalThis.CSS)==null?void 0:be.supports)==null?void 0:ye.call(be,"width: round(1.5px, 1px)"))}}e.FeatureTest=X;const se=[...Array(256).keys()].map(Fe=>Fe.toString(16).padStart(2,"0"));class fe{static makeHexColor(be,ye,tt){return`#${se[be]}${se[ye]}${se[tt]}`}static scaleMinMax(be,ye){let tt;be[0]?(be[0]<0&&(tt=ye[0],ye[0]=ye[1],ye[1]=tt),ye[0]*=be[0],ye[1]*=be[0],be[3]<0&&(tt=ye[2],ye[2]=ye[3],ye[3]=tt),ye[2]*=be[3],ye[3]*=be[3]):(tt=ye[0],ye[0]=ye[2],ye[2]=tt,tt=ye[1],ye[1]=ye[3],ye[3]=tt,be[1]<0&&(tt=ye[2],ye[2]=ye[3],ye[3]=tt),ye[2]*=be[1],ye[3]*=be[1],be[2]<0&&(tt=ye[0],ye[0]=ye[1],ye[1]=tt),ye[0]*=be[2],ye[1]*=be[2]),ye[0]+=be[4],ye[1]+=be[4],ye[2]+=be[5],ye[3]+=be[5]}static transform(be,ye){return[be[0]*ye[0]+be[2]*ye[1],be[1]*ye[0]+be[3]*ye[1],be[0]*ye[2]+be[2]*ye[3],be[1]*ye[2]+be[3]*ye[3],be[0]*ye[4]+be[2]*ye[5]+be[4],be[1]*ye[4]+be[3]*ye[5]+be[5]]}static applyTransform(be,ye){const tt=be[0]*ye[0]+be[1]*ye[2]+ye[4],xt=be[0]*ye[1]+be[1]*ye[3]+ye[5];return[tt,xt]}static applyInverseTransform(be,ye){const tt=ye[0]*ye[3]-ye[1]*ye[2],xt=(be[0]*ye[3]-be[1]*ye[2]+ye[2]*ye[5]-ye[4]*ye[3])/tt,vt=(-be[0]*ye[1]+be[1]*ye[0]+ye[4]*ye[1]-ye[5]*ye[0])/tt;return[xt,vt]}static getAxialAlignedBoundingBox(be,ye){const tt=this.applyTransform(be,ye),xt=this.applyTransform(be.slice(2,4),ye),vt=this.applyTransform([be[0],be[3]],ye),oe=this.applyTransform([be[2],be[1]],ye);return[Math.min(tt[0],xt[0],vt[0],oe[0]),Math.min(tt[1],xt[1],vt[1],oe[1]),Math.max(tt[0],xt[0],vt[0],oe[0]),Math.max(tt[1],xt[1],vt[1],oe[1])]}static inverseTransform(be){const ye=be[0]*be[3]-be[1]*be[2];return[be[3]/ye,-be[1]/ye,-be[2]/ye,be[0]/ye,(be[2]*be[5]-be[4]*be[3])/ye,(be[4]*be[1]-be[5]*be[0])/ye]}static singularValueDecompose2dScale(be){const ye=[be[0],be[2],be[1],be[3]],tt=be[0]*ye[0]+be[1]*ye[2],xt=be[0]*ye[1]+be[1]*ye[3],vt=be[2]*ye[0]+be[3]*ye[2],oe=be[2]*ye[1]+be[3]*ye[3],ke=(tt+oe)/2,Ve=Math.sqrt((tt+oe)**2-4*(tt*oe-vt*xt))/2,at=ke+Ve||1,Je=ke-Ve||1;return[Math.sqrt(at),Math.sqrt(Je)]}static normalizeRect(be){const ye=be.slice(0);return be[0]>be[2]&&(ye[0]=be[2],ye[2]=be[0]),be[1]>be[3]&&(ye[1]=be[3],ye[3]=be[1]),ye}static intersect(be,ye){const tt=Math.max(Math.min(be[0],be[2]),Math.min(ye[0],ye[2])),xt=Math.min(Math.max(be[0],be[2]),Math.max(ye[0],ye[2]));if(tt>xt)return null;const vt=Math.max(Math.min(be[1],be[3]),Math.min(ye[1],ye[3])),oe=Math.min(Math.max(be[1],be[3]),Math.max(ye[1],ye[3]));return vt>oe?null:[tt,vt,xt,oe]}static bezierBoundingBox(be,ye,tt,xt,vt,oe,ke,Ve){const at=[],Je=[[],[]];let et,ie,Q,ue,Ae,Oe,je,Ue;for(let ht=0;ht<2;++ht){if(ht===0?(ie=6*be-12*tt+6*vt,et=-3*be+9*tt-9*vt+3*ke,Q=3*tt-3*be):(ie=6*ye-12*xt+6*oe,et=-3*ye+9*xt-9*oe+3*Ve,Q=3*xt-3*ye),Math.abs(et)<1e-12){if(Math.abs(ie)<1e-12)continue;ue=-Q/ie,0<ue&&ue<1&&at.push(ue);continue}je=ie*ie-4*Q*et,Ue=Math.sqrt(je),!(je<0)&&(Ae=(-ie+Ue)/(2*et),0<Ae&&Ae<1&&at.push(Ae),Oe=(-ie-Ue)/(2*et),0<Oe&&Oe<1&&at.push(Oe))}let it=at.length,st;const Ye=it;for(;it--;)ue=at[it],st=1-ue,Je[0][it]=st*st*st*be+3*st*st*ue*tt+3*st*ue*ue*vt+ue*ue*ue*ke,Je[1][it]=st*st*st*ye+3*st*st*ue*xt+3*st*ue*ue*oe+ue*ue*ue*Ve;return Je[0][Ye]=be,Je[1][Ye]=ye,Je[0][Ye+1]=ke,Je[1][Ye+1]=Ve,Je[0].length=Je[1].length=Ye+2,[Math.min(...Je[0]),Math.min(...Je[1]),Math.max(...Je[0]),Math.max(...Je[1])]}}e.Util=fe;const ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Me(Fe){if(Fe[0]>=""){let ye;if(Fe[0]===""&&Fe[1]===""?ye="utf-16be":Fe[0]===""&&Fe[1]===""?ye="utf-16le":Fe[0]===""&&Fe[1]===""&&Fe[2]===""&&(ye="utf-8"),ye)try{const tt=new TextDecoder(ye,{fatal:!0}),xt=Ce(Fe);return tt.decode(xt)}catch(tt){G(`stringToPDFString: "${tt}".`)}}const be=[];for(let ye=0,tt=Fe.length;ye<tt;ye++){const xt=ve[Fe.charCodeAt(ye)];be.push(xt?String.fromCharCode(xt):Fe.charAt(ye))}return be.join("")}function Be(Fe){return decodeURIComponent(escape(Fe))}function Le(Fe){return unescape(encodeURIComponent(Fe))}function pe(Fe){return typeof Fe=="object"&&(Fe==null?void 0:Fe.byteLength)!==void 0}function Ge(Fe,be){if(Fe.length!==be.length)return!1;for(let ye=0,tt=Fe.length;ye<tt;ye++)if(Fe[ye]!==be[ye])return!1;return!0}function qe(Fe=new Date){return[Fe.getUTCFullYear().toString(),(Fe.getUTCMonth()+1).toString().padStart(2,"0"),Fe.getUTCDate().toString().padStart(2,"0"),Fe.getUTCHours().toString().padStart(2,"0"),Fe.getUTCMinutes().toString().padStart(2,"0"),Fe.getUTCSeconds().toString().padStart(2,"0")].join("")}class pt{constructor(){Se(this,mt,!1);this.promise=new Promise((be,ye)=>{this.resolve=tt=>{we(this,mt,!0),be(tt)},this.reject=tt=>{we(this,mt,!0),ye(tt)}})}get settled(){return R(this,mt)}}mt=new WeakMap,e.PromiseCapability=pt;let dt=null,Et=null;function rt(Fe){return dt||(dt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Et=new Map([["","t"]])),Fe.replaceAll(dt,(be,ye,tt)=>ye?ye.normalize("NFKC"):Et.get(tt))}function ct(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const Fe=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(Fe);else for(let be=0;be<32;be++)Fe[be]=Math.floor(Math.random()*255);return Re(Fe)}const yt="pdfjs_internal_id_";e.AnnotationPrefix=yt},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var s,t,n,r,Ts,$a,u,h,f,p,g,y,v,_,E,Ua,w,T,sc,N,A;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(k){if(typeof k=="string"||k instanceof URL?k={url:k}:(0,_util.isArrayBuffer)(k)&&(k={data:k}),typeof k!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!k.url&&!k.data&&!k.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const M=new PDFDocumentLoadingTask,{docId:L}=M,H=k.url?getUrlProp(k.url):null,D=k.data?getDataProp(k.data):null,q=k.httpHeaders||null,J=k.withCredentials===!0,ae=k.password??null,V=k.range instanceof PDFDataRangeTransport?k.range:null,Z=Number.isInteger(k.rangeChunkSize)&&k.rangeChunkSize>0?k.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let G=k.worker instanceof PDFWorker?k.worker:null;const ne=k.verbosity,B=typeof k.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(k.docBaseUrl)?k.docBaseUrl:null,F=typeof k.cMapUrl=="string"?k.cMapUrl:null,Y=k.cMapPacked!==!1,U=k.CMapReaderFactory||DefaultCMapReaderFactory,C=typeof k.standardFontDataUrl=="string"?k.standardFontDataUrl:null,P=k.StandardFontDataFactory||DefaultStandardFontDataFactory,$=k.stopAtErrors!==!0,W=Number.isInteger(k.maxImageSize)&&k.maxImageSize>-1?k.maxImageSize:-1,te=k.isEvalSupported!==!1,ee=typeof k.isOffscreenCanvasSupported=="boolean"?k.isOffscreenCanvasSupported:!_util.isNodeJS,ce=Number.isInteger(k.canvasMaxAreaInBytes)?k.canvasMaxAreaInBytes:-1,he=typeof k.disableFontFace=="boolean"?k.disableFontFace:_util.isNodeJS,Re=k.fontExtraProperties===!0,Ce=k.enableXfa===!0,Ie=k.ownerDocument||globalThis.document,Ne=k.disableRange===!0,$e=k.disableStream===!0,ge=k.disableAutoFetch===!0,_e=k.pdfBug===!0,X=V?V.length:k.length??NaN,se=typeof k.useSystemFonts=="boolean"?k.useSystemFonts:!_util.isNodeJS&&!he,fe=typeof k.useWorkerFetch=="boolean"?k.useWorkerFetch:U===_display_utils.DOMCMapReaderFactory&&P===_display_utils.DOMStandardFontDataFactory&&F&&C&&(0,_display_utils.isValidFetchUrl)(F,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(C,document.baseURI),ve=k.canvasFactory||new DefaultCanvasFactory({ownerDocument:Ie}),Me=k.filterFactory||new DefaultFilterFactory({docId:L,ownerDocument:Ie}),Be=null;(0,_util.setVerbosityLevel)(ne);const Le={canvasFactory:ve,filterFactory:Me};if(fe||(Le.cMapReaderFactory=new U({baseUrl:F,isCompressed:Y}),Le.standardFontDataFactory=new P({baseUrl:C})),!G){const qe={verbosity:ne,port:_worker_options.GlobalWorkerOptions.workerPort};G=qe.port?PDFWorker.fromPort(qe):new PDFWorker(qe),M._worker=G}const pe={docId:L,apiVersion:"3.11.174",data:D,password:ae,disableAutoFetch:ge,rangeChunkSize:Z,length:X,docBaseUrl:B,enableXfa:Ce,evaluatorOptions:{maxImageSize:W,disableFontFace:he,ignoreErrors:$,isEvalSupported:te,isOffscreenCanvasSupported:ee,canvasMaxAreaInBytes:ce,fontExtraProperties:Re,useSystemFonts:se,cMapUrl:fe?F:null,standardFontDataUrl:fe?C:null}},Ge={ignoreErrors:$,isEvalSupported:te,disableFontFace:he,fontExtraProperties:Re,enableXfa:Ce,ownerDocument:Ie,disableAutoFetch:ge,pdfBug:_e,styleElement:Be};return G.promise.then(function(){if(M.destroyed)throw new Error("Loading aborted");const qe=_fetchDocument(G,pe),pt=new Promise(function(dt){let Et;V?Et=new _transport_stream.PDFDataTransportStream({length:X,initialData:V.initialData,progressiveDone:V.progressiveDone,contentDispositionFilename:V.contentDispositionFilename,disableRange:Ne,disableStream:$e},V):D||(Et=(ct=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(ct):(0,_display_utils.isValidFetchUrl)(ct.url)?new _displayFetch_stream.PDFFetchStream(ct):new _displayNetwork.PDFNetworkStream(ct))({url:H,length:X,httpHeaders:q,withCredentials:J,rangeChunkSize:Z,disableRange:Ne,disableStream:$e})),dt(Et)});return Promise.all([qe,pt]).then(function([dt,Et]){if(M.destroyed)throw new Error("Loading aborted");const rt=new _message_handler.MessageHandler(L,dt,G.port),ct=new WorkerTransport(rt,M,Et,Ge,Le);M._transport=ct,rt.send("Ready",null)})}).catch(M._capability.reject),M}async function _fetchDocument(k,M){if(k.destroyed)throw new Error("Worker was destroyed");const L=await k.messageHandler.sendWithPromise("GetDocRequest",M,M.data?[M.data.buffer]:null);if(k.destroyed)throw new Error("Worker was destroyed");return L}function getUrlProp(k){if(k instanceof URL)return k.href;try{return new URL(k,window.location).href}catch{if(_util.isNodeJS&&typeof k=="string")return k}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(k){if(_util.isNodeJS&&typeof Buffer<"u"&&k instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(k instanceof Uint8Array&&k.byteLength===k.buffer.byteLength)return k;if(typeof k=="string")return(0,_util.stringToBytes)(k);if(typeof k=="object"&&!isNaN(k==null?void 0:k.length)||(0,_util.isArrayBuffer)(k))return new Uint8Array(k);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${Er(e,s)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var M,L,H;this.destroyed=!0;try{(M=this._worker)!=null&&M.port&&(this._worker._pendingDestroy=!0),await((L=this._transport)==null?void 0:L.destroy())}catch(D){throw(H=this._worker)!=null&&H.port&&delete this._worker._pendingDestroy,D}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};s=new WeakMap,Se(e,s,0);let PDFDocumentLoadingTask=e;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(M,L,H=!1,D=null){this.length=M,this.initialData=L,this.progressiveDone=H,this.contentDispositionFilename=D,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(M){this._rangeListeners.push(M)}addProgressListener(M){this._progressListeners.push(M)}addProgressiveReadListener(M){this._progressiveReadListeners.push(M)}addProgressiveDoneListener(M){this._progressiveDoneListeners.push(M)}onDataRange(M,L){for(const H of this._rangeListeners)H(M,L)}onDataProgress(M,L){this._readyCapability.promise.then(()=>{for(const H of this._progressListeners)H(M,L)})}onDataProgressiveRead(M){this._readyCapability.promise.then(()=>{for(const L of this._progressiveReadListeners)L(M)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const M of this._progressiveDoneListeners)M()})}transportReady(){this._readyCapability.resolve()}requestDataRange(M,L){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(M,L){this._pdfInfo=M,this._transport=L,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(H=>{if(!H)return H;const D=[];for(const q in H)D.push(...H[q]);return D}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(M){return this._transport.getPage(M)}getPageIndex(M){return this._transport.getPageIndex(M)}getDestinations(){return this._transport.getDestinations()}getDestination(M){return this._transport.getDestination(M)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(M=!1){return this._transport.startCleanup(M||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(M,L,H,D=!1){Se(this,r);Se(this,t,null);Se(this,n,!1);this._pageIndex=M,this._pageInfo=L,this._transport=H,this._stats=D?new _display_utils.StatTimer:null,this._pdfBug=D,this.commonObjs=H.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:M,rotation:L=this.rotate,offsetX:H=0,offsetY:D=0,dontFlip:q=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:M,rotation:L,offsetX:H,offsetY:D,dontFlip:q})}getAnnotations({intent:M="display"}={}){const L=this._transport.getRenderingIntent(M);return this._transport.getAnnotations(this._pageIndex,L.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var M;return((M=this._transport._htmlForXfa)==null?void 0:M.children[this._pageIndex])||null}render({canvasContext:M,viewport:L,intent:H="display",annotationMode:D=_util.AnnotationMode.ENABLE,transform:q=null,background:J=null,optionalContentConfigPromise:ae=null,annotationCanvasMap:V=null,pageColors:Z=null,printAnnotationStorage:G=null}){var P,$;(P=this._stats)==null||P.time("Overall");const ne=this._transport.getRenderingIntent(H,D,G);we(this,n,!1),de(this,r,$a).call(this),ae||(ae=this._transport.getOptionalContentConfig());let B=this._intentStates.get(ne.cacheKey);B||(B=Object.create(null),this._intentStates.set(ne.cacheKey,B)),B.streamReaderCancelTimeout&&(clearTimeout(B.streamReaderCancelTimeout),B.streamReaderCancelTimeout=null);const F=!!(ne.renderingIntent&_util.RenderingIntentFlag.PRINT);B.displayReadyCapability||(B.displayReadyCapability=new _util.PromiseCapability,B.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},($=this._stats)==null||$.time("Page Request"),this._pumpOperatorList(ne));const Y=W=>{var te,ee;B.renderTasks.delete(U),(this._maybeCleanupAfterRender||F)&&we(this,n,!0),de(this,r,Ts).call(this,!F),W?(U.capability.reject(W),this._abortOperatorList({intentState:B,reason:W instanceof Error?W:new Error(W)})):U.capability.resolve(),(te=this._stats)==null||te.timeEnd("Rendering"),(ee=this._stats)==null||ee.timeEnd("Overall")},U=new InternalRenderTask({callback:Y,params:{canvasContext:M,viewport:L,transform:q,background:J},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:V,operatorList:B.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!F,pdfBug:this._pdfBug,pageColors:Z});(B.renderTasks||(B.renderTasks=new Set)).add(U);const C=U.task;return Promise.all([B.displayReadyCapability.promise,ae]).then(([W,te])=>{var ee;if(this.destroyed){Y();return}(ee=this._stats)==null||ee.time("Rendering"),U.initializeGraphics({transparency:W,optionalContentConfig:te}),U.operatorListChanged()}).catch(Y),C}getOperatorList({intent:M="display",annotationMode:L=_util.AnnotationMode.ENABLE,printAnnotationStorage:H=null}={}){var V;function D(){J.operatorList.lastChunk&&(J.opListReadCapability.resolve(J.operatorList),J.renderTasks.delete(ae))}const q=this._transport.getRenderingIntent(M,L,H,!0);let J=this._intentStates.get(q.cacheKey);J||(J=Object.create(null),this._intentStates.set(q.cacheKey,J));let ae;return J.opListReadCapability||(ae=Object.create(null),ae.operatorListChanged=D,J.opListReadCapability=new _util.PromiseCapability,(J.renderTasks||(J.renderTasks=new Set)).add(ae),J.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(V=this._stats)==null||V.time("Page Request"),this._pumpOperatorList(q)),J.opListReadCapability.promise}streamTextContent({includeMarkedContent:M=!1,disableNormalization:L=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:M===!0,disableNormalization:L===!0},{highWaterMark:100,size(D){return D.items.length}})}getTextContent(M={}){if(this._transport._htmlForXfa)return this.getXfa().then(H=>_xfa_text.XfaText.textContent(H));const L=this.streamTextContent(M);return new Promise(function(H,D){function q(){J.read().then(function({value:V,done:Z}){if(Z){H(ae);return}Object.assign(ae.styles,V.styles),ae.items.push(...V.items),q()},D)}const J=L.getReader(),ae={items:[],styles:Object.create(null)};q()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const M=[];for(const L of this._intentStates.values())if(this._abortOperatorList({intentState:L,reason:new Error("Page was destroyed."),force:!0}),!L.opListReadCapability)for(const H of L.renderTasks)M.push(H.completed),H.cancel();return this.objs.clear(),we(this,n,!1),de(this,r,$a).call(this),Promise.all(M)}cleanup(M=!1){we(this,n,!0);const L=de(this,r,Ts).call(this,!1);return M&&L&&this._stats&&(this._stats=new _display_utils.StatTimer),L}_startRenderPage(M,L){var D,q;const H=this._intentStates.get(L);H&&((D=this._stats)==null||D.timeEnd("Page Request"),(q=H.displayReadyCapability)==null||q.resolve(M))}_renderPageChunk(M,L){for(let H=0,D=M.length;H<D;H++)L.operatorList.fnArray.push(M.fnArray[H]),L.operatorList.argsArray.push(M.argsArray[H]);L.operatorList.lastChunk=M.lastChunk,L.operatorList.separateAnnots=M.separateAnnots;for(const H of L.renderTasks)H.operatorListChanged();M.lastChunk&&de(this,r,Ts).call(this,!0)}_pumpOperatorList({renderingIntent:M,cacheKey:L,annotationStorageSerializable:H}){const{map:D,transfers:q}=H,ae=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:M,cacheKey:L,annotationStorage:D},q).getReader(),V=this._intentStates.get(L);V.streamReader=ae;const Z=()=>{ae.read().then(({value:G,done:ne})=>{if(ne){V.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(G,V),Z())},G=>{if(V.streamReader=null,!this._transport.destroyed){if(V.operatorList){V.operatorList.lastChunk=!0;for(const ne of V.renderTasks)ne.operatorListChanged();de(this,r,Ts).call(this,!0)}if(V.displayReadyCapability)V.displayReadyCapability.reject(G);else if(V.opListReadCapability)V.opListReadCapability.reject(G);else throw G}})};Z()}_abortOperatorList({intentState:M,reason:L,force:H=!1}){if(M.streamReader){if(M.streamReaderCancelTimeout&&(clearTimeout(M.streamReaderCancelTimeout),M.streamReaderCancelTimeout=null),!H){if(M.renderTasks.size>0)return;if(L instanceof _display_utils.RenderingCancelledException){let D=RENDERING_CANCELLED_TIMEOUT;L.extraDelay>0&&L.extraDelay<1e3&&(D+=L.extraDelay),M.streamReaderCancelTimeout=setTimeout(()=>{M.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:M,reason:L,force:!0})},D);return}}if(M.streamReader.cancel(new _util.AbortException(L.message)).catch(()=>{}),M.streamReader=null,!this._transport.destroyed){for(const[D,q]of this._intentStates)if(q===M){this._intentStates.delete(D);break}this.cleanup()}}}get stats(){return this._stats}}t=new WeakMap,n=new WeakMap,r=new WeakSet,Ts=function(M=!1){if(de(this,r,$a).call(this),!R(this,n)||this.destroyed)return!1;if(M)return we(this,t,setTimeout(()=>{we(this,t,null),de(this,r,Ts).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:L,operatorList:H}of this._intentStates.values())if(L.size>0||!H.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),we(this,n,!1),!0},$a=function(){R(this,t)&&(clearTimeout(R(this,t)),we(this,t,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){Se(this,u,new Set);Se(this,h,Promise.resolve())}postMessage(M,L){const H={data:structuredClone(M,L?{transfer:L}:null)};R(this,h).then(()=>{for(const D of R(this,u))D.call(this,H)})}addEventListener(M,L){R(this,u).add(L)}removeEventListener(M,L){R(this,u).delete(L)}terminate(){R(this,u).clear()}}u=new WeakMap,h=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const k=(f=document==null?void 0:document.currentScript)==null?void 0:f.src;k&&(PDFWorkerUtil.fallbackWorkerSrc=k.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(k,M){let L;try{if(L=new URL(k),!L.origin||L.origin==="null")return!1}catch{return!1}const H=new URL(M,L);return L.origin===H.origin},PDFWorkerUtil.createCDNWrapper=function(k){const M=`importScripts("${k}");`;return URL.createObjectURL(new Blob([M]))}}const _PDFWorker=class _PDFWorker{constructor({name:k=null,port:M=null,verbosity:L=(0,_util.getVerbosityLevel)()}={}){var H;if(this.name=k,this.destroyed=!1,this.verbosity=L,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,M){if((H=R(_PDFWorker,p))!=null&&H.has(M))throw new Error("Cannot use more than one PDFWorker per port.");(R(_PDFWorker,p)||we(_PDFWorker,p,new WeakMap)).set(M,this),this._initializeFromPort(M);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(k){this._port=k,this._messageHandler=new _message_handler.MessageHandler("main","worker",k),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:k}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,k)||(k=PDFWorkerUtil.createCDNWrapper(new URL(k,window.location).href));const M=new Worker(k),L=new _message_handler.MessageHandler("main","worker",M),H=()=>{M.removeEventListener("error",D),L.destroy(),M.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},D=()=>{this._webWorker||H()};M.addEventListener("error",D),L.on("test",J=>{if(M.removeEventListener("error",D),this.destroyed){H();return}J?(this._messageHandler=L,this._port=M,this._webWorker=M,this._readyCapability.resolve(),L.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),L.destroy(),M.terminate())}),L.on("ready",J=>{if(M.removeEventListener("error",D),this.destroyed){H();return}try{q()}catch{this._setupFakeWorker()}});const q=()=>{const J=new Uint8Array;L.send("test",J,[J.buffer])};q();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(k=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const M=new LoopbackPort;this._port=M;const L=`fake${PDFWorkerUtil.fakeWorkerId++}`,H=new _message_handler.MessageHandler(L+"_worker",L,M);k.setup(H,M);const D=new _message_handler.MessageHandler(L,L+"_worker",M);this._messageHandler=D,this._readyCapability.resolve(),D.send("configure",{verbosity:this.verbosity})}).catch(k=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${k.message}".`))})}destroy(){var k;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(k=R(_PDFWorker,p))==null||k.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(k){var L;if(!(k!=null&&k.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const M=(L=R(this,p))==null?void 0:L.get(k.port);if(M){if(M._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return M}return new _PDFWorker(k)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var k;try{return((k=globalThis.pdfjsWorker)==null?void 0:k.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};p=new WeakMap,Se(_PDFWorker,p);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(M,L,H,D,q){Se(this,E);Se(this,g,new Map);Se(this,y,new Map);Se(this,v,new Map);Se(this,_,null);this.messageHandler=M,this.loadingTask=L,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:D.ownerDocument,styleElement:D.styleElement}),this._params=D,this.canvasFactory=q.canvasFactory,this.filterFactory=q.filterFactory,this.cMapReaderFactory=q.cMapReaderFactory,this.standardFontDataFactory=q.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=H,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(M,L=_util.AnnotationMode.ENABLE,H=null,D=!1){let q=_util.RenderingIntentFlag.DISPLAY,J=_annotation_storage.SerializableEmpty;switch(M){case"any":q=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":q=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${M}`)}switch(L){case _util.AnnotationMode.DISABLE:q+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:q+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:q+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,J=(q&_util.RenderingIntentFlag.PRINT&&H instanceof _annotation_storage.PrintAnnotationStorage?H:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${L}`)}return D&&(q+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:q,cacheKey:`${q}_${J.hash}`,annotationStorageSerializable:J}}destroy(){var H;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(H=R(this,_))==null||H.reject(new Error("Worker was destroyed during onPassword callback"));const M=[];for(const D of R(this,y).values())M.push(D._destroy());R(this,y).clear(),R(this,v).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const L=this.messageHandler.sendWithPromise("Terminate",null);return M.push(L),Promise.all(M).then(()=>{var D;this.commonObjs.clear(),this.fontLoader.clear(),R(this,g).clear(),this.filterFactory.destroy(),(D=this._networkStream)==null||D.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:M,loadingTask:L}=this;M.on("GetReader",(H,D)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=q=>{this._lastProgress={loaded:q.loaded,total:q.total}},D.onPull=()=>{this._fullReader.read().then(function({value:q,done:J}){if(J){D.close();return}(0,_util.assert)(q instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),D.enqueue(new Uint8Array(q),1,[q])}).catch(q=>{D.error(q)})},D.onCancel=q=>{this._fullReader.cancel(q),D.ready.catch(J=>{if(!this.destroyed)throw J})}}),M.on("ReaderHeadersReady",H=>{const D=new _util.PromiseCapability,q=this._fullReader;return q.headersReady.then(()=>{var J;(!q.isStreamingSupported||!q.isRangeSupported)&&(this._lastProgress&&((J=L.onProgress)==null||J.call(L,this._lastProgress)),q.onProgress=ae=>{var V;(V=L.onProgress)==null||V.call(L,{loaded:ae.loaded,total:ae.total})}),D.resolve({isStreamingSupported:q.isStreamingSupported,isRangeSupported:q.isRangeSupported,contentLength:q.contentLength})},D.reject),D.promise}),M.on("GetRangeReader",(H,D)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const q=this._networkStream.getRangeReader(H.begin,H.end);if(!q){D.close();return}D.onPull=()=>{q.read().then(function({value:J,done:ae}){if(ae){D.close();return}(0,_util.assert)(J instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),D.enqueue(new Uint8Array(J),1,[J])}).catch(J=>{D.error(J)})},D.onCancel=J=>{q.cancel(J),D.ready.catch(ae=>{if(!this.destroyed)throw ae})}}),M.on("GetDoc",({pdfInfo:H})=>{this._numPages=H.numPages,this._htmlForXfa=H.htmlForXfa,delete H.htmlForXfa,L._capability.resolve(new PDFDocumentProxy(H,this))}),M.on("DocException",function(H){let D;switch(H.name){case"PasswordException":D=new _util.PasswordException(H.message,H.code);break;case"InvalidPDFException":D=new _util.InvalidPDFException(H.message);break;case"MissingPDFException":D=new _util.MissingPDFException(H.message);break;case"UnexpectedResponseException":D=new _util.UnexpectedResponseException(H.message,H.status);break;case"UnknownErrorException":D=new _util.UnknownErrorException(H.message,H.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}L._capability.reject(D)}),M.on("PasswordRequest",H=>{if(we(this,_,new _util.PromiseCapability),L.onPassword){const D=q=>{q instanceof Error?R(this,_).reject(q):R(this,_).resolve({password:q})};try{L.onPassword(D,H.code)}catch(q){R(this,_).reject(q)}}else R(this,_).reject(new _util.PasswordException(H.message,H.code));return R(this,_).promise}),M.on("DataLoaded",H=>{var D;(D=L.onProgress)==null||D.call(L,{loaded:H.length,total:H.length}),this.downloadInfoCapability.resolve(H)}),M.on("StartRenderPage",H=>{if(this.destroyed)return;R(this,y).get(H.pageIndex)._startRenderPage(H.transparency,H.cacheKey)}),M.on("commonobj",([H,D,q])=>{var J;if(!this.destroyed&&!this.commonObjs.has(H))switch(D){case"Font":const ae=this._params;if("error"in q){const G=q.error;(0,_util.warn)(`Error during font loading: ${G}`),this.commonObjs.resolve(H,G);break}const V=ae.pdfBug&&((J=globalThis.FontInspector)!=null&&J.enabled)?(G,ne)=>globalThis.FontInspector.fontAdded(G,ne):null,Z=new _font_loader.FontFaceObject(q,{isEvalSupported:ae.isEvalSupported,disableFontFace:ae.disableFontFace,ignoreErrors:ae.ignoreErrors,inspectFont:V});this.fontLoader.bind(Z).catch(G=>M.sendWithPromise("FontFallback",{id:H})).finally(()=>{!ae.fontExtraProperties&&Z.data&&(Z.data=null),this.commonObjs.resolve(H,Z)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(H,q);break;default:throw new Error(`Got unknown common object type ${D}`)}}),M.on("obj",([H,D,q,J])=>{var V;if(this.destroyed)return;const ae=R(this,y).get(D);if(!ae.objs.has(H))switch(q){case"Image":if(ae.objs.resolve(H,J),J){let Z;if(J.bitmap){const{width:G,height:ne}=J;Z=G*ne*4}else Z=((V=J.data)==null?void 0:V.length)||0;Z>_util.MAX_IMAGE_SIZE_TO_CACHE&&(ae._maybeCleanupAfterRender=!0)}break;case"Pattern":ae.objs.resolve(H,J);break;default:throw new Error(`Got unknown object type ${q}`)}}),M.on("DocProgress",H=>{var D;this.destroyed||(D=L.onProgress)==null||D.call(L,{loaded:H.loaded,total:H.total})}),M.on("FetchBuiltInCMap",H=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(H):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),M.on("FetchStandardFontData",H=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(H):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var H;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:M,transfers:L}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:M,filename:((H=this._fullReader)==null?void 0:H.filename)??null},L).finally(()=>{this.annotationStorage.resetModified()})}getPage(M){if(!Number.isInteger(M)||M<=0||M>this._numPages)return Promise.reject(new Error("Invalid page request."));const L=M-1,H=R(this,v).get(L);if(H)return H;const D=this.messageHandler.sendWithPromise("GetPage",{pageIndex:L}).then(q=>{if(this.destroyed)throw new Error("Transport destroyed");const J=new PDFPageProxy(L,q,this,this._params.pdfBug);return R(this,y).set(L,J),J});return R(this,v).set(L,D),D}getPageIndex(M){return typeof M!="object"||M===null||!Number.isInteger(M.num)||M.num<0||!Number.isInteger(M.gen)||M.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:M.num,gen:M.gen})}getAnnotations(M,L){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:M,intent:L})}getFieldObjects(){return de(this,E,Ua).call(this,"GetFieldObjects")}hasJSActions(){return de(this,E,Ua).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(M){return typeof M!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:M})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return de(this,E,Ua).call(this,"GetDocJSActions")}getPageJSActions(M){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:M})}getStructTree(M){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:M})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(M=>new _optional_content_config.OptionalContentConfig(M))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const M="GetMetadata",L=R(this,g).get(M);if(L)return L;const H=this.messageHandler.sendWithPromise(M,null).then(D=>{var q,J;return{info:D[0],metadata:D[1]?new _metadata.Metadata(D[1]):null,contentDispositionFilename:((q=this._fullReader)==null?void 0:q.filename)??null,contentLength:((J=this._fullReader)==null?void 0:J.contentLength)??null}});return R(this,g).set(M,H),H}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(M=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const L of R(this,y).values())if(!L.cleanup())throw new Error(`startCleanup: Page ${L.pageNumber} is currently rendering.`);this.commonObjs.clear(),M||this.fontLoader.clear(),R(this,g).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:M,enableXfa:L}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:M,enableXfa:L})}}g=new WeakMap,y=new WeakMap,v=new WeakMap,_=new WeakMap,E=new WeakSet,Ua=function(M,L=null){const H=R(this,g).get(M);if(H)return H;const D=this.messageHandler.sendWithPromise(M,L);return R(this,g).set(M,D),D};class PDFObjects{constructor(){Se(this,T);Se(this,w,Object.create(null))}get(M,L=null){if(L){const D=de(this,T,sc).call(this,M);return D.capability.promise.then(()=>L(D.data)),null}const H=R(this,w)[M];if(!(H!=null&&H.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${M}.`);return H.data}has(M){const L=R(this,w)[M];return(L==null?void 0:L.capability.settled)||!1}resolve(M,L=null){const H=de(this,T,sc).call(this,M);H.data=L,H.capability.resolve()}clear(){var M;for(const L in R(this,w)){const{data:H}=R(this,w)[L];(M=H==null?void 0:H.bitmap)==null||M.close()}we(this,w,Object.create(null))}}w=new WeakMap,T=new WeakSet,sc=function(M){var L;return(L=R(this,w))[M]||(L[M]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(M){Se(this,N,null);we(this,N,M),this.onContinue=null}get promise(){return R(this,N).capability.promise}cancel(M=0){R(this,N).cancel(null,M)}get separateAnnots(){const{separateAnnots:M}=R(this,N).operatorList;if(!M)return!1;const{annotationCanvasMap:L}=R(this,N);return M.form||M.canvas&&(L==null?void 0:L.size)>0}}N=new WeakMap,exports.RenderTask=RenderTask;const I=class I{constructor({callback:M,params:L,objs:H,commonObjs:D,annotationCanvasMap:q,operatorList:J,pageIndex:ae,canvasFactory:V,filterFactory:Z,useRequestAnimationFrame:G=!1,pdfBug:ne=!1,pageColors:B=null}){this.callback=M,this.params=L,this.objs=H,this.commonObjs=D,this.annotationCanvasMap=q,this.operatorListIdx=null,this.operatorList=J,this._pageIndex=ae,this.canvasFactory=V,this.filterFactory=Z,this._pdfBug=ne,this.pageColors=B,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=G===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=L.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:M=!1,optionalContentConfig:L}){var ae,V;if(this.cancelled)return;if(this._canvas){if(R(I,A).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");R(I,A).add(this._canvas)}this._pdfBug&&((ae=globalThis.StepperManager)!=null&&ae.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:H,viewport:D,transform:q,background:J}=this.params;this.gfx=new _canvas.CanvasGraphics(H,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:L},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:q,viewport:D,transparency:M,background:J}),this.operatorListIdx=0,this.graphicsReady=!0,(V=this.graphicsReadyCallback)==null||V.call(this)}cancel(M=null,L=0){var H;this.running=!1,this.cancelled=!0,(H=this.gfx)==null||H.endDrawing(),R(I,A).delete(this._canvas),this.callback(M||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,L))}operatorListChanged(){var M;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(M=this.stepper)==null||M.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),R(I,A).delete(this._canvas),this.callback())))}};A=new WeakMap,Se(I,A,new WeakSet);let InternalRenderTask=I;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(s,e,t)=>{var f,p,g,df,v;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var n=t(1),r=t(4),o=t(8);const c=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=c;class u{constructor(){Se(this,g);Se(this,f,!1);Se(this,p,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(E,x){const w=R(this,p).get(E);return w===void 0?x:Object.assign(x,w)}getRawValue(E){return R(this,p).get(E)}remove(E){if(R(this,p).delete(E),R(this,p).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const x of R(this,p).values())if(x instanceof r.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(E,x){const w=R(this,p).get(E);let T=!1;if(w!==void 0)for(const[O,N]of Object.entries(x))w[O]!==N&&(T=!0,w[O]=N);else T=!0,R(this,p).set(E,x);T&&de(this,g,df).call(this),x instanceof r.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(x.constructor._type)}has(E){return R(this,p).has(E)}getAll(){return R(this,p).size>0?(0,n.objectFromMap)(R(this,p)):null}setAll(E){for(const[x,w]of Object.entries(E))this.setValue(x,w)}get size(){return R(this,p).size}resetModified(){R(this,f)&&(we(this,f,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new h(this)}get serializable(){if(R(this,p).size===0)return c;const E=new Map,x=new o.MurmurHash3_64,w=[],T=Object.create(null);let O=!1;for(const[N,A]of R(this,p)){const I=A instanceof r.AnnotationEditor?A.serialize(!1,T):A;I&&(E.set(N,I),x.update(`${N}:${JSON.stringify(I)}`),O||(O=!!I.bitmap))}if(O)for(const N of E.values())N.bitmap&&w.push(N.bitmap);return E.size>0?{map:E,hash:x.hexdigest(),transfers:w}:c}}f=new WeakMap,p=new WeakMap,g=new WeakSet,df=function(){R(this,f)||(we(this,f,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=u;class h extends u{constructor(x){super();Se(this,v);const{map:w,hash:T,transfers:O}=x.serializable,N=structuredClone(w,O?{transfer:O}:null);we(this,v,{map:N,hash:T,transfers:O})}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return R(this,v)}}v=new WeakMap,e.PrintAnnotationStorage=h},(s,e,t)=>{var h,f,p,g,y,v,_,E,x,w,T,O,N,A,I,rc,ac,L,oc,lc,hf,ff,pf,cc,mf;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var n=t(5),r=t(1),o=t(6);const G=class G{constructor(B){Se(this,I);Se(this,h,"");Se(this,f,!1);Se(this,p,null);Se(this,g,null);Se(this,y,null);Se(this,v,!1);Se(this,_,null);Se(this,E,this.focusin.bind(this));Se(this,x,this.focusout.bind(this));Se(this,w,!1);Se(this,T,!1);Se(this,O,!1);ot(this,"_initialOptions",Object.create(null));ot(this,"_uiManager",null);ot(this,"_focusEventsAllowed",!0);ot(this,"_l10nPromise",null);Se(this,N,!1);Se(this,A,G._zIndex++);this.constructor===G&&(0,r.unreachable)("Cannot initialize AnnotationEditor."),this.parent=B.parent,this.id=B.id,this.width=this.height=null,this.pageIndex=B.parent.pageIndex,this.name=B.name,this.div=null,this._uiManager=B.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=B.isCentered,this._structTreeParentId=null;const{rotation:F,rawDims:{pageWidth:Y,pageHeight:U,pageX:C,pageY:P}}=this.parent.viewport;this.rotation=F,this.pageRotation=(360+F-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[Y,U],this.pageTranslation=[C,P];const[$,W]=this.parentDimensions;this.x=B.x/$,this.y=B.y/W,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,r.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(B){const F=new u({id:B.parent.getNextId(),parent:B.parent,uiManager:B._uiManager});F.annotationElementId=B.annotationElementId,F.deleted=!0,F._uiManager.addToAnnotationStorage(F)}static initialize(B,F=null){if(G._l10nPromise||(G._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(U=>[U,B.get(U)]))),F!=null&&F.strings)for(const U of F.strings)G._l10nPromise.set(U,B.get(U));if(G._borderLineWidth!==-1)return;const Y=getComputedStyle(document.documentElement);G._borderLineWidth=parseFloat(Y.getPropertyValue("--outline-width"))||0}static updateDefaultParams(B,F){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(B){return!1}static paste(B,F){(0,r.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return R(this,N)}set _isDraggable(B){var F;we(this,N,B),(F=this.div)==null||F.classList.toggle("draggable",B)}center(){const[B,F]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*F/(B*2),this.y+=this.width*B/(F*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*F/(B*2),this.y-=this.width*B/(F*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(B){this._uiManager.addCommands(B)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=R(this,A)}setParent(B){B!==null&&(this.pageIndex=B.pageIndex,this.pageDimensions=B.pageDimensions),this.parent=B}focusin(B){this._focusEventsAllowed&&(R(this,w)?we(this,w,!1):this.parent.setSelected(this))}focusout(B){var Y;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const F=B.relatedTarget;F!=null&&F.closest(`#${this.id}`)||(B.preventDefault(),(Y=this.parent)!=null&&Y.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(B,F,Y,U){const[C,P]=this.parentDimensions;[Y,U]=this.screenToPageTranslation(Y,U),this.x=(B+Y)/C,this.y=(F+U)/P,this.fixAndSetPosition()}translate(B,F){de(this,I,rc).call(this,this.parentDimensions,B,F)}translateInPage(B,F){de(this,I,rc).call(this,this.pageDimensions,B,F),this.div.scrollIntoView({block:"nearest"})}drag(B,F){const[Y,U]=this.parentDimensions;if(this.x+=B/Y,this.y+=F/U,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:te,y:ee}=this.div.getBoundingClientRect();this.parent.findNewParent(this,te,ee)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:C,y:P}=this;const[$,W]=de(this,I,ac).call(this);C+=$,P+=W,this.div.style.left=`${(100*C).toFixed(2)}%`,this.div.style.top=`${(100*P).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[B,F]=this.pageDimensions;let{x:Y,y:U,width:C,height:P}=this;switch(C*=B,P*=F,Y*=B,U*=F,this.rotation){case 0:Y=Math.max(0,Math.min(B-C,Y)),U=Math.max(0,Math.min(F-P,U));break;case 90:Y=Math.max(0,Math.min(B-P,Y)),U=Math.min(F,Math.max(C,U));break;case 180:Y=Math.min(B,Math.max(C,Y)),U=Math.min(F,Math.max(P,U));break;case 270:Y=Math.min(B,Math.max(P,Y)),U=Math.max(0,Math.min(F-C,U));break}this.x=Y/=B,this.y=U/=F;const[$,W]=de(this,I,ac).call(this);Y+=$,U+=W;const{style:te}=this.div;te.left=`${(100*Y).toFixed(2)}%`,te.top=`${(100*U).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(B,F){var Y;return de(Y=G,L,oc).call(Y,B,F,this.parentRotation)}pageTranslationToScreen(B,F){var Y;return de(Y=G,L,oc).call(Y,B,F,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:B,pageDimensions:[F,Y]}=this,U=F*B,C=Y*B;return r.FeatureTest.isCSSRoundSupported?[Math.round(U),Math.round(C)]:[U,C]}setDims(B,F){var C;const[Y,U]=this.parentDimensions;this.div.style.width=`${(100*B/Y).toFixed(2)}%`,R(this,v)||(this.div.style.height=`${(100*F/U).toFixed(2)}%`),(C=R(this,p))==null||C.classList.toggle("small",B<G.SMALL_EDITOR_SIZE||F<G.SMALL_EDITOR_SIZE)}fixDims(){const{style:B}=this.div,{height:F,width:Y}=B,U=Y.endsWith("%"),C=!R(this,v)&&F.endsWith("%");if(U&&C)return;const[P,$]=this.parentDimensions;U||(B.width=`${(100*parseFloat(Y)/P).toFixed(2)}%`),!R(this,v)&&!C&&(B.height=`${(100*parseFloat(F)/$).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(R(this,p))return;const B=we(this,p,document.createElement("button"));B.className="altText";const F=await G._l10nPromise.get("editor_alt_text_button_label");B.textContent=F,B.setAttribute("aria-label",F),B.tabIndex="0",B.addEventListener("contextmenu",o.noContextMenu),B.addEventListener("pointerdown",Y=>Y.stopPropagation()),B.addEventListener("click",Y=>{Y.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),B.addEventListener("keydown",Y=>{Y.target===B&&Y.key==="Enter"&&(Y.preventDefault(),this._uiManager.editAltText(this))}),de(this,I,cc).call(this),this.div.append(B),G.SMALL_EDITOR_SIZE||(G.SMALL_EDITOR_SIZE=Math.min(128,Math.round(B.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:R(this,h),decorative:R(this,f)}}set altTextData({altText:B,decorative:F}){R(this,h)===B&&R(this,f)===F||(we(this,h,B),we(this,f,F),de(this,I,cc).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",R(this,E)),this.div.addEventListener("focusout",R(this,x));const[B,F]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*F/B).toFixed(2)}%`,this.div.style.maxHeight=`${(100*B/F).toFixed(2)}%`);const[Y,U]=this.getInitialTranslation();return this.translate(Y,U),(0,n.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(B){const{isMac:F}=r.FeatureTest.platform;if(B.button!==0||B.ctrlKey&&F){B.preventDefault();return}we(this,w,!0),de(this,I,mf).call(this,B)}moveInDOM(){var B;(B=this.parent)==null||B.moveEditorInDOM(this)}_setParentAndPosition(B,F,Y){B.changeParent(this),this.x=F,this.y=Y,this.fixAndSetPosition()}getRect(B,F){const Y=this.parentScale,[U,C]=this.pageDimensions,[P,$]=this.pageTranslation,W=B/Y,te=F/Y,ee=this.x*U,ce=this.y*C,he=this.width*U,Re=this.height*C;switch(this.rotation){case 0:return[ee+W+P,C-ce-te-Re+$,ee+W+he+P,C-ce-te+$];case 90:return[ee+te+P,C-ce+W+$,ee+te+Re+P,C-ce+W+he+$];case 180:return[ee-W-he+P,C-ce+te+$,ee-W+P,C-ce+te+Re+$];case 270:return[ee-te-Re+P,C-ce-W-he+$,ee-te+P,C-ce-W+$];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(B,F){const[Y,U,C,P]=B,$=C-Y,W=P-U;switch(this.rotation){case 0:return[Y,F-P,$,W];case 90:return[Y,F-U,W,$];case 180:return[C,F-U,$,W];case 270:return[C,F-P,W,$];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){we(this,O,!0)}disableEditMode(){we(this,O,!1)}isInEditMode(){return R(this,O)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var B,F;(B=this.div)==null||B.addEventListener("focusin",R(this,E)),(F=this.div)==null||F.addEventListener("focusout",R(this,x))}serialize(B=!1,F=null){(0,r.unreachable)("An editor must be serializable")}static deserialize(B,F,Y){const U=new this.prototype.constructor({parent:F,id:F.getNextId(),uiManager:Y});U.rotation=B.rotation;const[C,P]=U.pageDimensions,[$,W,te,ee]=U.getRectInCurrentCoords(B.rect,P);return U.x=$/C,U.y=W/P,U.width=te/C,U.height=ee/P,U}remove(){var B;this.div.removeEventListener("focusin",R(this,E)),this.div.removeEventListener("focusout",R(this,x)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(B=R(this,p))==null||B.remove(),we(this,p,null),we(this,g,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(de(this,I,hf).call(this),R(this,_).classList.remove("hidden"))}select(){var B;this.makeResizable(),(B=this.div)==null||B.classList.add("selectedEditor")}unselect(){var B,F,Y;(B=R(this,_))==null||B.classList.add("hidden"),(F=this.div)==null||F.classList.remove("selectedEditor"),(Y=this.div)!=null&&Y.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(B,F){}disableEditing(){R(this,p)&&(R(this,p).hidden=!0)}enableEditing(){R(this,p)&&(R(this,p).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return R(this,T)}set isEditing(B){we(this,T,B),this.parent&&(B?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(B,F){we(this,v,!0);const Y=B/F,{style:U}=this.div;U.aspectRatio=Y,U.height="auto"}static get MIN_SIZE(){return 16}};h=new WeakMap,f=new WeakMap,p=new WeakMap,g=new WeakMap,y=new WeakMap,v=new WeakMap,_=new WeakMap,E=new WeakMap,x=new WeakMap,w=new WeakMap,T=new WeakMap,O=new WeakMap,N=new WeakMap,A=new WeakMap,I=new WeakSet,rc=function([B,F],Y,U){[Y,U]=this.screenToPageTranslation(Y,U),this.x+=Y/B,this.y+=U/F,this.fixAndSetPosition()},ac=function(){const[B,F]=this.parentDimensions,{_borderLineWidth:Y}=G,U=Y/B,C=Y/F;switch(this.rotation){case 90:return[-U,C];case 180:return[U,C];case 270:return[U,-C];default:return[-U,-C]}},L=new WeakSet,oc=function(B,F,Y){switch(Y){case 90:return[F,-B];case 180:return[-B,-F];case 270:return[-F,B];default:return[B,F]}},lc=function(B){switch(B){case 90:{const[F,Y]=this.pageDimensions;return[0,-F/Y,Y/F,0]}case 180:return[-1,0,0,-1];case 270:{const[F,Y]=this.pageDimensions;return[0,F/Y,-Y/F,0]}default:return[1,0,0,1]}},hf=function(){if(R(this,_))return;we(this,_,document.createElement("div")),R(this,_).classList.add("resizers");const B=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||B.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const F of B){const Y=document.createElement("div");R(this,_).append(Y),Y.classList.add("resizer",F),Y.addEventListener("pointerdown",de(this,I,ff).bind(this,F)),Y.addEventListener("contextmenu",o.noContextMenu)}this.div.prepend(R(this,_))},ff=function(B,F){F.preventDefault();const{isMac:Y}=r.FeatureTest.platform;if(F.button!==0||F.ctrlKey&&Y)return;const U=de(this,I,pf).bind(this,B),C=this._isDraggable;this._isDraggable=!1;const P={passive:!0,capture:!0};window.addEventListener("pointermove",U,P);const $=this.x,W=this.y,te=this.width,ee=this.height,ce=this.parent.div.style.cursor,he=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(F.target).cursor;const Re=()=>{this._isDraggable=C,window.removeEventListener("pointerup",Re),window.removeEventListener("blur",Re),window.removeEventListener("pointermove",U,P),this.parent.div.style.cursor=ce,this.div.style.cursor=he;const Ce=this.x,Ie=this.y,Ne=this.width,$e=this.height;Ce===$&&Ie===W&&Ne===te&&$e===ee||this.addCommands({cmd:()=>{this.width=Ne,this.height=$e,this.x=Ce,this.y=Ie;const[ge,_e]=this.parentDimensions;this.setDims(ge*Ne,_e*$e),this.fixAndSetPosition()},undo:()=>{this.width=te,this.height=ee,this.x=$,this.y=W;const[ge,_e]=this.parentDimensions;this.setDims(ge*te,_e*ee),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",Re),window.addEventListener("blur",Re)},pf=function(B,F){const[Y,U]=this.parentDimensions,C=this.x,P=this.y,$=this.width,W=this.height,te=G.MIN_SIZE/Y,ee=G.MIN_SIZE/U,ce=rt=>Math.round(rt*1e4)/1e4,he=de(this,I,lc).call(this,this.rotation),Re=(rt,ct)=>[he[0]*rt+he[2]*ct,he[1]*rt+he[3]*ct],Ce=de(this,I,lc).call(this,360-this.rotation),Ie=(rt,ct)=>[Ce[0]*rt+Ce[2]*ct,Ce[1]*rt+Ce[3]*ct];let Ne,$e,ge=!1,_e=!1;switch(B){case"topLeft":ge=!0,Ne=(rt,ct)=>[0,0],$e=(rt,ct)=>[rt,ct];break;case"topMiddle":Ne=(rt,ct)=>[rt/2,0],$e=(rt,ct)=>[rt/2,ct];break;case"topRight":ge=!0,Ne=(rt,ct)=>[rt,0],$e=(rt,ct)=>[0,ct];break;case"middleRight":_e=!0,Ne=(rt,ct)=>[rt,ct/2],$e=(rt,ct)=>[0,ct/2];break;case"bottomRight":ge=!0,Ne=(rt,ct)=>[rt,ct],$e=(rt,ct)=>[0,0];break;case"bottomMiddle":Ne=(rt,ct)=>[rt/2,ct],$e=(rt,ct)=>[rt/2,0];break;case"bottomLeft":ge=!0,Ne=(rt,ct)=>[0,ct],$e=(rt,ct)=>[rt,0];break;case"middleLeft":_e=!0,Ne=(rt,ct)=>[0,ct/2],$e=(rt,ct)=>[rt,ct/2];break}const X=Ne($,W),se=$e($,W);let fe=Re(...se);const ve=ce(C+fe[0]),Me=ce(P+fe[1]);let Be=1,Le=1,[pe,Ge]=this.screenToPageTranslation(F.movementX,F.movementY);if([pe,Ge]=Ie(pe/Y,Ge/U),ge){const rt=Math.hypot($,W);Be=Le=Math.max(Math.min(Math.hypot(se[0]-X[0]-pe,se[1]-X[1]-Ge)/rt,1/$,1/W),te/$,ee/W)}else _e?Be=Math.max(te,Math.min(1,Math.abs(se[0]-X[0]-pe)))/$:Le=Math.max(ee,Math.min(1,Math.abs(se[1]-X[1]-Ge)))/W;const qe=ce($*Be),pt=ce(W*Le);fe=Re(...$e(qe,pt));const dt=ve-fe[0],Et=Me-fe[1];this.width=qe,this.height=pt,this.x=dt,this.y=Et,this.setDims(Y*qe,U*pt),this.fixAndSetPosition()},cc=async function(){var Y;const B=R(this,p);if(!B)return;if(!R(this,h)&&!R(this,f)){B.classList.remove("done"),(Y=R(this,g))==null||Y.remove();return}G._l10nPromise.get("editor_alt_text_edit_button_label").then(U=>{B.setAttribute("aria-label",U)});let F=R(this,g);if(!F){we(this,g,F=document.createElement("span")),F.className="tooltip",F.setAttribute("role","tooltip");const U=F.id=`alt-text-tooltip-${this.id}`;B.setAttribute("aria-describedby",U);const C=100;B.addEventListener("mouseenter",()=>{we(this,y,setTimeout(()=>{we(this,y,null),R(this,g).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},C))}),B.addEventListener("mouseleave",()=>{var P;clearTimeout(R(this,y)),we(this,y,null),(P=R(this,g))==null||P.classList.remove("show")})}B.classList.add("done"),F.innerText=R(this,f)?await G._l10nPromise.get("editor_alt_text_decorative_tooltip"):R(this,h),F.parentNode||B.append(F)},mf=function(B){if(!this._isDraggable)return;const F=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let Y,U;F&&(Y={passive:!0,capture:!0},U=P=>{const[$,W]=this.screenToPageTranslation(P.movementX,P.movementY);this._uiManager.dragSelectedEditors($,W)},window.addEventListener("pointermove",U,Y));const C=()=>{if(window.removeEventListener("pointerup",C),window.removeEventListener("blur",C),F&&window.removeEventListener("pointermove",U,Y),we(this,w,!1),!this._uiManager.endDragSession()){const{isMac:P}=r.FeatureTest.platform;B.ctrlKey&&!P||B.shiftKey||B.metaKey&&P?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",C),window.addEventListener("blur",C)},Se(G,L),ot(G,"_borderLineWidth",-1),ot(G,"_colorManager",new n.ColorManager),ot(G,"_zIndex",1),ot(G,"SMALL_EDITOR_SIZE",0);let c=G;e.AnnotationEditor=c;class u extends c{constructor(B){super(B),this.annotationElementId=B.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(s,e,t)=>{var v,_,E,x,w,uc,N,A,I,k,M,gf,D,q,J,ae,V,Z,G,ne,B,F,Y,U,C,P,$,W,te,ee,ce,he,Re,Ce,Ie,Ne,$e,ge,_e,X,se,fe,ve,Me,Be,Le,pe,yf,dc,hc,Ba,fc,pc,Dn,Sr,bf,_f,mc,wr,gc;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=o,e.opacityToHex=c;var n=t(1),r=t(6);function o(vt,oe,ke){for(const Ve of ke)oe.addEventListener(Ve,vt[Ve].bind(vt))}function c(vt){return Math.round(Math.min(255,Math.max(1,255*vt))).toString(16).padStart(2,"0")}class u{constructor(){Se(this,v,0)}getId(){return`${n.AnnotationEditorPrefix}${Er(this,v)._++}`}}v=new WeakMap;const O=class O{constructor(){Se(this,w);Se(this,_,(0,n.getUuid)());Se(this,E,0);Se(this,x,null)}static get _isSVGFittingCanvas(){const oe='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Ve=new OffscreenCanvas(1,3).getContext("2d"),at=new Image;at.src=oe;const Je=at.decode().then(()=>(Ve.drawImage(at,0,0,1,1,0,0,1,3),new Uint32Array(Ve.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,n.shadow)(this,"_isSVGFittingCanvas",Je)}async getFromFile(oe){const{lastModified:ke,name:Ve,size:at,type:Je}=oe;return de(this,w,uc).call(this,`${ke}_${Ve}_${at}_${Je}`,oe)}async getFromUrl(oe){return de(this,w,uc).call(this,oe,oe)}async getFromId(oe){R(this,x)||we(this,x,new Map);const ke=R(this,x).get(oe);return ke?ke.bitmap?(ke.refCounter+=1,ke):ke.file?this.getFromFile(ke.file):this.getFromUrl(ke.url):null}getSvgUrl(oe){const ke=R(this,x).get(oe);return ke!=null&&ke.isSvg?ke.svgUrl:null}deleteId(oe){R(this,x)||we(this,x,new Map);const ke=R(this,x).get(oe);ke&&(ke.refCounter-=1,ke.refCounter===0&&(ke.bitmap=null))}isValidId(oe){return oe.startsWith(`image_${R(this,_)}_`)}};_=new WeakMap,E=new WeakMap,x=new WeakMap,w=new WeakSet,uc=async function(oe,ke){R(this,x)||we(this,x,new Map);let Ve=R(this,x).get(oe);if(Ve===null)return null;if(Ve!=null&&Ve.bitmap)return Ve.refCounter+=1,Ve;try{Ve||(Ve={bitmap:null,id:`image_${R(this,_)}_${Er(this,E)._++}`,refCounter:0,isSvg:!1});let at;if(typeof ke=="string"){Ve.url=ke;const Je=await fetch(ke);if(!Je.ok)throw new Error(Je.statusText);at=await Je.blob()}else at=Ve.file=ke;if(at.type==="image/svg+xml"){const Je=O._isSVGFittingCanvas,et=new FileReader,ie=new Image,Q=new Promise((ue,Ae)=>{ie.onload=()=>{Ve.bitmap=ie,Ve.isSvg=!0,ue()},et.onload=async()=>{const Oe=Ve.svgUrl=et.result;ie.src=await Je?`${Oe}#svgView(preserveAspectRatio(none))`:Oe},ie.onerror=et.onerror=Ae});et.readAsDataURL(at),await Q}else Ve.bitmap=await createImageBitmap(at);Ve.refCounter=1}catch(at){console.error(at),Ve=null}return R(this,x).set(oe,Ve),Ve&&R(this,x).set(Ve.id,Ve),Ve};let h=O;class f{constructor(oe=128){Se(this,N,[]);Se(this,A,!1);Se(this,I);Se(this,k,-1);we(this,I,oe)}add({cmd:oe,undo:ke,mustExec:Ve,type:at=NaN,overwriteIfSameType:Je=!1,keepUndo:et=!1}){if(Ve&&oe(),R(this,A))return;const ie={cmd:oe,undo:ke,type:at};if(R(this,k)===-1){R(this,N).length>0&&(R(this,N).length=0),we(this,k,0),R(this,N).push(ie);return}if(Je&&R(this,N)[R(this,k)].type===at){et&&(ie.undo=R(this,N)[R(this,k)].undo),R(this,N)[R(this,k)]=ie;return}const Q=R(this,k)+1;Q===R(this,I)?R(this,N).splice(0,1):(we(this,k,Q),Q<R(this,N).length&&R(this,N).splice(Q)),R(this,N).push(ie)}undo(){R(this,k)!==-1&&(we(this,A,!0),R(this,N)[R(this,k)].undo(),we(this,A,!1),we(this,k,R(this,k)-1))}redo(){R(this,k)<R(this,N).length-1&&(we(this,k,R(this,k)+1),we(this,A,!0),R(this,N)[R(this,k)].cmd(),we(this,A,!1))}hasSomethingToUndo(){return R(this,k)!==-1}hasSomethingToRedo(){return R(this,k)<R(this,N).length-1}destroy(){we(this,N,null)}}N=new WeakMap,A=new WeakMap,I=new WeakMap,k=new WeakMap,e.CommandManager=f;class p{constructor(oe){Se(this,M);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:ke}=n.FeatureTest.platform;for(const[Ve,at,Je={}]of oe)for(const et of Ve){const ie=et.startsWith("mac+");ke&&ie?(this.callbacks.set(et.slice(4),{callback:at,options:Je}),this.allKeys.add(et.split("+").at(-1))):!ke&&!ie&&(this.callbacks.set(et,{callback:at,options:Je}),this.allKeys.add(et.split("+").at(-1)))}}exec(oe,ke){if(!this.allKeys.has(ke.key))return;const Ve=this.callbacks.get(de(this,M,gf).call(this,ke));if(!Ve)return;const{callback:at,options:{bubbles:Je=!1,args:et=[],checker:ie=null}}=Ve;ie&&!ie(oe,ke)||(at.bind(oe,...et)(),Je||(ke.stopPropagation(),ke.preventDefault()))}}M=new WeakSet,gf=function(oe){oe.altKey&&this.buffer.push("alt"),oe.ctrlKey&&this.buffer.push("ctrl"),oe.metaKey&&this.buffer.push("meta"),oe.shiftKey&&this.buffer.push("shift"),this.buffer.push(oe.key);const ke=this.buffer.join("+");return this.buffer.length=0,ke},e.KeyboardManager=p;const H=class H{get _colors(){const oe=new Map([["CanvasText",null],["Canvas",null]]);return(0,r.getColorValues)(oe),(0,n.shadow)(this,"_colors",oe)}convert(oe){const ke=(0,r.getRGB)(oe);if(!window.matchMedia("(forced-colors: active)").matches)return ke;for(const[Ve,at]of this._colors)if(at.every((Je,et)=>Je===ke[et]))return H._colorsMapping.get(Ve);return ke}getHexCode(oe){const ke=this._colors.get(oe);return ke?n.Util.makeHexColor(...ke):oe}};ot(H,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let g=H;e.ColorManager=g;const xt=class xt{constructor(oe,ke,Ve,at,Je,et){Se(this,pe);Se(this,D,null);Se(this,q,new Map);Se(this,J,new Map);Se(this,ae,null);Se(this,V,null);Se(this,Z,new f);Se(this,G,0);Se(this,ne,new Set);Se(this,B,null);Se(this,F,null);Se(this,Y,new Set);Se(this,U,null);Se(this,C,new u);Se(this,P,!1);Se(this,$,!1);Se(this,W,null);Se(this,te,n.AnnotationEditorType.NONE);Se(this,ee,new Set);Se(this,ce,null);Se(this,he,this.blur.bind(this));Se(this,Re,this.focus.bind(this));Se(this,Ce,this.copy.bind(this));Se(this,Ie,this.cut.bind(this));Se(this,Ne,this.paste.bind(this));Se(this,$e,this.keydown.bind(this));Se(this,ge,this.onEditingAction.bind(this));Se(this,_e,this.onPageChanging.bind(this));Se(this,X,this.onScaleChanging.bind(this));Se(this,se,this.onRotationChanging.bind(this));Se(this,fe,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Se(this,ve,[0,0]);Se(this,Me,null);Se(this,Be,null);Se(this,Le,null);we(this,Be,oe),we(this,Le,ke),we(this,ae,Ve),this._eventBus=at,this._eventBus._on("editingaction",R(this,ge)),this._eventBus._on("pagechanging",R(this,_e)),this._eventBus._on("scalechanging",R(this,X)),this._eventBus._on("rotationchanging",R(this,se)),we(this,V,Je.annotationStorage),we(this,U,Je.filterFactory),we(this,ce,et),this.viewParameters={realScale:r.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const oe=xt.prototype,ke=Je=>{const{activeElement:et}=document;return et&&R(Je,Be).contains(et)&&Je.hasSomethingToControl()},Ve=this.TRANSLATE_SMALL,at=this.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new p([[["ctrl+a","mac+meta+a"],oe.selectAll],[["ctrl+z","mac+meta+z"],oe.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],oe.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],oe.delete],[["Escape","mac+Escape"],oe.unselectAll],[["ArrowLeft","mac+ArrowLeft"],oe.translateSelectedEditors,{args:[-Ve,0],checker:ke}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],oe.translateSelectedEditors,{args:[-at,0],checker:ke}],[["ArrowRight","mac+ArrowRight"],oe.translateSelectedEditors,{args:[Ve,0],checker:ke}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],oe.translateSelectedEditors,{args:[at,0],checker:ke}],[["ArrowUp","mac+ArrowUp"],oe.translateSelectedEditors,{args:[0,-Ve],checker:ke}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],oe.translateSelectedEditors,{args:[0,-at],checker:ke}],[["ArrowDown","mac+ArrowDown"],oe.translateSelectedEditors,{args:[0,Ve],checker:ke}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],oe.translateSelectedEditors,{args:[0,at],checker:ke}]]))}destroy(){de(this,pe,Ba).call(this),de(this,pe,dc).call(this),this._eventBus._off("editingaction",R(this,ge)),this._eventBus._off("pagechanging",R(this,_e)),this._eventBus._off("scalechanging",R(this,X)),this._eventBus._off("rotationchanging",R(this,se));for(const oe of R(this,J).values())oe.destroy();R(this,J).clear(),R(this,q).clear(),R(this,Y).clear(),we(this,D,null),R(this,ee).clear(),R(this,Z).destroy(),R(this,ae).destroy()}get hcmFilter(){return(0,n.shadow)(this,"hcmFilter",R(this,ce)?R(this,U).addHCMFilter(R(this,ce).foreground,R(this,ce).background):"none")}get direction(){return(0,n.shadow)(this,"direction",getComputedStyle(R(this,Be)).direction)}editAltText(oe){var ke;(ke=R(this,ae))==null||ke.editAltText(this,oe)}onPageChanging({pageNumber:oe}){we(this,G,oe-1)}focusMainContainer(){R(this,Be).focus()}findParent(oe,ke){for(const Ve of R(this,J).values()){const{x:at,y:Je,width:et,height:ie}=Ve.div.getBoundingClientRect();if(oe>=at&&oe<=at+et&&ke>=Je&&ke<=Je+ie)return Ve}return null}disableUserSelect(oe=!1){R(this,Le).classList.toggle("noUserSelect",oe)}addShouldRescale(oe){R(this,Y).add(oe)}removeShouldRescale(oe){R(this,Y).delete(oe)}onScaleChanging({scale:oe}){this.commitOrRemove(),this.viewParameters.realScale=oe*r.PixelsPerInch.PDF_TO_CSS_UNITS;for(const ke of R(this,Y))ke.onScaleChanging()}onRotationChanging({pagesRotation:oe}){this.commitOrRemove(),this.viewParameters.rotation=oe}addToAnnotationStorage(oe){!oe.isEmpty()&&R(this,V)&&!R(this,V).has(oe.id)&&R(this,V).setValue(oe.id,oe)}blur(){if(!this.hasSelection)return;const{activeElement:oe}=document;for(const ke of R(this,ee))if(ke.div.contains(oe)){we(this,W,[ke,oe]),ke._focusEventsAllowed=!1;break}}focus(){if(!R(this,W))return;const[oe,ke]=R(this,W);we(this,W,null),ke.addEventListener("focusin",()=>{oe._focusEventsAllowed=!0},{once:!0}),ke.focus()}addEditListeners(){de(this,pe,hc).call(this),de(this,pe,fc).call(this)}removeEditListeners(){de(this,pe,Ba).call(this),de(this,pe,pc).call(this)}copy(oe){var Ve;if(oe.preventDefault(),(Ve=R(this,D))==null||Ve.commitOrRemove(),!this.hasSelection)return;const ke=[];for(const at of R(this,ee)){const Je=at.serialize(!0);Je&&ke.push(Je)}ke.length!==0&&oe.clipboardData.setData("application/pdfjs",JSON.stringify(ke))}cut(oe){this.copy(oe),this.delete()}paste(oe){oe.preventDefault();const{clipboardData:ke}=oe;for(const Je of ke.items)for(const et of R(this,F))if(et.isHandlingMimeForPasting(Je.type)){et.paste(Je,this.currentLayer);return}let Ve=ke.getData("application/pdfjs");if(!Ve)return;try{Ve=JSON.parse(Ve)}catch(Je){(0,n.warn)(`paste: "${Je.message}".`);return}if(!Array.isArray(Ve))return;this.unselectAll();const at=this.currentLayer;try{const Je=[];for(const Q of Ve){const ue=at.deserialize(Q);if(!ue)return;Je.push(ue)}const et=()=>{for(const Q of Je)de(this,pe,mc).call(this,Q);de(this,pe,gc).call(this,Je)},ie=()=>{for(const Q of Je)Q.remove()};this.addCommands({cmd:et,undo:ie,mustExec:!0})}catch(Je){(0,n.warn)(`paste: "${Je.message}".`)}}keydown(oe){var ke;(ke=this.getActive())!=null&&ke.shouldGetKeyboardEvents()||xt._keyboardManager.exec(this,oe)}onEditingAction(oe){["undo","redo","delete","selectAll"].includes(oe.name)&&this[oe.name]()}setEditingState(oe){oe?(de(this,pe,yf).call(this),de(this,pe,hc).call(this),de(this,pe,fc).call(this),de(this,pe,Dn).call(this,{isEditing:R(this,te)!==n.AnnotationEditorType.NONE,isEmpty:de(this,pe,wr).call(this),hasSomethingToUndo:R(this,Z).hasSomethingToUndo(),hasSomethingToRedo:R(this,Z).hasSomethingToRedo(),hasSelectedEditor:!1})):(de(this,pe,dc).call(this),de(this,pe,Ba).call(this),de(this,pe,pc).call(this),de(this,pe,Dn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(oe){if(!R(this,F)){we(this,F,oe);for(const ke of R(this,F))de(this,pe,Sr).call(this,ke.defaultPropertiesToUpdate)}}getId(){return R(this,C).getId()}get currentLayer(){return R(this,J).get(R(this,G))}getLayer(oe){return R(this,J).get(oe)}get currentPageIndex(){return R(this,G)}addLayer(oe){R(this,J).set(oe.pageIndex,oe),R(this,P)?oe.enable():oe.disable()}removeLayer(oe){R(this,J).delete(oe.pageIndex)}updateMode(oe,ke=null){if(R(this,te)!==oe){if(we(this,te,oe),oe===n.AnnotationEditorType.NONE){this.setEditingState(!1),de(this,pe,_f).call(this);return}this.setEditingState(!0),de(this,pe,bf).call(this),this.unselectAll();for(const Ve of R(this,J).values())Ve.updateMode(oe);if(ke){for(const Ve of R(this,q).values())if(Ve.annotationElementId===ke){this.setSelected(Ve),Ve.enterInEditMode();break}}}}updateToolbar(oe){oe!==R(this,te)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:oe})}updateParams(oe,ke){if(R(this,F)){if(oe===n.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(oe);return}for(const Ve of R(this,ee))Ve.updateParams(oe,ke);for(const Ve of R(this,F))Ve.updateDefaultParams(oe,ke)}}enableWaiting(oe=!1){if(R(this,$)!==oe){we(this,$,oe);for(const ke of R(this,J).values())oe?ke.disableClick():ke.enableClick(),ke.div.classList.toggle("waiting",oe)}}getEditors(oe){const ke=[];for(const Ve of R(this,q).values())Ve.pageIndex===oe&&ke.push(Ve);return ke}getEditor(oe){return R(this,q).get(oe)}addEditor(oe){R(this,q).set(oe.id,oe)}removeEditor(oe){var ke;R(this,q).delete(oe.id),this.unselect(oe),(!oe.annotationElementId||!R(this,ne).has(oe.annotationElementId))&&((ke=R(this,V))==null||ke.remove(oe.id))}addDeletedAnnotationElement(oe){R(this,ne).add(oe.annotationElementId),oe.deleted=!0}isDeletedAnnotationElement(oe){return R(this,ne).has(oe)}removeDeletedAnnotationElement(oe){R(this,ne).delete(oe.annotationElementId),oe.deleted=!1}setActiveEditor(oe){R(this,D)!==oe&&(we(this,D,oe),oe&&de(this,pe,Sr).call(this,oe.propertiesToUpdate))}toggleSelected(oe){if(R(this,ee).has(oe)){R(this,ee).delete(oe),oe.unselect(),de(this,pe,Dn).call(this,{hasSelectedEditor:this.hasSelection});return}R(this,ee).add(oe),oe.select(),de(this,pe,Sr).call(this,oe.propertiesToUpdate),de(this,pe,Dn).call(this,{hasSelectedEditor:!0})}setSelected(oe){for(const ke of R(this,ee))ke!==oe&&ke.unselect();R(this,ee).clear(),R(this,ee).add(oe),oe.select(),de(this,pe,Sr).call(this,oe.propertiesToUpdate),de(this,pe,Dn).call(this,{hasSelectedEditor:!0})}isSelected(oe){return R(this,ee).has(oe)}unselect(oe){oe.unselect(),R(this,ee).delete(oe),de(this,pe,Dn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return R(this,ee).size!==0}undo(){R(this,Z).undo(),de(this,pe,Dn).call(this,{hasSomethingToUndo:R(this,Z).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:de(this,pe,wr).call(this)})}redo(){R(this,Z).redo(),de(this,pe,Dn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:R(this,Z).hasSomethingToRedo(),isEmpty:de(this,pe,wr).call(this)})}addCommands(oe){R(this,Z).add(oe),de(this,pe,Dn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:de(this,pe,wr).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const oe=[...R(this,ee)],ke=()=>{for(const at of oe)at.remove()},Ve=()=>{for(const at of oe)de(this,pe,mc).call(this,at)};this.addCommands({cmd:ke,undo:Ve,mustExec:!0})}commitOrRemove(){var oe;(oe=R(this,D))==null||oe.commitOrRemove()}hasSomethingToControl(){return R(this,D)||this.hasSelection}selectAll(){for(const oe of R(this,ee))oe.commit();de(this,pe,gc).call(this,R(this,q).values())}unselectAll(){if(R(this,D)){R(this,D).commitOrRemove();return}if(this.hasSelection){for(const oe of R(this,ee))oe.unselect();R(this,ee).clear(),de(this,pe,Dn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(oe,ke,Ve=!1){if(Ve||this.commitOrRemove(),!this.hasSelection)return;R(this,ve)[0]+=oe,R(this,ve)[1]+=ke;const[at,Je]=R(this,ve),et=[...R(this,ee)],ie=1e3;R(this,Me)&&clearTimeout(R(this,Me)),we(this,Me,setTimeout(()=>{we(this,Me,null),R(this,ve)[0]=R(this,ve)[1]=0,this.addCommands({cmd:()=>{for(const Q of et)R(this,q).has(Q.id)&&Q.translateInPage(at,Je)},undo:()=>{for(const Q of et)R(this,q).has(Q.id)&&Q.translateInPage(-at,-Je)},mustExec:!1})},ie));for(const Q of et)Q.translateInPage(oe,ke)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),we(this,B,new Map);for(const oe of R(this,ee))R(this,B).set(oe,{savedX:oe.x,savedY:oe.y,savedPageIndex:oe.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!R(this,B))return!1;this.disableUserSelect(!1);const oe=R(this,B);we(this,B,null);let ke=!1;for(const[{x:at,y:Je,pageIndex:et},ie]of oe)ie.newX=at,ie.newY=Je,ie.newPageIndex=et,ke||(ke=at!==ie.savedX||Je!==ie.savedY||et!==ie.savedPageIndex);if(!ke)return!1;const Ve=(at,Je,et,ie)=>{if(R(this,q).has(at.id)){const Q=R(this,J).get(ie);Q?at._setParentAndPosition(Q,Je,et):(at.pageIndex=ie,at.x=Je,at.y=et)}};return this.addCommands({cmd:()=>{for(const[at,{newX:Je,newY:et,newPageIndex:ie}]of oe)Ve(at,Je,et,ie)},undo:()=>{for(const[at,{savedX:Je,savedY:et,savedPageIndex:ie}]of oe)Ve(at,Je,et,ie)},mustExec:!0}),!0}dragSelectedEditors(oe,ke){if(R(this,B))for(const Ve of R(this,B).keys())Ve.drag(oe,ke)}rebuild(oe){if(oe.parent===null){const ke=this.getLayer(oe.pageIndex);ke?(ke.changeParent(oe),ke.addOrRebuild(oe)):(this.addEditor(oe),this.addToAnnotationStorage(oe),oe.rebuild())}else oe.parent.addOrRebuild(oe)}isActive(oe){return R(this,D)===oe}getActive(){return R(this,D)}getMode(){return R(this,te)}get imageManager(){return(0,n.shadow)(this,"imageManager",new h)}};D=new WeakMap,q=new WeakMap,J=new WeakMap,ae=new WeakMap,V=new WeakMap,Z=new WeakMap,G=new WeakMap,ne=new WeakMap,B=new WeakMap,F=new WeakMap,Y=new WeakMap,U=new WeakMap,C=new WeakMap,P=new WeakMap,$=new WeakMap,W=new WeakMap,te=new WeakMap,ee=new WeakMap,ce=new WeakMap,he=new WeakMap,Re=new WeakMap,Ce=new WeakMap,Ie=new WeakMap,Ne=new WeakMap,$e=new WeakMap,ge=new WeakMap,_e=new WeakMap,X=new WeakMap,se=new WeakMap,fe=new WeakMap,ve=new WeakMap,Me=new WeakMap,Be=new WeakMap,Le=new WeakMap,pe=new WeakSet,yf=function(){window.addEventListener("focus",R(this,Re)),window.addEventListener("blur",R(this,he))},dc=function(){window.removeEventListener("focus",R(this,Re)),window.removeEventListener("blur",R(this,he))},hc=function(){window.addEventListener("keydown",R(this,$e),{capture:!0})},Ba=function(){window.removeEventListener("keydown",R(this,$e),{capture:!0})},fc=function(){document.addEventListener("copy",R(this,Ce)),document.addEventListener("cut",R(this,Ie)),document.addEventListener("paste",R(this,Ne))},pc=function(){document.removeEventListener("copy",R(this,Ce)),document.removeEventListener("cut",R(this,Ie)),document.removeEventListener("paste",R(this,Ne))},Dn=function(oe){Object.entries(oe).some(([Ve,at])=>R(this,fe)[Ve]!==at)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(R(this,fe),oe)})},Sr=function(oe){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:oe})},bf=function(){if(!R(this,P)){we(this,P,!0);for(const oe of R(this,J).values())oe.enable()}},_f=function(){if(this.unselectAll(),R(this,P)){we(this,P,!1);for(const oe of R(this,J).values())oe.disable()}},mc=function(oe){const ke=R(this,J).get(oe.pageIndex);ke?ke.addOrRebuild(oe):this.addEditor(oe)},wr=function(){if(R(this,q).size===0)return!0;if(R(this,q).size===1)for(const oe of R(this,q).values())return oe.isEmpty();return!1},gc=function(oe){R(this,ee).clear();for(const ke of oe)ke.isEmpty()||(R(this,ee).add(ke),ke.select());de(this,pe,Dn).call(this,{hasSelectedEditor:!0})},ot(xt,"TRANSLATE_SMALL",1),ot(xt,"TRANSLATE_BIG",10);let y=xt;e.AnnotationEditorUIManager=y},(s,e,t)=>{var G,ne,B,F,Y,U,C,P,$,W,te,ee,Rs,Cs,yc,Ha,za,Ar,Tr;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=k,e.getColorValues=q,e.getCurrentTransform=J,e.getCurrentTransformInverse=ae,e.getFilenameFromUrl=w,e.getPdfFilenameFromUrl=T,e.getRGB=D,e.getXfaPageViewport=H,e.isDataScheme=E,e.isPdfFile=x,e.isValidFetchUrl=N,e.loadScript=I,e.noContextMenu=A,e.setLayerDimensions=V;var n=t(7),r=t(1);const o="http://www.w3.org/2000/svg",Z=class Z{};ot(Z,"CSS",96),ot(Z,"PDF",72),ot(Z,"PDF_TO_CSS_UNITS",Z.CSS/Z.PDF);let c=Z;e.PixelsPerInch=c;class u extends n.BaseFilterFactory{constructor({docId:X,ownerDocument:se=globalThis.document}={}){super();Se(this,ee);Se(this,G);Se(this,ne);Se(this,B);Se(this,F);Se(this,Y);Se(this,U);Se(this,C);Se(this,P);Se(this,$);Se(this,W);Se(this,te,0);we(this,B,X),we(this,F,se)}addFilter(X){if(!X)return"none";let se=R(this,ee,Rs).get(X);if(se)return se;let fe,ve,Me,Be;if(X.length===1){const qe=X[0],pt=new Array(256);for(let dt=0;dt<256;dt++)pt[dt]=qe[dt]/255;Be=fe=ve=Me=pt.join(",")}else{const[qe,pt,dt]=X,Et=new Array(256),rt=new Array(256),ct=new Array(256);for(let yt=0;yt<256;yt++)Et[yt]=qe[yt]/255,rt[yt]=pt[yt]/255,ct[yt]=dt[yt]/255;fe=Et.join(","),ve=rt.join(","),Me=ct.join(","),Be=`${fe}${ve}${Me}`}if(se=R(this,ee,Rs).get(Be),se)return R(this,ee,Rs).set(X,se),se;const Le=`g_${R(this,B)}_transfer_map_${Er(this,te)._++}`,pe=`url(#${Le})`;R(this,ee,Rs).set(X,pe),R(this,ee,Rs).set(Be,pe);const Ge=de(this,ee,Ha).call(this,Le);return de(this,ee,Ar).call(this,fe,ve,Me,Ge),pe}addHCMFilter(X,se){var pt;const fe=`${X}-${se}`;if(R(this,U)===fe)return R(this,C);if(we(this,U,fe),we(this,C,"none"),(pt=R(this,Y))==null||pt.remove(),!X||!se)return R(this,C);const ve=de(this,ee,Tr).call(this,X);X=r.Util.makeHexColor(...ve);const Me=de(this,ee,Tr).call(this,se);if(se=r.Util.makeHexColor(...Me),R(this,ee,Cs).style.color="",X==="#000000"&&se==="#ffffff"||X===se)return R(this,C);const Be=new Array(256);for(let dt=0;dt<=255;dt++){const Et=dt/255;Be[dt]=Et<=.03928?Et/12.92:((Et+.055)/1.055)**2.4}const Le=Be.join(","),pe=`g_${R(this,B)}_hcm_filter`,Ge=we(this,P,de(this,ee,Ha).call(this,pe));de(this,ee,Ar).call(this,Le,Le,Le,Ge),de(this,ee,yc).call(this,Ge);const qe=(dt,Et)=>{const rt=ve[dt]/255,ct=Me[dt]/255,yt=new Array(Et+1);for(let mt=0;mt<=Et;mt++)yt[mt]=rt+mt/Et*(ct-rt);return yt.join(",")};return de(this,ee,Ar).call(this,qe(0,5),qe(1,5),qe(2,5),Ge),we(this,C,`url(#${pe})`),R(this,C)}addHighlightHCMFilter(X,se,fe,ve){var ct;const Me=`${X}-${se}-${fe}-${ve}`;if(R(this,$)===Me)return R(this,W);if(we(this,$,Me),we(this,W,"none"),(ct=R(this,P))==null||ct.remove(),!X||!se)return R(this,W);const[Be,Le]=[X,se].map(de(this,ee,Tr).bind(this));let pe=Math.round(.2126*Be[0]+.7152*Be[1]+.0722*Be[2]),Ge=Math.round(.2126*Le[0]+.7152*Le[1]+.0722*Le[2]),[qe,pt]=[fe,ve].map(de(this,ee,Tr).bind(this));Ge<pe&&([pe,Ge,qe,pt]=[Ge,pe,pt,qe]),R(this,ee,Cs).style.color="";const dt=(yt,mt,Fe)=>{const be=new Array(256),ye=(Ge-pe)/Fe,tt=yt/255,xt=(mt-yt)/(255*Fe);let vt=0;for(let oe=0;oe<=Fe;oe++){const ke=Math.round(pe+oe*ye),Ve=tt+oe*xt;for(let at=vt;at<=ke;at++)be[at]=Ve;vt=ke+1}for(let oe=vt;oe<256;oe++)be[oe]=be[vt-1];return be.join(",")},Et=`g_${R(this,B)}_hcm_highlight_filter`,rt=we(this,P,de(this,ee,Ha).call(this,Et));return de(this,ee,yc).call(this,rt),de(this,ee,Ar).call(this,dt(qe[0],pt[0],5),dt(qe[1],pt[1],5),dt(qe[2],pt[2],5),rt),we(this,W,`url(#${Et})`),R(this,W)}destroy(X=!1){X&&(R(this,C)||R(this,W))||(R(this,ne)&&(R(this,ne).parentNode.parentNode.remove(),we(this,ne,null)),R(this,G)&&(R(this,G).clear(),we(this,G,null)),we(this,te,0))}}G=new WeakMap,ne=new WeakMap,B=new WeakMap,F=new WeakMap,Y=new WeakMap,U=new WeakMap,C=new WeakMap,P=new WeakMap,$=new WeakMap,W=new WeakMap,te=new WeakMap,ee=new WeakSet,Rs=function(){return R(this,G)||we(this,G,new Map)},Cs=function(){if(!R(this,ne)){const X=R(this,F).createElement("div"),{style:se}=X;se.visibility="hidden",se.contain="strict",se.width=se.height=0,se.position="absolute",se.top=se.left=0,se.zIndex=-1;const fe=R(this,F).createElementNS(o,"svg");fe.setAttribute("width",0),fe.setAttribute("height",0),we(this,ne,R(this,F).createElementNS(o,"defs")),X.append(fe),fe.append(R(this,ne)),R(this,F).body.append(X)}return R(this,ne)},yc=function(X){const se=R(this,F).createElementNS(o,"feColorMatrix");se.setAttribute("type","matrix"),se.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),X.append(se)},Ha=function(X){const se=R(this,F).createElementNS(o,"filter");return se.setAttribute("color-interpolation-filters","sRGB"),se.setAttribute("id",X),R(this,ee,Cs).append(se),se},za=function(X,se,fe){const ve=R(this,F).createElementNS(o,se);ve.setAttribute("type","discrete"),ve.setAttribute("tableValues",fe),X.append(ve)},Ar=function(X,se,fe,ve){const Me=R(this,F).createElementNS(o,"feComponentTransfer");ve.append(Me),de(this,ee,za).call(this,Me,"feFuncR",X),de(this,ee,za).call(this,Me,"feFuncG",se),de(this,ee,za).call(this,Me,"feFuncB",fe)},Tr=function(X){return R(this,ee,Cs).style.color=X,D(getComputedStyle(R(this,ee,Cs)).getPropertyValue("color"))},e.DOMFilterFactory=u;class h extends n.BaseCanvasFactory{constructor({ownerDocument:_e=globalThis.document}={}){super(),this._document=_e}_createCanvas(_e,X){const se=this._document.createElement("canvas");return se.width=_e,se.height=X,se}}e.DOMCanvasFactory=h;async function f(ge,_e=!1){if(N(ge,document.baseURI)){const X=await fetch(ge);if(!X.ok)throw new Error(X.statusText);return _e?new Uint8Array(await X.arrayBuffer()):(0,r.stringToBytes)(await X.text())}return new Promise((X,se)=>{const fe=new XMLHttpRequest;fe.open("GET",ge,!0),_e&&(fe.responseType="arraybuffer"),fe.onreadystatechange=()=>{if(fe.readyState===XMLHttpRequest.DONE){if(fe.status===200||fe.status===0){let ve;if(_e&&fe.response?ve=new Uint8Array(fe.response):!_e&&fe.responseText&&(ve=(0,r.stringToBytes)(fe.responseText)),ve){X(ve);return}}se(new Error(fe.statusText))}},fe.send(null)})}class p extends n.BaseCMapReaderFactory{_fetchData(_e,X){return f(_e,this.isCompressed).then(se=>({cMapData:se,compressionType:X}))}}e.DOMCMapReaderFactory=p;class g extends n.BaseStandardFontDataFactory{_fetchData(_e){return f(_e,!0)}}e.DOMStandardFontDataFactory=g;class y extends n.BaseSVGFactory{_createSVG(_e){return document.createElementNS(o,_e)}}e.DOMSVGFactory=y;class v{constructor({viewBox:_e,scale:X,rotation:se,offsetX:fe=0,offsetY:ve=0,dontFlip:Me=!1}){this.viewBox=_e,this.scale=X,this.rotation=se,this.offsetX=fe,this.offsetY=ve;const Be=(_e[2]+_e[0])/2,Le=(_e[3]+_e[1])/2;let pe,Ge,qe,pt;switch(se%=360,se<0&&(se+=360),se){case 180:pe=-1,Ge=0,qe=0,pt=1;break;case 90:pe=0,Ge=1,qe=1,pt=0;break;case 270:pe=0,Ge=-1,qe=-1,pt=0;break;case 0:pe=1,Ge=0,qe=0,pt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Me&&(qe=-qe,pt=-pt);let dt,Et,rt,ct;pe===0?(dt=Math.abs(Le-_e[1])*X+fe,Et=Math.abs(Be-_e[0])*X+ve,rt=(_e[3]-_e[1])*X,ct=(_e[2]-_e[0])*X):(dt=Math.abs(Be-_e[0])*X+fe,Et=Math.abs(Le-_e[1])*X+ve,rt=(_e[2]-_e[0])*X,ct=(_e[3]-_e[1])*X),this.transform=[pe*X,Ge*X,qe*X,pt*X,dt-pe*X*Be-qe*X*Le,Et-Ge*X*Be-pt*X*Le],this.width=rt,this.height=ct}get rawDims(){const{viewBox:_e}=this;return(0,r.shadow)(this,"rawDims",{pageWidth:_e[2]-_e[0],pageHeight:_e[3]-_e[1],pageX:_e[0],pageY:_e[1]})}clone({scale:_e=this.scale,rotation:X=this.rotation,offsetX:se=this.offsetX,offsetY:fe=this.offsetY,dontFlip:ve=!1}={}){return new v({viewBox:this.viewBox.slice(),scale:_e,rotation:X,offsetX:se,offsetY:fe,dontFlip:ve})}convertToViewportPoint(_e,X){return r.Util.applyTransform([_e,X],this.transform)}convertToViewportRectangle(_e){const X=r.Util.applyTransform([_e[0],_e[1]],this.transform),se=r.Util.applyTransform([_e[2],_e[3]],this.transform);return[X[0],X[1],se[0],se[1]]}convertToPdfPoint(_e,X){return r.Util.applyInverseTransform([_e,X],this.transform)}}e.PageViewport=v;class _ extends r.BaseException{constructor(_e,X=0){super(_e,"RenderingCancelledException"),this.extraDelay=X}}e.RenderingCancelledException=_;function E(ge){const _e=ge.length;let X=0;for(;X<_e&&ge[X].trim()==="";)X++;return ge.substring(X,X+5).toLowerCase()==="data:"}function x(ge){return typeof ge=="string"&&/\.pdf$/i.test(ge)}function w(ge,_e=!1){return _e||([ge]=ge.split(/[#?]/,1)),ge.substring(ge.lastIndexOf("/")+1)}function T(ge,_e="document.pdf"){if(typeof ge!="string")return _e;if(E(ge))return(0,r.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),_e;const X=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,se=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,fe=X.exec(ge);let ve=se.exec(fe[1])||se.exec(fe[2])||se.exec(fe[3]);if(ve&&(ve=ve[0],ve.includes("%")))try{ve=se.exec(decodeURIComponent(ve))[0]}catch{}return ve||_e}class O{constructor(){ot(this,"started",Object.create(null));ot(this,"times",[])}time(_e){_e in this.started&&(0,r.warn)(`Timer is already running for ${_e}`),this.started[_e]=Date.now()}timeEnd(_e){_e in this.started||(0,r.warn)(`Timer has not been started for ${_e}`),this.times.push({name:_e,start:this.started[_e],end:Date.now()}),delete this.started[_e]}toString(){const _e=[];let X=0;for(const{name:se}of this.times)X=Math.max(se.length,X);for(const{name:se,start:fe,end:ve}of this.times)_e.push(`${se.padEnd(X)} ${ve-fe}ms
`);return _e.join("")}}e.StatTimer=O;function N(ge,_e){try{const{protocol:X}=_e?new URL(ge,_e):new URL(ge);return X==="http:"||X==="https:"}catch{return!1}}function A(ge){ge.preventDefault()}function I(ge,_e=!1){return new Promise((X,se)=>{const fe=document.createElement("script");fe.src=ge,fe.onload=function(ve){_e&&fe.remove(),X(ve)},fe.onerror=function(){se(new Error(`Cannot load script at: ${fe.src}`))},(document.head||document.documentElement).append(fe)})}function k(ge){console.log("Deprecated API usage: "+ge)}let M;class L{static toDateObject(_e){if(!_e||typeof _e!="string")return null;M||(M=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const X=M.exec(_e);if(!X)return null;const se=parseInt(X[1],10);let fe=parseInt(X[2],10);fe=fe>=1&&fe<=12?fe-1:0;let ve=parseInt(X[3],10);ve=ve>=1&&ve<=31?ve:1;let Me=parseInt(X[4],10);Me=Me>=0&&Me<=23?Me:0;let Be=parseInt(X[5],10);Be=Be>=0&&Be<=59?Be:0;let Le=parseInt(X[6],10);Le=Le>=0&&Le<=59?Le:0;const pe=X[7]||"Z";let Ge=parseInt(X[8],10);Ge=Ge>=0&&Ge<=23?Ge:0;let qe=parseInt(X[9],10)||0;return qe=qe>=0&&qe<=59?qe:0,pe==="-"?(Me+=Ge,Be+=qe):pe==="+"&&(Me-=Ge,Be-=qe),new Date(Date.UTC(se,fe,ve,Me,Be,Le))}}e.PDFDateString=L;function H(ge,{scale:_e=1,rotation:X=0}){const{width:se,height:fe}=ge.attributes.style,ve=[0,0,parseInt(se),parseInt(fe)];return new v({viewBox:ve,scale:_e,rotation:X})}function D(ge){if(ge.startsWith("#")){const _e=parseInt(ge.slice(1),16);return[(_e&16711680)>>16,(_e&65280)>>8,_e&255]}return ge.startsWith("rgb(")?ge.slice(4,-1).split(",").map(_e=>parseInt(_e)):ge.startsWith("rgba(")?ge.slice(5,-1).split(",").map(_e=>parseInt(_e)).slice(0,3):((0,r.warn)(`Not a valid color format: "${ge}"`),[0,0,0])}function q(ge){const _e=document.createElement("span");_e.style.visibility="hidden",document.body.append(_e);for(const X of ge.keys()){_e.style.color=X;const se=window.getComputedStyle(_e).color;ge.set(X,D(se))}_e.remove()}function J(ge){const{a:_e,b:X,c:se,d:fe,e:ve,f:Me}=ge.getTransform();return[_e,X,se,fe,ve,Me]}function ae(ge){const{a:_e,b:X,c:se,d:fe,e:ve,f:Me}=ge.getTransform().invertSelf();return[_e,X,se,fe,ve,Me]}function V(ge,_e,X=!1,se=!0){if(_e instanceof v){const{pageWidth:fe,pageHeight:ve}=_e.rawDims,{style:Me}=ge,Be=r.FeatureTest.isCSSRoundSupported,Le=`var(--scale-factor) * ${fe}px`,pe=`var(--scale-factor) * ${ve}px`,Ge=Be?`round(${Le}, 1px)`:`calc(${Le})`,qe=Be?`round(${pe}, 1px)`:`calc(${pe})`;!X||_e.rotation%180===0?(Me.width=Ge,Me.height=qe):(Me.width=qe,Me.height=Ge)}se&&ge.setAttribute("data-main-rotation",_e.rotation)}},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var n=t(1);class r{constructor(){this.constructor===r&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(p){return"none"}addHCMFilter(p,g){return"none"}addHighlightHCMFilter(p,g,y,v){return"none"}destroy(p=!1){}}e.BaseFilterFactory=r;class o{constructor(){this.constructor===o&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(p,g){if(p<=0||g<=0)throw new Error("Invalid canvas size");const y=this._createCanvas(p,g);return{canvas:y,context:y.getContext("2d")}}reset(p,g,y){if(!p.canvas)throw new Error("Canvas is not specified");if(g<=0||y<=0)throw new Error("Invalid canvas size");p.canvas.width=g,p.canvas.height=y}destroy(p){if(!p.canvas)throw new Error("Canvas is not specified");p.canvas.width=0,p.canvas.height=0,p.canvas=null,p.context=null}_createCanvas(p,g){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=o;class c{constructor({baseUrl:p=null,isCompressed:g=!0}){this.constructor===c&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=p,this.isCompressed=g}async fetch({name:p}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!p)throw new Error("CMap name must be specified.");const g=this.baseUrl+p+(this.isCompressed?".bcmap":""),y=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(g,y).catch(v=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${g}`)})}_fetchData(p,g){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=c;class u{constructor({baseUrl:p=null}){this.constructor===u&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=p}async fetch({filename:p}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!p)throw new Error("Font filename must be specified.");const g=`${this.baseUrl}${p}`;return this._fetchData(g).catch(y=>{throw new Error(`Unable to load font data at: ${g}`)})}_fetchData(p){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=u;class h{constructor(){this.constructor===h&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(p,g,y=!1){if(p<=0||g<=0)throw new Error("Invalid SVG dimensions");const v=this._createSVG("svg:svg");return v.setAttribute("version","1.1"),y||(v.setAttribute("width",`${p}px`),v.setAttribute("height",`${g}px`)),v.setAttribute("preserveAspectRatio","none"),v.setAttribute("viewBox",`0 0 ${p} ${g}`),v}createElement(p){if(typeof p!="string")throw new Error("Invalid SVG element type");return this._createSVG(p)}_createSVG(p){(0,n.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=h},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var n=t(1);const r=3285377520,o=4294901760,c=65535;class u{constructor(f){this.h1=f?f&4294967295:r,this.h2=f?f&4294967295:r}update(f){let p,g;if(typeof f=="string"){p=new Uint8Array(f.length*2),g=0;for(let k=0,M=f.length;k<M;k++){const L=f.charCodeAt(k);L<=255?p[g++]=L:(p[g++]=L>>>8,p[g++]=L&255)}}else if((0,n.isArrayBuffer)(f))p=f.slice(),g=p.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const y=g>>2,v=g-y*4,_=new Uint32Array(p.buffer,0,y);let E=0,x=0,w=this.h1,T=this.h2;const O=3432918353,N=461845907,A=O&c,I=N&c;for(let k=0;k<y;k++)k&1?(E=_[k],E=E*O&o|E*A&c,E=E<<15|E>>>17,E=E*N&o|E*I&c,w^=E,w=w<<13|w>>>19,w=w*5+3864292196):(x=_[k],x=x*O&o|x*A&c,x=x<<15|x>>>17,x=x*N&o|x*I&c,T^=x,T=T<<13|T>>>19,T=T*5+3864292196);switch(E=0,v){case 3:E^=p[y*4+2]<<16;case 2:E^=p[y*4+1]<<8;case 1:E^=p[y*4],E=E*O&o|E*A&c,E=E<<15|E>>>17,E=E*N&o|E*I&c,y&1?w^=E:T^=E}this.h1=w,this.h2=T}hexdigest(){let f=this.h1,p=this.h2;return f^=p>>>1,f=f*3981806797&o|f*36045&c,p=p*4283543511&o|((p<<16|f>>>16)*2950163797&o)>>>16,f^=p>>>1,f=f*444984403&o|f*60499&c,p=p*3301882366&o|((p<<16|f>>>16)*3120437893&o)>>>16,f^=p>>>1,(f>>>0).toString(16).padStart(8,"0")+(p>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=u},(s,e,t)=>{var c;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var n=t(1);class r{constructor({ownerDocument:h=globalThis.document,styleElement:f=null}){Se(this,c,new Set);this._document=h,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(h){this.nativeFontFaces.add(h),this._document.fonts.add(h)}removeNativeFontFace(h){this.nativeFontFaces.delete(h),this._document.fonts.delete(h)}insertRule(h){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const f=this.styleElement.sheet;f.insertRule(h,f.cssRules.length)}clear(){for(const h of this.nativeFontFaces)this._document.fonts.delete(h);this.nativeFontFaces.clear(),R(this,c).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(h){if(!(!h||R(this,c).has(h.loadedName))){if((0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:f,src:p,style:g}=h,y=new FontFace(f,p,g);this.addNativeFontFace(y);try{await y.load(),R(this,c).add(f)}catch{(0,n.warn)(`Cannot load system font: ${h.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(y)}return}(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(h){if(h.attached||h.missingFile&&!h.systemFontInfo)return;if(h.attached=!0,h.systemFontInfo){await this.loadSystemFont(h.systemFontInfo);return}if(this.isFontLoadingAPISupported){const p=h.createNativeFontFace();if(p){this.addNativeFontFace(p);try{await p.loaded}catch(g){throw(0,n.warn)(`Failed to load font '${p.family}': '${g}'.`),h.disableFontFace=!0,g}}return}const f=h.createFontFaceRule();if(f){if(this.insertRule(f),this.isSyncFontLoadingSupported)return;await new Promise(p=>{const g=this._queueLoadingCallback(p);this._prepareFontLoadEvent(h,g)})}}get isFontLoadingAPISupported(){var f;const h=!!((f=this._document)!=null&&f.fonts);return(0,n.shadow)(this,"isFontLoadingAPISupported",h)}get isSyncFontLoadingSupported(){let h=!1;return(n.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(h=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",h)}_queueLoadingCallback(h){function f(){for((0,n.assert)(!g.done,"completeRequest() cannot be called twice."),g.done=!0;p.length>0&&p[0].done;){const y=p.shift();setTimeout(y.callback,0)}}const{loadingRequests:p}=this,g={done:!1,complete:f,callback:h};return p.push(g),g}get _loadTestFont(){const h=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",h)}_prepareFontLoadEvent(h,f){function p(D,q){return D.charCodeAt(q)<<24|D.charCodeAt(q+1)<<16|D.charCodeAt(q+2)<<8|D.charCodeAt(q+3)&255}function g(D,q,J,ae){const V=D.substring(0,q),Z=D.substring(q+J);return V+ae+Z}let y,v;const _=this._document.createElement("canvas");_.width=1,_.height=1;const E=_.getContext("2d");let x=0;function w(D,q){if(++x>30){(0,n.warn)("Load test font never loaded."),q();return}if(E.font="30px "+D,E.fillText(".",0,20),E.getImageData(0,0,1,1).data[3]>0){q();return}setTimeout(w.bind(null,D,q))}const T=`lt${Date.now()}${this.loadTestFontId++}`;let O=this._loadTestFont;O=g(O,976,T.length,T);const A=16,I=1482184792;let k=p(O,A);for(y=0,v=T.length-3;y<v;y+=4)k=k-I+p(T,y)|0;y<T.length&&(k=k-I+p(T+"XXX",y)|0),O=g(O,A,4,(0,n.string32)(k));const M=`url(data:font/opentype;base64,${btoa(O)});`,L=`@font-face {font-family:"${T}";src:${M}}`;this.insertRule(L);const H=this._document.createElement("div");H.style.visibility="hidden",H.style.width=H.style.height="10px",H.style.position="absolute",H.style.top=H.style.left="0px";for(const D of[h.loadedName,T]){const q=this._document.createElement("span");q.textContent="Hi",q.style.fontFamily=D,H.append(q)}this._document.body.append(H),w(T,()=>{H.remove(),f.complete()})}}c=new WeakMap,e.FontLoader=r;class o{constructor(h,{isEvalSupported:f=!0,disableFontFace:p=!1,ignoreErrors:g=!1,inspectFont:y=null}){this.compiledGlyphs=Object.create(null);for(const v in h)this[v]=h[v];this.isEvalSupported=f!==!1,this.disableFontFace=p===!0,this.ignoreErrors=g===!0,this._inspectFont=y}createNativeFontFace(){var f;if(!this.data||this.disableFontFace)return null;let h;if(!this.cssFontInfo)h=new FontFace(this.loadedName,this.data,{});else{const p={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(p.style=`oblique ${this.cssFontInfo.italicAngle}deg`),h=new FontFace(this.cssFontInfo.fontFamily,this.data,p)}return(f=this._inspectFont)==null||f.call(this,this),h}createFontFaceRule(){var g;if(!this.data||this.disableFontFace)return null;const h=(0,n.bytesToString)(this.data),f=`url(data:${this.mimetype};base64,${btoa(h)});`;let p;if(!this.cssFontInfo)p=`@font-face {font-family:"${this.loadedName}";src:${f}}`;else{let y=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(y+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),p=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${y}src:${f}}`}return(g=this._inspectFont)==null||g.call(this,this,f),p}getPathGenerator(h,f){if(this.compiledGlyphs[f]!==void 0)return this.compiledGlyphs[f];let p;try{p=h.get(this.loadedName+"_path_"+f)}catch(g){if(!this.ignoreErrors)throw g;return(0,n.warn)(`getPathGenerator - ignoring character: "${g}".`),this.compiledGlyphs[f]=function(y,v){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const g=[];for(const y of p){const v=y.args!==void 0?y.args.join(","):"";g.push("c.",y.cmd,"(",v,`);
`)}return this.compiledGlyphs[f]=new Function("c","size",g.join(""))}return this.compiledGlyphs[f]=function(g,y){for(const v of p)v.cmd==="scale"&&(v.args=[y,-y]),g[v.cmd].apply(g,v.args)}}}e.FontFaceObject=o},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var n=t(7);t(1);const r=function(f){return new Promise((p,g)=>{require$$5.readFile(f,(v,_)=>{if(v||!_){g(new Error(v));return}p(new Uint8Array(_))})})};class o extends n.BaseFilterFactory{}e.NodeFilterFactory=o;class c extends n.BaseCanvasFactory{_createCanvas(p,g){return require$$5.createCanvas(p,g)}}e.NodeCanvasFactory=c;class u extends n.BaseCMapReaderFactory{_fetchData(p,g){return r(p).then(y=>({cMapData:y,compressionType:g}))}}e.NodeCMapReaderFactory=u;class h extends n.BaseStandardFontDataFactory{_fetchData(p){return r(p)}}e.NodeStandardFontDataFactory=h},(s,e,t)=>{var ne,bc,_c;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var n=t(1),r=t(6),o=t(12),c=t(13);const u=16,h=100,f=4096,p=15,g=10,y=1e3,v=16;function _(U,C){if(U._removeMirroring)throw new Error("Context is already forwarding operations.");U.__originalSave=U.save,U.__originalRestore=U.restore,U.__originalRotate=U.rotate,U.__originalScale=U.scale,U.__originalTranslate=U.translate,U.__originalTransform=U.transform,U.__originalSetTransform=U.setTransform,U.__originalResetTransform=U.resetTransform,U.__originalClip=U.clip,U.__originalMoveTo=U.moveTo,U.__originalLineTo=U.lineTo,U.__originalBezierCurveTo=U.bezierCurveTo,U.__originalRect=U.rect,U.__originalClosePath=U.closePath,U.__originalBeginPath=U.beginPath,U._removeMirroring=()=>{U.save=U.__originalSave,U.restore=U.__originalRestore,U.rotate=U.__originalRotate,U.scale=U.__originalScale,U.translate=U.__originalTranslate,U.transform=U.__originalTransform,U.setTransform=U.__originalSetTransform,U.resetTransform=U.__originalResetTransform,U.clip=U.__originalClip,U.moveTo=U.__originalMoveTo,U.lineTo=U.__originalLineTo,U.bezierCurveTo=U.__originalBezierCurveTo,U.rect=U.__originalRect,U.closePath=U.__originalClosePath,U.beginPath=U.__originalBeginPath,delete U._removeMirroring},U.save=function(){C.save(),this.__originalSave()},U.restore=function(){C.restore(),this.__originalRestore()},U.translate=function($,W){C.translate($,W),this.__originalTranslate($,W)},U.scale=function($,W){C.scale($,W),this.__originalScale($,W)},U.transform=function($,W,te,ee,ce,he){C.transform($,W,te,ee,ce,he),this.__originalTransform($,W,te,ee,ce,he)},U.setTransform=function($,W,te,ee,ce,he){C.setTransform($,W,te,ee,ce,he),this.__originalSetTransform($,W,te,ee,ce,he)},U.resetTransform=function(){C.resetTransform(),this.__originalResetTransform()},U.rotate=function($){C.rotate($),this.__originalRotate($)},U.clip=function($){C.clip($),this.__originalClip($)},U.moveTo=function(P,$){C.moveTo(P,$),this.__originalMoveTo(P,$)},U.lineTo=function(P,$){C.lineTo(P,$),this.__originalLineTo(P,$)},U.bezierCurveTo=function(P,$,W,te,ee,ce){C.bezierCurveTo(P,$,W,te,ee,ce),this.__originalBezierCurveTo(P,$,W,te,ee,ce)},U.rect=function(P,$,W,te){C.rect(P,$,W,te),this.__originalRect(P,$,W,te)},U.closePath=function(){C.closePath(),this.__originalClosePath()},U.beginPath=function(){C.beginPath(),this.__originalBeginPath()}}class E{constructor(C){this.canvasFactory=C,this.cache=Object.create(null)}getCanvas(C,P,$){let W;return this.cache[C]!==void 0?(W=this.cache[C],this.canvasFactory.reset(W,P,$)):(W=this.canvasFactory.create(P,$),this.cache[C]=W),W}delete(C){delete this.cache[C]}clear(){for(const C in this.cache){const P=this.cache[C];this.canvasFactory.destroy(P),delete this.cache[C]}}}function x(U,C,P,$,W,te,ee,ce,he,Re){const[Ce,Ie,Ne,$e,ge,_e]=(0,r.getCurrentTransform)(U);if(Ie===0&&Ne===0){const fe=ee*Ce+ge,ve=Math.round(fe),Me=ce*$e+_e,Be=Math.round(Me),Le=(ee+he)*Ce+ge,pe=Math.abs(Math.round(Le)-ve)||1,Ge=(ce+Re)*$e+_e,qe=Math.abs(Math.round(Ge)-Be)||1;return U.setTransform(Math.sign(Ce),0,0,Math.sign($e),ve,Be),U.drawImage(C,P,$,W,te,0,0,pe,qe),U.setTransform(Ce,Ie,Ne,$e,ge,_e),[pe,qe]}if(Ce===0&&$e===0){const fe=ce*Ne+ge,ve=Math.round(fe),Me=ee*Ie+_e,Be=Math.round(Me),Le=(ce+Re)*Ne+ge,pe=Math.abs(Math.round(Le)-ve)||1,Ge=(ee+he)*Ie+_e,qe=Math.abs(Math.round(Ge)-Be)||1;return U.setTransform(0,Math.sign(Ie),Math.sign(Ne),0,ve,Be),U.drawImage(C,P,$,W,te,0,0,qe,pe),U.setTransform(Ce,Ie,Ne,$e,ge,_e),[qe,pe]}U.drawImage(C,P,$,W,te,ee,ce,he,Re);const X=Math.hypot(Ce,Ie),se=Math.hypot(Ne,$e);return[X*he,se*Re]}function w(U){const{width:C,height:P}=U;if(C>y||P>y)return null;const $=1e3,W=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),te=C+1;let ee=new Uint8Array(te*(P+1)),ce,he,Re;const Ce=C+7&-8;let Ie=new Uint8Array(Ce*P),Ne=0;for(const se of U.data){let fe=128;for(;fe>0;)Ie[Ne++]=se&fe?0:255,fe>>=1}let $e=0;for(Ne=0,Ie[Ne]!==0&&(ee[0]=1,++$e),he=1;he<C;he++)Ie[Ne]!==Ie[Ne+1]&&(ee[he]=Ie[Ne]?2:1,++$e),Ne++;for(Ie[Ne]!==0&&(ee[he]=2,++$e),ce=1;ce<P;ce++){Ne=ce*Ce,Re=ce*te,Ie[Ne-Ce]!==Ie[Ne]&&(ee[Re]=Ie[Ne]?1:8,++$e);let se=(Ie[Ne]?4:0)+(Ie[Ne-Ce]?8:0);for(he=1;he<C;he++)se=(se>>2)+(Ie[Ne+1]?4:0)+(Ie[Ne-Ce+1]?8:0),W[se]&&(ee[Re+he]=W[se],++$e),Ne++;if(Ie[Ne-Ce]!==Ie[Ne]&&(ee[Re+he]=Ie[Ne]?2:4,++$e),$e>$)return null}for(Ne=Ce*(P-1),Re=ce*te,Ie[Ne]!==0&&(ee[Re]=8,++$e),he=1;he<C;he++)Ie[Ne]!==Ie[Ne+1]&&(ee[Re+he]=Ie[Ne]?4:8,++$e),Ne++;if(Ie[Ne]!==0&&(ee[Re+he]=4,++$e),$e>$)return null;const ge=new Int32Array([0,te,-1,0,-te,0,0,0,1]),_e=new Path2D;for(ce=0;$e&&ce<=P;ce++){let se=ce*te;const fe=se+C;for(;se<fe&&!ee[se];)se++;if(se===fe)continue;_e.moveTo(se%te,ce);const ve=se;let Me=ee[se];do{const Be=ge[Me];do se+=Be;while(!ee[se]);const Le=ee[se];Le!==5&&Le!==10?(Me=Le,ee[se]=0):(Me=Le&51*Me>>4,ee[se]&=Me>>2|Me<<2),_e.lineTo(se%te,se/te|0),ee[se]||--$e}while(ve!==se);--ce}return Ie=null,ee=null,function(se){se.save(),se.scale(1/C,-1/P),se.translate(0,-P),se.fill(_e),se.beginPath(),se.restore()}}class T{constructor(C,P){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,C,P])}clone(){const C=Object.create(this);return C.clipBox=this.clipBox.slice(),C}setCurrentPoint(C,P){this.x=C,this.y=P}updatePathMinMax(C,P,$){[P,$]=n.Util.applyTransform([P,$],C),this.minX=Math.min(this.minX,P),this.minY=Math.min(this.minY,$),this.maxX=Math.max(this.maxX,P),this.maxY=Math.max(this.maxY,$)}updateRectMinMax(C,P){const $=n.Util.applyTransform(P,C),W=n.Util.applyTransform(P.slice(2),C);this.minX=Math.min(this.minX,$[0],W[0]),this.minY=Math.min(this.minY,$[1],W[1]),this.maxX=Math.max(this.maxX,$[0],W[0]),this.maxY=Math.max(this.maxY,$[1],W[1])}updateScalingPathMinMax(C,P){n.Util.scaleMinMax(C,P),this.minX=Math.min(this.minX,P[0]),this.maxX=Math.max(this.maxX,P[1]),this.minY=Math.min(this.minY,P[2]),this.maxY=Math.max(this.maxY,P[3])}updateCurvePathMinMax(C,P,$,W,te,ee,ce,he,Re,Ce){const Ie=n.Util.bezierBoundingBox(P,$,W,te,ee,ce,he,Re);if(Ce){Ce[0]=Math.min(Ce[0],Ie[0],Ie[2]),Ce[1]=Math.max(Ce[1],Ie[0],Ie[2]),Ce[2]=Math.min(Ce[2],Ie[1],Ie[3]),Ce[3]=Math.max(Ce[3],Ie[1],Ie[3]);return}this.updateRectMinMax(C,Ie)}getPathBoundingBox(C=o.PathType.FILL,P=null){const $=[this.minX,this.minY,this.maxX,this.maxY];if(C===o.PathType.STROKE){P||(0,n.unreachable)("Stroke bounding box must include transform.");const W=n.Util.singularValueDecompose2dScale(P),te=W[0]*this.lineWidth/2,ee=W[1]*this.lineWidth/2;$[0]-=te,$[1]-=ee,$[2]+=te,$[3]+=ee}return $}updateClipFromPath(){const C=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(C||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(C){this.clipBox=C,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(C=o.PathType.FILL,P=null){return n.Util.intersect(this.clipBox,this.getPathBoundingBox(C,P))}}function O(U,C){if(typeof ImageData<"u"&&C instanceof ImageData){U.putImageData(C,0,0);return}const P=C.height,$=C.width,W=P%v,te=(P-W)/v,ee=W===0?te:te+1,ce=U.createImageData($,v);let he=0,Re;const Ce=C.data,Ie=ce.data;let Ne,$e,ge,_e;if(C.kind===n.ImageKind.GRAYSCALE_1BPP){const X=Ce.byteLength,se=new Uint32Array(Ie.buffer,0,Ie.byteLength>>2),fe=se.length,ve=$+7>>3,Me=4294967295,Be=n.FeatureTest.isLittleEndian?4278190080:255;for(Ne=0;Ne<ee;Ne++){for(ge=Ne<te?v:W,Re=0,$e=0;$e<ge;$e++){const Le=X-he;let pe=0;const Ge=Le>ve?$:Le*8-7,qe=Ge&-8;let pt=0,dt=0;for(;pe<qe;pe+=8)dt=Ce[he++],se[Re++]=dt&128?Me:Be,se[Re++]=dt&64?Me:Be,se[Re++]=dt&32?Me:Be,se[Re++]=dt&16?Me:Be,se[Re++]=dt&8?Me:Be,se[Re++]=dt&4?Me:Be,se[Re++]=dt&2?Me:Be,se[Re++]=dt&1?Me:Be;for(;pe<Ge;pe++)pt===0&&(dt=Ce[he++],pt=128),se[Re++]=dt&pt?Me:Be,pt>>=1}for(;Re<fe;)se[Re++]=0;U.putImageData(ce,0,Ne*v)}}else if(C.kind===n.ImageKind.RGBA_32BPP){for($e=0,_e=$*v*4,Ne=0;Ne<te;Ne++)Ie.set(Ce.subarray(he,he+_e)),he+=_e,U.putImageData(ce,0,$e),$e+=v;Ne<ee&&(_e=$*W*4,Ie.set(Ce.subarray(he,he+_e)),U.putImageData(ce,0,$e))}else if(C.kind===n.ImageKind.RGB_24BPP)for(ge=v,_e=$*ge,Ne=0;Ne<ee;Ne++){for(Ne>=te&&(ge=W,_e=$*ge),Re=0,$e=_e;$e--;)Ie[Re++]=Ce[he++],Ie[Re++]=Ce[he++],Ie[Re++]=Ce[he++],Ie[Re++]=255;U.putImageData(ce,0,Ne*v)}else throw new Error(`bad image kind: ${C.kind}`)}function N(U,C){if(C.bitmap){U.drawImage(C.bitmap,0,0);return}const P=C.height,$=C.width,W=P%v,te=(P-W)/v,ee=W===0?te:te+1,ce=U.createImageData($,v);let he=0;const Re=C.data,Ce=ce.data;for(let Ie=0;Ie<ee;Ie++){const Ne=Ie<te?v:W;({srcPos:he}=(0,c.convertBlackAndWhiteToRGBA)({src:Re,srcPos:he,dest:Ce,width:$,height:Ne,nonBlackColor:0})),U.putImageData(ce,0,Ie*v)}}function A(U,C){const P=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const $ of P)U[$]!==void 0&&(C[$]=U[$]);U.setLineDash!==void 0&&(C.setLineDash(U.getLineDash()),C.lineDashOffset=U.lineDashOffset)}function I(U){if(U.strokeStyle=U.fillStyle="#000000",U.fillRule="nonzero",U.globalAlpha=1,U.lineWidth=1,U.lineCap="butt",U.lineJoin="miter",U.miterLimit=10,U.globalCompositeOperation="source-over",U.font="10px sans-serif",U.setLineDash!==void 0&&(U.setLineDash([]),U.lineDashOffset=0),!n.isNodeJS){const{filter:C}=U;C!=="none"&&C!==""&&(U.filter="none")}}function k(U,C,P,$){const W=U.length;for(let te=3;te<W;te+=4){const ee=U[te];if(ee===0)U[te-3]=C,U[te-2]=P,U[te-1]=$;else if(ee<255){const ce=255-ee;U[te-3]=U[te-3]*ee+C*ce>>8,U[te-2]=U[te-2]*ee+P*ce>>8,U[te-1]=U[te-1]*ee+$*ce>>8}}}function M(U,C,P){const $=U.length,W=1/255;for(let te=3;te<$;te+=4){const ee=P?P[U[te]]:U[te];C[te]=C[te]*ee*W|0}}function L(U,C,P){const $=U.length;for(let W=3;W<$;W+=4){const te=U[W-3]*77+U[W-2]*152+U[W-1]*28;C[W]=P?C[W]*P[te>>8]>>8:C[W]*te>>16}}function H(U,C,P,$,W,te,ee,ce,he,Re,Ce){const Ie=!!te,Ne=Ie?te[0]:0,$e=Ie?te[1]:0,ge=Ie?te[2]:0,_e=W==="Luminosity"?L:M,se=Math.min($,Math.ceil(1048576/P));for(let fe=0;fe<$;fe+=se){const ve=Math.min(se,$-fe),Me=U.getImageData(ce-Re,fe+(he-Ce),P,ve),Be=C.getImageData(ce,fe+he,P,ve);Ie&&k(Me.data,Ne,$e,ge),_e(Me.data,Be.data,ee),C.putImageData(Be,ce,fe+he)}}function D(U,C,P,$){const W=$[0],te=$[1],ee=$[2]-W,ce=$[3]-te;ee===0||ce===0||(H(C.context,P,ee,ce,C.subtype,C.backdrop,C.transferMap,W,te,C.offsetX,C.offsetY),U.save(),U.globalAlpha=1,U.globalCompositeOperation="source-over",U.setTransform(1,0,0,1,0,0),U.drawImage(P.canvas,0,0),U.restore())}function q(U,C){const P=n.Util.singularValueDecompose2dScale(U);P[0]=Math.fround(P[0]),P[1]=Math.fround(P[1]);const $=Math.fround((globalThis.devicePixelRatio||1)*r.PixelsPerInch.PDF_TO_CSS_UNITS);return C!==void 0?C:P[0]<=$||P[1]<=$}const J=["butt","round","square"],ae=["miter","round","bevel"],V={},Z={},Y=class Y{constructor(C,P,$,W,te,{optionalContentConfig:ee,markedContentStack:ce=null},he,Re){Se(this,ne);this.ctx=C,this.current=new T(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=P,this.objs=$,this.canvasFactory=W,this.filterFactory=te,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=ce||[],this.optionalContentConfig=ee,this.cachedCanvases=new E(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=he,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=Re,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(C,P=null){return typeof C=="string"?C.startsWith("g_")?this.commonObjs.get(C):this.objs.get(C):P}beginDrawing({transform:C,viewport:P,transparency:$=!1,background:W=null}){const te=this.ctx.canvas.width,ee=this.ctx.canvas.height,ce=this.ctx.fillStyle;if(this.ctx.fillStyle=W||"#ffffff",this.ctx.fillRect(0,0,te,ee),this.ctx.fillStyle=ce,$){const he=this.cachedCanvases.getCanvas("transparent",te,ee);this.compositeCtx=this.ctx,this.transparentCanvas=he.canvas,this.ctx=he.context,this.ctx.save(),this.ctx.transform(...(0,r.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),I(this.ctx),C&&(this.ctx.transform(...C),this.outputScaleX=C[0],this.outputScaleY=C[0]),this.ctx.transform(...P.transform),this.viewportScale=P.scale,this.baseTransform=(0,r.getCurrentTransform)(this.ctx)}executeOperatorList(C,P,$,W){const te=C.argsArray,ee=C.fnArray;let ce=P||0;const he=te.length;if(he===ce)return ce;const Re=he-ce>g&&typeof $=="function",Ce=Re?Date.now()+p:0;let Ie=0;const Ne=this.commonObjs,$e=this.objs;let ge;for(;;){if(W!==void 0&&ce===W.nextBreakPoint)return W.breakIt(ce,$),ce;if(ge=ee[ce],ge!==n.OPS.dependency)this[ge].apply(this,te[ce]);else for(const _e of te[ce]){const X=_e.startsWith("g_")?Ne:$e;if(!X.has(_e))return X.get(_e,$),ce}if(ce++,ce===he)return ce;if(Re&&++Ie>g){if(Date.now()>Ce)return $(),ce;Ie=0}}}endDrawing(){de(this,ne,bc).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const C of this._cachedBitmapsMap.values()){for(const P of C.values())typeof HTMLCanvasElement<"u"&&P instanceof HTMLCanvasElement&&(P.width=P.height=0);C.clear()}this._cachedBitmapsMap.clear(),de(this,ne,_c).call(this)}_scaleImage(C,P){const $=C.width,W=C.height;let te=Math.max(Math.hypot(P[0],P[1]),1),ee=Math.max(Math.hypot(P[2],P[3]),1),ce=$,he=W,Re="prescale1",Ce,Ie;for(;te>2&&ce>1||ee>2&&he>1;){let Ne=ce,$e=he;te>2&&ce>1&&(Ne=ce>=16384?Math.floor(ce/2)-1||1:Math.ceil(ce/2),te/=ce/Ne),ee>2&&he>1&&($e=he>=16384?Math.floor(he/2)-1||1:Math.ceil(he)/2,ee/=he/$e),Ce=this.cachedCanvases.getCanvas(Re,Ne,$e),Ie=Ce.context,Ie.clearRect(0,0,Ne,$e),Ie.drawImage(C,0,0,ce,he,0,0,Ne,$e),C=Ce.canvas,ce=Ne,he=$e,Re=Re==="prescale1"?"prescale2":"prescale1"}return{img:C,paintWidth:ce,paintHeight:he}}_createMaskCanvas(C){const P=this.ctx,{width:$,height:W}=C,te=this.current.fillColor,ee=this.current.patternFill,ce=(0,r.getCurrentTransform)(P);let he,Re,Ce,Ie;if((C.bitmap||C.data)&&C.count>1){const pe=C.bitmap||C.data.buffer;Re=JSON.stringify(ee?ce:[ce.slice(0,4),te]),he=this._cachedBitmapsMap.get(pe),he||(he=new Map,this._cachedBitmapsMap.set(pe,he));const Ge=he.get(Re);if(Ge&&!ee){const qe=Math.round(Math.min(ce[0],ce[2])+ce[4]),pt=Math.round(Math.min(ce[1],ce[3])+ce[5]);return{canvas:Ge,offsetX:qe,offsetY:pt}}Ce=Ge}Ce||(Ie=this.cachedCanvases.getCanvas("maskCanvas",$,W),N(Ie.context,C));let Ne=n.Util.transform(ce,[1/$,0,0,-1/W,0,0]);Ne=n.Util.transform(Ne,[1,0,0,1,0,-W]);const $e=n.Util.applyTransform([0,0],Ne),ge=n.Util.applyTransform([$,W],Ne),_e=n.Util.normalizeRect([$e[0],$e[1],ge[0],ge[1]]),X=Math.round(_e[2]-_e[0])||1,se=Math.round(_e[3]-_e[1])||1,fe=this.cachedCanvases.getCanvas("fillCanvas",X,se),ve=fe.context,Me=Math.min($e[0],ge[0]),Be=Math.min($e[1],ge[1]);ve.translate(-Me,-Be),ve.transform(...Ne),Ce||(Ce=this._scaleImage(Ie.canvas,(0,r.getCurrentTransformInverse)(ve)),Ce=Ce.img,he&&ee&&he.set(Re,Ce)),ve.imageSmoothingEnabled=q((0,r.getCurrentTransform)(ve),C.interpolate),x(ve,Ce,0,0,Ce.width,Ce.height,0,0,$,W),ve.globalCompositeOperation="source-in";const Le=n.Util.transform((0,r.getCurrentTransformInverse)(ve),[1,0,0,1,-Me,-Be]);return ve.fillStyle=ee?te.getPattern(P,this,Le,o.PathType.FILL):te,ve.fillRect(0,0,$,W),he&&!ee&&(this.cachedCanvases.delete("fillCanvas"),he.set(Re,fe.canvas)),{canvas:fe.canvas,offsetX:Math.round(Me),offsetY:Math.round(Be)}}setLineWidth(C){C!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=C,this.ctx.lineWidth=C}setLineCap(C){this.ctx.lineCap=J[C]}setLineJoin(C){this.ctx.lineJoin=ae[C]}setMiterLimit(C){this.ctx.miterLimit=C}setDash(C,P){const $=this.ctx;$.setLineDash!==void 0&&($.setLineDash(C),$.lineDashOffset=P)}setRenderingIntent(C){}setFlatness(C){}setGState(C){for(const[P,$]of C)switch(P){case"LW":this.setLineWidth($);break;case"LC":this.setLineCap($);break;case"LJ":this.setLineJoin($);break;case"ML":this.setMiterLimit($);break;case"D":this.setDash($[0],$[1]);break;case"RI":this.setRenderingIntent($);break;case"FL":this.setFlatness($);break;case"Font":this.setFont($[0],$[1]);break;case"CA":this.current.strokeAlpha=$;break;case"ca":this.current.fillAlpha=$,this.ctx.globalAlpha=$;break;case"BM":this.ctx.globalCompositeOperation=$;break;case"SMask":this.current.activeSMask=$?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter($);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const C=this.inSMaskMode;this.current.activeSMask&&!C?this.beginSMaskMode():!this.current.activeSMask&&C&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const C=this.ctx.canvas.width,P=this.ctx.canvas.height,$="smaskGroupAt"+this.groupLevel,W=this.cachedCanvases.getCanvas($,C,P);this.suspendedCtx=this.ctx,this.ctx=W.context;const te=this.ctx;te.setTransform(...(0,r.getCurrentTransform)(this.suspendedCtx)),A(this.suspendedCtx,te),_(te,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),A(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(C){if(!this.current.activeSMask)return;C?(C[0]=Math.floor(C[0]),C[1]=Math.floor(C[1]),C[2]=Math.ceil(C[2]),C[3]=Math.ceil(C[3])):C=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const P=this.current.activeSMask,$=this.suspendedCtx;D($,P,this.ctx,C),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(A(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const C=this.current;this.stateStack.push(C),this.current=C.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),A(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(C,P,$,W,te,ee){this.ctx.transform(C,P,$,W,te,ee),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(C,P,$){const W=this.ctx,te=this.current;let ee=te.x,ce=te.y,he,Re;const Ce=(0,r.getCurrentTransform)(W),Ie=Ce[0]===0&&Ce[3]===0||Ce[1]===0&&Ce[2]===0,Ne=Ie?$.slice(0):null;for(let $e=0,ge=0,_e=C.length;$e<_e;$e++)switch(C[$e]|0){case n.OPS.rectangle:ee=P[ge++],ce=P[ge++];const X=P[ge++],se=P[ge++],fe=ee+X,ve=ce+se;W.moveTo(ee,ce),X===0||se===0?W.lineTo(fe,ve):(W.lineTo(fe,ce),W.lineTo(fe,ve),W.lineTo(ee,ve)),Ie||te.updateRectMinMax(Ce,[ee,ce,fe,ve]),W.closePath();break;case n.OPS.moveTo:ee=P[ge++],ce=P[ge++],W.moveTo(ee,ce),Ie||te.updatePathMinMax(Ce,ee,ce);break;case n.OPS.lineTo:ee=P[ge++],ce=P[ge++],W.lineTo(ee,ce),Ie||te.updatePathMinMax(Ce,ee,ce);break;case n.OPS.curveTo:he=ee,Re=ce,ee=P[ge+4],ce=P[ge+5],W.bezierCurveTo(P[ge],P[ge+1],P[ge+2],P[ge+3],ee,ce),te.updateCurvePathMinMax(Ce,he,Re,P[ge],P[ge+1],P[ge+2],P[ge+3],ee,ce,Ne),ge+=6;break;case n.OPS.curveTo2:he=ee,Re=ce,W.bezierCurveTo(ee,ce,P[ge],P[ge+1],P[ge+2],P[ge+3]),te.updateCurvePathMinMax(Ce,he,Re,ee,ce,P[ge],P[ge+1],P[ge+2],P[ge+3],Ne),ee=P[ge+2],ce=P[ge+3],ge+=4;break;case n.OPS.curveTo3:he=ee,Re=ce,ee=P[ge+2],ce=P[ge+3],W.bezierCurveTo(P[ge],P[ge+1],ee,ce,ee,ce),te.updateCurvePathMinMax(Ce,he,Re,P[ge],P[ge+1],ee,ce,ee,ce,Ne),ge+=4;break;case n.OPS.closePath:W.closePath();break}Ie&&te.updateScalingPathMinMax(Ce,Ne),te.setCurrentPoint(ee,ce)}closePath(){this.ctx.closePath()}stroke(C=!0){const P=this.ctx,$=this.current.strokeColor;P.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof $=="object"&&($!=null&&$.getPattern)?(P.save(),P.strokeStyle=$.getPattern(P,this,(0,r.getCurrentTransformInverse)(P),o.PathType.STROKE),this.rescaleAndStroke(!1),P.restore()):this.rescaleAndStroke(!0)),C&&this.consumePath(this.current.getClippedPathBoundingBox()),P.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(C=!0){const P=this.ctx,$=this.current.fillColor,W=this.current.patternFill;let te=!1;W&&(P.save(),P.fillStyle=$.getPattern(P,this,(0,r.getCurrentTransformInverse)(P),o.PathType.FILL),te=!0);const ee=this.current.getClippedPathBoundingBox();this.contentVisible&&ee!==null&&(this.pendingEOFill?(P.fill("evenodd"),this.pendingEOFill=!1):P.fill()),te&&P.restore(),C&&this.consumePath(ee)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=V}eoClip(){this.pendingClip=Z}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const C=this.pendingTextPaths,P=this.ctx;if(C===void 0){P.beginPath();return}P.save(),P.beginPath();for(const $ of C)P.setTransform(...$.transform),P.translate($.x,$.y),$.addToPath(P,$.fontSize);P.restore(),P.clip(),P.beginPath(),delete this.pendingTextPaths}setCharSpacing(C){this.current.charSpacing=C}setWordSpacing(C){this.current.wordSpacing=C}setHScale(C){this.current.textHScale=C/100}setLeading(C){this.current.leading=-C}setFont(C,P){var Ce;const $=this.commonObjs.get(C),W=this.current;if(!$)throw new Error(`Can't find font for ${C}`);if(W.fontMatrix=$.fontMatrix||n.FONT_IDENTITY_MATRIX,(W.fontMatrix[0]===0||W.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+C),P<0?(P=-P,W.fontDirection=-1):W.fontDirection=1,this.current.font=$,this.current.fontSize=P,$.isType3Font)return;const te=$.loadedName||"sans-serif",ee=((Ce=$.systemFontInfo)==null?void 0:Ce.css)||`"${te}", ${$.fallbackName}`;let ce="normal";$.black?ce="900":$.bold&&(ce="bold");const he=$.italic?"italic":"normal";let Re=P;P<u?Re=u:P>h&&(Re=h),this.current.fontSizeScale=P/Re,this.ctx.font=`${he} ${ce} ${Re}px ${ee}`}setTextRenderingMode(C){this.current.textRenderingMode=C}setTextRise(C){this.current.textRise=C}moveText(C,P){this.current.x=this.current.lineX+=C,this.current.y=this.current.lineY+=P}setLeadingMoveText(C,P){this.setLeading(-P),this.moveText(C,P)}setTextMatrix(C,P,$,W,te,ee){this.current.textMatrix=[C,P,$,W,te,ee],this.current.textMatrixScale=Math.hypot(C,P),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(C,P,$,W){const te=this.ctx,ee=this.current,ce=ee.font,he=ee.textRenderingMode,Re=ee.fontSize/ee.fontSizeScale,Ce=he&n.TextRenderingMode.FILL_STROKE_MASK,Ie=!!(he&n.TextRenderingMode.ADD_TO_PATH_FLAG),Ne=ee.patternFill&&!ce.missingFile;let $e;(ce.disableFontFace||Ie||Ne)&&($e=ce.getPathGenerator(this.commonObjs,C)),ce.disableFontFace||Ne?(te.save(),te.translate(P,$),te.beginPath(),$e(te,Re),W&&te.setTransform(...W),(Ce===n.TextRenderingMode.FILL||Ce===n.TextRenderingMode.FILL_STROKE)&&te.fill(),(Ce===n.TextRenderingMode.STROKE||Ce===n.TextRenderingMode.FILL_STROKE)&&te.stroke(),te.restore()):((Ce===n.TextRenderingMode.FILL||Ce===n.TextRenderingMode.FILL_STROKE)&&te.fillText(C,P,$),(Ce===n.TextRenderingMode.STROKE||Ce===n.TextRenderingMode.FILL_STROKE)&&te.strokeText(C,P,$)),Ie&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,r.getCurrentTransform)(te),x:P,y:$,fontSize:Re,addToPath:$e})}get isFontSubpixelAAEnabled(){const{context:C}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);C.scale(1.5,1),C.fillText("I",0,10);const P=C.getImageData(0,0,10,10).data;let $=!1;for(let W=3;W<P.length;W+=4)if(P[W]>0&&P[W]<255){$=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",$)}showText(C){const P=this.current,$=P.font;if($.isType3Font)return this.showType3Text(C);const W=P.fontSize;if(W===0)return;const te=this.ctx,ee=P.fontSizeScale,ce=P.charSpacing,he=P.wordSpacing,Re=P.fontDirection,Ce=P.textHScale*Re,Ie=C.length,Ne=$.vertical,$e=Ne?1:-1,ge=$.defaultVMetrics,_e=W*P.fontMatrix[0],X=P.textRenderingMode===n.TextRenderingMode.FILL&&!$.disableFontFace&&!P.patternFill;te.save(),te.transform(...P.textMatrix),te.translate(P.x,P.y+P.textRise),Re>0?te.scale(Ce,-1):te.scale(Ce,1);let se;if(P.patternFill){te.save();const Le=P.fillColor.getPattern(te,this,(0,r.getCurrentTransformInverse)(te),o.PathType.FILL);se=(0,r.getCurrentTransform)(te),te.restore(),te.fillStyle=Le}let fe=P.lineWidth;const ve=P.textMatrixScale;if(ve===0||fe===0){const Le=P.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(Le===n.TextRenderingMode.STROKE||Le===n.TextRenderingMode.FILL_STROKE)&&(fe=this.getSinglePixelWidth())}else fe/=ve;if(ee!==1&&(te.scale(ee,ee),fe/=ee),te.lineWidth=fe,$.isInvalidPDFjsFont){const Le=[];let pe=0;for(const Ge of C)Le.push(Ge.unicode),pe+=Ge.width;te.fillText(Le.join(""),0,0),P.x+=pe*_e*Ce,te.restore(),this.compose();return}let Me=0,Be;for(Be=0;Be<Ie;++Be){const Le=C[Be];if(typeof Le=="number"){Me+=$e*Le*W/1e3;continue}let pe=!1;const Ge=(Le.isSpace?he:0)+ce,qe=Le.fontChar,pt=Le.accent;let dt,Et,rt=Le.width;if(Ne){const yt=Le.vmetric||ge,mt=-(Le.vmetric?yt[1]:rt*.5)*_e,Fe=yt[2]*_e;rt=yt?-yt[0]:rt,dt=mt/ee,Et=(Me+Fe)/ee}else dt=Me/ee,Et=0;if($.remeasure&&rt>0){const yt=te.measureText(qe).width*1e3/W*ee;if(rt<yt&&this.isFontSubpixelAAEnabled){const mt=rt/yt;pe=!0,te.save(),te.scale(mt,1),dt/=mt}else rt!==yt&&(dt+=(rt-yt)/2e3*W/ee)}if(this.contentVisible&&(Le.isInFont||$.missingFile)){if(X&&!pt)te.fillText(qe,dt,Et);else if(this.paintChar(qe,dt,Et,se),pt){const yt=dt+W*pt.offset.x/ee,mt=Et-W*pt.offset.y/ee;this.paintChar(pt.fontChar,yt,mt,se)}}const ct=Ne?rt*_e-Ge*Re:rt*_e+Ge*Re;Me+=ct,pe&&te.restore()}Ne?P.y-=Me:P.x+=Me*Ce,te.restore(),this.compose()}showType3Text(C){const P=this.ctx,$=this.current,W=$.font,te=$.fontSize,ee=$.fontDirection,ce=W.vertical?1:-1,he=$.charSpacing,Re=$.wordSpacing,Ce=$.textHScale*ee,Ie=$.fontMatrix||n.FONT_IDENTITY_MATRIX,Ne=C.length,$e=$.textRenderingMode===n.TextRenderingMode.INVISIBLE;let ge,_e,X,se;if(!($e||te===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,P.save(),P.transform(...$.textMatrix),P.translate($.x,$.y),P.scale(Ce,ee),ge=0;ge<Ne;++ge){if(_e=C[ge],typeof _e=="number"){se=ce*_e*te/1e3,this.ctx.translate(se,0),$.x+=se*Ce;continue}const fe=(_e.isSpace?Re:0)+he,ve=W.charProcOperatorList[_e.operatorListId];if(!ve){(0,n.warn)(`Type3 character "${_e.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=_e,this.save(),P.scale(te,te),P.transform(...Ie),this.executeOperatorList(ve),this.restore()),X=n.Util.applyTransform([_e.width,0],Ie)[0]*te+fe,P.translate(X,0),$.x+=X*Ce}P.restore(),this.processingType3=null}}setCharWidth(C,P){}setCharWidthAndBounds(C,P,$,W,te,ee){this.ctx.rect($,W,te-$,ee-W),this.ctx.clip(),this.endPath()}getColorN_Pattern(C){let P;if(C[0]==="TilingPattern"){const $=C[1],W=this.baseTransform||(0,r.getCurrentTransform)(this.ctx),te={createCanvasGraphics:ee=>new Y(ee,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};P=new o.TilingPattern(C,$,this.ctx,te,W)}else P=this._getPattern(C[1],C[2]);return P}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(C,P,$){const W=n.Util.makeHexColor(C,P,$);this.ctx.strokeStyle=W,this.current.strokeColor=W}setFillRGBColor(C,P,$){const W=n.Util.makeHexColor(C,P,$);this.ctx.fillStyle=W,this.current.fillColor=W,this.current.patternFill=!1}_getPattern(C,P=null){let $;return this.cachedPatterns.has(C)?$=this.cachedPatterns.get(C):($=(0,o.getShadingPattern)(this.getObject(C)),this.cachedPatterns.set(C,$)),P&&($.matrix=P),$}shadingFill(C){if(!this.contentVisible)return;const P=this.ctx;this.save();const $=this._getPattern(C);P.fillStyle=$.getPattern(P,this,(0,r.getCurrentTransformInverse)(P),o.PathType.SHADING);const W=(0,r.getCurrentTransformInverse)(P);if(W){const{width:te,height:ee}=P.canvas,[ce,he,Re,Ce]=n.Util.getAxialAlignedBoundingBox([0,0,te,ee],W);this.ctx.fillRect(ce,he,Re-ce,Ce-he)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(C,P){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(C)&&C.length===6&&this.transform(...C),this.baseTransform=(0,r.getCurrentTransform)(this.ctx),P)){const $=P[2]-P[0],W=P[3]-P[1];this.ctx.rect(P[0],P[1],$,W),this.current.updateRectMinMax((0,r.getCurrentTransform)(this.ctx),P),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(C){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const P=this.ctx;C.isolated||(0,n.info)("TODO: Support non-isolated groups."),C.knockout&&(0,n.warn)("Knockout groups not supported.");const $=(0,r.getCurrentTransform)(P);if(C.matrix&&P.transform(...C.matrix),!C.bbox)throw new Error("Bounding box is required.");let W=n.Util.getAxialAlignedBoundingBox(C.bbox,(0,r.getCurrentTransform)(P));const te=[0,0,P.canvas.width,P.canvas.height];W=n.Util.intersect(W,te)||[0,0,0,0];const ee=Math.floor(W[0]),ce=Math.floor(W[1]);let he=Math.max(Math.ceil(W[2])-ee,1),Re=Math.max(Math.ceil(W[3])-ce,1),Ce=1,Ie=1;he>f&&(Ce=he/f,he=f),Re>f&&(Ie=Re/f,Re=f),this.current.startNewPathAndClipBox([0,0,he,Re]);let Ne="groupAt"+this.groupLevel;C.smask&&(Ne+="_smask_"+this.smaskCounter++%2);const $e=this.cachedCanvases.getCanvas(Ne,he,Re),ge=$e.context;ge.scale(1/Ce,1/Ie),ge.translate(-ee,-ce),ge.transform(...$),C.smask?this.smaskStack.push({canvas:$e.canvas,context:ge,offsetX:ee,offsetY:ce,scaleX:Ce,scaleY:Ie,subtype:C.smask.subtype,backdrop:C.smask.backdrop,transferMap:C.smask.transferMap||null,startTransformInverse:null}):(P.setTransform(1,0,0,1,0,0),P.translate(ee,ce),P.scale(Ce,Ie),P.save()),A(P,ge),this.ctx=ge,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(P),this.groupLevel++}endGroup(C){if(!this.contentVisible)return;this.groupLevel--;const P=this.ctx,$=this.groupStack.pop();if(this.ctx=$,this.ctx.imageSmoothingEnabled=!1,C.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const W=(0,r.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...W);const te=n.Util.getAxialAlignedBoundingBox([0,0,P.canvas.width,P.canvas.height],W);this.ctx.drawImage(P.canvas,0,0),this.ctx.restore(),this.compose(te)}}beginAnnotation(C,P,$,W,te){if(de(this,ne,bc).call(this),I(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(P)&&P.length===4){const ee=P[2]-P[0],ce=P[3]-P[1];if(te&&this.annotationCanvasMap){$=$.slice(),$[4]-=P[0],$[5]-=P[1],P=P.slice(),P[0]=P[1]=0,P[2]=ee,P[3]=ce;const[he,Re]=n.Util.singularValueDecompose2dScale((0,r.getCurrentTransform)(this.ctx)),{viewportScale:Ce}=this,Ie=Math.ceil(ee*this.outputScaleX*Ce),Ne=Math.ceil(ce*this.outputScaleY*Ce);this.annotationCanvas=this.canvasFactory.create(Ie,Ne);const{canvas:$e,context:ge}=this.annotationCanvas;this.annotationCanvasMap.set(C,$e),this.annotationCanvas.savedCtx=this.ctx,this.ctx=ge,this.ctx.save(),this.ctx.setTransform(he,0,0,-Re,0,ce*Re),I(this.ctx)}else I(this.ctx),this.ctx.rect(P[0],P[1],ee,ce),this.ctx.clip(),this.endPath()}this.current=new T(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...$),this.transform(...W)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),de(this,ne,_c).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(C){if(!this.contentVisible)return;const P=C.count;C=this.getObject(C.data,C),C.count=P;const $=this.ctx,W=this.processingType3;if(W&&(W.compiled===void 0&&(W.compiled=w(C)),W.compiled)){W.compiled($);return}const te=this._createMaskCanvas(C),ee=te.canvas;$.save(),$.setTransform(1,0,0,1,0,0),$.drawImage(ee,te.offsetX,te.offsetY),$.restore(),this.compose()}paintImageMaskXObjectRepeat(C,P,$=0,W=0,te,ee){if(!this.contentVisible)return;C=this.getObject(C.data,C);const ce=this.ctx;ce.save();const he=(0,r.getCurrentTransform)(ce);ce.transform(P,$,W,te,0,0);const Re=this._createMaskCanvas(C);ce.setTransform(1,0,0,1,Re.offsetX-he[4],Re.offsetY-he[5]);for(let Ce=0,Ie=ee.length;Ce<Ie;Ce+=2){const Ne=n.Util.transform(he,[P,$,W,te,ee[Ce],ee[Ce+1]]),[$e,ge]=n.Util.applyTransform([0,0],Ne);ce.drawImage(Re.canvas,$e,ge)}ce.restore(),this.compose()}paintImageMaskXObjectGroup(C){if(!this.contentVisible)return;const P=this.ctx,$=this.current.fillColor,W=this.current.patternFill;for(const te of C){const{data:ee,width:ce,height:he,transform:Re}=te,Ce=this.cachedCanvases.getCanvas("maskCanvas",ce,he),Ie=Ce.context;Ie.save();const Ne=this.getObject(ee,te);N(Ie,Ne),Ie.globalCompositeOperation="source-in",Ie.fillStyle=W?$.getPattern(Ie,this,(0,r.getCurrentTransformInverse)(P),o.PathType.FILL):$,Ie.fillRect(0,0,ce,he),Ie.restore(),P.save(),P.transform(...Re),P.scale(1,-1),x(P,Ce.canvas,0,0,ce,he,0,-1,1,1),P.restore()}this.compose()}paintImageXObject(C){if(!this.contentVisible)return;const P=this.getObject(C);if(!P){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(P)}paintImageXObjectRepeat(C,P,$,W){if(!this.contentVisible)return;const te=this.getObject(C);if(!te){(0,n.warn)("Dependent image isn't ready yet");return}const ee=te.width,ce=te.height,he=[];for(let Re=0,Ce=W.length;Re<Ce;Re+=2)he.push({transform:[P,0,0,$,W[Re],W[Re+1]],x:0,y:0,w:ee,h:ce});this.paintInlineImageXObjectGroup(te,he)}applyTransferMapsToCanvas(C){return this.current.transferMaps!=="none"&&(C.filter=this.current.transferMaps,C.drawImage(C.canvas,0,0),C.filter="none"),C.canvas}applyTransferMapsToBitmap(C){if(this.current.transferMaps==="none")return C.bitmap;const{bitmap:P,width:$,height:W}=C,te=this.cachedCanvases.getCanvas("inlineImage",$,W),ee=te.context;return ee.filter=this.current.transferMaps,ee.drawImage(P,0,0),ee.filter="none",te.canvas}paintInlineImageXObject(C){if(!this.contentVisible)return;const P=C.width,$=C.height,W=this.ctx;if(this.save(),!n.isNodeJS){const{filter:ce}=W;ce!=="none"&&ce!==""&&(W.filter="none")}W.scale(1/P,-1/$);let te;if(C.bitmap)te=this.applyTransferMapsToBitmap(C);else if(typeof HTMLElement=="function"&&C instanceof HTMLElement||!C.data)te=C;else{const he=this.cachedCanvases.getCanvas("inlineImage",P,$).context;O(he,C),te=this.applyTransferMapsToCanvas(he)}const ee=this._scaleImage(te,(0,r.getCurrentTransformInverse)(W));W.imageSmoothingEnabled=q((0,r.getCurrentTransform)(W),C.interpolate),x(W,ee.img,0,0,ee.paintWidth,ee.paintHeight,0,-$,P,$),this.compose(),this.restore()}paintInlineImageXObjectGroup(C,P){if(!this.contentVisible)return;const $=this.ctx;let W;if(C.bitmap)W=C.bitmap;else{const te=C.width,ee=C.height,he=this.cachedCanvases.getCanvas("inlineImage",te,ee).context;O(he,C),W=this.applyTransferMapsToCanvas(he)}for(const te of P)$.save(),$.transform(...te.transform),$.scale(1,-1),x($,W,te.x,te.y,te.w,te.h,0,-1,1,1),$.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(C){}markPointProps(C,P){}beginMarkedContent(C){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(C,P){C==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(P)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(C){const P=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(C);const $=this.ctx;this.pendingClip&&(P||(this.pendingClip===Z?$.clip("evenodd"):$.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),$.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const C=(0,r.getCurrentTransform)(this.ctx);if(C[1]===0&&C[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(C[0]),Math.abs(C[3]));else{const P=Math.abs(C[0]*C[3]-C[2]*C[1]),$=Math.hypot(C[0],C[2]),W=Math.hypot(C[1],C[3]);this._cachedGetSinglePixelWidth=Math.max($,W)/P}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:C}=this.current,{a:P,b:$,c:W,d:te}=this.ctx.getTransform();let ee,ce;if($===0&&W===0){const he=Math.abs(P),Re=Math.abs(te);if(he===Re)if(C===0)ee=ce=1/he;else{const Ce=he*C;ee=ce=Ce<1?1/Ce:1}else if(C===0)ee=1/he,ce=1/Re;else{const Ce=he*C,Ie=Re*C;ee=Ce<1?1/Ce:1,ce=Ie<1?1/Ie:1}}else{const he=Math.abs(P*te-$*W),Re=Math.hypot(P,$),Ce=Math.hypot(W,te);if(C===0)ee=Ce/he,ce=Re/he;else{const Ie=C*he;ee=Ce>Ie?Ce/Ie:1,ce=Re>Ie?Re/Ie:1}}this._cachedScaleForStroking[0]=ee,this._cachedScaleForStroking[1]=ce}return this._cachedScaleForStroking}rescaleAndStroke(C){const{ctx:P}=this,{lineWidth:$}=this.current,[W,te]=this.getScaleForStroking();if(P.lineWidth=$||1,W===1&&te===1){P.stroke();return}const ee=P.getLineDash();if(C&&P.save(),P.scale(W,te),ee.length>0){const ce=Math.max(W,te);P.setLineDash(ee.map(he=>he/ce)),P.lineDashOffset/=ce}P.stroke(),C&&P.restore()}isContentVisible(){for(let C=this.markedContentStack.length-1;C>=0;C--)if(!this.markedContentStack[C].visible)return!1;return!0}};ne=new WeakSet,bc=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},_c=function(){if(this.pageColors){const C=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(C!=="none"){const P=this.ctx.filter;this.ctx.filter=C,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=P}}};let G=Y;e.CanvasGraphics=G;for(const U in n.OPS)G.prototype[U]!==void 0&&(G.prototype[n.OPS[U]]=G.prototype[U])},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=v;var n=t(1),r=t(6);const o={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=o;function c(w,T){if(!T)return;const O=T[2]-T[0],N=T[3]-T[1],A=new Path2D;A.rect(T[0],T[1],O,N),w.clip(A)}class u{constructor(){this.constructor===u&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class h extends u{constructor(T){super(),this._type=T[1],this._bbox=T[2],this._colorStops=T[3],this._p0=T[4],this._p1=T[5],this._r0=T[6],this._r1=T[7],this.matrix=null}_createGradient(T){let O;this._type==="axial"?O=T.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(O=T.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const N of this._colorStops)O.addColorStop(N[0],N[1]);return O}getPattern(T,O,N,A){let I;if(A===o.STROKE||A===o.FILL){const k=O.current.getClippedPathBoundingBox(A,(0,r.getCurrentTransform)(T))||[0,0,0,0],M=Math.ceil(k[2]-k[0])||1,L=Math.ceil(k[3]-k[1])||1,H=O.cachedCanvases.getCanvas("pattern",M,L,!0),D=H.context;D.clearRect(0,0,D.canvas.width,D.canvas.height),D.beginPath(),D.rect(0,0,D.canvas.width,D.canvas.height),D.translate(-k[0],-k[1]),N=n.Util.transform(N,[1,0,0,1,k[0],k[1]]),D.transform(...O.baseTransform),this.matrix&&D.transform(...this.matrix),c(D,this._bbox),D.fillStyle=this._createGradient(D),D.fill(),I=T.createPattern(H.canvas,"no-repeat");const q=new DOMMatrix(N);I.setTransform(q)}else c(T,this._bbox),I=this._createGradient(T);return I}}function f(w,T,O,N,A,I,k,M){const L=T.coords,H=T.colors,D=w.data,q=w.width*4;let J;L[O+1]>L[N+1]&&(J=O,O=N,N=J,J=I,I=k,k=J),L[N+1]>L[A+1]&&(J=N,N=A,A=J,J=k,k=M,M=J),L[O+1]>L[N+1]&&(J=O,O=N,N=J,J=I,I=k,k=J);const ae=(L[O]+T.offsetX)*T.scaleX,V=(L[O+1]+T.offsetY)*T.scaleY,Z=(L[N]+T.offsetX)*T.scaleX,G=(L[N+1]+T.offsetY)*T.scaleY,ne=(L[A]+T.offsetX)*T.scaleX,B=(L[A+1]+T.offsetY)*T.scaleY;if(V>=B)return;const F=H[I],Y=H[I+1],U=H[I+2],C=H[k],P=H[k+1],$=H[k+2],W=H[M],te=H[M+1],ee=H[M+2],ce=Math.round(V),he=Math.round(B);let Re,Ce,Ie,Ne,$e,ge,_e,X;for(let se=ce;se<=he;se++){if(se<G){const Le=se<V?0:(V-se)/(V-G);Re=ae-(ae-Z)*Le,Ce=F-(F-C)*Le,Ie=Y-(Y-P)*Le,Ne=U-(U-$)*Le}else{let Le;se>B?Le=1:G===B?Le=0:Le=(G-se)/(G-B),Re=Z-(Z-ne)*Le,Ce=C-(C-W)*Le,Ie=P-(P-te)*Le,Ne=$-($-ee)*Le}let fe;se<V?fe=0:se>B?fe=1:fe=(V-se)/(V-B),$e=ae-(ae-ne)*fe,ge=F-(F-W)*fe,_e=Y-(Y-te)*fe,X=U-(U-ee)*fe;const ve=Math.round(Math.min(Re,$e)),Me=Math.round(Math.max(Re,$e));let Be=q*se+ve*4;for(let Le=ve;Le<=Me;Le++)fe=(Re-Le)/(Re-$e),fe<0?fe=0:fe>1&&(fe=1),D[Be++]=Ce-(Ce-ge)*fe|0,D[Be++]=Ie-(Ie-_e)*fe|0,D[Be++]=Ne-(Ne-X)*fe|0,D[Be++]=255}}function p(w,T,O){const N=T.coords,A=T.colors;let I,k;switch(T.type){case"lattice":const M=T.verticesPerRow,L=Math.floor(N.length/M)-1,H=M-1;for(I=0;I<L;I++){let D=I*M;for(let q=0;q<H;q++,D++)f(w,O,N[D],N[D+1],N[D+M],A[D],A[D+1],A[D+M]),f(w,O,N[D+M+1],N[D+1],N[D+M],A[D+M+1],A[D+1],A[D+M])}break;case"triangles":for(I=0,k=N.length;I<k;I+=3)f(w,O,N[I],N[I+1],N[I+2],A[I],A[I+1],A[I+2]);break;default:throw new Error("illegal figure")}}class g extends u{constructor(T){super(),this._coords=T[2],this._colors=T[3],this._figures=T[4],this._bounds=T[5],this._bbox=T[7],this._background=T[8],this.matrix=null}_createMeshCanvas(T,O,N){const M=Math.floor(this._bounds[0]),L=Math.floor(this._bounds[1]),H=Math.ceil(this._bounds[2])-M,D=Math.ceil(this._bounds[3])-L,q=Math.min(Math.ceil(Math.abs(H*T[0]*1.1)),3e3),J=Math.min(Math.ceil(Math.abs(D*T[1]*1.1)),3e3),ae=H/q,V=D/J,Z={coords:this._coords,colors:this._colors,offsetX:-M,offsetY:-L,scaleX:1/ae,scaleY:1/V},G=q+2*2,ne=J+2*2,B=N.getCanvas("mesh",G,ne,!1),F=B.context,Y=F.createImageData(q,J);if(O){const C=Y.data;for(let P=0,$=C.length;P<$;P+=4)C[P]=O[0],C[P+1]=O[1],C[P+2]=O[2],C[P+3]=255}for(const C of this._figures)p(Y,C,Z);return F.putImageData(Y,2,2),{canvas:B.canvas,offsetX:M-2*ae,offsetY:L-2*V,scaleX:ae,scaleY:V}}getPattern(T,O,N,A){c(T,this._bbox);let I;if(A===o.SHADING)I=n.Util.singularValueDecompose2dScale((0,r.getCurrentTransform)(T));else if(I=n.Util.singularValueDecompose2dScale(O.baseTransform),this.matrix){const M=n.Util.singularValueDecompose2dScale(this.matrix);I=[I[0]*M[0],I[1]*M[1]]}const k=this._createMeshCanvas(I,A===o.SHADING?null:this._background,O.cachedCanvases);return A!==o.SHADING&&(T.setTransform(...O.baseTransform),this.matrix&&T.transform(...this.matrix)),T.translate(k.offsetX,k.offsetY),T.scale(k.scaleX,k.scaleY),T.createPattern(k.canvas,"no-repeat")}}class y extends u{getPattern(){return"hotpink"}}function v(w){switch(w[0]){case"RadialAxial":return new h(w);case"Mesh":return new g(w);case"Dummy":return new y}throw new Error(`Unknown IR type: ${w[0]}`)}const _={COLORED:1,UNCOLORED:2},x=class x{constructor(T,O,N,A,I){this.operatorList=T[2],this.matrix=T[3]||[1,0,0,1,0,0],this.bbox=T[4],this.xstep=T[5],this.ystep=T[6],this.paintType=T[7],this.tilingType=T[8],this.color=O,this.ctx=N,this.canvasGraphicsFactory=A,this.baseTransform=I}createPatternCanvas(T){const O=this.operatorList,N=this.bbox,A=this.xstep,I=this.ystep,k=this.paintType,M=this.tilingType,L=this.color,H=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+M);const D=N[0],q=N[1],J=N[2],ae=N[3],V=n.Util.singularValueDecompose2dScale(this.matrix),Z=n.Util.singularValueDecompose2dScale(this.baseTransform),G=[V[0]*Z[0],V[1]*Z[1]],ne=this.getSizeAndScale(A,this.ctx.canvas.width,G[0]),B=this.getSizeAndScale(I,this.ctx.canvas.height,G[1]),F=T.cachedCanvases.getCanvas("pattern",ne.size,B.size,!0),Y=F.context,U=H.createCanvasGraphics(Y);U.groupLevel=T.groupLevel,this.setFillAndStrokeStyleToContext(U,k,L);let C=D,P=q,$=J,W=ae;return D<0&&(C=0,$+=Math.abs(D)),q<0&&(P=0,W+=Math.abs(q)),Y.translate(-(ne.scale*C),-(B.scale*P)),U.transform(ne.scale,0,0,B.scale,0,0),Y.save(),this.clipBbox(U,C,P,$,W),U.baseTransform=(0,r.getCurrentTransform)(U.ctx),U.executeOperatorList(O),U.endDrawing(),{canvas:F.canvas,scaleX:ne.scale,scaleY:B.scale,offsetX:C,offsetY:P}}getSizeAndScale(T,O,N){T=Math.abs(T);const A=Math.max(x.MAX_PATTERN_SIZE,O);let I=Math.ceil(T*N);return I>=A?I=A:N=I/T,{scale:N,size:I}}clipBbox(T,O,N,A,I){const k=A-O,M=I-N;T.ctx.rect(O,N,k,M),T.current.updateRectMinMax((0,r.getCurrentTransform)(T.ctx),[O,N,A,I]),T.clip(),T.endPath()}setFillAndStrokeStyleToContext(T,O,N){const A=T.ctx,I=T.current;switch(O){case _.COLORED:const k=this.ctx;A.fillStyle=k.fillStyle,A.strokeStyle=k.strokeStyle,I.fillColor=k.fillStyle,I.strokeColor=k.strokeStyle;break;case _.UNCOLORED:const M=n.Util.makeHexColor(N[0],N[1],N[2]);A.fillStyle=M,A.strokeStyle=M,I.fillColor=M,I.strokeColor=M;break;default:throw new n.FormatError(`Unsupported paint type: ${O}`)}}getPattern(T,O,N,A){let I=N;A!==o.SHADING&&(I=n.Util.transform(I,O.baseTransform),this.matrix&&(I=n.Util.transform(I,this.matrix)));const k=this.createPatternCanvas(O);let M=new DOMMatrix(I);M=M.translate(k.offsetX,k.offsetY),M=M.scale(1/k.scaleX,1/k.scaleY);const L=T.createPattern(k.canvas,"repeat");return L.setTransform(M),L}};ot(x,"MAX_PATTERN_SIZE",3e3);let E=x;e.TilingPattern=E},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=o,e.convertToRGBA=r,e.grayToRGBA=u;var n=t(1);function r(h){switch(h.kind){case n.ImageKind.GRAYSCALE_1BPP:return o(h);case n.ImageKind.RGB_24BPP:return c(h)}return null}function o({src:h,srcPos:f=0,dest:p,width:g,height:y,nonBlackColor:v=4294967295,inverseDecode:_=!1}){const E=n.FeatureTest.isLittleEndian?4278190080:255,[x,w]=_?[v,E]:[E,v],T=g>>3,O=g&7,N=h.length;p=new Uint32Array(p.buffer);let A=0;for(let I=0;I<y;I++){for(const M=f+T;f<M;f++){const L=f<N?h[f]:255;p[A++]=L&128?w:x,p[A++]=L&64?w:x,p[A++]=L&32?w:x,p[A++]=L&16?w:x,p[A++]=L&8?w:x,p[A++]=L&4?w:x,p[A++]=L&2?w:x,p[A++]=L&1?w:x}if(O===0)continue;const k=f<N?h[f++]:255;for(let M=0;M<O;M++)p[A++]=k&1<<7-M?w:x}return{srcPos:f,destPos:A}}function c({src:h,srcPos:f=0,dest:p,destPos:g=0,width:y,height:v}){let _=0;const E=h.length>>2,x=new Uint32Array(h.buffer,f,E);if(n.FeatureTest.isLittleEndian){for(;_<E-2;_+=3,g+=4){const w=x[_],T=x[_+1],O=x[_+2];p[g]=w|4278190080,p[g+1]=w>>>24|T<<8|4278190080,p[g+2]=T>>>16|O<<16|4278190080,p[g+3]=O>>>8|4278190080}for(let w=_*4,T=h.length;w<T;w+=3)p[g++]=h[w]|h[w+1]<<8|h[w+2]<<16|4278190080}else{for(;_<E-2;_+=3,g+=4){const w=x[_],T=x[_+1],O=x[_+2];p[g]=w|255,p[g+1]=w<<24|T>>>8|255,p[g+2]=T<<16|O>>>16|255,p[g+3]=O<<8|255}for(let w=_*4,T=h.length;w<T;w+=3)p[g++]=h[w]<<24|h[w+1]<<16|h[w+2]<<8|255}return{srcPos:f,destPos:g}}function u(h,f){if(n.FeatureTest.isLittleEndian)for(let p=0,g=h.length;p<g;p++)f[p]=h[p]*65793|4278190080;else for(let p=0,g=h.length;p<g;p++)f[p]=h[p]*16843008|255}},(s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const t=Object.create(null);e.GlobalWorkerOptions=t,t.workerPort=null,t.workerSrc=""},(s,e,t)=>{var h,vf,xf,qa;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var n=t(1);const r={DATA:1,ERROR:2},o={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function c(y){switch(y instanceof Error||typeof y=="object"&&y!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),y.name){case"AbortException":return new n.AbortException(y.message);case"MissingPDFException":return new n.MissingPDFException(y.message);case"PasswordException":return new n.PasswordException(y.message,y.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(y.message,y.status);case"UnknownErrorException":return new n.UnknownErrorException(y.message,y.details);default:return new n.UnknownErrorException(y.message,y.toString())}}class u{constructor(v,_,E){Se(this,h);this.sourceName=v,this.targetName=_,this.comObj=E,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=x=>{const w=x.data;if(w.targetName!==this.sourceName)return;if(w.stream){de(this,h,xf).call(this,w);return}if(w.callback){const O=w.callbackId,N=this.callbackCapabilities[O];if(!N)throw new Error(`Cannot resolve callback ${O}`);if(delete this.callbackCapabilities[O],w.callback===r.DATA)N.resolve(w.data);else if(w.callback===r.ERROR)N.reject(c(w.reason));else throw new Error("Unexpected callback case");return}const T=this.actionHandler[w.action];if(!T)throw new Error(`Unknown action from worker: ${w.action}`);if(w.callbackId){const O=this.sourceName,N=w.sourceName;new Promise(function(A){A(T(w.data))}).then(function(A){E.postMessage({sourceName:O,targetName:N,callback:r.DATA,callbackId:w.callbackId,data:A})},function(A){E.postMessage({sourceName:O,targetName:N,callback:r.ERROR,callbackId:w.callbackId,reason:c(A)})});return}if(w.streamId){de(this,h,vf).call(this,w);return}T(w.data)},E.addEventListener("message",this._onComObjOnMessage)}on(v,_){const E=this.actionHandler;if(E[v])throw new Error(`There is already an actionName called "${v}"`);E[v]=_}send(v,_,E){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:v,data:_},E)}sendWithPromise(v,_,E){const x=this.callbackId++,w=new n.PromiseCapability;this.callbackCapabilities[x]=w;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:v,callbackId:x,data:_},E)}catch(T){w.reject(T)}return w.promise}sendWithStream(v,_,E,x){const w=this.streamId++,T=this.sourceName,O=this.targetName,N=this.comObj;return new ReadableStream({start:A=>{const I=new n.PromiseCapability;return this.streamControllers[w]={controller:A,startCall:I,pullCall:null,cancelCall:null,isClosed:!1},N.postMessage({sourceName:T,targetName:O,action:v,streamId:w,data:_,desiredSize:A.desiredSize},x),I.promise},pull:A=>{const I=new n.PromiseCapability;return this.streamControllers[w].pullCall=I,N.postMessage({sourceName:T,targetName:O,stream:o.PULL,streamId:w,desiredSize:A.desiredSize}),I.promise},cancel:A=>{(0,n.assert)(A instanceof Error,"cancel must have a valid reason");const I=new n.PromiseCapability;return this.streamControllers[w].cancelCall=I,this.streamControllers[w].isClosed=!0,N.postMessage({sourceName:T,targetName:O,stream:o.CANCEL,streamId:w,reason:c(A)}),I.promise}},E)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}h=new WeakSet,vf=function(v){const _=v.streamId,E=this.sourceName,x=v.sourceName,w=this.comObj,T=this,O=this.actionHandler[v.action],N={enqueue(A,I=1,k){if(this.isCancelled)return;const M=this.desiredSize;this.desiredSize-=I,M>0&&this.desiredSize<=0&&(this.sinkCapability=new n.PromiseCapability,this.ready=this.sinkCapability.promise),w.postMessage({sourceName:E,targetName:x,stream:o.ENQUEUE,streamId:_,chunk:A},k)},close(){this.isCancelled||(this.isCancelled=!0,w.postMessage({sourceName:E,targetName:x,stream:o.CLOSE,streamId:_}),delete T.streamSinks[_])},error(A){(0,n.assert)(A instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,w.postMessage({sourceName:E,targetName:x,stream:o.ERROR,streamId:_,reason:c(A)}))},sinkCapability:new n.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:v.desiredSize,ready:null};N.sinkCapability.resolve(),N.ready=N.sinkCapability.promise,this.streamSinks[_]=N,new Promise(function(A){A(O(v.data,N))}).then(function(){w.postMessage({sourceName:E,targetName:x,stream:o.START_COMPLETE,streamId:_,success:!0})},function(A){w.postMessage({sourceName:E,targetName:x,stream:o.START_COMPLETE,streamId:_,reason:c(A)})})},xf=function(v){const _=v.streamId,E=this.sourceName,x=v.sourceName,w=this.comObj,T=this.streamControllers[_],O=this.streamSinks[_];switch(v.stream){case o.START_COMPLETE:v.success?T.startCall.resolve():T.startCall.reject(c(v.reason));break;case o.PULL_COMPLETE:v.success?T.pullCall.resolve():T.pullCall.reject(c(v.reason));break;case o.PULL:if(!O){w.postMessage({sourceName:E,targetName:x,stream:o.PULL_COMPLETE,streamId:_,success:!0});break}O.desiredSize<=0&&v.desiredSize>0&&O.sinkCapability.resolve(),O.desiredSize=v.desiredSize,new Promise(function(N){var A;N((A=O.onPull)==null?void 0:A.call(O))}).then(function(){w.postMessage({sourceName:E,targetName:x,stream:o.PULL_COMPLETE,streamId:_,success:!0})},function(N){w.postMessage({sourceName:E,targetName:x,stream:o.PULL_COMPLETE,streamId:_,reason:c(N)})});break;case o.ENQUEUE:if((0,n.assert)(T,"enqueue should have stream controller"),T.isClosed)break;T.controller.enqueue(v.chunk);break;case o.CLOSE:if((0,n.assert)(T,"close should have stream controller"),T.isClosed)break;T.isClosed=!0,T.controller.close(),de(this,h,qa).call(this,T,_);break;case o.ERROR:(0,n.assert)(T,"error should have stream controller"),T.controller.error(c(v.reason)),de(this,h,qa).call(this,T,_);break;case o.CANCEL_COMPLETE:v.success?T.cancelCall.resolve():T.cancelCall.reject(c(v.reason)),de(this,h,qa).call(this,T,_);break;case o.CANCEL:if(!O)break;new Promise(function(N){var A;N((A=O.onCancel)==null?void 0:A.call(O,c(v.reason)))}).then(function(){w.postMessage({sourceName:E,targetName:x,stream:o.CANCEL_COMPLETE,streamId:_,success:!0})},function(N){w.postMessage({sourceName:E,targetName:x,stream:o.CANCEL_COMPLETE,streamId:_,reason:c(N)})}),O.sinkCapability.reject(c(v.reason)),O.isCancelled=!0,delete this.streamSinks[_];break;default:throw new Error("Unexpected stream case")}},qa=async function(v,_){var E,x,w;await Promise.allSettled([(E=v.startCall)==null?void 0:E.promise,(x=v.pullCall)==null?void 0:x.promise,(w=v.cancelCall)==null?void 0:w.promise]),delete this.streamControllers[_]},e.MessageHandler=u},(s,e,t)=>{var o,c;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var n=t(1);class r{constructor({parsedData:h,rawData:f}){Se(this,o);Se(this,c);we(this,o,h),we(this,c,f)}getRaw(){return R(this,c)}get(h){return R(this,o).get(h)??null}getAll(){return(0,n.objectFromMap)(R(this,o))}has(h){return R(this,o).has(h)}}o=new WeakMap,c=new WeakMap,e.Metadata=r},(s,e,t)=>{var h,f,p,g,y,v,vc;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var n=t(1),r=t(8);const o=Symbol("INTERNAL");class c{constructor(x,w){Se(this,h,!0);this.name=x,this.intent=w}get visible(){return R(this,h)}_setVisible(x,w){x!==o&&(0,n.unreachable)("Internal method `_setVisible` called."),we(this,h,w)}}h=new WeakMap;class u{constructor(x){Se(this,v);Se(this,f,null);Se(this,p,new Map);Se(this,g,null);Se(this,y,null);if(this.name=null,this.creator=null,x!==null){this.name=x.name,this.creator=x.creator,we(this,y,x.order);for(const w of x.groups)R(this,p).set(w.id,new c(w.name,w.intent));if(x.baseState==="OFF")for(const w of R(this,p).values())w._setVisible(o,!1);for(const w of x.on)R(this,p).get(w)._setVisible(o,!0);for(const w of x.off)R(this,p).get(w)._setVisible(o,!1);we(this,g,this.getHash())}}isVisible(x){if(R(this,p).size===0)return!0;if(!x)return(0,n.warn)("Optional content group not defined."),!0;if(x.type==="OCG")return R(this,p).has(x.id)?R(this,p).get(x.id).visible:((0,n.warn)(`Optional content group not found: ${x.id}`),!0);if(x.type==="OCMD"){if(x.expression)return de(this,v,vc).call(this,x.expression);if(!x.policy||x.policy==="AnyOn"){for(const w of x.ids){if(!R(this,p).has(w))return(0,n.warn)(`Optional content group not found: ${w}`),!0;if(R(this,p).get(w).visible)return!0}return!1}else if(x.policy==="AllOn"){for(const w of x.ids){if(!R(this,p).has(w))return(0,n.warn)(`Optional content group not found: ${w}`),!0;if(!R(this,p).get(w).visible)return!1}return!0}else if(x.policy==="AnyOff"){for(const w of x.ids){if(!R(this,p).has(w))return(0,n.warn)(`Optional content group not found: ${w}`),!0;if(!R(this,p).get(w).visible)return!0}return!1}else if(x.policy==="AllOff"){for(const w of x.ids){if(!R(this,p).has(w))return(0,n.warn)(`Optional content group not found: ${w}`),!0;if(R(this,p).get(w).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${x.policy}.`),!0}return(0,n.warn)(`Unknown group type ${x.type}.`),!0}setVisibility(x,w=!0){if(!R(this,p).has(x)){(0,n.warn)(`Optional content group not found: ${x}`);return}R(this,p).get(x)._setVisible(o,!!w),we(this,f,null)}get hasInitialVisibility(){return R(this,g)===null||this.getHash()===R(this,g)}getOrder(){return R(this,p).size?R(this,y)?R(this,y).slice():[...R(this,p).keys()]:null}getGroups(){return R(this,p).size>0?(0,n.objectFromMap)(R(this,p)):null}getGroup(x){return R(this,p).get(x)||null}getHash(){if(R(this,f)!==null)return R(this,f);const x=new r.MurmurHash3_64;for(const[w,T]of R(this,p))x.update(`${w}:${T.visible}`);return we(this,f,x.hexdigest())}}f=new WeakMap,p=new WeakMap,g=new WeakMap,y=new WeakMap,v=new WeakSet,vc=function(x){const w=x.length;if(w<2)return!0;const T=x[0];for(let O=1;O<w;O++){const N=x[O];let A;if(Array.isArray(N))A=de(this,v,vc).call(this,N);else if(R(this,p).has(N))A=R(this,p).get(N).visible;else return(0,n.warn)(`Optional content group not found: ${N}`),!0;switch(T){case"And":if(!A)return!1;break;case"Or":if(A)return!0;break;case"Not":return!A;default:return!0}}return T==="And"},e.OptionalContentConfig=u},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var n=t(1),r=t(6);class o{constructor({length:f,initialData:p,progressiveDone:g=!1,contentDispositionFilename:y=null,disableRange:v=!1,disableStream:_=!1},E){if((0,n.assert)(E,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=g,this._contentDispositionFilename=y,(p==null?void 0:p.length)>0){const x=p instanceof Uint8Array&&p.byteLength===p.buffer.byteLength?p.buffer:new Uint8Array(p).buffer;this._queuedChunks.push(x)}this._pdfDataRangeTransport=E,this._isStreamingSupported=!_,this._isRangeSupported=!v,this._contentLength=f,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((x,w)=>{this._onReceiveData({begin:x,chunk:w})}),this._pdfDataRangeTransport.addProgressListener((x,w)=>{this._onProgress({loaded:x,total:w})}),this._pdfDataRangeTransport.addProgressiveReadListener(x=>{this._onReceiveData({chunk:x})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:f,chunk:p}){const g=p instanceof Uint8Array&&p.byteLength===p.buffer.byteLength?p.buffer:new Uint8Array(p).buffer;if(f===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(g):this._queuedChunks.push(g);else{const y=this._rangeReaders.some(function(v){return v._begin!==f?!1:(v._enqueue(g),!0)});(0,n.assert)(y,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var f;return((f=this._fullRequestReader)==null?void 0:f._loaded)??0}_onProgress(f){var p,g,y,v;f.total===void 0?(g=(p=this._rangeReaders[0])==null?void 0:p.onProgress)==null||g.call(p,{loaded:f.loaded}):(v=(y=this._fullRequestReader)==null?void 0:y.onProgress)==null||v.call(y,{loaded:f.loaded,total:f.total})}_onProgressiveDone(){var f;(f=this._fullRequestReader)==null||f.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(f){const p=this._rangeReaders.indexOf(f);p>=0&&this._rangeReaders.splice(p,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const f=this._queuedChunks;return this._queuedChunks=null,new c(this,f,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(f,p){if(p<=this._progressiveDataLength)return null;const g=new u(this,f,p);return this._pdfDataRangeTransport.requestDataRange(f,p),this._rangeReaders.push(g),g}cancelAllRequests(f){var p;(p=this._fullRequestReader)==null||p.cancel(f);for(const g of this._rangeReaders.slice(0))g.cancel(f);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=o;class c{constructor(f,p,g=!1,y=null){this._stream=f,this._done=g||!1,this._filename=(0,r.isPdfFile)(y)?y:null,this._queuedChunks=p||[],this._loaded=0;for(const v of this._queuedChunks)this._loaded+=v.byteLength;this._requests=[],this._headersReady=Promise.resolve(),f._fullRequestReader=this,this.onProgress=null}_enqueue(f){this._done||(this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunks.push(f),this._loaded+=f.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const f=new n.PromiseCapability;return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class u{constructor(f,p,g){this._stream=f,this._begin=p,this._end=g,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(f){if(!this._done){if(this._requests.length===0)this._queuedChunk=f;else{this._requests.shift().resolve({value:f,done:!1});for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const p=this._queuedChunk;return this._queuedChunk=null,{value:p,done:!1}}if(this._done)return{value:void 0,done:!0};const f=new n.PromiseCapability;return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var n=t(1),r=t(20);function o(g,y,v){return{method:"GET",headers:g,signal:v.signal,mode:"cors",credentials:y?"include":"same-origin",redirect:"follow"}}function c(g){const y=new Headers;for(const v in g){const _=g[v];_!==void 0&&y.append(v,_)}return y}function u(g){return g instanceof Uint8Array?g.buffer:g instanceof ArrayBuffer?g:((0,n.warn)(`getArrayBuffer - unexpected data format: ${g}`),new Uint8Array(g).buffer)}class h{constructor(y){this.source=y,this.isHttp=/^https?:/i.test(y.url),this.httpHeaders=this.isHttp&&y.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var y;return((y=this._fullRequestReader)==null?void 0:y._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new f(this),this._fullRequestReader}getRangeReader(y,v){if(v<=this._progressiveDataLength)return null;const _=new p(this,y,v);return this._rangeRequestReaders.push(_),_}cancelAllRequests(y){var v;(v=this._fullRequestReader)==null||v.cancel(y);for(const _ of this._rangeRequestReaders.slice(0))_.cancel(y)}}e.PDFFetchStream=h;class f{constructor(y){this._stream=y,this._reader=null,this._loaded=0,this._filename=null;const v=y.source;this._withCredentials=v.withCredentials||!1,this._contentLength=v.length,this._headersCapability=new n.PromiseCapability,this._disableRange=v.disableRange||!1,this._rangeChunkSize=v.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!v.disableStream,this._isRangeSupported=!v.disableRange,this._headers=c(this._stream.httpHeaders);const _=v.url;fetch(_,o(this._headers,this._withCredentials,this._abortController)).then(E=>{if(!(0,r.validateResponseStatus)(E.status))throw(0,r.createResponseStatusError)(E.status,_);this._reader=E.body.getReader(),this._headersCapability.resolve();const x=O=>E.headers.get(O),{allowRangeRequests:w,suggestedLength:T}=(0,r.validateRangeRequestCapabilities)({getResponseHeader:x,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=w,this._contentLength=T||this._contentLength,this._filename=(0,r.extractFilenameFromHeader)(x),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var _;await this._headersCapability.promise;const{value:y,done:v}=await this._reader.read();return v?{value:y,done:v}:(this._loaded+=y.byteLength,(_=this.onProgress)==null||_.call(this,{loaded:this._loaded,total:this._contentLength}),{value:u(y),done:!1})}cancel(y){var v;(v=this._reader)==null||v.cancel(y),this._abortController.abort()}}class p{constructor(y,v,_){this._stream=y,this._reader=null,this._loaded=0;const E=y.source;this._withCredentials=E.withCredentials||!1,this._readCapability=new n.PromiseCapability,this._isStreamingSupported=!E.disableStream,this._abortController=new AbortController,this._headers=c(this._stream.httpHeaders),this._headers.append("Range",`bytes=${v}-${_-1}`);const x=E.url;fetch(x,o(this._headers,this._withCredentials,this._abortController)).then(w=>{if(!(0,r.validateResponseStatus)(w.status))throw(0,r.createResponseStatusError)(w.status,x);this._readCapability.resolve(),this._reader=w.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var _;await this._readCapability.promise;const{value:y,done:v}=await this._reader.read();return v?{value:y,done:v}:(this._loaded+=y.byteLength,(_=this.onProgress)==null||_.call(this,{loaded:this._loaded}),{value:u(y),done:!1})}cancel(y){var v;(v=this._reader)==null||v.cancel(y),this._abortController.abort()}}},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=h,e.extractFilenameFromHeader=u,e.validateRangeRequestCapabilities=c,e.validateResponseStatus=f;var n=t(1),r=t(21),o=t(6);function c({getResponseHeader:p,isHttp:g,rangeChunkSize:y,disableRange:v}){const _={allowRangeRequests:!1,suggestedLength:void 0},E=parseInt(p("Content-Length"),10);return!Number.isInteger(E)||(_.suggestedLength=E,E<=2*y)||v||!g||p("Accept-Ranges")!=="bytes"||(p("Content-Encoding")||"identity")!=="identity"||(_.allowRangeRequests=!0),_}function u(p){const g=p("Content-Disposition");if(g){let y=(0,r.getFilenameFromContentDispositionHeader)(g);if(y.includes("%"))try{y=decodeURIComponent(y)}catch{}if((0,o.isPdfFile)(y))return y}return null}function h(p,g){return p===404||p===0&&g.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+g+'".'):new n.UnexpectedResponseException(`Unexpected server response (${p}) while retrieving PDF "${g}".`,p)}function f(p){return p===200||p===206}},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=r;var n=t(1);function r(o){let c=!0,u=h("filename\\*","i").exec(o);if(u){u=u[1];let E=y(u);return E=unescape(E),E=v(E),E=_(E),p(E)}if(u=g(o),u){const E=_(u);return p(E)}if(u=h("filename","i").exec(o),u){u=u[1];let E=y(u);return E=_(E),p(E)}function h(E,x){return new RegExp("(?:^|;)\\s*"+E+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',x)}function f(E,x){if(E){if(!/^[\x00-\xFF]+$/.test(x))return x;try{const w=new TextDecoder(E,{fatal:!0}),T=(0,n.stringToBytes)(x);x=w.decode(T),c=!1}catch{}}return x}function p(E){return c&&/[\x80-\xff]/.test(E)&&(E=f("utf-8",E),c&&(E=f("iso-8859-1",E))),E}function g(E){const x=[];let w;const T=h("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(w=T.exec(E))!==null;){let[,N,A,I]=w;if(N=parseInt(N,10),N in x){if(N===0)break;continue}x[N]=[A,I]}const O=[];for(let N=0;N<x.length&&N in x;++N){let[A,I]=x[N];I=y(I),A&&(I=unescape(I),N===0&&(I=v(I))),O.push(I)}return O.join("")}function y(E){if(E.startsWith('"')){const x=E.slice(1).split('\\"');for(let w=0;w<x.length;++w){const T=x[w].indexOf('"');T!==-1&&(x[w]=x[w].slice(0,T),x.length=w+1),x[w]=x[w].replaceAll(/\\(.)/g,"$1")}E=x.join('"')}return E}function v(E){const x=E.indexOf("'");if(x===-1)return E;const w=E.slice(0,x),O=E.slice(x+1).replace(/^[^']*'/,"");return f(w,O)}function _(E){return!E.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(E)?E:E.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(x,w,T,O){if(T==="q"||T==="Q")return O=O.replaceAll("_"," "),O=O.replaceAll(/=([0-9a-fA-F]{2})/g,function(N,A){return String.fromCharCode(parseInt(A,16))}),f(w,O);try{O=atob(O)}catch{}return f(w,O)})}return""}},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var n=t(1),r=t(20);const o=200,c=206;function u(y){const v=y.response;return typeof v!="string"?v:(0,n.stringToBytes)(v).buffer}class h{constructor(v,_={}){this.url=v,this.isHttp=/^https?:/i.test(v),this.httpHeaders=this.isHttp&&_.httpHeaders||Object.create(null),this.withCredentials=_.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(v,_,E){const x={begin:v,end:_};for(const w in E)x[w]=E[w];return this.request(x)}requestFull(v){return this.request(v)}request(v){const _=new XMLHttpRequest,E=this.currXhrId++,x=this.pendingRequests[E]={xhr:_};_.open("GET",this.url),_.withCredentials=this.withCredentials;for(const w in this.httpHeaders){const T=this.httpHeaders[w];T!==void 0&&_.setRequestHeader(w,T)}return this.isHttp&&"begin"in v&&"end"in v?(_.setRequestHeader("Range",`bytes=${v.begin}-${v.end-1}`),x.expectedStatus=c):x.expectedStatus=o,_.responseType="arraybuffer",v.onError&&(_.onerror=function(w){v.onError(_.status)}),_.onreadystatechange=this.onStateChange.bind(this,E),_.onprogress=this.onProgress.bind(this,E),x.onHeadersReceived=v.onHeadersReceived,x.onDone=v.onDone,x.onError=v.onError,x.onProgress=v.onProgress,_.send(null),E}onProgress(v,_){var x;const E=this.pendingRequests[v];E&&((x=E.onProgress)==null||x.call(E,_))}onStateChange(v,_){var N,A,I;const E=this.pendingRequests[v];if(!E)return;const x=E.xhr;if(x.readyState>=2&&E.onHeadersReceived&&(E.onHeadersReceived(),delete E.onHeadersReceived),x.readyState!==4||!(v in this.pendingRequests))return;if(delete this.pendingRequests[v],x.status===0&&this.isHttp){(N=E.onError)==null||N.call(E,x.status);return}const w=x.status||o;if(!(w===o&&E.expectedStatus===c)&&w!==E.expectedStatus){(A=E.onError)==null||A.call(E,x.status);return}const O=u(x);if(w===c){const k=x.getResponseHeader("Content-Range"),M=/bytes (\d+)-(\d+)\/(\d+)/.exec(k);E.onDone({begin:parseInt(M[1],10),chunk:O})}else O?E.onDone({begin:0,chunk:O}):(I=E.onError)==null||I.call(E,x.status)}getRequestXhr(v){return this.pendingRequests[v].xhr}isPendingRequest(v){return v in this.pendingRequests}abortRequest(v){const _=this.pendingRequests[v].xhr;delete this.pendingRequests[v],_.abort()}}class f{constructor(v){this._source=v,this._manager=new h(v.url,{httpHeaders:v.httpHeaders,withCredentials:v.withCredentials}),this._rangeChunkSize=v.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(v){const _=this._rangeRequestReaders.indexOf(v);_>=0&&this._rangeRequestReaders.splice(_,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new p(this._manager,this._source),this._fullRequestReader}getRangeReader(v,_){const E=new g(this._manager,v,_);return E.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(E),E}cancelAllRequests(v){var _;(_=this._fullRequestReader)==null||_.cancel(v);for(const E of this._rangeRequestReaders.slice(0))E.cancel(v)}}e.PDFNetworkStream=f;class p{constructor(v,_){this._manager=v;const E={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=_.url,this._fullRequestId=v.requestFull(E),this._headersReceivedCapability=new n.PromiseCapability,this._disableRange=_.disableRange||!1,this._contentLength=_.length,this._rangeChunkSize=_.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const v=this._fullRequestId,_=this._manager.getRequestXhr(v),E=T=>_.getResponseHeader(T),{allowRangeRequests:x,suggestedLength:w}=(0,r.validateRangeRequestCapabilities)({getResponseHeader:E,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});x&&(this._isRangeSupported=!0),this._contentLength=w||this._contentLength,this._filename=(0,r.extractFilenameFromHeader)(E),this._isRangeSupported&&this._manager.abortRequest(v),this._headersReceivedCapability.resolve()}_onDone(v){if(v&&(this._requests.length>0?this._requests.shift().resolve({value:v.chunk,done:!1}):this._cachedChunks.push(v.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(v){this._storedError=(0,r.createResponseStatusError)(v,this._url),this._headersReceivedCapability.reject(this._storedError);for(const _ of this._requests)_.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(v){var _;(_=this.onProgress)==null||_.call(this,{loaded:v.loaded,total:v.lengthComputable?v.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const v=new n.PromiseCapability;return this._requests.push(v),v.promise}cancel(v){this._done=!0,this._headersReceivedCapability.reject(v);for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class g{constructor(v,_,E){this._manager=v;const x={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=v.url,this._requestId=v.requestRange(_,E,x),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var v;(v=this.onClosed)==null||v.call(this,this)}_onDone(v){const _=v.chunk;this._requests.length>0?this._requests.shift().resolve({value:_,done:!1}):this._queuedChunk=_,this._done=!0;for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(v){this._storedError=(0,r.createResponseStatusError)(v,this._url);for(const _ of this._requests)_.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(v){var _;this.isStreamingSupported||(_=this.onProgress)==null||_.call(this,{loaded:v.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const _=this._queuedChunk;return this._queuedChunk=null,{value:_,done:!1}}if(this._done)return{value:void 0,done:!0};const v=new n.PromiseCapability;return this._requests.push(v),v.promise}cancel(v){this._done=!0;for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var n=t(1),r=t(20);const o=/^file:\/\/\/[a-zA-Z]:\//;function c(E){const x=require$$5,w=x.parse(E);return w.protocol==="file:"||w.host?w:/^[a-z]:[/\\]/i.test(E)?x.parse(`file:///${E}`):(w.host||(w.protocol="file:"),w)}class u{constructor(x){this.source=x,this.url=c(x.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&x.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var x;return((x=this._fullRequestReader)==null?void 0:x._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new v(this):new g(this),this._fullRequestReader}getRangeReader(x,w){if(w<=this._progressiveDataLength)return null;const T=this.isFsUrl?new _(this,x,w):new y(this,x,w);return this._rangeRequestReaders.push(T),T}cancelAllRequests(x){var w;(w=this._fullRequestReader)==null||w.cancel(x);for(const T of this._rangeRequestReaders.slice(0))T.cancel(x)}}e.PDFNodeStream=u;class h{constructor(x){this._url=x.url,this._done=!1,this._storedError=null,this.onProgress=null;const w=x.source;this._contentLength=w.length,this._loaded=0,this._filename=null,this._disableRange=w.disableRange||!1,this._rangeChunkSize=w.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!w.disableStream,this._isRangeSupported=!w.disableRange,this._readableStream=null,this._readCapability=new n.PromiseCapability,this._headersCapability=new n.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var T;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const x=this._readableStream.read();return x===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=x.length,(T=this.onProgress)==null||T.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(x).buffer,done:!1})}cancel(x){if(!this._readableStream){this._error(x);return}this._readableStream.destroy(x)}_error(x){this._storedError=x,this._readCapability.resolve()}_setReadableStream(x){this._readableStream=x,x.on("readable",()=>{this._readCapability.resolve()}),x.on("end",()=>{x.destroy(),this._done=!0,this._readCapability.resolve()}),x.on("error",w=>{this._error(w)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class f{constructor(x){this._url=x.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new n.PromiseCapability;const w=x.source;this._isStreamingSupported=!w.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var T;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const x=this._readableStream.read();return x===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=x.length,(T=this.onProgress)==null||T.call(this,{loaded:this._loaded}),{value:new Uint8Array(x).buffer,done:!1})}cancel(x){if(!this._readableStream){this._error(x);return}this._readableStream.destroy(x)}_error(x){this._storedError=x,this._readCapability.resolve()}_setReadableStream(x){this._readableStream=x,x.on("readable",()=>{this._readCapability.resolve()}),x.on("end",()=>{x.destroy(),this._done=!0,this._readCapability.resolve()}),x.on("error",w=>{this._error(w)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function p(E,x){return{protocol:E.protocol,auth:E.auth,host:E.hostname,port:E.port,path:E.path,method:"GET",headers:x}}class g extends h{constructor(x){super(x);const w=T=>{if(T.statusCode===404){const I=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=I,this._headersCapability.reject(I);return}this._headersCapability.resolve(),this._setReadableStream(T);const O=I=>this._readableStream.headers[I.toLowerCase()],{allowRangeRequests:N,suggestedLength:A}=(0,r.validateRangeRequestCapabilities)({getResponseHeader:O,isHttp:x.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=N,this._contentLength=A||this._contentLength,this._filename=(0,r.extractFilenameFromHeader)(O)};if(this._request=null,this._url.protocol==="http:"){const T=require$$5;this._request=T.request(p(this._url,x.httpHeaders),w)}else{const T=require$$5;this._request=T.request(p(this._url,x.httpHeaders),w)}this._request.on("error",T=>{this._storedError=T,this._headersCapability.reject(T)}),this._request.end()}}class y extends f{constructor(x,w,T){super(x),this._httpHeaders={};for(const N in x.httpHeaders){const A=x.httpHeaders[N];A!==void 0&&(this._httpHeaders[N]=A)}this._httpHeaders.Range=`bytes=${w}-${T-1}`;const O=N=>{if(N.statusCode===404){const A=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=A;return}this._setReadableStream(N)};if(this._request=null,this._url.protocol==="http:"){const N=require$$5;this._request=N.request(p(this._url,this._httpHeaders),O)}else{const N=require$$5;this._request=N.request(p(this._url,this._httpHeaders),O)}this._request.on("error",N=>{this._storedError=N}),this._request.end()}}class v extends h{constructor(x){super(x);let w=decodeURIComponent(this._url.path);o.test(this._url.href)&&(w=w.replace(/^\//,""));const T=require$$5;T.lstat(w,(O,N)=>{if(O){O.code==="ENOENT"&&(O=new n.MissingPDFException(`Missing PDF "${w}".`)),this._storedError=O,this._headersCapability.reject(O);return}this._contentLength=N.size,this._setReadableStream(T.createReadStream(w)),this._headersCapability.resolve()})}}class _ extends f{constructor(x,w,T){super(x);let O=decodeURIComponent(this._url.path);o.test(this._url.href)&&(O=O.replace(/^\//,""));const N=require$$5;this._setReadableStream(N.createReadStream(O,{start:w,end:T-1}))}}},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var n=t(6),r=t(1);const o={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},c="http://www.w3.org/XML/1998/namespace",u="http://www.w3.org/1999/xlink",h=["butt","round","square"],f=["miter","round","bevel"],p=function(N,A="",I=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!I)return URL.createObjectURL(new Blob([N],{type:A}));const k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let M=`data:${A};base64,`;for(let L=0,H=N.length;L<H;L+=3){const D=N[L]&255,q=N[L+1]&255,J=N[L+2]&255,ae=D>>2,V=(D&3)<<4|q>>4,Z=L+1<H?(q&15)<<2|J>>6:64,G=L+2<H?J&63:64;M+=k[ae]+k[V]+k[Z]+k[G]}return M},g=function(){const N=new Uint8Array([137,80,78,71,13,10,26,10]),A=12,I=new Int32Array(256);for(let J=0;J<256;J++){let ae=J;for(let V=0;V<8;V++)ae=ae&1?3988292384^ae>>1&2147483647:ae>>1&2147483647;I[J]=ae}function k(J,ae,V){let Z=-1;for(let G=ae;G<V;G++){const ne=(Z^J[G])&255,B=I[ne];Z=Z>>>8^B}return Z^-1}function M(J,ae,V,Z){let G=Z;const ne=ae.length;V[G]=ne>>24&255,V[G+1]=ne>>16&255,V[G+2]=ne>>8&255,V[G+3]=ne&255,G+=4,V[G]=J.charCodeAt(0)&255,V[G+1]=J.charCodeAt(1)&255,V[G+2]=J.charCodeAt(2)&255,V[G+3]=J.charCodeAt(3)&255,G+=4,V.set(ae,G),G+=ae.length;const B=k(V,Z+4,G);V[G]=B>>24&255,V[G+1]=B>>16&255,V[G+2]=B>>8&255,V[G+3]=B&255}function L(J,ae,V){let Z=1,G=0;for(let ne=ae;ne<V;++ne)Z=(Z+(J[ne]&255))%65521,G=(G+Z)%65521;return G<<16|Z}function H(J){if(!r.isNodeJS)return D(J);try{const ae=parseInt(process.versions.node)>=8?J:Buffer.from(J),V=require$$5.deflateSync(ae,{level:9});return V instanceof Uint8Array?V:new Uint8Array(V)}catch(ae){(0,r.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+ae)}return D(J)}function D(J){let ae=J.length;const V=65535,Z=Math.ceil(ae/V),G=new Uint8Array(2+ae+Z*5+4);let ne=0;G[ne++]=120,G[ne++]=156;let B=0;for(;ae>V;)G[ne++]=0,G[ne++]=255,G[ne++]=255,G[ne++]=0,G[ne++]=0,G.set(J.subarray(B,B+V),ne),ne+=V,B+=V,ae-=V;G[ne++]=1,G[ne++]=ae&255,G[ne++]=ae>>8&255,G[ne++]=~ae&65535&255,G[ne++]=(~ae&65535)>>8&255,G.set(J.subarray(B),ne),ne+=J.length-B;const F=L(J,0,J.length);return G[ne++]=F>>24&255,G[ne++]=F>>16&255,G[ne++]=F>>8&255,G[ne++]=F&255,G}function q(J,ae,V,Z){const G=J.width,ne=J.height;let B,F,Y;const U=J.data;switch(ae){case r.ImageKind.GRAYSCALE_1BPP:F=0,B=1,Y=G+7>>3;break;case r.ImageKind.RGB_24BPP:F=2,B=8,Y=G*3;break;case r.ImageKind.RGBA_32BPP:F=6,B=8,Y=G*4;break;default:throw new Error("invalid format")}const C=new Uint8Array((1+Y)*ne);let P=0,$=0;for(let Re=0;Re<ne;++Re)C[P++]=0,C.set(U.subarray($,$+Y),P),$+=Y,P+=Y;if(ae===r.ImageKind.GRAYSCALE_1BPP&&Z){P=0;for(let Re=0;Re<ne;Re++){P++;for(let Ce=0;Ce<Y;Ce++)C[P++]^=255}}const W=new Uint8Array([G>>24&255,G>>16&255,G>>8&255,G&255,ne>>24&255,ne>>16&255,ne>>8&255,ne&255,B,F,0,0,0]),te=H(C),ee=N.length+A*3+W.length+te.length,ce=new Uint8Array(ee);let he=0;return ce.set(N,he),he+=N.length,M("IHDR",W,ce,he),he+=A+W.length,M("IDATA",te,ce,he),he+=A+te.length,M("IEND",new Uint8Array(0),ce,he),p(ce,"image/png",V)}return function(ae,V,Z){const G=ae.kind===void 0?r.ImageKind.GRAYSCALE_1BPP:ae.kind;return q(ae,G,V,Z)}}();class y{constructor(){this.fontSizeScale=1,this.fontWeight=o.fontWeight,this.fontSize=0,this.textMatrix=r.IDENTITY_MATRIX,this.fontMatrix=r.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=r.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=o.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(A,I){this.x=A,this.y=I}}function v(N){let A=[];const I=[];for(const k of N){if(k.fn==="save"){A.push({fnId:92,fn:"group",items:[]}),I.push(A),A=A.at(-1).items;continue}k.fn==="restore"?A=I.pop():A.push(k)}return A}function _(N){if(Number.isInteger(N))return N.toString();const A=N.toFixed(10);let I=A.length-1;if(A[I]!=="0")return A;do I--;while(A[I]==="0");return A.substring(0,A[I]==="."?I:I+1)}function E(N){if(N[4]===0&&N[5]===0){if(N[1]===0&&N[2]===0)return N[0]===1&&N[3]===1?"":`scale(${_(N[0])} ${_(N[3])})`;if(N[0]===N[3]&&N[1]===-N[2]){const A=Math.acos(N[0])*180/Math.PI;return`rotate(${_(A)})`}}else if(N[0]===1&&N[1]===0&&N[2]===0&&N[3]===1)return`translate(${_(N[4])} ${_(N[5])})`;return`matrix(${_(N[0])} ${_(N[1])} ${_(N[2])} ${_(N[3])} ${_(N[4])} ${_(N[5])})`}let x=0,w=0,T=0;class O{constructor(A,I,k=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new y,this.transformMatrix=r.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=A,this.objs=I,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!k,this._operatorIdMapping=[];for(const M in r.OPS)this._operatorIdMapping[r.OPS[M]]=M}getObject(A,I=null){return typeof A=="string"?A.startsWith("g_")?this.commonObjs.get(A):this.objs.get(A):I}save(){this.transformStack.push(this.transformMatrix);const A=this.current;this.extraStack.push(A),this.current=A.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(A){this.save(),this.executeOpTree(A),this.restore()}loadDependencies(A){const I=A.fnArray,k=A.argsArray;for(let M=0,L=I.length;M<L;M++)if(I[M]===r.OPS.dependency)for(const H of k[M]){const D=H.startsWith("g_")?this.commonObjs:this.objs,q=new Promise(J=>{D.get(H,J)});this.current.dependencies.push(q)}return Promise.all(this.current.dependencies)}transform(A,I,k,M,L,H){const D=[A,I,k,M,L,H];this.transformMatrix=r.Util.transform(this.transformMatrix,D),this.tgrp=null}getSVG(A,I){this.viewport=I;const k=this._initialize(I);return this.loadDependencies(A).then(()=>(this.transformMatrix=r.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(A)),k))}convertOpList(A){const I=this._operatorIdMapping,k=A.argsArray,M=A.fnArray,L=[];for(let H=0,D=M.length;H<D;H++){const q=M[H];L.push({fnId:q,fn:I[q],args:k[H]})}return v(L)}executeOpTree(A){for(const I of A){const k=I.fn,M=I.fnId,L=I.args;switch(M|0){case r.OPS.beginText:this.beginText();break;case r.OPS.dependency:break;case r.OPS.setLeading:this.setLeading(L);break;case r.OPS.setLeadingMoveText:this.setLeadingMoveText(L[0],L[1]);break;case r.OPS.setFont:this.setFont(L);break;case r.OPS.showText:this.showText(L[0]);break;case r.OPS.showSpacedText:this.showText(L[0]);break;case r.OPS.endText:this.endText();break;case r.OPS.moveText:this.moveText(L[0],L[1]);break;case r.OPS.setCharSpacing:this.setCharSpacing(L[0]);break;case r.OPS.setWordSpacing:this.setWordSpacing(L[0]);break;case r.OPS.setHScale:this.setHScale(L[0]);break;case r.OPS.setTextMatrix:this.setTextMatrix(L[0],L[1],L[2],L[3],L[4],L[5]);break;case r.OPS.setTextRise:this.setTextRise(L[0]);break;case r.OPS.setTextRenderingMode:this.setTextRenderingMode(L[0]);break;case r.OPS.setLineWidth:this.setLineWidth(L[0]);break;case r.OPS.setLineJoin:this.setLineJoin(L[0]);break;case r.OPS.setLineCap:this.setLineCap(L[0]);break;case r.OPS.setMiterLimit:this.setMiterLimit(L[0]);break;case r.OPS.setFillRGBColor:this.setFillRGBColor(L[0],L[1],L[2]);break;case r.OPS.setStrokeRGBColor:this.setStrokeRGBColor(L[0],L[1],L[2]);break;case r.OPS.setStrokeColorN:this.setStrokeColorN(L);break;case r.OPS.setFillColorN:this.setFillColorN(L);break;case r.OPS.shadingFill:this.shadingFill(L[0]);break;case r.OPS.setDash:this.setDash(L[0],L[1]);break;case r.OPS.setRenderingIntent:this.setRenderingIntent(L[0]);break;case r.OPS.setFlatness:this.setFlatness(L[0]);break;case r.OPS.setGState:this.setGState(L[0]);break;case r.OPS.fill:this.fill();break;case r.OPS.eoFill:this.eoFill();break;case r.OPS.stroke:this.stroke();break;case r.OPS.fillStroke:this.fillStroke();break;case r.OPS.eoFillStroke:this.eoFillStroke();break;case r.OPS.clip:this.clip("nonzero");break;case r.OPS.eoClip:this.clip("evenodd");break;case r.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case r.OPS.paintImageXObject:this.paintImageXObject(L[0]);break;case r.OPS.paintInlineImageXObject:this.paintInlineImageXObject(L[0]);break;case r.OPS.paintImageMaskXObject:this.paintImageMaskXObject(L[0]);break;case r.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(L[0],L[1]);break;case r.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case r.OPS.closePath:this.closePath();break;case r.OPS.closeStroke:this.closeStroke();break;case r.OPS.closeFillStroke:this.closeFillStroke();break;case r.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case r.OPS.nextLine:this.nextLine();break;case r.OPS.transform:this.transform(L[0],L[1],L[2],L[3],L[4],L[5]);break;case r.OPS.constructPath:this.constructPath(L[0],L[1]);break;case r.OPS.endPath:this.endPath();break;case 92:this.group(I.items);break;default:(0,r.warn)(`Unimplemented operator ${k}`);break}}}setWordSpacing(A){this.current.wordSpacing=A}setCharSpacing(A){this.current.charSpacing=A}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(A,I,k,M,L,H){const D=this.current;D.textMatrix=D.lineMatrix=[A,I,k,M,L,H],D.textMatrixScale=Math.hypot(A,I),D.x=D.lineX=0,D.y=D.lineY=0,D.xcoords=[],D.ycoords=[],D.tspan=this.svgFactory.createElement("svg:tspan"),D.tspan.setAttributeNS(null,"font-family",D.fontFamily),D.tspan.setAttributeNS(null,"font-size",`${_(D.fontSize)}px`),D.tspan.setAttributeNS(null,"y",_(-D.y)),D.txtElement=this.svgFactory.createElement("svg:text"),D.txtElement.append(D.tspan)}beginText(){const A=this.current;A.x=A.lineX=0,A.y=A.lineY=0,A.textMatrix=r.IDENTITY_MATRIX,A.lineMatrix=r.IDENTITY_MATRIX,A.textMatrixScale=1,A.tspan=this.svgFactory.createElement("svg:tspan"),A.txtElement=this.svgFactory.createElement("svg:text"),A.txtgrp=this.svgFactory.createElement("svg:g"),A.xcoords=[],A.ycoords=[]}moveText(A,I){const k=this.current;k.x=k.lineX+=A,k.y=k.lineY+=I,k.xcoords=[],k.ycoords=[],k.tspan=this.svgFactory.createElement("svg:tspan"),k.tspan.setAttributeNS(null,"font-family",k.fontFamily),k.tspan.setAttributeNS(null,"font-size",`${_(k.fontSize)}px`),k.tspan.setAttributeNS(null,"y",_(-k.y))}showText(A){const I=this.current,k=I.font,M=I.fontSize;if(M===0)return;const L=I.fontSizeScale,H=I.charSpacing,D=I.wordSpacing,q=I.fontDirection,J=I.textHScale*q,ae=k.vertical,V=ae?1:-1,Z=k.defaultVMetrics,G=M*I.fontMatrix[0];let ne=0;for(const Y of A){if(Y===null){ne+=q*D;continue}else if(typeof Y=="number"){ne+=V*Y*M/1e3;continue}const U=(Y.isSpace?D:0)+H,C=Y.fontChar;let P,$,W=Y.width;if(ae){let ee;const ce=Y.vmetric||Z;ee=Y.vmetric?ce[1]:W*.5,ee=-ee*G;const he=ce[2]*G;W=ce?-ce[0]:W,P=ee/L,$=(ne+he)/L}else P=ne/L,$=0;(Y.isInFont||k.missingFile)&&(I.xcoords.push(I.x+P),ae&&I.ycoords.push(-I.y+$),I.tspan.textContent+=C);const te=ae?W*G-U*q:W*G+U*q;ne+=te}I.tspan.setAttributeNS(null,"x",I.xcoords.map(_).join(" ")),ae?I.tspan.setAttributeNS(null,"y",I.ycoords.map(_).join(" ")):I.tspan.setAttributeNS(null,"y",_(-I.y)),ae?I.y-=ne:I.x+=ne*J,I.tspan.setAttributeNS(null,"font-family",I.fontFamily),I.tspan.setAttributeNS(null,"font-size",`${_(I.fontSize)}px`),I.fontStyle!==o.fontStyle&&I.tspan.setAttributeNS(null,"font-style",I.fontStyle),I.fontWeight!==o.fontWeight&&I.tspan.setAttributeNS(null,"font-weight",I.fontWeight);const B=I.textRenderingMode&r.TextRenderingMode.FILL_STROKE_MASK;if(B===r.TextRenderingMode.FILL||B===r.TextRenderingMode.FILL_STROKE?(I.fillColor!==o.fillColor&&I.tspan.setAttributeNS(null,"fill",I.fillColor),I.fillAlpha<1&&I.tspan.setAttributeNS(null,"fill-opacity",I.fillAlpha)):I.textRenderingMode===r.TextRenderingMode.ADD_TO_PATH?I.tspan.setAttributeNS(null,"fill","transparent"):I.tspan.setAttributeNS(null,"fill","none"),B===r.TextRenderingMode.STROKE||B===r.TextRenderingMode.FILL_STROKE){const Y=1/(I.textMatrixScale||1);this._setStrokeAttributes(I.tspan,Y)}let F=I.textMatrix;I.textRise!==0&&(F=F.slice(),F[5]+=I.textRise),I.txtElement.setAttributeNS(null,"transform",`${E(F)} scale(${_(J)}, -1)`),I.txtElement.setAttributeNS(c,"xml:space","preserve"),I.txtElement.append(I.tspan),I.txtgrp.append(I.txtElement),this._ensureTransformGroup().append(I.txtElement)}setLeadingMoveText(A,I){this.setLeading(-I),this.moveText(A,I)}addFontStyle(A){if(!A.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const I=p(A.data,A.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${A.loadedName}"; src: url(${I}); }
`}setFont(A){const I=this.current,k=this.commonObjs.get(A[0]);let M=A[1];I.font=k,this.embedFonts&&!k.missingFile&&!this.embeddedFonts[k.loadedName]&&(this.addFontStyle(k),this.embeddedFonts[k.loadedName]=k),I.fontMatrix=k.fontMatrix||r.FONT_IDENTITY_MATRIX;let L="normal";k.black?L="900":k.bold&&(L="bold");const H=k.italic?"italic":"normal";M<0?(M=-M,I.fontDirection=-1):I.fontDirection=1,I.fontSize=M,I.fontFamily=k.loadedName,I.fontWeight=L,I.fontStyle=H,I.tspan=this.svgFactory.createElement("svg:tspan"),I.tspan.setAttributeNS(null,"y",_(-I.y)),I.xcoords=[],I.ycoords=[]}endText(){var I;const A=this.current;A.textRenderingMode&r.TextRenderingMode.ADD_TO_PATH_FLAG&&((I=A.txtElement)!=null&&I.hasChildNodes())&&(A.element=A.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(A){A>0&&(this.current.lineWidth=A)}setLineCap(A){this.current.lineCap=h[A]}setLineJoin(A){this.current.lineJoin=f[A]}setMiterLimit(A){this.current.miterLimit=A}setStrokeAlpha(A){this.current.strokeAlpha=A}setStrokeRGBColor(A,I,k){this.current.strokeColor=r.Util.makeHexColor(A,I,k)}setFillAlpha(A){this.current.fillAlpha=A}setFillRGBColor(A,I,k){this.current.fillColor=r.Util.makeHexColor(A,I,k),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(A){this.current.strokeColor=this._makeColorN_Pattern(A)}setFillColorN(A){this.current.fillColor=this._makeColorN_Pattern(A)}shadingFill(A){const{width:I,height:k}=this.viewport,M=r.Util.inverseTransform(this.transformMatrix),[L,H,D,q]=r.Util.getAxialAlignedBoundingBox([0,0,I,k],M),J=this.svgFactory.createElement("svg:rect");J.setAttributeNS(null,"x",L),J.setAttributeNS(null,"y",H),J.setAttributeNS(null,"width",D-L),J.setAttributeNS(null,"height",q-H),J.setAttributeNS(null,"fill",this._makeShadingPattern(A)),this.current.fillAlpha<1&&J.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(J)}_makeColorN_Pattern(A){return A[0]==="TilingPattern"?this._makeTilingPattern(A):this._makeShadingPattern(A)}_makeTilingPattern(A){const I=A[1],k=A[2],M=A[3]||r.IDENTITY_MATRIX,[L,H,D,q]=A[4],J=A[5],ae=A[6],V=A[7],Z=`shading${T++}`,[G,ne,B,F]=r.Util.normalizeRect([...r.Util.applyTransform([L,H],M),...r.Util.applyTransform([D,q],M)]),[Y,U]=r.Util.singularValueDecompose2dScale(M),C=J*Y,P=ae*U,$=this.svgFactory.createElement("svg:pattern");$.setAttributeNS(null,"id",Z),$.setAttributeNS(null,"patternUnits","userSpaceOnUse"),$.setAttributeNS(null,"width",C),$.setAttributeNS(null,"height",P),$.setAttributeNS(null,"x",`${G}`),$.setAttributeNS(null,"y",`${ne}`);const W=this.svg,te=this.transformMatrix,ee=this.current.fillColor,ce=this.current.strokeColor,he=this.svgFactory.create(B-G,F-ne);if(this.svg=he,this.transformMatrix=M,V===2){const Re=r.Util.makeHexColor(...I);this.current.fillColor=Re,this.current.strokeColor=Re}return this.executeOpTree(this.convertOpList(k)),this.svg=W,this.transformMatrix=te,this.current.fillColor=ee,this.current.strokeColor=ce,$.append(he.childNodes[0]),this.defs.append($),`url(#${Z})`}_makeShadingPattern(A){switch(typeof A=="string"&&(A=this.objs.get(A)),A[0]){case"RadialAxial":const I=`shading${T++}`,k=A[3];let M;switch(A[1]){case"axial":const L=A[4],H=A[5];M=this.svgFactory.createElement("svg:linearGradient"),M.setAttributeNS(null,"id",I),M.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),M.setAttributeNS(null,"x1",L[0]),M.setAttributeNS(null,"y1",L[1]),M.setAttributeNS(null,"x2",H[0]),M.setAttributeNS(null,"y2",H[1]);break;case"radial":const D=A[4],q=A[5],J=A[6],ae=A[7];M=this.svgFactory.createElement("svg:radialGradient"),M.setAttributeNS(null,"id",I),M.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),M.setAttributeNS(null,"cx",q[0]),M.setAttributeNS(null,"cy",q[1]),M.setAttributeNS(null,"r",ae),M.setAttributeNS(null,"fx",D[0]),M.setAttributeNS(null,"fy",D[1]),M.setAttributeNS(null,"fr",J);break;default:throw new Error(`Unknown RadialAxial type: ${A[1]}`)}for(const L of k){const H=this.svgFactory.createElement("svg:stop");H.setAttributeNS(null,"offset",L[0]),H.setAttributeNS(null,"stop-color",L[1]),M.append(H)}return this.defs.append(M),`url(#${I})`;case"Mesh":return(0,r.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${A[0]}`)}}setDash(A,I){this.current.dashArray=A,this.current.dashPhase=I}constructPath(A,I){const k=this.current;let M=k.x,L=k.y,H=[],D=0;for(const q of A)switch(q|0){case r.OPS.rectangle:M=I[D++],L=I[D++];const J=I[D++],ae=I[D++],V=M+J,Z=L+ae;H.push("M",_(M),_(L),"L",_(V),_(L),"L",_(V),_(Z),"L",_(M),_(Z),"Z");break;case r.OPS.moveTo:M=I[D++],L=I[D++],H.push("M",_(M),_(L));break;case r.OPS.lineTo:M=I[D++],L=I[D++],H.push("L",_(M),_(L));break;case r.OPS.curveTo:M=I[D+4],L=I[D+5],H.push("C",_(I[D]),_(I[D+1]),_(I[D+2]),_(I[D+3]),_(M),_(L)),D+=6;break;case r.OPS.curveTo2:H.push("C",_(M),_(L),_(I[D]),_(I[D+1]),_(I[D+2]),_(I[D+3])),M=I[D+2],L=I[D+3],D+=4;break;case r.OPS.curveTo3:M=I[D+2],L=I[D+3],H.push("C",_(I[D]),_(I[D+1]),_(M),_(L),_(M),_(L)),D+=4;break;case r.OPS.closePath:H.push("Z");break}H=H.join(" "),k.path&&A.length>0&&A[0]!==r.OPS.rectangle&&A[0]!==r.OPS.moveTo?H=k.path.getAttributeNS(null,"d")+H:(k.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(k.path)),k.path.setAttributeNS(null,"d",H),k.path.setAttributeNS(null,"fill","none"),k.element=k.path,k.setCurrentPoint(M,L)}endPath(){const A=this.current;if(A.path=null,!this.pendingClip)return;if(!A.element){this.pendingClip=null;return}const I=`clippath${x++}`,k=this.svgFactory.createElement("svg:clipPath");k.setAttributeNS(null,"id",I),k.setAttributeNS(null,"transform",E(this.transformMatrix));const M=A.element.cloneNode(!0);if(this.pendingClip==="evenodd"?M.setAttributeNS(null,"clip-rule","evenodd"):M.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,k.append(M),this.defs.append(k),A.activeClipUrl){A.clipGroup=null;for(const L of this.extraStack)L.clipGroup=null;k.setAttributeNS(null,"clip-path",A.activeClipUrl)}A.activeClipUrl=`url(#${I})`,this.tgrp=null}clip(A){this.pendingClip=A}closePath(){const A=this.current;if(A.path){const I=`${A.path.getAttributeNS(null,"d")}Z`;A.path.setAttributeNS(null,"d",I)}}setLeading(A){this.current.leading=-A}setTextRise(A){this.current.textRise=A}setTextRenderingMode(A){this.current.textRenderingMode=A}setHScale(A){this.current.textHScale=A/100}setRenderingIntent(A){}setFlatness(A){}setGState(A){for(const[I,k]of A)switch(I){case"LW":this.setLineWidth(k);break;case"LC":this.setLineCap(k);break;case"LJ":this.setLineJoin(k);break;case"ML":this.setMiterLimit(k);break;case"D":this.setDash(k[0],k[1]);break;case"RI":this.setRenderingIntent(k);break;case"FL":this.setFlatness(k);break;case"Font":this.setFont(k);break;case"CA":this.setStrokeAlpha(k);break;case"ca":this.setFillAlpha(k);break;default:(0,r.warn)(`Unimplemented graphic state operator ${I}`);break}}fill(){const A=this.current;A.element&&(A.element.setAttributeNS(null,"fill",A.fillColor),A.element.setAttributeNS(null,"fill-opacity",A.fillAlpha),this.endPath())}stroke(){const A=this.current;A.element&&(this._setStrokeAttributes(A.element),A.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(A,I=1){const k=this.current;let M=k.dashArray;I!==1&&M.length>0&&(M=M.map(function(L){return I*L})),A.setAttributeNS(null,"stroke",k.strokeColor),A.setAttributeNS(null,"stroke-opacity",k.strokeAlpha),A.setAttributeNS(null,"stroke-miterlimit",_(k.miterLimit)),A.setAttributeNS(null,"stroke-linecap",k.lineCap),A.setAttributeNS(null,"stroke-linejoin",k.lineJoin),A.setAttributeNS(null,"stroke-width",_(I*k.lineWidth)+"px"),A.setAttributeNS(null,"stroke-dasharray",M.map(_).join(" ")),A.setAttributeNS(null,"stroke-dashoffset",_(I*k.dashPhase)+"px")}eoFill(){var A;(A=this.current.element)==null||A.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var A;(A=this.current.element)==null||A.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const A=this.svgFactory.createElement("svg:rect");A.setAttributeNS(null,"x","0"),A.setAttributeNS(null,"y","0"),A.setAttributeNS(null,"width","1px"),A.setAttributeNS(null,"height","1px"),A.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(A)}paintImageXObject(A){const I=this.getObject(A);if(!I){(0,r.warn)(`Dependent image with object ID ${A} is not ready yet`);return}this.paintInlineImageXObject(I)}paintInlineImageXObject(A,I){const k=A.width,M=A.height,L=g(A,this.forceDataSchema,!!I),H=this.svgFactory.createElement("svg:rect");H.setAttributeNS(null,"x","0"),H.setAttributeNS(null,"y","0"),H.setAttributeNS(null,"width",_(k)),H.setAttributeNS(null,"height",_(M)),this.current.element=H,this.clip("nonzero");const D=this.svgFactory.createElement("svg:image");D.setAttributeNS(u,"xlink:href",L),D.setAttributeNS(null,"x","0"),D.setAttributeNS(null,"y",_(-M)),D.setAttributeNS(null,"width",_(k)+"px"),D.setAttributeNS(null,"height",_(M)+"px"),D.setAttributeNS(null,"transform",`scale(${_(1/k)} ${_(-1/M)})`),I?I.append(D):this._ensureTransformGroup().append(D)}paintImageMaskXObject(A){const I=this.getObject(A.data,A);if(I.bitmap){(0,r.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const k=this.current,M=I.width,L=I.height,H=k.fillColor;k.maskId=`mask${w++}`;const D=this.svgFactory.createElement("svg:mask");D.setAttributeNS(null,"id",k.maskId);const q=this.svgFactory.createElement("svg:rect");q.setAttributeNS(null,"x","0"),q.setAttributeNS(null,"y","0"),q.setAttributeNS(null,"width",_(M)),q.setAttributeNS(null,"height",_(L)),q.setAttributeNS(null,"fill",H),q.setAttributeNS(null,"mask",`url(#${k.maskId})`),this.defs.append(D),this._ensureTransformGroup().append(q),this.paintInlineImageXObject(I,D)}paintFormXObjectBegin(A,I){if(Array.isArray(A)&&A.length===6&&this.transform(A[0],A[1],A[2],A[3],A[4],A[5]),I){const k=I[2]-I[0],M=I[3]-I[1],L=this.svgFactory.createElement("svg:rect");L.setAttributeNS(null,"x",I[0]),L.setAttributeNS(null,"y",I[1]),L.setAttributeNS(null,"width",_(k)),L.setAttributeNS(null,"height",_(M)),this.current.element=L,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(A){const I=this.svgFactory.create(A.width,A.height),k=this.svgFactory.createElement("svg:defs");I.append(k),this.defs=k;const M=this.svgFactory.createElement("svg:g");return M.setAttributeNS(null,"transform",E(A.transform)),I.append(M),this.svg=M,I}_ensureClipGroup(){if(!this.current.clipGroup){const A=this.svgFactory.createElement("svg:g");A.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(A),this.current.clipGroup=A}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",E(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=O},(s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class t{static textContent(r){const o=[],c={items:o,styles:Object.create(null)};function u(h){var g;if(!h)return;let f=null;const p=h.name;if(p==="#text")f=h.value;else if(t.shouldBuildText(p))(g=h==null?void 0:h.attributes)!=null&&g.textContent?f=h.attributes.textContent:h.value&&(f=h.value);else return;if(f!==null&&o.push({str:f}),!!h.children)for(const y of h.children)u(y)}return u(r),c}static shouldBuildText(r){return!(r==="textarea"||r==="input"||r==="option"||r==="select")}}e.XfaText=t},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=E,e.updateTextLayer=x;var n=t(1),r=t(6);const o=1e5,c=30,u=.8,h=new Map;function f(w,T){let O;if(T&&n.FeatureTest.isOffscreenCanvasSupported)O=new OffscreenCanvas(w,w).getContext("2d",{alpha:!1});else{const N=document.createElement("canvas");N.width=N.height=w,O=N.getContext("2d",{alpha:!1})}return O}function p(w,T){const O=h.get(w);if(O)return O;const N=f(c,T);N.font=`${c}px ${w}`;const A=N.measureText("");let I=A.fontBoundingBoxAscent,k=Math.abs(A.fontBoundingBoxDescent);if(I){const L=I/(I+k);return h.set(w,L),N.canvas.width=N.canvas.height=0,L}N.strokeStyle="red",N.clearRect(0,0,c,c),N.strokeText("g",0,0);let M=N.getImageData(0,0,c,c).data;k=0;for(let L=M.length-1-3;L>=0;L-=4)if(M[L]>0){k=Math.ceil(L/4/c);break}N.clearRect(0,0,c,c),N.strokeText("A",0,c),M=N.getImageData(0,0,c,c).data,I=0;for(let L=0,H=M.length;L<H;L+=4)if(M[L]>0){I=c-Math.floor(L/4/c);break}if(N.canvas.width=N.canvas.height=0,I){const L=I/(I+k);return h.set(w,L),L}return h.set(w,u),u}function g(w,T,O){const N=document.createElement("span"),A={angle:0,canvasWidth:0,hasText:T.str!=="",hasEOL:T.hasEOL,fontSize:0};w._textDivs.push(N);const I=n.Util.transform(w._transform,T.transform);let k=Math.atan2(I[1],I[0]);const M=O[T.fontName];M.vertical&&(k+=Math.PI/2);const L=Math.hypot(I[2],I[3]),H=L*p(M.fontFamily,w._isOffscreenCanvasSupported);let D,q;k===0?(D=I[4],q=I[5]-H):(D=I[4]+H*Math.sin(k),q=I[5]-H*Math.cos(k));const J="calc(var(--scale-factor)*",ae=N.style;w._container===w._rootContainer?(ae.left=`${(100*D/w._pageWidth).toFixed(2)}%`,ae.top=`${(100*q/w._pageHeight).toFixed(2)}%`):(ae.left=`${J}${D.toFixed(2)}px)`,ae.top=`${J}${q.toFixed(2)}px)`),ae.fontSize=`${J}${L.toFixed(2)}px)`,ae.fontFamily=M.fontFamily,A.fontSize=L,N.setAttribute("role","presentation"),N.textContent=T.str,N.dir=T.dir,w._fontInspectorEnabled&&(N.dataset.fontName=T.fontName),k!==0&&(A.angle=k*(180/Math.PI));let V=!1;if(T.str.length>1)V=!0;else if(T.str!==" "&&T.transform[0]!==T.transform[3]){const Z=Math.abs(T.transform[0]),G=Math.abs(T.transform[3]);Z!==G&&Math.max(Z,G)/Math.min(Z,G)>1.5&&(V=!0)}V&&(A.canvasWidth=M.vertical?T.height:T.width),w._textDivProperties.set(N,A),w._isReadableStream&&w._layoutText(N)}function y(w){const{div:T,scale:O,properties:N,ctx:A,prevFontSize:I,prevFontFamily:k}=w,{style:M}=T;let L="";if(N.canvasWidth!==0&&N.hasText){const{fontFamily:H}=M,{canvasWidth:D,fontSize:q}=N;(I!==q||k!==H)&&(A.font=`${q*O}px ${H}`,w.prevFontSize=q,w.prevFontFamily=H);const{width:J}=A.measureText(T.textContent);J>0&&(L=`scaleX(${D*O/J})`)}N.angle!==0&&(L=`rotate(${N.angle}deg) ${L}`),L.length>0&&(M.transform=L)}function v(w){if(w._canceled)return;const T=w._textDivs,O=w._capability;if(T.length>o){O.resolve();return}if(!w._isReadableStream)for(const A of T)w._layoutText(A);O.resolve()}class _{constructor({textContentSource:T,container:O,viewport:N,textDivs:A,textDivProperties:I,textContentItemsStr:k,isOffscreenCanvasSupported:M}){var J;this._textContentSource=T,this._isReadableStream=T instanceof ReadableStream,this._container=this._rootContainer=O,this._textDivs=A||[],this._textContentItemsStr=k||[],this._isOffscreenCanvasSupported=M,this._fontInspectorEnabled=!!((J=globalThis.FontInspector)!=null&&J.enabled),this._reader=null,this._textDivProperties=I||new WeakMap,this._canceled=!1,this._capability=new n.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:N.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:f(0,M)};const{pageWidth:L,pageHeight:H,pageX:D,pageY:q}=N.rawDims;this._transform=[1,0,0,-1,-D,q+H],this._pageWidth=L,this._pageHeight=H,(0,r.setLayerDimensions)(O,N),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(T,O){for(const N of T){if(N.str===void 0){if(N.type==="beginMarkedContentProps"||N.type==="beginMarkedContent"){const A=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),N.id!==null&&this._container.setAttribute("id",`${N.id}`),A.append(this._container)}else N.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(N.str),g(this,N,O)}}_layoutText(T){const O=this._layoutTextParams.properties=this._textDivProperties.get(T);if(this._layoutTextParams.div=T,y(this._layoutTextParams),O.hasText&&this._container.append(T),O.hasEOL){const N=document.createElement("br");N.setAttribute("role","presentation"),this._container.append(N)}}_render(){const T=new n.PromiseCapability;let O=Object.create(null);if(this._isReadableStream){const N=()=>{this._reader.read().then(({value:A,done:I})=>{if(I){T.resolve();return}Object.assign(O,A.styles),this._processItems(A.items,O),N()},T.reject)};this._reader=this._textContentSource.getReader(),N()}else if(this._textContentSource){const{items:N,styles:A}=this._textContentSource;this._processItems(N,A),T.resolve()}else throw new Error('No "textContentSource" parameter specified.');T.promise.then(()=>{O=null,v(this)},this._capability.reject)}}e.TextLayerRenderTask=_;function E(w){!w.textContentSource&&(w.textContent||w.textContentStream)&&((0,r.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),w.textContentSource=w.textContent||w.textContentStream);const{container:T,viewport:O}=w,N=getComputedStyle(T),A=N.getPropertyValue("visibility"),I=parseFloat(N.getPropertyValue("--scale-factor"));A==="visible"&&(!I||Math.abs(I-O.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const k=new _(w);return k._render(),k}function x({container:w,viewport:T,textDivs:O,textDivProperties:N,isOffscreenCanvasSupported:A,mustRotate:I=!0,mustRescale:k=!0}){if(I&&(0,r.setLayerDimensions)(w,{rotation:T.rotation}),k){const M=f(0,A),H={prevFontSize:null,prevFontFamily:null,div:null,scale:T.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:M};for(const D of O)H.properties=N.get(D),H.div=D,y(H)}}},(s,e,t)=>{var p,g,y,v,_,E,x,w,T,O,N,xc,Va,Ec,Sc;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var n=t(1),r=t(4),o=t(28),c=t(33),u=t(6),h=t(34);const L=class L{constructor({uiManager:D,pageIndex:q,div:J,accessibilityManager:ae,annotationLayer:V,viewport:Z,l10n:G}){Se(this,N);Se(this,p);Se(this,g,!1);Se(this,y,null);Se(this,v,this.pointerup.bind(this));Se(this,_,this.pointerdown.bind(this));Se(this,E,new Map);Se(this,x,!1);Se(this,w,!1);Se(this,T,!1);Se(this,O);const ne=[o.FreeTextEditor,c.InkEditor,h.StampEditor];if(!L._initialized){L._initialized=!0;for(const B of ne)B.initialize(G)}D.registerEditorTypes(ne),we(this,O,D),this.pageIndex=q,this.div=J,we(this,p,ae),we(this,y,V),this.viewport=Z,R(this,O).addLayer(this)}get isEmpty(){return R(this,E).size===0}updateToolbar(D){R(this,O).updateToolbar(D)}updateMode(D=R(this,O).getMode()){de(this,N,Sc).call(this),D===n.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),D!==n.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",D===n.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",D===n.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",D===n.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(D){if(!D&&R(this,O).getMode()!==n.AnnotationEditorType.INK)return;if(!D){for(const J of R(this,E).values())if(J.isEmpty()){J.setInBackground();return}}de(this,N,Va).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(D){R(this,O).setEditingState(D)}addCommands(D){R(this,O).addCommands(D)}enable(){this.div.style.pointerEvents="auto";const D=new Set;for(const J of R(this,E).values())J.enableEditing(),J.annotationElementId&&D.add(J.annotationElementId);if(!R(this,y))return;const q=R(this,y).getEditableAnnotations();for(const J of q){if(J.hide(),R(this,O).isDeletedAnnotationElement(J.data.id)||D.has(J.data.id))continue;const ae=this.deserialize(J);ae&&(this.addOrRebuild(ae),ae.enableEditing())}}disable(){var q;we(this,T,!0),this.div.style.pointerEvents="none";const D=new Set;for(const J of R(this,E).values()){if(J.disableEditing(),!J.annotationElementId||J.serialize()!==null){D.add(J.annotationElementId);continue}(q=this.getEditableAnnotation(J.annotationElementId))==null||q.show(),J.remove()}if(R(this,y)){const J=R(this,y).getEditableAnnotations();for(const ae of J){const{id:V}=ae.data;D.has(V)||R(this,O).isDeletedAnnotationElement(V)||ae.show()}}de(this,N,Sc).call(this),this.isEmpty&&(this.div.hidden=!0),we(this,T,!1)}getEditableAnnotation(D){var q;return((q=R(this,y))==null?void 0:q.getEditableAnnotation(D))||null}setActiveEditor(D){R(this,O).getActive()!==D&&R(this,O).setActiveEditor(D)}enableClick(){this.div.addEventListener("pointerdown",R(this,_)),this.div.addEventListener("pointerup",R(this,v))}disableClick(){this.div.removeEventListener("pointerdown",R(this,_)),this.div.removeEventListener("pointerup",R(this,v))}attach(D){R(this,E).set(D.id,D);const{annotationElementId:q}=D;q&&R(this,O).isDeletedAnnotationElement(q)&&R(this,O).removeDeletedAnnotationElement(D)}detach(D){var q;R(this,E).delete(D.id),(q=R(this,p))==null||q.removePointerInTextLayer(D.contentDiv),!R(this,T)&&D.annotationElementId&&R(this,O).addDeletedAnnotationElement(D)}remove(D){this.detach(D),R(this,O).removeEditor(D),D.div.contains(document.activeElement)&&setTimeout(()=>{R(this,O).focusMainContainer()},0),D.div.remove(),D.isAttachedToDOM=!1,R(this,w)||this.addInkEditorIfNeeded(!1)}changeParent(D){var q;D.parent!==this&&(D.annotationElementId&&(R(this,O).addDeletedAnnotationElement(D.annotationElementId),r.AnnotationEditor.deleteAnnotationElement(D),D.annotationElementId=null),this.attach(D),(q=D.parent)==null||q.detach(D),D.setParent(this),D.div&&D.isAttachedToDOM&&(D.div.remove(),this.div.append(D.div)))}add(D){if(this.changeParent(D),R(this,O).addEditor(D),this.attach(D),!D.isAttachedToDOM){const q=D.render();this.div.append(q),D.isAttachedToDOM=!0}D.fixAndSetPosition(),D.onceAdded(),R(this,O).addToAnnotationStorage(D)}moveEditorInDOM(D){var J;if(!D.isAttachedToDOM)return;const{activeElement:q}=document;D.div.contains(q)&&(D._focusEventsAllowed=!1,setTimeout(()=>{D.div.contains(document.activeElement)?D._focusEventsAllowed=!0:(D.div.addEventListener("focusin",()=>{D._focusEventsAllowed=!0},{once:!0}),q.focus())},0)),D._structTreeParentId=(J=R(this,p))==null?void 0:J.moveElementInDOM(this.div,D.div,D.contentDiv,!0)}addOrRebuild(D){D.needsToBeRebuilt()?D.rebuild():this.add(D)}addUndoableEditor(D){const q=()=>D._uiManager.rebuild(D),J=()=>{D.remove()};this.addCommands({cmd:q,undo:J,mustExec:!1})}getNextId(){return R(this,O).getId()}pasteEditor(D,q){R(this,O).updateToolbar(D),R(this,O).updateMode(D);const{offsetX:J,offsetY:ae}=de(this,N,Ec).call(this),V=this.getNextId(),Z=de(this,N,xc).call(this,{parent:this,id:V,x:J,y:ae,uiManager:R(this,O),isCentered:!0,...q});Z&&this.add(Z)}deserialize(D){switch(D.annotationType??D.annotationEditorType){case n.AnnotationEditorType.FREETEXT:return o.FreeTextEditor.deserialize(D,this,R(this,O));case n.AnnotationEditorType.INK:return c.InkEditor.deserialize(D,this,R(this,O));case n.AnnotationEditorType.STAMP:return h.StampEditor.deserialize(D,this,R(this,O))}return null}addNewEditor(){de(this,N,Va).call(this,de(this,N,Ec).call(this),!0)}setSelected(D){R(this,O).setSelected(D)}toggleSelected(D){R(this,O).toggleSelected(D)}isSelected(D){return R(this,O).isSelected(D)}unselect(D){R(this,O).unselect(D)}pointerup(D){const{isMac:q}=n.FeatureTest.platform;if(!(D.button!==0||D.ctrlKey&&q)&&D.target===this.div&&R(this,x)){if(we(this,x,!1),!R(this,g)){we(this,g,!0);return}if(R(this,O).getMode()===n.AnnotationEditorType.STAMP){R(this,O).unselectAll();return}de(this,N,Va).call(this,D,!1)}}pointerdown(D){if(R(this,x)){we(this,x,!1);return}const{isMac:q}=n.FeatureTest.platform;if(D.button!==0||D.ctrlKey&&q||D.target!==this.div)return;we(this,x,!0);const J=R(this,O).getActive();we(this,g,!J||J.isEmpty())}findNewParent(D,q,J){const ae=R(this,O).findParent(q,J);return ae===null||ae===this?!1:(ae.changeParent(D),!0)}destroy(){var D,q;((D=R(this,O).getActive())==null?void 0:D.parent)===this&&(R(this,O).commitOrRemove(),R(this,O).setActiveEditor(null));for(const J of R(this,E).values())(q=R(this,p))==null||q.removePointerInTextLayer(J.contentDiv),J.setParent(null),J.isAttachedToDOM=!1,J.div.remove();this.div=null,R(this,E).clear(),R(this,O).removeLayer(this)}render({viewport:D}){this.viewport=D,(0,u.setLayerDimensions)(this.div,D);for(const q of R(this,O).getEditors(this.pageIndex))this.add(q);this.updateMode()}update({viewport:D}){R(this,O).commitOrRemove(),this.viewport=D,(0,u.setLayerDimensions)(this.div,{rotation:D.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:D,pageHeight:q}=this.viewport.rawDims;return[D,q]}};p=new WeakMap,g=new WeakMap,y=new WeakMap,v=new WeakMap,_=new WeakMap,E=new WeakMap,x=new WeakMap,w=new WeakMap,T=new WeakMap,O=new WeakMap,N=new WeakSet,xc=function(D){switch(R(this,O).getMode()){case n.AnnotationEditorType.FREETEXT:return new o.FreeTextEditor(D);case n.AnnotationEditorType.INK:return new c.InkEditor(D);case n.AnnotationEditorType.STAMP:return new h.StampEditor(D)}return null},Va=function(D,q){const J=this.getNextId(),ae=de(this,N,xc).call(this,{parent:this,id:J,x:D.offsetX,y:D.offsetY,uiManager:R(this,O),isCentered:q});return ae&&this.add(ae),ae},Ec=function(){const{x:D,y:q,width:J,height:ae}=this.div.getBoundingClientRect(),V=Math.max(0,D),Z=Math.max(0,q),G=Math.min(window.innerWidth,D+J),ne=Math.min(window.innerHeight,q+ae),B=(V+G)/2-D,F=(Z+ne)/2-q,[Y,U]=this.viewport.rotation%180===0?[B,F]:[F,B];return{offsetX:Y,offsetY:U}},Sc=function(){we(this,w,!0);for(const D of R(this,E).values())D.isEmpty()&&D.remove();we(this,w,!1)},ot(L,"_initialized",!1);let f=L;e.AnnotationEditorLayer=f},(s,e,t)=>{var h,f,p,g,y,v,_,E,x,w,Ef,Sf,wf,Rr,wc,Af,Ac;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var n=t(1),r=t(5),o=t(4),c=t(29);const L=class L extends o.AnnotationEditor{constructor(q){super({...q,name:"freeTextEditor"});Se(this,w);Se(this,h,this.editorDivBlur.bind(this));Se(this,f,this.editorDivFocus.bind(this));Se(this,p,this.editorDivInput.bind(this));Se(this,g,this.editorDivKeydown.bind(this));Se(this,y);Se(this,v,"");Se(this,_,`${this.id}-editor`);Se(this,E);Se(this,x,null);we(this,y,q.color||L._defaultColor||o.AnnotationEditor._defaultLineColor),we(this,E,q.fontSize||L._defaultFontSize)}static get _keyboardManager(){const q=L.prototype,J=Z=>Z.isEmpty(),ae=r.AnnotationEditorUIManager.TRANSLATE_SMALL,V=r.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new r.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],q.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],q.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],q._translateEmpty,{args:[-ae,0],checker:J}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],q._translateEmpty,{args:[-V,0],checker:J}],[["ArrowRight","mac+ArrowRight"],q._translateEmpty,{args:[ae,0],checker:J}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],q._translateEmpty,{args:[V,0],checker:J}],[["ArrowUp","mac+ArrowUp"],q._translateEmpty,{args:[0,-ae],checker:J}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],q._translateEmpty,{args:[0,-V],checker:J}],[["ArrowDown","mac+ArrowDown"],q._translateEmpty,{args:[0,ae],checker:J}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],q._translateEmpty,{args:[0,V],checker:J}]]))}static initialize(q){o.AnnotationEditor.initialize(q,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const J=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(J.getPropertyValue("--freetext-padding"))}static updateDefaultParams(q,J){switch(q){case n.AnnotationEditorParamsType.FREETEXT_SIZE:L._defaultFontSize=J;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:L._defaultColor=J;break}}updateParams(q,J){switch(q){case n.AnnotationEditorParamsType.FREETEXT_SIZE:de(this,w,Ef).call(this,J);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:de(this,w,Sf).call(this,J);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,L._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,L._defaultColor||o.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,R(this,E)],[n.AnnotationEditorParamsType.FREETEXT_COLOR,R(this,y)]]}_translateEmpty(q,J){this._uiManager.translateSelectedEditors(q,J,!0)}getInitialTranslation(){const q=this.parentScale;return[-L._internalPadding*q,-(L._internalPadding+R(this,E))*q]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",R(this,g)),this.editorDiv.addEventListener("focus",R(this,f)),this.editorDiv.addEventListener("blur",R(this,h)),this.editorDiv.addEventListener("input",R(this,p)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",R(this,_)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",R(this,g)),this.editorDiv.removeEventListener("focus",R(this,f)),this.editorDiv.removeEventListener("blur",R(this,h)),this.editorDiv.removeEventListener("input",R(this,p)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(q){this._focusEventsAllowed&&(super.focusin(q),q.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var q;if(this.width){de(this,w,Ac).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(q=this._initialOptions)!=null&&q.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const q=R(this,v),J=we(this,v,de(this,w,wf).call(this).trimEnd());if(q===J)return;const ae=V=>{if(we(this,v,V),!V){this.remove();return}de(this,w,wc).call(this),this._uiManager.rebuild(this),de(this,w,Rr).call(this)};this.addCommands({cmd:()=>{ae(J)},undo:()=>{ae(q)},mustExec:!1}),de(this,w,Rr).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(q){this.enterInEditMode()}keydown(q){q.target===this.div&&q.key==="Enter"&&(this.enterInEditMode(),q.preventDefault())}editorDivKeydown(q){L._keyboardManager.exec(this,q)}editorDivFocus(q){this.isEditing=!0}editorDivBlur(q){this.isEditing=!1}editorDivInput(q){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let q,J;this.width&&(q=this.x,J=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",R(this,_)),this.enableEditing(),o.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(V=>{var Z;return(Z=this.editorDiv)==null?void 0:Z.setAttribute("aria-label",V)}),o.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(V=>{var Z;return(Z=this.editorDiv)==null?void 0:Z.setAttribute("default-content",V)}),this.editorDiv.contentEditable=!0;const{style:ae}=this.editorDiv;if(ae.fontSize=`calc(${R(this,E)}px * var(--scale-factor))`,ae.color=R(this,y),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,r.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[V,Z]=this.parentDimensions;if(this.annotationElementId){const{position:G}=R(this,x);let[ne,B]=this.getInitialTranslation();[ne,B]=this.pageTranslationToScreen(ne,B);const[F,Y]=this.pageDimensions,[U,C]=this.pageTranslation;let P,$;switch(this.rotation){case 0:P=q+(G[0]-U)/F,$=J+this.height-(G[1]-C)/Y;break;case 90:P=q+(G[0]-U)/F,$=J-(G[1]-C)/Y,[ne,B]=[B,-ne];break;case 180:P=q-this.width+(G[0]-U)/F,$=J-(G[1]-C)/Y,[ne,B]=[-ne,-B];break;case 270:P=q+(G[0]-U-this.height*Y)/F,$=J+(G[1]-C-this.width*F)/Y,[ne,B]=[-B,ne];break}this.setAt(P*V,$*Z,ne,B)}else this.setAt(q*V,J*Z,this.width*V,this.height*Z);de(this,w,wc).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(q,J,ae){let V=null;if(q instanceof c.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:G,fontColor:ne},rect:B,rotation:F,id:Y},textContent:U,textPosition:C,parent:{page:{pageNumber:P}}}=q;if(!U||U.length===0)return null;V=q={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(ne),fontSize:G,value:U.join(`
`),position:C,pageIndex:P-1,rect:B,rotation:F,id:Y,deleted:!1}}const Z=super.deserialize(q,J,ae);return we(Z,E,q.fontSize),we(Z,y,n.Util.makeHexColor(...q.color)),we(Z,v,q.value),Z.annotationElementId=q.id||null,we(Z,x,V),Z}serialize(q=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const J=L._internalPadding*this.parentScale,ae=this.getRect(J,J),V=o.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:R(this,y)),Z={annotationType:n.AnnotationEditorType.FREETEXT,color:V,fontSize:R(this,E),value:R(this,v),pageIndex:this.pageIndex,rect:ae,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return q?Z:this.annotationElementId&&!de(this,w,Af).call(this,Z)?null:(Z.id=this.annotationElementId,Z)}};h=new WeakMap,f=new WeakMap,p=new WeakMap,g=new WeakMap,y=new WeakMap,v=new WeakMap,_=new WeakMap,E=new WeakMap,x=new WeakMap,w=new WeakSet,Ef=function(q){const J=V=>{this.editorDiv.style.fontSize=`calc(${V}px * var(--scale-factor))`,this.translate(0,-(V-R(this,E))*this.parentScale),we(this,E,V),de(this,w,Rr).call(this)},ae=R(this,E);this.addCommands({cmd:()=>{J(q)},undo:()=>{J(ae)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Sf=function(q){const J=R(this,y);this.addCommands({cmd:()=>{we(this,y,this.editorDiv.style.color=q)},undo:()=>{we(this,y,this.editorDiv.style.color=J)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},wf=function(){const q=this.editorDiv.getElementsByTagName("div");if(q.length===0)return this.editorDiv.innerText;const J=[];for(const ae of q)J.push(ae.innerText.replace(/\r\n?|\n/,""));return J.join(`
`)},Rr=function(){const[q,J]=this.parentDimensions;let ae;if(this.isAttachedToDOM)ae=this.div.getBoundingClientRect();else{const{currentLayer:V,div:Z}=this,G=Z.style.display;Z.style.display="hidden",V.div.append(this.div),ae=Z.getBoundingClientRect(),Z.remove(),Z.style.display=G}this.rotation%180===this.parentRotation%180?(this.width=ae.width/q,this.height=ae.height/J):(this.width=ae.height/q,this.height=ae.width/J),this.fixAndSetPosition()},wc=function(){if(this.editorDiv.replaceChildren(),!!R(this,v))for(const q of R(this,v).split(`
`)){const J=document.createElement("div");J.append(q?document.createTextNode(q):document.createElement("br")),this.editorDiv.append(J)}},Af=function(q){const{value:J,fontSize:ae,color:V,rect:Z,pageIndex:G}=R(this,x);return q.value!==J||q.fontSize!==ae||q.rect.some((ne,B)=>Math.abs(ne-Z[B])>=1)||q.color.some((ne,B)=>ne!==V[B])||q.pageIndex!==G},Ac=function(q=!1){if(!this.annotationElementId)return;if(de(this,w,Rr).call(this),!q&&(this.width===0||this.height===0)){setTimeout(()=>de(this,w,Ac).call(this,!0),0);return}const J=L._internalPadding*this.parentScale;R(this,x).rect=this.getRect(J,J)},ot(L,"_freeTextDefaultContent",""),ot(L,"_internalPadding",0),ot(L,"_defaultColor",null),ot(L,"_defaultFontSize",10),ot(L,"_type","freetext");let u=L;e.FreeTextEditor=u},(s,e,t)=>{var $,te,Wi,Tf,he,Re,Ce,Ie,Ne,$e,ge,_e,X,se,fe,ve,Me,Be,Le,pe,Ge,qe,Rf,Za,Tc,Rc,ct,yt,mt,Fe,be,ye,tt,Cc,vt,oe,ke,Ve,Cf,Oc;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var n=t(1),r=t(6),o=t(3),c=t(30),u=t(31),h=t(32);const f=1e3,p=9,g=new WeakSet;function y(et){return{width:et[2]-et[0],height:et[3]-et[1]}}class v{static create(ie){switch(ie.data.annotationType){case n.AnnotationType.LINK:return new E(ie);case n.AnnotationType.TEXT:return new x(ie);case n.AnnotationType.WIDGET:switch(ie.data.fieldType){case"Tx":return new T(ie);case"Btn":return ie.data.radioButton?new A(ie):ie.data.checkBox?new N(ie):new I(ie);case"Ch":return new k(ie);case"Sig":return new O(ie)}return new w(ie);case n.AnnotationType.POPUP:return new M(ie);case n.AnnotationType.FREETEXT:return new H(ie);case n.AnnotationType.LINE:return new D(ie);case n.AnnotationType.SQUARE:return new q(ie);case n.AnnotationType.CIRCLE:return new J(ie);case n.AnnotationType.POLYLINE:return new ae(ie);case n.AnnotationType.CARET:return new Z(ie);case n.AnnotationType.INK:return new G(ie);case n.AnnotationType.POLYGON:return new V(ie);case n.AnnotationType.HIGHLIGHT:return new ne(ie);case n.AnnotationType.UNDERLINE:return new B(ie);case n.AnnotationType.SQUIGGLY:return new F(ie);case n.AnnotationType.STRIKEOUT:return new Y(ie);case n.AnnotationType.STAMP:return new U(ie);case n.AnnotationType.FILEATTACHMENT:return new C(ie);default:return new _(ie)}}}const W=class W{constructor(ie,{isRenderable:Q=!1,ignoreBorder:ue=!1,createQuadrilaterals:Ae=!1}={}){Se(this,$,!1);this.isRenderable=Q,this.data=ie.data,this.layer=ie.layer,this.linkService=ie.linkService,this.downloadManager=ie.downloadManager,this.imageResourcesPath=ie.imageResourcesPath,this.renderForms=ie.renderForms,this.svgFactory=ie.svgFactory,this.annotationStorage=ie.annotationStorage,this.enableScripting=ie.enableScripting,this.hasJSActions=ie.hasJSActions,this._fieldObjects=ie.fieldObjects,this.parent=ie.parent,Q&&(this.container=this._createContainer(ue)),Ae&&this._createQuadrilaterals()}static _hasPopupData({titleObj:ie,contentsObj:Q,richText:ue}){return!!(ie!=null&&ie.str||Q!=null&&Q.str||ue!=null&&ue.str)}get hasPopupData(){return W._hasPopupData(this.data)}_createContainer(ie){const{data:Q,parent:{page:ue,viewport:Ae}}=this,Oe=document.createElement("section");Oe.setAttribute("data-annotation-id",Q.id),this instanceof w||(Oe.tabIndex=f),Oe.style.zIndex=this.parent.zIndex++,this.data.popupRef&&Oe.setAttribute("aria-haspopup","dialog"),Q.noRotate&&Oe.classList.add("norotate");const{pageWidth:je,pageHeight:Ue,pageX:it,pageY:st}=Ae.rawDims;if(!Q.rect||this instanceof M){const{rotation:ut}=Q;return!Q.hasOwnCanvas&&ut!==0&&this.setRotation(ut,Oe),Oe}const{width:Ye,height:ht}=y(Q.rect),Qe=n.Util.normalizeRect([Q.rect[0],ue.view[3]-Q.rect[1]+ue.view[1],Q.rect[2],ue.view[3]-Q.rect[3]+ue.view[1]]);if(!ie&&Q.borderStyle.width>0){Oe.style.borderWidth=`${Q.borderStyle.width}px`;const ut=Q.borderStyle.horizontalCornerRadius,bt=Q.borderStyle.verticalCornerRadius;if(ut>0||bt>0){const Ot=`calc(${ut}px * var(--scale-factor)) / calc(${bt}px * var(--scale-factor))`;Oe.style.borderRadius=Ot}else if(this instanceof A){const Ot=`calc(${Ye}px * var(--scale-factor)) / calc(${ht}px * var(--scale-factor))`;Oe.style.borderRadius=Ot}switch(Q.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:Oe.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:Oe.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:Oe.style.borderBottomStyle="solid";break}const At=Q.borderColor||null;At?(we(this,$,!0),Oe.style.borderColor=n.Util.makeHexColor(At[0]|0,At[1]|0,At[2]|0)):Oe.style.borderWidth=0}Oe.style.left=`${100*(Qe[0]-it)/je}%`,Oe.style.top=`${100*(Qe[1]-st)/Ue}%`;const{rotation:Ke}=Q;return Q.hasOwnCanvas||Ke===0?(Oe.style.width=`${100*Ye/je}%`,Oe.style.height=`${100*ht/Ue}%`):this.setRotation(Ke,Oe),Oe}setRotation(ie,Q=this.container){if(!this.data.rect)return;const{pageWidth:ue,pageHeight:Ae}=this.parent.viewport.rawDims,{width:Oe,height:je}=y(this.data.rect);let Ue,it;ie%180===0?(Ue=100*Oe/ue,it=100*je/Ae):(Ue=100*je/ue,it=100*Oe/Ae),Q.style.width=`${Ue}%`,Q.style.height=`${it}%`,Q.setAttribute("data-main-rotation",(360-ie)%360)}get _commonActions(){const ie=(Q,ue,Ae)=>{const Oe=Ae.detail[Q],je=Oe[0],Ue=Oe.slice(1);Ae.target.style[ue]=c.ColorConverters[`${je}_HTML`](Ue),this.annotationStorage.setValue(this.data.id,{[ue]:c.ColorConverters[`${je}_rgb`](Ue)})};return(0,n.shadow)(this,"_commonActions",{display:Q=>{const{display:ue}=Q.detail,Ae=ue%2===1;this.container.style.visibility=Ae?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:Ae,noPrint:ue===1||ue===2})},print:Q=>{this.annotationStorage.setValue(this.data.id,{noPrint:!Q.detail.print})},hidden:Q=>{const{hidden:ue}=Q.detail;this.container.style.visibility=ue?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:ue,noView:ue})},focus:Q=>{setTimeout(()=>Q.target.focus({preventScroll:!1}),0)},userName:Q=>{Q.target.title=Q.detail.userName},readonly:Q=>{Q.target.disabled=Q.detail.readonly},required:Q=>{this._setRequired(Q.target,Q.detail.required)},bgColor:Q=>{ie("bgColor","backgroundColor",Q)},fillColor:Q=>{ie("fillColor","backgroundColor",Q)},fgColor:Q=>{ie("fgColor","color",Q)},textColor:Q=>{ie("textColor","color",Q)},borderColor:Q=>{ie("borderColor","borderColor",Q)},strokeColor:Q=>{ie("strokeColor","borderColor",Q)},rotation:Q=>{const ue=Q.detail.rotation;this.setRotation(ue),this.annotationStorage.setValue(this.data.id,{rotation:ue})}})}_dispatchEventFromSandbox(ie,Q){const ue=this._commonActions;for(const Ae of Object.keys(Q.detail)){const Oe=ie[Ae]||ue[Ae];Oe==null||Oe(Q)}}_setDefaultPropertiesFromJS(ie){if(!this.enableScripting)return;const Q=this.annotationStorage.getRawValue(this.data.id);if(!Q)return;const ue=this._commonActions;for(const[Ae,Oe]of Object.entries(Q)){const je=ue[Ae];if(je){const Ue={detail:{[Ae]:Oe},target:ie};je(Ue),delete Q[Ae]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:ie}=this.data;if(!ie)return;const[Q,ue,Ae,Oe]=this.data.rect;if(ie.length===1){const[,{x:bt,y:At},{x:Ot,y:Bt}]=ie[0];if(Ae===bt&&Oe===At&&Q===Ot&&ue===Bt)return}const{style:je}=this.container;let Ue;if(R(this,$)){const{borderColor:bt,borderWidth:At}=je;je.borderWidth=0,Ue=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${bt}" stroke-width="${At}">`],this.container.classList.add("hasBorder")}const it=Ae-Q,st=Oe-ue,{svgFactory:Ye}=this,ht=Ye.createElement("svg");ht.classList.add("quadrilateralsContainer"),ht.setAttribute("width",0),ht.setAttribute("height",0);const Qe=Ye.createElement("defs");ht.append(Qe);const Ke=Ye.createElement("clipPath"),ut=`clippath_${this.data.id}`;Ke.setAttribute("id",ut),Ke.setAttribute("clipPathUnits","objectBoundingBox"),Qe.append(Ke);for(const[,{x:bt,y:At},{x:Ot,y:Bt}]of ie){const nt=Ye.createElement("rect"),me=(Ot-Q)/it,We=(Oe-At)/st,lt=(bt-Ot)/it,It=(At-Bt)/st;nt.setAttribute("x",me),nt.setAttribute("y",We),nt.setAttribute("width",lt),nt.setAttribute("height",It),Ke.append(nt),Ue==null||Ue.push(`<rect vector-effect="non-scaling-stroke" x="${me}" y="${We}" width="${lt}" height="${It}"/>`)}R(this,$)&&(Ue.push("</g></svg>')"),je.backgroundImage=Ue.join("")),this.container.append(ht),this.container.style.clipPath=`url(#${ut})`}_createPopup(){const{container:ie,data:Q}=this;ie.setAttribute("aria-haspopup","dialog");const ue=new M({data:{color:Q.color,titleObj:Q.titleObj,modificationDate:Q.modificationDate,contentsObj:Q.contentsObj,richText:Q.richText,parentRect:Q.rect,borderStyle:0,id:`popup_${Q.id}`,rotation:Q.rotation},parent:this.parent,elements:[this]});this.parent.div.append(ue.render())}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(ie,Q=null){const ue=[];if(this._fieldObjects){const Ae=this._fieldObjects[ie];if(Ae)for(const{page:Oe,id:je,exportValues:Ue}of Ae){if(Oe===-1||je===Q)continue;const it=typeof Ue=="string"?Ue:null,st=document.querySelector(`[data-element-id="${je}"]`);if(st&&!g.has(st)){(0,n.warn)(`_getElementsByName - element not allowed: ${je}`);continue}ue.push({id:je,exportValue:it,domElement:st})}return ue}for(const Ae of document.getElementsByName(ie)){const{exportValue:Oe}=Ae,je=Ae.getAttribute("data-element-id");je!==Q&&g.has(Ae)&&ue.push({id:je,exportValue:Oe,domElement:Ae})}return ue}show(){var ie;this.container&&(this.container.hidden=!1),(ie=this.popup)==null||ie.maybeShow()}hide(){var ie;this.container&&(this.container.hidden=!0),(ie=this.popup)==null||ie.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const ie=this.getElementsToTriggerPopup();if(Array.isArray(ie))for(const Q of ie)Q.classList.add("highlightArea");else ie.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:ie,data:{id:Q}}=this;this.container.addEventListener("dblclick",()=>{var ue;(ue=this.linkService.eventBus)==null||ue.dispatch("switchannotationeditormode",{source:this,mode:ie,editId:Q})})}};$=new WeakMap;let _=W;class E extends _{constructor(Q,ue=null){super(Q,{isRenderable:!0,ignoreBorder:!!(ue!=null&&ue.ignoreBorder),createQuadrilaterals:!0});Se(this,te);this.isTooltipOnly=Q.data.isTooltipOnly}render(){const{data:Q,linkService:ue}=this,Ae=document.createElement("a");Ae.setAttribute("data-element-id",Q.id);let Oe=!1;return Q.url?(ue.addLinkAttributes(Ae,Q.url,Q.newWindow),Oe=!0):Q.action?(this._bindNamedAction(Ae,Q.action),Oe=!0):Q.attachment?(this._bindAttachment(Ae,Q.attachment),Oe=!0):Q.setOCGState?(de(this,te,Tf).call(this,Ae,Q.setOCGState),Oe=!0):Q.dest?(this._bindLink(Ae,Q.dest),Oe=!0):(Q.actions&&(Q.actions.Action||Q.actions["Mouse Up"]||Q.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(Ae,Q),Oe=!0),Q.resetForm?(this._bindResetFormAction(Ae,Q.resetForm),Oe=!0):this.isTooltipOnly&&!Oe&&(this._bindLink(Ae,""),Oe=!0)),this.container.classList.add("linkAnnotation"),Oe&&this.container.append(Ae),this.container}_bindLink(Q,ue){Q.href=this.linkService.getDestinationHash(ue),Q.onclick=()=>(ue&&this.linkService.goToDestination(ue),!1),(ue||ue==="")&&de(this,te,Wi).call(this)}_bindNamedAction(Q,ue){Q.href=this.linkService.getAnchorUrl(""),Q.onclick=()=>(this.linkService.executeNamedAction(ue),!1),de(this,te,Wi).call(this)}_bindAttachment(Q,ue){Q.href=this.linkService.getAnchorUrl(""),Q.onclick=()=>{var Ae;return(Ae=this.downloadManager)==null||Ae.openOrDownloadData(this.container,ue.content,ue.filename),!1},de(this,te,Wi).call(this)}_bindJSAction(Q,ue){Q.href=this.linkService.getAnchorUrl("");const Ae=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const Oe of Object.keys(ue.actions)){const je=Ae.get(Oe);je&&(Q[je]=()=>{var Ue;return(Ue=this.linkService.eventBus)==null||Ue.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ue.id,name:Oe}}),!1})}Q.onclick||(Q.onclick=()=>!1),de(this,te,Wi).call(this)}_bindResetFormAction(Q,ue){const Ae=Q.onclick;if(Ae||(Q.href=this.linkService.getAnchorUrl("")),de(this,te,Wi).call(this),!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),Ae||(Q.onclick=()=>!1);return}Q.onclick=()=>{var ht;Ae==null||Ae();const{fields:Oe,refs:je,include:Ue}=ue,it=[];if(Oe.length!==0||je.length!==0){const Qe=new Set(je);for(const Ke of Oe){const ut=this._fieldObjects[Ke]||[];for(const{id:bt}of ut)Qe.add(bt)}for(const Ke of Object.values(this._fieldObjects))for(const ut of Ke)Qe.has(ut.id)===Ue&&it.push(ut)}else for(const Qe of Object.values(this._fieldObjects))it.push(...Qe);const st=this.annotationStorage,Ye=[];for(const Qe of it){const{id:Ke}=Qe;switch(Ye.push(Ke),Qe.type){case"text":{const bt=Qe.defaultValue||"";st.setValue(Ke,{value:bt});break}case"checkbox":case"radiobutton":{const bt=Qe.defaultValue===Qe.exportValues;st.setValue(Ke,{value:bt});break}case"combobox":case"listbox":{const bt=Qe.defaultValue||"";st.setValue(Ke,{value:bt});break}default:continue}const ut=document.querySelector(`[data-element-id="${Ke}"]`);if(ut){if(!g.has(ut)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${Ke}`);continue}}else continue;ut.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((ht=this.linkService.eventBus)==null||ht.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Ye,name:"ResetForm"}})),!1}}}te=new WeakSet,Wi=function(){this.container.setAttribute("data-internal-link","")},Tf=function(Q,ue){Q.href=this.linkService.getAnchorUrl(""),Q.onclick=()=>(this.linkService.executeSetOCGState(ue),!1),de(this,te,Wi).call(this)};class x extends _{constructor(ie){super(ie,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const ie=document.createElement("img");return ie.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",ie.alt="[{{type}} Annotation]",ie.dataset.l10nId="text_annotation_type",ie.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(ie),this.container}}class w extends _{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(ie){var Q;this.data.hasOwnCanvas&&(((Q=ie.previousSibling)==null?void 0:Q.nodeName)==="CANVAS"&&(ie.previousSibling.hidden=!0),ie.hidden=!1)}_getKeyModifier(ie){const{isWin:Q,isMac:ue}=n.FeatureTest.platform;return Q&&ie.ctrlKey||ue&&ie.metaKey}_setEventListener(ie,Q,ue,Ae,Oe){ue.includes("mouse")?ie.addEventListener(ue,je=>{var Ue;(Ue=this.linkService.eventBus)==null||Ue.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Ae,value:Oe(je),shift:je.shiftKey,modifier:this._getKeyModifier(je)}})}):ie.addEventListener(ue,je=>{var Ue;if(ue==="blur"){if(!Q.focused||!je.relatedTarget)return;Q.focused=!1}else if(ue==="focus"){if(Q.focused)return;Q.focused=!0}Oe&&((Ue=this.linkService.eventBus)==null||Ue.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Ae,value:Oe(je)}}))})}_setEventListeners(ie,Q,ue,Ae){var Oe,je,Ue;for(const[it,st]of ue)(st==="Action"||(Oe=this.data.actions)!=null&&Oe[st])&&((st==="Focus"||st==="Blur")&&(Q||(Q={focused:!1})),this._setEventListener(ie,Q,it,st,Ae),st==="Focus"&&!((je=this.data.actions)!=null&&je.Blur)?this._setEventListener(ie,Q,"blur","Blur",null):st==="Blur"&&!((Ue=this.data.actions)!=null&&Ue.Focus)&&this._setEventListener(ie,Q,"focus","Focus",null))}_setBackgroundColor(ie){const Q=this.data.backgroundColor||null;ie.style.backgroundColor=Q===null?"transparent":n.Util.makeHexColor(Q[0],Q[1],Q[2])}_setTextStyle(ie){const Q=["left","center","right"],{fontColor:ue}=this.data.defaultAppearanceData,Ae=this.data.defaultAppearanceData.fontSize||p,Oe=ie.style;let je;const Ue=2,it=st=>Math.round(10*st)/10;if(this.data.multiLine){const st=Math.abs(this.data.rect[3]-this.data.rect[1]-Ue),Ye=Math.round(st/(n.LINE_FACTOR*Ae))||1,ht=st/Ye;je=Math.min(Ae,it(ht/n.LINE_FACTOR))}else{const st=Math.abs(this.data.rect[3]-this.data.rect[1]-Ue);je=Math.min(Ae,it(st/n.LINE_FACTOR))}Oe.fontSize=`calc(${je}px * var(--scale-factor))`,Oe.color=n.Util.makeHexColor(ue[0],ue[1],ue[2]),this.data.textAlignment!==null&&(Oe.textAlign=Q[this.data.textAlignment])}_setRequired(ie,Q){Q?ie.setAttribute("required",!0):ie.removeAttribute("required"),ie.setAttribute("aria-required",Q)}}class T extends w{constructor(ie){const Q=ie.renderForms||!ie.data.hasAppearance&&!!ie.data.fieldValue;super(ie,{isRenderable:Q})}setPropertyOnSiblings(ie,Q,ue,Ae){const Oe=this.annotationStorage;for(const je of this._getElementsByName(ie.name,ie.id))je.domElement&&(je.domElement[Q]=ue),Oe.setValue(je.id,{[Ae]:ue})}render(){var Ae,Oe;const ie=this.annotationStorage,Q=this.data.id;this.container.classList.add("textWidgetAnnotation");let ue=null;if(this.renderForms){const je=ie.getValue(Q,{value:this.data.fieldValue});let Ue=je.value||"";const it=ie.getValue(Q,{charLimit:this.data.maxLen}).charLimit;it&&Ue.length>it&&(Ue=Ue.slice(0,it));let st=je.formattedValue||((Ae=this.data.textContent)==null?void 0:Ae.join(`
`))||null;st&&this.data.comb&&(st=st.replaceAll(/\s+/g,""));const Ye={userValue:Ue,formattedValue:st,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(ue=document.createElement("textarea"),ue.textContent=st??Ue,this.data.doNotScroll&&(ue.style.overflowY="hidden")):(ue=document.createElement("input"),ue.type="text",ue.setAttribute("value",st??Ue),this.data.doNotScroll&&(ue.style.overflowX="hidden")),this.data.hasOwnCanvas&&(ue.hidden=!0),g.add(ue),ue.setAttribute("data-element-id",Q),ue.disabled=this.data.readOnly,ue.name=this.data.fieldName,ue.tabIndex=f,this._setRequired(ue,this.data.required),it&&(ue.maxLength=it),ue.addEventListener("input",Qe=>{ie.setValue(Q,{value:Qe.target.value}),this.setPropertyOnSiblings(ue,"value",Qe.target.value,"value"),Ye.formattedValue=null}),ue.addEventListener("resetform",Qe=>{const Ke=this.data.defaultFieldValue??"";ue.value=Ye.userValue=Ke,Ye.formattedValue=null});let ht=Qe=>{const{formattedValue:Ke}=Ye;Ke!=null&&(Qe.target.value=Ke),Qe.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){ue.addEventListener("focus",Ke=>{if(Ye.focused)return;const{target:ut}=Ke;Ye.userValue&&(ut.value=Ye.userValue),Ye.lastCommittedValue=ut.value,Ye.commitKey=1,Ye.focused=!0}),ue.addEventListener("updatefromsandbox",Ke=>{this.showElementAndHideCanvas(Ke.target);const ut={value(bt){Ye.userValue=bt.detail.value??"",ie.setValue(Q,{value:Ye.userValue.toString()}),bt.target.value=Ye.userValue},formattedValue(bt){const{formattedValue:At}=bt.detail;Ye.formattedValue=At,At!=null&&bt.target!==document.activeElement&&(bt.target.value=At),ie.setValue(Q,{formattedValue:At})},selRange(bt){bt.target.setSelectionRange(...bt.detail.selRange)},charLimit:bt=>{var nt;const{charLimit:At}=bt.detail,{target:Ot}=bt;if(At===0){Ot.removeAttribute("maxLength");return}Ot.setAttribute("maxLength",At);let Bt=Ye.userValue;!Bt||Bt.length<=At||(Bt=Bt.slice(0,At),Ot.value=Ye.userValue=Bt,ie.setValue(Q,{value:Bt}),(nt=this.linkService.eventBus)==null||nt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Q,name:"Keystroke",value:Bt,willCommit:!0,commitKey:1,selStart:Ot.selectionStart,selEnd:Ot.selectionEnd}}))}};this._dispatchEventFromSandbox(ut,Ke)}),ue.addEventListener("keydown",Ke=>{var At;Ye.commitKey=1;let ut=-1;if(Ke.key==="Escape"?ut=0:Ke.key==="Enter"&&!this.data.multiLine?ut=2:Ke.key==="Tab"&&(Ye.commitKey=3),ut===-1)return;const{value:bt}=Ke.target;Ye.lastCommittedValue!==bt&&(Ye.lastCommittedValue=bt,Ye.userValue=bt,(At=this.linkService.eventBus)==null||At.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Q,name:"Keystroke",value:bt,willCommit:!0,commitKey:ut,selStart:Ke.target.selectionStart,selEnd:Ke.target.selectionEnd}}))});const Qe=ht;ht=null,ue.addEventListener("blur",Ke=>{var bt;if(!Ye.focused||!Ke.relatedTarget)return;Ye.focused=!1;const{value:ut}=Ke.target;Ye.userValue=ut,Ye.lastCommittedValue!==ut&&((bt=this.linkService.eventBus)==null||bt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Q,name:"Keystroke",value:ut,willCommit:!0,commitKey:Ye.commitKey,selStart:Ke.target.selectionStart,selEnd:Ke.target.selectionEnd}})),Qe(Ke)}),(Oe=this.data.actions)!=null&&Oe.Keystroke&&ue.addEventListener("beforeinput",Ke=>{var We;Ye.lastCommittedValue=null;const{data:ut,target:bt}=Ke,{value:At,selectionStart:Ot,selectionEnd:Bt}=bt;let nt=Ot,me=Bt;switch(Ke.inputType){case"deleteWordBackward":{const lt=At.substring(0,Ot).match(/\w*[^\w]*$/);lt&&(nt-=lt[0].length);break}case"deleteWordForward":{const lt=At.substring(Ot).match(/^[^\w]*\w*/);lt&&(me+=lt[0].length);break}case"deleteContentBackward":Ot===Bt&&(nt-=1);break;case"deleteContentForward":Ot===Bt&&(me+=1);break}Ke.preventDefault(),(We=this.linkService.eventBus)==null||We.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Q,name:"Keystroke",value:At,change:ut||"",willCommit:!1,selStart:nt,selEnd:me}})}),this._setEventListeners(ue,Ye,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ke=>Ke.target.value)}if(ht&&ue.addEventListener("blur",ht),this.data.comb){const Ke=(this.data.rect[2]-this.data.rect[0])/it;ue.classList.add("comb"),ue.style.letterSpacing=`calc(${Ke}px * var(--scale-factor) - 1ch)`}}else ue=document.createElement("div"),ue.textContent=this.data.fieldValue,ue.style.verticalAlign="middle",ue.style.display="table-cell";return this._setTextStyle(ue),this._setBackgroundColor(ue),this._setDefaultPropertiesFromJS(ue),this.container.append(ue),this.container}}class O extends w{constructor(ie){super(ie,{isRenderable:!!ie.data.hasOwnCanvas})}}class N extends w{constructor(ie){super(ie,{isRenderable:ie.renderForms})}render(){const ie=this.annotationStorage,Q=this.data,ue=Q.id;let Ae=ie.getValue(ue,{value:Q.exportValue===Q.fieldValue}).value;typeof Ae=="string"&&(Ae=Ae!=="Off",ie.setValue(ue,{value:Ae})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const Oe=document.createElement("input");return g.add(Oe),Oe.setAttribute("data-element-id",ue),Oe.disabled=Q.readOnly,this._setRequired(Oe,this.data.required),Oe.type="checkbox",Oe.name=Q.fieldName,Ae&&Oe.setAttribute("checked",!0),Oe.setAttribute("exportValue",Q.exportValue),Oe.tabIndex=f,Oe.addEventListener("change",je=>{const{name:Ue,checked:it}=je.target;for(const st of this._getElementsByName(Ue,ue)){const Ye=it&&st.exportValue===Q.exportValue;st.domElement&&(st.domElement.checked=Ye),ie.setValue(st.id,{value:Ye})}ie.setValue(ue,{value:it})}),Oe.addEventListener("resetform",je=>{const Ue=Q.defaultFieldValue||"Off";je.target.checked=Ue===Q.exportValue}),this.enableScripting&&this.hasJSActions&&(Oe.addEventListener("updatefromsandbox",je=>{const Ue={value(it){it.target.checked=it.detail.value!=="Off",ie.setValue(ue,{value:it.target.checked})}};this._dispatchEventFromSandbox(Ue,je)}),this._setEventListeners(Oe,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],je=>je.target.checked)),this._setBackgroundColor(Oe),this._setDefaultPropertiesFromJS(Oe),this.container.append(Oe),this.container}}class A extends w{constructor(ie){super(ie,{isRenderable:ie.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const ie=this.annotationStorage,Q=this.data,ue=Q.id;let Ae=ie.getValue(ue,{value:Q.fieldValue===Q.buttonValue}).value;typeof Ae=="string"&&(Ae=Ae!==Q.buttonValue,ie.setValue(ue,{value:Ae}));const Oe=document.createElement("input");if(g.add(Oe),Oe.setAttribute("data-element-id",ue),Oe.disabled=Q.readOnly,this._setRequired(Oe,this.data.required),Oe.type="radio",Oe.name=Q.fieldName,Ae&&Oe.setAttribute("checked",!0),Oe.tabIndex=f,Oe.addEventListener("change",je=>{const{name:Ue,checked:it}=je.target;for(const st of this._getElementsByName(Ue,ue))ie.setValue(st.id,{value:!1});ie.setValue(ue,{value:it})}),Oe.addEventListener("resetform",je=>{const Ue=Q.defaultFieldValue;je.target.checked=Ue!=null&&Ue===Q.buttonValue}),this.enableScripting&&this.hasJSActions){const je=Q.buttonValue;Oe.addEventListener("updatefromsandbox",Ue=>{const it={value:st=>{const Ye=je===st.detail.value;for(const ht of this._getElementsByName(st.target.name)){const Qe=Ye&&ht.id===ue;ht.domElement&&(ht.domElement.checked=Qe),ie.setValue(ht.id,{value:Qe})}}};this._dispatchEventFromSandbox(it,Ue)}),this._setEventListeners(Oe,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ue=>Ue.target.checked)}return this._setBackgroundColor(Oe),this._setDefaultPropertiesFromJS(Oe),this.container.append(Oe),this.container}}class I extends E{constructor(ie){super(ie,{ignoreBorder:ie.data.hasAppearance})}render(){const ie=super.render();ie.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(ie.title=this.data.alternativeText);const Q=ie.lastChild;return this.enableScripting&&this.hasJSActions&&Q&&(this._setDefaultPropertiesFromJS(Q),Q.addEventListener("updatefromsandbox",ue=>{this._dispatchEventFromSandbox({},ue)})),ie}}class k extends w{constructor(ie){super(ie,{isRenderable:ie.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const ie=this.annotationStorage,Q=this.data.id,ue=ie.getValue(Q,{value:this.data.fieldValue}),Ae=document.createElement("select");g.add(Ae),Ae.setAttribute("data-element-id",Q),Ae.disabled=this.data.readOnly,this._setRequired(Ae,this.data.required),Ae.name=this.data.fieldName,Ae.tabIndex=f;let Oe=this.data.combo&&this.data.options.length>0;this.data.combo||(Ae.size=this.data.options.length,this.data.multiSelect&&(Ae.multiple=!0)),Ae.addEventListener("resetform",Ye=>{const ht=this.data.defaultFieldValue;for(const Qe of Ae.options)Qe.selected=Qe.value===ht});for(const Ye of this.data.options){const ht=document.createElement("option");ht.textContent=Ye.displayValue,ht.value=Ye.exportValue,ue.value.includes(Ye.exportValue)&&(ht.setAttribute("selected",!0),Oe=!1),Ae.append(ht)}let je=null;if(Oe){const Ye=document.createElement("option");Ye.value=" ",Ye.setAttribute("hidden",!0),Ye.setAttribute("selected",!0),Ae.prepend(Ye),je=()=>{Ye.remove(),Ae.removeEventListener("input",je),je=null},Ae.addEventListener("input",je)}const Ue=Ye=>{const ht=Ye?"value":"textContent",{options:Qe,multiple:Ke}=Ae;return Ke?Array.prototype.filter.call(Qe,ut=>ut.selected).map(ut=>ut[ht]):Qe.selectedIndex===-1?null:Qe[Qe.selectedIndex][ht]};let it=Ue(!1);const st=Ye=>{const ht=Ye.target.options;return Array.prototype.map.call(ht,Qe=>({displayValue:Qe.textContent,exportValue:Qe.value}))};return this.enableScripting&&this.hasJSActions?(Ae.addEventListener("updatefromsandbox",Ye=>{const ht={value(Qe){je==null||je();const Ke=Qe.detail.value,ut=new Set(Array.isArray(Ke)?Ke:[Ke]);for(const bt of Ae.options)bt.selected=ut.has(bt.value);ie.setValue(Q,{value:Ue(!0)}),it=Ue(!1)},multipleSelection(Qe){Ae.multiple=!0},remove(Qe){const Ke=Ae.options,ut=Qe.detail.remove;Ke[ut].selected=!1,Ae.remove(ut),Ke.length>0&&Array.prototype.findIndex.call(Ke,At=>At.selected)===-1&&(Ke[0].selected=!0),ie.setValue(Q,{value:Ue(!0),items:st(Qe)}),it=Ue(!1)},clear(Qe){for(;Ae.length!==0;)Ae.remove(0);ie.setValue(Q,{value:null,items:[]}),it=Ue(!1)},insert(Qe){const{index:Ke,displayValue:ut,exportValue:bt}=Qe.detail.insert,At=Ae.children[Ke],Ot=document.createElement("option");Ot.textContent=ut,Ot.value=bt,At?At.before(Ot):Ae.append(Ot),ie.setValue(Q,{value:Ue(!0),items:st(Qe)}),it=Ue(!1)},items(Qe){const{items:Ke}=Qe.detail;for(;Ae.length!==0;)Ae.remove(0);for(const ut of Ke){const{displayValue:bt,exportValue:At}=ut,Ot=document.createElement("option");Ot.textContent=bt,Ot.value=At,Ae.append(Ot)}Ae.options.length>0&&(Ae.options[0].selected=!0),ie.setValue(Q,{value:Ue(!0),items:st(Qe)}),it=Ue(!1)},indices(Qe){const Ke=new Set(Qe.detail.indices);for(const ut of Qe.target.options)ut.selected=Ke.has(ut.index);ie.setValue(Q,{value:Ue(!0)}),it=Ue(!1)},editable(Qe){Qe.target.disabled=!Qe.detail.editable}};this._dispatchEventFromSandbox(ht,Ye)}),Ae.addEventListener("input",Ye=>{var Qe;const ht=Ue(!0);ie.setValue(Q,{value:ht}),Ye.preventDefault(),(Qe=this.linkService.eventBus)==null||Qe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Q,name:"Keystroke",value:it,changeEx:ht,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(Ae,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Ye=>Ye.target.value)):Ae.addEventListener("input",function(Ye){ie.setValue(Q,{value:Ue(!0)})}),this.data.combo&&this._setTextStyle(Ae),this._setBackgroundColor(Ae),this._setDefaultPropertiesFromJS(Ae),this.container.append(Ae),this.container}}class M extends _{constructor(ie){const{data:Q,elements:ue}=ie;super(ie,{isRenderable:_._hasPopupData(Q)}),this.elements=ue}render(){this.container.classList.add("popupAnnotation");const ie=new L({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),Q=[];for(const ue of this.elements)ue.popup=ie,Q.push(ue.data.id),ue.addHighlightArea();return this.container.setAttribute("aria-controls",Q.map(ue=>`${n.AnnotationPrefix}${ue}`).join(",")),this.container}}class L{constructor({container:ie,color:Q,elements:ue,titleObj:Ae,modificationDate:Oe,contentsObj:je,richText:Ue,parent:it,rect:st,parentRect:Ye,open:ht}){Se(this,qe);Se(this,he,null);Se(this,Re,de(this,qe,Rf).bind(this));Se(this,Ce,de(this,qe,Rc).bind(this));Se(this,Ie,de(this,qe,Tc).bind(this));Se(this,Ne,de(this,qe,Za).bind(this));Se(this,$e,null);Se(this,ge,null);Se(this,_e,null);Se(this,X,null);Se(this,se,null);Se(this,fe,null);Se(this,ve,!1);Se(this,Me,null);Se(this,Be,null);Se(this,Le,null);Se(this,pe,null);Se(this,Ge,!1);var Ke;we(this,ge,ie),we(this,pe,Ae),we(this,_e,je),we(this,Le,Ue),we(this,se,it),we(this,$e,Q),we(this,Be,st),we(this,fe,Ye),we(this,X,ue);const Qe=r.PDFDateString.toDateObject(Oe);Qe&&we(this,he,it.l10n.get("annotation_date_string",{date:Qe.toLocaleDateString(),time:Qe.toLocaleTimeString()})),this.trigger=ue.flatMap(ut=>ut.getElementsToTriggerPopup());for(const ut of this.trigger)ut.addEventListener("click",R(this,Ne)),ut.addEventListener("mouseenter",R(this,Ie)),ut.addEventListener("mouseleave",R(this,Ce)),ut.classList.add("popupTriggerArea");for(const ut of ue)(Ke=ut.container)==null||Ke.addEventListener("keydown",R(this,Re));R(this,ge).hidden=!0,ht&&de(this,qe,Za).call(this)}render(){if(R(this,Me))return;const{page:{view:ie},viewport:{rawDims:{pageWidth:Q,pageHeight:ue,pageX:Ae,pageY:Oe}}}=R(this,se),je=we(this,Me,document.createElement("div"));if(je.className="popup",R(this,$e)){const nt=je.style.outlineColor=n.Util.makeHexColor(...R(this,$e));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?je.style.backgroundColor=`color-mix(in srgb, ${nt} 30%, white)`:je.style.backgroundColor=n.Util.makeHexColor(...R(this,$e).map(We=>Math.floor(.7*(255-We)+We)))}const Ue=document.createElement("span");Ue.className="header";const it=document.createElement("h1");if(Ue.append(it),{dir:it.dir,str:it.textContent}=R(this,pe),je.append(Ue),R(this,he)){const nt=document.createElement("span");nt.classList.add("popupDate"),R(this,he).then(me=>{nt.textContent=me}),Ue.append(nt)}const st=R(this,_e),Ye=R(this,Le);if(Ye!=null&&Ye.str&&(!(st!=null&&st.str)||st.str===Ye.str))h.XfaLayer.render({xfaHtml:Ye.html,intent:"richText",div:je}),je.lastChild.classList.add("richText","popupContent");else{const nt=this._formatContents(st);je.append(nt)}let ht=!!R(this,fe),Qe=ht?R(this,fe):R(this,Be);for(const nt of R(this,X))if(!Qe||n.Util.intersect(nt.data.rect,Qe)!==null){Qe=nt.data.rect,ht=!0;break}const Ke=n.Util.normalizeRect([Qe[0],ie[3]-Qe[1]+ie[1],Qe[2],ie[3]-Qe[3]+ie[1]]),bt=ht?Qe[2]-Qe[0]+5:0,At=Ke[0]+bt,Ot=Ke[1],{style:Bt}=R(this,ge);Bt.left=`${100*(At-Ae)/Q}%`,Bt.top=`${100*(Ot-Oe)/ue}%`,R(this,ge).append(je)}_formatContents({str:ie,dir:Q}){const ue=document.createElement("p");ue.classList.add("popupContent"),ue.dir=Q;const Ae=ie.split(/(?:\r\n?|\n)/);for(let Oe=0,je=Ae.length;Oe<je;++Oe){const Ue=Ae[Oe];ue.append(document.createTextNode(Ue)),Oe<je-1&&ue.append(document.createElement("br"))}return ue}forceHide(){we(this,Ge,this.isVisible),R(this,Ge)&&(R(this,ge).hidden=!0)}maybeShow(){R(this,Ge)&&(we(this,Ge,!1),R(this,ge).hidden=!1)}get isVisible(){return R(this,ge).hidden===!1}}he=new WeakMap,Re=new WeakMap,Ce=new WeakMap,Ie=new WeakMap,Ne=new WeakMap,$e=new WeakMap,ge=new WeakMap,_e=new WeakMap,X=new WeakMap,se=new WeakMap,fe=new WeakMap,ve=new WeakMap,Me=new WeakMap,Be=new WeakMap,Le=new WeakMap,pe=new WeakMap,Ge=new WeakMap,qe=new WeakSet,Rf=function(ie){ie.altKey||ie.shiftKey||ie.ctrlKey||ie.metaKey||(ie.key==="Enter"||ie.key==="Escape"&&R(this,ve))&&de(this,qe,Za).call(this)},Za=function(){we(this,ve,!R(this,ve)),R(this,ve)?(de(this,qe,Tc).call(this),R(this,ge).addEventListener("click",R(this,Ne)),R(this,ge).addEventListener("keydown",R(this,Re))):(de(this,qe,Rc).call(this),R(this,ge).removeEventListener("click",R(this,Ne)),R(this,ge).removeEventListener("keydown",R(this,Re)))},Tc=function(){R(this,Me)||this.render(),this.isVisible?R(this,ve)&&R(this,ge).classList.add("focused"):(R(this,ge).hidden=!1,R(this,ge).style.zIndex=parseInt(R(this,ge).style.zIndex)+1e3)},Rc=function(){R(this,ge).classList.remove("focused"),!(R(this,ve)||!this.isVisible)&&(R(this,ge).hidden=!0,R(this,ge).style.zIndex=parseInt(R(this,ge).style.zIndex)-1e3)};class H extends _{constructor(ie){super(ie,{isRenderable:!0,ignoreBorder:!0}),this.textContent=ie.data.textContent,this.textPosition=ie.data.textPosition,this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const ie=document.createElement("div");ie.classList.add("annotationTextContent"),ie.setAttribute("role","comment");for(const Q of this.textContent){const ue=document.createElement("span");ue.textContent=Q,ie.append(ue)}this.container.append(ie)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=H;class D extends _{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0});Se(this,ct,null)}render(){this.container.classList.add("lineAnnotation");const Q=this.data,{width:ue,height:Ae}=y(Q.rect),Oe=this.svgFactory.create(ue,Ae,!0),je=we(this,ct,this.svgFactory.createElement("svg:line"));return je.setAttribute("x1",Q.rect[2]-Q.lineCoordinates[0]),je.setAttribute("y1",Q.rect[3]-Q.lineCoordinates[1]),je.setAttribute("x2",Q.rect[2]-Q.lineCoordinates[2]),je.setAttribute("y2",Q.rect[3]-Q.lineCoordinates[3]),je.setAttribute("stroke-width",Q.borderStyle.width||1),je.setAttribute("stroke","transparent"),je.setAttribute("fill","transparent"),Oe.append(je),this.container.append(Oe),!Q.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return R(this,ct)}addHighlightArea(){this.container.classList.add("highlightArea")}}ct=new WeakMap;class q extends _{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0});Se(this,yt,null)}render(){this.container.classList.add("squareAnnotation");const Q=this.data,{width:ue,height:Ae}=y(Q.rect),Oe=this.svgFactory.create(ue,Ae,!0),je=Q.borderStyle.width,Ue=we(this,yt,this.svgFactory.createElement("svg:rect"));return Ue.setAttribute("x",je/2),Ue.setAttribute("y",je/2),Ue.setAttribute("width",ue-je),Ue.setAttribute("height",Ae-je),Ue.setAttribute("stroke-width",je||1),Ue.setAttribute("stroke","transparent"),Ue.setAttribute("fill","transparent"),Oe.append(Ue),this.container.append(Oe),!Q.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return R(this,yt)}addHighlightArea(){this.container.classList.add("highlightArea")}}yt=new WeakMap;class J extends _{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0});Se(this,mt,null)}render(){this.container.classList.add("circleAnnotation");const Q=this.data,{width:ue,height:Ae}=y(Q.rect),Oe=this.svgFactory.create(ue,Ae,!0),je=Q.borderStyle.width,Ue=we(this,mt,this.svgFactory.createElement("svg:ellipse"));return Ue.setAttribute("cx",ue/2),Ue.setAttribute("cy",Ae/2),Ue.setAttribute("rx",ue/2-je/2),Ue.setAttribute("ry",Ae/2-je/2),Ue.setAttribute("stroke-width",je||1),Ue.setAttribute("stroke","transparent"),Ue.setAttribute("fill","transparent"),Oe.append(Ue),this.container.append(Oe),!Q.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return R(this,mt)}addHighlightArea(){this.container.classList.add("highlightArea")}}mt=new WeakMap;class ae extends _{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0});Se(this,Fe,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const Q=this.data,{width:ue,height:Ae}=y(Q.rect),Oe=this.svgFactory.create(ue,Ae,!0);let je=[];for(const it of Q.vertices){const st=it.x-Q.rect[0],Ye=Q.rect[3]-it.y;je.push(st+","+Ye)}je=je.join(" ");const Ue=we(this,Fe,this.svgFactory.createElement(this.svgElementName));return Ue.setAttribute("points",je),Ue.setAttribute("stroke-width",Q.borderStyle.width||1),Ue.setAttribute("stroke","transparent"),Ue.setAttribute("fill","transparent"),Oe.append(Ue),this.container.append(Oe),!Q.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return R(this,Fe)}addHighlightArea(){this.container.classList.add("highlightArea")}}Fe=new WeakMap;class V extends ae{constructor(ie){super(ie),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Z extends _{constructor(ie){super(ie,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class G extends _{constructor(Q){super(Q,{isRenderable:!0,ignoreBorder:!0});Se(this,be,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const Q=this.data,{width:ue,height:Ae}=y(Q.rect),Oe=this.svgFactory.create(ue,Ae,!0);for(const je of Q.inkLists){let Ue=[];for(const st of je){const Ye=st.x-Q.rect[0],ht=Q.rect[3]-st.y;Ue.push(`${Ye},${ht}`)}Ue=Ue.join(" ");const it=this.svgFactory.createElement(this.svgElementName);R(this,be).push(it),it.setAttribute("points",Ue),it.setAttribute("stroke-width",Q.borderStyle.width||1),it.setAttribute("stroke","transparent"),it.setAttribute("fill","transparent"),!Q.popupRef&&this.hasPopupData&&this._createPopup(),Oe.append(it)}return this.container.append(Oe),this.container}getElementsToTriggerPopup(){return R(this,be)}addHighlightArea(){this.container.classList.add("highlightArea")}}be=new WeakMap,e.InkAnnotationElement=G;class ne extends _{constructor(ie){super(ie,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class B extends _{constructor(ie){super(ie,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class F extends _{constructor(ie){super(ie,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Y extends _{constructor(ie){super(ie,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class U extends _{constructor(ie){super(ie,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=U;class C extends _{constructor(Q){var Oe;super(Q,{isRenderable:!0});Se(this,tt);Se(this,ye,null);const{filename:ue,content:Ae}=this.data.file;this.filename=(0,r.getFilenameFromUrl)(ue,!0),this.content=Ae,(Oe=this.linkService.eventBus)==null||Oe.dispatch("fileattachmentannotation",{source:this,filename:ue,content:Ae})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:Q,data:ue}=this;let Ae;ue.hasAppearance||ue.fillAlpha===0?Ae=document.createElement("div"):(Ae=document.createElement("img"),Ae.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(ue.name)?"paperclip":"pushpin"}.svg`,ue.fillAlpha&&ue.fillAlpha<1&&(Ae.style=`filter: opacity(${Math.round(ue.fillAlpha*100)}%);`)),Ae.addEventListener("dblclick",de(this,tt,Cc).bind(this)),we(this,ye,Ae);const{isMac:Oe}=n.FeatureTest.platform;return Q.addEventListener("keydown",je=>{je.key==="Enter"&&(Oe?je.metaKey:je.ctrlKey)&&de(this,tt,Cc).call(this)}),!ue.popupRef&&this.hasPopupData?this._createPopup():Ae.classList.add("popupTriggerArea"),Q.append(Ae),Q}getElementsToTriggerPopup(){return R(this,ye)}addHighlightArea(){this.container.classList.add("highlightArea")}}ye=new WeakMap,tt=new WeakSet,Cc=function(){var Q;(Q=this.downloadManager)==null||Q.openOrDownloadData(this.container,this.content,this.filename)};class P{constructor({div:ie,accessibilityManager:Q,annotationCanvasMap:ue,l10n:Ae,page:Oe,viewport:je}){Se(this,Ve);Se(this,vt,null);Se(this,oe,null);Se(this,ke,new Map);this.div=ie,we(this,vt,Q),we(this,oe,ue),this.l10n=Ae,this.page=Oe,this.viewport=je,this.zIndex=0,this.l10n||(this.l10n=u.NullL10n)}async render(ie){const{annotations:Q}=ie,ue=this.div;(0,r.setLayerDimensions)(ue,this.viewport);const Ae=new Map,Oe={data:null,layer:ue,linkService:ie.linkService,downloadManager:ie.downloadManager,imageResourcesPath:ie.imageResourcesPath||"",renderForms:ie.renderForms!==!1,svgFactory:new r.DOMSVGFactory,annotationStorage:ie.annotationStorage||new o.AnnotationStorage,enableScripting:ie.enableScripting===!0,hasJSActions:ie.hasJSActions,fieldObjects:ie.fieldObjects,parent:this,elements:null};for(const je of Q){if(je.noHTML)continue;const Ue=je.annotationType===n.AnnotationType.POPUP;if(Ue){const Ye=Ae.get(je.id);if(!Ye)continue;Oe.elements=Ye}else{const{width:Ye,height:ht}=y(je.rect);if(Ye<=0||ht<=0)continue}Oe.data=je;const it=v.create(Oe);if(!it.isRenderable)continue;if(!Ue&&je.popupRef){const Ye=Ae.get(je.popupRef);Ye?Ye.push(it):Ae.set(je.popupRef,[it])}it.annotationEditorType>0&&R(this,ke).set(it.data.id,it);const st=it.render();je.hidden&&(st.style.visibility="hidden"),de(this,Ve,Cf).call(this,st,je.id)}de(this,Ve,Oc).call(this),await this.l10n.translate(ue)}update({viewport:ie}){const Q=this.div;this.viewport=ie,(0,r.setLayerDimensions)(Q,{rotation:ie.rotation}),de(this,Ve,Oc).call(this),Q.hidden=!1}getEditableAnnotations(){return Array.from(R(this,ke).values())}getEditableAnnotation(ie){return R(this,ke).get(ie)}}vt=new WeakMap,oe=new WeakMap,ke=new WeakMap,Ve=new WeakSet,Cf=function(ie,Q){var Ae;const ue=ie.firstChild||ie;ue.id=`${n.AnnotationPrefix}${Q}`,this.div.append(ie),(Ae=R(this,vt))==null||Ae.moveElementInDOM(this.div,ie,ue,!1)},Oc=function(){if(!R(this,oe))return;const ie=this.div;for(const[Q,ue]of R(this,oe)){const Ae=ie.querySelector(`[data-annotation-id="${Q}"]`);if(!Ae)continue;const{firstChild:Oe}=Ae;Oe?Oe.nodeName==="CANVAS"?Oe.replaceWith(ue):Oe.before(ue):Ae.append(ue)}R(this,oe).clear()},e.AnnotationLayer=P},(s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function t(o){return Math.floor(Math.max(0,Math.min(1,o))*255).toString(16).padStart(2,"0")}function n(o){return Math.max(0,Math.min(255,255*o))}class r{static CMYK_G([c,u,h,f]){return["G",1-Math.min(1,.3*c+.59*h+.11*u+f)]}static G_CMYK([c]){return["CMYK",0,0,0,1-c]}static G_RGB([c]){return["RGB",c,c,c]}static G_rgb([c]){return c=n(c),[c,c,c]}static G_HTML([c]){const u=t(c);return`#${u}${u}${u}`}static RGB_G([c,u,h]){return["G",.3*c+.59*u+.11*h]}static RGB_rgb(c){return c.map(n)}static RGB_HTML(c){return`#${c.map(t).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([c,u,h,f]){return["RGB",1-Math.min(1,c+f),1-Math.min(1,h+f),1-Math.min(1,u+f)]}static CMYK_rgb([c,u,h,f]){return[n(1-Math.min(1,c+f)),n(1-Math.min(1,h+f)),n(1-Math.min(1,u+f))]}static CMYK_HTML(c){const u=this.CMYK_RGB(c).slice(1);return this.RGB_HTML(u)}static RGB_CMYK([c,u,h]){const f=1-c,p=1-u,g=1-h,y=Math.min(f,p,g);return["CMYK",f,p,g,y]}}e.ColorConverters=r},(s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=n;const t={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};t.print_progress_percent="{{progress}}%";function n(c,u){switch(c){case"find_match_count":c=`find_match_count[${u.total===1?"one":"other"}]`;break;case"find_match_count_limit":c=`find_match_count_limit[${u.limit===1?"one":"other"}]`;break}return t[c]||""}function r(c,u){return u?c.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(h,f)=>f in u?u[f]:"{{"+f+"}}"):c}const o={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(c,u=null,h=n(c,u)){return r(h,u)},async translate(c){}};e.NullL10n=o},(s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var n=t(25);class r{static setupStorage(c,u,h,f,p){const g=f.getValue(u,{value:null});switch(h.name){case"textarea":if(g.value!==null&&(c.textContent=g.value),p==="print")break;c.addEventListener("input",y=>{f.setValue(u,{value:y.target.value})});break;case"input":if(h.attributes.type==="radio"||h.attributes.type==="checkbox"){if(g.value===h.attributes.xfaOn?c.setAttribute("checked",!0):g.value===h.attributes.xfaOff&&c.removeAttribute("checked"),p==="print")break;c.addEventListener("change",y=>{f.setValue(u,{value:y.target.checked?y.target.getAttribute("xfaOn"):y.target.getAttribute("xfaOff")})})}else{if(g.value!==null&&c.setAttribute("value",g.value),p==="print")break;c.addEventListener("input",y=>{f.setValue(u,{value:y.target.value})})}break;case"select":if(g.value!==null){c.setAttribute("value",g.value);for(const y of h.children)y.attributes.value===g.value?y.attributes.selected=!0:y.attributes.hasOwnProperty("selected")&&delete y.attributes.selected}c.addEventListener("input",y=>{const v=y.target.options,_=v.selectedIndex===-1?"":v[v.selectedIndex].value;f.setValue(u,{value:_})});break}}static setAttributes({html:c,element:u,storage:h=null,intent:f,linkService:p}){const{attributes:g}=u,y=c instanceof HTMLAnchorElement;g.type==="radio"&&(g.name=`${g.name}-${f}`);for(const[v,_]of Object.entries(g))if(_!=null)switch(v){case"class":_.length&&c.setAttribute(v,_.join(" "));break;case"dataId":break;case"id":c.setAttribute("data-element-id",_);break;case"style":Object.assign(c.style,_);break;case"textContent":c.textContent=_;break;default:(!y||v!=="href"&&v!=="newWindow")&&c.setAttribute(v,_)}y&&p.addLinkAttributes(c,g.href,g.newWindow),h&&g.dataId&&this.setupStorage(c,g.dataId,u,h)}static render(c){var E;const u=c.annotationStorage,h=c.linkService,f=c.xfaHtml,p=c.intent||"display",g=document.createElement(f.name);f.attributes&&this.setAttributes({html:g,element:f,intent:p,linkService:h});const y=[[f,-1,g]],v=c.div;if(v.append(g),c.viewport){const x=`matrix(${c.viewport.transform.join(",")})`;v.style.transform=x}p!=="richText"&&v.setAttribute("class","xfaLayer xfaFont");const _=[];for(;y.length>0;){const[x,w,T]=y.at(-1);if(w+1===x.children.length){y.pop();continue}const O=x.children[++y.at(-1)[1]];if(O===null)continue;const{name:N}=O;if(N==="#text"){const I=document.createTextNode(O.value);_.push(I),T.append(I);continue}const A=(E=O==null?void 0:O.attributes)!=null&&E.xmlns?document.createElementNS(O.attributes.xmlns,N):document.createElement(N);if(T.append(A),O.attributes&&this.setAttributes({html:A,element:O,storage:u,intent:p,linkService:h}),O.children&&O.children.length>0)y.push([O,-1,A]);else if(O.value){const I=document.createTextNode(O.value);n.XfaText.shouldBuildText(N)&&_.push(I),A.append(I)}}for(const x of v.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))x.setAttribute("readOnly",!0);return{textDivs:_}}static update(c){const u=`matrix(${c.viewport.transform.join(",")})`;c.div.style.transform=u,c.div.hidden=!1}}e.XfaLayer=r},(s,e,t)=>{var f,p,g,y,v,_,E,x,w,T,O,N,A,I,k,Of,Pf,kf,Mf,Pc,If,kc,Df,Lf,Nf,Ff,jf,ai,Mc,Ga,Wa,Os,Ic,Xa,te,$f,Dc,Uf,Bf,Lc,Ya,Ps;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var n=t(1),r=t(4),o=t(29),c=t(6),u=t(5);const $e=class $e extends r.AnnotationEditor{constructor(X){super({...X,name:"inkEditor"});Se(this,k);Se(this,f,0);Se(this,p,0);Se(this,g,this.canvasPointermove.bind(this));Se(this,y,this.canvasPointerleave.bind(this));Se(this,v,this.canvasPointerup.bind(this));Se(this,_,this.canvasPointerdown.bind(this));Se(this,E,new Path2D);Se(this,x,!1);Se(this,w,!1);Se(this,T,!1);Se(this,O,null);Se(this,N,0);Se(this,A,0);Se(this,I,null);this.color=X.color||null,this.thickness=X.thickness||null,this.opacity=X.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(X){r.AnnotationEditor.initialize(X,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(X,se){switch(X){case n.AnnotationEditorParamsType.INK_THICKNESS:$e._defaultThickness=se;break;case n.AnnotationEditorParamsType.INK_COLOR:$e._defaultColor=se;break;case n.AnnotationEditorParamsType.INK_OPACITY:$e._defaultOpacity=se/100;break}}updateParams(X,se){switch(X){case n.AnnotationEditorParamsType.INK_THICKNESS:de(this,k,Of).call(this,se);break;case n.AnnotationEditorParamsType.INK_COLOR:de(this,k,Pf).call(this,se);break;case n.AnnotationEditorParamsType.INK_OPACITY:de(this,k,kf).call(this,se);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,$e._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,$e._defaultColor||r.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round($e._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||$e._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||$e._defaultColor||r.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??$e._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(de(this,k,Ga).call(this),de(this,k,Wa).call(this)),this.isAttachedToDOM||(this.parent.add(this),de(this,k,Os).call(this)),de(this,k,Ps).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,R(this,O).disconnect(),we(this,O,null),super.remove())}setParent(X){!this.parent&&X?this._uiManager.removeShouldRescale(this):this.parent&&X===null&&this._uiManager.addShouldRescale(this),super.setParent(X)}onScaleChanging(){const[X,se]=this.parentDimensions,fe=this.width*X,ve=this.height*se;this.setDimensions(fe,ve)}enableEditMode(){R(this,x)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",R(this,_)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",R(this,_)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){R(this,x)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),we(this,x,!0),this.div.classList.add("disabled"),de(this,k,Ps).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(X){this._focusEventsAllowed&&(super.focusin(X),this.enableEditMode())}canvasPointerdown(X){X.button!==0||!this.isInEditMode()||R(this,x)||(this.setInForeground(),X.preventDefault(),X.type!=="mouse"&&this.div.focus(),de(this,k,If).call(this,X.offsetX,X.offsetY))}canvasPointermove(X){X.preventDefault(),de(this,k,kc).call(this,X.offsetX,X.offsetY)}canvasPointerup(X){X.preventDefault(),de(this,k,Mc).call(this,X)}canvasPointerleave(X){de(this,k,Mc).call(this,X)}get isResizable(){return!this.isEmpty()&&R(this,x)}render(){if(this.div)return this.div;let X,se;this.width&&(X=this.x,se=this.y),super.render(),r.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Le=>{var pe;return(pe=this.div)==null?void 0:pe.setAttribute("aria-label",Le)});const[fe,ve,Me,Be]=de(this,k,Mf).call(this);if(this.setAt(fe,ve,0,0),this.setDims(Me,Be),de(this,k,Ga).call(this),this.width){const[Le,pe]=this.parentDimensions;this.setAspectRatio(this.width*Le,this.height*pe),this.setAt(X*Le,se*pe,this.width*Le,this.height*pe),we(this,T,!0),de(this,k,Os).call(this),this.setDims(this.width*Le,this.height*pe),de(this,k,ai).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return de(this,k,Wa).call(this),this.div}setDimensions(X,se){const fe=Math.round(X),ve=Math.round(se);if(R(this,N)===fe&&R(this,A)===ve)return;we(this,N,fe),we(this,A,ve),this.canvas.style.visibility="hidden";const[Me,Be]=this.parentDimensions;this.width=X/Me,this.height=se/Be,this.fixAndSetPosition(),R(this,x)&&de(this,k,Ic).call(this,X,se),de(this,k,Os).call(this),de(this,k,ai).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(X,se,fe){var ct,yt,mt;if(X instanceof o.InkAnnotationElement)return null;const ve=super.deserialize(X,se,fe);ve.thickness=X.thickness,ve.color=n.Util.makeHexColor(...X.color),ve.opacity=X.opacity;const[Me,Be]=ve.pageDimensions,Le=ve.width*Me,pe=ve.height*Be,Ge=ve.parentScale,qe=X.thickness/2;we(ve,x,!0),we(ve,N,Math.round(Le)),we(ve,A,Math.round(pe));const{paths:pt,rect:dt,rotation:Et}=X;for(let{bezier:Fe}of pt){Fe=de(ct=$e,te,Uf).call(ct,Fe,dt,Et);const be=[];ve.paths.push(be);let ye=Ge*(Fe[0]-qe),tt=Ge*(Fe[1]-qe);for(let vt=2,oe=Fe.length;vt<oe;vt+=6){const ke=Ge*(Fe[vt]-qe),Ve=Ge*(Fe[vt+1]-qe),at=Ge*(Fe[vt+2]-qe),Je=Ge*(Fe[vt+3]-qe),et=Ge*(Fe[vt+4]-qe),ie=Ge*(Fe[vt+5]-qe);be.push([[ye,tt],[ke,Ve],[at,Je],[et,ie]]),ye=et,tt=ie}const xt=de(this,te,$f).call(this,be);ve.bezierPath2D.push(xt)}const rt=de(yt=ve,k,Lc).call(yt);return we(ve,p,Math.max(r.AnnotationEditor.MIN_SIZE,rt[2]-rt[0])),we(ve,f,Math.max(r.AnnotationEditor.MIN_SIZE,rt[3]-rt[1])),de(mt=ve,k,Ic).call(mt,Le,pe),ve}serialize(){if(this.isEmpty())return null;const X=this.getRect(0,0),se=r.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:se,thickness:this.thickness,opacity:this.opacity,paths:de(this,k,Bf).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,X),pageIndex:this.pageIndex,rect:X,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};f=new WeakMap,p=new WeakMap,g=new WeakMap,y=new WeakMap,v=new WeakMap,_=new WeakMap,E=new WeakMap,x=new WeakMap,w=new WeakMap,T=new WeakMap,O=new WeakMap,N=new WeakMap,A=new WeakMap,I=new WeakMap,k=new WeakSet,Of=function(X){const se=this.thickness;this.addCommands({cmd:()=>{this.thickness=X,de(this,k,Ps).call(this)},undo:()=>{this.thickness=se,de(this,k,Ps).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Pf=function(X){const se=this.color;this.addCommands({cmd:()=>{this.color=X,de(this,k,ai).call(this)},undo:()=>{this.color=se,de(this,k,ai).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},kf=function(X){X/=100;const se=this.opacity;this.addCommands({cmd:()=>{this.opacity=X,de(this,k,ai).call(this)},undo:()=>{this.opacity=se,de(this,k,ai).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Mf=function(){const{parentRotation:X,parentDimensions:[se,fe]}=this;switch(X){case 90:return[0,fe,fe,se];case 180:return[se,fe,se,fe];case 270:return[se,0,fe,se];default:return[0,0,se,fe]}},Pc=function(){const{ctx:X,color:se,opacity:fe,thickness:ve,parentScale:Me,scaleFactor:Be}=this;X.lineWidth=ve*Me/Be,X.lineCap="round",X.lineJoin="round",X.miterLimit=10,X.strokeStyle=`${se}${(0,u.opacityToHex)(fe)}`},If=function(X,se){this.canvas.addEventListener("contextmenu",c.noContextMenu),this.canvas.addEventListener("pointerleave",R(this,y)),this.canvas.addEventListener("pointermove",R(this,g)),this.canvas.addEventListener("pointerup",R(this,v)),this.canvas.removeEventListener("pointerdown",R(this,_)),this.isEditing=!0,R(this,T)||(we(this,T,!0),de(this,k,Os).call(this),this.thickness||(this.thickness=$e._defaultThickness),this.color||(this.color=$e._defaultColor||r.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=$e._defaultOpacity)),this.currentPath.push([X,se]),we(this,w,!1),de(this,k,Pc).call(this),we(this,I,()=>{de(this,k,Nf).call(this),R(this,I)&&window.requestAnimationFrame(R(this,I))}),window.requestAnimationFrame(R(this,I))},kc=function(X,se){const[fe,ve]=this.currentPath.at(-1);if(this.currentPath.length>1&&X===fe&&se===ve)return;const Me=this.currentPath;let Be=R(this,E);if(Me.push([X,se]),we(this,w,!0),Me.length<=2){Be.moveTo(...Me[0]),Be.lineTo(X,se);return}Me.length===3&&(we(this,E,Be=new Path2D),Be.moveTo(...Me[0])),de(this,k,Ff).call(this,Be,...Me.at(-3),...Me.at(-2),X,se)},Df=function(){if(this.currentPath.length===0)return;const X=this.currentPath.at(-1);R(this,E).lineTo(...X)},Lf=function(X,se){we(this,I,null),X=Math.min(Math.max(X,0),this.canvas.width),se=Math.min(Math.max(se,0),this.canvas.height),de(this,k,kc).call(this,X,se),de(this,k,Df).call(this);let fe;if(this.currentPath.length!==1)fe=de(this,k,jf).call(this);else{const pe=[X,se];fe=[[pe,pe.slice(),pe.slice(),pe]]}const ve=R(this,E),Me=this.currentPath;this.currentPath=[],we(this,E,new Path2D);const Be=()=>{this.allRawPaths.push(Me),this.paths.push(fe),this.bezierPath2D.push(ve),this.rebuild()},Le=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(de(this,k,Ga).call(this),de(this,k,Wa).call(this)),de(this,k,Ps).call(this))};this.addCommands({cmd:Be,undo:Le,mustExec:!0})},Nf=function(){if(!R(this,w))return;we(this,w,!1);const X=Math.ceil(this.thickness*this.parentScale),se=this.currentPath.slice(-3),fe=se.map(Be=>Be[0]),ve=se.map(Be=>Be[1]);Math.min(...fe)-X,Math.max(...fe)+X,Math.min(...ve)-X,Math.max(...ve)+X;const{ctx:Me}=this;Me.save(),Me.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Be of this.bezierPath2D)Me.stroke(Be);Me.stroke(R(this,E)),Me.restore()},Ff=function(X,se,fe,ve,Me,Be,Le){const pe=(se+ve)/2,Ge=(fe+Me)/2,qe=(ve+Be)/2,pt=(Me+Le)/2;X.bezierCurveTo(pe+2*(ve-pe)/3,Ge+2*(Me-Ge)/3,qe+2*(ve-qe)/3,pt+2*(Me-pt)/3,qe,pt)},jf=function(){const X=this.currentPath;if(X.length<=2)return[[X[0],X[0],X.at(-1),X.at(-1)]];const se=[];let fe,[ve,Me]=X[0];for(fe=1;fe<X.length-2;fe++){const[dt,Et]=X[fe],[rt,ct]=X[fe+1],yt=(dt+rt)/2,mt=(Et+ct)/2,Fe=[ve+2*(dt-ve)/3,Me+2*(Et-Me)/3],be=[yt+2*(dt-yt)/3,mt+2*(Et-mt)/3];se.push([[ve,Me],Fe,be,[yt,mt]]),[ve,Me]=[yt,mt]}const[Be,Le]=X[fe],[pe,Ge]=X[fe+1],qe=[ve+2*(Be-ve)/3,Me+2*(Le-Me)/3],pt=[pe+2*(Be-pe)/3,Ge+2*(Le-Ge)/3];return se.push([[ve,Me],qe,pt,[pe,Ge]]),se},ai=function(){if(this.isEmpty()){de(this,k,Xa).call(this);return}de(this,k,Pc).call(this);const{canvas:X,ctx:se}=this;se.setTransform(1,0,0,1,0,0),se.clearRect(0,0,X.width,X.height),de(this,k,Xa).call(this);for(const fe of this.bezierPath2D)se.stroke(fe)},Mc=function(X){this.canvas.removeEventListener("pointerleave",R(this,y)),this.canvas.removeEventListener("pointermove",R(this,g)),this.canvas.removeEventListener("pointerup",R(this,v)),this.canvas.addEventListener("pointerdown",R(this,_)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",c.noContextMenu)},10),de(this,k,Lf).call(this,X.offsetX,X.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Ga=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",r.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(X=>{var se;return(se=this.canvas)==null?void 0:se.setAttribute("aria-label",X)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Wa=function(){we(this,O,new ResizeObserver(X=>{const se=X[0].contentRect;se.width&&se.height&&this.setDimensions(se.width,se.height)})),R(this,O).observe(this.div)},Os=function(){if(!R(this,T))return;const[X,se]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*X),this.canvas.height=Math.ceil(this.height*se),de(this,k,Xa).call(this)},Ic=function(X,se){const fe=de(this,k,Ya).call(this),ve=(X-fe)/R(this,p),Me=(se-fe)/R(this,f);this.scaleFactor=Math.min(ve,Me)},Xa=function(){const X=de(this,k,Ya).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+X,this.translationY*this.scaleFactor+X)},te=new WeakSet,$f=function(X){const se=new Path2D;for(let fe=0,ve=X.length;fe<ve;fe++){const[Me,Be,Le,pe]=X[fe];fe===0&&se.moveTo(...Me),se.bezierCurveTo(Be[0],Be[1],Le[0],Le[1],pe[0],pe[1])}return se},Dc=function(X,se,fe){const[ve,Me,Be,Le]=se;switch(fe){case 0:for(let pe=0,Ge=X.length;pe<Ge;pe+=2)X[pe]+=ve,X[pe+1]=Le-X[pe+1];break;case 90:for(let pe=0,Ge=X.length;pe<Ge;pe+=2){const qe=X[pe];X[pe]=X[pe+1]+ve,X[pe+1]=qe+Me}break;case 180:for(let pe=0,Ge=X.length;pe<Ge;pe+=2)X[pe]=Be-X[pe],X[pe+1]+=Me;break;case 270:for(let pe=0,Ge=X.length;pe<Ge;pe+=2){const qe=X[pe];X[pe]=Be-X[pe+1],X[pe+1]=Le-qe}break;default:throw new Error("Invalid rotation")}return X},Uf=function(X,se,fe){const[ve,Me,Be,Le]=se;switch(fe){case 0:for(let pe=0,Ge=X.length;pe<Ge;pe+=2)X[pe]-=ve,X[pe+1]=Le-X[pe+1];break;case 90:for(let pe=0,Ge=X.length;pe<Ge;pe+=2){const qe=X[pe];X[pe]=X[pe+1]-Me,X[pe+1]=qe-ve}break;case 180:for(let pe=0,Ge=X.length;pe<Ge;pe+=2)X[pe]=Be-X[pe],X[pe+1]-=Me;break;case 270:for(let pe=0,Ge=X.length;pe<Ge;pe+=2){const qe=X[pe];X[pe]=Le-X[pe+1],X[pe+1]=Be-qe}break;default:throw new Error("Invalid rotation")}return X},Bf=function(X,se,fe,ve){var Ge,qe;const Me=[],Be=this.thickness/2,Le=X*se+Be,pe=X*fe+Be;for(const pt of this.paths){const dt=[],Et=[];for(let rt=0,ct=pt.length;rt<ct;rt++){const[yt,mt,Fe,be]=pt[rt],ye=X*yt[0]+Le,tt=X*yt[1]+pe,xt=X*mt[0]+Le,vt=X*mt[1]+pe,oe=X*Fe[0]+Le,ke=X*Fe[1]+pe,Ve=X*be[0]+Le,at=X*be[1]+pe;rt===0&&(dt.push(ye,tt),Et.push(ye,tt)),dt.push(xt,vt,oe,ke,Ve,at),Et.push(xt,vt),rt===ct-1&&Et.push(Ve,at)}Me.push({bezier:de(Ge=$e,te,Dc).call(Ge,dt,ve,this.rotation),points:de(qe=$e,te,Dc).call(qe,Et,ve,this.rotation)})}return Me},Lc=function(){let X=1/0,se=-1/0,fe=1/0,ve=-1/0;for(const Me of this.paths)for(const[Be,Le,pe,Ge]of Me){const qe=n.Util.bezierBoundingBox(...Be,...Le,...pe,...Ge);X=Math.min(X,qe[0]),fe=Math.min(fe,qe[1]),se=Math.max(se,qe[2]),ve=Math.max(ve,qe[3])}return[X,fe,se,ve]},Ya=function(){return R(this,x)?Math.ceil(this.thickness*this.parentScale):0},Ps=function(X=!1){if(this.isEmpty())return;if(!R(this,x)){de(this,k,ai).call(this);return}const se=de(this,k,Lc).call(this),fe=de(this,k,Ya).call(this);we(this,p,Math.max(r.AnnotationEditor.MIN_SIZE,se[2]-se[0])),we(this,f,Math.max(r.AnnotationEditor.MIN_SIZE,se[3]-se[1]));const ve=Math.ceil(fe+R(this,p)*this.scaleFactor),Me=Math.ceil(fe+R(this,f)*this.scaleFactor),[Be,Le]=this.parentDimensions;this.width=ve/Be,this.height=Me/Le,this.setAspectRatio(ve,Me);const pe=this.translationX,Ge=this.translationY;this.translationX=-se[0],this.translationY=-se[1],de(this,k,Os).call(this),de(this,k,ai).call(this),we(this,N,ve),we(this,A,Me),this.setDims(ve,Me);const qe=X?fe/this.scaleFactor/2:0;this.translate(pe-this.translationX-qe,Ge-this.translationY-qe)},Se($e,te),ot($e,"_defaultColor",null),ot($e,"_defaultOpacity",1),ot($e,"_defaultThickness",1),ot($e,"_type","ink");let h=$e;e.InkEditor=h},(s,e,t)=>{var h,f,p,g,y,v,_,E,x,w,T,Cr,Or,Ka,Nc,Hf,zf,Fc,Ja,qf;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var n=t(1),r=t(4),o=t(6),c=t(29);const q=class q extends r.AnnotationEditor{constructor(V){super({...V,name:"stampEditor"});Se(this,T);Se(this,h,null);Se(this,f,null);Se(this,p,null);Se(this,g,null);Se(this,y,null);Se(this,v,null);Se(this,_,null);Se(this,E,null);Se(this,x,!1);Se(this,w,!1);we(this,g,V.bitmapUrl),we(this,y,V.bitmapFile)}static initialize(V){r.AnnotationEditor.initialize(V)}static get supportedTypes(){const V=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,n.shadow)(this,"supportedTypes",V.map(Z=>`image/${Z}`))}static get supportedTypesStr(){return(0,n.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(V){return this.supportedTypes.includes(V)}static paste(V,Z){Z.pasteEditor(n.AnnotationEditorType.STAMP,{bitmapFile:V.getAsFile()})}remove(){var V,Z;R(this,f)&&(we(this,h,null),this._uiManager.imageManager.deleteId(R(this,f)),(V=R(this,v))==null||V.remove(),we(this,v,null),(Z=R(this,_))==null||Z.disconnect(),we(this,_,null)),super.remove()}rebuild(){if(!this.parent){R(this,f)&&de(this,T,Ka).call(this);return}super.rebuild(),this.div!==null&&(R(this,f)&&de(this,T,Ka).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(R(this,p)||R(this,h)||R(this,g)||R(this,y))}get isResizable(){return!0}render(){if(this.div)return this.div;let V,Z;if(this.width&&(V=this.x,Z=this.y),super.render(),this.div.hidden=!0,R(this,h)?de(this,T,Nc).call(this):de(this,T,Ka).call(this),this.width){const[G,ne]=this.parentDimensions;this.setAt(V*G,Z*ne,this.width*G,this.height*ne)}return this.div}static deserialize(V,Z,G){if(V instanceof c.StampAnnotationElement)return null;const ne=super.deserialize(V,Z,G),{rect:B,bitmapUrl:F,bitmapId:Y,isSvg:U,accessibilityData:C}=V;Y&&G.imageManager.isValidId(Y)?we(ne,f,Y):we(ne,g,F),we(ne,x,U);const[P,$]=ne.pageDimensions;return ne.width=(B[2]-B[0])/P,ne.height=(B[3]-B[1])/$,C&&(ne.altTextData=C),ne}serialize(V=!1,Z=null){if(this.isEmpty())return null;const G={annotationType:n.AnnotationEditorType.STAMP,bitmapId:R(this,f),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:R(this,x),structTreeParentId:this._structTreeParentId};if(V)return G.bitmapUrl=de(this,T,Ja).call(this,!0),G.accessibilityData=this.altTextData,G;const{decorative:ne,altText:B}=this.altTextData;if(!ne&&B&&(G.accessibilityData={type:"Figure",alt:B}),Z===null)return G;Z.stamps||(Z.stamps=new Map);const F=R(this,x)?(G.rect[2]-G.rect[0])*(G.rect[3]-G.rect[1]):null;if(!Z.stamps.has(R(this,f)))Z.stamps.set(R(this,f),{area:F,serialized:G}),G.bitmap=de(this,T,Ja).call(this,!1);else if(R(this,x)){const Y=Z.stamps.get(R(this,f));F>Y.area&&(Y.area=F,Y.serialized.bitmap.close(),Y.serialized.bitmap=de(this,T,Ja).call(this,!1))}return G}};h=new WeakMap,f=new WeakMap,p=new WeakMap,g=new WeakMap,y=new WeakMap,v=new WeakMap,_=new WeakMap,E=new WeakMap,x=new WeakMap,w=new WeakMap,T=new WeakSet,Cr=function(V,Z=!1){if(!V){this.remove();return}we(this,h,V.bitmap),Z||(we(this,f,V.id),we(this,x,V.isSvg)),de(this,T,Nc).call(this)},Or=function(){we(this,p,null),this._uiManager.enableWaiting(!1),R(this,v)&&this.div.focus()},Ka=function(){if(R(this,f)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(R(this,f)).then(Z=>de(this,T,Cr).call(this,Z,!0)).finally(()=>de(this,T,Or).call(this));return}if(R(this,g)){const Z=R(this,g);we(this,g,null),this._uiManager.enableWaiting(!0),we(this,p,this._uiManager.imageManager.getFromUrl(Z).then(G=>de(this,T,Cr).call(this,G)).finally(()=>de(this,T,Or).call(this)));return}if(R(this,y)){const Z=R(this,y);we(this,y,null),this._uiManager.enableWaiting(!0),we(this,p,this._uiManager.imageManager.getFromFile(Z).then(G=>de(this,T,Cr).call(this,G)).finally(()=>de(this,T,Or).call(this)));return}const V=document.createElement("input");V.type="file",V.accept=q.supportedTypesStr,we(this,p,new Promise(Z=>{V.addEventListener("change",async()=>{if(!V.files||V.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const G=await this._uiManager.imageManager.getFromFile(V.files[0]);de(this,T,Cr).call(this,G)}Z()}),V.addEventListener("cancel",()=>{this.remove(),Z()})}).finally(()=>de(this,T,Or).call(this))),V.click()},Nc=function(){const{div:V}=this;let{width:Z,height:G}=R(this,h);const[ne,B]=this.pageDimensions,F=.75;if(this.width)Z=this.width*ne,G=this.height*B;else if(Z>F*ne||G>F*B){const P=Math.min(F*ne/Z,F*B/G);Z*=P,G*=P}const[Y,U]=this.parentDimensions;this.setDims(Z*Y/ne,G*U/B),this._uiManager.enableWaiting(!1);const C=we(this,v,document.createElement("canvas"));V.append(C),V.hidden=!1,de(this,T,Fc).call(this,Z,G),de(this,T,qf).call(this),R(this,w)||(this.parent.addUndoableEditor(this),we(this,w,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},Hf=function(V,Z){var F;const[G,ne]=this.parentDimensions;this.width=V/G,this.height=Z/ne,this.setDims(V,Z),(F=this._initialOptions)!=null&&F.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,R(this,E)!==null&&clearTimeout(R(this,E)),we(this,E,setTimeout(()=>{we(this,E,null),de(this,T,Fc).call(this,V,Z)},200))},zf=function(V,Z){const{width:G,height:ne}=R(this,h);let B=G,F=ne,Y=R(this,h);for(;B>2*V||F>2*Z;){const U=B,C=F;B>2*V&&(B=B>=16384?Math.floor(B/2)-1:Math.ceil(B/2)),F>2*Z&&(F=F>=16384?Math.floor(F/2)-1:Math.ceil(F/2));const P=new OffscreenCanvas(B,F);P.getContext("2d").drawImage(Y,0,0,U,C,0,0,B,F),Y=P.transferToImageBitmap()}return Y},Fc=function(V,Z){V=Math.ceil(V),Z=Math.ceil(Z);const G=R(this,v);if(!G||G.width===V&&G.height===Z)return;G.width=V,G.height=Z;const ne=R(this,x)?R(this,h):de(this,T,zf).call(this,V,Z),B=G.getContext("2d");B.filter=this._uiManager.hcmFilter,B.drawImage(ne,0,0,ne.width,ne.height,0,0,V,Z)},Ja=function(V){if(V){if(R(this,x)){const ne=this._uiManager.imageManager.getSvgUrl(R(this,f));if(ne)return ne}const Z=document.createElement("canvas");return{width:Z.width,height:Z.height}=R(this,h),Z.getContext("2d").drawImage(R(this,h),0,0),Z.toDataURL()}if(R(this,x)){const[Z,G]=this.pageDimensions,ne=Math.round(this.width*Z*o.PixelsPerInch.PDF_TO_CSS_UNITS),B=Math.round(this.height*G*o.PixelsPerInch.PDF_TO_CSS_UNITS),F=new OffscreenCanvas(ne,B);return F.getContext("2d").drawImage(R(this,h),0,0,R(this,h).width,R(this,h).height,0,0,ne,B),F.transferToImageBitmap()}return structuredClone(R(this,h))},qf=function(){we(this,_,new ResizeObserver(V=>{const Z=V[0].contentRect;Z.width&&Z.height&&de(this,T,Hf).call(this,Z.width,Z.height)})),R(this,_).observe(this.div)},ot(q,"_type","stamp");let u=q;e.StampEditor=u}],__webpack_module_cache__={};function __w_pdfjs_require__(s){var e=__webpack_module_cache__[s];if(e!==void 0)return e.exports;var t=__webpack_module_cache__[s]={exports:{}};return __webpack_modules__[s](t,t.exports,__w_pdfjs_require__),t.exports}var __webpack_exports__={};return(()=>{var s=__webpack_exports__;Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(s,"AnnotationEditorLayer",{enumerable:!0,get:function(){return o.AnnotationEditorLayer}}),Object.defineProperty(s,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(s,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(s,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return c.AnnotationEditorUIManager}}),Object.defineProperty(s,"AnnotationLayer",{enumerable:!0,get:function(){return u.AnnotationLayer}}),Object.defineProperty(s,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(s,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(s,"DOMSVGFactory",{enumerable:!0,get:function(){return n.DOMSVGFactory}}),Object.defineProperty(s,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(s,"GlobalWorkerOptions",{enumerable:!0,get:function(){return h.GlobalWorkerOptions}}),Object.defineProperty(s,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(s,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(s,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(s,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(s,"PDFDataRangeTransport",{enumerable:!0,get:function(){return t.PDFDataRangeTransport}}),Object.defineProperty(s,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(s,"PDFWorker",{enumerable:!0,get:function(){return t.PDFWorker}}),Object.defineProperty(s,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(s,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(s,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(s,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(s,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(s,"SVGGraphics",{enumerable:!0,get:function(){return t.SVGGraphics}}),Object.defineProperty(s,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(s,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(s,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(s,"XfaLayer",{enumerable:!0,get:function(){return f.XfaLayer}}),Object.defineProperty(s,"build",{enumerable:!0,get:function(){return t.build}}),Object.defineProperty(s,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(s,"getDocument",{enumerable:!0,get:function(){return t.getDocument}}),Object.defineProperty(s,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(s,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(s,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(s,"isDataScheme",{enumerable:!0,get:function(){return n.isDataScheme}}),Object.defineProperty(s,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(s,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(s,"noContextMenu",{enumerable:!0,get:function(){return n.noContextMenu}}),Object.defineProperty(s,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(s,"renderTextLayer",{enumerable:!0,get:function(){return r.renderTextLayer}}),Object.defineProperty(s,"setLayerDimensions",{enumerable:!0,get:function(){return n.setLayerDimensions}}),Object.defineProperty(s,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(s,"updateTextLayer",{enumerable:!0,get:function(){return r.updateTextLayer}}),Object.defineProperty(s,"version",{enumerable:!0,get:function(){return t.version}});var e=__w_pdfjs_require__(1),t=__w_pdfjs_require__(2),n=__w_pdfjs_require__(6),r=__w_pdfjs_require__(26),o=__w_pdfjs_require__(27),c=__w_pdfjs_require__(5),u=__w_pdfjs_require__(29),h=__w_pdfjs_require__(14),f=__w_pdfjs_require__(32)})(),__webpack_exports__})())}(pdf)),pdf.exports}var pdfExports=requirePdf();/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function round(s){return s+.5|0}const lim=(s,e,t)=>Math.max(Math.min(s,t),e);function p2b(s){return lim(round(s*2.55),0,255)}function n2b(s){return lim(round(s*255),0,255)}function b2n(s){return lim(round(s/2.55)/100,0,1)}function n2p(s){return lim(round(s*100),0,100)}const map$1={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},hex=[..."0123456789ABCDEF"],h1=s=>hex[s&15],h2=s=>hex[(s&240)>>4]+hex[s&15],eq=s=>(s&240)>>4===(s&15),isShort=s=>eq(s.r)&&eq(s.g)&&eq(s.b)&&eq(s.a);function hexParse(s){var e=s.length,t;return s[0]==="#"&&(e===4||e===5?t={r:255&map$1[s[1]]*17,g:255&map$1[s[2]]*17,b:255&map$1[s[3]]*17,a:e===5?map$1[s[4]]*17:255}:(e===7||e===9)&&(t={r:map$1[s[1]]<<4|map$1[s[2]],g:map$1[s[3]]<<4|map$1[s[4]],b:map$1[s[5]]<<4|map$1[s[6]],a:e===9?map$1[s[7]]<<4|map$1[s[8]]:255})),t}const alpha=(s,e)=>s<255?e(s):"";function hexString(s){var e=isShort(s)?h1:h2;return s?"#"+e(s.r)+e(s.g)+e(s.b)+alpha(s.a,e):void 0}const HUE_RE=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function hsl2rgbn(s,e,t){const n=e*Math.min(t,1-t),r=(o,c=(o+s/30)%12)=>t-n*Math.max(Math.min(c-3,9-c,1),-1);return[r(0),r(8),r(4)]}function hsv2rgbn(s,e,t){const n=(r,o=(r+s/60)%6)=>t-t*e*Math.max(Math.min(o,4-o,1),0);return[n(5),n(3),n(1)]}function hwb2rgbn(s,e,t){const n=hsl2rgbn(s,1,.5);let r;for(e+t>1&&(r=1/(e+t),e*=r,t*=r),r=0;r<3;r++)n[r]*=1-e-t,n[r]+=e;return n}function hueValue(s,e,t,n,r){return s===r?(e-t)/n+(e<t?6:0):e===r?(t-s)/n+2:(s-e)/n+4}function rgb2hsl(s){const t=s.r/255,n=s.g/255,r=s.b/255,o=Math.max(t,n,r),c=Math.min(t,n,r),u=(o+c)/2;let h,f,p;return o!==c&&(p=o-c,f=u>.5?p/(2-o-c):p/(o+c),h=hueValue(t,n,r,p,o),h=h*60+.5),[h|0,f||0,u]}function calln(s,e,t,n){return(Array.isArray(e)?s(e[0],e[1],e[2]):s(e,t,n)).map(n2b)}function hsl2rgb(s,e,t){return calln(hsl2rgbn,s,e,t)}function hwb2rgb(s,e,t){return calln(hwb2rgbn,s,e,t)}function hsv2rgb(s,e,t){return calln(hsv2rgbn,s,e,t)}function hue(s){return(s%360+360)%360}function hueParse(s){const e=HUE_RE.exec(s);let t=255,n;if(!e)return;e[5]!==n&&(t=e[6]?p2b(+e[5]):n2b(+e[5]));const r=hue(+e[2]),o=+e[3]/100,c=+e[4]/100;return e[1]==="hwb"?n=hwb2rgb(r,o,c):e[1]==="hsv"?n=hsv2rgb(r,o,c):n=hsl2rgb(r,o,c),{r:n[0],g:n[1],b:n[2],a:t}}function rotate(s,e){var t=rgb2hsl(s);t[0]=hue(t[0]+e),t=hsl2rgb(t),s.r=t[0],s.g=t[1],s.b=t[2]}function hslString(s){if(!s)return;const e=rgb2hsl(s),t=e[0],n=n2p(e[1]),r=n2p(e[2]);return s.a<255?`hsla(${t}, ${n}%, ${r}%, ${b2n(s.a)})`:`hsl(${t}, ${n}%, ${r}%)`}const map={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},names$1={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function unpack(){const s={},e=Object.keys(names$1),t=Object.keys(map);let n,r,o,c,u;for(n=0;n<e.length;n++){for(c=u=e[n],r=0;r<t.length;r++)o=t[r],u=u.replace(o,map[o]);o=parseInt(names$1[c],16),s[u]=[o>>16&255,o>>8&255,o&255]}return s}let names;function nameParse(s){names||(names=unpack(),names.transparent=[0,0,0,0]);const e=names[s.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const RGB_RE=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function rgbParse(s){const e=RGB_RE.exec(s);let t=255,n,r,o;if(e){if(e[7]!==n){const c=+e[7];t=e[8]?p2b(c):lim(c*255,0,255)}return n=+e[1],r=+e[3],o=+e[5],n=255&(e[2]?p2b(n):lim(n,0,255)),r=255&(e[4]?p2b(r):lim(r,0,255)),o=255&(e[6]?p2b(o):lim(o,0,255)),{r:n,g:r,b:o,a:t}}}function rgbString(s){return s&&(s.a<255?`rgba(${s.r}, ${s.g}, ${s.b}, ${b2n(s.a)})`:`rgb(${s.r}, ${s.g}, ${s.b})`)}const to=s=>s<=.0031308?s*12.92:Math.pow(s,1/2.4)*1.055-.055,from=s=>s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4);function interpolate$1(s,e,t){const n=from(b2n(s.r)),r=from(b2n(s.g)),o=from(b2n(s.b));return{r:n2b(to(n+t*(from(b2n(e.r))-n))),g:n2b(to(r+t*(from(b2n(e.g))-r))),b:n2b(to(o+t*(from(b2n(e.b))-o))),a:s.a+t*(e.a-s.a)}}function modHSL(s,e,t){if(s){let n=rgb2hsl(s);n[e]=Math.max(0,Math.min(n[e]+n[e]*t,e===0?360:1)),n=hsl2rgb(n),s.r=n[0],s.g=n[1],s.b=n[2]}}function clone$2(s,e){return s&&Object.assign(e||{},s)}function fromObject(s){var e={r:0,g:0,b:0,a:255};return Array.isArray(s)?s.length>=3&&(e={r:s[0],g:s[1],b:s[2],a:255},s.length>3&&(e.a=n2b(s[3]))):(e=clone$2(s,{r:0,g:0,b:0,a:1}),e.a=n2b(e.a)),e}function functionParse(s){return s.charAt(0)==="r"?rgbParse(s):hueParse(s)}class Color{constructor(e){if(e instanceof Color)return e;const t=typeof e;let n;t==="object"?n=fromObject(e):t==="string"&&(n=hexParse(e)||nameParse(e)||functionParse(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=clone$2(this._rgb);return e&&(e.a=b2n(e.a)),e}set rgb(e){this._rgb=fromObject(e)}rgbString(){return this._valid?rgbString(this._rgb):void 0}hexString(){return this._valid?hexString(this._rgb):void 0}hslString(){return this._valid?hslString(this._rgb):void 0}mix(e,t){if(e){const n=this.rgb,r=e.rgb;let o;const c=t===o?.5:t,u=2*c-1,h=n.a-r.a,f=((u*h===-1?u:(u+h)/(1+u*h))+1)/2;o=1-f,n.r=255&f*n.r+o*r.r+.5,n.g=255&f*n.g+o*r.g+.5,n.b=255&f*n.b+o*r.b+.5,n.a=c*n.a+(1-c)*r.a,this.rgb=n}return this}interpolate(e,t){return e&&(this._rgb=interpolate$1(this._rgb,e._rgb,t)),this}clone(){return new Color(this.rgb)}alpha(e){return this._rgb.a=n2b(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=round(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return modHSL(this._rgb,2,e),this}darken(e){return modHSL(this._rgb,2,-e),this}saturate(e){return modHSL(this._rgb,1,e),this}desaturate(e){return modHSL(this._rgb,1,-e),this}rotate(e){return rotate(this._rgb,e),this}}/*!
 * Chart.js v4.4.7
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */function noop(){}const uid=(()=>{let s=0;return()=>s++})();function isNullOrUndef(s){return s==null}function isArray(s){if(Array.isArray&&Array.isArray(s))return!0;const e=Object.prototype.toString.call(s);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function isObject(s){return s!==null&&Object.prototype.toString.call(s)==="[object Object]"}function isNumberFinite(s){return(typeof s=="number"||s instanceof Number)&&isFinite(+s)}function finiteOrDefault(s,e){return isNumberFinite(s)?s:e}function valueOrDefault(s,e){return typeof s>"u"?e:s}const toPercentage=(s,e)=>typeof s=="string"&&s.endsWith("%")?parseFloat(s)/100:+s/e,toDimension=(s,e)=>typeof s=="string"&&s.endsWith("%")?parseFloat(s)/100*e:+s;function callback(s,e,t){if(s&&typeof s.call=="function")return s.apply(t,e)}function each(s,e,t,n){let r,o,c;if(isArray(s))for(o=s.length,r=0;r<o;r++)e.call(t,s[r],r);else if(isObject(s))for(c=Object.keys(s),o=c.length,r=0;r<o;r++)e.call(t,s[c[r]],c[r])}function _elementsEqual(s,e){let t,n,r,o;if(!s||!e||s.length!==e.length)return!1;for(t=0,n=s.length;t<n;++t)if(r=s[t],o=e[t],r.datasetIndex!==o.datasetIndex||r.index!==o.index)return!1;return!0}function clone$1(s){if(isArray(s))return s.map(clone$1);if(isObject(s)){const e=Object.create(null),t=Object.keys(s),n=t.length;let r=0;for(;r<n;++r)e[t[r]]=clone$1(s[t[r]]);return e}return s}function isValidKey(s){return["__proto__","prototype","constructor"].indexOf(s)===-1}function _merger(s,e,t,n){if(!isValidKey(s))return;const r=e[s],o=t[s];isObject(r)&&isObject(o)?merge(r,o,n):e[s]=clone$1(o)}function merge(s,e,t){const n=isArray(e)?e:[e],r=n.length;if(!isObject(s))return s;t=t||{};const o=t.merger||_merger;let c;for(let u=0;u<r;++u){if(c=n[u],!isObject(c))continue;const h=Object.keys(c);for(let f=0,p=h.length;f<p;++f)o(h[f],s,c,t)}return s}function mergeIf(s,e){return merge(s,e,{merger:_mergerIf})}function _mergerIf(s,e,t){if(!isValidKey(s))return;const n=e[s],r=t[s];isObject(n)&&isObject(r)?mergeIf(n,r):Object.prototype.hasOwnProperty.call(e,s)||(e[s]=clone$1(r))}const keyResolvers={"":s=>s,x:s=>s.x,y:s=>s.y};function _splitKey(s){const e=s.split("."),t=[];let n="";for(const r of e)n+=r,n.endsWith("\\")?n=n.slice(0,-1)+".":(t.push(n),n="");return t}function _getKeyResolver(s){const e=_splitKey(s);return t=>{for(const n of e){if(n==="")break;t=t&&t[n]}return t}}function resolveObjectKey(s,e){return(keyResolvers[e]||(keyResolvers[e]=_getKeyResolver(e)))(s)}function _capitalize(s){return s.charAt(0).toUpperCase()+s.slice(1)}const defined=s=>typeof s<"u",isFunction=s=>typeof s=="function",setsEqual=(s,e)=>{if(s.size!==e.size)return!1;for(const t of s)if(!e.has(t))return!1;return!0};function _isClickEvent(s){return s.type==="mouseup"||s.type==="click"||s.type==="contextmenu"}const PI=Math.PI,TAU=2*PI,INFINITY=Number.POSITIVE_INFINITY,RAD_PER_DEG=PI/180,HALF_PI=PI/2,QUARTER_PI=PI/4,TWO_THIRDS_PI=PI*2/3,log10=Math.log10,sign=Math.sign;function almostEquals(s,e,t){return Math.abs(s-e)<t}function niceNum(s){const e=Math.round(s);s=almostEquals(s,e,s/1e3)?e:s;const t=Math.pow(10,Math.floor(log10(s))),n=s/t;return(n<=1?1:n<=2?2:n<=5?5:10)*t}function _factorize(s){const e=[],t=Math.sqrt(s);let n;for(n=1;n<t;n++)s%n===0&&(e.push(n),e.push(s/n));return t===(t|0)&&e.push(t),e.sort((r,o)=>r-o).pop(),e}function isNumber(s){return!isNaN(parseFloat(s))&&isFinite(s)}function almostWhole(s,e){const t=Math.round(s);return t-e<=s&&t+e>=s}function _setMinAndMaxByKey(s,e,t){let n,r,o;for(n=0,r=s.length;n<r;n++)o=s[n][t],isNaN(o)||(e.min=Math.min(e.min,o),e.max=Math.max(e.max,o))}function toRadians(s){return s*(PI/180)}function toDegrees(s){return s*(180/PI)}function _decimalPlaces(s){if(!isNumberFinite(s))return;let e=1,t=0;for(;Math.round(s*e)/e!==s;)e*=10,t++;return t}function getAngleFromPoint(s,e){const t=e.x-s.x,n=e.y-s.y,r=Math.sqrt(t*t+n*n);let o=Math.atan2(n,t);return o<-.5*PI&&(o+=TAU),{angle:o,distance:r}}function distanceBetweenPoints(s,e){return Math.sqrt(Math.pow(e.x-s.x,2)+Math.pow(e.y-s.y,2))}function _normalizeAngle(s){return(s%TAU+TAU)%TAU}function _angleBetween(s,e,t,n){const r=_normalizeAngle(s),o=_normalizeAngle(e),c=_normalizeAngle(t),u=_normalizeAngle(o-r),h=_normalizeAngle(c-r),f=_normalizeAngle(r-o),p=_normalizeAngle(r-c);return r===o||r===c||n&&o===c||u>h&&f<p}function _limitValue(s,e,t){return Math.max(e,Math.min(t,s))}function _int16Range(s){return _limitValue(s,-32768,32767)}function _isBetween(s,e,t,n=1e-6){return s>=Math.min(e,t)-n&&s<=Math.max(e,t)+n}function _lookup(s,e,t){t=t||(c=>s[c]<e);let n=s.length-1,r=0,o;for(;n-r>1;)o=r+n>>1,t(o)?r=o:n=o;return{lo:r,hi:n}}const _lookupByKey=(s,e,t,n)=>_lookup(s,t,n?r=>{const o=s[r][e];return o<t||o===t&&s[r+1][e]===t}:r=>s[r][e]<t),_rlookupByKey=(s,e,t)=>_lookup(s,t,n=>s[n][e]>=t);function _filterBetween(s,e,t){let n=0,r=s.length;for(;n<r&&s[n]<e;)n++;for(;r>n&&s[r-1]>t;)r--;return n>0||r<s.length?s.slice(n,r):s}const arrayEvents=["push","pop","shift","splice","unshift"];function listenArrayEvents(s,e){if(s._chartjs){s._chartjs.listeners.push(e);return}Object.defineProperty(s,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),arrayEvents.forEach(t=>{const n="_onData"+_capitalize(t),r=s[t];Object.defineProperty(s,t,{configurable:!0,enumerable:!1,value(...o){const c=r.apply(this,o);return s._chartjs.listeners.forEach(u=>{typeof u[n]=="function"&&u[n](...o)}),c}})})}function unlistenArrayEvents(s,e){const t=s._chartjs;if(!t)return;const n=t.listeners,r=n.indexOf(e);r!==-1&&n.splice(r,1),!(n.length>0)&&(arrayEvents.forEach(o=>{delete s[o]}),delete s._chartjs)}function _arrayUnique(s){const e=new Set(s);return e.size===s.length?s:Array.from(e)}const requestAnimFrame=function(){return typeof window>"u"?function(s){return s()}:window.requestAnimationFrame}();function throttled(s,e){let t=[],n=!1;return function(...r){t=r,n||(n=!0,requestAnimFrame.call(window,()=>{n=!1,s.apply(e,t)}))}}function debounce(s,e){let t;return function(...n){return e?(clearTimeout(t),t=setTimeout(s,e,n)):s.apply(this,n),e}}const _toLeftRightCenter=s=>s==="start"?"left":s==="end"?"right":"center",_alignStartEnd=(s,e,t)=>s==="start"?e:s==="end"?t:(e+t)/2,_textX=(s,e,t,n)=>s===(n?"left":"right")?t:s==="center"?(e+t)/2:e,atEdge=s=>s===0||s===1,elasticIn=(s,e,t)=>-(Math.pow(2,10*(s-=1))*Math.sin((s-e)*TAU/t)),elasticOut=(s,e,t)=>Math.pow(2,-10*s)*Math.sin((s-e)*TAU/t)+1,effects={linear:s=>s,easeInQuad:s=>s*s,easeOutQuad:s=>-s*(s-2),easeInOutQuad:s=>(s/=.5)<1?.5*s*s:-.5*(--s*(s-2)-1),easeInCubic:s=>s*s*s,easeOutCubic:s=>(s-=1)*s*s+1,easeInOutCubic:s=>(s/=.5)<1?.5*s*s*s:.5*((s-=2)*s*s+2),easeInQuart:s=>s*s*s*s,easeOutQuart:s=>-((s-=1)*s*s*s-1),easeInOutQuart:s=>(s/=.5)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2),easeInQuint:s=>s*s*s*s*s,easeOutQuint:s=>(s-=1)*s*s*s*s+1,easeInOutQuint:s=>(s/=.5)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2),easeInSine:s=>-Math.cos(s*HALF_PI)+1,easeOutSine:s=>Math.sin(s*HALF_PI),easeInOutSine:s=>-.5*(Math.cos(PI*s)-1),easeInExpo:s=>s===0?0:Math.pow(2,10*(s-1)),easeOutExpo:s=>s===1?1:-Math.pow(2,-10*s)+1,easeInOutExpo:s=>atEdge(s)?s:s<.5?.5*Math.pow(2,10*(s*2-1)):.5*(-Math.pow(2,-10*(s*2-1))+2),easeInCirc:s=>s>=1?s:-(Math.sqrt(1-s*s)-1),easeOutCirc:s=>Math.sqrt(1-(s-=1)*s),easeInOutCirc:s=>(s/=.5)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1),easeInElastic:s=>atEdge(s)?s:elasticIn(s,.075,.3),easeOutElastic:s=>atEdge(s)?s:elasticOut(s,.075,.3),easeInOutElastic(s){return atEdge(s)?s:s<.5?.5*elasticIn(s*2,.1125,.45):.5+.5*elasticOut(s*2-1,.1125,.45)},easeInBack(s){return s*s*((1.70158+1)*s-1.70158)},easeOutBack(s){return(s-=1)*s*((1.70158+1)*s+1.70158)+1},easeInOutBack(s){let e=1.70158;return(s/=.5)<1?.5*(s*s*(((e*=1.525)+1)*s-e)):.5*((s-=2)*s*(((e*=1.525)+1)*s+e)+2)},easeInBounce:s=>1-effects.easeOutBounce(1-s),easeOutBounce(s){return s<1/2.75?7.5625*s*s:s<2/2.75?7.5625*(s-=1.5/2.75)*s+.75:s<2.5/2.75?7.5625*(s-=2.25/2.75)*s+.9375:7.5625*(s-=2.625/2.75)*s+.984375},easeInOutBounce:s=>s<.5?effects.easeInBounce(s*2)*.5:effects.easeOutBounce(s*2-1)*.5+.5};function isPatternOrGradient(s){if(s&&typeof s=="object"){const e=s.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function color(s){return isPatternOrGradient(s)?s:new Color(s)}function getHoverColor(s){return isPatternOrGradient(s)?s:new Color(s).saturate(.5).darken(.1).hexString()}const numbers=["x","y","borderWidth","radius","tension"],colors=["color","borderColor","backgroundColor"];function applyAnimationsDefaults(s){s.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),s.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),s.set("animations",{colors:{type:"color",properties:colors},numbers:{type:"number",properties:numbers}}),s.describe("animations",{_fallback:"animation"}),s.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function applyLayoutsDefaults(s){s.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const intlCache=new Map;function getNumberFormat(s,e){e=e||{};const t=s+JSON.stringify(e);let n=intlCache.get(t);return n||(n=new Intl.NumberFormat(s,e),intlCache.set(t,n)),n}function formatNumber(s,e,t){return getNumberFormat(e,t).format(s)}const formatters={values(s){return isArray(s)?s:""+s},numeric(s,e,t){if(s===0)return"0";const n=this.chart.options.locale;let r,o=s;if(t.length>1){const f=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(f<1e-4||f>1e15)&&(r="scientific"),o=calculateDelta(s,t)}const c=log10(Math.abs(o)),u=isNaN(c)?1:Math.max(Math.min(-1*Math.floor(c),20),0),h={notation:r,minimumFractionDigits:u,maximumFractionDigits:u};return Object.assign(h,this.options.ticks.format),formatNumber(s,n,h)}};function calculateDelta(s,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&s!==Math.floor(s)&&(t=s-Math.floor(s)),t}var Ticks={formatters};function applyScaleDefaults(s){s.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Ticks.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),s.route("scale.ticks","color","","color"),s.route("scale.grid","color","","borderColor"),s.route("scale.border","color","","borderColor"),s.route("scale.title","color","","color"),s.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),s.describe("scales",{_fallback:"scale"}),s.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const overrides=Object.create(null),descriptors=Object.create(null);function getScope$1(s,e){if(!e)return s;const t=e.split(".");for(let n=0,r=t.length;n<r;++n){const o=t[n];s=s[o]||(s[o]=Object.create(null))}return s}function set(s,e,t){return typeof e=="string"?merge(getScope$1(s,e),t):merge(getScope$1(s,""),e)}class Defaults{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,r)=>getHoverColor(r.backgroundColor),this.hoverBorderColor=(n,r)=>getHoverColor(r.borderColor),this.hoverColor=(n,r)=>getHoverColor(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return set(this,e,t)}get(e){return getScope$1(this,e)}describe(e,t){return set(descriptors,e,t)}override(e,t){return set(overrides,e,t)}route(e,t,n,r){const o=getScope$1(this,e),c=getScope$1(this,n),u="_"+t;Object.defineProperties(o,{[u]:{value:o[t],writable:!0},[t]:{enumerable:!0,get(){const h=this[u],f=c[r];return isObject(h)?Object.assign({},f,h):valueOrDefault(h,f)},set(h){this[u]=h}}})}apply(e){e.forEach(t=>t(this))}}var defaults=new Defaults({_scriptable:s=>!s.startsWith("on"),_indexable:s=>s!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[applyAnimationsDefaults,applyLayoutsDefaults,applyScaleDefaults]);function toFontString(s){return!s||isNullOrUndef(s.size)||isNullOrUndef(s.family)?null:(s.style?s.style+" ":"")+(s.weight?s.weight+" ":"")+s.size+"px "+s.family}function _measureText(s,e,t,n,r){let o=e[r];return o||(o=e[r]=s.measureText(r).width,t.push(r)),o>n&&(n=o),n}function _alignPixel(s,e,t){const n=s.currentDevicePixelRatio,r=t!==0?Math.max(t/2,.5):0;return Math.round((e-r)*n)/n+r}function clearCanvas(s,e){!e&&!s||(e=e||s.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,s.width,s.height),e.restore())}function drawPoint(s,e,t,n){drawPointLegend(s,e,t,n,null)}function drawPointLegend(s,e,t,n,r){let o,c,u,h,f,p,g,y;const v=e.pointStyle,_=e.rotation,E=e.radius;let x=(_||0)*RAD_PER_DEG;if(v&&typeof v=="object"&&(o=v.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){s.save(),s.translate(t,n),s.rotate(x),s.drawImage(v,-v.width/2,-v.height/2,v.width,v.height),s.restore();return}if(!(isNaN(E)||E<=0)){switch(s.beginPath(),v){default:r?s.ellipse(t,n,r/2,E,0,0,TAU):s.arc(t,n,E,0,TAU),s.closePath();break;case"triangle":p=r?r/2:E,s.moveTo(t+Math.sin(x)*p,n-Math.cos(x)*E),x+=TWO_THIRDS_PI,s.lineTo(t+Math.sin(x)*p,n-Math.cos(x)*E),x+=TWO_THIRDS_PI,s.lineTo(t+Math.sin(x)*p,n-Math.cos(x)*E),s.closePath();break;case"rectRounded":f=E*.516,h=E-f,c=Math.cos(x+QUARTER_PI)*h,g=Math.cos(x+QUARTER_PI)*(r?r/2-f:h),u=Math.sin(x+QUARTER_PI)*h,y=Math.sin(x+QUARTER_PI)*(r?r/2-f:h),s.arc(t-g,n-u,f,x-PI,x-HALF_PI),s.arc(t+y,n-c,f,x-HALF_PI,x),s.arc(t+g,n+u,f,x,x+HALF_PI),s.arc(t-y,n+c,f,x+HALF_PI,x+PI),s.closePath();break;case"rect":if(!_){h=Math.SQRT1_2*E,p=r?r/2:h,s.rect(t-p,n-h,2*p,2*h);break}x+=QUARTER_PI;case"rectRot":g=Math.cos(x)*(r?r/2:E),c=Math.cos(x)*E,u=Math.sin(x)*E,y=Math.sin(x)*(r?r/2:E),s.moveTo(t-g,n-u),s.lineTo(t+y,n-c),s.lineTo(t+g,n+u),s.lineTo(t-y,n+c),s.closePath();break;case"crossRot":x+=QUARTER_PI;case"cross":g=Math.cos(x)*(r?r/2:E),c=Math.cos(x)*E,u=Math.sin(x)*E,y=Math.sin(x)*(r?r/2:E),s.moveTo(t-g,n-u),s.lineTo(t+g,n+u),s.moveTo(t+y,n-c),s.lineTo(t-y,n+c);break;case"star":g=Math.cos(x)*(r?r/2:E),c=Math.cos(x)*E,u=Math.sin(x)*E,y=Math.sin(x)*(r?r/2:E),s.moveTo(t-g,n-u),s.lineTo(t+g,n+u),s.moveTo(t+y,n-c),s.lineTo(t-y,n+c),x+=QUARTER_PI,g=Math.cos(x)*(r?r/2:E),c=Math.cos(x)*E,u=Math.sin(x)*E,y=Math.sin(x)*(r?r/2:E),s.moveTo(t-g,n-u),s.lineTo(t+g,n+u),s.moveTo(t+y,n-c),s.lineTo(t-y,n+c);break;case"line":c=r?r/2:Math.cos(x)*E,u=Math.sin(x)*E,s.moveTo(t-c,n-u),s.lineTo(t+c,n+u);break;case"dash":s.moveTo(t,n),s.lineTo(t+Math.cos(x)*(r?r/2:E),n+Math.sin(x)*E);break;case!1:s.closePath();break}s.fill(),e.borderWidth>0&&s.stroke()}}function _isPointInArea(s,e,t){return t=t||.5,!e||s&&s.x>e.left-t&&s.x<e.right+t&&s.y>e.top-t&&s.y<e.bottom+t}function clipArea(s,e){s.save(),s.beginPath(),s.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),s.clip()}function unclipArea(s){s.restore()}function setRenderOpts(s,e){e.translation&&s.translate(e.translation[0],e.translation[1]),isNullOrUndef(e.rotation)||s.rotate(e.rotation),e.color&&(s.fillStyle=e.color),e.textAlign&&(s.textAlign=e.textAlign),e.textBaseline&&(s.textBaseline=e.textBaseline)}function decorateText(s,e,t,n,r){if(r.strikethrough||r.underline){const o=s.measureText(n),c=e-o.actualBoundingBoxLeft,u=e+o.actualBoundingBoxRight,h=t-o.actualBoundingBoxAscent,f=t+o.actualBoundingBoxDescent,p=r.strikethrough?(h+f)/2:f;s.strokeStyle=s.fillStyle,s.beginPath(),s.lineWidth=r.decorationWidth||2,s.moveTo(c,p),s.lineTo(u,p),s.stroke()}}function drawBackdrop(s,e){const t=s.fillStyle;s.fillStyle=e.color,s.fillRect(e.left,e.top,e.width,e.height),s.fillStyle=t}function renderText(s,e,t,n,r,o={}){const c=isArray(e)?e:[e],u=o.strokeWidth>0&&o.strokeColor!=="";let h,f;for(s.save(),s.font=r.string,setRenderOpts(s,o),h=0;h<c.length;++h)f=c[h],o.backdrop&&drawBackdrop(s,o.backdrop),u&&(o.strokeColor&&(s.strokeStyle=o.strokeColor),isNullOrUndef(o.strokeWidth)||(s.lineWidth=o.strokeWidth),s.strokeText(f,t,n,o.maxWidth)),s.fillText(f,t,n,o.maxWidth),decorateText(s,t,n,f,o),n+=Number(r.lineHeight);s.restore()}function addRoundedRectPath(s,e){const{x:t,y:n,w:r,h:o,radius:c}=e;s.arc(t+c.topLeft,n+c.topLeft,c.topLeft,1.5*PI,PI,!0),s.lineTo(t,n+o-c.bottomLeft),s.arc(t+c.bottomLeft,n+o-c.bottomLeft,c.bottomLeft,PI,HALF_PI,!0),s.lineTo(t+r-c.bottomRight,n+o),s.arc(t+r-c.bottomRight,n+o-c.bottomRight,c.bottomRight,HALF_PI,0,!0),s.lineTo(t+r,n+c.topRight),s.arc(t+r-c.topRight,n+c.topRight,c.topRight,0,-HALF_PI,!0),s.lineTo(t+c.topLeft,n)}const LINE_HEIGHT=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,FONT_STYLE=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function toLineHeight(s,e){const t=(""+s).match(LINE_HEIGHT);if(!t||t[1]==="normal")return e*1.2;switch(s=+t[2],t[3]){case"px":return s;case"%":s/=100;break}return e*s}const numberOrZero=s=>+s||0;function _readValueToProps(s,e){const t={},n=isObject(e),r=n?Object.keys(e):e,o=isObject(s)?n?c=>valueOrDefault(s[c],s[e[c]]):c=>s[c]:()=>s;for(const c of r)t[c]=numberOrZero(o(c));return t}function toTRBL(s){return _readValueToProps(s,{top:"y",right:"x",bottom:"y",left:"x"})}function toTRBLCorners(s){return _readValueToProps(s,["topLeft","topRight","bottomLeft","bottomRight"])}function toPadding(s){const e=toTRBL(s);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function toFont(s,e){s=s||{},e=e||defaults.font;let t=valueOrDefault(s.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let n=valueOrDefault(s.style,e.style);n&&!(""+n).match(FONT_STYLE)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const r={family:valueOrDefault(s.family,e.family),lineHeight:toLineHeight(valueOrDefault(s.lineHeight,e.lineHeight),t),size:t,style:n,weight:valueOrDefault(s.weight,e.weight),string:""};return r.string=toFontString(r),r}function resolve(s,e,t,n){let r,o,c;for(r=0,o=s.length;r<o;++r)if(c=s[r],c!==void 0&&c!==void 0)return c}function _addGrace(s,e,t){const{min:n,max:r}=s,o=toDimension(e,(r-n)/2),c=(u,h)=>t&&u===0?0:u+h;return{min:c(n,-Math.abs(o)),max:c(r,o)}}function createContext(s,e){return Object.assign(Object.create(s),e)}function _createResolver(s,e=[""],t,n,r=()=>s[0]){const o=t||s;typeof n>"u"&&(n=_resolve("_fallback",s));const c={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:s,_rootScopes:o,_fallback:n,_getTarget:r,override:u=>_createResolver([u,...s],e,o,n)};return new Proxy(c,{deleteProperty(u,h){return delete u[h],delete u._keys,delete s[0][h],!0},get(u,h){return _cached(u,h,()=>_resolveWithPrefixes(h,e,s,u))},getOwnPropertyDescriptor(u,h){return Reflect.getOwnPropertyDescriptor(u._scopes[0],h)},getPrototypeOf(){return Reflect.getPrototypeOf(s[0])},has(u,h){return getKeysFromAllScopes(u).includes(h)},ownKeys(u){return getKeysFromAllScopes(u)},set(u,h,f){const p=u._storage||(u._storage=r());return u[h]=p[h]=f,delete u._keys,!0}})}function _attachContext(s,e,t,n){const r={_cacheable:!1,_proxy:s,_context:e,_subProxy:t,_stack:new Set,_descriptors:_descriptors(s,n),setContext:o=>_attachContext(s,o,t,n),override:o=>_attachContext(s.override(o),e,t,n)};return new Proxy(r,{deleteProperty(o,c){return delete o[c],delete s[c],!0},get(o,c,u){return _cached(o,c,()=>_resolveWithContext(o,c,u))},getOwnPropertyDescriptor(o,c){return o._descriptors.allKeys?Reflect.has(s,c)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(s,c)},getPrototypeOf(){return Reflect.getPrototypeOf(s)},has(o,c){return Reflect.has(s,c)},ownKeys(){return Reflect.ownKeys(s)},set(o,c,u){return s[c]=u,delete o[c],!0}})}function _descriptors(s,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:n=e.indexable,_allKeys:r=e.allKeys}=s;return{allKeys:r,scriptable:t,indexable:n,isScriptable:isFunction(t)?t:()=>t,isIndexable:isFunction(n)?n:()=>n}}const readKey=(s,e)=>s?s+_capitalize(e):e,needsSubResolver=(s,e)=>isObject(e)&&s!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function _cached(s,e,t){if(Object.prototype.hasOwnProperty.call(s,e)||e==="constructor")return s[e];const n=t();return s[e]=n,n}function _resolveWithContext(s,e,t){const{_proxy:n,_context:r,_subProxy:o,_descriptors:c}=s;let u=n[e];return isFunction(u)&&c.isScriptable(e)&&(u=_resolveScriptable(e,u,s,t)),isArray(u)&&u.length&&(u=_resolveArray(e,u,s,c.isIndexable)),needsSubResolver(e,u)&&(u=_attachContext(u,r,o&&o[e],c)),u}function _resolveScriptable(s,e,t,n){const{_proxy:r,_context:o,_subProxy:c,_stack:u}=t;if(u.has(s))throw new Error("Recursion detected: "+Array.from(u).join("->")+"->"+s);u.add(s);let h=e(o,c||n);return u.delete(s),needsSubResolver(s,h)&&(h=createSubResolver(r._scopes,r,s,h)),h}function _resolveArray(s,e,t,n){const{_proxy:r,_context:o,_subProxy:c,_descriptors:u}=t;if(typeof o.index<"u"&&n(s))return e[o.index%e.length];if(isObject(e[0])){const h=e,f=r._scopes.filter(p=>p!==h);e=[];for(const p of h){const g=createSubResolver(f,r,s,p);e.push(_attachContext(g,o,c&&c[s],u))}}return e}function resolveFallback(s,e,t){return isFunction(s)?s(e,t):s}const getScope=(s,e)=>s===!0?e:typeof s=="string"?resolveObjectKey(e,s):void 0;function addScopes(s,e,t,n,r){for(const o of e){const c=getScope(t,o);if(c){s.add(c);const u=resolveFallback(c._fallback,t,r);if(typeof u<"u"&&u!==t&&u!==n)return u}else if(c===!1&&typeof n<"u"&&t!==n)return null}return!1}function createSubResolver(s,e,t,n){const r=e._rootScopes,o=resolveFallback(e._fallback,t,n),c=[...s,...r],u=new Set;u.add(n);let h=addScopesFromKey(u,c,t,o||t,n);return h===null||typeof o<"u"&&o!==t&&(h=addScopesFromKey(u,c,o,h,n),h===null)?!1:_createResolver(Array.from(u),[""],r,o,()=>subGetTarget(e,t,n))}function addScopesFromKey(s,e,t,n,r){for(;t;)t=addScopes(s,e,t,n,r);return t}function subGetTarget(s,e,t){const n=s._getTarget();e in n||(n[e]={});const r=n[e];return isArray(r)&&isObject(t)?t:r||{}}function _resolveWithPrefixes(s,e,t,n){let r;for(const o of e)if(r=_resolve(readKey(o,s),t),typeof r<"u")return needsSubResolver(s,r)?createSubResolver(t,n,s,r):r}function _resolve(s,e){for(const t of e){if(!t)continue;const n=t[s];if(typeof n<"u")return n}}function getKeysFromAllScopes(s){let e=s._keys;return e||(e=s._keys=resolveKeysFromAllScopes(s._scopes)),e}function resolveKeysFromAllScopes(s){const e=new Set;for(const t of s)for(const n of Object.keys(t).filter(r=>!r.startsWith("_")))e.add(n);return Array.from(e)}function _isDomSupported(){return typeof window<"u"&&typeof document<"u"}function _getParentNode(s){let e=s.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function parseMaxStyle(s,e,t){let n;return typeof s=="string"?(n=parseInt(s,10),s.indexOf("%")!==-1&&(n=n/100*e.parentNode[t])):n=s,n}const getComputedStyle$1=s=>s.ownerDocument.defaultView.getComputedStyle(s,null);function getStyle(s,e){return getComputedStyle$1(s).getPropertyValue(e)}const positions=["top","right","bottom","left"];function getPositionedStyle(s,e,t){const n={};t=t?"-"+t:"";for(let r=0;r<4;r++){const o=positions[r];n[o]=parseFloat(s[e+"-"+o+t])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const useOffsetPos=(s,e,t)=>(s>0||e>0)&&(!t||!t.shadowRoot);function getCanvasPosition(s,e){const t=s.touches,n=t&&t.length?t[0]:s,{offsetX:r,offsetY:o}=n;let c=!1,u,h;if(useOffsetPos(r,o,s.target))u=r,h=o;else{const f=e.getBoundingClientRect();u=n.clientX-f.left,h=n.clientY-f.top,c=!0}return{x:u,y:h,box:c}}function getRelativePosition(s,e){if("native"in s)return s;const{canvas:t,currentDevicePixelRatio:n}=e,r=getComputedStyle$1(t),o=r.boxSizing==="border-box",c=getPositionedStyle(r,"padding"),u=getPositionedStyle(r,"border","width"),{x:h,y:f,box:p}=getCanvasPosition(s,t),g=c.left+(p&&u.left),y=c.top+(p&&u.top);let{width:v,height:_}=e;return o&&(v-=c.width+u.width,_-=c.height+u.height),{x:Math.round((h-g)/v*t.width/n),y:Math.round((f-y)/_*t.height/n)}}function getContainerSize(s,e,t){let n,r;if(e===void 0||t===void 0){const o=s&&_getParentNode(s);if(!o)e=s.clientWidth,t=s.clientHeight;else{const c=o.getBoundingClientRect(),u=getComputedStyle$1(o),h=getPositionedStyle(u,"border","width"),f=getPositionedStyle(u,"padding");e=c.width-f.width-h.width,t=c.height-f.height-h.height,n=parseMaxStyle(u.maxWidth,o,"clientWidth"),r=parseMaxStyle(u.maxHeight,o,"clientHeight")}}return{width:e,height:t,maxWidth:n||INFINITY,maxHeight:r||INFINITY}}const round1=s=>Math.round(s*10)/10;function getMaximumSize(s,e,t,n){const r=getComputedStyle$1(s),o=getPositionedStyle(r,"margin"),c=parseMaxStyle(r.maxWidth,s,"clientWidth")||INFINITY,u=parseMaxStyle(r.maxHeight,s,"clientHeight")||INFINITY,h=getContainerSize(s,e,t);let{width:f,height:p}=h;if(r.boxSizing==="content-box"){const y=getPositionedStyle(r,"border","width"),v=getPositionedStyle(r,"padding");f-=v.width+y.width,p-=v.height+y.height}return f=Math.max(0,f-o.width),p=Math.max(0,n?f/n:p-o.height),f=round1(Math.min(f,c,h.maxWidth)),p=round1(Math.min(p,u,h.maxHeight)),f&&!p&&(p=round1(f/2)),(e!==void 0||t!==void 0)&&n&&h.height&&p>h.height&&(p=h.height,f=round1(Math.floor(p*n))),{width:f,height:p}}function retinaScale(s,e,t){const n=e||1,r=Math.floor(s.height*n),o=Math.floor(s.width*n);s.height=Math.floor(s.height),s.width=Math.floor(s.width);const c=s.canvas;return c.style&&(t||!c.style.height&&!c.style.width)&&(c.style.height=`${s.height}px`,c.style.width=`${s.width}px`),s.currentDevicePixelRatio!==n||c.height!==r||c.width!==o?(s.currentDevicePixelRatio=n,c.height=r,c.width=o,s.ctx.setTransform(n,0,0,n,0,0),!0):!1}const supportsEventListenerOptions=function(){let s=!1;try{const e={get passive(){return s=!0,!1}};_isDomSupported()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return s}();function readUsedSize(s,e){const t=getStyle(s,e),n=t&&t.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}const getRightToLeftAdapter=function(s,e){return{x(t){return s+s+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,n){return t-n},leftForLtr(t,n){return t-n}}},getLeftToRightAdapter=function(){return{x(s){return s},setWidth(s){},textAlign(s){return s},xPlus(s,e){return s+e},leftForLtr(s,e){return s}}};function getRtlAdapter(s,e,t){return s?getRightToLeftAdapter(e,t):getLeftToRightAdapter()}function overrideTextDirection(s,e){let t,n;(e==="ltr"||e==="rtl")&&(t=s.canvas.style,n=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),s.prevTextDirection=n)}function restoreTextDirection(s,e){e!==void 0&&(delete s.prevTextDirection,s.canvas.style.setProperty("direction",e[0],e[1]))}/*!
 * Chart.js v4.4.7
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */class Animator{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,n,r){const o=t.listeners[r],c=t.duration;o.forEach(u=>u({chart:e,initial:t.initial,numSteps:c,currentStep:Math.min(n-t.start,c)}))}_refresh(){this._request||(this._running=!0,this._request=requestAnimFrame.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((n,r)=>{if(!n.running||!n.items.length)return;const o=n.items;let c=o.length-1,u=!1,h;for(;c>=0;--c)h=o[c],h._active?(h._total>n.duration&&(n.duration=h._total),h.tick(e),u=!0):(o[c]=o[o.length-1],o.pop());u&&(r.draw(),this._notify(r,n,e,"progress")),o.length||(n.running=!1,this._notify(r,n,e,"complete"),n.initial=!1),t+=o.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((n,r)=>Math.max(n,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const n=t.items;let r=n.length-1;for(;r>=0;--r)n[r].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var animator=new Animator;const transparent="transparent",interpolators={boolean(s,e,t){return t>.5?e:s},color(s,e,t){const n=color(s||transparent),r=n.valid&&color(e||transparent);return r&&r.valid?r.mix(n,t).hexString():e},number(s,e,t){return s+(e-s)*t}};class Animation{constructor(e,t,n,r){const o=t[n];r=resolve([e.to,r,o,e.from]);const c=resolve([e.from,o,r]);this._active=!0,this._fn=e.fn||interpolators[e.type||typeof c],this._easing=effects[e.easing]||effects.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=c,this._to=r,this._promises=void 0}active(){return this._active}update(e,t,n){if(this._active){this._notify(!1);const r=this._target[this._prop],o=n-this._start,c=this._duration-o;this._start=n,this._duration=Math.floor(Math.max(c,e.duration)),this._total+=o,this._loop=!!e.loop,this._to=resolve([e.to,t,r,e.from]),this._from=resolve([e.from,r,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,n=this._duration,r=this._prop,o=this._from,c=this._loop,u=this._to;let h;if(this._active=o!==u&&(c||t<n),!this._active){this._target[r]=u,this._notify(!0);return}if(t<0){this._target[r]=o;return}h=t/n%2,h=c&&h>1?2-h:h,h=this._easing(Math.min(1,Math.max(0,h))),this._target[r]=this._fn(o,u,h)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,n)=>{e.push({res:t,rej:n})})}_notify(e){const t=e?"res":"rej",n=this._promises||[];for(let r=0;r<n.length;r++)n[r][t]()}}class Animations{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!isObject(e))return;const t=Object.keys(defaults.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const o=e[r];if(!isObject(o))return;const c={};for(const u of t)c[u]=o[u];(isArray(o.properties)&&o.properties||[r]).forEach(u=>{(u===r||!n.has(u))&&n.set(u,c)})})}_animateOptions(e,t){const n=t.options,r=resolveTargetOptions(e,n);if(!r)return[];const o=this._createAnimations(r,n);return n.$shared&&awaitAll(e.options.$animations,n).then(()=>{e.options=n},()=>{}),o}_createAnimations(e,t){const n=this._properties,r=[],o=e.$animations||(e.$animations={}),c=Object.keys(t),u=Date.now();let h;for(h=c.length-1;h>=0;--h){const f=c[h];if(f.charAt(0)==="$")continue;if(f==="options"){r.push(...this._animateOptions(e,t));continue}const p=t[f];let g=o[f];const y=n.get(f);if(g)if(y&&g.active()){g.update(y,p,u);continue}else g.cancel();if(!y||!y.duration){e[f]=p;continue}o[f]=g=new Animation(y,e,f,p),r.push(g)}return r}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const n=this._createAnimations(e,t);if(n.length)return animator.add(this._chart,n),!0}}function awaitAll(s,e){const t=[],n=Object.keys(e);for(let r=0;r<n.length;r++){const o=s[n[r]];o&&o.active()&&t.push(o.wait())}return Promise.all(t)}function resolveTargetOptions(s,e){if(!e)return;let t=s.options;if(!t){s.options=e;return}return t.$shared&&(s.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function scaleClip(s,e){const t=s&&s.options||{},n=t.reverse,r=t.min===void 0?e:0,o=t.max===void 0?e:0;return{start:n?o:r,end:n?r:o}}function defaultClip(s,e,t){if(t===!1)return!1;const n=scaleClip(s,t),r=scaleClip(e,t);return{top:r.end,right:n.end,bottom:r.start,left:n.start}}function toClip(s){let e,t,n,r;return isObject(s)?(e=s.top,t=s.right,n=s.bottom,r=s.left):e=t=n=r=s,{top:e,right:t,bottom:n,left:r,disabled:s===!1}}function getSortedDatasetIndices(s,e){const t=[],n=s._getSortedDatasetMetas(e);let r,o;for(r=0,o=n.length;r<o;++r)t.push(n[r].index);return t}function applyStack(s,e,t,n={}){const r=s.keys,o=n.mode==="single";let c,u,h,f;if(e===null)return;let p=!1;for(c=0,u=r.length;c<u;++c){if(h=+r[c],h===t){if(p=!0,n.all)continue;break}f=s.values[h],isNumberFinite(f)&&(o||e===0||sign(e)===sign(f))&&(e+=f)}return!p&&!n.all?0:e}function convertObjectDataToArray(s,e){const{iScale:t,vScale:n}=e,r=t.axis==="x"?"x":"y",o=n.axis==="x"?"x":"y",c=Object.keys(s),u=new Array(c.length);let h,f,p;for(h=0,f=c.length;h<f;++h)p=c[h],u[h]={[r]:p,[o]:s[p]};return u}function isStacked(s,e){const t=s&&s.options.stacked;return t||t===void 0&&e.stack!==void 0}function getStackKey(s,e,t){return`${s.id}.${e.id}.${t.stack||t.type}`}function getUserBounds(s){const{min:e,max:t,minDefined:n,maxDefined:r}=s.getUserBounds();return{min:n?e:Number.NEGATIVE_INFINITY,max:r?t:Number.POSITIVE_INFINITY}}function getOrCreateStack(s,e,t){const n=s[e]||(s[e]={});return n[t]||(n[t]={})}function getLastIndexInStack(s,e,t,n){for(const r of e.getMatchingVisibleMetas(n).reverse()){const o=s[r.index];if(t&&o>0||!t&&o<0)return r.index}return null}function updateStacks(s,e){const{chart:t,_cachedMeta:n}=s,r=t._stacks||(t._stacks={}),{iScale:o,vScale:c,index:u}=n,h=o.axis,f=c.axis,p=getStackKey(o,c,n),g=e.length;let y;for(let v=0;v<g;++v){const _=e[v],{[h]:E,[f]:x}=_,w=_._stacks||(_._stacks={});y=w[f]=getOrCreateStack(r,p,E),y[u]=x,y._top=getLastIndexInStack(y,c,!0,n.type),y._bottom=getLastIndexInStack(y,c,!1,n.type);const T=y._visualValues||(y._visualValues={});T[u]=x}}function getFirstScaleId(s,e){const t=s.scales;return Object.keys(t).filter(n=>t[n].axis===e).shift()}function createDatasetContext(s,e){return createContext(s,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function createDataContext(s,e,t){return createContext(s,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function clearStacks(s,e){const t=s.controller.index,n=s.vScale&&s.vScale.axis;if(n){e=e||s._parsed;for(const r of e){const o=r._stacks;if(!o||o[n]===void 0||o[n][t]===void 0)return;delete o[n][t],o[n]._visualValues!==void 0&&o[n]._visualValues[t]!==void 0&&delete o[n]._visualValues[t]}}}const isDirectUpdateMode=s=>s==="reset"||s==="none",cloneIfNotShared=(s,e)=>e?s:Object.assign({},s),createStack=(s,e,t)=>s&&!e.hidden&&e._stacked&&{keys:getSortedDatasetIndices(t,!0),values:null};class DatasetController{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=isStacked(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&clearStacks(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,n=this.getDataset(),r=(g,y,v,_)=>g==="x"?y:g==="r"?_:v,o=t.xAxisID=valueOrDefault(n.xAxisID,getFirstScaleId(e,"x")),c=t.yAxisID=valueOrDefault(n.yAxisID,getFirstScaleId(e,"y")),u=t.rAxisID=valueOrDefault(n.rAxisID,getFirstScaleId(e,"r")),h=t.indexAxis,f=t.iAxisID=r(h,o,c,u),p=t.vAxisID=r(h,c,o,u);t.xScale=this.getScaleForId(o),t.yScale=this.getScaleForId(c),t.rScale=this.getScaleForId(u),t.iScale=this.getScaleForId(f),t.vScale=this.getScaleForId(p)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&unlistenArrayEvents(this._data,this),e._stacked&&clearStacks(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(isObject(t)){const r=this._cachedMeta;this._data=convertObjectDataToArray(t,r)}else if(n!==t){if(n){unlistenArrayEvents(n,this);const r=this._cachedMeta;clearStacks(r),r._parsed=[]}t&&Object.isExtensible(t)&&listenArrayEvents(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,n=this.getDataset();let r=!1;this._dataCheck();const o=t._stacked;t._stacked=isStacked(t.vScale,t),t.stack!==n.stack&&(r=!0,clearStacks(t),t.stack=n.stack),this._resyncElements(e),(r||o!==t._stacked)&&(updateStacks(this,t._parsed),t._stacked=isStacked(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:n,_data:r}=this,{iScale:o,_stacked:c}=n,u=o.axis;let h=e===0&&t===r.length?!0:n._sorted,f=e>0&&n._parsed[e-1],p,g,y;if(this._parsing===!1)n._parsed=r,n._sorted=!0,y=r;else{isArray(r[e])?y=this.parseArrayData(n,r,e,t):isObject(r[e])?y=this.parseObjectData(n,r,e,t):y=this.parsePrimitiveData(n,r,e,t);const v=()=>g[u]===null||f&&g[u]<f[u];for(p=0;p<t;++p)n._parsed[p+e]=g=y[p],h&&(v()&&(h=!1),f=g);n._sorted=h}c&&updateStacks(this,y)}parsePrimitiveData(e,t,n,r){const{iScale:o,vScale:c}=e,u=o.axis,h=c.axis,f=o.getLabels(),p=o===c,g=new Array(r);let y,v,_;for(y=0,v=r;y<v;++y)_=y+n,g[y]={[u]:p||o.parse(f[_],_),[h]:c.parse(t[_],_)};return g}parseArrayData(e,t,n,r){const{xScale:o,yScale:c}=e,u=new Array(r);let h,f,p,g;for(h=0,f=r;h<f;++h)p=h+n,g=t[p],u[h]={x:o.parse(g[0],p),y:c.parse(g[1],p)};return u}parseObjectData(e,t,n,r){const{xScale:o,yScale:c}=e,{xAxisKey:u="x",yAxisKey:h="y"}=this._parsing,f=new Array(r);let p,g,y,v;for(p=0,g=r;p<g;++p)y=p+n,v=t[y],f[p]={x:o.parse(resolveObjectKey(v,u),y),y:c.parse(resolveObjectKey(v,h),y)};return f}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){const r=this.chart,o=this._cachedMeta,c=t[e.axis],u={keys:getSortedDatasetIndices(r,!0),values:t._stacks[e.axis]._visualValues};return applyStack(u,c,o.index,{mode:n})}updateRangeFromParsed(e,t,n,r){const o=n[t.axis];let c=o===null?NaN:o;const u=r&&n._stacks[t.axis];r&&u&&(r.values=u,c=applyStack(r,o,this._cachedMeta.index)),e.min=Math.min(e.min,c),e.max=Math.max(e.max,c)}getMinMax(e,t){const n=this._cachedMeta,r=n._parsed,o=n._sorted&&e===n.iScale,c=r.length,u=this._getOtherScale(e),h=createStack(t,n,this.chart),f={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:p,max:g}=getUserBounds(u);let y,v;function _(){v=r[y];const E=v[u.axis];return!isNumberFinite(v[e.axis])||p>E||g<E}for(y=0;y<c&&!(!_()&&(this.updateRangeFromParsed(f,e,v,h),o));++y);if(o){for(y=c-1;y>=0;--y)if(!_()){this.updateRangeFromParsed(f,e,v,h);break}}return f}getAllParsedValues(e){const t=this._cachedMeta._parsed,n=[];let r,o,c;for(r=0,o=t.length;r<o;++r)c=t[r][e.axis],isNumberFinite(c)&&n.push(c);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,n=t.iScale,r=t.vScale,o=this.getParsed(e);return{label:n?""+n.getLabelForValue(o[n.axis]):"",value:r?""+r.getLabelForValue(o[r.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=toClip(valueOrDefault(this.options.clip,defaultClip(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,n=this._cachedMeta,r=n.data||[],o=t.chartArea,c=[],u=this._drawStart||0,h=this._drawCount||r.length-u,f=this.options.drawActiveElementsOnTop;let p;for(n.dataset&&n.dataset.draw(e,o,u,h),p=u;p<u+h;++p){const g=r[p];g.hidden||(g.active&&f?c.push(g):g.draw(e,o))}for(p=0;p<c.length;++p)c[p].draw(e,o)}getStyle(e,t){const n=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){const r=this.getDataset();let o;if(e>=0&&e<this._cachedMeta.data.length){const c=this._cachedMeta.data[e];o=c.$context||(c.$context=createDataContext(this.getContext(),e,c)),o.parsed=this.getParsed(e),o.raw=r.data[e],o.index=o.dataIndex=e}else o=this.$context||(this.$context=createDatasetContext(this.chart.getContext(),this.index)),o.dataset=r,o.index=o.datasetIndex=this.index;return o.active=!!t,o.mode=n,o}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",n){const r=t==="active",o=this._cachedDataOpts,c=e+"-"+t,u=o[c],h=this.enableOptionSharing&&defined(n);if(u)return cloneIfNotShared(u,h);const f=this.chart.config,p=f.datasetElementScopeKeys(this._type,e),g=r?[`${e}Hover`,"hover",e,""]:[e,""],y=f.getOptionScopes(this.getDataset(),p),v=Object.keys(defaults.elements[e]),_=()=>this.getContext(n,r,t),E=f.resolveNamedOptions(y,v,_,g);return E.$shared&&(E.$shared=h,o[c]=Object.freeze(cloneIfNotShared(E,h))),E}_resolveAnimations(e,t,n){const r=this.chart,o=this._cachedDataOpts,c=`animation-${t}`,u=o[c];if(u)return u;let h;if(r.options.animation!==!1){const p=this.chart.config,g=p.datasetAnimationScopeKeys(this._type,t),y=p.getOptionScopes(this.getDataset(),g);h=p.createResolver(y,this.getContext(e,n,t))}const f=new Animations(r,h&&h.animations);return h&&h._cacheable&&(o[c]=Object.freeze(f)),f}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||isDirectUpdateMode(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const n=this.resolveDataElementOptions(e,t),r=this._sharedOptions,o=this.getSharedOptions(n),c=this.includeOptions(t,o)||o!==r;return this.updateSharedOptions(o,t,n),{sharedOptions:o,includeOptions:c}}updateElement(e,t,n,r){isDirectUpdateMode(r)?Object.assign(e,n):this._resolveAnimations(t,r).update(e,n)}updateSharedOptions(e,t,n){e&&!isDirectUpdateMode(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,r){e.active=r;const o=this.getStyle(t,r);this._resolveAnimations(t,n,r).update(e,{options:!r&&this.getSharedOptions(o)||o})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,n=this._cachedMeta.data;for(const[u,h,f]of this._syncList)this[u](h,f);this._syncList=[];const r=n.length,o=t.length,c=Math.min(o,r);c&&this.parse(0,c),o>r?this._insertElements(r,o-r,e):o<r&&this._removeElements(o,r-o)}_insertElements(e,t,n=!0){const r=this._cachedMeta,o=r.data,c=e+t;let u;const h=f=>{for(f.length+=t,u=f.length-1;u>=c;u--)f[u]=f[u-t]};for(h(o),u=e;u<c;++u)o[u]=new this.dataElementType;this._parsing&&h(r._parsed),this.parse(e,t),n&&this.updateElements(o,e,t,"reset")}updateElements(e,t,n,r){}_removeElements(e,t){const n=this._cachedMeta;if(this._parsing){const r=n._parsed.splice(e,t);n._stacked&&clearStacks(n,r)}n.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,n,r]=e;this[t](n,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}ot(DatasetController,"defaults",{}),ot(DatasetController,"datasetElementType",null),ot(DatasetController,"dataElementType",null);function getAllScaleValues(s,e){if(!s._cache.$bar){const t=s.getMatchingVisibleMetas(e);let n=[];for(let r=0,o=t.length;r<o;r++)n=n.concat(t[r].controller.getAllParsedValues(s));s._cache.$bar=_arrayUnique(n.sort((r,o)=>r-o))}return s._cache.$bar}function computeMinSampleSize(s){const e=s.iScale,t=getAllScaleValues(e,s.type);let n=e._length,r,o,c,u;const h=()=>{c===32767||c===-32768||(defined(u)&&(n=Math.min(n,Math.abs(c-u)||n)),u=c)};for(r=0,o=t.length;r<o;++r)c=e.getPixelForValue(t[r]),h();for(u=void 0,r=0,o=e.ticks.length;r<o;++r)c=e.getPixelForTick(r),h();return n}function computeFitCategoryTraits(s,e,t,n){const r=t.barThickness;let o,c;return isNullOrUndef(r)?(o=e.min*t.categoryPercentage,c=t.barPercentage):(o=r*n,c=1),{chunk:o/n,ratio:c,start:e.pixels[s]-o/2}}function computeFlexCategoryTraits(s,e,t,n){const r=e.pixels,o=r[s];let c=s>0?r[s-1]:null,u=s<r.length-1?r[s+1]:null;const h=t.categoryPercentage;c===null&&(c=o-(u===null?e.end-e.start:u-o)),u===null&&(u=o+o-c);const f=o-(o-Math.min(c,u))/2*h;return{chunk:Math.abs(u-c)/2*h/n,ratio:t.barPercentage,start:f}}function parseFloatBar(s,e,t,n){const r=t.parse(s[0],n),o=t.parse(s[1],n),c=Math.min(r,o),u=Math.max(r,o);let h=c,f=u;Math.abs(c)>Math.abs(u)&&(h=u,f=c),e[t.axis]=f,e._custom={barStart:h,barEnd:f,start:r,end:o,min:c,max:u}}function parseValue(s,e,t,n){return isArray(s)?parseFloatBar(s,e,t,n):e[t.axis]=t.parse(s,n),e}function parseArrayOrPrimitive(s,e,t,n){const r=s.iScale,o=s.vScale,c=r.getLabels(),u=r===o,h=[];let f,p,g,y;for(f=t,p=t+n;f<p;++f)y=e[f],g={},g[r.axis]=u||r.parse(c[f],f),h.push(parseValue(y,g,o,f));return h}function isFloatBar(s){return s&&s.barStart!==void 0&&s.barEnd!==void 0}function barSign(s,e,t){return s!==0?sign(s):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function borderProps(s){let e,t,n,r,o;return s.horizontal?(e=s.base>s.x,t="left",n="right"):(e=s.base<s.y,t="bottom",n="top"),e?(r="end",o="start"):(r="start",o="end"),{start:t,end:n,reverse:e,top:r,bottom:o}}function setBorderSkipped(s,e,t,n){let r=e.borderSkipped;const o={};if(!r){s.borderSkipped=o;return}if(r===!0){s.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:c,end:u,reverse:h,top:f,bottom:p}=borderProps(s);r==="middle"&&t&&(s.enableBorderRadius=!0,(t._top||0)===n?r=f:(t._bottom||0)===n?r=p:(o[parseEdge(p,c,u,h)]=!0,r=f)),o[parseEdge(r,c,u,h)]=!0,s.borderSkipped=o}function parseEdge(s,e,t,n){return n?(s=swap(s,e,t),s=startEnd(s,t,e)):s=startEnd(s,e,t),s}function swap(s,e,t){return s===e?t:s===t?e:s}function startEnd(s,e,t){return s==="start"?e:s==="end"?t:s}function setInflateAmount(s,{inflateAmount:e},t){s.inflateAmount=e==="auto"?t===1?.33:0:e}class BarController extends DatasetController{parsePrimitiveData(e,t,n,r){return parseArrayOrPrimitive(e,t,n,r)}parseArrayData(e,t,n,r){return parseArrayOrPrimitive(e,t,n,r)}parseObjectData(e,t,n,r){const{iScale:o,vScale:c}=e,{xAxisKey:u="x",yAxisKey:h="y"}=this._parsing,f=o.axis==="x"?u:h,p=c.axis==="x"?u:h,g=[];let y,v,_,E;for(y=n,v=n+r;y<v;++y)E=t[y],_={},_[o.axis]=o.parse(resolveObjectKey(E,f),y),g.push(parseValue(resolveObjectKey(E,p),_,c,y));return g}updateRangeFromParsed(e,t,n,r){super.updateRangeFromParsed(e,t,n,r);const o=n._custom;o&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,o.min),e.max=Math.max(e.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:n,vScale:r}=t,o=this.getParsed(e),c=o._custom,u=isFloatBar(c)?"["+c.start+", "+c.end+"]":""+r.getLabelForValue(o[r.axis]);return{label:""+n.getLabelForValue(o[n.axis]),value:u}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,n,r){const o=r==="reset",{index:c,_cachedMeta:{vScale:u}}=this,h=u.getBasePixel(),f=u.isHorizontal(),p=this._getRuler(),{sharedOptions:g,includeOptions:y}=this._getSharedOptions(t,r);for(let v=t;v<t+n;v++){const _=this.getParsed(v),E=o||isNullOrUndef(_[u.axis])?{base:h,head:h}:this._calculateBarValuePixels(v),x=this._calculateBarIndexPixels(v,p),w=(_._stacks||{})[u.axis],T={horizontal:f,base:E.base,enableBorderRadius:!w||isFloatBar(_._custom)||c===w._top||c===w._bottom,x:f?E.head:x.center,y:f?x.center:E.head,height:f?x.size:Math.abs(E.size),width:f?Math.abs(E.size):x.size};y&&(T.options=g||this.resolveDataElementOptions(v,e[v].active?"active":r));const O=T.options||e[v].options;setBorderSkipped(T,O,w,c),setInflateAmount(T,O,p.ratio),this.updateElement(e[v],v,T,r)}}_getStacks(e,t){const{iScale:n}=this._cachedMeta,r=n.getMatchingVisibleMetas(this._type).filter(p=>p.controller.options.grouped),o=n.options.stacked,c=[],u=this._cachedMeta.controller.getParsed(t),h=u&&u[n.axis],f=p=>{const g=p._parsed.find(v=>v[n.axis]===h),y=g&&g[p.vScale.axis];if(isNullOrUndef(y)||isNaN(y))return!0};for(const p of r)if(!(t!==void 0&&f(p))&&((o===!1||c.indexOf(p.stack)===-1||o===void 0&&p.stack===void 0)&&c.push(p.stack),p.index===e))break;return c.length||c.push(void 0),c}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,n){const r=this._getStacks(e,n),o=t!==void 0?r.indexOf(t):-1;return o===-1?r.length-1:o}_getRuler(){const e=this.options,t=this._cachedMeta,n=t.iScale,r=[];let o,c;for(o=0,c=t.data.length;o<c;++o)r.push(n.getPixelForValue(this.getParsed(o)[n.axis],o));const u=e.barThickness;return{min:u||computeMinSampleSize(t),pixels:r,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:e.grouped,ratio:u?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:n,index:r},options:{base:o,minBarLength:c}}=this,u=o||0,h=this.getParsed(e),f=h._custom,p=isFloatBar(f);let g=h[t.axis],y=0,v=n?this.applyStack(t,h,n):g,_,E;v!==g&&(y=v-g,v=g),p&&(g=f.barStart,v=f.barEnd-f.barStart,g!==0&&sign(g)!==sign(f.barEnd)&&(y=0),y+=g);const x=!isNullOrUndef(o)&&!p?o:y;let w=t.getPixelForValue(x);if(this.chart.getDataVisibility(e)?_=t.getPixelForValue(y+v):_=w,E=_-w,Math.abs(E)<c){E=barSign(E,t,u)*c,g===u&&(w-=E/2);const T=t.getPixelForDecimal(0),O=t.getPixelForDecimal(1),N=Math.min(T,O),A=Math.max(T,O);w=Math.max(Math.min(w,A),N),_=w+E,n&&!p&&(h._stacks[t.axis]._visualValues[r]=t.getValueForPixel(_)-t.getValueForPixel(w))}if(w===t.getPixelForValue(u)){const T=sign(E)*t.getLineWidthForValue(u)/2;w+=T,E-=T}return{size:E,base:w,head:_,center:_+E/2}}_calculateBarIndexPixels(e,t){const n=t.scale,r=this.options,o=r.skipNull,c=valueOrDefault(r.maxBarThickness,1/0);let u,h;if(t.grouped){const f=o?this._getStackCount(e):t.stackCount,p=r.barThickness==="flex"?computeFlexCategoryTraits(e,t,r,f):computeFitCategoryTraits(e,t,r,f),g=this._getStackIndex(this.index,this._cachedMeta.stack,o?e:void 0);u=p.start+p.chunk*g+p.chunk/2,h=Math.min(c,p.chunk*p.ratio)}else u=n.getPixelForValue(this.getParsed(e)[n.axis],e),h=Math.min(c,t.min*t.ratio);return{base:u-h/2,head:u+h/2,center:u,size:h}}draw(){const e=this._cachedMeta,t=e.vScale,n=e.data,r=n.length;let o=0;for(;o<r;++o)this.getParsed(o)[t.axis]!==null&&!n[o].hidden&&n[o].draw(this._ctx)}}ot(BarController,"id","bar"),ot(BarController,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),ot(BarController,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function getRatioAndOffset(s,e,t){let n=1,r=1,o=0,c=0;if(e<TAU){const u=s,h=u+e,f=Math.cos(u),p=Math.sin(u),g=Math.cos(h),y=Math.sin(h),v=(O,N,A)=>_angleBetween(O,u,h,!0)?1:Math.max(N,N*t,A,A*t),_=(O,N,A)=>_angleBetween(O,u,h,!0)?-1:Math.min(N,N*t,A,A*t),E=v(0,f,g),x=v(HALF_PI,p,y),w=_(PI,f,g),T=_(PI+HALF_PI,p,y);n=(E-w)/2,r=(x-T)/2,o=-(E+w)/2,c=-(x+T)/2}return{ratioX:n,ratioY:r,offsetX:o,offsetY:c}}class DoughnutController extends DatasetController{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const n=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=n;else{let o=h=>+n[h];if(isObject(n[e])){const{key:h="value"}=this._parsing;o=f=>+resolveObjectKey(n[f],h)}let c,u;for(c=e,u=e+t;c<u;++c)r._parsed[c]=o(c)}}_getRotation(){return toRadians(this.options.rotation-90)}_getCircumference(){return toRadians(this.options.circumference)}_getRotationExtents(){let e=TAU,t=-TAU;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const r=this.chart.getDatasetMeta(n).controller,o=r._getRotation(),c=r._getCircumference();e=Math.min(e,o),t=Math.max(t,o+c)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:n}=t,r=this._cachedMeta,o=r.data,c=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,u=Math.max((Math.min(n.width,n.height)-c)/2,0),h=Math.min(toPercentage(this.options.cutout,u),1),f=this._getRingWeight(this.index),{circumference:p,rotation:g}=this._getRotationExtents(),{ratioX:y,ratioY:v,offsetX:_,offsetY:E}=getRatioAndOffset(g,p,h),x=(n.width-c)/y,w=(n.height-c)/v,T=Math.max(Math.min(x,w)/2,0),O=toDimension(this.options.radius,T),N=Math.max(O*h,0),A=(O-N)/this._getVisibleDatasetWeightTotal();this.offsetX=_*O,this.offsetY=E*O,r.total=this.calculateTotal(),this.outerRadius=O-A*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-A*f,0),this.updateElements(o,0,o.length,e)}_circumference(e,t){const n=this.options,r=this._cachedMeta,o=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*o/TAU)}updateElements(e,t,n,r){const o=r==="reset",c=this.chart,u=c.chartArea,f=c.options.animation,p=(u.left+u.right)/2,g=(u.top+u.bottom)/2,y=o&&f.animateScale,v=y?0:this.innerRadius,_=y?0:this.outerRadius,{sharedOptions:E,includeOptions:x}=this._getSharedOptions(t,r);let w=this._getRotation(),T;for(T=0;T<t;++T)w+=this._circumference(T,o);for(T=t;T<t+n;++T){const O=this._circumference(T,o),N=e[T],A={x:p+this.offsetX,y:g+this.offsetY,startAngle:w,endAngle:w+O,circumference:O,outerRadius:_,innerRadius:v};x&&(A.options=E||this.resolveDataElementOptions(T,N.active?"active":r)),w+=O,this.updateElement(N,T,A,r)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let n=0,r;for(r=0;r<t.length;r++){const o=e._parsed[r];o!==null&&!isNaN(o)&&this.chart.getDataVisibility(r)&&!t[r].hidden&&(n+=Math.abs(o))}return n}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?TAU*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,r=n.data.labels||[],o=formatNumber(t._parsed[e],n.options.locale);return{label:r[e]||"",value:o}}getMaxBorderWidth(e){let t=0;const n=this.chart;let r,o,c,u,h;if(!e){for(r=0,o=n.data.datasets.length;r<o;++r)if(n.isDatasetVisible(r)){c=n.getDatasetMeta(r),e=c.data,u=c.controller;break}}if(!e)return 0;for(r=0,o=e.length;r<o;++r)h=u.resolveDataElementOptions(r),h.borderAlign!=="inner"&&(t=Math.max(t,h.borderWidth||0,h.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let n=0,r=e.length;n<r;++n){const o=this.resolveDataElementOptions(n);t=Math.max(t,o.offset||0,o.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}_getRingWeight(e){return Math.max(valueOrDefault(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}ot(DoughnutController,"id","doughnut"),ot(DoughnutController,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),ot(DoughnutController,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),ot(DoughnutController,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n,color:r}}=e.legend.options;return t.labels.map((o,c)=>{const h=e.getDatasetMeta(0).controller.getStyle(c);return{text:o,fillStyle:h.backgroundColor,strokeStyle:h.borderColor,fontColor:r,lineWidth:h.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(c),index:c}})}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}});function abstract(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class DateAdapterBase{constructor(e){ot(this,"options");this.options=e||{}}static override(e){Object.assign(DateAdapterBase.prototype,e)}init(){}formats(){return abstract()}parse(){return abstract()}format(){return abstract()}add(){return abstract()}diff(){return abstract()}startOf(){return abstract()}endOf(){return abstract()}}var adapters={_date:DateAdapterBase};function binarySearch(s,e,t,n){const{controller:r,data:o,_sorted:c}=s,u=r._cachedMeta.iScale;if(u&&e===u.axis&&e!=="r"&&c&&o.length){const h=u._reversePixels?_rlookupByKey:_lookupByKey;if(n){if(r._sharedOptions){const f=o[0],p=typeof f.getRange=="function"&&f.getRange(e);if(p){const g=h(o,e,t-p),y=h(o,e,t+p);return{lo:g.lo,hi:y.hi}}}}else return h(o,e,t)}return{lo:0,hi:o.length-1}}function evaluateInteractionItems(s,e,t,n,r){const o=s.getSortedVisibleDatasetMetas(),c=t[e];for(let u=0,h=o.length;u<h;++u){const{index:f,data:p}=o[u],{lo:g,hi:y}=binarySearch(o[u],e,c,r);for(let v=g;v<=y;++v){const _=p[v];_.skip||n(_,f,v)}}}function getDistanceMetricForAxis(s){const e=s.indexOf("x")!==-1,t=s.indexOf("y")!==-1;return function(n,r){const o=e?Math.abs(n.x-r.x):0,c=t?Math.abs(n.y-r.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(c,2))}}function getIntersectItems(s,e,t,n,r){const o=[];return!r&&!s.isPointInArea(e)||evaluateInteractionItems(s,t,e,function(u,h,f){!r&&!_isPointInArea(u,s.chartArea,0)||u.inRange(e.x,e.y,n)&&o.push({element:u,datasetIndex:h,index:f})},!0),o}function getNearestRadialItems(s,e,t,n){let r=[];function o(c,u,h){const{startAngle:f,endAngle:p}=c.getProps(["startAngle","endAngle"],n),{angle:g}=getAngleFromPoint(c,{x:e.x,y:e.y});_angleBetween(g,f,p)&&r.push({element:c,datasetIndex:u,index:h})}return evaluateInteractionItems(s,t,e,o),r}function getNearestCartesianItems(s,e,t,n,r,o){let c=[];const u=getDistanceMetricForAxis(t);let h=Number.POSITIVE_INFINITY;function f(p,g,y){const v=p.inRange(e.x,e.y,r);if(n&&!v)return;const _=p.getCenterPoint(r);if(!(!!o||s.isPointInArea(_))&&!v)return;const x=u(e,_);x<h?(c=[{element:p,datasetIndex:g,index:y}],h=x):x===h&&c.push({element:p,datasetIndex:g,index:y})}return evaluateInteractionItems(s,t,e,f),c}function getNearestItems(s,e,t,n,r,o){return!o&&!s.isPointInArea(e)?[]:t==="r"&&!n?getNearestRadialItems(s,e,t,r):getNearestCartesianItems(s,e,t,n,r,o)}function getAxisItems(s,e,t,n,r){const o=[],c=t==="x"?"inXRange":"inYRange";let u=!1;return evaluateInteractionItems(s,t,e,(h,f,p)=>{h[c]&&h[c](e[t],r)&&(o.push({element:h,datasetIndex:f,index:p}),u=u||h.inRange(e.x,e.y,r))}),n&&!u?[]:o}var Interaction={modes:{index(s,e,t,n){const r=getRelativePosition(e,s),o=t.axis||"x",c=t.includeInvisible||!1,u=t.intersect?getIntersectItems(s,r,o,n,c):getNearestItems(s,r,o,!1,n,c),h=[];return u.length?(s.getSortedVisibleDatasetMetas().forEach(f=>{const p=u[0].index,g=f.data[p];g&&!g.skip&&h.push({element:g,datasetIndex:f.index,index:p})}),h):[]},dataset(s,e,t,n){const r=getRelativePosition(e,s),o=t.axis||"xy",c=t.includeInvisible||!1;let u=t.intersect?getIntersectItems(s,r,o,n,c):getNearestItems(s,r,o,!1,n,c);if(u.length>0){const h=u[0].datasetIndex,f=s.getDatasetMeta(h).data;u=[];for(let p=0;p<f.length;++p)u.push({element:f[p],datasetIndex:h,index:p})}return u},point(s,e,t,n){const r=getRelativePosition(e,s),o=t.axis||"xy",c=t.includeInvisible||!1;return getIntersectItems(s,r,o,n,c)},nearest(s,e,t,n){const r=getRelativePosition(e,s),o=t.axis||"xy",c=t.includeInvisible||!1;return getNearestItems(s,r,o,t.intersect,n,c)},x(s,e,t,n){const r=getRelativePosition(e,s);return getAxisItems(s,r,"x",t.intersect,n)},y(s,e,t,n){const r=getRelativePosition(e,s);return getAxisItems(s,r,"y",t.intersect,n)}}};const STATIC_POSITIONS=["left","top","right","bottom"];function filterByPosition(s,e){return s.filter(t=>t.pos===e)}function filterDynamicPositionByAxis(s,e){return s.filter(t=>STATIC_POSITIONS.indexOf(t.pos)===-1&&t.box.axis===e)}function sortByWeight(s,e){return s.sort((t,n)=>{const r=e?n:t,o=e?t:n;return r.weight===o.weight?r.index-o.index:r.weight-o.weight})}function wrapBoxes(s){const e=[];let t,n,r,o,c,u;for(t=0,n=(s||[]).length;t<n;++t)r=s[t],{position:o,options:{stack:c,stackWeight:u=1}}=r,e.push({index:t,box:r,pos:o,horizontal:r.isHorizontal(),weight:r.weight,stack:c&&o+c,stackWeight:u});return e}function buildStacks(s){const e={};for(const t of s){const{stack:n,pos:r,stackWeight:o}=t;if(!n||!STATIC_POSITIONS.includes(r))continue;const c=e[n]||(e[n]={count:0,placed:0,weight:0,size:0});c.count++,c.weight+=o}return e}function setLayoutDims(s,e){const t=buildStacks(s),{vBoxMaxWidth:n,hBoxMaxHeight:r}=e;let o,c,u;for(o=0,c=s.length;o<c;++o){u=s[o];const{fullSize:h}=u.box,f=t[u.stack],p=f&&u.stackWeight/f.weight;u.horizontal?(u.width=p?p*n:h&&e.availableWidth,u.height=r):(u.width=n,u.height=p?p*r:h&&e.availableHeight)}return t}function buildLayoutBoxes(s){const e=wrapBoxes(s),t=sortByWeight(e.filter(f=>f.box.fullSize),!0),n=sortByWeight(filterByPosition(e,"left"),!0),r=sortByWeight(filterByPosition(e,"right")),o=sortByWeight(filterByPosition(e,"top"),!0),c=sortByWeight(filterByPosition(e,"bottom")),u=filterDynamicPositionByAxis(e,"x"),h=filterDynamicPositionByAxis(e,"y");return{fullSize:t,leftAndTop:n.concat(o),rightAndBottom:r.concat(h).concat(c).concat(u),chartArea:filterByPosition(e,"chartArea"),vertical:n.concat(r).concat(h),horizontal:o.concat(c).concat(u)}}function getCombinedMax(s,e,t,n){return Math.max(s[t],e[t])+Math.max(s[n],e[n])}function updateMaxPadding(s,e){s.top=Math.max(s.top,e.top),s.left=Math.max(s.left,e.left),s.bottom=Math.max(s.bottom,e.bottom),s.right=Math.max(s.right,e.right)}function updateDims(s,e,t,n){const{pos:r,box:o}=t,c=s.maxPadding;if(!isObject(r)){t.size&&(s[r]-=t.size);const g=n[t.stack]||{size:0,count:1};g.size=Math.max(g.size,t.horizontal?o.height:o.width),t.size=g.size/g.count,s[r]+=t.size}o.getPadding&&updateMaxPadding(c,o.getPadding());const u=Math.max(0,e.outerWidth-getCombinedMax(c,s,"left","right")),h=Math.max(0,e.outerHeight-getCombinedMax(c,s,"top","bottom")),f=u!==s.w,p=h!==s.h;return s.w=u,s.h=h,t.horizontal?{same:f,other:p}:{same:p,other:f}}function handleMaxPadding(s){const e=s.maxPadding;function t(n){const r=Math.max(e[n]-s[n],0);return s[n]+=r,r}s.y+=t("top"),s.x+=t("left"),t("right"),t("bottom")}function getMargins(s,e){const t=e.maxPadding;function n(r){const o={left:0,top:0,right:0,bottom:0};return r.forEach(c=>{o[c]=Math.max(e[c],t[c])}),o}return n(s?["left","right"]:["top","bottom"])}function fitBoxes(s,e,t,n){const r=[];let o,c,u,h,f,p;for(o=0,c=s.length,f=0;o<c;++o){u=s[o],h=u.box,h.update(u.width||e.w,u.height||e.h,getMargins(u.horizontal,e));const{same:g,other:y}=updateDims(e,t,u,n);f|=g&&r.length,p=p||y,h.fullSize||r.push(u)}return f&&fitBoxes(r,e,t,n)||p}function setBoxDims(s,e,t,n,r){s.top=t,s.left=e,s.right=e+n,s.bottom=t+r,s.width=n,s.height=r}function placeBoxes(s,e,t,n){const r=t.padding;let{x:o,y:c}=e;for(const u of s){const h=u.box,f=n[u.stack]||{placed:0,weight:1},p=u.stackWeight/f.weight||1;if(u.horizontal){const g=e.w*p,y=f.size||h.height;defined(f.start)&&(c=f.start),h.fullSize?setBoxDims(h,r.left,c,t.outerWidth-r.right-r.left,y):setBoxDims(h,e.left+f.placed,c,g,y),f.start=c,f.placed+=g,c=h.bottom}else{const g=e.h*p,y=f.size||h.width;defined(f.start)&&(o=f.start),h.fullSize?setBoxDims(h,o,r.top,y,t.outerHeight-r.bottom-r.top):setBoxDims(h,o,e.top+f.placed,y,g),f.start=o,f.placed+=g,o=h.right}}e.x=o,e.y=c}var layouts={addBox(s,e){s.boxes||(s.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},s.boxes.push(e)},removeBox(s,e){const t=s.boxes?s.boxes.indexOf(e):-1;t!==-1&&s.boxes.splice(t,1)},configure(s,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(s,e,t,n){if(!s)return;const r=toPadding(s.options.layout.padding),o=Math.max(e-r.width,0),c=Math.max(t-r.height,0),u=buildLayoutBoxes(s.boxes),h=u.vertical,f=u.horizontal;each(s.boxes,E=>{typeof E.beforeLayout=="function"&&E.beforeLayout()});const p=h.reduce((E,x)=>x.box.options&&x.box.options.display===!1?E:E+1,0)||1,g=Object.freeze({outerWidth:e,outerHeight:t,padding:r,availableWidth:o,availableHeight:c,vBoxMaxWidth:o/2/p,hBoxMaxHeight:c/2}),y=Object.assign({},r);updateMaxPadding(y,toPadding(n));const v=Object.assign({maxPadding:y,w:o,h:c,x:r.left,y:r.top},r),_=setLayoutDims(h.concat(f),g);fitBoxes(u.fullSize,v,g,_),fitBoxes(h,v,g,_),fitBoxes(f,v,g,_)&&fitBoxes(h,v,g,_),handleMaxPadding(v),placeBoxes(u.leftAndTop,v,g,_),v.x+=v.w,v.y+=v.h,placeBoxes(u.rightAndBottom,v,g,_),s.chartArea={left:v.left,top:v.top,right:v.left+v.w,bottom:v.top+v.h,height:v.h,width:v.w},each(u.chartArea,E=>{const x=E.box;Object.assign(x,s.chartArea),x.update(v.w,v.h,{left:0,top:0,right:0,bottom:0})})}};class BasePlatform{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,r){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,r?Math.floor(t/r):n)}}isAttached(e){return!0}updateConfig(e){}}class BasicPlatform extends BasePlatform{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const EXPANDO_KEY="$chartjs",EVENT_TYPES={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},isNullOrEmpty=s=>s===null||s==="";function initCanvas(s,e){const t=s.style,n=s.getAttribute("height"),r=s.getAttribute("width");if(s[EXPANDO_KEY]={initial:{height:n,width:r,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",isNullOrEmpty(r)){const o=readUsedSize(s,"width");o!==void 0&&(s.width=o)}if(isNullOrEmpty(n))if(s.style.height==="")s.height=s.width/(e||2);else{const o=readUsedSize(s,"height");o!==void 0&&(s.height=o)}return s}const eventListenerOptions=supportsEventListenerOptions?{passive:!0}:!1;function addListener(s,e,t){s&&s.addEventListener(e,t,eventListenerOptions)}function removeListener(s,e,t){s&&s.canvas&&s.canvas.removeEventListener(e,t,eventListenerOptions)}function fromNativeEvent(s,e){const t=EVENT_TYPES[s.type]||s.type,{x:n,y:r}=getRelativePosition(s,e);return{type:t,chart:e,native:s,x:n!==void 0?n:null,y:r!==void 0?r:null}}function nodeListContains(s,e){for(const t of s)if(t===e||t.contains(e))return!0}function createAttachObserver(s,e,t){const n=s.canvas,r=new MutationObserver(o=>{let c=!1;for(const u of o)c=c||nodeListContains(u.addedNodes,n),c=c&&!nodeListContains(u.removedNodes,n);c&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}function createDetachObserver(s,e,t){const n=s.canvas,r=new MutationObserver(o=>{let c=!1;for(const u of o)c=c||nodeListContains(u.removedNodes,n),c=c&&!nodeListContains(u.addedNodes,n);c&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}const drpListeningCharts=new Map;let oldDevicePixelRatio=0;function onWindowResize(){const s=window.devicePixelRatio;s!==oldDevicePixelRatio&&(oldDevicePixelRatio=s,drpListeningCharts.forEach((e,t)=>{t.currentDevicePixelRatio!==s&&e()}))}function listenDevicePixelRatioChanges(s,e){drpListeningCharts.size||window.addEventListener("resize",onWindowResize),drpListeningCharts.set(s,e)}function unlistenDevicePixelRatioChanges(s){drpListeningCharts.delete(s),drpListeningCharts.size||window.removeEventListener("resize",onWindowResize)}function createResizeObserver(s,e,t){const n=s.canvas,r=n&&_getParentNode(n);if(!r)return;const o=throttled((u,h)=>{const f=r.clientWidth;t(u,h),f<r.clientWidth&&t()},window),c=new ResizeObserver(u=>{const h=u[0],f=h.contentRect.width,p=h.contentRect.height;f===0&&p===0||o(f,p)});return c.observe(r),listenDevicePixelRatioChanges(s,o),c}function releaseObserver(s,e,t){t&&t.disconnect(),e==="resize"&&unlistenDevicePixelRatioChanges(s)}function createProxyAndListen(s,e,t){const n=s.canvas,r=throttled(o=>{s.ctx!==null&&t(fromNativeEvent(o,s))},s);return addListener(n,e,r),r}class DomPlatform extends BasePlatform{acquireContext(e,t){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(initCanvas(e,t),n):null}releaseContext(e){const t=e.canvas;if(!t[EXPANDO_KEY])return!1;const n=t[EXPANDO_KEY].initial;["height","width"].forEach(o=>{const c=n[o];isNullOrUndef(c)?t.removeAttribute(o):t.setAttribute(o,c)});const r=n.style||{};return Object.keys(r).forEach(o=>{t.style[o]=r[o]}),t.width=t.width,delete t[EXPANDO_KEY],!0}addEventListener(e,t,n){this.removeEventListener(e,t);const r=e.$proxies||(e.$proxies={}),c={attach:createAttachObserver,detach:createDetachObserver,resize:createResizeObserver}[t]||createProxyAndListen;r[t]=c(e,t,n)}removeEventListener(e,t){const n=e.$proxies||(e.$proxies={}),r=n[t];if(!r)return;({attach:releaseObserver,detach:releaseObserver,resize:releaseObserver}[t]||removeListener)(e,t,r),n[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,r){return getMaximumSize(e,t,n,r)}isAttached(e){const t=e&&_getParentNode(e);return!!(t&&t.isConnected)}}function _detectPlatform(s){return!_isDomSupported()||typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas?BasicPlatform:DomPlatform}class Element{constructor(){ot(this,"x");ot(this,"y");ot(this,"active",!1);ot(this,"options");ot(this,"$animations")}tooltipPosition(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return isNumber(this.x)&&isNumber(this.y)}getProps(e,t){const n=this.$animations;if(!t||!n)return this;const r={};return e.forEach(o=>{r[o]=n[o]&&n[o].active()?n[o]._to:this[o]}),r}}ot(Element,"defaults",{}),ot(Element,"defaultRoutes");function autoSkip(s,e){const t=s.options.ticks,n=determineMaxTicks(s),r=Math.min(t.maxTicksLimit||n,n),o=t.major.enabled?getMajorIndices(e):[],c=o.length,u=o[0],h=o[c-1],f=[];if(c>r)return skipMajors(e,f,o,c/r),f;const p=calculateSpacing(o,e,r);if(c>0){let g,y;const v=c>1?Math.round((h-u)/(c-1)):null;for(skip(e,f,p,isNullOrUndef(v)?0:u-v,u),g=0,y=c-1;g<y;g++)skip(e,f,p,o[g],o[g+1]);return skip(e,f,p,h,isNullOrUndef(v)?e.length:h+v),f}return skip(e,f,p),f}function determineMaxTicks(s){const e=s.options.offset,t=s._tickSize(),n=s._length/t+(e?0:1),r=s._maxLength/t;return Math.floor(Math.min(n,r))}function calculateSpacing(s,e,t){const n=getEvenSpacing(s),r=e.length/t;if(!n)return Math.max(r,1);const o=_factorize(n);for(let c=0,u=o.length-1;c<u;c++){const h=o[c];if(h>r)return h}return Math.max(r,1)}function getMajorIndices(s){const e=[];let t,n;for(t=0,n=s.length;t<n;t++)s[t].major&&e.push(t);return e}function skipMajors(s,e,t,n){let r=0,o=t[0],c;for(n=Math.ceil(n),c=0;c<s.length;c++)c===o&&(e.push(s[c]),r++,o=t[r*n])}function skip(s,e,t,n,r){const o=valueOrDefault(n,0),c=Math.min(valueOrDefault(r,s.length),s.length);let u=0,h,f,p;for(t=Math.ceil(t),r&&(h=r-n,t=h/Math.floor(h/t)),p=o;p<0;)u++,p=Math.round(o+u*t);for(f=Math.max(o,0);f<c;f++)f===p&&(e.push(s[f]),u++,p=Math.round(o+u*t))}function getEvenSpacing(s){const e=s.length;let t,n;if(e<2)return!1;for(n=s[0],t=1;t<e;++t)if(s[t]-s[t-1]!==n)return!1;return n}const reverseAlign=s=>s==="left"?"right":s==="right"?"left":s,offsetFromEdge=(s,e,t)=>e==="top"||e==="left"?s[e]+t:s[e]-t,getTicksLimit=(s,e)=>Math.min(e||s,s);function sample(s,e){const t=[],n=s.length/e,r=s.length;let o=0;for(;o<r;o+=n)t.push(s[Math.floor(o)]);return t}function getPixelForGridLine(s,e,t){const n=s.ticks.length,r=Math.min(e,n-1),o=s._startPixel,c=s._endPixel,u=1e-6;let h=s.getPixelForTick(r),f;if(!(t&&(n===1?f=Math.max(h-o,c-h):e===0?f=(s.getPixelForTick(1)-h)/2:f=(h-s.getPixelForTick(r-1))/2,h+=r<e?f:-f,h<o-u||h>c+u)))return h}function garbageCollect(s,e){each(s,t=>{const n=t.gc,r=n.length/2;let o;if(r>e){for(o=0;o<r;++o)delete t.data[n[o]];n.splice(0,r)}})}function getTickMarkLength(s){return s.drawTicks?s.tickLength:0}function getTitleHeight(s,e){if(!s.display)return 0;const t=toFont(s.font,e),n=toPadding(s.padding);return(isArray(s.text)?s.text.length:1)*t.lineHeight+n.height}function createScaleContext(s,e){return createContext(s,{scale:e,type:"scale"})}function createTickContext(s,e,t){return createContext(s,{tick:t,index:e,type:"tick"})}function titleAlign(s,e,t){let n=_toLeftRightCenter(s);return(t&&e!=="right"||!t&&e==="right")&&(n=reverseAlign(n)),n}function titleArgs(s,e,t,n){const{top:r,left:o,bottom:c,right:u,chart:h}=s,{chartArea:f,scales:p}=h;let g=0,y,v,_;const E=c-r,x=u-o;if(s.isHorizontal()){if(v=_alignStartEnd(n,o,u),isObject(t)){const w=Object.keys(t)[0],T=t[w];_=p[w].getPixelForValue(T)+E-e}else t==="center"?_=(f.bottom+f.top)/2+E-e:_=offsetFromEdge(s,t,e);y=u-o}else{if(isObject(t)){const w=Object.keys(t)[0],T=t[w];v=p[w].getPixelForValue(T)-x+e}else t==="center"?v=(f.left+f.right)/2-x+e:v=offsetFromEdge(s,t,e);_=_alignStartEnd(n,c,r),g=t==="left"?-HALF_PI:HALF_PI}return{titleX:v,titleY:_,maxWidth:y,rotation:g}}class Scale extends Element{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:r}=this;return e=finiteOrDefault(e,Number.POSITIVE_INFINITY),t=finiteOrDefault(t,Number.NEGATIVE_INFINITY),n=finiteOrDefault(n,Number.POSITIVE_INFINITY),r=finiteOrDefault(r,Number.NEGATIVE_INFINITY),{min:finiteOrDefault(e,n),max:finiteOrDefault(t,r),minDefined:isNumberFinite(e),maxDefined:isNumberFinite(t)}}getMinMax(e){let{min:t,max:n,minDefined:r,maxDefined:o}=this.getUserBounds(),c;if(r&&o)return{min:t,max:n};const u=this.getMatchingVisibleMetas();for(let h=0,f=u.length;h<f;++h)c=u[h].controller.getMinMax(this,e),r||(t=Math.min(t,c.min)),o||(n=Math.max(n,c.max));return t=o&&t>n?n:t,n=r&&t>n?t:n,{min:finiteOrDefault(t,finiteOrDefault(n,t)),max:finiteOrDefault(n,finiteOrDefault(t,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){callback(this.options.beforeUpdate,[this])}update(e,t,n){const{beginAtZero:r,grace:o,ticks:c}=this.options,u=c.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=_addGrace(this,o,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const h=u<this.ticks.length;this._convertTicksToLabels(h?sample(this.ticks,u):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),c.display&&(c.autoSkip||c.source==="auto")&&(this.ticks=autoSkip(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),h&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,n;this.isHorizontal()?(t=this.left,n=this.right):(t=this.top,n=this.bottom,e=!e),this._startPixel=t,this._endPixel=n,this._reversePixels=e,this._length=n-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){callback(this.options.afterUpdate,[this])}beforeSetDimensions(){callback(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){callback(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),callback(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){callback(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let n,r,o;for(n=0,r=e.length;n<r;n++)o=e[n],o.label=callback(t.callback,[o.value,n,e],this)}afterTickToLabelConversion(){callback(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){callback(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,n=getTicksLimit(this.ticks.length,e.ticks.maxTicksLimit),r=t.minRotation||0,o=t.maxRotation;let c=r,u,h,f;if(!this._isVisible()||!t.display||r>=o||n<=1||!this.isHorizontal()){this.labelRotation=r;return}const p=this._getLabelSizes(),g=p.widest.width,y=p.highest.height,v=_limitValue(this.chart.width-g,0,this.maxWidth);u=e.offset?this.maxWidth/n:v/(n-1),g+6>u&&(u=v/(n-(e.offset?.5:1)),h=this.maxHeight-getTickMarkLength(e.grid)-t.padding-getTitleHeight(e.title,this.chart.options.font),f=Math.sqrt(g*g+y*y),c=toDegrees(Math.min(Math.asin(_limitValue((p.highest.height+6)/u,-1,1)),Math.asin(_limitValue(h/f,-1,1))-Math.asin(_limitValue(y/f,-1,1)))),c=Math.max(r,Math.min(o,c))),this.labelRotation=c}afterCalculateLabelRotation(){callback(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){callback(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:n,title:r,grid:o}}=this,c=this._isVisible(),u=this.isHorizontal();if(c){const h=getTitleHeight(r,t.options.font);if(u?(e.width=this.maxWidth,e.height=getTickMarkLength(o)+h):(e.height=this.maxHeight,e.width=getTickMarkLength(o)+h),n.display&&this.ticks.length){const{first:f,last:p,widest:g,highest:y}=this._getLabelSizes(),v=n.padding*2,_=toRadians(this.labelRotation),E=Math.cos(_),x=Math.sin(_);if(u){const w=n.mirror?0:x*g.width+E*y.height;e.height=Math.min(this.maxHeight,e.height+w+v)}else{const w=n.mirror?0:E*g.width+x*y.height;e.width=Math.min(this.maxWidth,e.width+w+v)}this._calculatePadding(f,p,x,E)}}this._handleMargins(),u?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,n,r){const{ticks:{align:o,padding:c},position:u}=this.options,h=this.labelRotation!==0,f=u!=="top"&&this.axis==="x";if(this.isHorizontal()){const p=this.getPixelForTick(0)-this.left,g=this.right-this.getPixelForTick(this.ticks.length-1);let y=0,v=0;h?f?(y=r*e.width,v=n*t.height):(y=n*e.height,v=r*t.width):o==="start"?v=t.width:o==="end"?y=e.width:o!=="inner"&&(y=e.width/2,v=t.width/2),this.paddingLeft=Math.max((y-p+c)*this.width/(this.width-p),0),this.paddingRight=Math.max((v-g+c)*this.width/(this.width-g),0)}else{let p=t.height/2,g=e.height/2;o==="start"?(p=0,g=e.height):o==="end"&&(p=t.height,g=0),this.paddingTop=p+c,this.paddingBottom=g+c}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){callback(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,n;for(t=0,n=e.length;t<n;t++)isNullOrUndef(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let n=this.ticks;t<n.length&&(n=sample(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,n){const{ctx:r,_longestTextCache:o}=this,c=[],u=[],h=Math.floor(t/getTicksLimit(t,n));let f=0,p=0,g,y,v,_,E,x,w,T,O,N,A;for(g=0;g<t;g+=h){if(_=e[g].label,E=this._resolveTickFontOptions(g),r.font=x=E.string,w=o[x]=o[x]||{data:{},gc:[]},T=E.lineHeight,O=N=0,!isNullOrUndef(_)&&!isArray(_))O=_measureText(r,w.data,w.gc,O,_),N=T;else if(isArray(_))for(y=0,v=_.length;y<v;++y)A=_[y],!isNullOrUndef(A)&&!isArray(A)&&(O=_measureText(r,w.data,w.gc,O,A),N+=T);c.push(O),u.push(N),f=Math.max(O,f),p=Math.max(N,p)}garbageCollect(o,t);const I=c.indexOf(f),k=u.indexOf(p),M=L=>({width:c[L]||0,height:u[L]||0});return{first:M(0),last:M(t-1),widest:M(I),highest:M(k),widths:c,heights:u}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return _int16Range(this._alignToPixels?_alignPixel(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const n=t[e];return n.$context||(n.$context=createTickContext(this.getContext(),e,n))}return this.$context||(this.$context=createScaleContext(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=toRadians(this.labelRotation),n=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t)),o=this._getLabelSizes(),c=e.autoSkipPadding||0,u=o?o.widest.width+c:0,h=o?o.highest.height+c:0;return this.isHorizontal()?h*n>u*r?u/n:h/r:h*r<u*n?h/n:u/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,n=this.chart,r=this.options,{grid:o,position:c,border:u}=r,h=o.offset,f=this.isHorizontal(),g=this.ticks.length+(h?1:0),y=getTickMarkLength(o),v=[],_=u.setContext(this.getContext()),E=_.display?_.width:0,x=E/2,w=function(Z){return _alignPixel(n,Z,E)};let T,O,N,A,I,k,M,L,H,D,q,J;if(c==="top")T=w(this.bottom),k=this.bottom-y,L=T-x,D=w(e.top)+x,J=e.bottom;else if(c==="bottom")T=w(this.top),D=e.top,J=w(e.bottom)-x,k=T+x,L=this.top+y;else if(c==="left")T=w(this.right),I=this.right-y,M=T-x,H=w(e.left)+x,q=e.right;else if(c==="right")T=w(this.left),H=e.left,q=w(e.right)-x,I=T+x,M=this.left+y;else if(t==="x"){if(c==="center")T=w((e.top+e.bottom)/2+.5);else if(isObject(c)){const Z=Object.keys(c)[0],G=c[Z];T=w(this.chart.scales[Z].getPixelForValue(G))}D=e.top,J=e.bottom,k=T+x,L=k+y}else if(t==="y"){if(c==="center")T=w((e.left+e.right)/2);else if(isObject(c)){const Z=Object.keys(c)[0],G=c[Z];T=w(this.chart.scales[Z].getPixelForValue(G))}I=T-x,M=I-y,H=e.left,q=e.right}const ae=valueOrDefault(r.ticks.maxTicksLimit,g),V=Math.max(1,Math.ceil(g/ae));for(O=0;O<g;O+=V){const Z=this.getContext(O),G=o.setContext(Z),ne=u.setContext(Z),B=G.lineWidth,F=G.color,Y=ne.dash||[],U=ne.dashOffset,C=G.tickWidth,P=G.tickColor,$=G.tickBorderDash||[],W=G.tickBorderDashOffset;N=getPixelForGridLine(this,O,h),N!==void 0&&(A=_alignPixel(n,N,B),f?I=M=H=q=A:k=L=D=J=A,v.push({tx1:I,ty1:k,tx2:M,ty2:L,x1:H,y1:D,x2:q,y2:J,width:B,color:F,borderDash:Y,borderDashOffset:U,tickWidth:C,tickColor:P,tickBorderDash:$,tickBorderDashOffset:W}))}return this._ticksLength=g,this._borderValue=T,v}_computeLabelItems(e){const t=this.axis,n=this.options,{position:r,ticks:o}=n,c=this.isHorizontal(),u=this.ticks,{align:h,crossAlign:f,padding:p,mirror:g}=o,y=getTickMarkLength(n.grid),v=y+p,_=g?-p:v,E=-toRadians(this.labelRotation),x=[];let w,T,O,N,A,I,k,M,L,H,D,q,J="middle";if(r==="top")I=this.bottom-_,k=this._getXAxisLabelAlignment();else if(r==="bottom")I=this.top+_,k=this._getXAxisLabelAlignment();else if(r==="left"){const V=this._getYAxisLabelAlignment(y);k=V.textAlign,A=V.x}else if(r==="right"){const V=this._getYAxisLabelAlignment(y);k=V.textAlign,A=V.x}else if(t==="x"){if(r==="center")I=(e.top+e.bottom)/2+v;else if(isObject(r)){const V=Object.keys(r)[0],Z=r[V];I=this.chart.scales[V].getPixelForValue(Z)+v}k=this._getXAxisLabelAlignment()}else if(t==="y"){if(r==="center")A=(e.left+e.right)/2-v;else if(isObject(r)){const V=Object.keys(r)[0],Z=r[V];A=this.chart.scales[V].getPixelForValue(Z)}k=this._getYAxisLabelAlignment(y).textAlign}t==="y"&&(h==="start"?J="top":h==="end"&&(J="bottom"));const ae=this._getLabelSizes();for(w=0,T=u.length;w<T;++w){O=u[w],N=O.label;const V=o.setContext(this.getContext(w));M=this.getPixelForTick(w)+o.labelOffset,L=this._resolveTickFontOptions(w),H=L.lineHeight,D=isArray(N)?N.length:1;const Z=D/2,G=V.color,ne=V.textStrokeColor,B=V.textStrokeWidth;let F=k;c?(A=M,k==="inner"&&(w===T-1?F=this.options.reverse?"left":"right":w===0?F=this.options.reverse?"right":"left":F="center"),r==="top"?f==="near"||E!==0?q=-D*H+H/2:f==="center"?q=-ae.highest.height/2-Z*H+H:q=-ae.highest.height+H/2:f==="near"||E!==0?q=H/2:f==="center"?q=ae.highest.height/2-Z*H:q=ae.highest.height-D*H,g&&(q*=-1),E!==0&&!V.showLabelBackdrop&&(A+=H/2*Math.sin(E))):(I=M,q=(1-D)*H/2);let Y;if(V.showLabelBackdrop){const U=toPadding(V.backdropPadding),C=ae.heights[w],P=ae.widths[w];let $=q-U.top,W=0-U.left;switch(J){case"middle":$-=C/2;break;case"bottom":$-=C;break}switch(k){case"center":W-=P/2;break;case"right":W-=P;break;case"inner":w===T-1?W-=P:w>0&&(W-=P/2);break}Y={left:W,top:$,width:P+U.width,height:C+U.height,color:V.backdropColor}}x.push({label:N,font:L,textOffset:q,options:{rotation:E,color:G,strokeColor:ne,strokeWidth:B,textAlign:F,textBaseline:J,translation:[A,I],backdrop:Y}})}return x}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-toRadians(this.labelRotation))return e==="top"?"left":"right";let r="center";return t.align==="start"?r="left":t.align==="end"?r="right":t.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:n,mirror:r,padding:o}}=this.options,c=this._getLabelSizes(),u=e+o,h=c.widest.width;let f,p;return t==="left"?r?(p=this.right+o,n==="near"?f="left":n==="center"?(f="center",p+=h/2):(f="right",p+=h)):(p=this.right-u,n==="near"?f="right":n==="center"?(f="center",p-=h/2):(f="left",p=this.left)):t==="right"?r?(p=this.left+o,n==="near"?f="right":n==="center"?(f="center",p-=h/2):(f="left",p-=h)):(p=this.left+u,n==="near"?f="left":n==="center"?(f="center",p+=h/2):(f="right",p=this.right)):f="right",{textAlign:f,x:p}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:n,top:r,width:o,height:c}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,r,o,c),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const r=this.ticks.findIndex(o=>o.value===e);return r>=0?t.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const t=this.options.grid,n=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let o,c;const u=(h,f,p)=>{!p.width||!p.color||(n.save(),n.lineWidth=p.width,n.strokeStyle=p.color,n.setLineDash(p.borderDash||[]),n.lineDashOffset=p.borderDashOffset,n.beginPath(),n.moveTo(h.x,h.y),n.lineTo(f.x,f.y),n.stroke(),n.restore())};if(t.display)for(o=0,c=r.length;o<c;++o){const h=r[o];t.drawOnChartArea&&u({x:h.x1,y:h.y1},{x:h.x2,y:h.y2},h),t.drawTicks&&u({x:h.tx1,y:h.ty1},{x:h.tx2,y:h.ty2},{color:h.tickColor,width:h.tickWidth,borderDash:h.tickBorderDash,borderDashOffset:h.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:n,grid:r}}=this,o=n.setContext(this.getContext()),c=n.display?o.width:0;if(!c)return;const u=r.setContext(this.getContext(0)).lineWidth,h=this._borderValue;let f,p,g,y;this.isHorizontal()?(f=_alignPixel(e,this.left,c)-c/2,p=_alignPixel(e,this.right,u)+u/2,g=y=h):(g=_alignPixel(e,this.top,c)-c/2,y=_alignPixel(e,this.bottom,u)+u/2,f=p=h),t.save(),t.lineWidth=o.width,t.strokeStyle=o.color,t.beginPath(),t.moveTo(f,g),t.lineTo(p,y),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const n=this.ctx,r=this._computeLabelArea();r&&clipArea(n,r);const o=this.getLabelItems(e);for(const c of o){const u=c.options,h=c.font,f=c.label,p=c.textOffset;renderText(n,f,0,p,h,u)}r&&unclipArea(n)}drawTitle(){const{ctx:e,options:{position:t,title:n,reverse:r}}=this;if(!n.display)return;const o=toFont(n.font),c=toPadding(n.padding),u=n.align;let h=o.lineHeight/2;t==="bottom"||t==="center"||isObject(t)?(h+=c.bottom,isArray(n.text)&&(h+=o.lineHeight*(n.text.length-1))):h+=c.top;const{titleX:f,titleY:p,maxWidth:g,rotation:y}=titleArgs(this,h,t,u);renderText(e,n.text,0,0,o,{color:n.color,maxWidth:g,rotation:y,textAlign:titleAlign(u,t,r),textBaseline:"middle",translation:[f,p]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,n=valueOrDefault(e.grid&&e.grid.z,-1),r=valueOrDefault(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Scale.prototype.draw?[{z:t,draw:o=>{this.draw(o)}}]:[{z:n,draw:o=>{this.drawBackground(),this.drawGrid(o),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:t,draw:o=>{this.drawLabels(o)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",r=[];let o,c;for(o=0,c=t.length;o<c;++o){const u=t[o];u[n]===this.id&&(!e||u.type===e)&&r.push(u)}return r}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return toFont(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class TypedRegistry{constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let n;isIChartComponent(t)&&(n=this.register(t));const r=this.items,o=e.id,c=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+e);return o in r||(r[o]=e,registerDefaults(e,c,n),this.override&&defaults.override(e.id,e.overrides)),c}get(e){return this.items[e]}unregister(e){const t=this.items,n=e.id,r=this.scope;n in t&&delete t[n],r&&n in defaults[r]&&(delete defaults[r][n],this.override&&delete overrides[n])}}function registerDefaults(s,e,t){const n=merge(Object.create(null),[t?defaults.get(t):{},defaults.get(e),s.defaults]);defaults.set(e,n),s.defaultRoutes&&routeDefaults(e,s.defaultRoutes),s.descriptors&&defaults.describe(e,s.descriptors)}function routeDefaults(s,e){Object.keys(e).forEach(t=>{const n=t.split("."),r=n.pop(),o=[s].concat(n).join("."),c=e[t].split("."),u=c.pop(),h=c.join(".");defaults.route(o,r,h,u)})}function isIChartComponent(s){return"id"in s&&"defaults"in s}class Registry{constructor(){this.controllers=new TypedRegistry(DatasetController,"datasets",!0),this.elements=new TypedRegistry(Element,"elements"),this.plugins=new TypedRegistry(Object,"plugins"),this.scales=new TypedRegistry(Scale,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,n){[...t].forEach(r=>{const o=n||this._getRegistryForType(r);n||o.isForType(r)||o===this.plugins&&r.id?this._exec(e,o,r):each(r,c=>{const u=n||this._getRegistryForType(c);this._exec(e,u,c)})})}_exec(e,t,n){const r=_capitalize(e);callback(n["before"+r],[],n),t[e](n),callback(n["after"+r],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){const r=t.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+n+".");return r}}var registry=new Registry;class PluginService{constructor(){this._init=[]}notify(e,t,n,r){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const o=r?this._descriptors(e).filter(r):this._descriptors(e),c=this._notify(o,e,t,n);return t==="afterDestroy"&&(this._notify(o,e,"stop"),this._notify(this._init,e,"uninstall")),c}_notify(e,t,n,r){r=r||{};for(const o of e){const c=o.plugin,u=c[n],h=[t,r,o.options];if(callback(u,h,c)===!1&&r.cancelable)return!1}return!0}invalidate(){isNullOrUndef(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const n=e&&e.config,r=valueOrDefault(n.options&&n.options.plugins,{}),o=allPlugins(n);return r===!1&&!t?[]:createDescriptors(e,o,r,t)}_notifyStateChanges(e){const t=this._oldCache||[],n=this._cache,r=(o,c)=>o.filter(u=>!c.some(h=>u.plugin.id===h.plugin.id));this._notify(r(t,n),e,"stop"),this._notify(r(n,t),e,"start")}}function allPlugins(s){const e={},t=[],n=Object.keys(registry.plugins.items);for(let o=0;o<n.length;o++)t.push(registry.getPlugin(n[o]));const r=s.plugins||[];for(let o=0;o<r.length;o++){const c=r[o];t.indexOf(c)===-1&&(t.push(c),e[c.id]=!0)}return{plugins:t,localIds:e}}function getOpts(s,e){return!e&&s===!1?null:s===!0?{}:s}function createDescriptors(s,{plugins:e,localIds:t},n,r){const o=[],c=s.getContext();for(const u of e){const h=u.id,f=getOpts(n[h],r);f!==null&&o.push({plugin:u,options:pluginOpts(s.config,{plugin:u,local:t[h]},f,c)})}return o}function pluginOpts(s,{plugin:e,local:t},n,r){const o=s.pluginScopeKeys(e),c=s.getOptionScopes(n,o);return t&&e.defaults&&c.push(e.defaults),s.createResolver(c,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function getIndexAxis(s,e){const t=defaults.datasets[s]||{};return((e.datasets||{})[s]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function getAxisFromDefaultScaleID(s,e){let t=s;return s==="_index_"?t=e:s==="_value_"&&(t=e==="x"?"y":"x"),t}function getDefaultScaleIDFromAxis(s,e){return s===e?"_index_":"_value_"}function idMatchesAxis(s){if(s==="x"||s==="y"||s==="r")return s}function axisFromPosition(s){if(s==="top"||s==="bottom")return"x";if(s==="left"||s==="right")return"y"}function determineAxis(s,...e){if(idMatchesAxis(s))return s;for(const t of e){const n=t.axis||axisFromPosition(t.position)||s.length>1&&idMatchesAxis(s[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${s}' axis. Please provide 'axis' or 'position' option.`)}function getAxisFromDataset(s,e,t){if(t[e+"AxisID"]===s)return{axis:e}}function retrieveAxisFromDatasets(s,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(n=>n.xAxisID===s||n.yAxisID===s);if(t.length)return getAxisFromDataset(s,"x",t[0])||getAxisFromDataset(s,"y",t[0])}return{}}function mergeScaleConfig(s,e){const t=overrides[s.type]||{scales:{}},n=e.scales||{},r=getIndexAxis(s.type,e),o=Object.create(null);return Object.keys(n).forEach(c=>{const u=n[c];if(!isObject(u))return console.error(`Invalid scale configuration for scale: ${c}`);if(u._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${c}`);const h=determineAxis(c,u,retrieveAxisFromDatasets(c,s),defaults.scales[u.type]),f=getDefaultScaleIDFromAxis(h,r),p=t.scales||{};o[c]=mergeIf(Object.create(null),[{axis:h},u,p[h],p[f]])}),s.data.datasets.forEach(c=>{const u=c.type||s.type,h=c.indexAxis||getIndexAxis(u,e),p=(overrides[u]||{}).scales||{};Object.keys(p).forEach(g=>{const y=getAxisFromDefaultScaleID(g,h),v=c[y+"AxisID"]||y;o[v]=o[v]||Object.create(null),mergeIf(o[v],[{axis:y},n[v],p[g]])})}),Object.keys(o).forEach(c=>{const u=o[c];mergeIf(u,[defaults.scales[u.type],defaults.scale])}),o}function initOptions(s){const e=s.options||(s.options={});e.plugins=valueOrDefault(e.plugins,{}),e.scales=mergeScaleConfig(s,e)}function initData(s){return s=s||{},s.datasets=s.datasets||[],s.labels=s.labels||[],s}function initConfig(s){return s=s||{},s.data=initData(s.data),initOptions(s),s}const keyCache=new Map,keysCached=new Set;function cachedKeys(s,e){let t=keyCache.get(s);return t||(t=e(),keyCache.set(s,t),keysCached.add(t)),t}const addIfFound=(s,e,t)=>{const n=resolveObjectKey(e,t);n!==void 0&&s.add(n)};class Config{constructor(e){this._config=initConfig(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=initData(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),initOptions(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return cachedKeys(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return cachedKeys(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return cachedKeys(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,n=this.type;return cachedKeys(`${n}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const n=this._scopeCache;let r=n.get(e);return(!r||t)&&(r=new Map,n.set(e,r)),r}getOptionScopes(e,t,n){const{options:r,type:o}=this,c=this._cachedScopes(e,n),u=c.get(t);if(u)return u;const h=new Set;t.forEach(p=>{e&&(h.add(e),p.forEach(g=>addIfFound(h,e,g))),p.forEach(g=>addIfFound(h,r,g)),p.forEach(g=>addIfFound(h,overrides[o]||{},g)),p.forEach(g=>addIfFound(h,defaults,g)),p.forEach(g=>addIfFound(h,descriptors,g))});const f=Array.from(h);return f.length===0&&f.push(Object.create(null)),keysCached.has(t)&&c.set(t,f),f}chartOptionScopes(){const{options:e,type:t}=this;return[e,overrides[t]||{},defaults.datasets[t]||{},{type:t},defaults,descriptors]}resolveNamedOptions(e,t,n,r=[""]){const o={$shared:!0},{resolver:c,subPrefixes:u}=getResolver(this._resolverCache,e,r);let h=c;if(needContext(c,t)){o.$shared=!1,n=isFunction(n)?n():n;const f=this.createResolver(e,n,u);h=_attachContext(c,n,f)}for(const f of t)o[f]=h[f];return o}createResolver(e,t,n=[""],r){const{resolver:o}=getResolver(this._resolverCache,e,n);return isObject(t)?_attachContext(o,t,void 0,r):o}}function getResolver(s,e,t){let n=s.get(e);n||(n=new Map,s.set(e,n));const r=t.join();let o=n.get(r);return o||(o={resolver:_createResolver(e,t),subPrefixes:t.filter(u=>!u.toLowerCase().includes("hover"))},n.set(r,o)),o}const hasFunction=s=>isObject(s)&&Object.getOwnPropertyNames(s).some(e=>isFunction(s[e]));function needContext(s,e){const{isScriptable:t,isIndexable:n}=_descriptors(s);for(const r of e){const o=t(r),c=n(r),u=(c||o)&&s[r];if(o&&(isFunction(u)||hasFunction(u))||c&&isArray(u))return!0}return!1}var version="4.4.7";const KNOWN_POSITIONS=["top","bottom","left","right","chartArea"];function positionIsHorizontal(s,e){return s==="top"||s==="bottom"||KNOWN_POSITIONS.indexOf(s)===-1&&e==="x"}function compare2Level(s,e){return function(t,n){return t[s]===n[s]?t[e]-n[e]:t[s]-n[s]}}function onAnimationsComplete(s){const e=s.chart,t=e.options.animation;e.notifyPlugins("afterRender"),callback(t&&t.onComplete,[s],e)}function onAnimationProgress(s){const e=s.chart,t=e.options.animation;callback(t&&t.onProgress,[s],e)}function getCanvas(s){return _isDomSupported()&&typeof s=="string"?s=document.getElementById(s):s&&s.length&&(s=s[0]),s&&s.canvas&&(s=s.canvas),s}const instances={},getChart=s=>{const e=getCanvas(s);return Object.values(instances).filter(t=>t.canvas===e).pop()};function moveNumericKeys(s,e,t){const n=Object.keys(s);for(const r of n){const o=+r;if(o>=e){const c=s[r];delete s[r],(t>0||o>e)&&(s[o+t]=c)}}}function determineLastEvent(s,e,t,n){return!t||s.type==="mouseout"?null:n?e:s}function getSizeForArea(s,e,t){return s.options.clip?s[t]:e[t]}function getDatasetArea(s,e){const{xScale:t,yScale:n}=s;return t&&n?{left:getSizeForArea(t,e,"left"),right:getSizeForArea(t,e,"right"),top:getSizeForArea(n,e,"top"),bottom:getSizeForArea(n,e,"bottom")}:e}var Ci;let Chart$1=(Ci=class{static register(...e){registry.add(...e),invalidatePlugins()}static unregister(...e){registry.remove(...e),invalidatePlugins()}constructor(e,t){const n=this.config=new Config(t),r=getCanvas(e),o=getChart(r);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const c=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||_detectPlatform(r)),this.platform.updateConfig(n);const u=this.platform.acquireContext(r,c.aspectRatio),h=u&&u.canvas,f=h&&h.height,p=h&&h.width;if(this.id=uid(),this.ctx=u,this.canvas=h,this.width=p,this.height=f,this._options=c,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new PluginService,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=debounce(g=>this.update(g),c.resizeDelay||0),this._dataChanges=[],instances[this.id]=this,!u||!h){console.error("Failed to create chart: can't acquire context from the given item");return}animator.listen(this,"complete",onAnimationsComplete),animator.listen(this,"progress",onAnimationProgress),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:r,_aspectRatio:o}=this;return isNullOrUndef(e)?t&&o?o:r?n/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return registry}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():retinaScale(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return clearCanvas(this.canvas,this.ctx),this}stop(){return animator.stop(this),this}resize(e,t){animator.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const n=this.options,r=this.canvas,o=n.maintainAspectRatio&&this.aspectRatio,c=this.platform.getMaximumSize(r,e,t,o),u=n.devicePixelRatio||this.platform.getDevicePixelRatio(),h=this.width?"resize":"attach";this.width=c.width,this.height=c.height,this._aspectRatio=this.aspectRatio,retinaScale(this,u,!0)&&(this.notifyPlugins("resize",{size:c}),callback(n.onResize,[this,c],this),this.attached&&this._doResize(h)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};each(t,(n,r)=>{n.id=r})}buildOrUpdateScales(){const e=this.options,t=e.scales,n=this.scales,r=Object.keys(n).reduce((c,u)=>(c[u]=!1,c),{});let o=[];t&&(o=o.concat(Object.keys(t).map(c=>{const u=t[c],h=determineAxis(c,u),f=h==="r",p=h==="x";return{options:u,dposition:f?"chartArea":p?"bottom":"left",dtype:f?"radialLinear":p?"category":"linear"}}))),each(o,c=>{const u=c.options,h=u.id,f=determineAxis(h,u),p=valueOrDefault(u.type,c.dtype);(u.position===void 0||positionIsHorizontal(u.position,f)!==positionIsHorizontal(c.dposition))&&(u.position=c.dposition),r[h]=!0;let g=null;if(h in n&&n[h].type===p)g=n[h];else{const y=registry.getScale(p);g=new y({id:h,type:p,ctx:this.ctx,chart:this}),n[g.id]=g}g.init(u,e)}),each(r,(c,u)=>{c||delete n[u]}),each(n,c=>{layouts.configure(this,c,c.options),layouts.addBox(this,c)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort((r,o)=>r.index-o.index),n>t){for(let r=t;r<n;++r)this._destroyDatasetMeta(r);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(compare2Level("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((n,r)=>{t.filter(o=>o===n._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let n,r;for(this._removeUnreferencedMetasets(),n=0,r=t.length;n<r;n++){const o=t[n];let c=this.getDatasetMeta(n);const u=o.type||this.config.type;if(c.type&&c.type!==u&&(this._destroyDatasetMeta(n),c=this.getDatasetMeta(n)),c.type=u,c.indexAxis=o.indexAxis||getIndexAxis(u,this.options),c.order=o.order||0,c.index=n,c.label=""+o.label,c.visible=this.isDatasetVisible(n),c.controller)c.controller.updateIndex(n),c.controller.linkScales();else{const h=registry.getController(u),{datasetElementType:f,dataElementType:p}=defaults.datasets[u];Object.assign(h,{dataElementType:registry.getElement(p),datasetElementType:f&&registry.getElement(f)}),c.controller=new h(this,n),e.push(c.controller)}}return this._updateMetasets(),e}_resetElements(){each(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let c=0;for(let f=0,p=this.data.datasets.length;f<p;f++){const{controller:g}=this.getDatasetMeta(f),y=!r&&o.indexOf(g)===-1;g.buildOrUpdateElements(y),c=Math.max(+g.getMaxOverflow(),c)}c=this._minPadding=n.layout.autoPadding?c:0,this._updateLayout(c),r||each(o,f=>{f.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(compare2Level("z","_idx"));const{_active:u,_lastEvent:h}=this;h?this._eventHandler(h,!0):u.length&&this._updateHoverStyles(u,u,!0),this.render()}_updateScales(){each(this.scales,e=>{layouts.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);(!setsEqual(t,n)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:n,start:r,count:o}of t){const c=n==="_removeElements"?-o:o;moveNumericKeys(e,r,c)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,n=o=>new Set(e.filter(c=>c[0]===o).map((c,u)=>u+","+c.splice(1).join(","))),r=n(0);for(let o=1;o<t;o++)if(!setsEqual(r,n(o)))return;return Array.from(r).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;layouts.update(this,this.width,this.height,e);const t=this.chartArea,n=t.width<=0||t.height<=0;this._layers=[],each(this.boxes,r=>{n&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,o)=>{r._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,n=this.data.datasets.length;t<n;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,n=this.data.datasets.length;t<n;++t)this._updateDataset(t,isFunction(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const n=this.getDatasetMeta(e),r={meta:n,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(n.controller._update(t),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(animator.has(this)?this.attached&&!animator.running(this)&&animator.start(this):(this.draw(),onAnimationsComplete({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:n,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,n=[];let r,o;for(r=0,o=t.length;r<o;++r){const c=t[r];(!e||c.visible)&&n.push(c)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,n=e._clip,r=!n.disabled,o=getDatasetArea(e,this.chartArea),c={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",c)!==!1&&(r&&clipArea(t,{left:n.left===!1?0:o.left-n.left,right:n.right===!1?this.width:o.right+n.right,top:n.top===!1?0:o.top-n.top,bottom:n.bottom===!1?this.height:o.bottom+n.bottom}),e.controller.draw(),r&&unclipArea(t),c.cancelable=!1,this.notifyPlugins("afterDatasetDraw",c))}isPointInArea(e){return _isPointInArea(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,n,r){const o=Interaction.modes[t];return typeof o=="function"?o(this,e,n,r):[]}getDatasetMeta(e){const t=this.data.datasets[e],n=this._metasets;let r=n.filter(o=>o&&o._dataset===t).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(r)),r}getContext(){return this.$context||(this.$context=createContext(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const n=this.getDatasetMeta(e);return typeof n.hidden=="boolean"?!n.hidden:!t.hidden}setDatasetVisibility(e,t){const n=this.getDatasetMeta(e);n.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){const r=n?"show":"hide",o=this.getDatasetMeta(e),c=o.controller._resolveAnimations(void 0,r);defined(t)?(o.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),c.update(o,{visible:n}),this.update(u=>u.datasetIndex===e?r:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),animator.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),clearCanvas(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete instances[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,n=(o,c)=>{t.addEventListener(this,o,c),e[o]=c},r=(o,c,u)=>{o.offsetX=c,o.offsetY=u,this._eventHandler(o)};each(this.options.events,o=>n(o,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,n=(h,f)=>{t.addEventListener(this,h,f),e[h]=f},r=(h,f)=>{e[h]&&(t.removeEventListener(this,h,f),delete e[h])},o=(h,f)=>{this.canvas&&this.resize(h,f)};let c;const u=()=>{r("attach",u),this.attached=!0,this.resize(),n("resize",o),n("detach",c)};c=()=>{this.attached=!1,r("resize",o),this._stop(),this._resize(0,0),n("attach",u)},t.isAttached(this.canvas)?u():c()}unbindEvents(){each(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},each(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,n){const r=n?"set":"remove";let o,c,u,h;for(t==="dataset"&&(o=this.getDatasetMeta(e[0].datasetIndex),o.controller["_"+r+"DatasetHoverStyle"]()),u=0,h=e.length;u<h;++u){c=e[u];const f=c&&this.getDatasetMeta(c.datasetIndex).controller;f&&f[r+"HoverStyle"](c.element,c.datasetIndex,c.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],n=e.map(({datasetIndex:o,index:c})=>{const u=this.getDatasetMeta(o);if(!u)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:u.data[c],index:c}});!_elementsEqual(n,t)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,t))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,n){const r=this.options.hover,o=(h,f)=>h.filter(p=>!f.some(g=>p.datasetIndex===g.datasetIndex&&p.index===g.index)),c=o(t,e),u=n?e:o(e,t);c.length&&this.updateHoverStyle(c,r.mode,!1),u.length&&r.mode&&this.updateHoverStyle(u,r.mode,!0)}_eventHandler(e,t){const n={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},r=c=>(c.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",n,r)===!1)return;const o=this._handleEvent(e,t,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,r),(o||n.changed)&&this.render(),this}_handleEvent(e,t,n){const{_active:r=[],options:o}=this,c=t,u=this._getActiveElements(e,r,n,c),h=_isClickEvent(e),f=determineLastEvent(e,this._lastEvent,n,h);n&&(this._lastEvent=null,callback(o.onHover,[e,u,this],this),h&&callback(o.onClick,[e,u,this],this));const p=!_elementsEqual(u,r);return(p||t)&&(this._active=u,this._updateHoverStyles(u,r,t)),this._lastEvent=f,p}_getActiveElements(e,t,n,r){if(e.type==="mouseout")return[];if(!n)return t;const o=this.options.hover;return this.getElementsAtEventForMode(e,o.mode,o,r)}},ot(Ci,"defaults",defaults),ot(Ci,"instances",instances),ot(Ci,"overrides",overrides),ot(Ci,"registry",registry),ot(Ci,"version",version),ot(Ci,"getChart",getChart),Ci);function invalidatePlugins(){return each(Chart$1.instances,s=>s._plugins.invalidate())}function clipArc(s,e,t){const{startAngle:n,pixelMargin:r,x:o,y:c,outerRadius:u,innerRadius:h}=e;let f=r/u;s.beginPath(),s.arc(o,c,u,n-f,t+f),h>r?(f=r/h,s.arc(o,c,h,t+f,n-f,!0)):s.arc(o,c,r,t+HALF_PI,n-HALF_PI),s.closePath(),s.clip()}function toRadiusCorners(s){return _readValueToProps(s,["outerStart","outerEnd","innerStart","innerEnd"])}function parseBorderRadius$1(s,e,t,n){const r=toRadiusCorners(s.options.borderRadius),o=(t-e)/2,c=Math.min(o,n*e/2),u=h=>{const f=(t-Math.min(o,h))*n/2;return _limitValue(h,0,Math.min(o,f))};return{outerStart:u(r.outerStart),outerEnd:u(r.outerEnd),innerStart:_limitValue(r.innerStart,0,c),innerEnd:_limitValue(r.innerEnd,0,c)}}function rThetaToXY(s,e,t,n){return{x:t+s*Math.cos(e),y:n+s*Math.sin(e)}}function pathArc(s,e,t,n,r,o){const{x:c,y:u,startAngle:h,pixelMargin:f,innerRadius:p}=e,g=Math.max(e.outerRadius+n+t-f,0),y=p>0?p+n+t+f:0;let v=0;const _=r-h;if(n){const V=p>0?p-n:0,Z=g>0?g-n:0,G=(V+Z)/2,ne=G!==0?_*G/(G+n):_;v=(_-ne)/2}const E=Math.max(.001,_*g-t/PI)/g,x=(_-E)/2,w=h+x+v,T=r-x-v,{outerStart:O,outerEnd:N,innerStart:A,innerEnd:I}=parseBorderRadius$1(e,y,g,T-w),k=g-O,M=g-N,L=w+O/k,H=T-N/M,D=y+A,q=y+I,J=w+A/D,ae=T-I/q;if(s.beginPath(),o){const V=(L+H)/2;if(s.arc(c,u,g,L,V),s.arc(c,u,g,V,H),N>0){const B=rThetaToXY(M,H,c,u);s.arc(B.x,B.y,N,H,T+HALF_PI)}const Z=rThetaToXY(q,T,c,u);if(s.lineTo(Z.x,Z.y),I>0){const B=rThetaToXY(q,ae,c,u);s.arc(B.x,B.y,I,T+HALF_PI,ae+Math.PI)}const G=(T-I/y+(w+A/y))/2;if(s.arc(c,u,y,T-I/y,G,!0),s.arc(c,u,y,G,w+A/y,!0),A>0){const B=rThetaToXY(D,J,c,u);s.arc(B.x,B.y,A,J+Math.PI,w-HALF_PI)}const ne=rThetaToXY(k,w,c,u);if(s.lineTo(ne.x,ne.y),O>0){const B=rThetaToXY(k,L,c,u);s.arc(B.x,B.y,O,w-HALF_PI,L)}}else{s.moveTo(c,u);const V=Math.cos(L)*g+c,Z=Math.sin(L)*g+u;s.lineTo(V,Z);const G=Math.cos(H)*g+c,ne=Math.sin(H)*g+u;s.lineTo(G,ne)}s.closePath()}function drawArc(s,e,t,n,r){const{fullCircles:o,startAngle:c,circumference:u}=e;let h=e.endAngle;if(o){pathArc(s,e,t,n,h,r);for(let f=0;f<o;++f)s.fill();isNaN(u)||(h=c+(u%TAU||TAU))}return pathArc(s,e,t,n,h,r),s.fill(),h}function drawBorder(s,e,t,n,r){const{fullCircles:o,startAngle:c,circumference:u,options:h}=e,{borderWidth:f,borderJoinStyle:p,borderDash:g,borderDashOffset:y}=h,v=h.borderAlign==="inner";if(!f)return;s.setLineDash(g||[]),s.lineDashOffset=y,v?(s.lineWidth=f*2,s.lineJoin=p||"round"):(s.lineWidth=f,s.lineJoin=p||"bevel");let _=e.endAngle;if(o){pathArc(s,e,t,n,_,r);for(let E=0;E<o;++E)s.stroke();isNaN(u)||(_=c+(u%TAU||TAU))}v&&clipArc(s,e,_),o||(pathArc(s,e,t,n,_,r),s.stroke())}class ArcElement extends Element{constructor(t){super();ot(this,"circumference");ot(this,"endAngle");ot(this,"fullCircles");ot(this,"innerRadius");ot(this,"outerRadius");ot(this,"pixelMargin");ot(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,n,r){const o=this.getProps(["x","y"],r),{angle:c,distance:u}=getAngleFromPoint(o,{x:t,y:n}),{startAngle:h,endAngle:f,innerRadius:p,outerRadius:g,circumference:y}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),v=(this.options.spacing+this.options.borderWidth)/2,_=valueOrDefault(y,f-h),E=_angleBetween(c,h,f)&&h!==f,x=_>=TAU||E,w=_isBetween(u,p+v,g+v);return x&&w}getCenterPoint(t){const{x:n,y:r,startAngle:o,endAngle:c,innerRadius:u,outerRadius:h}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:f,spacing:p}=this.options,g=(o+c)/2,y=(u+h+p+f)/2;return{x:n+Math.cos(g)*y,y:r+Math.sin(g)*y}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:n,circumference:r}=this,o=(n.offset||0)/4,c=(n.spacing||0)/2,u=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=r>TAU?Math.floor(r/TAU):0,r===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const h=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(h)*o,Math.sin(h)*o);const f=1-Math.sin(Math.min(PI,r||0)),p=o*f;t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,drawArc(t,this,p,c,u),drawBorder(t,this,p,c,u),t.restore()}}ot(ArcElement,"id","arc"),ot(ArcElement,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),ot(ArcElement,"defaultRoutes",{backgroundColor:"backgroundColor"}),ot(ArcElement,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"});function getBarBounds(s,e){const{x:t,y:n,base:r,width:o,height:c}=s.getProps(["x","y","base","width","height"],e);let u,h,f,p,g;return s.horizontal?(g=c/2,u=Math.min(t,r),h=Math.max(t,r),f=n-g,p=n+g):(g=o/2,u=t-g,h=t+g,f=Math.min(n,r),p=Math.max(n,r)),{left:u,top:f,right:h,bottom:p}}function skipOrLimit(s,e,t,n){return s?0:_limitValue(e,t,n)}function parseBorderWidth(s,e,t){const n=s.options.borderWidth,r=s.borderSkipped,o=toTRBL(n);return{t:skipOrLimit(r.top,o.top,0,t),r:skipOrLimit(r.right,o.right,0,e),b:skipOrLimit(r.bottom,o.bottom,0,t),l:skipOrLimit(r.left,o.left,0,e)}}function parseBorderRadius(s,e,t){const{enableBorderRadius:n}=s.getProps(["enableBorderRadius"]),r=s.options.borderRadius,o=toTRBLCorners(r),c=Math.min(e,t),u=s.borderSkipped,h=n||isObject(r);return{topLeft:skipOrLimit(!h||u.top||u.left,o.topLeft,0,c),topRight:skipOrLimit(!h||u.top||u.right,o.topRight,0,c),bottomLeft:skipOrLimit(!h||u.bottom||u.left,o.bottomLeft,0,c),bottomRight:skipOrLimit(!h||u.bottom||u.right,o.bottomRight,0,c)}}function boundingRects(s){const e=getBarBounds(s),t=e.right-e.left,n=e.bottom-e.top,r=parseBorderWidth(s,t/2,n/2),o=parseBorderRadius(s,t/2,n/2);return{outer:{x:e.left,y:e.top,w:t,h:n,radius:o},inner:{x:e.left+r.l,y:e.top+r.t,w:t-r.l-r.r,h:n-r.t-r.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,o.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(r.b,r.r))}}}}function inRange(s,e,t,n){const r=e===null,o=t===null,u=s&&!(r&&o)&&getBarBounds(s,n);return u&&(r||_isBetween(e,u.left,u.right))&&(o||_isBetween(t,u.top,u.bottom))}function hasRadius(s){return s.topLeft||s.topRight||s.bottomLeft||s.bottomRight}function addNormalRectPath(s,e){s.rect(e.x,e.y,e.w,e.h)}function inflateRect(s,e,t={}){const n=s.x!==t.x?-e:0,r=s.y!==t.y?-e:0,o=(s.x+s.w!==t.x+t.w?e:0)-n,c=(s.y+s.h!==t.y+t.h?e:0)-r;return{x:s.x+n,y:s.y+r,w:s.w+o,h:s.h+c,radius:s.radius}}class BarElement extends Element{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:n,backgroundColor:r}}=this,{inner:o,outer:c}=boundingRects(this),u=hasRadius(c.radius)?addRoundedRectPath:addNormalRectPath;e.save(),(c.w!==o.w||c.h!==o.h)&&(e.beginPath(),u(e,inflateRect(c,t,o)),e.clip(),u(e,inflateRect(o,-t,c)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),u(e,inflateRect(o,t)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,t,n){return inRange(this,e,t,n)}inXRange(e,t){return inRange(this,e,null,t)}inYRange(e,t){return inRange(this,null,e,t)}getCenterPoint(e){const{x:t,y:n,base:r,horizontal:o}=this.getProps(["x","y","base","horizontal"],e);return{x:o?(t+r)/2:t,y:o?n:(n+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}ot(BarElement,"id","bar"),ot(BarElement,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),ot(BarElement,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const getBoxSize=(s,e)=>{let{boxHeight:t=e,boxWidth:n=e}=s;return s.usePointStyle&&(t=Math.min(t,e),n=s.pointStyleWidth||Math.min(n,e)),{boxWidth:n,boxHeight:t,itemHeight:Math.max(e,t)}},itemsEqual=(s,e)=>s!==null&&e!==null&&s.datasetIndex===e.datasetIndex&&s.index===e.index;class Legend extends Element{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=callback(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(n=>e.filter(n,this.chart.data))),e.sort&&(t=t.sort((n,r)=>e.sort(n,r,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const n=e.labels,r=toFont(n.font),o=r.size,c=this._computeTitleHeight(),{boxWidth:u,itemHeight:h}=getBoxSize(n,o);let f,p;t.font=r.string,this.isHorizontal()?(f=this.maxWidth,p=this._fitRows(c,o,u,h)+10):(p=this.maxHeight,f=this._fitCols(c,r,u,h)+10),this.width=Math.min(f,e.maxWidth||this.maxWidth),this.height=Math.min(p,e.maxHeight||this.maxHeight)}_fitRows(e,t,n,r){const{ctx:o,maxWidth:c,options:{labels:{padding:u}}}=this,h=this.legendHitBoxes=[],f=this.lineWidths=[0],p=r+u;let g=e;o.textAlign="left",o.textBaseline="middle";let y=-1,v=-p;return this.legendItems.forEach((_,E)=>{const x=n+t/2+o.measureText(_.text).width;(E===0||f[f.length-1]+x+2*u>c)&&(g+=p,f[f.length-(E>0?0:1)]=0,v+=p,y++),h[E]={left:0,top:v,row:y,width:x,height:r},f[f.length-1]+=x+u}),g}_fitCols(e,t,n,r){const{ctx:o,maxHeight:c,options:{labels:{padding:u}}}=this,h=this.legendHitBoxes=[],f=this.columnSizes=[],p=c-e;let g=u,y=0,v=0,_=0,E=0;return this.legendItems.forEach((x,w)=>{const{itemWidth:T,itemHeight:O}=calculateItemSize(n,t,o,x,r);w>0&&v+O+2*u>p&&(g+=y+u,f.push({width:y,height:v}),_+=y+u,E++,y=v=0),h[w]={left:_,top:v,col:E,width:T,height:O},y=Math.max(y,T),v+=O+u}),g+=y,f.push({width:y,height:v}),g}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:n,labels:{padding:r},rtl:o}}=this,c=getRtlAdapter(o,this.left,this.width);if(this.isHorizontal()){let u=0,h=_alignStartEnd(n,this.left+r,this.right-this.lineWidths[u]);for(const f of t)u!==f.row&&(u=f.row,h=_alignStartEnd(n,this.left+r,this.right-this.lineWidths[u])),f.top+=this.top+e+r,f.left=c.leftForLtr(c.x(h),f.width),h+=f.width+r}else{let u=0,h=_alignStartEnd(n,this.top+e+r,this.bottom-this.columnSizes[u].height);for(const f of t)f.col!==u&&(u=f.col,h=_alignStartEnd(n,this.top+e+r,this.bottom-this.columnSizes[u].height)),f.top=h,f.left+=this.left+r,f.left=c.leftForLtr(c.x(f.left),f.width),h+=f.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;clipArea(e,this),this._draw(),unclipArea(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:n,ctx:r}=this,{align:o,labels:c}=e,u=defaults.color,h=getRtlAdapter(e.rtl,this.left,this.width),f=toFont(c.font),{padding:p}=c,g=f.size,y=g/2;let v;this.drawTitle(),r.textAlign=h.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=f.string;const{boxWidth:_,boxHeight:E,itemHeight:x}=getBoxSize(c,g),w=function(I,k,M){if(isNaN(_)||_<=0||isNaN(E)||E<0)return;r.save();const L=valueOrDefault(M.lineWidth,1);if(r.fillStyle=valueOrDefault(M.fillStyle,u),r.lineCap=valueOrDefault(M.lineCap,"butt"),r.lineDashOffset=valueOrDefault(M.lineDashOffset,0),r.lineJoin=valueOrDefault(M.lineJoin,"miter"),r.lineWidth=L,r.strokeStyle=valueOrDefault(M.strokeStyle,u),r.setLineDash(valueOrDefault(M.lineDash,[])),c.usePointStyle){const H={radius:E*Math.SQRT2/2,pointStyle:M.pointStyle,rotation:M.rotation,borderWidth:L},D=h.xPlus(I,_/2),q=k+y;drawPointLegend(r,H,D,q,c.pointStyleWidth&&_)}else{const H=k+Math.max((g-E)/2,0),D=h.leftForLtr(I,_),q=toTRBLCorners(M.borderRadius);r.beginPath(),Object.values(q).some(J=>J!==0)?addRoundedRectPath(r,{x:D,y:H,w:_,h:E,radius:q}):r.rect(D,H,_,E),r.fill(),L!==0&&r.stroke()}r.restore()},T=function(I,k,M){renderText(r,M.text,I,k+x/2,f,{strikethrough:M.hidden,textAlign:h.textAlign(M.textAlign)})},O=this.isHorizontal(),N=this._computeTitleHeight();O?v={x:_alignStartEnd(o,this.left+p,this.right-n[0]),y:this.top+p+N,line:0}:v={x:this.left+p,y:_alignStartEnd(o,this.top+N+p,this.bottom-t[0].height),line:0},overrideTextDirection(this.ctx,e.textDirection);const A=x+p;this.legendItems.forEach((I,k)=>{r.strokeStyle=I.fontColor,r.fillStyle=I.fontColor;const M=r.measureText(I.text).width,L=h.textAlign(I.textAlign||(I.textAlign=c.textAlign)),H=_+y+M;let D=v.x,q=v.y;h.setWidth(this.width),O?k>0&&D+H+p>this.right&&(q=v.y+=A,v.line++,D=v.x=_alignStartEnd(o,this.left+p,this.right-n[v.line])):k>0&&q+A>this.bottom&&(D=v.x=D+t[v.line].width+p,v.line++,q=v.y=_alignStartEnd(o,this.top+N+p,this.bottom-t[v.line].height));const J=h.x(D);if(w(J,q,I),D=_textX(L,D+_+y,O?D+H:this.right,e.rtl),T(h.x(D),q,I),O)v.x+=H+p;else if(typeof I.text!="string"){const ae=f.lineHeight;v.y+=calculateLegendItemHeight(I,ae)+p}else v.y+=A}),restoreTextDirection(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,n=toFont(t.font),r=toPadding(t.padding);if(!t.display)return;const o=getRtlAdapter(e.rtl,this.left,this.width),c=this.ctx,u=t.position,h=n.size/2,f=r.top+h;let p,g=this.left,y=this.width;if(this.isHorizontal())y=Math.max(...this.lineWidths),p=this.top+f,g=_alignStartEnd(e.align,g,this.right-y);else{const _=this.columnSizes.reduce((E,x)=>Math.max(E,x.height),0);p=f+_alignStartEnd(e.align,this.top,this.bottom-_-e.labels.padding-this._computeTitleHeight())}const v=_alignStartEnd(u,g,g+y);c.textAlign=o.textAlign(_toLeftRightCenter(u)),c.textBaseline="middle",c.strokeStyle=t.color,c.fillStyle=t.color,c.font=n.string,renderText(c,t.text,v,p,n)}_computeTitleHeight(){const e=this.options.title,t=toFont(e.font),n=toPadding(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){let n,r,o;if(_isBetween(e,this.left,this.right)&&_isBetween(t,this.top,this.bottom)){for(o=this.legendHitBoxes,n=0;n<o.length;++n)if(r=o[n],_isBetween(e,r.left,r.left+r.width)&&_isBetween(t,r.top,r.top+r.height))return this.legendItems[n]}return null}handleEvent(e){const t=this.options;if(!isListened(e.type,t))return;const n=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,o=itemsEqual(r,n);r&&!o&&callback(t.onLeave,[e,r,this],this),this._hoveredItem=n,n&&!o&&callback(t.onHover,[e,n,this],this)}else n&&callback(t.onClick,[e,n,this],this)}}function calculateItemSize(s,e,t,n,r){const o=calculateItemWidth(n,s,e,t),c=calculateItemHeight(r,n,e.lineHeight);return{itemWidth:o,itemHeight:c}}function calculateItemWidth(s,e,t,n){let r=s.text;return r&&typeof r!="string"&&(r=r.reduce((o,c)=>o.length>c.length?o:c)),e+t.size/2+n.measureText(r).width}function calculateItemHeight(s,e,t){let n=s;return typeof e.text!="string"&&(n=calculateLegendItemHeight(e,t)),n}function calculateLegendItemHeight(s,e){const t=s.text?s.text.length:0;return e*t}function isListened(s,e){return!!((s==="mousemove"||s==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(s==="click"||s==="mouseup"))}var plugin_legend={id:"legend",_element:Legend,start(s,e,t){const n=s.legend=new Legend({ctx:s.ctx,options:t,chart:s});layouts.configure(s,n,t),layouts.addBox(s,n)},stop(s){layouts.removeBox(s,s.legend),delete s.legend},beforeUpdate(s,e,t){const n=s.legend;layouts.configure(s,n,t),n.options=t},afterUpdate(s){const e=s.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(s,e){e.replay||s.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(s,e,t){const n=e.datasetIndex,r=t.chart;r.isDatasetVisible(n)?(r.hide(n),e.hidden=!0):(r.show(n),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:s=>s.chart.options.color,boxWidth:40,padding:10,generateLabels(s){const e=s.data.datasets,{labels:{usePointStyle:t,pointStyle:n,textAlign:r,color:o,useBorderRadius:c,borderRadius:u}}=s.legend.options;return s._getSortedDatasetMetas().map(h=>{const f=h.controller.getStyle(t?0:void 0),p=toPadding(f.borderWidth);return{text:e[h.index].label,fillStyle:f.backgroundColor,fontColor:o,hidden:!h.visible,lineCap:f.borderCapStyle,lineDash:f.borderDash,lineDashOffset:f.borderDashOffset,lineJoin:f.borderJoinStyle,lineWidth:(p.width+p.height)/4,strokeStyle:f.borderColor,pointStyle:n||f.pointStyle,rotation:f.rotation,textAlign:r||f.textAlign,borderRadius:c&&(u||f.borderRadius),datasetIndex:h.index}},this)}},title:{color:s=>s.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:s=>!s.startsWith("on"),labels:{_scriptable:s=>!["generateLabels","filter","sort"].includes(s)}}};class Title extends Element{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const r=isArray(n.text)?n.text.length:1;this._padding=toPadding(n.padding);const o=r*toFont(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=o:this.width=o}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:n,bottom:r,right:o,options:c}=this,u=c.align;let h=0,f,p,g;return this.isHorizontal()?(p=_alignStartEnd(u,n,o),g=t+e,f=o-n):(c.position==="left"?(p=n+e,g=_alignStartEnd(u,r,t),h=PI*-.5):(p=o-e,g=_alignStartEnd(u,t,r),h=PI*.5),f=r-t),{titleX:p,titleY:g,maxWidth:f,rotation:h}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const n=toFont(t.font),o=n.lineHeight/2+this._padding.top,{titleX:c,titleY:u,maxWidth:h,rotation:f}=this._drawArgs(o);renderText(e,t.text,0,0,n,{color:t.color,maxWidth:h,rotation:f,textAlign:_toLeftRightCenter(t.align),textBaseline:"middle",translation:[c,u]})}}function createTitle(s,e){const t=new Title({ctx:s.ctx,options:e,chart:s});layouts.configure(s,t,e),layouts.addBox(s,t),s.titleBlock=t}var plugin_title={id:"title",_element:Title,start(s,e,t){createTitle(s,t)},stop(s){const e=s.titleBlock;layouts.removeBox(s,e),delete s.titleBlock},beforeUpdate(s,e,t){const n=s.titleBlock;layouts.configure(s,n,t),n.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const positioners={average(s){if(!s.length)return!1;let e,t,n=new Set,r=0,o=0;for(e=0,t=s.length;e<t;++e){const u=s[e].element;if(u&&u.hasValue()){const h=u.tooltipPosition();n.add(h.x),r+=h.y,++o}}return o===0||n.size===0?!1:{x:[...n].reduce((u,h)=>u+h)/n.size,y:r/o}},nearest(s,e){if(!s.length)return!1;let t=e.x,n=e.y,r=Number.POSITIVE_INFINITY,o,c,u;for(o=0,c=s.length;o<c;++o){const h=s[o].element;if(h&&h.hasValue()){const f=h.getCenterPoint(),p=distanceBetweenPoints(e,f);p<r&&(r=p,u=h)}}if(u){const h=u.tooltipPosition();t=h.x,n=h.y}return{x:t,y:n}}};function pushOrConcat(s,e){return e&&(isArray(e)?Array.prototype.push.apply(s,e):s.push(e)),s}function splitNewlines(s){return(typeof s=="string"||s instanceof String)&&s.indexOf(`
`)>-1?s.split(`
`):s}function createTooltipItem(s,e){const{element:t,datasetIndex:n,index:r}=e,o=s.getDatasetMeta(n).controller,{label:c,value:u}=o.getLabelAndValue(r);return{chart:s,label:c,parsed:o.getParsed(r),raw:s.data.datasets[n].data[r],formattedValue:u,dataset:o.getDataset(),dataIndex:r,datasetIndex:n,element:t}}function getTooltipSize(s,e){const t=s.chart.ctx,{body:n,footer:r,title:o}=s,{boxWidth:c,boxHeight:u}=e,h=toFont(e.bodyFont),f=toFont(e.titleFont),p=toFont(e.footerFont),g=o.length,y=r.length,v=n.length,_=toPadding(e.padding);let E=_.height,x=0,w=n.reduce((N,A)=>N+A.before.length+A.lines.length+A.after.length,0);if(w+=s.beforeBody.length+s.afterBody.length,g&&(E+=g*f.lineHeight+(g-1)*e.titleSpacing+e.titleMarginBottom),w){const N=e.displayColors?Math.max(u,h.lineHeight):h.lineHeight;E+=v*N+(w-v)*h.lineHeight+(w-1)*e.bodySpacing}y&&(E+=e.footerMarginTop+y*p.lineHeight+(y-1)*e.footerSpacing);let T=0;const O=function(N){x=Math.max(x,t.measureText(N).width+T)};return t.save(),t.font=f.string,each(s.title,O),t.font=h.string,each(s.beforeBody.concat(s.afterBody),O),T=e.displayColors?c+2+e.boxPadding:0,each(n,N=>{each(N.before,O),each(N.lines,O),each(N.after,O)}),T=0,t.font=p.string,each(s.footer,O),t.restore(),x+=_.width,{width:x,height:E}}function determineYAlign(s,e){const{y:t,height:n}=e;return t<n/2?"top":t>s.height-n/2?"bottom":"center"}function doesNotFitWithAlign(s,e,t,n){const{x:r,width:o}=n,c=t.caretSize+t.caretPadding;if(s==="left"&&r+o+c>e.width||s==="right"&&r-o-c<0)return!0}function determineXAlign(s,e,t,n){const{x:r,width:o}=t,{width:c,chartArea:{left:u,right:h}}=s;let f="center";return n==="center"?f=r<=(u+h)/2?"left":"right":r<=o/2?f="left":r>=c-o/2&&(f="right"),doesNotFitWithAlign(f,s,e,t)&&(f="center"),f}function determineAlignment(s,e,t){const n=t.yAlign||e.yAlign||determineYAlign(s,t);return{xAlign:t.xAlign||e.xAlign||determineXAlign(s,e,t,n),yAlign:n}}function alignX(s,e){let{x:t,width:n}=s;return e==="right"?t-=n:e==="center"&&(t-=n/2),t}function alignY(s,e,t){let{y:n,height:r}=s;return e==="top"?n+=t:e==="bottom"?n-=r+t:n-=r/2,n}function getBackgroundPoint(s,e,t,n){const{caretSize:r,caretPadding:o,cornerRadius:c}=s,{xAlign:u,yAlign:h}=t,f=r+o,{topLeft:p,topRight:g,bottomLeft:y,bottomRight:v}=toTRBLCorners(c);let _=alignX(e,u);const E=alignY(e,h,f);return h==="center"?u==="left"?_+=f:u==="right"&&(_-=f):u==="left"?_-=Math.max(p,y)+r:u==="right"&&(_+=Math.max(g,v)+r),{x:_limitValue(_,0,n.width-e.width),y:_limitValue(E,0,n.height-e.height)}}function getAlignedX(s,e,t){const n=toPadding(t.padding);return e==="center"?s.x+s.width/2:e==="right"?s.x+s.width-n.right:s.x+n.left}function getBeforeAfterBodyLines(s){return pushOrConcat([],splitNewlines(s))}function createTooltipContext(s,e,t){return createContext(s,{tooltip:e,tooltipItems:t,type:"tooltip"})}function overrideCallbacks(s,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?s.override(t):s}const defaultCallbacks={beforeTitle:noop,title(s){if(s.length>0){const e=s[0],t=e.chart.data.labels,n=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(n>0&&e.dataIndex<n)return t[e.dataIndex]}return""},afterTitle:noop,beforeBody:noop,beforeLabel:noop,label(s){if(this&&this.options&&this.options.mode==="dataset")return s.label+": "+s.formattedValue||s.formattedValue;let e=s.dataset.label||"";e&&(e+=": ");const t=s.formattedValue;return isNullOrUndef(t)||(e+=t),e},labelColor(s){const t=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(s){const t=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:noop,afterBody:noop,beforeFooter:noop,footer:noop,afterFooter:noop};function invokeCallbackWithFallback(s,e,t,n){const r=s[e].call(t,n);return typeof r>"u"?defaultCallbacks[e].call(t,n):r}class Tooltip extends Element{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,n=this.options.setContext(this.getContext()),r=n.enabled&&t.options.animation&&n.animations,o=new Animations(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=createTooltipContext(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:n}=t,r=invokeCallbackWithFallback(n,"beforeTitle",this,e),o=invokeCallbackWithFallback(n,"title",this,e),c=invokeCallbackWithFallback(n,"afterTitle",this,e);let u=[];return u=pushOrConcat(u,splitNewlines(r)),u=pushOrConcat(u,splitNewlines(o)),u=pushOrConcat(u,splitNewlines(c)),u}getBeforeBody(e,t){return getBeforeAfterBodyLines(invokeCallbackWithFallback(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:n}=t,r=[];return each(e,o=>{const c={before:[],lines:[],after:[]},u=overrideCallbacks(n,o);pushOrConcat(c.before,splitNewlines(invokeCallbackWithFallback(u,"beforeLabel",this,o))),pushOrConcat(c.lines,invokeCallbackWithFallback(u,"label",this,o)),pushOrConcat(c.after,splitNewlines(invokeCallbackWithFallback(u,"afterLabel",this,o))),r.push(c)}),r}getAfterBody(e,t){return getBeforeAfterBodyLines(invokeCallbackWithFallback(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:n}=t,r=invokeCallbackWithFallback(n,"beforeFooter",this,e),o=invokeCallbackWithFallback(n,"footer",this,e),c=invokeCallbackWithFallback(n,"afterFooter",this,e);let u=[];return u=pushOrConcat(u,splitNewlines(r)),u=pushOrConcat(u,splitNewlines(o)),u=pushOrConcat(u,splitNewlines(c)),u}_createItems(e){const t=this._active,n=this.chart.data,r=[],o=[],c=[];let u=[],h,f;for(h=0,f=t.length;h<f;++h)u.push(createTooltipItem(this.chart,t[h]));return e.filter&&(u=u.filter((p,g,y)=>e.filter(p,g,y,n))),e.itemSort&&(u=u.sort((p,g)=>e.itemSort(p,g,n))),each(u,p=>{const g=overrideCallbacks(e.callbacks,p);r.push(invokeCallbackWithFallback(g,"labelColor",this,p)),o.push(invokeCallbackWithFallback(g,"labelPointStyle",this,p)),c.push(invokeCallbackWithFallback(g,"labelTextColor",this,p))}),this.labelColors=r,this.labelPointStyles=o,this.labelTextColors=c,this.dataPoints=u,u}update(e,t){const n=this.options.setContext(this.getContext()),r=this._active;let o,c=[];if(!r.length)this.opacity!==0&&(o={opacity:0});else{const u=positioners[n.position].call(this,r,this._eventPosition);c=this._createItems(n),this.title=this.getTitle(c,n),this.beforeBody=this.getBeforeBody(c,n),this.body=this.getBody(c,n),this.afterBody=this.getAfterBody(c,n),this.footer=this.getFooter(c,n);const h=this._size=getTooltipSize(this,n),f=Object.assign({},u,h),p=determineAlignment(this.chart,n,f),g=getBackgroundPoint(n,f,p,this.chart);this.xAlign=p.xAlign,this.yAlign=p.yAlign,o={opacity:1,x:g.x,y:g.y,width:h.width,height:h.height,caretX:u.x,caretY:u.y}}this._tooltipItems=c,this.$context=void 0,o&&this._resolveAnimations().update(this,o),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,n,r){const o=this.getCaretPosition(e,n,r);t.lineTo(o.x1,o.y1),t.lineTo(o.x2,o.y2),t.lineTo(o.x3,o.y3)}getCaretPosition(e,t,n){const{xAlign:r,yAlign:o}=this,{caretSize:c,cornerRadius:u}=n,{topLeft:h,topRight:f,bottomLeft:p,bottomRight:g}=toTRBLCorners(u),{x:y,y:v}=e,{width:_,height:E}=t;let x,w,T,O,N,A;return o==="center"?(N=v+E/2,r==="left"?(x=y,w=x-c,O=N+c,A=N-c):(x=y+_,w=x+c,O=N-c,A=N+c),T=x):(r==="left"?w=y+Math.max(h,p)+c:r==="right"?w=y+_-Math.max(f,g)-c:w=this.caretX,o==="top"?(O=v,N=O-c,x=w-c,T=w+c):(O=v+E,N=O+c,x=w+c,T=w-c),A=O),{x1:x,x2:w,x3:T,y1:O,y2:N,y3:A}}drawTitle(e,t,n){const r=this.title,o=r.length;let c,u,h;if(o){const f=getRtlAdapter(n.rtl,this.x,this.width);for(e.x=getAlignedX(this,n.titleAlign,n),t.textAlign=f.textAlign(n.titleAlign),t.textBaseline="middle",c=toFont(n.titleFont),u=n.titleSpacing,t.fillStyle=n.titleColor,t.font=c.string,h=0;h<o;++h)t.fillText(r[h],f.x(e.x),e.y+c.lineHeight/2),e.y+=c.lineHeight+u,h+1===o&&(e.y+=n.titleMarginBottom-u)}}_drawColorBox(e,t,n,r,o){const c=this.labelColors[n],u=this.labelPointStyles[n],{boxHeight:h,boxWidth:f}=o,p=toFont(o.bodyFont),g=getAlignedX(this,"left",o),y=r.x(g),v=h<p.lineHeight?(p.lineHeight-h)/2:0,_=t.y+v;if(o.usePointStyle){const E={radius:Math.min(f,h)/2,pointStyle:u.pointStyle,rotation:u.rotation,borderWidth:1},x=r.leftForLtr(y,f)+f/2,w=_+h/2;e.strokeStyle=o.multiKeyBackground,e.fillStyle=o.multiKeyBackground,drawPoint(e,E,x,w),e.strokeStyle=c.borderColor,e.fillStyle=c.backgroundColor,drawPoint(e,E,x,w)}else{e.lineWidth=isObject(c.borderWidth)?Math.max(...Object.values(c.borderWidth)):c.borderWidth||1,e.strokeStyle=c.borderColor,e.setLineDash(c.borderDash||[]),e.lineDashOffset=c.borderDashOffset||0;const E=r.leftForLtr(y,f),x=r.leftForLtr(r.xPlus(y,1),f-2),w=toTRBLCorners(c.borderRadius);Object.values(w).some(T=>T!==0)?(e.beginPath(),e.fillStyle=o.multiKeyBackground,addRoundedRectPath(e,{x:E,y:_,w:f,h,radius:w}),e.fill(),e.stroke(),e.fillStyle=c.backgroundColor,e.beginPath(),addRoundedRectPath(e,{x,y:_+1,w:f-2,h:h-2,radius:w}),e.fill()):(e.fillStyle=o.multiKeyBackground,e.fillRect(E,_,f,h),e.strokeRect(E,_,f,h),e.fillStyle=c.backgroundColor,e.fillRect(x,_+1,f-2,h-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,t,n){const{body:r}=this,{bodySpacing:o,bodyAlign:c,displayColors:u,boxHeight:h,boxWidth:f,boxPadding:p}=n,g=toFont(n.bodyFont);let y=g.lineHeight,v=0;const _=getRtlAdapter(n.rtl,this.x,this.width),E=function(M){t.fillText(M,_.x(e.x+v),e.y+y/2),e.y+=y+o},x=_.textAlign(c);let w,T,O,N,A,I,k;for(t.textAlign=c,t.textBaseline="middle",t.font=g.string,e.x=getAlignedX(this,x,n),t.fillStyle=n.bodyColor,each(this.beforeBody,E),v=u&&x!=="right"?c==="center"?f/2+p:f+2+p:0,N=0,I=r.length;N<I;++N){for(w=r[N],T=this.labelTextColors[N],t.fillStyle=T,each(w.before,E),O=w.lines,u&&O.length&&(this._drawColorBox(t,e,N,_,n),y=Math.max(g.lineHeight,h)),A=0,k=O.length;A<k;++A)E(O[A]),y=g.lineHeight;each(w.after,E)}v=0,y=g.lineHeight,each(this.afterBody,E),e.y-=o}drawFooter(e,t,n){const r=this.footer,o=r.length;let c,u;if(o){const h=getRtlAdapter(n.rtl,this.x,this.width);for(e.x=getAlignedX(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=h.textAlign(n.footerAlign),t.textBaseline="middle",c=toFont(n.footerFont),t.fillStyle=n.footerColor,t.font=c.string,u=0;u<o;++u)t.fillText(r[u],h.x(e.x),e.y+c.lineHeight/2),e.y+=c.lineHeight+n.footerSpacing}}drawBackground(e,t,n,r){const{xAlign:o,yAlign:c}=this,{x:u,y:h}=e,{width:f,height:p}=n,{topLeft:g,topRight:y,bottomLeft:v,bottomRight:_}=toTRBLCorners(r.cornerRadius);t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.beginPath(),t.moveTo(u+g,h),c==="top"&&this.drawCaret(e,t,n,r),t.lineTo(u+f-y,h),t.quadraticCurveTo(u+f,h,u+f,h+y),c==="center"&&o==="right"&&this.drawCaret(e,t,n,r),t.lineTo(u+f,h+p-_),t.quadraticCurveTo(u+f,h+p,u+f-_,h+p),c==="bottom"&&this.drawCaret(e,t,n,r),t.lineTo(u+v,h+p),t.quadraticCurveTo(u,h+p,u,h+p-v),c==="center"&&o==="left"&&this.drawCaret(e,t,n,r),t.lineTo(u,h+g),t.quadraticCurveTo(u,h,u+g,h),t.closePath(),t.fill(),r.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,n=this.$animations,r=n&&n.x,o=n&&n.y;if(r||o){const c=positioners[e.position].call(this,this._active,this._eventPosition);if(!c)return;const u=this._size=getTooltipSize(this,e),h=Object.assign({},c,this._size),f=determineAlignment(t,e,h),p=getBackgroundPoint(e,h,f,t);(r._to!==p.x||o._to!==p.y)&&(this.xAlign=f.xAlign,this.yAlign=f.yAlign,this.width=u.width,this.height=u.height,this.caretX=c.x,this.caretY=c.y,this._resolveAnimations().update(this,p))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(t);const r={width:this.width,height:this.height},o={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const c=toPadding(t.padding),u=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&u&&(e.save(),e.globalAlpha=n,this.drawBackground(o,e,r,t),overrideTextDirection(e,t.textDirection),o.y+=c.top,this.drawTitle(o,e,t),this.drawBody(o,e,t),this.drawFooter(o,e,t),restoreTextDirection(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const n=this._active,r=e.map(({datasetIndex:u,index:h})=>{const f=this.chart.getDatasetMeta(u);if(!f)throw new Error("Cannot find a dataset at index "+u);return{datasetIndex:u,element:f.data[h],index:h}}),o=!_elementsEqual(n,r),c=this._positionChanged(r,t);(o||c)&&(this._active=r,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,n=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,o=this._active||[],c=this._getActiveElements(e,o,t,n),u=this._positionChanged(c,e),h=t||!_elementsEqual(c,o)||u;return h&&(this._active=c,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),h}_getActiveElements(e,t,n,r){const o=this.options;if(e.type==="mouseout")return[];if(!r)return t.filter(u=>this.chart.data.datasets[u.datasetIndex]&&this.chart.getDatasetMeta(u.datasetIndex).controller.getParsed(u.index)!==void 0);const c=this.chart.getElementsAtEventForMode(e,o.mode,o,n);return o.reverse&&c.reverse(),c}_positionChanged(e,t){const{caretX:n,caretY:r,options:o}=this,c=positioners[o.position].call(this,e,t);return c!==!1&&(n!==c.x||r!==c.y)}}ot(Tooltip,"positioners",positioners);var plugin_tooltip={id:"tooltip",_element:Tooltip,positioners,afterInit(s,e,t){t&&(s.tooltip=new Tooltip({chart:s,options:t}))},beforeUpdate(s,e,t){s.tooltip&&s.tooltip.initialize(t)},reset(s,e,t){s.tooltip&&s.tooltip.initialize(t)},afterDraw(s){const e=s.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(s.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(s.ctx),s.notifyPlugins("afterTooltipDraw",t)}},afterEvent(s,e){if(s.tooltip){const t=e.replay;s.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(s,e)=>e.bodyFont.size,boxWidth:(s,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:defaultCallbacks},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:s=>s!=="filter"&&s!=="itemSort"&&s!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const addIfString=(s,e,t,n)=>(typeof e=="string"?(t=s.push(e)-1,n.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function findOrAddLabel(s,e,t,n){const r=s.indexOf(e);if(r===-1)return addIfString(s,e,t,n);const o=s.lastIndexOf(e);return r!==o?t:r}const validIndex=(s,e)=>s===null?null:_limitValue(Math.round(s),0,e);function _getLabelForValue(s){const e=this.getLabels();return s>=0&&s<e.length?e[s]:s}class CategoryScale extends Scale{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const n=this.getLabels();for(const{index:r,label:o}of t)n[r]===o&&n.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(isNullOrUndef(e))return null;const n=this.getLabels();return t=isFinite(t)&&n[t]===e?t:findOrAddLabel(n,e,valueOrDefault(t,e),this._addedLabels),validIndex(t,n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:n,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(n=0),t||(r=this.getLabels().length-1)),this.min=n,this.max=r}buildTicks(){const e=this.min,t=this.max,n=this.options.offset,r=[];let o=this.getLabels();o=e===0&&t===o.length-1?o:o.slice(e,t+1),this._valueRange=Math.max(o.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let c=e;c<=t;c++)r.push({value:c});return r}getLabelForValue(e){return _getLabelForValue.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}ot(CategoryScale,"id","category"),ot(CategoryScale,"defaults",{ticks:{callback:_getLabelForValue}});function generateTicks$1(s,e){const t=[],{bounds:r,step:o,min:c,max:u,precision:h,count:f,maxTicks:p,maxDigits:g,includeBounds:y}=s,v=o||1,_=p-1,{min:E,max:x}=e,w=!isNullOrUndef(c),T=!isNullOrUndef(u),O=!isNullOrUndef(f),N=(x-E)/(g+1);let A=niceNum((x-E)/_/v)*v,I,k,M,L;if(A<1e-14&&!w&&!T)return[{value:E},{value:x}];L=Math.ceil(x/A)-Math.floor(E/A),L>_&&(A=niceNum(L*A/_/v)*v),isNullOrUndef(h)||(I=Math.pow(10,h),A=Math.ceil(A*I)/I),r==="ticks"?(k=Math.floor(E/A)*A,M=Math.ceil(x/A)*A):(k=E,M=x),w&&T&&o&&almostWhole((u-c)/o,A/1e3)?(L=Math.round(Math.min((u-c)/A,p)),A=(u-c)/L,k=c,M=u):O?(k=w?c:k,M=T?u:M,L=f-1,A=(M-k)/L):(L=(M-k)/A,almostEquals(L,Math.round(L),A/1e3)?L=Math.round(L):L=Math.ceil(L));const H=Math.max(_decimalPlaces(A),_decimalPlaces(k));I=Math.pow(10,isNullOrUndef(h)?H:h),k=Math.round(k*I)/I,M=Math.round(M*I)/I;let D=0;for(w&&(y&&k!==c?(t.push({value:c}),k<c&&D++,almostEquals(Math.round((k+D*A)*I)/I,c,relativeLabelSize(c,N,s))&&D++):k<c&&D++);D<L;++D){const q=Math.round((k+D*A)*I)/I;if(T&&q>u)break;t.push({value:q})}return T&&y&&M!==u?t.length&&almostEquals(t[t.length-1].value,u,relativeLabelSize(u,N,s))?t[t.length-1].value=u:t.push({value:u}):(!T||M===u)&&t.push({value:M}),t}function relativeLabelSize(s,e,{horizontal:t,minRotation:n}){const r=toRadians(n),o=(t?Math.sin(r):Math.cos(r))||.001,c=.75*e*(""+s).length;return Math.min(e/o,c)}class LinearScaleBase extends Scale{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return isNullOrUndef(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:r,max:o}=this;const c=h=>r=t?r:h,u=h=>o=n?o:h;if(e){const h=sign(r),f=sign(o);h<0&&f<0?u(0):h>0&&f>0&&c(0)}if(r===o){let h=o===0?1:Math.abs(o*.05);u(o+h),e||c(r-h)}this.min=r,this.max=o}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:n}=e,r;return n?(r=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),t=t||11),t&&(r=Math.min(t,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const r={maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},o=this._range||this,c=generateTicks$1(r,o);return e.bounds==="ticks"&&_setMinAndMaxByKey(c,this,"value"),e.reverse?(c.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),c}configure(){const e=this.ticks;let t=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const r=(n-t)/Math.max(e.length-1,1)/2;t-=r,n+=r}this._startValue=t,this._endValue=n,this._valueRange=n-t}getLabelForValue(e){return formatNumber(e,this.chart.options.locale,this.options.ticks.format)}}class LinearScale extends LinearScaleBase{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=isNumberFinite(e)?e:0,this.max=isNumberFinite(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,n=toRadians(this.options.ticks.minRotation),r=(e?Math.sin(n):Math.cos(n))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,o.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}ot(LinearScale,"id","linear"),ot(LinearScale,"defaults",{ticks:{callback:Ticks.formatters.numeric}});const INTERVALS={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},UNITS=Object.keys(INTERVALS);function sorter(s,e){return s-e}function parse(s,e){if(isNullOrUndef(e))return null;const t=s._adapter,{parser:n,round:r,isoWeekday:o}=s._parseOpts;let c=e;return typeof n=="function"&&(c=n(c)),isNumberFinite(c)||(c=typeof n=="string"?t.parse(c,n):t.parse(c)),c===null?null:(r&&(c=r==="week"&&(isNumber(o)||o===!0)?t.startOf(c,"isoWeek",o):t.startOf(c,r)),+c)}function determineUnitForAutoTicks(s,e,t,n){const r=UNITS.length;for(let o=UNITS.indexOf(s);o<r-1;++o){const c=INTERVALS[UNITS[o]],u=c.steps?c.steps:Number.MAX_SAFE_INTEGER;if(c.common&&Math.ceil((t-e)/(u*c.size))<=n)return UNITS[o]}return UNITS[r-1]}function determineUnitForFormatting(s,e,t,n,r){for(let o=UNITS.length-1;o>=UNITS.indexOf(t);o--){const c=UNITS[o];if(INTERVALS[c].common&&s._adapter.diff(r,n,c)>=e-1)return c}return UNITS[t?UNITS.indexOf(t):0]}function determineMajorUnit(s){for(let e=UNITS.indexOf(s)+1,t=UNITS.length;e<t;++e)if(INTERVALS[UNITS[e]].common)return UNITS[e]}function addTick(s,e,t){if(!t)s[e]=!0;else if(t.length){const{lo:n,hi:r}=_lookup(t,e),o=t[n]>=e?t[n]:t[r];s[o]=!0}}function setMajorTicks(s,e,t,n){const r=s._adapter,o=+r.startOf(e[0].value,n),c=e[e.length-1].value;let u,h;for(u=o;u<=c;u=+r.add(u,1,n))h=t[u],h>=0&&(e[h].major=!0);return e}function ticksFromTimestamps(s,e,t){const n=[],r={},o=e.length;let c,u;for(c=0;c<o;++c)u=e[c],r[u]=c,n.push({value:u,major:!1});return o===0||!t?n:setMajorTicks(s,n,r,t)}class TimeScale extends Scale{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const n=e.time||(e.time={}),r=this._adapter=new adapters._date(e.adapters.date);r.init(t),mergeIf(n.displayFormats,r.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:parse(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,n=e.time.unit||"day";let{min:r,max:o,minDefined:c,maxDefined:u}=this.getUserBounds();function h(f){!c&&!isNaN(f.min)&&(r=Math.min(r,f.min)),!u&&!isNaN(f.max)&&(o=Math.max(o,f.max))}(!c||!u)&&(h(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&h(this.getMinMax(!1))),r=isNumberFinite(r)&&!isNaN(r)?r:+t.startOf(Date.now(),n),o=isNumberFinite(o)&&!isNaN(o)?o:+t.endOf(Date.now(),n)+1,this.min=Math.min(r,o-1),this.max=Math.max(r+1,o)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}buildTicks(){const e=this.options,t=e.time,n=e.ticks,r=n.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const o=this.min,c=this.max,u=_filterBetween(r,o,c);return this._unit=t.unit||(n.autoSkip?determineUnitForAutoTicks(t.minUnit,this.min,this.max,this._getLabelCapacity(o)):determineUnitForFormatting(this,u.length,t.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:determineMajorUnit(this._unit),this.initOffsets(r),e.reverse&&u.reverse(),ticksFromTimestamps(this,u,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,n=0,r,o;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?t=1-r:t=(this.getDecimalForValue(e[1])-r)/2,o=this.getDecimalForValue(e[e.length-1]),e.length===1?n=o:n=(o-this.getDecimalForValue(e[e.length-2]))/2);const c=e.length<3?.5:.25;t=_limitValue(t,0,c),n=_limitValue(n,0,c),this._offsets={start:t,end:n,factor:1/(t+1+n)}}_generate(){const e=this._adapter,t=this.min,n=this.max,r=this.options,o=r.time,c=o.unit||determineUnitForAutoTicks(o.minUnit,t,n,this._getLabelCapacity(t)),u=valueOrDefault(r.ticks.stepSize,1),h=c==="week"?o.isoWeekday:!1,f=isNumber(h)||h===!0,p={};let g=t,y,v;if(f&&(g=+e.startOf(g,"isoWeek",h)),g=+e.startOf(g,f?"day":c),e.diff(n,t,c)>1e5*u)throw new Error(t+" and "+n+" are too far apart with stepSize of "+u+" "+c);const _=r.ticks.source==="data"&&this.getDataTimestamps();for(y=g,v=0;y<n;y=+e.add(y,u,c),v++)addTick(p,y,_);return(y===n||r.bounds==="ticks"||v===1)&&addTick(p,y,_),Object.keys(p).sort(sorter).map(E=>+E)}getLabelForValue(e){const t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}format(e,t){const r=this.options.time.displayFormats,o=this._unit,c=t||r[o];return this._adapter.format(e,c)}_tickFormatFunction(e,t,n,r){const o=this.options,c=o.ticks.callback;if(c)return callback(c,[e,t,n],this);const u=o.time.displayFormats,h=this._unit,f=this._majorUnit,p=h&&u[h],g=f&&u[f],y=n[t],v=f&&g&&y&&y.major;return this._adapter.format(e,r||(v?g:p))}generateTickLabels(e){let t,n,r;for(t=0,n=e.length;t<n;++t)r=e[t],r.label=this._tickFormatFunction(r.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,n=this.ctx.measureText(e).width,r=toRadians(this.isHorizontal()?t.maxRotation:t.minRotation),o=Math.cos(r),c=Math.sin(r),u=this._resolveTickFontOptions(0).size;return{w:n*o+u*c,h:n*c+u*o}}_getLabelCapacity(e){const t=this.options.time,n=t.displayFormats,r=n[t.unit]||n.millisecond,o=this._tickFormatFunction(e,0,ticksFromTimestamps(this,[e],this._majorUnit),r),c=this._getLabelSize(o),u=Math.floor(this.isHorizontal()?this.width/c.w:this.height/c.h)-1;return u>0?u:1}getDataTimestamps(){let e=this._cache.data||[],t,n;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(t=0,n=r.length;t<n;++t)e=e.concat(r[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,n;if(e.length)return e;const r=this.getLabels();for(t=0,n=r.length;t<n;++t)e.push(parse(this,r[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return _arrayUnique(e.sort(sorter))}}ot(TimeScale,"id","time"),ot(TimeScale,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function interpolate(s,e,t){let n=0,r=s.length-1,o,c,u,h;t?(e>=s[n].pos&&e<=s[r].pos&&({lo:n,hi:r}=_lookupByKey(s,"pos",e)),{pos:o,time:u}=s[n],{pos:c,time:h}=s[r]):(e>=s[n].time&&e<=s[r].time&&({lo:n,hi:r}=_lookupByKey(s,"time",e)),{time:o,pos:u}=s[n],{time:c,pos:h}=s[r]);const f=c-o;return f?u+(h-u)*(e-o)/f:u}class TimeSeriesScale extends TimeScale{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=interpolate(t,this.min),this._tableRange=interpolate(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:n}=this,r=[],o=[];let c,u,h,f,p;for(c=0,u=e.length;c<u;++c)f=e[c],f>=t&&f<=n&&r.push(f);if(r.length<2)return[{time:t,pos:0},{time:n,pos:1}];for(c=0,u=r.length;c<u;++c)p=r[c+1],h=r[c-1],f=r[c],Math.round((p+h)/2)!==f&&o.push({time:f,pos:c/(u-1)});return o}_generate(){const e=this.min,t=this.max;let n=super.getDataTimestamps();return(!n.includes(e)||!n.length)&&n.splice(0,0,e),(!n.includes(t)||n.length===1)&&n.push(t),n.sort((r,o)=>r-o)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),n=this.getLabelTimestamps();return t.length&&n.length?e=this.normalize(t.concat(n)):e=t.length?t:n,e=this._cache.all=e,e}getDecimalForValue(e){return(interpolate(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return interpolate(this._table,n*this._tableRange+this._minPos,!0)}}ot(TimeSeriesScale,"id","timeseries"),ot(TimeSeriesScale,"defaults",TimeScale.defaults);const defaultDatasetIdKey="label";function reforwardRef(s,e){typeof s=="function"?s(e):s&&(s.current=e)}function setOptions(s,e){const t=s.options;t&&e&&Object.assign(t,e)}function setLabels(s,e){s.labels=e}function setDatasets(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:defaultDatasetIdKey;const n=[];s.datasets=e.map(r=>{const o=s.datasets.find(c=>c[t]===r[t]);return!o||!r.data||n.includes(o)?{...r}:(n.push(o),Object.assign(o,r),o)})}function cloneData(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:defaultDatasetIdKey;const t={labels:[],datasets:[]};return setLabels(t,s.labels),setDatasets(t,s.datasets,e),t}function ChartComponent(s,e){const{height:t=150,width:n=300,redraw:r=!1,datasetIdKey:o,type:c,data:u,options:h,plugins:f=[],fallbackContent:p,updateMode:g,...y}=s,v=reactExports.useRef(null),_=reactExports.useRef(null),E=()=>{v.current&&(_.current=new Chart$1(v.current,{type:c,data:cloneData(u,o),options:h&&{...h},plugins:f}),reforwardRef(e,_.current))},x=()=>{reforwardRef(e,null),_.current&&(_.current.destroy(),_.current=null)};return reactExports.useEffect(()=>{!r&&_.current&&h&&setOptions(_.current,h)},[r,h]),reactExports.useEffect(()=>{!r&&_.current&&setLabels(_.current.config.data,u.labels)},[r,u.labels]),reactExports.useEffect(()=>{!r&&_.current&&u.datasets&&setDatasets(_.current.config.data,u.datasets,o)},[r,u.datasets]),reactExports.useEffect(()=>{_.current&&(r?(x(),setTimeout(E)):_.current.update(g))},[r,h,u.labels,u.datasets,g]),reactExports.useEffect(()=>{_.current&&(x(),setTimeout(E))},[c]),reactExports.useEffect(()=>(E(),()=>x()),[]),React.createElement("canvas",{ref:v,role:"img",height:t,width:n,...y},p)}const Chart=reactExports.forwardRef(ChartComponent);function createTypedChart(s,e){return Chart$1.register(e),reactExports.forwardRef((t,n)=>React.createElement(Chart,{...t,ref:n,type:s}))}const Bar=createTypedChart("bar",BarController),Doughnut=createTypedChart("doughnut",DoughnutController);Chart$1.register(CategoryScale,LinearScale,BarElement,ArcElement,plugin_title,plugin_tooltip,plugin_legend);const AssessmentCharts=({evaluation:s})=>{const e=parseInt(s.mcq_evaluation.score.split("/")[0]),t=parseInt(s.mcq_evaluation.score.split("/")[1]),n=e/t*100,r=parseInt(s.rubric_evaluation[0].score.split("/")[0]),o=parseInt(s.rubric_evaluation[0].score.split("/")[1]),c=r/o*100,u={labels:["MCQs","Deliverables"],datasets:[{data:[n,c],backgroundColor:["rgba(52, 152, 219, 0.8)","rgba(46, 204, 113, 0.8)"],borderColor:["rgba(52, 152, 219, 1)","rgba(46, 204, 113, 1)"],borderWidth:2}]},h={labels:s.rubric_evaluation.map(g=>g.criteria),datasets:[{label:"Score",data:s.rubric_evaluation.map(g=>parseInt(g.score.split("/")[0])),backgroundColor:"rgba(155, 89, 182, 0.8)",borderColor:"rgba(155, 89, 182, 1)",borderWidth:1,borderRadius:5}]},f={responsive:!0,plugins:{legend:{position:"top",labels:{font:{size:14,family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif"},padding:20}},title:{display:!0,text:"Score Distribution (%)",font:{size:18,weight:"bold"},padding:20},tooltip:{callbacks:{label:function(g){return`${g.label}: ${Math.round(g.raw)}%`}}}},cutout:"60%"},p={responsive:!0,plugins:{legend:{display:!1},title:{display:!0,text:"Performance by Criteria",font:{size:18,weight:"bold"},padding:20}},scales:{y:{beginAtZero:!0,max:10,ticks:{stepSize:2,font:{size:12}},grid:{display:!0,color:"rgba(0, 0, 0, 0.1)"}},x:{ticks:{font:{size:12},maxRotation:45,minRotation:45},grid:{display:!1}}}};return jsxRuntimeExports.jsx("div",{className:"charts-container",children:jsxRuntimeExports.jsxs("div",{className:"chart-row",children:[jsxRuntimeExports.jsx("div",{className:"chart-card",children:jsxRuntimeExports.jsx(Doughnut,{data:u,options:f})}),jsxRuntimeExports.jsx("div",{className:"chart-card",children:jsxRuntimeExports.jsx(Bar,{data:h,options:p})})]})})};pdfExports.GlobalWorkerOptions.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.min.js`;const model=new ChatGroq({model:"mixtral-8x7b-32768",temperature:.5,apiKey:"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"}),Assessment=()=>{const s=useLocation(),e=useNavigate(),{project:t,criteria:n}=s.state||{},[r,o]=reactExports.useState([]),[c,u]=reactExports.useState({}),[h,f]=reactExports.useState(!0),[p,g]=reactExports.useState(null),[y,v]=reactExports.useState({}),[_,E]=reactExports.useState(null),[x,w]=reactExports.useState(!1),[T,O]=reactExports.useState(!1),[N,A]=reactExports.useState(""),[I,k]=reactExports.useState(!1);reactExports.useEffect(()=>{if(!t||!n){e("/terms");return}M()},[t,n]);const M=async()=>{try{const V=`Generate 10 multiple choice questions (MCQs) for assessing knowledge of ${t.title}. 
        The assessment criteria is: ${n.name}.

        Return the MCQs in the following JSON format:
        {
          "mcqs": [
            {
              "question": "Question text here",
              "options": ["Option 1", "Option 2", "Option 3", "Option 4"],
              "correctAnswer": 0,
              "explanation": "Explanation for the correct answer"
            }
          ]
        }

        Requirements:
        1. Generate EXACTLY 10 questions
        2. Each question MUST have EXACTLY 4 options
        3. correctAnswer MUST be a number from 0-3 indicating the index of the correct option
        4. Focus on testing understanding of core concepts
        5. Return ONLY valid JSON with NO special characters or line breaks in strings
        6. Escape all quotes within strings
        7. Keep questions and options concise
        8. Do not include any text outside the JSON structure`;try{const G=(await model.call([{role:"system",content:V},{role:"user",content:"Generate MCQs in the specified JSON format."}])).content.trim().replace(/^[^{]*/,"").replace(/[^}]*$/,""),ne=JSON.parse(G);if(!ne.mcqs||!Array.isArray(ne.mcqs))throw new Error("Invalid MCQ format: mcqs array not found");const B=ne.mcqs.map((F,Y)=>{const U=C=>String(C).replace(/[\x00-\x1F\x7F-\x9F]/g,"");return{id:Y+1,question:U(F.question)||`Question ${Y+1}`,options:Array.isArray(F.options)?F.options.map(U).slice(0,4):["Option A","Option B","Option C","Option D"],correctAnswer:typeof F.correctAnswer=="number"&&F.correctAnswer>=0&&F.correctAnswer<=3?F.correctAnswer:0,explanation:U(F.explanation)||"No explanation provided"}});if(B.length!==10)throw new Error(`Expected 10 MCQs, but got ${B.length}`);o(B),g(null)}catch(Z){console.error("Error in MCQ generation:",Z),g(`Failed to generate MCQs: ${Z.message}. Please try again.`);const G=Array(5).fill(null).map((ne,B)=>({id:B+1,question:`Sample Question ${B+1} about ${t.title}?`,options:["Option A","Option B","Option C","Option D"],correctAnswer:0,explanation:"This is a sample question."}));o(G)}f(!1)}catch(V){console.error("Error generating MCQs:",V),g("Failed to generate questions. Please try again."),f(!1)}},L=(V,Z)=>{u(G=>({...G,[V]:Z}))},H=async V=>{try{const Z=await V.arrayBuffer(),G=await pdfExports.getDocument({data:Z}).promise;let ne="";for(let B=1;B<=G.numPages;B++){const U=(await(await G.getPage(B)).getTextContent()).items.map(C=>C.str).join(" ");ne+=U+" "}return ne.trim()}catch(Z){throw console.error("Error extracting text from PDF:",Z),new Error("Failed to read PDF content")}},D=async(V,Z)=>{try{const G=await H(Z);v(ne=>({...ne,[V]:{file:Z,text:G}}))}catch{g("Error reading PDF file. Please try again.")}},q=async()=>{O(!0);try{const V=Object.values(y).map(B=>B.text).join(`

`),Z=`
        You are an expert assessment evaluator. Evaluate this submission based on:

        Project: ${t.title}
        Assessment Criteria: ${n.name}
        Objective: ${n.objective}
        Tasks: ${n.tasks}
        Rubrics: ${JSON.stringify(n.rubrics)}

        MCQ Answers: ${JSON.stringify(c)}
        Deliverable Content: ${V}

        Provide evaluation in this JSON format:
        {
          "mcq_evaluation": {
            "score": "X/10",
            "feedback": "Detailed feedback"
          },
          "rubric_evaluation": [
            {
              "criteria": "Criteria Name",
              "level": "Achieved Level",
              "score": "X/10",
              "feedback": "Detailed feedback"
            }
          ],
          "total_score": "X/30",
          "improvement_suggestions": [
            "Detailed suggestions"
          ],
          "ai_opinion": "Comprehensive analysis and recommendations"
        }
      `,G=await model.call([{role:"system",content:Z},{role:"user",content:"Evaluate the submission now."}]),ne=JSON.parse(G.content);E(ne),A(ne.ai_opinion),w(!0)}catch{g("Error evaluating submission. Please try again.")}finally{O(!1)}},J=()=>{if("speechSynthesis"in window){const V=new SpeechSynthesisUtterance(N);V.onend=()=>k(!1),k(!0),window.speechSynthesis.speak(V)}},ae=()=>{"speechSynthesis"in window&&(window.speechSynthesis.cancel(),k(!1))};return h?jsxRuntimeExports.jsx("div",{className:"loading",children:"Generating assessment questions..."}):p?jsxRuntimeExports.jsx("div",{className:"error",children:p}):x?jsxRuntimeExports.jsxs("div",{className:"assessment-container",children:[jsxRuntimeExports.jsxs("div",{className:"results-header",children:[jsxRuntimeExports.jsx("h2",{children:"Assessment Results"}),jsxRuntimeExports.jsx("h3",{children:t.title}),jsxRuntimeExports.jsx("p",{className:"criteria-name",children:n.name})]}),jsxRuntimeExports.jsx("div",{className:"results-content",children:x&&_&&jsxRuntimeExports.jsxs("div",{className:"results-container",children:[jsxRuntimeExports.jsx(AssessmentCharts,{evaluation:_}),jsxRuntimeExports.jsx("div",{className:"score-overview",children:jsxRuntimeExports.jsxs("h3",{children:["Total Score: ",_.total_score]})}),jsxRuntimeExports.jsxs("div",{className:"evaluation-section",children:[jsxRuntimeExports.jsx("h3",{children:"MCQ Evaluation"}),jsxRuntimeExports.jsxs("div",{className:"evaluation-card",children:[jsxRuntimeExports.jsxs("p",{className:"score",children:["Score: ",_.mcq_evaluation.score]}),jsxRuntimeExports.jsx("p",{className:"feedback",children:_.mcq_evaluation.feedback})]})]}),jsxRuntimeExports.jsxs("div",{className:"evaluation-section",children:[jsxRuntimeExports.jsx("h3",{children:"Rubric Evaluation"}),jsxRuntimeExports.jsx("div",{className:"rubric-table",children:jsxRuntimeExports.jsxs("table",{children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{children:"Criteria"}),jsxRuntimeExports.jsx("th",{children:"Level"}),jsxRuntimeExports.jsx("th",{children:"Score"})]})}),jsxRuntimeExports.jsx("tbody",{children:_.rubric_evaluation.map((V,Z)=>jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{children:V.criteria}),jsxRuntimeExports.jsx("td",{children:V.level}),jsxRuntimeExports.jsx("td",{children:V.score})]},Z))})]})})]}),jsxRuntimeExports.jsxs("div",{className:"improvement-section",children:[jsxRuntimeExports.jsx("h3",{children:"Areas for Improvement"}),jsxRuntimeExports.jsx("ul",{children:_.improvement_suggestions.map((V,Z)=>jsxRuntimeExports.jsx("li",{children:V},Z))})]}),jsxRuntimeExports.jsxs("div",{className:"ai-opinion-section",children:[jsxRuntimeExports.jsx("h3",{children:"AI Opinion"}),jsxRuntimeExports.jsxs("div",{className:"ai-opinion-content",children:[jsxRuntimeExports.jsx("p",{children:N}),jsxRuntimeExports.jsx("button",{className:"voice-button",onClick:I?ae:J,children:I?"Stop AI Voice":"Play AI Voice"})]})]}),jsxRuntimeExports.jsx("button",{className:"new-assessment-button",onClick:()=>e("/terms"),children:"Start New Assessment"})]})})]}):jsxRuntimeExports.jsxs("div",{className:"assessment-container",children:[jsxRuntimeExports.jsxs("div",{className:"assessment-header",children:[jsxRuntimeExports.jsx("h2",{children:t.title}),jsxRuntimeExports.jsx("p",{className:"criteria-name",children:n.name})]}),jsxRuntimeExports.jsxs("div",{className:"assessment-content",children:[jsxRuntimeExports.jsxs("div",{className:"mcq-section",children:[jsxRuntimeExports.jsx("h3",{children:"Multiple Choice Questions"}),r.map((V,Z)=>jsxRuntimeExports.jsxs("div",{className:"question-card",children:[jsxRuntimeExports.jsxs("h4",{children:["Question ",Z+1]}),jsxRuntimeExports.jsx("p",{children:V.question}),jsxRuntimeExports.jsx("div",{className:"options",children:V.options.map((G,ne)=>jsxRuntimeExports.jsxs("label",{className:"option-label",children:[jsxRuntimeExports.jsx("input",{type:"radio",name:`question-${V.id}`,value:ne,checked:c[V.id]===ne,onChange:()=>L(V.id,ne)}),G]},ne))})]},V.id))]}),jsxRuntimeExports.jsxs("div",{className:"deliverables-section",children:[jsxRuntimeExports.jsx("h3",{children:"Upload Deliverables"}),n.deliverables.map((V,Z)=>jsxRuntimeExports.jsxs("div",{className:"deliverable-item",children:[jsxRuntimeExports.jsx("p",{children:V}),jsxRuntimeExports.jsx("input",{type:"file",onChange:G=>D(Z,G.target.files[0]),accept:".pdf"})]},Z))]}),jsxRuntimeExports.jsx("button",{className:"submit-button",onClick:q,disabled:T||Object.keys(c).length!==r.length||Object.keys(y).length!==n.deliverables.length,children:T?"Evaluating...":"Submit for Evaluation"})]})]})};/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */const{entries,setPrototypeOf,isFrozen,getPrototypeOf,getOwnPropertyDescriptor}=Object;let{freeze,seal,create}=Object,{apply,construct}=typeof Reflect<"u"&&Reflect;freeze||(freeze=function(e){return e});seal||(seal=function(e){return e});apply||(apply=function(e,t,n){return e.apply(t,n)});construct||(construct=function(e,t){return new e(...t)});const arrayForEach=unapply(Array.prototype.forEach),arrayLastIndexOf=unapply(Array.prototype.lastIndexOf),arrayPop=unapply(Array.prototype.pop),arrayPush=unapply(Array.prototype.push),arraySplice=unapply(Array.prototype.splice),stringToLowerCase=unapply(String.prototype.toLowerCase),stringToString=unapply(String.prototype.toString),stringMatch=unapply(String.prototype.match),stringReplace=unapply(String.prototype.replace),stringIndexOf=unapply(String.prototype.indexOf),stringTrim=unapply(String.prototype.trim),objectHasOwnProperty=unapply(Object.prototype.hasOwnProperty),regExpTest=unapply(RegExp.prototype.test),typeErrorCreate=unconstruct(TypeError);function unapply(s){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return apply(s,e,n)}}function unconstruct(s){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return construct(s,t)}}function addToSet(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:stringToLowerCase;setPrototypeOf&&setPrototypeOf(s,null);let n=e.length;for(;n--;){let r=e[n];if(typeof r=="string"){const o=t(r);o!==r&&(isFrozen(e)||(e[n]=o),r=o)}s[r]=!0}return s}function cleanArray(s){for(let e=0;e<s.length;e++)objectHasOwnProperty(s,e)||(s[e]=null);return s}function clone(s){const e=create(null);for(const[t,n]of entries(s))objectHasOwnProperty(s,t)&&(Array.isArray(n)?e[t]=cleanArray(n):n&&typeof n=="object"&&n.constructor===Object?e[t]=clone(n):e[t]=n);return e}function lookupGetter(s,e){for(;s!==null;){const n=getOwnPropertyDescriptor(s,e);if(n){if(n.get)return unapply(n.get);if(typeof n.value=="function")return unapply(n.value)}s=getPrototypeOf(s)}function t(){return null}return t}const html$1=freeze(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),svg$1=freeze(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),svgFilters=freeze(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),svgDisallowed=freeze(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mathMl$1=freeze(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),mathMlDisallowed=freeze(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=freeze(["#text"]),html=freeze(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),svg=freeze(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mathMl=freeze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),xml=freeze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),MUSTACHE_EXPR=seal(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ERB_EXPR=seal(/<%[\w\W]*|[\w\W]*%>/gm),TMPLIT_EXPR=seal(/\$\{[\w\W]*/gm),DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]+$/),ARIA_ATTR=seal(/^aria-[\-\w]+$/),IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i),ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),DOCTYPE_NAME=seal(/^html$/i),CUSTOM_ELEMENT=seal(/^[a-z][.\w]*(-[.\w]+)+$/i);var EXPRESSIONS=Object.freeze({__proto__:null,ARIA_ATTR,ATTR_WHITESPACE,CUSTOM_ELEMENT,DATA_ATTR,DOCTYPE_NAME,ERB_EXPR,IS_ALLOWED_URI,IS_SCRIPT_OR_DATA,MUSTACHE_EXPR,TMPLIT_EXPR});const NODE_TYPE={element:1,text:3,progressingInstruction:7,comment:8,document:9},getGlobal=function s(){return typeof window>"u"?null:window},_createTrustedTypesPolicy=function s(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const r="data-tt-policy-suffix";t&&t.hasAttribute(r)&&(n=t.getAttribute(r));const o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},_createHooksMap=function s(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function createDOMPurify(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:getGlobal();const e=nt=>createDOMPurify(nt);if(e.version="3.2.4",e.removed=[],!s||!s.document||s.document.nodeType!==NODE_TYPE.document||!s.Element)return e.isSupported=!1,e;let{document:t}=s;const n=t,r=n.currentScript,{DocumentFragment:o,HTMLTemplateElement:c,Node:u,Element:h,NodeFilter:f,NamedNodeMap:p=s.NamedNodeMap||s.MozNamedAttrMap,HTMLFormElement:g,DOMParser:y,trustedTypes:v}=s,_=h.prototype,E=lookupGetter(_,"cloneNode"),x=lookupGetter(_,"remove"),w=lookupGetter(_,"nextSibling"),T=lookupGetter(_,"childNodes"),O=lookupGetter(_,"parentNode");if(typeof c=="function"){const nt=t.createElement("template");nt.content&&nt.content.ownerDocument&&(t=nt.content.ownerDocument)}let N,A="";const{implementation:I,createNodeIterator:k,createDocumentFragment:M,getElementsByTagName:L}=t,{importNode:H}=n;let D=_createHooksMap();e.isSupported=typeof entries=="function"&&typeof O=="function"&&I&&I.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:q,ERB_EXPR:J,TMPLIT_EXPR:ae,DATA_ATTR:V,ARIA_ATTR:Z,IS_SCRIPT_OR_DATA:G,ATTR_WHITESPACE:ne,CUSTOM_ELEMENT:B}=EXPRESSIONS;let{IS_ALLOWED_URI:F}=EXPRESSIONS,Y=null;const U=addToSet({},[...html$1,...svg$1,...svgFilters,...mathMl$1,...text]);let C=null;const P=addToSet({},[...html,...svg,...mathMl,...xml]);let $=Object.seal(create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),W=null,te=null,ee=!0,ce=!0,he=!1,Re=!0,Ce=!1,Ie=!0,Ne=!1,$e=!1,ge=!1,_e=!1,X=!1,se=!1,fe=!0,ve=!1;const Me="user-content-";let Be=!0,Le=!1,pe={},Ge=null;const qe=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let pt=null;const dt=addToSet({},["audio","video","img","source","image","track"]);let Et=null;const rt=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ct="http://www.w3.org/1998/Math/MathML",yt="http://www.w3.org/2000/svg",mt="http://www.w3.org/1999/xhtml";let Fe=mt,be=!1,ye=null;const tt=addToSet({},[ct,yt,mt],stringToString);let xt=addToSet({},["mi","mo","mn","ms","mtext"]),vt=addToSet({},["annotation-xml"]);const oe=addToSet({},["title","style","font","a","script"]);let ke=null;const Ve=["application/xhtml+xml","text/html"],at="text/html";let Je=null,et=null;const ie=t.createElement("form"),Q=function(me){return me instanceof RegExp||me instanceof Function},ue=function(){let me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(et&&et===me)){if((!me||typeof me!="object")&&(me={}),me=clone(me),ke=Ve.indexOf(me.PARSER_MEDIA_TYPE)===-1?at:me.PARSER_MEDIA_TYPE,Je=ke==="application/xhtml+xml"?stringToString:stringToLowerCase,Y=objectHasOwnProperty(me,"ALLOWED_TAGS")?addToSet({},me.ALLOWED_TAGS,Je):U,C=objectHasOwnProperty(me,"ALLOWED_ATTR")?addToSet({},me.ALLOWED_ATTR,Je):P,ye=objectHasOwnProperty(me,"ALLOWED_NAMESPACES")?addToSet({},me.ALLOWED_NAMESPACES,stringToString):tt,Et=objectHasOwnProperty(me,"ADD_URI_SAFE_ATTR")?addToSet(clone(rt),me.ADD_URI_SAFE_ATTR,Je):rt,pt=objectHasOwnProperty(me,"ADD_DATA_URI_TAGS")?addToSet(clone(dt),me.ADD_DATA_URI_TAGS,Je):dt,Ge=objectHasOwnProperty(me,"FORBID_CONTENTS")?addToSet({},me.FORBID_CONTENTS,Je):qe,W=objectHasOwnProperty(me,"FORBID_TAGS")?addToSet({},me.FORBID_TAGS,Je):{},te=objectHasOwnProperty(me,"FORBID_ATTR")?addToSet({},me.FORBID_ATTR,Je):{},pe=objectHasOwnProperty(me,"USE_PROFILES")?me.USE_PROFILES:!1,ee=me.ALLOW_ARIA_ATTR!==!1,ce=me.ALLOW_DATA_ATTR!==!1,he=me.ALLOW_UNKNOWN_PROTOCOLS||!1,Re=me.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ce=me.SAFE_FOR_TEMPLATES||!1,Ie=me.SAFE_FOR_XML!==!1,Ne=me.WHOLE_DOCUMENT||!1,_e=me.RETURN_DOM||!1,X=me.RETURN_DOM_FRAGMENT||!1,se=me.RETURN_TRUSTED_TYPE||!1,ge=me.FORCE_BODY||!1,fe=me.SANITIZE_DOM!==!1,ve=me.SANITIZE_NAMED_PROPS||!1,Be=me.KEEP_CONTENT!==!1,Le=me.IN_PLACE||!1,F=me.ALLOWED_URI_REGEXP||IS_ALLOWED_URI,Fe=me.NAMESPACE||mt,xt=me.MATHML_TEXT_INTEGRATION_POINTS||xt,vt=me.HTML_INTEGRATION_POINTS||vt,$=me.CUSTOM_ELEMENT_HANDLING||{},me.CUSTOM_ELEMENT_HANDLING&&Q(me.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&($.tagNameCheck=me.CUSTOM_ELEMENT_HANDLING.tagNameCheck),me.CUSTOM_ELEMENT_HANDLING&&Q(me.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&($.attributeNameCheck=me.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),me.CUSTOM_ELEMENT_HANDLING&&typeof me.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&($.allowCustomizedBuiltInElements=me.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ce&&(ce=!1),X&&(_e=!0),pe&&(Y=addToSet({},text),C=[],pe.html===!0&&(addToSet(Y,html$1),addToSet(C,html)),pe.svg===!0&&(addToSet(Y,svg$1),addToSet(C,svg),addToSet(C,xml)),pe.svgFilters===!0&&(addToSet(Y,svgFilters),addToSet(C,svg),addToSet(C,xml)),pe.mathMl===!0&&(addToSet(Y,mathMl$1),addToSet(C,mathMl),addToSet(C,xml))),me.ADD_TAGS&&(Y===U&&(Y=clone(Y)),addToSet(Y,me.ADD_TAGS,Je)),me.ADD_ATTR&&(C===P&&(C=clone(C)),addToSet(C,me.ADD_ATTR,Je)),me.ADD_URI_SAFE_ATTR&&addToSet(Et,me.ADD_URI_SAFE_ATTR,Je),me.FORBID_CONTENTS&&(Ge===qe&&(Ge=clone(Ge)),addToSet(Ge,me.FORBID_CONTENTS,Je)),Be&&(Y["#text"]=!0),Ne&&addToSet(Y,["html","head","body"]),Y.table&&(addToSet(Y,["tbody"]),delete W.tbody),me.TRUSTED_TYPES_POLICY){if(typeof me.TRUSTED_TYPES_POLICY.createHTML!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof me.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');N=me.TRUSTED_TYPES_POLICY,A=N.createHTML("")}else N===void 0&&(N=_createTrustedTypesPolicy(v,r)),N!==null&&typeof A=="string"&&(A=N.createHTML(""));freeze&&freeze(me),et=me}},Ae=addToSet({},[...svg$1,...svgFilters,...svgDisallowed]),Oe=addToSet({},[...mathMl$1,...mathMlDisallowed]),je=function(me){let We=O(me);(!We||!We.tagName)&&(We={namespaceURI:Fe,tagName:"template"});const lt=stringToLowerCase(me.tagName),It=stringToLowerCase(We.tagName);return ye[me.namespaceURI]?me.namespaceURI===yt?We.namespaceURI===mt?lt==="svg":We.namespaceURI===ct?lt==="svg"&&(It==="annotation-xml"||xt[It]):!!Ae[lt]:me.namespaceURI===ct?We.namespaceURI===mt?lt==="math":We.namespaceURI===yt?lt==="math"&&vt[It]:!!Oe[lt]:me.namespaceURI===mt?We.namespaceURI===yt&&!vt[It]||We.namespaceURI===ct&&!xt[It]?!1:!Oe[lt]&&(oe[lt]||!Ae[lt]):!!(ke==="application/xhtml+xml"&&ye[me.namespaceURI]):!1},Ue=function(me){arrayPush(e.removed,{element:me});try{O(me).removeChild(me)}catch{x(me)}},it=function(me,We){try{arrayPush(e.removed,{attribute:We.getAttributeNode(me),from:We})}catch{arrayPush(e.removed,{attribute:null,from:We})}if(We.removeAttribute(me),me==="is")if(_e||X)try{Ue(We)}catch{}else try{We.setAttribute(me,"")}catch{}},st=function(me){let We=null,lt=null;if(ge)me="<remove></remove>"+me;else{const Pt=stringMatch(me,/^[\r\n\t ]+/);lt=Pt&&Pt[0]}ke==="application/xhtml+xml"&&Fe===mt&&(me='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+me+"</body></html>");const It=N?N.createHTML(me):me;if(Fe===mt)try{We=new y().parseFromString(It,ke)}catch{}if(!We||!We.documentElement){We=I.createDocument(Fe,"template",null);try{We.documentElement.innerHTML=be?A:It}catch{}}const Ht=We.body||We.documentElement;return me&&lt&&Ht.insertBefore(t.createTextNode(lt),Ht.childNodes[0]||null),Fe===mt?L.call(We,Ne?"html":"body")[0]:Ne?We.documentElement:Ht},Ye=function(me){return k.call(me.ownerDocument||me,me,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT|f.SHOW_PROCESSING_INSTRUCTION|f.SHOW_CDATA_SECTION,null)},ht=function(me){return me instanceof g&&(typeof me.nodeName!="string"||typeof me.textContent!="string"||typeof me.removeChild!="function"||!(me.attributes instanceof p)||typeof me.removeAttribute!="function"||typeof me.setAttribute!="function"||typeof me.namespaceURI!="string"||typeof me.insertBefore!="function"||typeof me.hasChildNodes!="function")},Qe=function(me){return typeof u=="function"&&me instanceof u};function Ke(nt,me,We){arrayForEach(nt,lt=>{lt.call(e,me,We,et)})}const ut=function(me){let We=null;if(Ke(D.beforeSanitizeElements,me,null),ht(me))return Ue(me),!0;const lt=Je(me.nodeName);if(Ke(D.uponSanitizeElement,me,{tagName:lt,allowedTags:Y}),me.hasChildNodes()&&!Qe(me.firstElementChild)&&regExpTest(/<[/\w]/g,me.innerHTML)&&regExpTest(/<[/\w]/g,me.textContent)||me.nodeType===NODE_TYPE.progressingInstruction||Ie&&me.nodeType===NODE_TYPE.comment&&regExpTest(/<[/\w]/g,me.data))return Ue(me),!0;if(!Y[lt]||W[lt]){if(!W[lt]&&At(lt)&&($.tagNameCheck instanceof RegExp&&regExpTest($.tagNameCheck,lt)||$.tagNameCheck instanceof Function&&$.tagNameCheck(lt)))return!1;if(Be&&!Ge[lt]){const It=O(me)||me.parentNode,Ht=T(me)||me.childNodes;if(Ht&&It){const Pt=Ht.length;for(let rn=Pt-1;rn>=0;--rn){const pn=E(Ht[rn],!0);pn.__removalCount=(me.__removalCount||0)+1,It.insertBefore(pn,w(me))}}}return Ue(me),!0}return me instanceof h&&!je(me)||(lt==="noscript"||lt==="noembed"||lt==="noframes")&&regExpTest(/<\/no(script|embed|frames)/i,me.innerHTML)?(Ue(me),!0):(Ce&&me.nodeType===NODE_TYPE.text&&(We=me.textContent,arrayForEach([q,J,ae],It=>{We=stringReplace(We,It," ")}),me.textContent!==We&&(arrayPush(e.removed,{element:me.cloneNode()}),me.textContent=We)),Ke(D.afterSanitizeElements,me,null),!1)},bt=function(me,We,lt){if(fe&&(We==="id"||We==="name")&&(lt in t||lt in ie))return!1;if(!(ce&&!te[We]&&regExpTest(V,We))){if(!(ee&&regExpTest(Z,We))){if(!C[We]||te[We]){if(!(At(me)&&($.tagNameCheck instanceof RegExp&&regExpTest($.tagNameCheck,me)||$.tagNameCheck instanceof Function&&$.tagNameCheck(me))&&($.attributeNameCheck instanceof RegExp&&regExpTest($.attributeNameCheck,We)||$.attributeNameCheck instanceof Function&&$.attributeNameCheck(We))||We==="is"&&$.allowCustomizedBuiltInElements&&($.tagNameCheck instanceof RegExp&&regExpTest($.tagNameCheck,lt)||$.tagNameCheck instanceof Function&&$.tagNameCheck(lt))))return!1}else if(!Et[We]){if(!regExpTest(F,stringReplace(lt,ne,""))){if(!((We==="src"||We==="xlink:href"||We==="href")&&me!=="script"&&stringIndexOf(lt,"data:")===0&&pt[me])){if(!(he&&!regExpTest(G,stringReplace(lt,ne,"")))){if(lt)return!1}}}}}}return!0},At=function(me){return me!=="annotation-xml"&&stringMatch(me,B)},Ot=function(me){Ke(D.beforeSanitizeAttributes,me,null);const{attributes:We}=me;if(!We||ht(me))return;const lt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:C,forceKeepAttr:void 0};let It=We.length;for(;It--;){const Ht=We[It],{name:Pt,namespaceURI:rn,value:pn}=Ht,mn=Je(Pt);let Vt=Pt==="value"?pn:stringTrim(pn);if(lt.attrName=mn,lt.attrValue=Vt,lt.keepAttr=!0,lt.forceKeepAttr=void 0,Ke(D.uponSanitizeAttribute,me,lt),Vt=lt.attrValue,ve&&(mn==="id"||mn==="name")&&(it(Pt,me),Vt=Me+Vt),Ie&&regExpTest(/((--!?|])>)|<\/(style|title)/i,Vt)){it(Pt,me);continue}if(lt.forceKeepAttr||(it(Pt,me),!lt.keepAttr))continue;if(!Re&&regExpTest(/\/>/i,Vt)){it(Pt,me);continue}Ce&&arrayForEach([q,J,ae],Pr=>{Vt=stringReplace(Vt,Pr," ")});const xn=Je(me.nodeName);if(bt(xn,mn,Vt)){if(N&&typeof v=="object"&&typeof v.getAttributeType=="function"&&!rn)switch(v.getAttributeType(xn,mn)){case"TrustedHTML":{Vt=N.createHTML(Vt);break}case"TrustedScriptURL":{Vt=N.createScriptURL(Vt);break}}try{rn?me.setAttributeNS(rn,Pt,Vt):me.setAttribute(Pt,Vt),ht(me)?Ue(me):arrayPop(e.removed)}catch{}}}Ke(D.afterSanitizeAttributes,me,null)},Bt=function nt(me){let We=null;const lt=Ye(me);for(Ke(D.beforeSanitizeShadowDOM,me,null);We=lt.nextNode();)Ke(D.uponSanitizeShadowNode,We,null),ut(We),Ot(We),We.content instanceof o&&nt(We.content);Ke(D.afterSanitizeShadowDOM,me,null)};return e.sanitize=function(nt){let me=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},We=null,lt=null,It=null,Ht=null;if(be=!nt,be&&(nt="<!-->"),typeof nt!="string"&&!Qe(nt))if(typeof nt.toString=="function"){if(nt=nt.toString(),typeof nt!="string")throw typeErrorCreate("dirty is not a string, aborting")}else throw typeErrorCreate("toString is not a function");if(!e.isSupported)return nt;if($e||ue(me),e.removed=[],typeof nt=="string"&&(Le=!1),Le){if(nt.nodeName){const pn=Je(nt.nodeName);if(!Y[pn]||W[pn])throw typeErrorCreate("root node is forbidden and cannot be sanitized in-place")}}else if(nt instanceof u)We=st("<!---->"),lt=We.ownerDocument.importNode(nt,!0),lt.nodeType===NODE_TYPE.element&&lt.nodeName==="BODY"||lt.nodeName==="HTML"?We=lt:We.appendChild(lt);else{if(!_e&&!Ce&&!Ne&&nt.indexOf("<")===-1)return N&&se?N.createHTML(nt):nt;if(We=st(nt),!We)return _e?null:se?A:""}We&&ge&&Ue(We.firstChild);const Pt=Ye(Le?nt:We);for(;It=Pt.nextNode();)ut(It),Ot(It),It.content instanceof o&&Bt(It.content);if(Le)return nt;if(_e){if(X)for(Ht=M.call(We.ownerDocument);We.firstChild;)Ht.appendChild(We.firstChild);else Ht=We;return(C.shadowroot||C.shadowrootmode)&&(Ht=H.call(n,Ht,!0)),Ht}let rn=Ne?We.outerHTML:We.innerHTML;return Ne&&Y["!doctype"]&&We.ownerDocument&&We.ownerDocument.doctype&&We.ownerDocument.doctype.name&&regExpTest(DOCTYPE_NAME,We.ownerDocument.doctype.name)&&(rn="<!DOCTYPE "+We.ownerDocument.doctype.name+`>
`+rn),Ce&&arrayForEach([q,J,ae],pn=>{rn=stringReplace(rn,pn," ")}),N&&se?N.createHTML(rn):rn},e.setConfig=function(){let nt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ue(nt),$e=!0},e.clearConfig=function(){et=null,$e=!1},e.isValidAttribute=function(nt,me,We){et||ue({});const lt=Je(nt),It=Je(me);return bt(lt,It,We)},e.addHook=function(nt,me){typeof me=="function"&&arrayPush(D[nt],me)},e.removeHook=function(nt,me){if(me!==void 0){const We=arrayLastIndexOf(D[nt],me);return We===-1?void 0:arraySplice(D[nt],We,1)[0]}return arrayPop(D[nt])},e.removeHooks=function(nt){D[nt]=[]},e.removeAllHooks=function(){D=_createHooksMap()},e}var purify=createDOMPurify();const GROQ_API_KEY$1="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",GROQ_API_URL$1="https://api.groq.com/openai/v1/chat/completions",TeacherAssistant=()=>{const[s,e]=reactExports.useState(""),[t,n]=reactExports.useState(""),[r,o]=reactExports.useState(""),[c,u]=reactExports.useState(""),[h,f]=reactExports.useState(""),[p,g]=reactExports.useState(!1),[y,v]=reactExports.useState(""),[_,E]=reactExports.useState(!1),[x,w]=reactExports.useState(!1),T=window.speechSynthesis,[O,N]=reactExports.useState(null),A=reactExports.useCallback(()=>{if(_){T.cancel(),E(!1);return}if(h){const H=h.replace(/<[^>]+>/g,""),D=new SpeechSynthesisUtterance(H);D.lang="en-US",D.rate=1,D.pitch=1,D.onend=()=>{E(!1)},D.onerror=()=>{E(!1),v("Speech synthesis failed. Please try again.")},N(D),E(!0),T.speak(D)}},[h,_]),I=()=>{w(!0);const H=new(window.SpeechRecognition||window.webkitSpeechRecognition);H.lang="en-US",H.onresult=D=>{const q=D.results[0][0].transcript;u(q),L(),w(!1)},H.start()};React.useEffect(()=>()=>{T&&T.cancel()},[]);const k=async H=>{var D;try{const q=`As a teacher assistant for ${t} Grade ${r} in the ${s} curriculum, please help with this question: ${H}`,J=await fetch(GROQ_API_URL$1,{method:"POST",headers:{Authorization:`Bearer ${GROQ_API_KEY$1}`,"Content-Type":"application/json"},body:JSON.stringify({model:"llama-3.3-70b-specdec",messages:[{role:"system",content:`You are an AI teacher assistant. Help teachers create effective lesson plans, provide teaching strategies, and suggest educational resources.

Format your responses using HTML tags for better readability:
- Use <h1> for main topics
- Use <h2> for subtopics
- Use <h3> for section headings
- Use <p> for paragraphs
- Use <strong> for emphasis
- Use <em> for secondary emphasis
- Use <ul> and <li> for unordered lists
- Use <ol> and <li> for ordered lists
- Use <blockquote> for important quotes or key points
- Use <code> for any code or specific terms
- Create tables using <table>, <tr>, <th>, and <td> when presenting structured data
- Wrap tips in <div class="tip">...</div>
- Wrap notes in <div class="note">...</div>

Make your responses visually appealing and easy to read. Use appropriate headings and structure to organize the information clearly.`},{role:"user",content:q}],temperature:.5})}),ae=await J.json();if(!J.ok)throw new Error(((D=ae.error)==null?void 0:D.message)||"Failed to get response");return ae.choices[0].message.content}catch(q){return v(q.message||"Failed to get response"),null}},M=H=>`<div style="background-color: white; color: black;">${purify.sanitize(H)}</div>`,L=async H=>{if(H&&H.preventDefault(),!s||!t||!r){alert("Please select curriculum, subject, and grade before asking a question.");return}g(!0),v(""),f("");const D=await k(c);if(!D){g(!1);return}f(M(D)),g(!1)};return jsxRuntimeExports.jsx("div",{className:"lesson-plan-container",children:jsxRuntimeExports.jsxs("div",{className:"content",children:[jsxRuntimeExports.jsx("h1",{children:"Teacher Assistant"}),jsxRuntimeExports.jsx("p",{className:"description",children:"Get help with lesson planning, teaching strategies, and educational resources"}),jsxRuntimeExports.jsxs("form",{onSubmit:L,className:"form-content",children:[jsxRuntimeExports.jsxs("div",{className:"dropdown-section",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Select Curriculum"}),jsxRuntimeExports.jsxs("select",{value:s,onChange:H=>e(H.target.value),required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Choose Curriculum"}),jsxRuntimeExports.jsx("option",{value:"ontario",children:"Ontario"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Select Subject"}),jsxRuntimeExports.jsxs("select",{value:t,onChange:H=>n(H.target.value),required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Choose Subject"}),jsxRuntimeExports.jsx("option",{value:"math",children:"Mathematics"}),jsxRuntimeExports.jsx("option",{value:"english",children:"English"}),jsxRuntimeExports.jsx("option",{value:"science",children:"Science"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Select Grade"}),jsxRuntimeExports.jsxs("select",{value:r,onChange:H=>o(H.target.value),required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Choose Grade"}),[1,2,3,4,5,6,7,8].map(H=>jsxRuntimeExports.jsxs("option",{value:H,children:["Grade ",H]},H))]})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Your Question"}),jsxRuntimeExports.jsx("textarea",{value:c,onChange:H=>u(H.target.value),placeholder:"Ask about lesson planning, teaching strategies, or any other teaching-related questions...",required:!0,rows:"4",className:"question-input",disabled:x})]}),jsxRuntimeExports.jsx("button",{type:"submit",className:"submit-button",disabled:p,children:p?"Getting Answer...":"Ask Question"}),jsxRuntimeExports.jsx("button",{onClick:I,className:"voice-button",title:"Ask Question by Voice",children:"Ask by Voice"})]}),y&&jsxRuntimeExports.jsx("div",{className:"error-message",children:y}),h&&jsxRuntimeExports.jsxs("div",{className:"generated-content",children:[jsxRuntimeExports.jsx("h2",{children:"Here's Your Answer"}),jsxRuntimeExports.jsx("div",{className:"answer-box",dangerouslySetInnerHTML:{__html:h}}),jsxRuntimeExports.jsx("button",{onClick:A,className:"voice-button",title:_?"Stop Speaking":"Listen to Answer",children:_?"Stop":"Listen"})]})]})})},GROQ_API_KEY="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",GROQ_API_URL="https://api.groq.com/openai/v1/chat/completions",StudentAssistant=()=>{const[s,e]=reactExports.useState(""),[t,n]=reactExports.useState(""),[r,o]=reactExports.useState(""),[c,u]=reactExports.useState(""),[h,f]=reactExports.useState(""),[p,g]=reactExports.useState(!1),[y,v]=reactExports.useState(""),[_,E]=reactExports.useState(!1),[x,w]=reactExports.useState(!1),T=window.speechSynthesis,[O,N]=reactExports.useState(null),A=reactExports.useCallback(()=>{if(_){T.cancel(),E(!1);return}if(h){const H=h.replace(/<[^>]+>/g,""),D=new SpeechSynthesisUtterance(H);D.lang="en-US",D.rate=1,D.pitch=1,D.onend=()=>{E(!1)},D.onerror=()=>{E(!1),v("Speech synthesis failed. Please try again.")},N(D),E(!0),T.speak(D)}},[h,_]),I=()=>{w(!0);const H=new(window.SpeechRecognition||window.webkitSpeechRecognition);H.lang="en-US",H.onresult=D=>{const q=D.results[0][0].transcript;u(q),L(),w(!1)},H.start()};React.useEffect(()=>()=>{T&&T.cancel()},[]);const k=async H=>{var D;try{const q=`As a student learning assistant for ${t} Grade ${r} in the ${s} curriculum, please help with this question: ${H}`,J=await fetch(GROQ_API_URL,{method:"POST",headers:{Authorization:`Bearer ${GROQ_API_KEY}`,"Content-Type":"application/json"},body:JSON.stringify({model:"llama-3.3-70b-versatile",messages:[{role:"system",content:`You are an AI student assistant. Explain concepts clearly and simply, suitable for the student's grade level. Provide step-by-step explanations when needed.

Format your responses using HTML tags for better readability:
- Use <h1> for main topics
- Use <h2> for subtopics
- Use <h3> for section headings
- Use <p> for paragraphs
- Use <strong> for emphasis
- Use <em> for secondary emphasis
- Use <ul> and <li> for unordered lists
- Use <ol> and <li> for ordered lists
- Use <blockquote> for important quotes or key points
- Use <code> for any code or specific terms
- Create tables using <table>, <tr>, <th>, and <td> when presenting structured data
- Wrap tips in <div class="tip">...</div>
- Wrap notes in <div class="note">...</div>

Make your responses visually appealing and easy to read. Break down complex concepts into clear, well-organized sections with appropriate headings and structure.

Please ensure your response is formatted with a white background, black text, headings, and tables.
`},{role:"user",content:q}],temperature:.5})}),ae=await J.json();if(!J.ok)throw new Error(((D=ae.error)==null?void 0:D.message)||"Failed to get response");return ae.choices[0].message.content}catch(q){return v(q.message||"Failed to get response"),null}},M=H=>purify.sanitize(H),L=async H=>{if(H.preventDefault(),!s||!t||!r){alert("Please select curriculum, subject, and grade before asking a question.");return}g(!0),v(""),f("");const D=await k(c);if(!D){g(!1);return}f(M(D)),g(!1)};return jsxRuntimeExports.jsx("div",{className:"lesson-plan-container",children:jsxRuntimeExports.jsxs("div",{className:"content",children:[jsxRuntimeExports.jsx("h1",{children:"Student Learning Assistant"}),jsxRuntimeExports.jsx("p",{className:"description",children:"Get help understanding concepts, solving problems, and improving your study skills"}),jsxRuntimeExports.jsxs("form",{onSubmit:L,className:"form-content",children:[jsxRuntimeExports.jsxs("div",{className:"dropdown-section",children:[jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Select Your Curriculum"}),jsxRuntimeExports.jsxs("select",{value:s,onChange:H=>e(H.target.value),required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Choose Curriculum"}),jsxRuntimeExports.jsx("option",{value:"ontario",children:"Ontario"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Select Your Subject"}),jsxRuntimeExports.jsxs("select",{value:t,onChange:H=>n(H.target.value),required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Choose Subject"}),jsxRuntimeExports.jsx("option",{value:"math",children:"Mathematics"}),jsxRuntimeExports.jsx("option",{value:"english",children:"English"}),jsxRuntimeExports.jsx("option",{value:"science",children:"Science"})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Select Your Grade"}),jsxRuntimeExports.jsxs("select",{value:r,onChange:H=>o(H.target.value),required:!0,children:[jsxRuntimeExports.jsx("option",{value:"",children:"Choose Grade"}),[1,2,3,4,5,6,7,8].map(H=>jsxRuntimeExports.jsxs("option",{value:H,children:["Grade ",H]},H))]})]})]}),jsxRuntimeExports.jsxs("div",{className:"form-group",children:[jsxRuntimeExports.jsx("label",{children:"Your Question"}),jsxRuntimeExports.jsx("textarea",{value:c,onChange:H=>u(H.target.value),placeholder:"Ask about anything you need help with in your studies...",required:!0,rows:"4",className:"question-input"})]}),jsxRuntimeExports.jsx("button",{type:"submit",className:"submit-button",disabled:p,children:p?"Getting Answer...":"Ask Question"}),jsxRuntimeExports.jsx("button",{onClick:I,className:"voice-button",children:x?"Listening...":"Ask Question by Voice"})]}),y&&jsxRuntimeExports.jsx("div",{className:"error-message",children:y}),h&&jsxRuntimeExports.jsxs("div",{className:"generated-content",children:[jsxRuntimeExports.jsx("h2",{children:"Here's Your Answer"}),jsxRuntimeExports.jsx("div",{className:"answer-box",dangerouslySetInnerHTML:{__html:h}}),jsxRuntimeExports.jsx("button",{onClick:A,className:"voice-button",title:_?"Stop Speaking":"Listen to Answer",children:_?"Stop":"Listen"})]})]})})},App=()=>jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsxs("div",{className:"app",children:[jsxRuntimeExports.jsx(Header,{}),jsxRuntimeExports.jsx("main",{className:"main-content",children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/introduction",element:jsxRuntimeExports.jsx(Introduction,{})}),jsxRuntimeExports.jsx(Route,{path:"/terms",element:jsxRuntimeExports.jsx(Terms,{})}),jsxRuntimeExports.jsx(Route,{path:"/lessonplan",element:jsxRuntimeExports.jsx(LessonPlan,{})}),jsxRuntimeExports.jsx(Route,{path:"/assessment",element:jsxRuntimeExports.jsx(Assessment,{})}),jsxRuntimeExports.jsx(Route,{path:"/teacher-assistant",element:jsxRuntimeExports.jsx(TeacherAssistant,{})}),jsxRuntimeExports.jsx(Route,{path:"/student-assistant",element:jsxRuntimeExports.jsx(StudentAssistant,{})}),jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(Navigate,{to:"/terms",replace:!0})})]})}),jsxRuntimeExports.jsx(Footer,{})]})});clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
//# sourceMappingURL=index-B2I8KTmu.js.map
